#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass heb-article
\begin_preamble
\date{}
\usepackage{fullpage}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language hebrew
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures false
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\branch Drafts
\selected 0
\filename_suffix 0
\color #faf0e6
\end_branch
\branch Advanced
\selected 0
\filename_suffix 0
\color #faf0e6
\end_branch
\branch Full proofs
\selected 0
\filename_suffix 0
\color #faf0e6
\end_branch
\branch Class Version
\selected 1
\filename_suffix 0
\color #faf0e6
\end_branch
\branch Not sure
\selected 0
\filename_suffix 0
\color #faf0e6
\end_branch
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
אלגוריתמים קומבינטוריים - הרצאות
\end_layout

\begin_layout Author
גדי אלכסנדרוביץ'
\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Section
מבוא
\end_layout

\begin_layout Standard
מטרת קורס זה היא לתת היכרות בסיסית עם מדעי המחשב מנקודת מבט שהיא 
\begin_inset Quotes eld
\end_inset

מתמטית
\begin_inset Quotes erd
\end_inset

 באופיה.
 לצורך כך נציג מספר נושאים אשר נלמדים בקורסי הבסיס של מדעי המחשב העוסקים
 במבני נתונים ואלגוריתמיים: אלגוריתמי מיון, אלגוריתמים שפועלים על גרפים
 ואלגוריתמים של קידוד.
 בסיוע הנחה נוספת על ידע בסיסי באלגברה מופשטת נוכל להציג גם אלגוריתמים בסיסיים
 של תורת המספרים וקריפטוגרפיה, שבמדעי המחשב נלמדים בשלב מתקדם יותר כחומר
 בחירה.
\end_layout

\begin_layout Section
אלגוריתמי מיון
\end_layout

\begin_layout Subsection
מבוא
\end_layout

\begin_layout Subsubsection
מהו אלגוריתם מיון?
\end_layout

\begin_layout Standard
מטרתם של אלגוריתמי מיון היא לקחת כקלט רשימה של איברים ולהחזיר רשימה חדשה
 המסודרת 
\begin_inset Quotes eld
\end_inset

מהקטן לגדול
\begin_inset Quotes erd
\end_inset

.
 הנה כמה דוגמאות לקלטים כאלו:
\end_layout

\begin_layout Enumerate
רשימה של מספרים טבעיים, למשל 
\begin_inset Formula $\left[13,53,5,18\right]$
\end_inset

, כשהפלט הצפוי הוא 
\begin_inset Formula $\left[5,13,18,53\right]$
\end_inset

.
\end_layout

\begin_layout Enumerate
רשימה של קלפי משחק, כשהסדר ביניהם נקבע על בסיס חוקי הברידג', למשל 
\begin_inset Formula $\left[K\diamondsuit,2\spadesuit,5\diamondsuit,8\clubsuit\right]$
\end_inset

 כשהפלט הצפוי הוא 
\begin_inset Formula $\left[8\clubsuit,5\diamondsuit,K\diamondsuit,2\spadesuit\right]$
\end_inset

.
\end_layout

\begin_layout Enumerate
רשימה של כוכבי לכת במערכת השמש כשהסדר ביניהם נקבע על בסיס הקרבה לשמש.
\begin_inset Newline newline
\end_inset

למשל 
\begin_inset Formula $\left[\text{Earth, Jupyter, Mars, Venus}\right]$
\end_inset

 כשהפלט הצפוי הוא 
\begin_inset Formula $\left[\text{Venus, Earth, Mars, Jupyter}\right]$
\end_inset


\end_layout

\begin_layout Standard
בדוגמאות הללו אנו רואים כי זהות האובייקטים שאנו מסדרים יכולה להיות מורכבת,
 וגם הכלל שקובע את הסדר ביניהם עשוי להיות מורכב, אך בכל המקרים שבהם נעסוק
 נניח כי בין כל אברי הקבוצה קיים יחס סדר 
\series bold
לינארי
\series default
, כלומר לכל זוג איברים שונים 
\begin_inset Formula $a,b$
\end_inset

 מתקיים או 
\begin_inset Formula $a<b$
\end_inset

 או 
\begin_inset Formula $b<a$
\end_inset

.
 במדעי המחשב נהוג לבטא את יחס הסדר הזה באמצעות 
\series bold
מפתח
\series default
 שמתואם לכל איבר כך שההשוואה מתבצעת בין המפתחות.
 כך למשל עבור כוכבי לכת, המפתח יהיה מרחקם מהשמש; עבור קלפי משחק ניתן להתאים
 לכל קלף מספר בין
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ל-
\numeric on
52
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באופן ייחודי בהתאם לסדרה שלו ולערכו, וכן הלאה.
\end_layout

\begin_layout Standard
באופן כללי ייתכן שלאיברים שונים יהיו מפתחות זהים.
 דרישה אפשרית אחת מאלגוריתם מיון היא שיהיה 
\series bold
יציב
\series default
, במובן זה שהסדר בין איברים בעלי אותו מפתח לא ישתנה בעקבות הפעלת אלגוריתם
 המיון.
 כל עוד לא נעסוק בדרישה זו נוכל להניח כי לכל האיברים מפתחות שונים )כי עבור
 כל זוג איברים בעלי אותו מפתח אפשר לבחור באופן שרירותי מי יהיה הקטן יותר
 ולשנות את המפתח בהתאם(.
\end_layout

\begin_layout Standard
על מנת לפשט את התיאורים בהמשך נניח שכל המפתחות הם מספרים ממשיים, אך כל מה
 שנציג יהיה תקף לכל קבוצה של מפתחות שהיא סדורה לינארית.
\end_layout

\begin_layout Definition

\series bold
\begin_inset CommandInset label
LatexCommand label
name "def:בעיית המיון"

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "def:תמורה ממיינת"

\end_inset

בעיית המיון
\series default
: בהינתן סדרה של 
\begin_inset Formula $n$
\end_inset

 מספרים ממשיים שונים 
\begin_inset Formula $a=\left(a_{0},\ldots,a_{n-1}\right)$
\end_inset

, בעיית המיון היא בעיית המציאה של התמורה היחידה 
\begin_inset Formula $\pi\in S_{n}$
\end_inset

 המקיימת 
\begin_inset Formula $a_{\pi\left(1\right)}<\ldots<a_{\pi\left(n\right)}$
\end_inset

 )כאשר 
\begin_inset Formula $S_{n}$
\end_inset

 היא קבוצת התמורות על האיברים 
\begin_inset Formula $\left\{ 0,\ldots,n-1\right\} $
\end_inset

( .
 התמורה 
\begin_inset Formula $\pi$
\end_inset

 נקראת 
\series bold
התמורה הממיינת
\series default
 של 
\begin_inset Formula $a$
\end_inset

.
\end_layout

\begin_layout Standard
קיימים אלגוריתמים שעושים שימוש בתכונות ספציפיות של המפתחות על מנת לייעל
 את תהליך המיון.
 כך ניתן לציין את 
\series bold
מיון מניה
\series default
 ואת 
\series bold
מיון בסיס
\series default
 שמתבססים על ההנחה שהמפתחות הם מספרים טבעיים בתחום חסום וידוע, ואת 
\series bold
מיון סלים
\series default
 שמתבסס על ההנחה שהמפתחות הם מספרים ממשיים המתפלגים בצורה אחידה.
 לעת עתה ננתח אלגוריתמים שהשימוש היחיד שלהם במפתחות הוא 
\series bold
בהשוואה
\series default
 של מפתחות של איברים שונים זה לזה.
 במילים אחרות, האלגוריתמים שנציג יתבססו על שתי פעולות בסיס בלבד:
\end_layout

\begin_layout Itemize

\series bold
העתקה
\series default
 של איברים - החלפת המקום של איברים בתוך רשימה קיימת או העתקת איבר מרשימה
 קיימת למקום ברשימה חדשה.
\end_layout

\begin_layout Itemize

\series bold
השוואה
\series default
 של המפתחות של איברים: בהינתן שני איברים 
\begin_inset Formula $x_{i},x_{j}$
\end_inset

, בדיקה האם 
\begin_inset Formula $x_{i}<x_{j}$
\end_inset

 וקבלת תשובה של 
\begin_inset Quotes eld
\end_inset

כן/לא
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
כמו כן על מנת לשמור את הדיון פשוט ככל הניתן, האלגוריתמים שלנו יהיו 
\series bold
דטרמיניסטיים
\series default
 )לא יבצעו הגרלות(.
\end_layout

\begin_layout Subsubsection
עץ השוואות - מבוא אינטואיטיבי
\end_layout

\begin_layout Standard
ניתן לתאר באופן קומפקטי את פעולת אלגוריתם דטרמיניסטי מבוסס השוואות על קלט
 מגודל 
\begin_inset Formula $n$
\end_inset

 בעזרת 
\series bold
עץ
\series default
 המכונה 
\begin_inset Quotes eld
\end_inset

עץ השוואות
\begin_inset Quotes erd
\end_inset

.
 המסלולים בעץ מייצגים ריצות אפשריות שונות של האלגוריתם, וצמתיו הפנימיים
 מייצגים את ההשוואות שאותן ריצות מבצעות.
 העלים כוללים את הפלט של האלגוריתם.
 הנה דוגמא לעץ השוואות אפשרי עבור 
\begin_inset Formula $n=3$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename images/decision_tree.PNG
	scale 50

\end_inset


\end_layout

\begin_layout Standard
האלגוריתם המתואר על ידי האיור פועל על קלט 
\begin_inset Formula $a=\left(a_{0},a_{1},a_{2}\right)$
\end_inset

 באופן הבא: הוא בונה מסלול החל משורש העץ, כך שבכל צומת פנימי בעץ עם הסימון
 
\begin_inset Formula $x_{i}<^{?}x_{j}$
\end_inset

, האלגוריתם בודק האם 
\begin_inset Formula $a_{i}<a_{j}$
\end_inset

.
 אם התשובה היא 
\begin_inset Quotes eld
\end_inset

כן
\begin_inset Quotes erd
\end_inset

, האלגוריתם מוסיף למסלול את הבן הימני של הצומת וממשיך אליו; אם התשובה היא
 
\begin_inset Quotes eld
\end_inset

לא
\begin_inset Quotes erd
\end_inset

 הוא מוסיף למסלול את הבן השמאלי וממשיך אליו.
 כאשר האלגוריתם מגיע לעלה, הוא מוציא פלט בהתאם לסימון של העלה: אם הסימון
 הוא 
\begin_inset Formula $x_{i}<x_{j}<x_{k}$
\end_inset

, הפלט של האלגוריתם הוא הרשימה 
\begin_inset Formula $\left(a_{i},a_{j},a_{k}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
כל מסלול בעץ הוא בעל שלושה צמתים פנימיים ולכן בכל ריצה של האלגוריתם מתבצעות
 שלוש השוואות.
 האם קיים אלגוריתם שיכול להסתפק תמיד רק בשתי השוואות? נראה זאת בהמשך.
\end_layout

\begin_layout Subsubsection
עץ השוואות - הגדרות פורמליות
\end_layout

\begin_layout Standard
נזכיר כי 
\series bold
עץ בינארי
\series default
 
\begin_inset Formula $T$
\end_inset

 הוא גרף מכוון עם שורש 
\begin_inset Formula $r$
\end_inset

 כך שדרגת היציאה של כל צומת היא לכל היותר
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\numeric off
, ואנו משיתים על העץ מבנה נוסף בכך שאנו מבדילים בין 
\begin_inset Quotes eld
\end_inset

בן ימני
\begin_inset Quotes erd
\end_inset

 ובין 
\begin_inset Quotes eld
\end_inset

בן שמאלי
\begin_inset Quotes erd
\end_inset

 של צומת )לכל צומת יש ארבע אפשרויות: או שאין לו בנים כלל, או שיש לו שני
 בנים שאחד ימני והשני שמאלי, או שיש לו ימני בלבד, או שיש לו שמאלי בלבד(.
 עץ בינארי נקרא 
\series bold
מלא
\series default
 אם כל צומת בו הוא בעל דרגת יציאה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
או
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\numeric off
.
\end_layout

\begin_layout Standard
הבנים השמאלי והימני של צומת 
\begin_inset Formula $v$
\end_inset

 )אם הם קיימים( מסומנים על ידי 
\begin_inset Formula $\text{left}\left(v\right),\text{right}\left(v\right)$
\end_inset

 בהתאמה.
 האב של צומת 
\begin_inset Formula $v$
\end_inset

 )אם הוא קיים( מסומן על ידי 
\begin_inset Formula $\text{parent}\left(v\right)$
\end_inset

.
\end_layout

\begin_layout Standard

\series bold
עלה
\series default
 בעץ הוא צומת בעל דרגת יציאה 
\begin_inset Formula $0$
\end_inset

.
\end_layout

\begin_layout Standard

\series bold
גובה העץ
\series default
 
\begin_inset Formula $h\left(T\right)$
\end_inset

 הוא מספר הקשתות המקסימלי במסלול המכוון המחבר את השורש 
\begin_inset Formula $r$
\end_inset

 אל עלה בעץ )דהיינו, האורך המקסימלי של מסלול מכוון בעץ(.
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:מסלול חישוב בעץ השוואות"

\end_inset

יהא 
\begin_inset Formula $n$
\end_inset

 טבעי ויהא 
\begin_inset Formula $T$
\end_inset

 עץ בינארי מלא שבו כל קודקוד פנימי 
\begin_inset Formula $v$
\end_inset

 מתויג על ידי השוואה 
\begin_inset Formula $q\left(v\right)=x_{i}<^{?}x_{j}$
\end_inset

 עבור 
\begin_inset Formula $1\le i,j\le n$
\end_inset

 וכל עלה 
\begin_inset Formula $v$
\end_inset

 מתויג על ידי תמורה 
\begin_inset Formula $\pi\left(v\right)\in S_{n}$
\end_inset

.
 לכל וקטור 
\begin_inset Formula $a=\left(a_{0},\ldots,a_{n-1}\right)\in\mathbb{R}^{n}$
\end_inset

 נגדיר את 
\series bold
מסלול החישוב
\series default
 של 
\begin_inset Formula $a$
\end_inset

 על העץ 
\begin_inset Formula $T$
\end_inset

 בתור הסדרה 
\begin_inset Formula $v_{0},v_{1},\ldots,v_{m}$
\end_inset

 המוגדרת באופן אינדוקטיבי:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
בסיס
\series default
: 
\begin_inset Formula $v_{0}\triangleq r$
\end_inset

 )הסדרה מתחילה בשורש העץ(
\end_layout

\begin_layout Itemize

\series bold
צעד
\series default
: אם 
\begin_inset Formula $v_{k}$
\end_inset

 הוא עלה, הסדרה מסתיימת באיבר זה.
 אחרת 
\begin_inset Formula $v_{k}$
\end_inset

 הוא קודקוד פנימי המתויג על ידי 
\begin_inset Formula $q\left(v_{k}\right)=x_{i}<^{?}x_{j}$
\end_inset

 ונגדיר 
\begin_inset Formula 
\begin{align*}
v_{k+1} & \triangleq\begin{cases}
\text{right}\left(v_{k}\right) & a_{i}<a_{j}\\
\text{left}\left(v_{k}\right) & a_{i}\not<a_{j}
\end{cases}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
נסמן את מסלול החישוב של 
\begin_inset Formula $a$
\end_inset

 על העץ 
\begin_inset Formula $T$
\end_inset

 על ידי 
\begin_inset Formula $\text{Path}_{T}\left(a\right)$
\end_inset

 )נשמיט את 
\begin_inset Formula $T$
\end_inset

 כאשר הוא ברור מהההקשר(.
\end_layout

\end_deeper
\begin_layout Standard
בהגדרה שלעיל אין התחייבות לנכונות של החישוב שמבצע 
\begin_inset Formula $T$
\end_inset

; לשם כך נשתמש בהגדרה נוספת.
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:עץ השוואות למיון"

\end_inset

יהא 
\begin_inset Formula $T$
\end_inset

 עץ מתויג כמו בהגדרה 
\begin_inset CommandInset ref
LatexCommand ref
reference "def:מסלול חישוב בעץ השוואות"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 נאמר ש-
\begin_inset Formula $T$
\end_inset

 הוא 
\series bold
עץ השוואות למיון 
\series default

\begin_inset Formula $n$
\end_inset

 איברים אם לכל 
\begin_inset Formula $a=\left(a_{1},\ldots,a_{n}\right)\in\mathbb{R}^{n}$
\end_inset

 מתקיים שהתמורה הממיינת )הגדרה 
\begin_inset CommandInset ref
LatexCommand ref
reference "def:תמורה ממיינת"
plural "false"
caps "false"
noprefix "false"

\end_inset

( של 
\begin_inset Formula $a$
\end_inset

 שווה ל-
\begin_inset Formula $\pi\left(v_{m}\right)$
\end_inset

, כך ש-
\begin_inset Formula $v_{m}$
\end_inset

 הוא האיבר האחרון בסדרה 
\begin_inset Formula $\text{Path}_{T}\left(a\right)$
\end_inset

 ו-
\begin_inset Formula $\pi\left(v_{m}\right)$
\end_inset

 הוא התיוג של העלה 
\begin_inset Formula $v_{m}$
\end_inset

 בעץ 
\begin_inset Formula $T$
\end_inset

.
\end_layout

\begin_layout Claim
כל אלגוריתם מיון המבוסס על השוואות מגדיר לכל מספר טבעי 
\begin_inset Formula $n$
\end_inset

 עץ השוואות יחיד המתאר את פעולתו על רשימות מאורך 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Standard
לא נוכיח טענה זו פורמלית אך האינטואיציה מאחוריה ברורה: כדי למצוא את עץ ההשוואות
 פשוט נריץ את האלגוריתם מספר פעמים כך שעבור כל השוואה שהאלגוריתם מבצע נראה
 פעם אחת לפחות את תגובתו לתשובת 
\begin_inset Quotes eld
\end_inset

כן
\begin_inset Quotes erd
\end_inset

 ופעם אחת לפחות את תגובתו לתשובת 
\begin_inset Quotes eld
\end_inset

לא
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:סיבוכיות אלגוריתם מיון"

\end_inset

יהא 
\begin_inset Formula $A$
\end_inset

 אלגוריתם מיון.
 
\series bold
סיבוכיות האלגוריתם
\series default
 
\begin_inset Formula $A$
\end_inset

 היא פונקציה 
\begin_inset Formula $c_{A}\left(n\right):\mathbb{N}\to\mathbb{N}$
\end_inset

 המחזירה לכל 
\begin_inset Formula $n$
\end_inset

 את מספר ההשוואות המקסימלי שיבצע 
\begin_inset Formula $A$
\end_inset

 על קלט שהוא רשימה מאורך 
\begin_inset Formula $n$
\end_inset

.
 פורמלית: 
\begin_inset Formula $c_{A}\left(n\right)\triangleq h\left(T\right)$
\end_inset

 כאשר 
\begin_inset Formula $T$
\end_inset

 הוא עץ ההשוואות למיון 
\begin_inset Formula $n$
\end_inset

 איברים שמגדיר 
\begin_inset Formula $A$
\end_inset

.
\end_layout

\begin_layout Standard
נשים לב לכך שהגדרה זו שונה מעט מההגדרות ה
\begin_inset Quotes erd
\end_inset

רגילות
\begin_inset Quotes erd
\end_inset

 של סיבוכיות אלגוריתמים שמודדות שימוש בזמן חישוב או זיכרון; כאן אנחנו מודדים
 בצורה ישירה את 
\series bold
מספר ההשוואות
\series default
 שמבצע האלגוריתם, מתוך הנחה שממילא מספר השוואות זה עומד ביחס ישר עם זמן
 החישוב הכולל של האלגוריתם.
\end_layout

\begin_layout Subsubsection
חסם תחתון לסיבוכיות של אלגוריתמי מיון
\end_layout

\begin_layout Standard
מודל עץ ההשוואות מאפשר לנו לזהות בקלות יחסית את מספר ההשוואות המינימלי שנדרש
 מאלגוריתם מיון.
 ראשית נזכיר תוצאה בסיסית על עצים בינאריים:
\end_layout

\begin_layout Claim
בעץ בינארי מגובה 
\begin_inset Formula $k$
\end_inset

 יש לכל היותר 
\begin_inset Formula $2^{k}$
\end_inset

 עלים.
\end_layout

\begin_layout Proof
באינדוקציה על 
\begin_inset Formula $k$
\end_inset

.
 המקרה של 
\begin_inset Formula $k=0$
\end_inset

 הוא עץ בעל צומת בודד )שהוא גם עלה(.
 ניקח כעת עץ 
\begin_inset Formula $T$
\end_inset

 מעומק 
\begin_inset Formula $k+1$
\end_inset

 ונסיר ממנו את כל העלים.
 נקבל עץ 
\begin_inset Formula $T^{\prime}$
\end_inset

 מעומק 
\begin_inset Formula $k$
\end_inset

 ולכן מהנחת האינדוקציה יש בו לכל היותר 
\begin_inset Formula $2^{k}$
\end_inset

 עלים.
 כעת, כל עלה בעץ 
\begin_inset Formula $T$
\end_inset

 הוא בן של אחד מהעלים בעץ 
\begin_inset Formula $T^{\prime}$
\end_inset

.
 מכיוון שב-
\begin_inset Formula $T^{\prime}$
\end_inset

 יש לכל היותר 
\begin_inset Formula $2^{k}$
\end_inset

 עלים, ולכל עלה כזה יכולים להיות לכל היותר 
\begin_inset Formula $2$
\end_inset

 בנים ב-
\begin_inset Formula $T$
\end_inset

, אז ב-
\begin_inset Formula $T$
\end_inset

 יש לכל היותר 
\begin_inset Formula $2\cdot2^{k}=2^{k+1}$
\end_inset

 עלים.
\end_layout

\begin_layout Standard
כעת, עץ השוואות למיון של 
\begin_inset Formula $n$
\end_inset

 איברים חייב לכלול בעלים שלו כל אחת מ-
\begin_inset Formula $n!$
\end_inset

 התמורות ב-
\begin_inset Formula $S_{n}$
\end_inset

, כי אם חסרה תמורה 
\begin_inset Formula $\sigma\in S_{n}$
\end_inset

 אז העץ לא יחזיר תשובה נכונה על הקלט 
\begin_inset Formula $a=\left(\sigma\left(0\right),\ldots,\sigma\left(n-1\right)\right)$
\end_inset

.
 בשילוב עם הטענה על הקשר בין גובה של עץ בינארי ומספר העלים שלו נקבל שכל
 עץ השוואות למיון 
\begin_inset Formula $n$
\end_inset

 איברים 
\begin_inset Formula $T$
\end_inset

 מקיים 
\begin_inset Formula $n!\le2^{h\left(T\right)}$
\end_inset

, כלומר 
\begin_inset Formula $\lg\left(n!\right)\le h\left(T\right)$
\end_inset

 )
\begin_inset Formula $\lg$
\end_inset

 הוא סימון מקוצר של 
\begin_inset Formula $\log_{2}$
\end_inset

(.
\end_layout

\begin_layout Standard
אפשר להעריך את 
\begin_inset Formula $\lg\left(n!\right)$
\end_inset

 בעזרת 
\series bold
נוסחת סטירלינג
\series default
, 
\begin_inset Formula $n!\sim\sqrt{2\pi n}\left(\frac{n}{e}\right)^{n}$
\end_inset

, אבל ניתן לקבל חסם תחתון על 
\begin_inset Formula $\lg\left(n!\right)$
\end_inset

 בצורה פשוטה יותר.
\end_layout

\begin_layout Standard
ראשית, נזכור כי 
\begin_inset Formula $\lg\left(x\right)=\frac{\ln x}{\ln2}$
\end_inset

 ולכן מספיק למצוא חסם על 
\begin_inset Formula $\ln\left(n!\right)$
\end_inset

 ולכפול בקבוע 
\begin_inset Formula $\ln2$
\end_inset

 - זה לא משנה את החסם האסימפטוטי.
\end_layout

\begin_layout Standard
שנית, 
\begin_inset Formula $\ln\left(n!\right)=\sum_{j=1}^{n}\ln\left(j\right)=\sum_{j=2}^{n}\ln\left(j\right)$
\end_inset

, לכן מספיק שנמצא חסם תחתון על הסכום הזה.
\end_layout

\begin_layout Standard
מכיוון ש-
\begin_inset Formula $\ln$
\end_inset

 היא פונקציה מונוטונית עולה וחיובית בקטע 
\begin_inset Formula $[1,\infty)$
\end_inset

 ניתן לתת לסכום חסם בעזרת התבססות על הגדרת האינטגרל בעזרת 
\series bold
סכומי דארבו
\series default
: נחלק את הקטע 
\begin_inset Formula $\left[1,n\right]$
\end_inset

 ל-
\begin_inset Formula $n-1$
\end_inset

 אינטרוולים מאורך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)
\begin_inset Formula $\left[1,2\right],\left[2,3\right],\ldots,\left[n-1,n\right]$
\end_inset

(.
 ערך הפונקציה 
\begin_inset Formula $\ln$
\end_inset

 על נקודת הקצה 
\series bold
הימנית
\series default
 של הקטע היא חסם עליון לערכה בקטע כולו, ומכאן שמתקיים
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\sum_{j=2}^{n}\ln j & \ge\int_{1}^{n}\ln xdx\\
 & =\left[x\ln x-x\right]_{1}^{n}\\
 & =n\ln n-n+1\\
 & =\Omega\left(n\log n\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
קיבלנו כי 
\begin_inset Formula $h\left(T\right)=\Omega\left(n\log n\right)$
\end_inset

 עבור 
\series bold
כל
\series default
 עץ השוואות עבור 
\begin_inset Formula $n$
\end_inset

 איברים, ומכאן ש-
\begin_inset Formula $c_{A}\left(n\right)=\Omega\left(n\log n\right)$
\end_inset

 עבור 
\series bold
כל
\series default
 אלגוריתם מיון מבוסס השוואות בלבד.
 בהמשך נראה אלגוריתמי מיון שאכן מממשים את החסם התחתון הזה.
\end_layout

\begin_layout Subsection
מיון הכנסה
\end_layout

\begin_layout Subsubsection
תיאורו של מיון הכנסה
\end_layout

\begin_layout Standard
מיון הכנסה אינו אלגוריתם יעיל במיוחד במימוש על ידי מחשב, אבל הוא טבעי יחסית
 לבני אדם ורבים משתמשים בו כדי למיין יד של קלפים, למשל.
 אינטואטיבית, בכל שלב מרימים קלף חדש, מוצאים את המקום שמתאים לו ביד )בין
 אילו שני קלפים להכניס אותו או האם לשים אותו בהתחלה/בסוף(, מכניסים אותו
 ועוברים לקלף הבא.
\end_layout

\begin_layout Standard
במימוש אלגוריתמי, המיון יפעל כך על רשימה 
\begin_inset Formula $\left(a_{0},a_{1},\ldots,a_{n-1}\right)$
\end_inset

: על האיבר הראשון 
\begin_inset Formula $a_{0}$
\end_inset

 נחשוב כאילו הוא לבדו מהווה רשימה ממויינת.
 כעת נניח באינדוקציה שכל האיברים 
\begin_inset Formula $a_{0},a_{1},\ldots,a_{k-1}$
\end_inset

 כבר ממויינים ב-
\begin_inset Formula $k$
\end_inset

 המקומות הראשונים ברשימה, ונתבונן על האיבר הבא, 
\begin_inset Formula $a_{k}$
\end_inset

.
 כל עוד הוא קטן מהאיבר שבא מייד לפניו ברשימה, נחליף ביניהם; נעצור כאשר 
\begin_inset Formula $a_{k}$
\end_inset

 יגיע לראשית הרשימה )במקרה שבו הוא הקטן ביותר מבין 
\begin_inset Formula $k+1$
\end_inset

 האיברים הראשונים( או כאשר האיבר שלפניו קטן ממנו.
\end_layout

\begin_layout Standard
בשיטה זו, האלגוריתם אינו זקוק למקום נוסף כדי למיין את הרשימה - המיון מתבצע
 
\series bold
במקום
\series default
 )
\lang english
In-Place
\lang hebrew
(, תוך שינוי הרשימה שהתקבלה כקלט )אפשר לשמר את הרשימה המקורית על ידי יצירת
 עותק שלה והפעלת המיון על העותק(.
\end_layout

\begin_layout Standard
בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
האלגוריתם נראה כך:
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,basicstyle={\ttfamily},frame=tlrb"
inline false
status open

\begin_layout Plain Layout

1 def insertion_sort(a):
\end_layout

\begin_layout Plain Layout

2    for k in range(1, len(a)):
\end_layout

\begin_layout Plain Layout

3        key = a[k]
\end_layout

\begin_layout Plain Layout

4        i = k - 1
\end_layout

\begin_layout Plain Layout

5        while i >= 0 and a[i] > key:
\end_layout

\begin_layout Plain Layout

6            a[i+1] = a[i]
\end_layout

\begin_layout Plain Layout

7            i = i - 1
\end_layout

\begin_layout Plain Layout

8        a[i+1] = key
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
הסיבוכיות של מיון הכנסה
\end_layout

\begin_layout Standard
מהי סיבוכיות האלגוריתם, שנסמן 
\begin_inset Formula $c_{\text{IS}}\left(n\right)$
\end_inset

? כפי שראינו, המקרה הגרוע ביותר מבחינת האלגוריתם הוא זה שבו 
\begin_inset Formula $a_{k}$
\end_inset

 קטן מכל האיברים שלפניו, כי אז מספר ההשוואות הוא הגדול ביותר.
 כלומר, הקלט הגרוע ביותר מבחינת האלגוריתם הוא הרשימה 
\begin_inset Formula $\left(n,n-1,n-2,\ldots,1\right)$
\end_inset

.
 בעזרת קלט זה נוכל לחשב במדויק את הסיבוכיות:
\end_layout

\begin_layout Theorem
\begin_inset Formula $c_{\text{IS}}\left(n\right)={n \choose 2}$
\end_inset


\end_layout

\begin_layout Proof
בריצת האלגוריתם על רשימה מאורך 
\begin_inset Formula $n$
\end_inset

, הלולאה החיצונית )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\numeric off
( מתבצעת בדיוק 
\begin_inset Formula $n-1$
\end_inset

 פעמים עבור הערכים 
\begin_inset Formula $k\in\left\{ 1,2,\ldots,n-1\right\} $
\end_inset

.
 עבור הערך 
\begin_inset Formula $k$
\end_inset

 מתבצעות לכל היותר 
\begin_inset Formula $k$
\end_inset

 השוואות )בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\numeric off
, עם האיברים במקומוות ה-
\begin_inset Formula $0,1,\ldots,k-1$
\end_inset

( כך שהאלגוריתם מבצע לכל היותר 
\begin_inset Formula $1+2+\ldots+n-1=\frac{n\left(n-1\right)}{2}={n \choose 2}$
\end_inset

 השוואות ומכאן 
\begin_inset Formula $c_{\text{IS}}\left(n\right)\le{n \choose 2}$
\end_inset

.
\end_layout

\begin_layout Proof
מצד שני, על הקלט 
\begin_inset Formula $\left(n,n-1,n-2,\ldots,1\right)$
\end_inset

 אכן מתבצעות בדיוק 
\begin_inset Formula $k$
\end_inset

 השוואות בשלב 
\begin_inset Formula $k$
\end_inset

 ולכן 
\begin_inset Formula $c_{\text{IS}}\left(n\right)\ge{n \choose 2}$
\end_inset

 )כי החישוב על קלט זה הוא דוגמא אחת למסלול בעץ ולכן לחסם תחתון על עומק העץ(.
\end_layout

\begin_layout Proof
משני אלו נסיק את 
\begin_inset Formula $c_{\text{IS}}\left(n\right)={n \choose 2}$
\end_inset

 כמבוקש.
\end_layout

\begin_layout Standard
אסימפטוטית, זמן ריצה זה הוא 
\begin_inset Formula $\Theta\left(n^{2}\right)$
\end_inset

, שאינו נחשב לזמן ריצה טוב במיוחד.
 ישנם אלגוריתמי מיון שזוהי סיבוכיות זמן הריצה שלהם ועדיין נחשבים טובים בזכות
 ריצה מהירה במקרה 
\series bold
הממוצע
\series default
 )למשל, האלגוריתם 
\series bold
מיון-מהיר
\series default
( אך לא נציג גישה זו כאן.
\end_layout

\begin_layout Subsection
מיון מיזוג
\end_layout

\begin_layout Subsubsection
תיאורו של מיון מיזוג
\end_layout

\begin_layout Standard
כפי שראינו, מיון הכנסה הוא אלגוריתם איטי למדי.
 על קלט שהוא רשימה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1,000,000
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
איברים )סדר גודל ריאליסטי( הוא עלול להזדקק ל-
\begin_inset Formula ${10^{6} \choose 2}\approx500,000,000,000$
\end_inset

 השוואות - מספר מופרז לגמרי.
 זאת מכיוון שהגודל המקורי של הרשימה הוכפל ב-
\begin_inset Formula $\frac{1,000,000}{2}$
\end_inset

 בערך.
 האם ניתן לצמצם מאוד את המספר בו מכפילים, למשל, להכפיל רק ב-
\numeric on
40
\numeric off
? התשובה היא חיובית ודוגמא לאלגוריתם שמבצע את הקסם הזה ורץ בסיבוכיות 
\begin_inset Formula $O\left(n\lg n\right)$
\end_inset

 היא 
\series bold
מיון מיזוג
\series default
 שנציג כעת.
\end_layout

\begin_layout Standard
מיון מיזוג הוא דוגמא טיפוסית לאלגוריתם שפועל בשיטת 
\series bold
הפרד ומשול
\series default
 - הוא מחלק את הקלט שלו לשני חלקים מגודל זהה וממיין כל אחד מהחלקים הללו
 בנפרד )על ידי קריאה רקורסיבית לעצמו(.
 לאחר מכן הוא 
\series bold
ממזג
\series default
 את שתי הרשימות הממויינות לרשימה ממויינת אחת.
 הביצוע היעיל של שלב מיזוג זה הוא המפתח ליעילות האלגוריתם.
\end_layout

\begin_layout Standard
נעסוק אם כן בשאלה הבאה: בהינתן שתי רשימות 
\series bold
ממוינות
\series default
 
\begin_inset Formula $a=\left(a_{0},a_{1},\ldots,a_{n-1}\right)$
\end_inset

 ו-
\begin_inset Formula $b=\left(b_{0},b_{1},\ldots,b_{m-1}\right)$
\end_inset

 אנו רוצים לחשב את הרשימה הממוינת 
\begin_inset Formula $c=\left(c_{0},c_{1},\ldots,c_{n+m-1}\right)$
\end_inset

 שאבריה הן בדיוק אברי שתי הרשימות 
\begin_inset Formula $a,b$
\end_inset

, כלומר 
\begin_inset Formula $\left\{ c_{0},\ldots,c_{n+m-1}\right\} =\left\{ a_{0},\ldots,a_{n-1}\right\} \cup\left\{ b_{0},\ldots,b_{m-1}\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
המיזוג מתבצע בצורה אינטואיטיבית: אפשר לחשוב על עלייה של אנשים למטוס, כך
 שבעלי המקומות המרוחקים יותר נכנסים קודם.
 נניח כי יש לנו שני תורים שבהם האנשים כבר עומדים בצורה ממויינת.
 בכל רגע נתון בודקים את מספר המקום של שני האנשים שבראש התור ומכניסים אל
 המטוס את זה מביניהם שאמור להיכנס קודם.
 אל ראש התור של האדם שנכנס מגיע אדם חדש וכעת משווים אותו עם האדם שבראש התור
 השני וכן הלאה.
 בסופו של דבר אחרי שתור אחד מתרוקן נותנים לאנשים בתור השני להיכנס לפי הסדר,
 בלי צורך בהשוואות נוספות.
\end_layout

\begin_layout Standard
במימוש במחשב נפעל כך: בכל שלב אנו מחזיקים את האינדקסים של האיברים הקטנים
 ביותר ב-
\begin_inset Formula $a,b$
\end_inset

 שטרם הכנסנו אל 
\begin_inset Formula $c$
\end_inset

, משווים את שני האיברים הללו, מכניסים אל 
\begin_inset Formula $c$
\end_inset

 את הקטן יותר ומקדמים את האינדקס של הסדרה של האיבר שהכנסנו.
 כאשר בשלב מסויים אחת הרשימות מתרוקנת )דהיינו, האינדקס שלה עובר את האיבר
 האחרון בה( אנחנו עוברים להכנסה סדרתית של אברי הרשימה השניה.
\end_layout

\begin_layout Standard
בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
האלגוריתם נראה כך:
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,basicstyle={\ttfamily},frame=tlrb"
inline false
status open

\begin_layout Plain Layout

1  def merge(a,b):
\end_layout

\begin_layout Plain Layout

2      n = len(a)
\end_layout

\begin_layout Plain Layout

3      m = len(b)
\end_layout

\begin_layout Plain Layout

4      i, j = 0, 0
\end_layout

\begin_layout Plain Layout

5      c = []
\end_layout

\begin_layout Plain Layout

6      while i < n and j < m:
\end_layout

\begin_layout Plain Layout

7          if a[i] < b[j]:
\end_layout

\begin_layout Plain Layout

8              c.append(a[i])
\end_layout

\begin_layout Plain Layout

9              i = i + 1
\end_layout

\begin_layout Plain Layout

10         else:
\end_layout

\begin_layout Plain Layout

11             c.append(b[j])
\end_layout

\begin_layout Plain Layout

12             j = j + 1    
\end_layout

\begin_layout Plain Layout

13     if i == n:
\end_layout

\begin_layout Plain Layout

14         while j < m:
\end_layout

\begin_layout Plain Layout

15             c.append(b[j])
\end_layout

\begin_layout Plain Layout

16             j = j + 1
\end_layout

\begin_layout Plain Layout

17     else:
\end_layout

\begin_layout Plain Layout

18         while i < n:
\end_layout

\begin_layout Plain Layout

19             c.append(a[i])
\end_layout

\begin_layout Plain Layout

20             i = i + 1
\end_layout

\begin_layout Plain Layout

21     return c
\end_layout

\end_inset


\end_layout

\begin_layout Standard
שורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6-12
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אחראיות לשלב הראשון של המיזוג שבו טרם רוקנו אף אחת מהרשימות; שורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
13-16
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מכסות את המקרה שבו הרשימה 
\begin_inset Formula $a$
\end_inset

 התרוקנה ושורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
17-20
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מכסות את המקרה שבו הרשימה 
\begin_inset Formula $b$
\end_inset

 ריקה.
\end_layout

\begin_layout Standard
נשים לב כי באופן שבו מימשנו את האלגוריתם, הוא יוצר רשימה חדשה 
\begin_inset Formula $c$
\end_inset

 ומחזיר אותה; אנחנו לא מבצעים מיון 
\begin_inset Quotes eld
\end_inset

במקום
\begin_inset Quotes erd
\end_inset

 כפי שקרה במיון מיזוג.
\end_layout

\begin_layout Standard
כעת נשתמש בפונקציה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
merge
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שהגדרנו כדי לממש את אלגוריתם מיון מיזוג המלא.
 להבדיל מהמימוש הארוך יחסית של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
merge
\lang hebrew
, המיון כולו ניתן לתיאור קומפקטי, כי המורכבות שלו מוחבאת בתוך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
merge
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ובתוך הקריאה הרקורסיבית, וכל שנותר לו לעשות הוא 
\begin_inset Quotes eld
\end_inset

ניהול חשבונות
\begin_inset Quotes erd
\end_inset

 - לבדוק אם אנחנו במקרה הקצה של רשימה ריקה או בת איבר אחד )ואז ניתן להחזיר
 אותה(, לפרק את הרשימה לשתי רשימות ולמיין אותן רקורסיבית, ואז למזג את התוצאה:
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,basicstyle={\ttfamily},frame=tlrb"
inline false
status open

\begin_layout Plain Layout

1 def merge_sort(a):
\end_layout

\begin_layout Plain Layout

2     n = len(a)
\end_layout

\begin_layout Plain Layout

3     if n == 0 or n == 1:
\end_layout

\begin_layout Plain Layout

4         return a
\end_layout

\begin_layout Plain Layout

5     k = n // 2
\end_layout

\begin_layout Plain Layout

6     b = merge_sort(a[:k])
\end_layout

\begin_layout Plain Layout

7     c = merge_sort(a[k:])
\end_layout

\begin_layout Plain Layout

8     return merge(b,c) 
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מחושב אינדקס 
\begin_inset Quotes eld
\end_inset

אמצע
\begin_inset Quotes erd
\end_inset

 הרשימה, 
\begin_inset Formula $k=\left\lfloor \frac{n}{2}\right\rfloor $
\end_inset

.
 
\end_layout

\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נבנית תת-הרשימה 
\begin_inset Formula $b=\left(a_{0},a_{1},\ldots,a_{k-1}\right)$
\end_inset

.
\end_layout

\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נבנית תת-הרשימה 
\begin_inset Formula $c=\left(a_{k},a_{k+1},\ldots,a_{n-1}\right)$
\end_inset

.
\end_layout

\begin_layout Subsubsection
הסיבוכיות של מיון מיזוג
\end_layout

\begin_layout Standard
הסיבוכיות של מיון מיזוג מתקבלת משילוב של שני מרכיבים: ניתוח הסיבוכיות של
 הפונקציה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
merge
\lang hebrew
, וניתוח הסיבוכיות של הקריאה הרקורסיבית.
 נתחיל עם הפונקציה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
merge
\lang hebrew
.
\end_layout

\begin_layout Claim
נסמן ב-
\begin_inset Formula $c_{M}\left(n,m\right)$
\end_inset

 את הסיבוכיות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
merge
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על רשימות מאורכים 
\begin_inset Formula $n,m$
\end_inset

.
 אז 
\begin_inset Formula $c_{M}\left(n,m\right)\le n+m-1$
\end_inset


\end_layout

\begin_layout Proof
בתוך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
merge
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעת השוואה רק בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\numeric off
, כחלק מהלולאה המרכזית.
 הלולאה הזו מתחילה כאשר 
\begin_inset Formula $i=0,j=0$
\end_inset

 ומסתיימת כאשר 
\begin_inset Formula $i=n-1$
\end_inset

 או 
\begin_inset Formula $j=m-1$
\end_inset

, ובכל איטרציה שלה מגדילים ב-
\numeric on
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
או את 
\begin_inset Formula $i$
\end_inset

 או את 
\begin_inset Formula $j$
\end_inset

.
\end_layout

\begin_layout Proof
נתבונן על המספר 
\begin_inset Formula $i+j$
\end_inset

.
 המספר הזה שווה בתחילת הלולאה ל-
\begin_inset Formula $0+0=0$
\end_inset

 ובסוף הלולאה הוא קטן או שווה ל\SpecialChar softhyphen

\begin_inset Formula $\left(m-1\right)+\left(n-1\right)=n+m-2$
\end_inset

.
 כמו כן, בכל איטרציה 
\begin_inset Formula $i+j$
\end_inset

 גדל בדיוק ב-
\numeric on
1
\numeric off
.
 לכן מספר האיטרציות הכולל )ומכאן גם מספר ההשוואות הכולל( הוא לכל היותר 
\begin_inset Formula $n+m-1$
\end_inset

 )עבור הערכים 
\begin_inset Formula $0,1,2,\ldots,n+m-2$
\end_inset

 של 
\begin_inset Formula $i+j$
\end_inset

(.
\end_layout

\begin_layout Standard
נעבור אל מיון מיזוג עצמו:
\end_layout

\begin_layout Theorem
נסמן ב-
\begin_inset Formula $c_{MS}\left(n\right)$
\end_inset

 את הסיבוכיות של מיון מיזוג על רשימה מאורך 
\begin_inset Formula $n$
\end_inset

, אז 
\begin_inset Formula $c_{MS}\left(n\right)=O\left(n\log n\right)$
\end_inset


\end_layout

\begin_layout Proof
ראשית נשים לב לכך שעבור 
\begin_inset Formula $n>1$
\end_inset

 ניתן לחסום את הסיבוכיות של מיון מיזוג על ידי סכום הסיבוכיות של שתי ההפעלות
 הרקורסיביות שלו ועוד פעולת המיזוג:
\begin_inset Formula 
\begin{align*}
c_{MS}\left(n\right) & \le c_{MS}\left(\left\lfloor \frac{n}{2}\right\rfloor \right)+c_{MS}\left(\left\lceil \frac{n}{2}\right\rceil \right)+c_{M}\left(\left\lfloor \frac{n}{2}\right\rfloor ,\left\lceil \frac{n}{2}\right\rceil \right)\\
 & \le2c_{MS}\left(\left\lceil \frac{n}{2}\right\rceil \right)+\left(\left\lfloor \frac{n}{2}\right\rfloor +\left\lceil \frac{n}{2}\right\rceil -1\right)\\
 & \le2c_{MS}\left(\left\lceil \frac{n}{2}\right\rceil \right)+n-1
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
נשתמש באי השוויון שקיבלנו כדי להוכיח באינדוקציה שלכל 
\begin_inset Formula $k$
\end_inset

 טבעי מתקיים 
\begin_inset Formula $c_{MS}\left(2^{k}\right)\le k\cdot2^{k}$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Itemize
בסיס: עבור 
\begin_inset Formula $k=0$
\end_inset

, 
\begin_inset Formula $c_{MS}\left(2^{k}\right)-c_{MS}\left(1\right)=0$
\end_inset

 כי במקרה זה המיון מחזיר מייד את המערך ללא ביצוע השוואות )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באלגוריתם(.
\end_layout

\begin_layout Itemize
צעד: נניח כי 
\begin_inset Formula $c_{MS}\left(2^{k}\right)\le k\cdot2^{k}$
\end_inset

.
 כעת:
\begin_inset Formula 
\begin{align*}
c_{MS}\left(2^{k+1}\right) & \le2c_{MS}\left(2^{k}\right)+2^{k+1}-1\\
 & \le2\cdot k\cdot2^{k}+2^{k+1}-1\\
 & \le k\cdot2^{k+1}+2^{k+1}\\
 & \le\left(k+1\right)\cdot2^{k+1}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
כמבוקש.
 
\end_layout

\end_deeper
\begin_layout Proof
כעת יהא 
\begin_inset Formula $n$
\end_inset

 כלשהו.
 אז קיים 
\begin_inset Formula $k$
\end_inset

 טבעי כך ש-
\begin_inset Formula $2^{k-1}<n\le2^{k}$
\end_inset

, ולכן 
\begin_inset Formula $2^{k}<2n$
\end_inset

, כלומר 
\begin_inset Formula $k<\lg\left(2n\right)=\lg n+1$
\end_inset

, וכעת:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
c_{MS}\left(n\right) & \le c_{MS}\left(2^{k}\right)\\
 & \le k\cdot2^{k}\\
 & <\left(\lg n+1\right)2n\\
 & =2n\lg n+2n
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
ומכאן שסיבוכיות מיון מיזוג היא 
\begin_inset Formula $O\left(n\log n\right)$
\end_inset

, כנדרש.
 
\end_layout

\begin_layout Standard
אם נצרף לחסם הסיבוכיות העליון את החסם התחתון 
\begin_inset Formula $\Omega\left(n\log n\right)$
\end_inset

 שהוכחנו באופן כללי עבור אלגוריתמי מיון מבוססי השוואות, נראה שסיבוכיות מיון
 מיזוג היא 
\begin_inset Formula $\Theta\left(n\log n\right)$
\end_inset

.
 על פניו מדובר על סיבוכיות אופטימלית, ואכן מיון מיזוג הוא מיון טוב למדי,
 אבל יש לזכור שבמציאות יש שיקולים נוספים בנוסף לסיבוכיות האסימפטוטית של
 המקרה הגרוע ביותר )האלגוריתם 
\series bold
מיון מהיר
\series default
 שלא יילמד בקורס הוא בעל סיבוכיות 
\begin_inset Formula $\Theta\left(n^{2}\right)$
\end_inset

 במקרה הגרוע אבל בפועל מביס על פי רוב את מיון מיזוג(.
\end_layout

\begin_layout Subsection
מיון ערימה
\end_layout

\begin_layout Subsubsection
מבוא אינטואיטיבי
\end_layout

\begin_layout Standard
מיון ערימה הוא אלגוריתם מיון יעיל בעל סיבוכיות 
\begin_inset Formula $\Theta\left(n\log n\right)$
\end_inset

 בדומה למיון מיזוג, אך להבדיל ממיון מיזוג הוא מבוצע כולו 
\series bold
במקום
\series default
 )כלומר, בלי שימוש בזכרון נוסף(.
 הקסם הזה מתבצע באמצעות שימוש חכם במבנה נתונים הנקרא 
\series bold
ערימה 
\series default
)
\lang english
Heap
\lang hebrew
(.
\end_layout

\begin_layout Standard
במיון מיזוג, היו לנו שני 
\begin_inset Quotes eld
\end_inset

תורים
\begin_inset Quotes erd
\end_inset

 ממוינים של איברים ובכל שלב הוספנו אחד מהם לרשימה הממויינת וקידמנו את התור.
 בערימה יש לנו 
\series bold
עץ בינארי
\series default
 שאיננו ממויין אבל 
\series bold
כל מסלול
\series default
 בו ממוין.
 בכל שלב, השורש של העץ הוא האיבר הגדול ביותר שנותר בו, וניתן להוציא את השורש,
 להכניס אותו לרשימה הממויינת ואז לבצע 
\begin_inset Quotes eld
\end_inset

תיקון
\begin_inset Quotes erd
\end_inset

 של העץ שמפעפע אל השורש שלו את האיבר הגדול ביותר בו.
\end_layout

\begin_layout Standard
האלגורים פועל בשני שלבים:
\end_layout

\begin_layout Enumerate
שלב בניית הערימה: בשלב זה לוקחים את רשימת האיברים המבולגנת ויוצרים בתוכה
 את הסדר החלקי שמתקיים בתוך ערימה.
 שלב זה דורש רק 
\begin_inset Formula $O\left(n\right)$
\end_inset

 השוואות.
\end_layout

\begin_layout Enumerate
שלב המיון: בשלב זה חוזרים שוב ושוב על הצעד הבא: שולפים מראש הערימה את האיבר
 הגדול ביותר ומתקנים את הערימה בהתאם.
 
\begin_inset Quotes eld
\end_inset

שליפה
\begin_inset Quotes erd
\end_inset

 כזו ותיקון הערימה בהתאם דורשת רק 
\begin_inset Formula $O\left(\log n\right)$
\end_inset

 השוואות ומכיוון שחוזרים עליה 
\begin_inset Formula $n$
\end_inset

 פעמים, מקבלים סיבוכיות של 
\begin_inset Formula $O\left(n\log n\right)$
\end_inset

.
\end_layout

\begin_layout Subsubsection
ערימה וייצוג שלה באמצעות מערך
\end_layout

\begin_layout Standard
נפתח בהגדרה פורמלית:
\end_layout

\begin_layout Definition

\series bold
ערימה
\series default
 היא עץ בינארי 
\begin_inset Formula $T$
\end_inset

 שצמתיו ניתנים להשוואה כך שלכל צומת 
\begin_inset Formula $v\in T$
\end_inset

 שאינו השורש מתקיים 
\begin_inset Formula $v\le\text{parent}\left(v\right)$
\end_inset

.
\end_layout

\begin_layout Standard
בפרט, משמעות ההגדרה היא שבכל מסלול מעלה בעץ חזרה אל השורש, הצמתים ממויינים
 בסדר עולה.
\end_layout

\begin_layout Standard
ניתן לייצג עצים בשלל דרכים במחשב, אך מכיוון שמטרתנו כאן היא מיון יעיל של
 מערך, נציג אופן שבו אפשר לחשוב על מערך 
\begin_inset Formula $\left(a_{1},a_{2},\ldots,a_{n}\right)$
\end_inset

 בתור ייצוג של עץ בינארי.
 בגישה זו, הבנים של הצומת 
\begin_inset Formula $a_{i}$
\end_inset

 יהיו 
\begin_inset Formula $a_{2i}$
\end_inset

 ו-
\begin_inset Formula $a_{2i+1}$
\end_inset

, ואילו ההורה של הצומת 
\begin_inset Formula $a_{i}$
\end_inset

 יהיה 
\begin_inset Formula $a_{\left\lfloor \frac{i}{2}\right\rfloor }$
\end_inset

.
\end_layout

\begin_layout Standard
נשים לב שכדי שהתעלול המספרי יעבוד, התחלנו את המערך מ-
\begin_inset Formula $a_{1}$
\end_inset

 ולא מ-
\begin_inset Formula $a_{0}$
\end_inset

, כרגיל.
 כאשר נכתוב קוד מחשב נצטרך להתייחס בצורה כלשהי לכך שכן בדרך כלל מערכים מתחילים
 מאינדקס
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\numeric off
.
\end_layout

\begin_layout Standard
בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נוכל להשתמש בפונקציות הבאות כדי לבצע את האבסטרקציה הזו:
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,basicstyle={\ttfamily},frame=tlrb"
inline false
status open

\begin_layout Plain Layout

1 def left(i):
\end_layout

\begin_layout Plain Layout

2     return 2*i + 1
\end_layout

\begin_layout Plain Layout

3 def right(i):
\end_layout

\begin_layout Plain Layout

4     return 2*i + 2
\end_layout

\begin_layout Plain Layout

5 def parent(i):
\end_layout

\begin_layout Plain Layout

6     return (i-1) // 2
\end_layout

\end_inset


\end_layout

\begin_layout Standard
איננו מציגים כאן אופטימיזציות שניתן לבצע במימוש האלגוריתם )למשל, אפשר לתאר
 את הפעולות לעיל בתור פעולות על סיביות בודדות, כך למשל כפל ב-
\numeric on
2
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
או חלוקה ב-
\numeric on
2
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הן פעולות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
shift
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של סיביות( אלא מסתפקים בהבנת הרעיון שמאחורי האלגוריתם עצמו.
\end_layout

\begin_layout Standard

\series bold
איור
\end_layout

\begin_layout Standard
כפי שניתן לראות, הערימה מיוצגת כך: האיבר הראשון במערך הוא השכבה הראשונה
 של הץ.
 שני האיברים הבאים הם השכבה הבאה, וכן הלאה.
 השכבה האחרונה בעץ מיוצגת על ידי רצף האיברים האחרונים במערך.
 לכן, אם נקטין את המערך באיבר בודד, הדבר יתבטא בהסרת עלה מהעץ.
 ניעזר בכך בהמשך, כאשר נעביר לסוף המערך את האיברים שכבר מוינו ונקטין את
 הערימה בהתאם.
\end_layout

\begin_layout Standard
עץ בינארי שבנוי בשכבות כאלו, כך שכל השכבות מלאות פרט אולי לאחרונה, נקרא
 
\series bold
עץ בינארי כמעט שלם
\series default
.
\end_layout

\begin_layout Subsubsection
שמירה על תכונת הערימה
\end_layout

\begin_layout Standard
\begin_inset Quotes eld
\end_inset

תכונת הערימה
\begin_inset Quotes erd
\end_inset

 היא התכונה שתיארנו קודם - כל צומת בערימה גדול מבניו.
 גם בשלב הבניה הראשוני של הערימה וגם בשלב הוצאת האיברים לצורך המיון, הכלי
 המרכזי שלנו יהיה פונקציה ש
\begin_inset Quotes erd
\end_inset

מתקנת
\begin_inset Quotes erd
\end_inset

 ערימה שהיא תקינה למעט אולי האפשרות שהשורש שלה 
\series bold
קטן
\series default
 מאחד מבניו.
 תיקון של בעיה כזו מבוצע באופן רקורסיבי: השורש מוחלף עם הבן הגדול יותר,
 וכעת נותר לתקן את תת-הערימה של אותו בן.
 בצורה הזו השורש המקורי של הערימה 
\begin_inset Quotes eld
\end_inset

מפועפע
\begin_inset Quotes erd
\end_inset

 לתחתית הערימה עד שהוא נעצר במקום שבו הוא גדול משני בניו - באופן שמזכיר
 את מיון הכנסה.
 מכיוון שבעץ עם 
\begin_inset Formula $n$
\end_inset

 צמתים עומק העץ הוא 
\begin_inset Formula $\Theta\left(\log n\right)$
\end_inset

, שלב ה
\begin_inset Quotes erd
\end_inset

פעפוע
\begin_inset Quotes erd
\end_inset

 הזה הוא קצר יחסית.
\end_layout

\begin_layout Standard
בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נממש את הפונקציה הזו בצורה הבאה:
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "language=Python,basicstyle={\ttfamily},frame=tlrb"
inline false
status open

\begin_layout Plain Layout

1  def heapify(a, i, n):
\end_layout

\begin_layout Plain Layout

2      children = []
\end_layout

\begin_layout Plain Layout

3      left_child = left(i)
\end_layout

\begin_layout Plain Layout

4      right_child = right(i)
\end_layout

\begin_layout Plain Layout

5      max_child_value = None
\end_layout

\begin_layout Plain Layout

6      max_child_index = None
\end_layout

\begin_layout Plain Layout

7      if left_child < n:
\end_layout

\begin_layout Plain Layout

8          max_child_value = a[left_child]
\end_layout

\begin_layout Plain Layout

9          max_child_index = left_child
\end_layout

\begin_layout Plain Layout

10     if right_child < n and (max_child_value is None 
\end_layout

\begin_layout Plain Layout

                               or max_child_value < a[right_child]):
\end_layout

\begin_layout Plain Layout

11         max_child_value = a[right_child]
\end_layout

\begin_layout Plain Layout

12         max_child_index = right_child
\end_layout

\begin_layout Plain Layout

13     if max_child_value is not None and a[i] < max_child_value:
\end_layout

\begin_layout Plain Layout

14         a[i], a[max_child_index] = max_child_value, a[i]
\end_layout

\begin_layout Plain Layout

15         heapify(a, max_child_index, n)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
הפונקציה מקבלת שלושה קלטים: את המערך 
\begin_inset Formula $a$
\end_inset

, את האינדקס 
\begin_inset Formula $i$
\end_inset

 של הצומת שנמצא בשורש תת-הערימה שאנחנו רוצים לתקן, ואת הגודל 
\begin_inset Formula $n$
\end_inset

 של הערימה.
 בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 אין בדרך כלל צורך לקבל בנפרד את האורך של מערך )להבדיל מבשפת 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
C
\lang hebrew
, למשל( כי הפונקציה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
len(a)
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תחזיר את אורכו, אולם במקרה הנוכחי ייתכן שהערימה 
\series bold
אינה
\series default
 משתמשת בכל המערך )כזכור, הרעיון יהיה שבסוף המערך יהיו האיברים שכבר מוינו,
 והאיברים שטרם מוינו יהיו בערימה(.
\end_layout

\begin_layout Standard
הפונקציה מבצעת לכל היותר שתי השוואות )בין שני הבנים של הצומת ובין הצומת
 לגדול מבין הבנים הללו( וקוראת לעצמה רקורסיבית עבור תת-עץ שהשורש שלו הוא
 בן של 
\begin_inset Formula $i$
\end_inset

, כך שסיבוכיות הפונקציה חסומה מלמעלה על ידי 
\begin_inset Formula $2\cdot h\left(v_{i}\right)$
\end_inset

 כאשר 
\begin_inset Formula $v_{i}$
\end_inset

 הוא הצומת בעץ שהאינדקס שלו במערך הוא 
\begin_inset Formula $i$
\end_inset

, ו-
\begin_inset Formula $h\left(v_{i}\right)$
\end_inset

 הוא עומק העץ ש-
\begin_inset Formula $v_{i}$
\end_inset

 נמצא בשורש שלו.
\end_layout

\begin_layout Subsubsection
בניית ערימה
\end_layout

\begin_layout Standard
בהינתן הפונקציה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
heapify
\lang hebrew
, בניית ערימה היא פשוטה: נעבור על המערך 
\begin_inset Formula $a$
\end_inset

 
\series bold
מהסוף להתחלה
\series default
 ועל כל צומת נפעיל את
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
heapify
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בתורו.
 המעבר מהסוף להתחלה מבטיח שתמיד תתקיים הנחת היסוד של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
heapify
\lang hebrew
: כאשר אנו מפעילים אותה על צומת, מובטח לנו שתתי-העצים של בניו הם כבר ערימות.
\end_layout

\begin_layout Standard
בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
זה נראה כך:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def make_heap(a):
\end_layout

\begin_layout Plain Layout

2     n = len(a)
\end_layout

\begin_layout Plain Layout

3     for i in range(n-1, -1, -1):
\end_layout

\begin_layout Plain Layout

4         heapify(a, i, n)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
כאן בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעת הלולאה 
\begin_inset Formula $i=n-1,\ldots,0$
\end_inset

 )ה-
\begin_inset Formula $-1$
\end_inset

 השני אומר לעצור עם ההגעה ל-
\begin_inset Formula $i=-1$
\end_inset

, לא כולל הצעד הזה; וה-
\begin_inset Formula $-1$
\end_inset

 השני אומר שיש להפחית
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מ-
\begin_inset Formula $i$
\end_inset

 בכל איטרציה במקום להוסיף
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כרגיל(.
\end_layout

\begin_layout Standard
מכיוון שהלולאה מתבצעת 
\begin_inset Formula $n$
\end_inset

 פעמים ובכל פעם מתבצעת קריאה ל-
\lang english
heapify
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שהסיבוכיות שלה חסומה על ידי 
\begin_inset Formula $O\left(\log n\right)$
\end_inset

, קל לראות כי סיבוכיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
make_heap
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא לפחות 
\begin_inset Formula $O\left(n\log n\right)$
\end_inset

.
 אבל למעשה, ניתוח זהיר יראה לנו כי היא קטנה יותר:
\end_layout

\begin_layout Theorem
סיבוכיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
make_heap
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 היא 
\begin_inset Formula $O\left(n\right)$
\end_inset

.
\end_layout

\begin_layout Standard
המפתח לניתוח הוא פירוק העץ לשכבות.
 ככל ששכבה היא יותר גבוהה, כך יש בה אקספוננציאלית פחות צמתים, מה שמוביל
 לסיבוכיות נמוכה משמעותית.
\end_layout

\begin_layout Proof
לכל 
\begin_inset Formula $n$
\end_inset

 טבע, יהא 
\begin_inset Formula $k$
\end_inset

 המספר הטבעי הקטן ביותר כך ש-
\begin_inset Formula $2^{k-1}\le n\le2^{k}$
\end_inset

.
 אז בעץ בינארי כמעט שלם עם 
\begin_inset Formula $n$
\end_inset

 צמתים יש 
\begin_inset Formula $k+1$
\end_inset

 שכבות.
 שנמספר על ידי 
\begin_inset Formula $i=0,1,\ldots,k$
\end_inset

.
 בשכבה ה-
\begin_inset Formula $i$
\end_inset

 יש 
\begin_inset Formula $2^{i}$
\end_inset

 צמתים לכל היותר וגובהה הוא 
\begin_inset Formula $k-i$
\end_inset

.
\end_layout

\begin_layout Proof
כעת, סיבוכיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
heapify
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
לכל צומת 
\begin_inset Formula $v_{i}$
\end_inset

 חסומה כפי שראינו על ידי 
\begin_inset Formula $2\cdot h\left(v_{i}\right)$
\end_inset

, כך שסיבוכיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
make_heap
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
חסומה על ידי:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\sum_{v\in T}2h\left(v\right) & \le2\sum_{i=0}^{k}2^{i}\cdot\left(k-i\right)\\
 & =2\sum_{j=0}^{k}j\cdot2^{k-j}\\
 & =2^{k+1}\sum_{j=0}^{k}\frac{j}{2^{j}}
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
נרצה לחסום את 
\begin_inset Formula $\sum_{j=0}^{k}\frac{j}{2^{j}}$
\end_inset

.
 לשם כך ניתן להשתמש בתעלול מתורת טורי החזקות:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\sum_{j=0}^{\infty}jx^{j} & =x\sum_{j=0}^{\infty}jx^{j-1}\\
 & =x\left(\sum_{j=0}^{\infty}x^{j}\right)^{\prime}\\
 & x\cdot\left(\frac{1}{1-x}\right)^{\prime}=\frac{x}{\left(1-x\right)^{2}}
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
אם נציב 
\begin_inset Formula $x=\frac{1}{2}$
\end_inset

 נקבל 
\begin_inset Formula $\sum_{j=0}^{k}\frac{j}{2^{j}}\le\sum_{j=0}^{\infty}\frac{j}{2^{j}}=2$
\end_inset

.
 מכאן שסיבוכיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
make_heap
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
חסומה על ידי 
\begin_inset Formula $2^{k+2}$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $8n\ge2^{k+2}$
\end_inset

 קיבלנו שסיבוכיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
make_heap
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא 
\begin_inset Formula $O\left(n\right)$
\end_inset

.
\end_layout

\begin_layout Subsubsection
שימוש בערימה למיון
\end_layout

\begin_layout Standard
אחרי עבודת ההכנה שביצענו, מיון ערימה עצמו הוא טריוויאלי: בונים ערימה, ואז
 במשך 
\begin_inset Formula $n-1$
\end_inset

 צעדים מעבירים את השורש שלה אל התא האחרון במערך שטרם מוין, מקטינים את גודל
 הערימה ב-
\numeric on
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ומתקנים אותה בעזרת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
heapify
\lang hebrew
.
\end_layout

\begin_layout Standard
בשפת פייתון הקוד נראה כך:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def heap_sort(a):
\end_layout

\begin_layout Plain Layout

2     n = len(a)
\end_layout

\begin_layout Plain Layout

3     make_heap(a)
\end_layout

\begin_layout Plain Layout

4     for i in range(1,n):
\end_layout

\begin_layout Plain Layout

5         a[0], a[n-i] = a[n-i], a[0]
\end_layout

\begin_layout Plain Layout

6         heapify(a, 0, n-i)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
כאן בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נוצרת הערימה, בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעת החלפה בין האיבר בראש הערימה )הגדול ביותר מאלו שטרם מוינו( ובין האיבר
 בעל האינדקס הגדול ביותר מבין אלו שטרם מוינו, ובשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצע תיקון הערימה )החל מהשורש שלה ולכן ה-
\numeric on
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שמועבר לפונקציה, וכשגודלה מעודכן בהתאם ולכן ה-
\begin_inset Formula $n-i$
\end_inset

 שמועבר לפונקציה(.
\end_layout

\begin_layout Theorem
הסיבוכיות של מיון ערימה היא 
\begin_inset Formula $O\left(n\log n\right)$
\end_inset

.
\end_layout

\begin_layout Proof
הסיבוכיות של מיון ערימה מורכבת מהסיבוכיות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
make_heap
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\begin_inset Formula $n-1$
\end_inset

 הפעלות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
heapify
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ולכן
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
c_{\text{HEAP\_SORT}}\left(n\right) & \le c_{\text{MAKE\_HEAP}}\left(n\right)+\left(n-1\right)c_{\text{HEAPIFY}}\left(n\right)\\
 & \le O\left(n\right)+\left(n-1\right)O\left(\log n\right)\\
 & \le O\left(n\log n\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
בעיית הבחירה
\end_layout

\begin_layout Subsubsection
מבוא
\end_layout

\begin_layout Standard
לעתים בהינתן רשימה 
\begin_inset Formula $a$
\end_inset

 אין לנו צורך למיין את כולה, אלא רק למצוא איברים כלשהם שמאופיינים על פי
 המיקום שלהם ברשימה הממויינת.
 שלוש הדוגמאות הבסיסיות הן האיבר המינימלי ברשימה )שנמצא במקום הראשון ברשימה
 הממויינת(, האיבר המקסימלי ברשימה )שנמצא במקום האחרון ברשימה הממויינת( ו
\series bold
החציון
\series default
 של הרשימה )שנמצא באמצע הרשימה הממויינת(.
\end_layout

\begin_layout Standard
מציאת מינימום היא עניין פשוט: מאתחלים את המינימום להיות האיבר הראשון ברשימה
 ואז עוברים סדרתית על הרשימה ומשווים כל איבר למינימום.
 אם נמצא ברשימה איבר קטן יותר, הוא הופך למינימום החדש.
 בצורה הזו נזקקים ל-
\begin_inset Formula $n-1$
\end_inset

 השוואות, ואלגוריתם דומה עובד עבור מציאת מקסימום.
\end_layout

\begin_layout Standard
לעומת זאת, הרבה פחות ברור כיצד למצוא חציון ברשימה לא ממויינת.
 כמובן, ניתן למיין את הרשימה בסיבוכיות 
\begin_inset Formula $O\left(n\log n\right)$
\end_inset

 ולבדוק את האיבר באמצע הרשימה, אך כפי שנראה, ניתן לפעול בצורה יעילה יותר
 ולמצוא את החציון בסיבוכיות 
\begin_inset Formula $O\left(n\right)$
\end_inset

.
 החציון אינו ייחודי כאן - נראה שלכל רשימה מאורך 
\begin_inset Formula $n$
\end_inset

 ולכל 
\begin_inset Formula $0\le k\le n-1$
\end_inset

 ניתן למצוא את האיבר במקום ה-
\begin_inset Formula $k$
\end_inset

-י ברשימה הממויינת תוך ביצוע לכל היותר 
\begin_inset Formula $30n$
\end_inset

 השוואות.
\end_layout

\begin_layout Standard
נגדיר פורמלית את המטרה שלנו:
\end_layout

\begin_layout Definition

\series bold
בעיית הבחירה
\series default
: בהינתן סדרה 
\begin_inset Formula $a=\left(a_{0},\ldots,a_{n-1}\right)$
\end_inset

 עם תמורה ממיינת 
\begin_inset Formula $\pi\in S_{n}$
\end_inset

, 
\begin_inset Formula $a_{\pi\left(0\right)}<\ldots<a_{\pi\left(n-1\right)}$
\end_inset

, נגדיר 
\begin_inset Formula 
\begin{align*}
\text{sel}\left(a,k\right) & =a_{\pi\left(k\right)}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
למשל:
\end_layout

\begin_layout Itemize
\begin_inset Formula $\text{sel}\left(a,0\right)=\min a$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\text{sel}\left(a,n-1\right)=\max a$
\end_inset


\end_layout

\begin_layout Itemize
החציון של 
\begin_inset Formula $a$
\end_inset

 מוגדר להיות 
\begin_inset Formula $\text{sel}\left(a,\left\lfloor \frac{n}{2}\right\rfloor \right)$
\end_inset

 )אם הרשימה מאורך זוגי זהו 
\series bold
החציון העליון
\series default
 של 
\begin_inset Formula $a$
\end_inset

 למשל עבור הרשימה הממויינת 
\begin_inset Formula $\left(a_{0},a_{1},a_{2},a_{3}\right)$
\end_inset

 מוחזר 
\begin_inset Formula $a_{2}$
\end_inset

(.
\end_layout

\begin_layout Subsubsection
תיאור האלגוריתם
\end_layout

\begin_layout Standard
השיטה שלנו תהיה רקורסיבית: בכל איטרציה נמצא איבר 
\begin_inset Formula $x\in a$
\end_inset

 שהוא 
\begin_inset Quotes eld
\end_inset

קרוב מספיק להיות החציון
\begin_inset Quotes erd
\end_inset

 של הרשימה ונבנה שני מערכים חדשים, 
\begin_inset Formula $c=\left\{ a_{i}\in a\ |\ a_{i}\;\le x\right\} $
\end_inset

 ו-
\begin_inset Formula $d=\left\{ a_{i}\in a\ |\ a_{i}\;>x\right\} $
\end_inset

.
 אם יצא שגודל 
\begin_inset Formula $c$
\end_inset

 הוא בדיוק 
\begin_inset Formula $k$
\end_inset

, הרי שהאיבר במקום 
\begin_inset Formula $k$
\end_inset

 ברשימה הממויינת אמור להיות 
\begin_inset Formula $x$
\end_inset

, וסיימנו; אם גודל 
\begin_inset Formula $c$
\end_inset

 
\series bold
גדול
\series default
 מ-
\begin_inset Formula $k$
\end_inset

 אפשר להמשיך את החיפוש רקורסיבית בתוך 
\begin_inset Formula $c$
\end_inset

, ואם גודל 
\begin_inset Formula $c$
\end_inset

 
\series bold
קטן
\series default
 מ-
\begin_inset Formula $k$
\end_inset

 אפשר להמשיך את החיפוש בתוך 
\begin_inset Formula $d$
\end_inset

.
 כל עוד האיבר 
\begin_inset Formula $x$
\end_inset

 נבחר בצורה כזו שגם 
\begin_inset Formula $c$
\end_inset

 וגם 
\begin_inset Formula $d$
\end_inset

 יהיו קטנות בצורה מהותית ביחס ל-
\begin_inset Formula $a$
\end_inset

, זה מספיק כדי לקבל סיבוכיות לינארית.
\end_layout

\begin_layout Standard
הדרך שבה מוצאים את 
\begin_inset Formula $x$
\end_inset

 נדמית קצת קסומה במבט ראשון.
 ראשית, מחלקים את 
\begin_inset Formula $a$
\end_inset

 לסדרות של חמישה איברים:
\end_layout

\begin_layout Standard
\begin_inset Formula $F_{1}=\left(a_{0},a_{1},a_{2},a_{3},a_{4}\right)$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $F_{2}=\left(a_{5},a_{6},a_{7},a_{8},a_{9}\right)$
\end_inset


\end_layout

\begin_layout Standard
וכן הלאה עד לקבלת סדרה 
\begin_inset Formula $F_{1},F_{2},\ldots,F_{t}$
\end_inset

, כשה
\begin_inset Quotes erd
\end_inset

חמישייה
\begin_inset Quotes erd
\end_inset

 האחרונה 
\begin_inset Formula $F_{t}$
\end_inset

 יכולה לכלול גם פחות מחמישה איברים, ומתקיים 
\begin_inset Formula $t=\left\lceil \frac{n}{5}\right\rceil $
\end_inset

.
\end_layout

\begin_layout Standard
כל חמישייה כזו ניתן למיין בזמן קבוע ולכן ניתן למצוא את החציון שלה בצורה
 ישירה.
 נקבל רשימה 
\begin_inset Formula $b=\left(b_{1},\ldots,b_{t}\right)$
\end_inset

 של החציונים של של החמישיות.
 נבחר את 
\begin_inset Formula $x$
\end_inset

 שלנו להיות החציון של הרשימה הזו.
 נשים לב לכך שלא ניתן למיין את הרשימה הזו כדי למצוא את החציון שלה, בניגוד
 לתעלול שביצענו עם הרשימות בנות חמש האיברים.
 תחת זאת, נקרא רקורסיבית לשיטת החיפוש שלנו כדי לטפל ברשימה זו.
\end_layout

\begin_layout Standard
בשפת פייתון הקוד נראה כך:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def select(a, k):
\end_layout

\begin_layout Plain Layout

2      n = len(a)
\end_layout

\begin_layout Plain Layout

3      if n == 1:
\end_layout

\begin_layout Plain Layout

4          return a[0]
\end_layout

\begin_layout Plain Layout

5      b = [find_median(a[5*i:5*(i+1)]) for i in range(math.ceil(n / 5))]
\end_layout

\begin_layout Plain Layout

6      x = select(b, len(b) // 2)
\end_layout

\begin_layout Plain Layout

7      c = [ai for ai in a if ai < x]
\end_layout

\begin_layout Plain Layout

8      d = [ai for ai in a if ai > x]
\end_layout

\begin_layout Plain Layout

9      if len(c) == k:
\end_layout

\begin_layout Plain Layout

10         return x
\end_layout

\begin_layout Plain Layout

11     if len(c) > k:
\end_layout

\begin_layout Plain Layout

12         return select(c, k)
\end_layout

\begin_layout Plain Layout

13     if len(c) < k:
\end_layout

\begin_layout Plain Layout

14         return select(d, k - len(c) - 1)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
כאשר המימוש שלנו של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
find_median
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבסס על מיון הכנסה:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def find_median(f):
\end_layout

\begin_layout Plain Layout

2     insertion_sort(f)
\end_layout

\begin_layout Plain Layout

3     return f[len(f) // 2]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
נשים לב לכך שהקוד אינו אופטימלי ואין בו בדיקת תקינות של הקלטים; זאת כדי
 לשמור על פשטות הקריאה שלו.
\end_layout

\begin_layout Standard
נתאר פרטנית את הקוד של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
select
\lang hebrew
:
\end_layout

\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 נבדק מקרה הקצה של מערך בן איבר בודד שאותו מחזירים בלי קשר לערכו של 
\begin_inset Formula $k$
\end_inset

.
\end_layout

\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מחולק המערך לסדרה של תתי-מערכים מגודל
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ועבור כל אחד מהם מוצאים את החציון שלו בצורה ישירה.
 התוצאה היא רשימת החציונים 
\begin_inset Formula $b$
\end_inset

.
\end_layout

\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
קוראים רקורסיבית ל-
\lang english
select
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על מנת לחשב את החציון 
\begin_inset Formula $x$
\end_inset

 של הרשימה 
\begin_inset Formula $b$
\end_inset

.
\end_layout

\begin_layout Itemize
בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7-8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נבנים המערכים 
\begin_inset Formula $c,d$
\end_inset

 מתוך האיברים הקטנים והגדולים מ-
\begin_inset Formula $x$
\end_inset

 בהתאמה )שלב זה מבוצע בצורה לא אופטימלית, עם שתי סריקות של 
\begin_inset Formula $a$
\end_inset

 במקום סריקה בודדת(.
\end_layout

\begin_layout Itemize
בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9,11,13
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נבדקים שלושת המקרים האפשריים לגבי המיקום של האיבר ה-
\begin_inset Formula $k$
\end_inset

-י )או שהוא 
\begin_inset Formula $x$
\end_inset

, או שהוא בתוך 
\begin_inset Formula $c$
\end_inset

, או שהוא בתוך 
\begin_inset Formula $d$
\end_inset

(.
 במקרים שבהם האיבר טרם נמצא, מתבצעת קריאה רקורסיבית ל-
\lang english
select
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עבור המערך המתאים.
\end_layout

\begin_layout Subsubsection
ניתוח סיבוכיות
\end_layout

\begin_layout Standard
המפתח לניתוח הסיבוכיות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
select
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא במציאת חסם על גודל המערכים שעליהם פועלים רקורסיבית.
 מציאת החציון של 
\begin_inset Formula $b$
\end_inset

 בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעת על מערך מגודל 
\begin_inset Formula $\left\lceil \frac{n}{5}\right\rceil $
\end_inset

, אבל מה ניתן לומר על גודלן של 
\begin_inset Formula $c,d$
\end_inset

? הקבוצות הללו נוצרות על ידי לקיחת איבר בודד 
\begin_inset Formula $x$
\end_inset

 ופירוק שאר האיברים לקטנים וגדולים ממנו.
 האם לא קיימת האפשרות שניקח בטעות את 
\begin_inset Formula $x$
\end_inset

 להיות אחד מהאיברים הקטנים במערך ולכן 
\begin_inset Formula $d$
\end_inset

 תהיה עצומה?
\end_layout

\begin_layout Standard
התשובה היא לא, כפי שמראה הטענה הבאה:
\end_layout

\begin_layout Claim
אם 
\begin_inset Formula $\left|a\right|=n$
\end_inset

 אז גודל הקבוצות 
\begin_inset Formula $c,d$
\end_inset

 שמתקבלות בשורות 
\numeric on
7-8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
select
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מקיים 
\begin_inset Formula $\left|c\right|,\left|d\right|\le\frac{7n}{10}+6$
\end_inset


\end_layout

\begin_layout Standard
לפני שנוכיח פורמלית את הטענה, הנה האינטואיציה שמאחוריה.
 נסתכל על המקרה הקונקרטי של 
\begin_inset Formula $n=35$
\end_inset

 שבו יש 
\begin_inset Formula $\left|b\right|=\frac{n}{5}=7$
\end_inset

 קבוצות של חמישה איברים.
 נצייר אותן בתור עמודות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נקודות, כך שהעמודות מסודרות על פי הסדר בקבוצת החציונים 
\begin_inset Formula $b$
\end_inset

 )השורה האמצעית(.
 הנקודה הבולטת במרכז היא 
\begin_inset Formula $x$
\end_inset

 - התוצאה של מציאת החציון של 
\begin_inset Formula $b$
\end_inset

 בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\numeric off
.
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename images/medians.PNG

\end_inset


\end_layout

\begin_layout Standard
כעת נתבונן על איברים ש
\series bold
ידוע לנו בודאות
\series default
 שיהיו שייכים ל-
\begin_inset Formula $c$
\end_inset

, כלומר שידוע לנו בודאות שהם קטנים מ-
\begin_inset Formula $x$
\end_inset

.
 ראשית, כל החציונים ב-
\begin_inset Formula $b$
\end_inset

 שבאים 
\series bold
לפני
\series default
 
\begin_inset Formula $x$
\end_inset

 יהיו כאלו.
 שנית, כל האיברים בטור של החציונים הללו שקטנים מהם יהיו כאלו.
 יש 
\begin_inset Formula $3$
\end_inset

 חציונים כאלו וכל חציון כזה תורם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
איברים )הוא עצמו ושני אלו שקטנים ממנו בטור שלו( כך שנקבל
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
איברים לפחות.
 בנוסף לכך יש גם את האיברים בטור של 
\begin_inset Formula $x$
\end_inset

 אבל כאן יהיה מדובר רק על שני איברים ולא שלושה.
\end_layout

\begin_layout Standard
באופן כללי יש בעיה נוספת שלא מתבטאת באיור - אחד הטורים עלול לכלול פחות מחמישה
 איברים.
 בשתי בעיות אלו נתחשב בהוכחה הכללית.
\end_layout

\begin_layout Proof
גודל הקבוצה 
\begin_inset Formula $b$
\end_inset

 הוא 
\begin_inset Formula $\left\lceil \frac{n}{5}\right\rceil $
\end_inset

, ומספר אברי 
\begin_inset Formula $b$
\end_inset

 שהוא קטן או שווה לחציון 
\begin_inset Formula $x$
\end_inset

 הוא לפחות 
\begin_inset Formula $\left\lceil \frac{b}{2}\right\rceil $
\end_inset

.
 פירוש הדבר הוא שיש בין הקבוצות 
\begin_inset Formula $F_{1},F_{2},\ldots,F_{t}$
\end_inset

 לפחות 
\begin_inset Formula $\left\lceil \frac{1}{2}\left\lceil \frac{n}{5}\right\rceil \right\rceil $
\end_inset

 קבוצות שבהן החציון קטן או שווה ל-
\begin_inset Formula $x$
\end_inset

.
 כל קבוצה כזו תורמת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
איברים שקטנים מ-
\begin_inset Formula $x$
\end_inset

 למעט אולי הקבוצה שכוללת את 
\begin_inset Formula $x$
\end_inset

 עצמו וקבוצה אחת נוספת שיש פה פחות מ-
\numeric on
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 איברים, ולכן יש לכל הפחות 
\begin_inset Formula 
\begin{align*}
3\left(\left\lceil \frac{1}{2}\left\lceil \frac{n}{5}\right\rceil \right\rceil -2\right) & \ge3\left(\frac{n}{10}-2\right)=\frac{3n}{10}-6
\end{align*}

\end_inset

 איברים שקטנים מ-
\begin_inset Formula $x$
\end_inset

.
 מכאן שכמות האיברים ש
\family default
\series bold
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
גדולים
\series default
 מ-
\begin_inset Formula $x$
\end_inset

 היא לכל היותר 
\begin_inset Formula $n-\left(\frac{3n}{10}-6\right)=\frac{7n}{10}+6$
\end_inset

, כלומר 
\begin_inset Formula $\left|d\right|\le\frac{7n}{10}+6$
\end_inset

.
 אותו הטיעון מראה גם ש-
\begin_inset Formula $\left|c\right|\le\frac{7n}{10}+6$
\end_inset

.
\end_layout

\begin_layout Standard
נעבור כעת לניתוח הסיבוכיות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
select
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כולה.
 נסמן ב-
\begin_inset Formula $c_{\text{SEL}}\left(n\right)$
\end_inset

 את מספר ההשוואות שמבצעת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
select
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
במקרה הגרוע על קלט מגודל 
\begin_inset Formula $n$
\end_inset

.
 כעת נחסום את 
\begin_inset Formula $c_{\text{SEL}}\left(n\right)$
\end_inset

 על ידי בחינת שלבי האלגוריתם.
\end_layout

\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מבוצע מיון הכנסה ל-
\begin_inset Formula $\left\lceil \frac{n}{5}\right\rceil $
\end_inset

 קבוצות שכל אחת מהן היא מגודל
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ולכן דורש 
\begin_inset Formula ${5 \choose 2}=10$
\end_inset

 השוואות לכל היותר, ולכן שלב זה דורש לכל היותר 
\begin_inset Formula 
\begin{align*}
\left\lceil \frac{n}{5}\right\rceil \cdot10 & \le\frac{10n}{5}+10\\
 & =2n+10=O\left(n\right)
\end{align*}

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
השוואות.
\end_layout

\end_deeper
\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעת קריאה רקורסיבית ל-
\lang english
select
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שדורשת לכל היותר 
\begin_inset Formula $c_{\text{SEL}}\left(\left\lceil \frac{n}{5}\right\rceil \right)$
\end_inset

 השוואות.
\end_layout

\begin_layout Itemize
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
משווים את כל אברי 
\begin_inset Formula $a$
\end_inset

 ל-
\begin_inset Formula $x$
\end_inset

, כך ששורה זו דורשת 
\begin_inset Formula $n$
\end_inset

 השוואות, וכך גם שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)ניתן לבצע את שתי השורות במעבר אחד על המערך לצורך שיפור היעילות(.
 בכל מקרה שורות אלו לוקחות 
\begin_inset Formula $O\left(n\right)$
\end_inset

 השוואות.
\end_layout

\begin_layout Itemize
בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
12
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\numeric on
14
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעת קריאה רקורסיבית ל-
\lang english
select
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שדורשת לכל היותר 
\begin_inset Formula $c_{\text{SEL}}\left(\frac{7n}{10}+6\right)$
\end_inset

 השוואות.
 רק אחת מבין שתי הקריאות הללו יכולה להתבצע בכל פעם.
\end_layout

\begin_layout Standard
קיבלנו את הנוסחה הרקורסיבית הבאה:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
c_{\text{SEL}}\left(n\right) & \le c_{\text{SEL}}\left(\left\lceil \frac{n}{5}\right\rceil \right)+c_{\text{SEL}}\left(\frac{7n}{10}+6\right)+O\left(n\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Theorem
קיים קבוע 
\begin_inset Formula $t$
\end_inset

 כך ש-
\begin_inset Formula $c_{\text{SEL}}\left(n\right)\le tn$
\end_inset

 לכל 
\begin_inset Formula $n>0$
\end_inset

.
\end_layout

\begin_layout Proof
יהא 
\begin_inset Formula $a$
\end_inset

 קבוע כך שהחלק בנוסחה ל-
\begin_inset Formula $c_{\text{SEL}}$
\end_inset

 שלעיל שהוא 
\begin_inset Formula $O\left(n\right)$
\end_inset

 יהיה חסום על ידי 
\begin_inset Formula $an$
\end_inset

 לכל 
\begin_inset Formula $n$
\end_inset

 טבעי.
 כעת נשתמש ב
\begin_inset Quotes erd
\end_inset

מספרי קסם
\begin_inset Quotes erd
\end_inset

 שנבין מהיכן הגיעו בהמשך ונגדיר 
\begin_inset Formula $t=\max\left\{ 20a,c_{\text{SEL}}\left(140\right)\right\} $
\end_inset

.
 נוכיח באינדוקציה כי 
\begin_inset Formula $c_{\text{SEL}}\left(n\right)<tn$
\end_inset

.
\end_layout

\begin_layout Proof
ראשית, לכל 
\begin_inset Formula $1\le n\le140$
\end_inset

 מתקיים 
\begin_inset Formula $c_{\text{SEL}}\left(n\right)\le c_{\text{SEL}}\left(140\right)$
\end_inset

 )כי ממבנה האלגוריתם אפשר לראות שהסיבוכיות היא מונוטונית עולה, דהיינו הגדלה
 של הקלט יכולה רק להביא להגדלת הסיבוכיות(.
 לכן 
\begin_inset Formula $c_{\text{SEL}}\left(n\right)\le c_{\text{SEL}}\left(140\right)\le t\le tn$
\end_inset

 כנדרש.
\end_layout

\begin_layout Proof
נניח כעת באינדוקציה שלמה ש-
\begin_inset Formula $c_{\text{SEL}}\left(k\right)\le tk$
\end_inset

 לכל 
\begin_inset Formula $k<n$
\end_inset

 ונשתמש בנוסחה הרקורסיבית שראינו קודם:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
c_{\text{SEL}}\left(n\right) & \le c_{\text{SEL}}\left(\left\lceil \frac{n}{5}\right\rceil \right)+c_{\text{SEL}}\left(\frac{7n}{10}+6\right)+O\left(n\right)\\
 & \le t\left\lceil \frac{n}{5}\right\rceil +t\left(\frac{7n}{10}+6\right)+an\\
 & \le\frac{tn}{5}+t+\frac{7tn}{10}+6t+an\\
 & =\frac{9tn}{10}+7t+an\\
 & =tn+\left(-\frac{tn}{10}+7t+an\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
דהיינו, נקבל את התוצאה המבוקשת בתנאי שמתקיים ש-
\begin_inset Formula $-\frac{tn}{10}+7t+an\le0$
\end_inset

.
 נחלץ את 
\begin_inset Formula $t$
\end_inset

 מאי השוויון הזה ונקבל:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
t\left(7-\frac{n}{10}\right)+an & \le0\\
t\left(\frac{n-70}{10}\right) & \ge an\\
t & \ge10a\left(\frac{n}{n-70}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כעת תתברר הבחירה שלנו בערכו של 
\begin_inset Formula $t$
\end_inset

.
 כזכור, בחרנו את 
\begin_inset Formula $t$
\end_inset

 כך שאפשר להניח ש-
\begin_inset Formula $n\ge140$
\end_inset

, מה שמוביל לכך שהביטוי 
\begin_inset Formula $\frac{n}{n-70}$
\end_inset

 יקיים 
\begin_inset Formula $\frac{n}{n-70}\le2$
\end_inset

 )כי זו פונקציה יורדת ששווה ל-
\numeric on
2
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ב-
\begin_inset Formula $n=140$
\end_inset

(.
 מכאן ש-
\begin_inset Formula $10a\left(\frac{n}{n-70}\right)\le20a\le t$
\end_inset

 מהבחירה שלנו את 
\begin_inset Formula $t$
\end_inset

 להיות לפחות 
\begin_inset Formula $20a$
\end_inset

.
 זה מסיים את ההוכחה
\end_layout

\begin_layout Section
אלגוריתמי חיפוש בגרף ושימושיהם
\end_layout

\begin_layout Subsection
ייצוג גרפים
\end_layout

\begin_layout Standard
אנחנו מגדירים גרף בתור זוג 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 כך ש-
\begin_inset Formula $V$
\end_inset

 היא קבוצה של 
\series bold
צמתים
\series default
 ו-
\begin_inset Formula $E$
\end_inset

 היא קבוצה של 
\series bold
קשתות
\series default
 כאשר כל קשת מאופיינת בכך שיש לה שתי 
\series bold
נקודות קצה
\series default
 שהן צמתים ב-
\begin_inset Formula $V$
\end_inset

.
 אם 
\begin_inset Formula $G$
\end_inset

 הוא גרף 
\series bold
לא מכוון
\series default
 אז נקודות הקצה מהוות קבוצה בת שני איברים, בזמן שאם 
\begin_inset Formula $G$
\end_inset

 הוא גרף 
\series bold
מכוון
\series default
 אז נקודות הקצה הן זוג סדור )צומת היציאה של הקשת וצומת הכניסה של הקשת(.
\end_layout

\begin_layout Standard
בהמשך נעסוק בגרפים שמגיעים עם מידע נוסף - למשל, משקל מספרי על הקשתות.
 אפשר לייצג מידע נוסף זה בתור פונקציות על קבוצת הצמתים או הקשתות.
\end_layout

\begin_layout Standard
מעבר לייצוג המתמטי, שאלת הייצוג של גרפים במחשב אינה טריוויאלית ויש שיטות
 ייצוג רבות ושונות.
 נבחר לצורך הקורס הזה את שיטת הייצוג הנוחה עבורנו להצגת האלגוריתמים שלנו
 ולא נעסוק בשיטות האחרות או בהשוואה בין היעילות שלהן.
 שיטת הייצוג תתבטא רק בקטעי הקוד שנכתוב.
\end_layout

\begin_layout Standard
אנו נניח שהגרף
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
G
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נתון על ידי 
\series bold
אובייקט
\series default
 שהשדות שלו הם קבוצת הצמתים 
\begin_inset Formula $V$
\end_inset

 וקבוצת הקשתות 
\begin_inset Formula $E$
\end_inset


\end_layout

\begin_layout Subsection
אלגוריתם חיפוש לרוחב
\family roman
\series bold
\shape up
\size large
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)
\lang english
BFS
\lang hebrew
(
\end_layout

\begin_layout Subsubsection
האלגוריתם הבסיסי
\end_layout

\begin_layout Standard
המטרה בחיפוש לרוחב היא לעבור על כל צמתי הגרף הישיגים מצומת התחלתי כלשהו,
 כך שהסדר שבו מגיעים לצמתים תלוי במרחק שלהם מהצומת ההתחלתי: ראשית עוברים
 על כל הצמתים שמרחקם ממנו
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
, אחר כך על הצמתים שמרחקם ממנו הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וכדומה, כך שאפשר לחשוב על האלגוריתם בתור מעין 
\begin_inset Quotes eld
\end_inset

גל
\begin_inset Quotes erd
\end_inset

 שמתחיל להתפשט מהצומת ההתחלתי.
\end_layout

\begin_layout Standard
בפני עצמו
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מאפשר את גילוי כל הצמתים הישיגים מהצומת ההתחלתי, אך הרחבות שונות שלו מאפשרות
 לחשב דברים נוספים, ונראה דוגמאות לכך.
\end_layout

\begin_layout Standard
אופן הפעולה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 הוא כדלהלן: בכל רגע נתון האלגוריתם מתחזק שתי רשימות צמתים - הרשימה 
\begin_inset Formula $Q$
\end_inset

 שהיא תור של הצמתים שעדיין צריכים להיסרק, ורשימה 
\begin_inset Formula $S$
\end_inset

 של הצמתים שכבר נסרקו.
 בתחילת פעולתו האלגוריתם מקבל צומת 
\begin_inset Formula $s\in V$
\end_inset

 ומכניס אותו אל 
\begin_inset Formula $Q$
\end_inset

, ומכאן ואילך פועל כך כל עוד 
\begin_inset Formula $Q$
\end_inset

 איננו ריק: הוא מוציא את האיבר שבראש הרשימה 
\begin_inset Formula $Q$
\end_inset

, עובר על שכניו של הצומת הזה ולכל שכן שאינו ב-
\begin_inset Formula $S$
\end_inset

 או 
\begin_inset Formula $Q$
\end_inset

 - מכניס אותו לסוף הרשימה 
\begin_inset Formula $Q$
\end_inset

.
\end_layout

\begin_layout Standard
בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
האלגוריתם נראה כך:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def BFS(G, s):
\end_layout

\begin_layout Plain Layout

2     Q = [s]
\end_layout

\begin_layout Plain Layout

3     S = []
\end_layout

\begin_layout Plain Layout

4     while len(Q) > 0:
\end_layout

\begin_layout Plain Layout

5         u = Q.pop(0)
\end_layout

\begin_layout Plain Layout

6         for v in G.adjacency(u):
\end_layout

\begin_layout Plain Layout

7             if v not in Q and v not in S:
\end_layout

\begin_layout Plain Layout

8                 Q.append(v)
\end_layout

\begin_layout Plain Layout

9         S.append(u)
\end_layout

\begin_layout Plain Layout

10    return S
\end_layout

\end_inset


\end_layout

\begin_layout Standard
האלגוריתם עשוי לעבור על כל הצמתים בגרף ולכן הלולאה החיצונית עשויה להתבצע
 
\begin_inset Formula $O\text{\left(\left|V\right|\right)}$
\end_inset

 פעמים.
 לכל צומת האלגוריתם עובר על כל שכניו, כלומר על כל הקשתות שמחוברות אליו,
 ולכן בסך הכל הוא עשוי לעבור על 
\begin_inset Formula $O\left(\left|E\right|\right)$
\end_inset

 קשתות.
 על פניו הדבר גורר סיבוכיות של 
\begin_inset Formula $O\left(\left|V\right|+\left|E\right|\right)$
\end_inset

 ובמימוש יעיל של האלגוריתם זה גם המצב; לרוע המזל המימוש שהצגנו אינו יעיל
 כי בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצע חיפוש בקבוצות 
\begin_inset Formula $Q,S$
\end_inset

 שתלוי גם בגודל הנוכחי שלהן.
\end_layout

\begin_layout Standard
הפתרון הפשוט ביותר לבעיית יעילות זו היא לשמור את הצומת בתור מבנה נתונים
 מורכב שמסוגל להכיל מידע נוסף מעבר לשם הצומת - למשל, 
\begin_inset Quotes eld
\end_inset

צבע
\begin_inset Quotes erd
\end_inset

 שמסמן אם הצומת טרם הוכנס ל-
\begin_inset Formula $Q$
\end_inset

 )ואז הוא לבן(, אם הוא כבר הוכנס ל-
\begin_inset Formula $Q$
\end_inset

 אבל טרם הוצא ממנו )ואז הוא אפור( ואם הוא כבר הוצא מ-
\begin_inset Formula $Q$
\end_inset

 )ואז הוא שחור(.
 נראה גישה זו בהמשך.
\end_layout

\begin_layout Subsubsection
מציאת מרחקים ועץ
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\end_layout

\begin_layout Standard
נשתמש כעת ב-
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כדי לקבל שני סוגי מידע על הצמתים שישיגים מ-
\begin_inset Formula $s$
\end_inset

: את 
\series bold
המרחק
\series default
 שלהם מ-
\begin_inset Formula $s$
\end_inset

 ואת המסלול הקצר ביותר מהם אל 
\begin_inset Formula $s$
\end_inset

.
 פורמלית, נגדיר שתי פונקציות, 
\begin_inset Formula $d:V\to\mathbb{N}\cup\left\{ \infty\right\} $
\end_inset

 כך שלכל צומת 
\begin_inset Formula $v\in V$
\end_inset

, 
\begin_inset Formula $d\left(v\right)$
\end_inset

 הוא מרחק 
\begin_inset Formula $v$
\end_inset

 מ-
\begin_inset Formula $s$
\end_inset

 או 
\begin_inset Formula $\infty$
\end_inset

 אם 
\begin_inset Formula $v$
\end_inset

 לא ישיג מ-
\begin_inset Formula $s$
\end_inset

.
 בנוסף, נגדיר פונקציה 
\begin_inset Formula $\pi:V\to V\cup\left\{ \text{None}\right\} $
\end_inset

 כך שלכל צומת 
\begin_inset Formula $v\in V$
\end_inset

, 
\begin_inset Formula $\pi\left(v\right)$
\end_inset

 הוא הצומת שבא 
\series bold
לפניו
\series default
 במסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

, או 
\begin_inset Formula $\emptyset$
\end_inset

 אם לא קיים צומת כזה.
 באופן הזה, לכל צומת 
\begin_inset Formula $v\in V$
\end_inset

 המסלול הקצר ביותר אליו מ-
\begin_inset Formula $s$
\end_inset

 הוא המסלול הבא:
\end_layout

\begin_layout LyX-Code
\begin_inset Formula 
\begin{align*}
s=\pi^{d\left(v\right)}\left(v\right)\to\pi^{d\left(v\right)-1}\left(v\right)\to\ldots\to\pi^{2}\left(v\right)\to\pi\left(v\right)\to v
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
האלגוריתם נראה כך:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def BFS_shortest_paths(G, s):
\end_layout

\begin_layout Plain Layout

2      Q = [s]
\end_layout

\begin_layout Plain Layout

3      S = []
\end_layout

\begin_layout Plain Layout

4      for v in G.V:
\end_layout

\begin_layout Plain Layout

5          v.color = 'white'
\end_layout

\begin_layout Plain Layout

6          v.d = math.inf
\end_layout

\begin_layout Plain Layout

7          v.pi = None   
\end_layout

\begin_layout Plain Layout

8      s.color = 'gray'
\end_layout

\begin_layout Plain Layout

9      s.d = 0    
\end_layout

\begin_layout Plain Layout

10     while len(Q) > 0:
\end_layout

\begin_layout Plain Layout

11         u = Q.pop(0)
\end_layout

\begin_layout Plain Layout

12         for v in G.adjacency(u):
\end_layout

\begin_layout Plain Layout

13             if v.color == 'white':
\end_layout

\begin_layout Plain Layout

14                 Q.append(v)
\end_layout

\begin_layout Plain Layout

15                 v.color = 'gray'
\end_layout

\begin_layout Plain Layout

16                 v.d = u.d + 1
\end_layout

\begin_layout Plain Layout

17                 v.pi = u
\end_layout

\begin_layout Plain Layout

18         u.color = 'black'
\end_layout

\begin_layout Plain Layout

19         S.append(u)
\end_layout

\begin_layout Plain Layout

20     return S
\end_layout

\end_inset


\end_layout

\begin_layout Standard
ההבדל בין האלגוריתם הזה לקודם הוא בניהול שדות המידע בתוך האובייקט שמייצג
 את הצמתים עצמם.
\end_layout

\begin_layout Itemize
בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
4-7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מאותחל המידע של כל הצמתים לערך ברירת המחדל )צבע לבן, מרחק אינסופי, צומת
 קודם ריק(
\end_layout

\begin_layout Itemize
בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8-9
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ישנו אתחול מיוחד של הצומת שממנו מתחיל ה-
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)המרחק מעצמו הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\numeric off
, הצבע שלו הוא אפור כי הוא כבר בתוך התור 
\begin_inset Formula $Q$
\end_inset

(
\end_layout

\begin_layout Itemize
בזמן שסורקים את הגרף מהצומת 
\begin_inset Formula $u$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
11
\numeric off
( עוברים על הצמתים שמחוברים אליו )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
12
\numeric off
( ולכל צומת כזה בודקים אם זו הפעם הראשונה שראינו אותו ולכן צבעו לבן )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
13
\numeric off
(.
 אם כן, מעדכנים את הצבע שלו לאפור )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
15
\numeric off
( והמרחק שלו מ-
\begin_inset Formula $s$
\end_inset

 מוגדר להיות מרחק 
\begin_inset Formula $v$
\end_inset

 מ-
\begin_inset Formula $s$
\end_inset

 ועוד
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
16
\numeric off
(.
 הצומת הקודם במסלול, 
\begin_inset Formula $\pi\left(v\right)$
\end_inset

, מוגדר להיות 
\begin_inset Formula $u$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
17
\numeric off
(.
\end_layout

\begin_layout Itemize
כאשר מסיימים לעבור על הצומת 
\begin_inset Formula $u$
\end_inset

 משונה צבעו לשחור )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
18
\numeric off
(.
\end_layout

\begin_layout Standard
על פניו אין טעם בהפרדה בין הצבעים שחור ואפור ואפשר היה להסתפק במשתנה בוליאני
 שאומר אם כבר פגשנו את הצומת או לא, אלא שבהמשך נראה שההפרדה הזו בין אפור
 ושחור מקילה על ההוכחה המרכזית שלנו.
\end_layout

\begin_layout Standard
נוכיח את נכונות האלגוריתם.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
אולי גם דוגמת ריצה?
\end_layout

\end_inset

 לשם כך נפתח עם הגדרה טבעית:
\end_layout

\begin_layout Definition
יהא 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 גרף ויהיו 
\begin_inset Formula $s,v\in V$
\end_inset

.
 
\series bold
המרחק
\series default
 מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 שמסומן ב-
\begin_inset Formula $\delta\left(s,v\right)$
\end_inset

 הוא מספר הקשתות המינימלי במסלול כלשהו מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

.
 אם לא קיים מסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 אז 
\begin_inset Formula $\delta\left(s,v\right)=\infty$
\end_inset

.
 
\series bold
מסלול קצר ביותר
\series default
 מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 הוא מסלול מאורך 
\begin_inset Formula $\delta\left(s,v\right)$
\end_inset

.
\end_layout

\begin_layout Standard
מטרתנו היא להראות שבסיום ריצת אלגוריתם ה-
\lang english
BFS_shortest_paths(G,s)
\lang hebrew
, שדה ה-
\begin_inset Formula $d$
\end_inset

 של כל צומת 
\begin_inset Formula $v\in V$
\end_inset

 מכיל את 
\begin_inset Formula $\delta\left(s,v\right)$
\end_inset

 ושהמסלול שמוגדר באמצעות ה-
\begin_inset Formula $\pi$
\end_inset

-ים הוא מסלול קצר ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

.
\end_layout

\begin_layout Standard
ראשית נוכיח ששדה ה-
\begin_inset Formula $d$
\end_inset

 הוא 
\series bold
חסם מלמעלה
\series default
 על 
\begin_inset Formula $\delta$
\end_inset

:
\end_layout

\begin_layout Claim
בסיום ריצת האלגוריתם על 
\begin_inset Formula $s$
\end_inset

, לכל 
\begin_inset Formula $v\in V$
\end_inset

 מתקיים ש-
\begin_inset Formula $\delta\left(s,v\right)\le v.d$
\end_inset

.
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $v.d=\infty$
\end_inset

 זה ברור, אחרת 
\begin_inset Formula $v$
\end_inset

 הוכנס מתישהו אל 
\begin_inset Formula $Q$
\end_inset

 במהלך ריצת האלגוריתם.
 נוכיח את הטענה באינדוקציה על ההכנסות ל-
\begin_inset Formula $Q$
\end_inset

.
 הבסיס הוא עבור 
\begin_inset Formula $s$
\end_inset

 שהוכנס ראשון )בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\numeric off
(, ועבורו נקבע 
\begin_inset Formula $s.d=0$
\end_inset

 )בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9
\numeric off
( ולא משתנה עוד, ולכן מתקיים 
\begin_inset Formula $\delta\left(s,s\right)=0\le s.d$
\end_inset

.
\end_layout

\begin_layout Proof
נעבור אל צעד האינדוקציה.
 אם 
\begin_inset Formula $v\ne s$
\end_inset

 התווסף ל-
\begin_inset Formula $Q$
\end_inset

 זה חייב להיות בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
14
\numeric off
, כחלק מסריקת השכנים של צומת 
\begin_inset Formula $u$
\end_inset

 שהתווסף קודם אל 
\begin_inset Formula $Q$
\end_inset

 ולכן ניתן להפעיל עליו את הנחת האינדוקציה ולקבל 
\begin_inset Formula $\delta\left(s,u\right)\le u.d$
\end_inset

.
 במקרה זה, בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
16
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נקבע ערכו של 
\begin_inset Formula $v.d$
\end_inset

 להיות 
\begin_inset Formula $v.d=u.d+1$
\end_inset

.
\end_layout

\begin_layout Proof
כמו כן, נשים לב לכך ש-
\begin_inset Formula $\delta\left(s,v\right)\le\delta\left(s,u\right)+1$
\end_inset

 מאי-שוויון המשולש על מרחקים בגרף )המסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 שעובר דרך מסלול קצר ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 ואז בקשת מ-
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 הוא מסלול אפשרי אחד מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

, לאו דווקא הקצר ביותר, ואורכו 
\begin_inset Formula $\delta\left(s,u\right)+1$
\end_inset

(.
 נחבר את שלושת פרטי המידע הללו ונקבל:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\delta\left(s,v\right) & \le\delta\left(s,u\right)+1\\
 & \le u.d+1=v.d
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
אנו רוצים כעת להוכיח את ההפך, 
\begin_inset Formula $v.d\le\delta\left(s,v\right)$
\end_inset

.
 לצורך כך נזדקק לטענת עזר אחת: 
\end_layout

\begin_layout Claim
\begin_inset CommandInset label
LatexCommand label
name "claim:הכנסת-איברי-BFS"

\end_inset

אם 
\begin_inset Formula $u$
\end_inset

 הוכנס ל-
\begin_inset Formula $Q$
\end_inset

 לפני 
\begin_inset Formula $v$
\end_inset

, אז 
\begin_inset Formula $u.d\le v.d$
\end_inset

.
\end_layout

\begin_layout Proof
תהא 
\begin_inset Formula $v_{0},v_{1},\ldots,v_{t}$
\end_inset

 סדרת כל הצמתים שהוכנסו ל-
\begin_inset Formula $Q$
\end_inset

 במהלך האלגוריתם על פי סדר ההכנסה שלהם.
 מספיק להוכיח ש-
\begin_inset Formula $v_{i}.d\le v_{i+1}.d$
\end_inset

 לכל 
\begin_inset Formula $0\le i<t$
\end_inset

 כדי להסיק את המסקנה המבוקשת.
 נוכיח זאת באינדוקציה שלמה על 
\begin_inset Formula $i$
\end_inset

.
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $v_{i}=s$
\end_inset

 אז על פי שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9
\numeric off
, 
\begin_inset Formula $v_{i}.d=0\le v_{i+1}.d$
\end_inset

 שכן שדה ה-
\begin_inset Formula $d$
\end_inset

 של 
\series bold
כל
\series default
 צומת הוא מספר טבעי.
 לכן נניח מעתה ש-
\begin_inset Formula $v_{i}\ne s$
\end_inset

 )ולכן גם 
\begin_inset Formula $v_{i+1}\ne s$
\end_inset

(.
 כלומר, 
\begin_inset Formula $v_{i}$
\end_inset

 הוכנס ל-
\begin_inset Formula $Q$
\end_inset

 במהלך סריקה של צומת אחר, שנסמן 
\begin_inset Formula $u_{i}$
\end_inset

, ו-
\begin_inset Formula $v_{i+1}$
\end_inset

 הוכנס ל-
\begin_inset Formula $Q$
\end_inset

 במהלך סריקה של צומת שנסמן 
\begin_inset Formula $u_{i+1}$
\end_inset

.
\end_layout

\begin_layout Proof
ייתכן ש- 
\begin_inset Formula $u_{i}=u_{i+1}$
\end_inset

 ואז 
\begin_inset Formula $u_{i}.d=u_{i+1}.d$
\end_inset

, ואם לא, אז בהכרח 
\begin_inset Formula $u_{i}$
\end_inset

 הוכנס ל-
\begin_inset Formula $Q$
\end_inset

 לפני 
\begin_inset Formula $u_{i+1}$
\end_inset

 אחרת 
\begin_inset Formula $v_{i+1}$
\end_inset

 היה מתווסף ל-
\begin_inset Formula $Q$
\end_inset

 לפני 
\begin_inset Formula $v_{i}$
\end_inset

 ואז ניתן להשתמש בהנחת האינדוקציה ולקבל 
\begin_inset Formula $u_{i}.d\le u_{i+1}.d$
\end_inset

.
\end_layout

\begin_layout Proof
כעת, על פי
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 שורה 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
16
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נקבל 
\begin_inset Formula $v_{i}.d=u_{i}.d+1$
\end_inset

 וגם 
\begin_inset Formula $v_{i+1}.d=u_{i+1}.d+1$
\end_inset

.
 לכן קיבלנו:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
v_{i}.d & =u_{i}.d+1\\
 & \le u_{i+1}.d+1\\
 & =v_{i+1}.d
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כנדרש.
\end_layout

\begin_layout Standard
כעת ניתן להוכיח את החצי השני של הטענה על המרחקים:
\end_layout

\begin_layout Claim
בסיום ריצת האלגוריתם על 
\begin_inset Formula $s$
\end_inset

, לכל 
\begin_inset Formula $v\in V$
\end_inset

 מתקיים ש-
\begin_inset Formula $v.d\le\delta\left(s,v\right)$
\end_inset

.
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $\delta\left(s,v\right)=\infty$
\end_inset

 אי השוויון מתקיים תמיד, לכן מספיק להוכיח את הטענה עבור 
\begin_inset Formula $v$
\end_inset

-ים שעבורם 
\begin_inset Formula $\delta\left(s,v\right)$
\end_inset

 הוא מספר טבעי.
 נוכיח זאת באינדוקציה שלמה על הגודל של 
\begin_inset Formula $\delta\left(s,v\right)$
\end_inset

.
\end_layout

\begin_layout Proof
עבור 
\begin_inset Formula $\delta\left(s,v\right)=0$
\end_inset

 בהכרח 
\begin_inset Formula $v=s$
\end_inset

 ואכן 
\begin_inset Formula $s.d=0$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באלגוריתם(.
\end_layout

\begin_layout Proof
יהא כעת 
\begin_inset Formula $v\ne s$
\end_inset

 ונתבונן במסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 מאורך 
\begin_inset Formula $\delta\left(s,v\right)=k$
\end_inset

.
 נסמן ב-
\begin_inset Formula $u$
\end_inset

 את הצומת שלפני 
\begin_inset Formula $v$
\end_inset

 במסלול )קיימת כזו כי אורך המסלול גדול מאפס(.
 כלומר, המסלול הוא 
\begin_inset Formula $s\to\ldots\to u\to v$
\end_inset

 ויש עליו 
\begin_inset Formula $\delta\left(s,v\right)$
\end_inset

 קשתות.
 המסלול הזה בפרט כולל בתוכו מסלול מאורך 
\begin_inset Formula $k-1$
\end_inset

 מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 כך ש-
\begin_inset Formula $\delta\left(s,u\right)<\delta\left(s,v\right)$
\end_inset

, ולכן ניתן להשתמש על 
\begin_inset Formula $u$
\end_inset

 בהנחת האינדוקציה ולהסיק ש-
\begin_inset Formula $u.d\le\delta\left(s,u\right)$
\end_inset

.
\end_layout

\begin_layout Proof
אם נוכל להוכיח ש-
\begin_inset Formula $v.d\le u.d+1$
\end_inset

 סיימנו, כי אז יתקיים:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
v.d & \le u.d+1\\
 & \le\delta\left(s,u\right)+1\\
 & \le\delta\left(s,v\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
מכיוון שהקשת 
\begin_inset Formula $u\to v$
\end_inset

 קיימת בגרף, ועל פי הנחת האינדוקציה ערכו של 
\begin_inset Formula $u$
\end_inset

 נקבע בשלב מסויים )ולא נשאר 
\begin_inset Formula $\infty$
\end_inset

( פירוש הדבר הוא ש-
\begin_inset Formula $u$
\end_inset

 התווסף אל 
\begin_inset Formula $Q$
\end_inset

, ולאחר מכן הוצא ממנה.
 כחלק מתהליך ההוצאה של 
\begin_inset Formula $u$
\end_inset

 מ-
\begin_inset Formula $Q$
\end_inset

 האלגוריתם עבר על שכניו, ובפרט עבר על 
\begin_inset Formula $v$
\end_inset

.
 צבע 
\begin_inset Formula $v$
\end_inset

 בזמן הזה יכול להיות או לבן, או אפור או שחור, ונבדוק מה נובע מכל אחת מהאפשרויות
 הללו.
\end_layout

\begin_deeper
\begin_layout Itemize
אם 
\begin_inset Formula $v$
\end_inset

 היה לבן בזמן הסריקה )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
13
\numeric off
( אז בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
16
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תבוצע ההשמה 
\begin_inset Formula $v.d=u.d+1$
\end_inset

 וסיימנו.
\end_layout

\begin_layout Itemize
אם 
\begin_inset Formula $v$
\end_inset

 היה שחור בזמן הסריקה, המשמעות היא ש-
\begin_inset Formula $v$
\end_inset

 הוצא מ-
\begin_inset Formula $Q$
\end_inset

 לפני ש-
\begin_inset Formula $u$
\end_inset

 הוצא מ-
\begin_inset Formula $Q$
\end_inset

.
 לכן בהכרח 
\begin_inset Formula $v$
\end_inset

 נכנס אל 
\begin_inset Formula $Q$
\end_inset

 לפני 
\begin_inset Formula $u$
\end_inset

 )כי 
\begin_inset Formula $Q$
\end_inset

 הוא תור שפועל בשיטת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
First-in-first-out
\lang hebrew
( ומטענה 
\begin_inset CommandInset ref
LatexCommand ref
reference "claim:הכנסת-איברי-BFS"
plural "false"
caps "false"
noprefix "false"

\end_inset

 נקבל ש-
\begin_inset Formula $v.d\le u.d$
\end_inset

.
\end_layout

\begin_layout Itemize
אם 
\begin_inset Formula $v$
\end_inset

 היה אפור בזמן הסריקה, אז הוא הפך לאפור )בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
15
\numeric off
( בזמן סריקה שביצע צומת 
\series bold
אחר
\series default
, 
\begin_inset Formula $w$
\end_inset

, שכבר הוצא מ-
\begin_inset Formula $Q$
\end_inset

 לפני 
\begin_inset Formula $u$
\end_inset

, כלומר גם הוכנס ל-
\begin_inset Formula $Q$
\end_inset

 לפני 
\begin_inset Formula $u$
\end_inset

 ולכן מטענה 
\begin_inset CommandInset ref
LatexCommand ref
reference "claim:הכנסת-איברי-BFS"
plural "false"
caps "false"
noprefix "false"

\end_inset

 עולה ש-
\begin_inset Formula $w.d\le u.d$
\end_inset

.
 אחרי שצבעו של 
\begin_inset Formula $v$
\end_inset

 הפך לאפור גם נקבע 
\begin_inset Formula $v.d=w.d+1$
\end_inset

 )בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
16
\numeric off
(.
 משני אלו נסיק ש-
\begin_inset Formula $v.d=w.d+1\le u.d+1$
\end_inset

, כפי שרצינו.
\end_layout

\end_deeper
\begin_layout Standard
ראינו כי 
\begin_inset Formula $v.d\le\delta\left(s,v\right)$
\end_inset

 ו-
\begin_inset Formula $\delta\left(s,v\right)\le v.d$
\end_inset

 ולכן נוכל להסיק ש-
\begin_inset Formula $v.d=\delta\left(s,v\right)$
\end_inset

.
\end_layout

\begin_layout Standard
נותר רק להשתכנע בכך ש-
\begin_inset Formula $\pi$
\end_inset

 אכן מגדירה את המסלול הקצר ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל צמתי הגרף.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:אלגוריתם-BFS-בונה-מסלול"

\end_inset

אם 
\begin_inset Formula $v$
\end_inset

 אינו ישיג מ-
\begin_inset Formula $s$
\end_inset

 אז 
\begin_inset Formula $v.\pi=\text{None }$
\end_inset

.
 אחרת, המסלול הבא הוא מסלול קצר ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

:
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\begin{align*}
s & =\pi^{d\left(v\right)}\left(v\right)\to\pi^{d\left(v\right)-1}\left(v\right)\to\ldots\to\pi^{2}\left(v\right)\to\pi\left(v\right)\to v
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
ראשית, אם 
\begin_inset Formula $v$
\end_inset

 אינו ישיג מ-
\begin_inset Formula $s$
\end_inset

 אז 
\begin_inset Formula $d\left(v\right)=\infty$
\end_inset

 כפי שראינו קודם.
 כלומר, מרגע האתחול של 
\begin_inset Formula $v$
\end_inset

 בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5-7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
לא השתנה בו דבר, ולכן בפרט גם 
\begin_inset Formula $v.\pi=\text{None}$
\end_inset

.
\end_layout

\begin_layout Proof
נניח כעת כי 
\begin_inset Formula $v$
\end_inset

 ישיג מ-
\begin_inset Formula $s$
\end_inset

, כלומר 
\begin_inset Formula $d\left(v\right)$
\end_inset

 הוא מספר טבעי.
 ההוכחה היא באינדוקציה על 
\begin_inset Formula $d\left(v\right)$
\end_inset

.
 עבור הבסיס, 
\begin_inset Formula $d\left(v\right)=0$
\end_inset

 גורר ש-
\begin_inset Formula $v=s$
\end_inset

 ואכן 
\begin_inset Formula $s=\pi^{0}\left(s\right)$
\end_inset

 כמבוקש.
\end_layout

\begin_layout Proof
יהא כעת 
\begin_inset Formula $v\ne s$
\end_inset

 כלשהו ויהא 
\begin_inset Formula $u=v.\pi$
\end_inset

.
 ערך זה נקבע בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
17
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של האלגוריתם ונובע מכך שבשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
16
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נקבע 
\begin_inset Formula $v.d=u.d+1$
\end_inset

, וכמו כן קיימת קשת מ-
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

.
 כעת, מכך ש-
\begin_inset Formula $d\left(u\right)=d\left(v\right)-1$
\end_inset

 עולה שניתן להשתמש בהנחת האינדוקציה על 
\begin_inset Formula $u$
\end_inset

 ולקבל מסלול 
\begin_inset Formula 
\begin{align*}
s & =\pi^{d\left(u\right)}\left(u\right)\to\ldots\to\pi\left(u\right)\to u
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
נציב 
\begin_inset Formula $u=\pi\left(v\right)$
\end_inset

 ו-
\begin_inset Formula $d\left(u\right)=d\left(v\right)-1$
\end_inset

 ונקבל:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
s & =\pi^{d\left(v\right)-1}\left(\pi\left(v\right)\right)\to\ldots\to\pi\left(\pi\left(v\right)\right)\to\pi\left(v\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
נרכיב את ההפעלות של 
\begin_inset Formula $\pi$
\end_inset

, נוסיף לסוף המסלול את 
\begin_inset Formula $v$
\end_inset

 בהתבסס על הקשת 
\begin_inset Formula $u\to v$
\end_inset

 שראינו את קיומה, ונקבל את המבוקש:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
s & =\pi^{d\left(v\right)}\left(v\right)\to\ldots\to\pi^{2}\left(v\right)\to\pi\left(v\right)\to v
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
אלגוריתם המסלולים הקלים ביותר של דייקסטרה
\end_layout

\begin_layout Subsubsection
בעיית המסלול הקלים ביותר
\end_layout

\begin_layout Standard
ראינו כיצד אלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מאפשר לנו למצוא את 
\series bold
המרחק
\series default
 בין צומת 
\begin_inset Formula $s$
\end_inset

 נתון בגרף ובין כל צומת אחר שישיג ממנו.
 המרחק הזה נמדד באמצעות 
\series bold
מספר הקשתות
\series default
 במסלול מ-
\begin_inset Formula $s$
\end_inset

 לצמתים אחרים, אבל זהו מקרה פרטי של בעיה כללית יותר - הבעיה של מציאת 
\series bold
מסלולים קלים ביותר
\series default
 בגרף.
\end_layout

\begin_layout Standard
דוגמא פשוטה לאופן שבו בעיה זו מתעוררת נתונה על ידי 
\series bold
רשת כבישים
\series default
 שמחברת ערים )או נקודות כלשהן במפה(.
 נניח שאנו רוצים למצוא את המסלול שבו נגיע במהירות הגדולה ביותר מהעיר 
\begin_inset Formula $A$
\end_inset

 אל העיר 
\begin_inset Formula $B$
\end_inset

.
 ייתכן למשל שיש כביש ישיר שמחבר את 
\begin_inset Formula $A$
\end_inset

 אל 
\begin_inset Formula $B$
\end_inset

 אבל הוא ארוך ומתפתל והנסיעה בו איטית, ולעומת זאת קיימים כבישים ישירים מהירים
 מ-
\begin_inset Formula $A$
\end_inset

 אל עיר אחרת 
\begin_inset Formula $C$
\end_inset

 ומ-
\begin_inset Formula $C$
\end_inset

 אל 
\begin_inset Formula $B$
\end_inset

.
 במקרה זה עדיף להתבסס על המסלול שכולל שתי קשתות במקום אחת.
\end_layout

\begin_layout Standard
כדי למדל את הסיטואציה הזו בפורמליזם של תורת הגרפים אנו מגדירים 
\series bold
גרף ממושקל
\series default
:
\end_layout

\begin_layout Definition

\series bold
גרף מכוון ממושקל
\series default
 הוא שלשה 
\begin_inset Formula $G=\left(V,E,w\right)$
\end_inset

 כך ש-
\begin_inset Formula $\left(V,E\right)$
\end_inset

 הוא גרף מכוון ו-
\begin_inset Formula $w:E\to\mathbb{R}^{\ge0}$
\end_inset

 היא 
\series bold
פונקציית משקל
\series default
 שמתאימה לכל איבר של 
\begin_inset Formula $E$
\end_inset

 משקל שהוא מספר ממשי אי-שלילי.
\end_layout

\begin_layout Standard
כעת קל להגדיר משקל של מסלול:
\end_layout

\begin_layout Definition

\series bold
משקל של מסלול
\series default
: יהא 
\begin_inset Formula $p:v_{0}\to v_{1}\to\ldots\to v_{n}$
\end_inset

 מסלול בגרף ממושקל .
 אז משקל המסלול הוא 
\begin_inset Formula $w\left(p\right)=\sum_{i=0}^{n-1}w\left(\left(v_{i},v_{i+1}\right)\right)$
\end_inset

.
\end_layout

\begin_layout Standard
לבסוף, אפשר להגדיר מהו המסלול הקל ביותר בין שני צמתים:
\end_layout

\begin_layout Definition
יהיו 
\begin_inset Formula $u,v\in V$
\end_inset

 בגרף מכוון ממושקל.
 אם 
\begin_inset Formula $v$
\end_inset

 אינו ישיג מ-
\begin_inset Formula $u$
\end_inset

 נגדיר 
\begin_inset Formula $\delta\left(u,v\right)=\infty$
\end_inset

 ואחרת נגדיר את 
\begin_inset Formula $\delta\left(u,v\right)\triangleq\min\left\{ w\left(p\right)\ |\ u\overset{p}{\rightsquigarrow v}\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
אחת הסיבות שבגללן דרשנו שהמשקלים על הקשתות יהיו 
\series bold
אי-שליליים
\series default
 היא שאם יש קשתות בעלות משקל שלילי, ייתכן ש-
\begin_inset Formula $\delta\left(u,v\right)$
\end_inset

 יהיה לא מוגדר גם אם 
\begin_inset Formula $v$
\end_inset

 ישיג מ-
\begin_inset Formula $u$
\end_inset

; זה יקרה אם קיים מסלול מ-
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 שבדרך אליו עוברים על 
\series bold
מעגל
\series default
 שסכום המשקלים של קשתותיו 
\series bold
שלילי
\series default
 )ולכן ככל שחוזרים על המעגל יותר פעמים, משקל המסלול יהיה קטן יותר(.
 בנוסף, האלגוריתם של דייקסטרה שאותו נתאר כאן לא עובד כלל על גרף שיש בו קשתות
 שליליות )גם אם אין בו מעגל שלילי(.
 אלגוריתם 
\series bold
בלמן-פורד
\series default
 מסוגל להתמודד עם קשתות שליליות )בתנאי שאין מעגל שלילי( במחיר זמן ריצה גדול
 יותר, אבל לא נציג אותו כאן.
\end_layout

\begin_layout Standard
הבעיה שלנו כעת פשוטה לניסוח:
\end_layout

\begin_layout Definition

\series bold
בעיית המסלולים הקלים ממקור יחיד
\series default
: בהינתן 
\begin_inset Formula $G$
\end_inset

 גרף מכוון ממושקל ו-
\begin_inset Formula $s\in V$
\end_inset

, למצוא עבור כל 
\begin_inset Formula $v\in V$
\end_inset

 את 
\begin_inset Formula $\delta\left(s,v\right)$
\end_inset

 ומסלול 
\begin_inset Formula $s\overset{p}{\rightsquigarrow v}$
\end_inset

 שזהו משקלו.
\end_layout

\begin_layout Standard
על פניו זו בעיה שאפתנית יותר מאשר הבעיה של מציאת מסלול קל ביותר בין שני
 צמתים: במקום זוג צמתים, אנחנו מבקשים לדעת משהו על צומת אחד 
\series bold
וכל יתר הגרף
\series default
.
 בפועל, לא ידוע אלגוריתם שפועל בסיבוכיות אסימפטוטית יעילה יותר מאשר האלגוריתמים
 שפותרים את הבעיה הכללית יותר ולכן אנו מתמקדים בה.
\end_layout

\begin_layout Subsubsection
תיאור האלגוריתם של דייקסטרה
\end_layout

\begin_layout Standard
האלגוריתם של דייקסטרה דומה מאוד בבסיסו לאלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\lang hebrew
, עם שני הבדלים חשובים:
\end_layout

\begin_layout Description
התור: באלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הצמתים שמתגלים במהלך האלגוריתם מוכנסים אל 
\series bold
תור
\series default
 
\begin_inset Formula $Q$
\end_inset

 שפועל בשיטת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
FIFO
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 - הראשון שנכנס הוא שיוצא.
 האינטואיציה מאחורי גישה זו היא שככל שצומת מוכנס מוקדם יותר כך הוא קרוב
 יותר אל 
\begin_inset Formula $s$
\end_inset

 ולכן בכל איטרציה נשלף מ-
\begin_inset Formula $Q$
\end_inset

 צומת שהוא מינימלי מבחינת המרחק שלו מ-
\begin_inset Formula $s$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Standard
בסיטוציה של מסלולים קלים ביותר ההנחה הזו כבר לא בהכרח נכונה - כפי שראינו,
 מספר הקשתות על מסלול אינו אינדיקציה מלאה למשקל שלו.
 זה מאלץ את התור 
\begin_inset Formula $Q$
\end_inset

 להיות ממומש בצורה חכמה יותר שמאפשרת בכל איטרציה את שליפת הצומת בעל המרחק
 
\series bold
המינימלי
\series default
 מ-
\begin_inset Formula $s$
\end_inset

.
 תור כזה נקרא 
\series bold
תור עדיפויות
\series default
.
 במסגרת הזו לא נוכל להציג את המימוש היעיל ביותר לתור העדיפויות שאלגוריתם
 דייקסטרה נזקק לו )מימוש שמכונה 
\series bold
ערימת פיבונאצ'י
\series default
( ונסתפק בהסבר כללי על מימוש באמצעות ערימה.
\end_layout

\end_deeper
\begin_layout Description
השכנים: באלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בכל איטרציה עוברים על כל השכנים של הצומת 
\begin_inset Formula $u$
\end_inset

.
 שכנים 
\begin_inset Formula $v$
\end_inset

 שהם צמתים שהאלגוריתם טרם נתקל בהם )
\begin_inset Quotes erd
\end_inset

לבנים
\begin_inset Quotes erd
\end_inset

( מסומנים כבעלי מרחק 
\begin_inset Formula $d\left(v\right)=d\left(u\right)+1$
\end_inset

 מהצומת 
\begin_inset Formula $s$
\end_inset

, ושכנים שהאלגוריתם כבר נתקל בהם קודם )
\begin_inset Quotes erd
\end_inset

אפורים
\begin_inset Quotes erd
\end_inset

 או 
\begin_inset Quotes eld
\end_inset

שחורים
\begin_inset Quotes erd
\end_inset

( לא זוכים לטיפול כלל.
 באלגוריתם דייקסטרה לא ניתן לנקוט באותה גישת התעלמות מצמתים אפורים, כי ייתכן
 שהמסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 ועוד הקשת )שטרם נבדקה עד כה( מ-
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 גם יחד מהווים מסלול קל יותר מהמסלול הקל ביותר שידוע כרגע מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

.
 לכן יש לבצע השוואה שבודקת אם המסלול הזה אכן קל יותר ואם כן - לתקן בהתאם.
\end_layout

\begin_layout Standard
נציג מימוש בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של האלגוריתם שבו התור 
\begin_inset Formula $Q$
\end_inset

 ממומש בצורה נאיבית על ידי רשימה.
 את הוצאת האיבר המינימלי מהרשימה נממש על ידי פונקציה שמשתמשת ב
\begin_inset Quotes erd
\end_inset

שורת קסם
\begin_inset Quotes erd
\end_inset

 בודדת בפייתון )לא קריטי להבין מה קורה בה(:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def pop_min(Q):
\end_layout

\begin_layout Plain Layout

2     return Q.pop(min(range(len(Q)), key = lambda i: Q[i].d))
\end_layout

\end_inset


\end_layout

\begin_layout Standard
נעבור לאלגוריתם דייקסטרה עצמו:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def djikstra(G, s):
\end_layout

\begin_layout Plain Layout

2      for v in G.V:
\end_layout

\begin_layout Plain Layout

3          v.d = math.inf
\end_layout

\begin_layout Plain Layout

4          v.pi = None    
\end_layout

\begin_layout Plain Layout

5      s.d = 0 
\end_layout

\begin_layout Plain Layout

6      S = []
\end_layout

\begin_layout Plain Layout

7      Q = [v for v in G.V]
\end_layout

\begin_layout Plain Layout

8      while len(Q) > 0:
\end_layout

\begin_layout Plain Layout

9          u = pop_min(Q)
\end_layout

\begin_layout Plain Layout

10         S.append(u)
\end_layout

\begin_layout Plain Layout

11         for v in G.adjacency(u):
\end_layout

\begin_layout Plain Layout

12             if v.d > u.d + G.w[(u,v)]:
\end_layout

\begin_layout Plain Layout

13                 v.d = u.d + G.w[(u,v)]
\end_layout

\begin_layout Plain Layout

14                 v.pi = u
\end_layout

\begin_layout Plain Layout

15     return S
\end_layout

\end_inset


\end_layout

\begin_layout Standard
אלגוריתם דייקסטרה הוא דוגמא קלאסית לאלגוריתם 
\series bold
חמדני
\series default
, כלומר כזה שבכל שלב שלו מבצע את השיפור שנראה הטוב ביותר באותו הרגע.
 במקרה של דייקסטרה, הגישה החמדנית מבטיחה הצלחה; לא כל אלגוריתם חמדני זוכה
 להבטחה כזו.
\end_layout

\begin_layout Subsubsection
סיבוכיות אלגוריתם דייקסטרה
\end_layout

\begin_layout Standard
האלגוריתם מבצע 
\begin_inset Formula $\text{\left|V\right|}$
\end_inset

 חזרות על הלולאה שבשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)כי בכל צעד של האיטרציה מוצא איבר בודד מ-
\begin_inset Formula $Q$
\end_inset

(.
 הלולאה הנוספת שבשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
11
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעת פעם אחת לכל קשת בגרף, כלומר 
\begin_inset Formula $\left|E\right|$
\end_inset

 פעמים בסך הכל, ולכן המרכיב הרלוונטי הנוסף בקביעת זמן הריצה של דייקסטרה
 היא פעולת הוצאת המינימום שבשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9
\numeric off
.
 במימוש הנאיבי שלנו פעולה זו דורשת זמן של 
\begin_inset Formula $\left|V\right|$
\end_inset

, ולכן סיבוכיות האלגוריתם היא 
\begin_inset Formula $O\left(\left|V\right|^{2}+\left|E\right|\right)=O\left(\left|V\right|^{2}\right)$
\end_inset

 כאשר הרכיב של 
\begin_inset Formula $\left|E\right|$
\end_inset

 נעלם שכן בגרף פשוט מספר הקשתות חסום בידי 
\begin_inset Formula $\left|V\right|^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
מימוש בעזרת ערימה של 
\begin_inset Formula $Q$
\end_inset

 ישנה את הסיבוכיות באופן הבא: ראשית, בניית הערימה בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תדרוש זמן של 
\begin_inset Formula $O\left(\left|V\right|\right)$
\end_inset

 שלא משפיע על סיבוכיות האלגוריתם.
 שנית, פעולת הוצאת המינימום בשורה 
\begin_inset Formula $9$
\end_inset

 תדרוש זמן של 
\begin_inset Formula $O\left(\log\left|V\right|\right)$
\end_inset

 בלבד, כפי שלקחה במיון-ערימה )זהו הזמן של ביצוע
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
heapify
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על הערימה לאחר הוצאת האיבר המינימלי בה(.
\end_layout

\begin_layout Standard
לרוע המזל, אלגוריתם דייקסטרה מניב סיבוך של שימוש בערימה שלא ראינו עד כה
 - בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
13
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עשוי להתעדכן ערכו של איבר שנמצא 
\series bold
בתוך הערימה
\series default
.
 פירוש הדבר הוא שיש לשמור מכל צומת 
\begin_inset Formula $v$
\end_inset

 מצביע אל האיבר שמייצג אותו בתוך הערימה, וכשערכו של 
\begin_inset Formula $v.d$
\end_inset

 מתעדכן, לתקן את הערימה בהתאם על ידי 
\begin_inset Quotes eld
\end_inset

פעפוע למעלה
\begin_inset Quotes erd
\end_inset

 של האיבר שערכו השתנה.
 תיקון זה עשוי לדרוש זמן של 
\begin_inset Formula $O\left(\log\left|V\right|\right)$
\end_inset

 גם הוא.
\end_layout

\begin_layout Standard
בסך הכל נקבל שמימוש על ידי ערימה מניב זמן ריצה של 
\begin_inset Formula $O\left(\left(\left|V\right|+\left|E\right|\right)\log\left|V\right|\right)$
\end_inset

, כלומר 
\begin_inset Formula $O\left(\left|V\right|\log\left|V\right|+\left|E\right|\log\left|V\right|\right)$
\end_inset

.
 זמן ריצה זה הוא שיפור משמעותי ביחס ל-
\begin_inset Formula $O\left(\left|V\right|^{2}\right)$
\end_inset

 בתנאי שהגרף דליל, כלומר מספר הקשתות בו קטן דיו - 
\begin_inset Formula $\left|E\right|=o\left(\left|V\right|^{2}/\log\left|V\right|\right)$
\end_inset

.
\end_layout

\begin_layout Standard
כפי שהוזכר קודם, שימוש במבנה נתונים שנקרא 
\series bold
ערימת פיבונאצ'י
\series default
 למימוש 
\begin_inset Formula $Q$
\end_inset

 יכול לשפר עוד יותר את זמן הריצה.
 במבנה נתונים זה 
\series bold
הסיבוכיות המשוערכת
\series default
 של פעולת הקטנת המפתח היא רק 
\begin_inset Formula $O\left(1\right)$
\end_inset

 )אך לא נוכל להסביר כאן מהי סיבוכיות משוערכת...( וכתוצאה מכך סיבוכיות האלגוריתם
 היא 
\begin_inset Formula $O\left(\left|V\right|\log\left|V\right|+\left|E\right|\right)$
\end_inset

.
\end_layout

\begin_layout Subsubsection
נכונות אלגוריתם דייקסטרה
\end_layout

\begin_layout Standard
הטענה שאנו מבקשים להוכיח כעת היא:
\end_layout

\begin_layout Theorem
בסיום ריצת אלגוריתם דייקסטרה על הקלט 
\begin_inset Formula $G,s$
\end_inset

 מתקיים לכל צומת 
\begin_inset Formula $v.d=\delta\left(s,v\right)$
\end_inset

.
\end_layout

\begin_layout Proof
נוכיח באינדוקציה טענה חזקה יותר: שבכל שלב של ריצת האלגוריתם, לכל 
\begin_inset Formula $v\in S$
\end_inset

 מתקיים 
\begin_inset Formula $v.d=\delta\left(s,v\right)$
\end_inset

 ולכל 
\begin_inset Formula $v\in Q$
\end_inset

 מתקיים 
\begin_inset Formula $v.d\ge\delta\left(s,v\right)$
\end_inset

.
 מכיוון שבשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מאותחל 
\begin_inset Formula $Q$
\end_inset

 לכלול את כל צמתי 
\begin_inset Formula $V$
\end_inset

, ובכל פעם שצומת מוצא )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9
\numeric off
( מוסיפים אותו ל-
\begin_inset Formula $S$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\numeric off
( והאלגוריתם עוצר כאשר התור 
\begin_inset Formula $Q$
\end_inset

 ריק )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\numeric off
( נסיק שבסיום ריצת האלגוריתם 
\begin_inset Formula $S=V$
\end_inset

 ולכן הטענה על 
\begin_inset Formula $S$
\end_inset

 גוררת את מה שצריך להוכיח.
\end_layout

\begin_layout Proof
בסיס האינדוקציה קל: בתחילת ריצת האלגוריתם 
\begin_inset Formula $S=\emptyset$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\numeric off
( ולכן הטענה נכונה עבור 
\begin_inset Formula $S$
\end_inset

 באופן ריק.
 כמו כן, לכל 
\begin_inset Formula $v\in Q$
\end_inset

 השונה מ-
\begin_inset Formula $s$
\end_inset

 מתקיים 
\begin_inset Formula $v.d=\infty\ge\delta\left(s,v\right)$
\end_inset

 ועבור 
\begin_inset Formula $s$
\end_inset

 מתקיים 
\begin_inset Formula $s.d=0=\delta\left(s,s\right)$
\end_inset

.
\end_layout

\begin_layout Proof
ראשית נראה שבכל שינוי של 
\begin_inset Formula $v.d$
\end_inset

 עבור 
\begin_inset Formula $v\in Q$
\end_inset

, עדיין מתקיים 
\begin_inset Formula $v.d\ge\delta\left(s,v\right)$
\end_inset

.
 המקום היחיד שבו 
\begin_inset Formula $v.d$
\end_inset

 משתנה לאחר שלב האתחול הוא שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
13
\numeric off
, שבה הוא משתנה ל-
\begin_inset Formula $v.d=u.d+w\left(u,v\right)$
\end_inset

 כאשר 
\begin_inset Formula $u$
\end_inset

 הוא צומת ששייך ל-
\begin_inset Formula $S$
\end_inset

 )שכן הוא התווסף בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\numeric off
( ומהנחת האינדוקציה, 
\begin_inset Formula $u.d=\delta\left(s,u\right)$
\end_inset

.
 מכאן ש-
\begin_inset Formula $u.d+w\left(u,v\right)$
\end_inset

 הוא משקל המסלול 
\begin_inset Formula $s\rightsquigarrow u\to v$
\end_inset

 שבו עוברים מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 במסלול קל ביותר, ואז עוברים אל 
\begin_inset Formula $v$
\end_inset

 דרך הקשת 
\begin_inset Formula $u\to v$
\end_inset

.
 מהגדרת 
\begin_inset Formula $\delta\left(s,v\right)$
\end_inset

 בתור מינימום נובע ש-
\begin_inset Formula $\delta\left(s,v\right)\le u.d+w\left(u,v\right)$
\end_inset

, כמבוקש.
\end_layout

\begin_layout Proof
נותר להראות שבכל פעם שבה מוסיפים צומת 
\begin_inset Formula $u$
\end_inset

 ל-
\begin_inset Formula $S$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\numeric off
(, אותו צומת 
\begin_inset Formula $u$
\end_inset

 מקיים 
\begin_inset Formula $u.d=\delta\left(s,u\right)$
\end_inset

.
 יש שני מקרים טריוויאליים: זה שבו 
\begin_inset Formula $u=s$
\end_inset

 וזה שבו 
\begin_inset Formula $u$
\end_inset

 לא ישיג מ-
\begin_inset Formula $s$
\end_inset

 ולכן 
\begin_inset Formula $\delta\left(s,u\right)=\infty$
\end_inset

.
 בתחילת ריצת האלגוריתם עבור צמתים אלו מתקיים 
\begin_inset Formula $u.d=\delta\left(s,d\right)$
\end_inset

 וכפי שכבר ראינו, לא יכול עבור אף צומת להיווצר מצב שבו 
\begin_inset Formula $v.d<\delta\left(s,v\right)$
\end_inset

 ולכן גם בסיום ריצת האלגוריתם צמתים אלו מקיימים 
\begin_inset Formula $u.d=\delta\left(s,d\right)$
\end_inset

.
\end_layout

\begin_layout Proof
נותר לטפל בצומת 
\begin_inset Formula $u$
\end_inset

 שהוא ישיג מ-
\begin_inset Formula $s$
\end_inset

 אך שונה מ-
\begin_inset Formula $s$
\end_inset

.
 נתבונן במצב האלגוריתם בתחילת שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\numeric off
, לפני הכנסת 
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $S$
\end_inset

: ניקח מסלול קל ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

, 
\begin_inset Formula $s\rightsquigarrow u$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $s\in S$
\end_inset

 ואילו 
\begin_inset Formula $u\notin S$
\end_inset

 בשלב זה, הרי שקיים בתוך המסלול צומת 
\begin_inset Formula $y$
\end_inset

 שהוא הצומת הראשון כך ש-
\begin_inset Formula $y\notin S$
\end_inset

.
 נסמן את הצומת שלפניו במסלול ב-
\begin_inset Formula $x$
\end_inset

.
 כלומר המסלול הקל ביותר הוא מהצורה 
\begin_inset Formula $s\rightsquigarrow x\to y\rightsquigarrow u$
\end_inset

.
\end_layout

\begin_layout Proof
מכיוון ש-
\begin_inset Formula $y$
\end_inset

 הוא הצומת הראשון במסלול שאינו שייך ל-
\begin_inset Formula $S$
\end_inset

 נקבל ש-
\begin_inset Formula $x\in S$
\end_inset

 והוא הוכנס לשם לפני 
\begin_inset Formula $u$
\end_inset

 ולכן הנחת האינדוקציה תקפה עבורו: 
\begin_inset Formula $x.d=\delta\left(s,x\right)$
\end_inset

.
\end_layout

\begin_layout Proof
כעת, מכיוון ש-
\begin_inset Formula $s\rightsquigarrow x\to y\rightsquigarrow u$
\end_inset

 הוא מסלול קל ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 הרי ש-
\begin_inset Formula $s\rightsquigarrow x\to y$
\end_inset

 הוא מסלול קל ביותר מ\SpecialChar softhyphen

\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $y$
\end_inset

 )אחרת היינו יכולים להחליף אותו במסלול קל יותר ולהקל על המסלול מ\SpecialChar softhyphen

\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

(.
 מכאן ש-
\begin_inset Formula $\delta\left(s,y\right)=\delta\left(s,x\right)+w\left(x,y\right)$
\end_inset

.
 כעת, כאשר 
\begin_inset Formula $x$
\end_inset

 הוכנס אל 
\begin_inset Formula $S$
\end_inset

 בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מיד לאחר מכן האלגוריתם עבר סדרתית על שכניו כולל 
\begin_inset Formula $y$
\end_inset

.
 הבדיקה בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
12
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
האם מתקיים 
\begin_inset Formula $y.d\ge x.d+w\left(x,y\right)$
\end_inset

 בהכרח מצליחה, שכן 
\begin_inset Formula 
\begin{align*}
x.d+w\left(x,y\right) & =\delta\left(s,x\right)+w\left(x,y\right)\\
 & =\delta\left(s,y\right)\le y.d
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
ולכן בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
13
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מעודכן 
\begin_inset Formula $y.d$
\end_inset

 כך ש-
\begin_inset Formula $y.d=\delta\left(s,x\right)+w\left(x,y\right)=\delta\left(s,y\right)$
\end_inset

.
\end_layout

\begin_layout Proof
כעת נתבונן פעם אחרונה במסלול 
\begin_inset Formula $s\rightsquigarrow x\to y\rightsquigarrow u$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $u$
\end_inset

 נמצא בהמשך המסלול אחרי 
\begin_inset Formula $y$
\end_inset

 
\series bold
ואין קשתות שליליות בגרף
\series default
 אז 
\begin_inset Formula 
\begin{align*}
y.d & =\delta\left(s,y\right)\le\delta\left(s,u\right)\le u.d
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כעת נשתמש בכך שבשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נשלף מ-
\begin_inset Formula $Q$
\end_inset

 איבר בעל ערך 
\begin_inset Formula $d$
\end_inset

 
\series bold
מינימלי
\series default
.
 מכיוון שבחרנו את 
\begin_inset Formula $y$
\end_inset

 כך ש-
\begin_inset Formula $y\notin S$
\end_inset

 הרי ש-
\begin_inset Formula $y\in Q$
\end_inset

, ולכן המינימליות של 
\begin_inset Formula $u$
\end_inset

 גוררת ש-
\begin_inset Formula $u.d\le y.d$
\end_inset

.
 אם נוסיף את זה לשרשרת אי השוויונים שקיבלנו קודם, נקבל שהאיבר הראשון והאחרון
 בה זהים:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
y.d & =\delta\left(s,y\right)\le\delta\left(s,u\right)\le u.d\le y.d
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כלומר, כל השרשרת היא למעשה של שוויונים.
 מכאן נסיק שברגע ההכנסה שלו אל 
\begin_inset Formula $S$
\end_inset

, 
\begin_inset Formula $u.d=\delta\left(s,u\right)$
\end_inset

, כמבוקש.
\end_layout

\begin_layout Standard
כמו ב-
\lang english
BFS
\lang hebrew
, גם כאן פשוט להוכיח ש-
\begin_inset Formula $\pi$
\end_inset

 מקודד את המסלולים הקלים ביותר:
\end_layout

\begin_layout Theorem
אם 
\begin_inset Formula $v$
\end_inset

 אינו ישיג מ-
\begin_inset Formula $s$
\end_inset

 אז 
\begin_inset Formula $v.\pi=\text{None }$
\end_inset

.
 אחרת, המסלול הבא הוא מסלול קל ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

:
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\begin{align*}
s & =\pi^{d\left(v\right)}\left(v\right)\to\pi^{d\left(v\right)-1}\left(v\right)\to\ldots\to\pi^{2}\left(v\right)\to\pi\left(v\right)\to v
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
ההוכחה דומה מאוד להוכחה של משפט 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:אלגוריתם-BFS-בונה-מסלול"
plural "false"
caps "false"
noprefix "false"

\end_inset

 עבור אלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ולא נציג אותה כאן.
\begin_inset Note Note
status open

\begin_layout Plain Layout
תרגיל טוב לש
\begin_inset Quotes erd
\end_inset

ב
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
אלגוריתם המסלולים הקלים ביותר של פלויד-וורשאל
\end_layout

\begin_layout Subsubsection
מבוא לאלגוריתם פלויד-וורשאל
\end_layout

\begin_layout Standard
אלגוריתם דייקסטרה פתר את בעיית המסלולים הקלים ביותר 
\series bold
ממקור יחיד
\series default
.
 כעת אנו רוצים לעסוק בבעיית המסלולים הקלים ביותר בין כל זוג צמתים בגרף:
\end_layout

\begin_layout Definition

\series bold
בעיית המסלולים הקלים בין כל הזוגות
\series default
: בהינתן 
\begin_inset Formula $G$
\end_inset

 גרף מכוון ממושקל, למצוא עבור כל 
\begin_inset Formula $u,v\in V$
\end_inset

 את 
\begin_inset Formula $\delta\left(u,v\right)$
\end_inset

 ומסלול 
\begin_inset Formula $u\overset{p}{\rightsquigarrow v}$
\end_inset

 שזהו משקלו.
\end_layout

\begin_layout Standard
דרך פתרון אפשרית אחת היא להריץ את אלגוריתם דייקסטרה 
\begin_inset Formula $\left|V\right|$
\end_inset

 פעמים, פעם אחת לכל צומת בגרף.
 זה פתרון שמניב זמן ריצה של 
\begin_inset Formula $O\left(\left|V\right|^{2}\log\left|V\right|+\left|V\right|\left|E\right|\right)$
\end_inset

 עבור המימוש הטוב ביותר של דייקסטרה.
\end_layout

\begin_layout Standard
גישה אחרת היא להשתמש באלגוריתם פלויד-וורשאל, שסיבוכיות זמן הריצה שלו היא
 
\begin_inset Formula $O\left(\left|V\right|^{3}\right)$
\end_inset

 - לכאורה פחות טובה מזו של דייקסטה, אך יש מספר סיבות להציג אותו:
\end_layout

\begin_layout Itemize
פלויד-וורשאל יודע להתמודד עם הסיטואציה של קיום קשתות שליליות בגרף )אך לא
 קיום מעגל שסכום המשקלים עליו שלילי(.
 במצב כזה לא ניתן להשתמש בדייקסטרה, ואלגוריתם חלופי כמו בלמן-פורד דורש סיבוכיות
 זמן ריצה גבוהה יותר.
\end_layout

\begin_layout Itemize
זמן הריצה בפועל של פלויד-וורשאל עשוי להיות טוב משל השימוש הזה בדייקסטרה
 עקב האופי השונה של האלגוריתמים.
\end_layout

\begin_layout Itemize
הרעיון שעומד מאחורי פלויד-וורשאל מעניין בפני עצמו )ובמובן מסויים, פשוט מזה
 של דייקסטרה( ומצדיק היכרות עמו.
\end_layout

\begin_layout Subsubsection
תיאור אלגוריתם פלויד-וורשאל
\end_layout

\begin_layout Standard
לצורך האלגוריתם נמספר את צמתי 
\begin_inset Formula $V$
\end_inset

 מ-
\numeric on
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עד 
\begin_inset Formula $n$
\end_inset

: 
\begin_inset Formula $V=\left\{ v_{1},v_{2},\ldots,v_{n}\right\} $
\end_inset

.
 כמו כן נגדיר מטריצה 
\begin_inset Formula $W\in M_{n\times n}\left(\mathbb{R\cup\left\{ \infty\right\} }\right)$
\end_inset

 של 
\series bold
משקלים
\series default
 שנותנת משקל לכל זוג סדור של צמתים בגרף, באופן הבא:
\end_layout

\begin_layout Standard
\begin_inset Formula $\left[W\right]_{ij}=\begin{cases}
0 & i=j\\
w\left(v_{i},v_{j}\right) & i\ne j,\left(v_{i},v_{j}\right)\in E\\
\infty & i\ne j,\left(v_{i},v_{j}\right)\notin E
\end{cases}$
\end_inset


\end_layout

\begin_layout Standard
הרעיון מאחורי האלגוריתם הוא לתחזק מטריצה 
\begin_inset Formula $D\in M_{n\times n}\left(\mathbb{R\cup\left\{ \infty\right\} }\right)$
\end_inset

 של 
\series bold
מרחקים
\series default
: מטרתנו היא להבטיח שבסוף ריצת האלגוריתם יתקיים 
\begin_inset Formula $\left[D\right]_{ij}=\delta\left(v_{i},v_{j}\right)$
\end_inset

.
 האלגוריתם מבצע זאת על ידי סדרת שיפורים הדרגתיים שמניבה סדרה של מטריצות:
 
\begin_inset Formula $D^{0},D^{1},D^{2},\ldots,D^{n}$
\end_inset

 כך שמתקיים העיקרון הכללי הבא: 
\end_layout

\begin_layout Standard
\begin_inset Formula $\left[D^{k}\right]_{ij}$
\end_inset

 שווה למשקל המסלול הקל ביותר מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 ש
\series bold
צמתי הביניים
\series default
 שבהם הוא עובר הם בעלי אינדקס 
\begin_inset Formula $k$
\end_inset

 לכל היותר )צמתי הביניים של מסלול הם כל הצמתים בו למעט הראשון והאחרון(.
\end_layout

\begin_layout Standard
קל לראות ש-
\begin_inset Formula $D^{0}=W$
\end_inset

.
 כיצד ניתן לחשב את 
\begin_inset Formula $D^{k}$
\end_inset

 מתוך 
\begin_inset Formula $D^{k-1}$
\end_inset

? באמצעות האבחנה הבאה: אם המסלול הקל ביותר מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 שצמתי הביניים שלו הם בעלי אינדקס לכל היותר 
\begin_inset Formula $k$
\end_inset

 
\series bold
לא כולל
\series default
 את 
\begin_inset Formula $v_{k}$
\end_inset

 בתור צומת ביניים, אז 
\begin_inset Formula $\left[D^{k}\right]_{ij}=\left[D^{k-1}\right]_{ij}$
\end_inset

.
\end_layout

\begin_layout Standard
אם המסלול 
\series bold
כן כולל
\series default
 את 
\begin_inset Formula $v_{k}$
\end_inset

 אז הוא יכלול אותו רק פעם אחת, ואפשר לפצל את המסלול לשלושה חלקים:
\end_layout

\begin_layout Standard
\begin_inset Formula $v_{i}\rightsquigarrow^{p}v_{k}\rightsquigarrow^{q}v_{j}$
\end_inset


\end_layout

\begin_layout Standard
כך שהמסלולים 
\begin_inset Formula $p,q$
\end_inset

 
\series bold
אינם
\series default
 משתמשים בצומת 
\begin_inset Formula $v_{k}$
\end_inset

 ולכן כל צמתי הביניים שלהם הם בעלי אינדקס 
\begin_inset Formula $k-1$
\end_inset

 לכל היותר.
 מכאן שהמסלול הקל ביותר שעושה שימוש ב-
\begin_inset Formula $v_{k}$
\end_inset

 נבנה מתוך שני מסלולים קלים ביותר השייכים כבר ל-
\begin_inset Formula $D^{k-1}$
\end_inset

: מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{k}$
\end_inset

 ומ-
\begin_inset Formula $v_{k}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

.
 כלומר מתקיים במקרה זה:
\end_layout

\begin_layout Standard
\begin_inset Formula $\left[D^{k}\right]_{ij}=\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}$
\end_inset


\end_layout

\begin_layout Standard
ועל כן אם נגדיר
\end_layout

\begin_layout Standard
\begin_inset Formula $\left[D^{k}\right]_{ij}=\min\left\{ \left[D^{k-1}\right]_{ij},\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}\right\} $
\end_inset


\end_layout

\begin_layout Standard
כלל העדכון הזה יאפשר לנו לחשב אינדוקטיבית את 
\begin_inset Formula $D^{n}$
\end_inset

.
\end_layout

\begin_layout Standard
חישוב המסלול הקצר ביותר ניתן לביצוע במקביל לחישוב 
\begin_inset Formula $D$
\end_inset

 )או לאחר מכן, מתוך 
\begin_inset Formula $D$
\end_inset

(.
 גם לצורך כך נגדיר מטריצה: 
\begin_inset Formula $\left[\Pi\right]_{ij}$
\end_inset

 תהיה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
None
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אם אין מסלול מ-
\begin_inset Formula $i$
\end_inset

 אל 
\begin_inset Formula $j$
\end_inset

, ואם קיים מסלול כזה, אז היא 
\begin_inset Formula $\left[\Pi\right]_{ij}=t$
\end_inset

 כך ש-
\begin_inset Formula $v_{t}$
\end_inset

 הוא הקודם המיידי של 
\begin_inset Formula $v_{j}$
\end_inset

 במסלול קל ביותר מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

, כלומר המסלול הקל ביותר הוא מהצורה 
\begin_inset Formula $v_{i}\rightsquigarrow v_{t}\to v_{j}$
\end_inset

.
\end_layout

\begin_layout Standard
כמו עם 
\begin_inset Formula $D$
\end_inset

, כך גם את 
\begin_inset Formula $\Pi$
\end_inset

 נחשב איטרטיבית על ידי סדרה 
\begin_inset Formula $\Pi^{0},\Pi^{1},\ldots,\Pi^{n}$
\end_inset

 שמצייתת לאותו עיקרון: 
\begin_inset Formula $\left[\Pi^{k}\right]_{ij}$
\end_inset

 הוא הקודם המיידי של 
\begin_inset Formula $v_{j}$
\end_inset

 במסלול הקל ביותר מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 שעובר דרך צמתי ביניים עם אינדקס לכל היותר 
\begin_inset Formula $k$
\end_inset

.
 האתחול מתאים לסיטואציה של מסלול שעובר בצעד בודד מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 כך שאין בו צמתי ביניים:
\end_layout

\begin_layout Standard
\begin_inset Formula $\left[\Pi^{0}\right]_{ij}=\begin{cases}
i & \left[W\right]_{ij}<\infty\\
\text{None} & \left[W\right]_{ij}=\infty
\end{cases}$
\end_inset


\end_layout

\begin_layout Standard
והתיקון האיטרטיבי מתבצע בהתאם לבחירה אם הועדף המסלול שלא עובר דרך 
\begin_inset Formula $v_{k}$
\end_inset

 או שהועדף המסלול שעובר דרכו:
\end_layout

\begin_layout Standard
\begin_inset Formula $\left[\Pi^{k}\right]_{ij}=\begin{cases}
\left[\Pi^{k-1}\right]_{ij} & \left[D^{k-1}\right]_{ij}\le\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}\\
\left[\Pi^{k-1}\right]_{kj} & \left[D^{k-1}\right]_{ij}>\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}
\end{cases}$
\end_inset


\end_layout

\begin_layout Standard
נציג מימוש בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של אלגוריתם פלויד-וורשאל:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def floyd_warshall(W):
\end_layout

\begin_layout Plain Layout

2      n = len(W)
\end_layout

\begin_layout Plain Layout

3      D = [[W[i][j] for j in range(n)] for i in range(n)]
\end_layout

\begin_layout Plain Layout

4      Pi = [[i if W[i][j] != math.inf else None for j in range(n)] for i
 in range(n)]
\end_layout

\begin_layout Plain Layout

5      for k in range(n):
\end_layout

\begin_layout Plain Layout

6          D_new = [[D[i][j] for j in range(n)] for i in range(n)]
\end_layout

\begin_layout Plain Layout

7          Pi_new = [[Pi[i][j] for j in range(n)] for i in range(n)]
\end_layout

\begin_layout Plain Layout

8          for i in range(n):
\end_layout

\begin_layout Plain Layout

9              for j in range(n):
\end_layout

\begin_layout Plain Layout

10                 if D[i][j] > D[i][k] + D[k][j]:
\end_layout

\begin_layout Plain Layout

11                     D_new[i][j] = D[i][k] + D[k][j]
\end_layout

\begin_layout Plain Layout

12                     Pi_new[i][j] = Pi[k][j]
\end_layout

\begin_layout Plain Layout

13         D = D_new
\end_layout

\begin_layout Plain Layout

14         Pi = Pi_new
\end_layout

\begin_layout Plain Layout

15     return D, Pi
\end_layout

\end_inset


\end_layout

\begin_layout Standard
בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3,4
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מאתחלים את 
\begin_inset Formula $D^{0},\Pi^{0}$
\end_inset

.
 העדכון עצמו מתבצע בצורה הבאה: בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6,7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מעתיקים את 
\begin_inset Formula $D^{k-1},\Pi^{k-1}$
\end_inset

 כמות שהם ומשנים אותם )בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
11,12
\numeric off
( רק אם התקיים התנאי 
\begin_inset Formula $\left[D^{k-1}\right]_{ij}>\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}$
\end_inset

 )שנבדק בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\numeric off
(.
\end_layout

\begin_layout Standard
המימוש שלנו מניח שאנו מקבלים את 
\begin_inset Formula $W$
\end_inset

 המורחב.
 ניתן בפייתון לבנות אותו מתוך הגרף 
\begin_inset Formula $G$
\end_inset

 באמצעות הקסם הבא, שלא קריטי להבין:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def build_W(G):
\end_layout

\begin_layout Plain Layout

2     n = len(G.V)
\end_layout

\begin_layout Plain Layout

3     W = [[0 if i == j 
\end_layout

\begin_layout Plain Layout

4           else w[(G.V[i],G.V[j])] if (G.V[i],G.V[j]) in G.w 
\end_layout

\begin_layout Plain Layout

5           else math.inf 
\end_layout

\begin_layout Plain Layout

6           for j in range(n)] 
\end_layout

\begin_layout Plain Layout

7           for i in range(n)]
\end_layout

\begin_layout Plain Layout

8     return W
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
ניתוח סיבוכיות ונכונות של אלגוריתם פלויד-וורשאל
\end_layout

\begin_layout Standard
סיבוכיות אלגוריתם פלויד-וורשאל פשוטה מאוד: הוא מבצע קינון של שלוש לולאות
 )שורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5,9,10
\numeric off
( שכל אחת מהן רצה 
\begin_inset Formula $\left|V\right|$
\end_inset

 צעדים, כך שזמן הריצה שלו הוא 
\begin_inset Formula $\Theta\left(\left|V\right|^{3}\right)$
\end_inset

.
 נעבור להוכחת הנכונות שלו, שמפרמלת את ההסבר שהצגנו קודם.
\end_layout

\begin_layout Theorem
בסיום ריצת אלגוריתם פלויד-וורשאל, 
\begin_inset Formula $\left[D\right]_{ij}=\delta\left(v_{i},v_{j}\right)$
\end_inset


\end_layout

\begin_layout Proof
נוכיח באינדוקציה טענה חזקה יותר: אם 
\begin_inset Formula $D^{k}$
\end_inset

 היא המטריצה המתקבלת לאחר 
\begin_inset Formula $k$
\end_inset

 הפעלות של הלולאה שבשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\numeric off
, אז 
\begin_inset Formula $\left[D^{k}\right]_{ij}$
\end_inset

 הוא משקל המסלול הקל ביותר מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 שאינו עובר דרך צמתי ביניים בעלי אינדקס גדול מ-
\begin_inset Formula $k$
\end_inset

, או ש-
\begin_inset Formula $\left[D^{k}\right]_{ij}=\infty$
\end_inset

 אם מסלול כזה אינו קיים.
\end_layout

\begin_layout Proof
עבור 
\begin_inset Formula $k=0$
\end_inset

, מכיוון שצמתי הגרף אונדקסו בתור 
\begin_inset Formula $\left\{ v_{1},\ldots,v_{n}\right\} $
\end_inset

, כל צומת הוא בעל אינדקס גדול מ-
\begin_inset Formula $k$
\end_inset

 ולכן המסלולים היחידים מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 שבאים בחשבון הם אלו מאורך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 )רק כאשר 
\begin_inset Formula $i=j$
\end_inset

( או 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
.
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $i=j$
\end_inset

 אז המסלולים מ-
\begin_inset Formula $v_{i}$
\end_inset

 לעצמו כוללים את המסלול הריק שמשקלו
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ואולי מסלול מהצורה 
\begin_inset Formula $v_{i}\to v_{i}$
\end_inset

 אם קיימת קשת מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל עצמו.
 מכיוון שהנחנו שאין בגרף מעגלים עם משקל שלילי, משקל המסלול הזה הוא אי-שלילי
 ולכן משקל המסלול הקל ביותר הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\numeric off
.
 ואמנם 
\begin_inset Formula $\left[W\right]_{ii}=0$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
build_W
\lang hebrew
(.
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $i\ne j$
\end_inset

 וקיימת הקשת 
\begin_inset Formula $v_{i}\to v_{j}$
\end_inset

 אז המסלול היחיד מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 שמקיים את התנאי הוא המסלול 
\begin_inset Formula $v_{i}\to v_{j}$
\end_inset

 שמשקלו 
\begin_inset Formula $w\left(i,j\right)$
\end_inset

 והוא אכן שווה ל-
\begin_inset Formula $\left[W\right]_{ij}$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
4
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
build_W
\lang hebrew
(.
 אם לא קיימת הקשת 
\begin_inset Formula $v_{i}\to v_{j}$
\end_inset

 אז לא קיים מסלול כלל ואכן 
\begin_inset Formula $\left[W\right]_{ij}=\infty$
\end_inset

 )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
build_W
\lang hebrew
(.
 
\end_layout

\begin_layout Proof
נעבור אל צעד האינדוקציה.
 יהיו 
\begin_inset Formula $i,j$
\end_inset

 כלשהם.
 אם לא קיים מסלול מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 שצמתי הביניים בו הם כולם מאינדקס לכל היותר 
\begin_inset Formula $k$
\end_inset

 אז בפרט לא קיים מסלול כזה גם עבור צמתי ביניים מאינדקס לכל היותר 
\begin_inset Formula $k-1$
\end_inset

 כך שעל פי הנחת האינדוקציה 
\begin_inset Formula $\left[D^{k-1}\right]_{ij}=\infty$
\end_inset

.
 בנוסף, לא ייתכן שקיים גם מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{k}$
\end_inset

 ומ-
\begin_inset Formula $v_{k}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 שמקיימים את תנאי האינדקסים עבור 
\begin_inset Formula $k-1$
\end_inset

 כי שרשור המסלולים מניב מסלול מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 שמקיים את תנאי האינדקסים עבור 
\begin_inset Formula $k$
\end_inset

.
 כלומר, 
\begin_inset Formula $\left[D^{k-1}\right]_{ik}=\infty$
\end_inset

 או 
\begin_inset Formula $\left[D^{k-1}\right]_{kj}=\infty$
\end_inset

 ובכל מקרה 
\begin_inset Formula $\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}=\infty$
\end_inset

.
 לכן התנאי בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אינו מתקיים, ועל פי ההשמה בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נקבל 
\begin_inset Formula $\left[D^{k}\right]_{ij}=\left[D^{k-1}\right]_{ij}=\infty$
\end_inset

 כנדרש.
\end_layout

\begin_layout Proof
נניח כעת כי קיים מסלול כזה וניקח את המסלול הקל ביותר מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 עם אינדקסים לכל היותר 
\begin_inset Formula $k$
\end_inset

.
 אם 
\begin_inset Formula $v_{k}$
\end_inset

 לא מופיע במסלול הזה אז על פי הנחת האינדוקציה 
\begin_inset Formula $\left[D^{k}\right]_{k-1}$
\end_inset

 שווה למשקל מסלול זה ובהכרח יתקיים 
\begin_inset Formula $\left[D^{k}\right]_{k-1}\le\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}$
\end_inset

, אחרת המסלול הקל ביותר יתקבל משרשור שני המסלולים בעלי המשקלים 
\begin_inset Formula $\left[D^{k-1}\right]_{ik},\left[D^{k-1}\right]_{kj}$
\end_inset

.
 לכן התנאי בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אינו מתקיים גם במקרה זה ונקבל 
\begin_inset Formula $\left[D^{k}\right]_{ij}=\left[D^{k-1}\right]_{ij}$
\end_inset

 כנדרש.
\end_layout

\begin_layout Proof
אם לעומת זאת 
\begin_inset Formula $v_{k}$
\end_inset

 כן מופיע במסלול הקל ביותר, נתבונן במסלול זה: 
\begin_inset Formula $v_{i}\rightsquigarrow^{p}v_{k}\rightsquigarrow^{q}v_{j}$
\end_inset

.
 אם 
\begin_inset Formula $v_{k}$
\end_inset

 מופיע בו יותר מפעם אחת זה יוצר מעגל, ועל פי ההנחה שלנו אין בגרף מעגלים
 בעלי משקל שלילי כך שאפשר להסיר את המעגל מהמסלול ולקבל מסלול עם אותו משקל
 )או קל יותר(, ולכן ניתן להניח שבמסלול שלקחנו 
\begin_inset Formula $v_{k}$
\end_inset

 מופיע בדיוק פעם אחת.
 לכן 
\begin_inset Formula $p,q$
\end_inset

 מקיימים את תנאי האינדקסים עבור 
\begin_inset Formula $k-1$
\end_inset

 ובהכרח משקלם שווה ל-
\begin_inset Formula $\left[D^{k-1}\right]_{ik},\left[D^{k-1}\right]_{kj}$
\end_inset

 )אחרת היה אפשר להחליף אותם במסלולים קלים יותר(.
\end_layout

\begin_layout Proof
כעת, אם 
\begin_inset Formula $\left[D^{k-1}\right]_{ij}=\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}$
\end_inset

 אז התנאי בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
לא יופעל ונקבל 
\begin_inset Formula $\left[D^{k}\right]_{ij}=\left[D^{k-1}\right]_{ij}=\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}$
\end_inset

, כנדרש.
\end_layout

\begin_layout Proof
אם לעומת זאת 
\begin_inset Formula $\left[D^{k-1}\right]_{ij}>\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}$
\end_inset

 התנאי בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כן יופעל וההשמה בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
11
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תגרום לכך שיתקיים 
\begin_inset Formula $\left[D^{k}\right]_{ij}=\left[D^{k-1}\right]_{ik}+\left[D^{k-1}\right]_{kj}$
\end_inset

, כנדרש.
\end_layout

\begin_layout Standard
כרגיל, יש להוכיח גם כי האלגוריתם מצליח לא רק לחשב את משקל המסלולים הקלים
 ביותר אלא גם למצוא אותם:
\end_layout

\begin_layout Theorem
לכל 
\begin_inset Formula $i$
\end_inset

 נגדיר פונקציה 
\begin_inset Formula $\pi_{i}\left(v_{j}\right)=\left[\Pi\right]_{ij}$
\end_inset

 עבור ערכו של 
\begin_inset Formula $\Pi$
\end_inset

 בסיום ריצת האלגוריתם.
 אם לא קיים מסלול מ-
\begin_inset Formula $v_{i}$
\end_inset

 אל 
\begin_inset Formula $v_{j}$
\end_inset

 אז 
\begin_inset Formula $\pi_{i}\left(j\right)=\text{None}$
\end_inset

.
 אחרת, קיים 
\begin_inset Formula $t$
\end_inset

 כך ש-
\begin_inset Formula $v_{i}=\pi^{t}\left(v_{j}\right)$
\end_inset

 והמסלול 
\begin_inset Formula $\pi^{t}\left(v_{j}\right)\to\pi^{t-1}\left(v_{j}\right)\to\cdots\to\pi^{0}\left(v_{j}\right)$
\end_inset

 הוא ממשקל 
\begin_inset Formula $\delta\left(v_{i},v_{j}\right)$
\end_inset

.
\end_layout

\begin_layout Proof
כמו במקרה של דייקסטרה, ההוכחה דומה באופיה להוכחות שכבר ראינו ולא נציג אותה
 כאן.
\end_layout

\begin_layout Subsection
אלגוריתם חיפוש לעומק )
\lang english
DFS
\lang hebrew
(
\end_layout

\begin_layout Subsubsection
תיאור אלגוריתם 
\lang english
DFS
\end_layout

\begin_layout Standard
הרעיון באלגוריתם חיפוש לעומק הוא לבצע סריקה של גרף החל מצומת התחלתי כדי
 למצוא את כל הצמתים הישיגים ממנו, אך לעשות זאת בצורה שונה מ-
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שהיא אולי טבעית יותר בביצוע בידי בני אדם: להתחיל ללכת לאורך אחד מהמסלולים
 בגרף תוך סימון הצמתים שאנו עוברים בהם, עד שאנו 
\begin_inset Quotes eld
\end_inset

נתקעים
\begin_inset Quotes erd
\end_inset

 בצומת שאין ממנו יציאה לצומת שביקרנו ממנו.
 במצב שכזה חוזרים צעד אחד אחורה ובודקים אם קיימת שם קשת אל צומת שטרם ביקרנו
 בו, וכן הלאה.
\end_layout

\begin_layout Standard
ב-
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מבנה הנתונים ששימש לניהול סדר העדיפויות בבדיקת צמתים היה 
\series bold
תור
\series default
: בכל שלב, הכנסנו אל התור את הצמתים שטרם ביקרנו בהם מבין שכניו של הצומת
 הנוכחי אותו בדקנו, והצמתים הוצאו מהתור על פי עיקרון
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
First-in-first-out
\lang hebrew
.
 ב-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
לעומת זאת מבנה הנתונים שבו נשתמש הוא 
\series bold
מחסנית
\series default
 שפועל על פי עיקרון
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Last-in-first-out
\lang hebrew
; בכל שלב נוסיף למחסנית את כל השכנים שטרם ביקרנו בהם של הצומת שאנו בודקים
 באותו שלב.
\end_layout

\begin_layout Standard
ברוב שפות התכנות ניתן לממש
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באמצעות 
\series bold
רקורסיה
\series default
, כלומר פונקציה שקוראת לעצמה.
 מאחורי הקלעים של שפת התכנות מנגנון הרקורסיה ממומש באמצעות מחסנית, שבה נשמר
 המידע הרלוונטי לכל קריאה של הפונקציה )בפרט, ייצוג כלשהו של הצמתים שנבדקים
 במהלך קריאה זו(.
 זה הופך את המימוש של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בשפות כאלו לפשוט יחסית.
\end_layout

\begin_layout Standard
אנו נציג כיצד ניתן להשתמש ב-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כדי למצוא 
\series bold
מיון טופולוגי
\series default
 של גרף וכדי למצוא 
\series bold
רכיבים קשירים היטב
\series default
 של גרף.
 לצורך כך נממש את ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בצורה ששומרת בצמתים מידע נוסף שיהיה שימושי לצרכים הללו.
\end_layout

\begin_layout Standard
נציג מימוש של אלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בשפת פייתון:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def DFS(G):
\end_layout

\begin_layout Plain Layout

2     for u in G.V:
\end_layout

\begin_layout Plain Layout

3         u.color = 'white'
\end_layout

\begin_layout Plain Layout

4         u.pi = None
\end_layout

\begin_layout Plain Layout

5     time = 0
\end_layout

\begin_layout Plain Layout

6     for u in G.V:
\end_layout

\begin_layout Plain Layout

7         if u.color == 'white':
\end_layout

\begin_layout Plain Layout

8             time = DFS_visit(G, u, time)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
הקוד של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\lang hebrew
 הזה הוא מעטפת לחלק הרקורסיבי של האלגוריתם, שיתבצע ב-
\lang english
DFS_visit
\lang hebrew
.
 ב-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעים שני דברים: 
\end_layout

\begin_layout Enumerate
אתחול המידע של האלגוריתם )שכולל בשלב זה את צבעי הצמתים, ה-
\begin_inset Formula $\pi$
\end_inset

 שלהם שיצביע על הצומת שממנו נכנסו אליהם בסריקה ומשתנה בשם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
time
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שיאפשר לנו לעקוב אחר הסדר שבו צמתים התגלו והטיפול בהם הסתיים(
\end_layout

\begin_layout Enumerate
מעבר סדרתי על צמתי 
\begin_inset Formula $G$
\end_inset

 והפעלת האלגוריתם הרקורסיבי על כל אחד מהם שטרם טופל בהפעלות קודמות.
 זה שונה מ-
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שבו הסתפקנו בהפעלת האלגוריתם על צומת בודד ולא התעניינו בצמתים שאינם ישיגים
 ממנו.
\end_layout

\begin_layout Standard
נציג כעת את מימוש החלק הרקורסיבי של האלגוריתם:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def DFS_visit(G, u, time):
\end_layout

\begin_layout Plain Layout

2      time = time + 1
\end_layout

\begin_layout Plain Layout

3      u.d = time
\end_layout

\begin_layout Plain Layout

4      u.color = 'gray'
\end_layout

\begin_layout Plain Layout

5      for v in G.adjacency(u):
\end_layout

\begin_layout Plain Layout

6          if v.color == 'white':
\end_layout

\begin_layout Plain Layout

7              v.pi = u
\end_layout

\begin_layout Plain Layout

8              time = DFS_visit(G, v, time)
\end_layout

\begin_layout Plain Layout

9      u.color = 'black'
\end_layout

\begin_layout Plain Layout

10     time = time + 1
\end_layout

\begin_layout Plain Layout

11     u.f = time
\end_layout

\begin_layout Plain Layout

12     return time
\end_layout

\end_inset


\end_layout

\begin_layout Standard
האלגוריתם פועל כך: הוא מסמן את זמן תחילת הטיפול בצומת 
\begin_inset Formula $u$
\end_inset

 בתוך 
\begin_inset Formula $u.d$
\end_inset

 ואת זמן סיום הטיפול בו ב-
\begin_inset Formula $u.f$
\end_inset

, כשבכל פעם הזמן מוגדל ב-
\numeric on
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בדיוק לפני ההשמה הזו.
 הוא משנה את צבעו של 
\begin_inset Formula $u$
\end_inset

 לאפור עם תחילת הטיפול בו ומשנה את הצבע לשחור לאחר סיום הטיפול.
\end_layout

\begin_layout Standard
הטיפול עצמו כולל מעבר סדרתי על כל הצמתים שיש קשת מ-
\begin_inset Formula $u$
\end_inset

 אליהם, ולכל צומת כזה שטרם ביקרו בו )כלומר, צבעו לבן( מסומן 
\begin_inset Formula $v.\pi=u$
\end_inset

 ולאחר מכן האלגוריתם ממשיך לטפל רקורסיבית ב-
\begin_inset Formula $v$
\end_inset

 )כשהוא מעדכן את משתנה הזמן
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
time
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בהתאם למה שקרה בקריאה הרקורסיבית(.
\end_layout

\begin_layout Standard
הבדל מהותי אחד בין
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ובין
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא בכך שב-
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 הטיפול בצומת הסתיים 
\family default
\series bold
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
לפני
\series default
 שהחל הטיפול בצמתים שנתגלו במהלך הסריקה שלו; כאן אנו משהים את סימון סיום
 הטיפול עד 
\series bold
לאחר
\series default
 שטופלו הצמתים הבאים בתור.
\end_layout

\begin_layout Standard
סיבוכיות זמן הריצה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא 
\begin_inset Formula $O\left(\left|V\right|+\left|E\right|\right)$
\end_inset

 שכן האלגוריתם עובר סדרתית על כל הצמתים והקשתות בגרף.
\end_layout

\begin_layout Subsubsection
תכונות אלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\end_layout

\begin_layout Standard
על מנת להיעזר ב-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נרצה להבין טוב יותר מה מאפיין את אופן פעולתו.
\end_layout

\begin_layout Standard
האבחנה הראשונה היא כי כל הפעלה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS_visit
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
סורקת את הגרף במבנה של 
\series bold
עץ
\series default
 שמקודד על ידי הפונקציה 
\begin_inset Formula $\pi$
\end_inset

 שמתאימה לכל צומת את ההורה שלו בעץ.
 מכיוון ש-
\lang english
DFS_visit
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עשוי להיקרא מספר פעמים מתוך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על צמתים שונים, תת-הגרף שמקודד על ידי 
\begin_inset Formula $\pi$
\end_inset

 הוא 
\series bold
יער
\series default
, כלומר אוסף של עצים.
 למרות זאת, נמשיך לדבר בחופשיות על 
\begin_inset Quotes eld
\end_inset

עץ ה-
\lang english
DFS
\lang hebrew

\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
כל צומת מתווסף לעץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כאשר שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באלגוריתם מופעלת עבורו.
 באותו רגע, הצומת שאליו מחברים אותו הוא אפור )זו השפעת שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
4
\numeric off
( ואפשר להראות באינדוקציה שכל סדרת הצמתים שתתקבל באמצעות 
\begin_inset Formula $\pi$
\end_inset

 על הצמתים הללו תהיה אפורה, ושאלו הצמתים האפורים היחידים בשלב זה של האלגוריתם.
 המסקנה היא שאם צומת מתווסף לעץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אז אבותיו בעץ הם כל הצמתים האפורים, והוא אינו צאצא של אף צומת שאינו אפור
 בעץ.
\end_layout

\begin_layout Standard
אבחנה נוספת שנשתמש בה בחופשיות בהמשך הוא שכל הזמנים שמוכנסים לצמתים )
\begin_inset Formula $u.d$
\end_inset

 ו-
\begin_inset Formula $u.f$
\end_inset

( הם שונים זה מזה עבור כל הצמתים בגרף.
 זאת מכיוון שהמשתנה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
time
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא 
\begin_inset Quotes eld
\end_inset

גלובלי
\begin_inset Quotes erd
\end_inset

 במובן זה שכל שינוי בו בתוך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS_visit
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מוחזר החוצה ומועבר לקריאות הבאות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS_visit
\lang hebrew
, ומכיוון שלפני כל השמה ב-
\begin_inset Formula $u.d,u.f$
\end_inset

 ערכו של המשתנה מוגדל ב-
\numeric on
1
\numeric off
.
\end_layout

\begin_layout Standard
נתאר כעת את מה שמכונה 
\series bold
תכונת הסוגריים
\series default
 של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\lang hebrew
.
 בשימוש 
\begin_inset Quotes eld
\end_inset

אמיתי
\begin_inset Quotes erd
\end_inset

 בסוגריים, ביטוי כמו 
\begin_inset Formula $([)]$
\end_inset

 אינו חוקי כי הסוגריים העגולים נסגרים לפני הסוגריים המרובעים; האינטואיציה
 היא כי מכיוון שהסוגריים המרובעים נפתחו 
\series bold
אחרי
\series default
 שהסוגריים העגולים נפתחו אבל לפני שהסוגריים העגולים נסגרו, הם צריכים להיסגר
 
\series bold
לפני
\series default
 שהסוגריים העגולים נסגרים.
 אפשרות אחרת היא שהסוגריים המרובעים ייפתחו 
\series bold
אחרי
\series default
 שהסוגריים העגולים ייסגרו.
 כלומר, שתי האפשרויות הבאות הן חוקיות:
\end_layout

\begin_layout Itemize
\begin_inset Formula $\left(\left[\right]\right)$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\left(\right)\left[\right]$
\end_inset


\end_layout

\begin_layout Standard
תכונת הסוגריים של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אומרת שדבר דומה קורה כאשר מסתכלים על זמני תחילת וסיום הטיפול בצמתים:
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:משפט-תכונת-הסוגריים"

\end_inset

יהיו 
\begin_inset Formula $u,v\in V$
\end_inset

 ונניח בלי הגבלת הכלליות ש-
\begin_inset Formula $u.d<v.d$
\end_inset

.
 אז בדיוק אחת משתי האפשרויות הבאות מתקיימת:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $u.d<v.d<v.f<u.f$
\end_inset

 )
\begin_inset Quotes erd
\end_inset

המקרה 
\begin_inset Formula $\left(\left[\right]\right)$
\end_inset


\begin_inset Quotes erd
\end_inset

(.
 במקרה זה, 
\begin_inset Formula $v$
\end_inset

 הוא צאצא של 
\begin_inset Formula $u$
\end_inset

 בעץ ה-
\lang english
DFS
\lang hebrew
.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $u.d<u.f<v.d<v.f$
\end_inset

 )
\begin_inset Quotes erd
\end_inset

המקרה 
\begin_inset Formula $\left(\right)\left[\right]$
\end_inset


\begin_inset Quotes erd
\end_inset

(.
 במקרה זה, אף צומת אינו צאצא של השני בעץ ה-
\lang english
DFS
\lang hebrew
.
\end_layout

\begin_layout Proof
יש בדיוק שתי אפשרויות: או ש-
\begin_inset Formula $v.d<u.f$
\end_inset

 או ש-
\begin_inset Formula $u.f<v.d$
\end_inset

.
 כל אפשרות תניב את אחד המקרים שלנו.
\end_layout

\begin_layout Proof

\series bold
מקרה א'
\series default
: 
\begin_inset Formula $v.d<u.f$
\end_inset

 )הטיפול ב-
\begin_inset Formula $v$
\end_inset

 מתחיל לפני שהטיפול ב-
\begin_inset Formula $u$
\end_inset

 מסתיים(
\end_layout

\begin_layout Proof
במקרה זה עלינו להוכיח ש-
\begin_inset Formula $v.f<u.f$
\end_inset

 וש-
\begin_inset Formula $v$
\end_inset

 הוא צאצא של 
\begin_inset Formula $u$
\end_inset

 בעץ ה-
\lang english
DFS
\lang hebrew
.
 נשים לב לכך שערכו של 
\begin_inset Formula $u.d$
\end_inset

 נקבע בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וערכו של 
\begin_inset Formula $u.f$
\end_inset

 נקבע בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
11
\numeric off
, כך שהגעת האלגוריתם אל שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עבור 
\begin_inset Formula $v$
\end_inset

 מתבצעת בין הפעלת שתי שורות אלו עבור 
\begin_inset Formula $u$
\end_inset

.
 כדי לחזור אל 
\begin_inset Formula $u$
\end_inset

 האלגוריתם צריך לסיים את הפעלת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS_visit
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עבור 
\begin_inset Formula $v$
\end_inset

, כלומר להגיע לשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
11
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של 
\begin_inset Formula $v$
\end_inset

 ולקבוע את ערכו של 
\begin_inset Formula $v.f$
\end_inset

, ולכן 
\begin_inset Formula $v.f<u.f$
\end_inset

.
\end_layout

\begin_layout Proof
מכיוון ש-
\begin_inset Formula $v.f<u.f$
\end_inset

 הרי שכאשר 
\begin_inset Formula $v$
\end_inset

 התווסף לעץ ה-
\lang english
DFS
\lang hebrew
, הצומת 
\begin_inset Formula $u$
\end_inset

 היה אפור ולכן )מההערה שאמרנו קודם( 
\begin_inset Formula $v$
\end_inset

 יהיה צאצא שלו.
\end_layout

\begin_layout Proof

\series bold
מקרה ב': 
\series default

\begin_inset Formula $u.f<v.d$
\end_inset

 )הטיפול ב-
\begin_inset Formula $v$
\end_inset

 מתחיל אחרי שהטיפול ב-
\begin_inset Formula $u$
\end_inset

 מסתיים(
\end_layout

\begin_layout Proof
במצב זה מכיוון ש- 
\begin_inset Formula $v.d<v.f$
\end_inset

 ו-
\begin_inset Formula $u.d<u.f$
\end_inset

 שרשרת אי השוויונים מתקבלת מעצמה.
 מכיוון שבזמן הטיפול ב-
\begin_inset Formula $v$
\end_inset

 הצומת 
\begin_inset Formula $u$
\end_inset

 כבר לא היה אפור, נקבל ש-
\begin_inset Formula $v$
\end_inset

 אינו צאצא של 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Standard
נוכל כעת להסיק משפט שימושי נוסף:
\end_layout

\begin_layout Theorem
)
\begin_inset Quotes erd
\end_inset

משפט המסלול הלבן
\begin_inset Quotes erd
\end_inset

( הצומת 
\begin_inset Formula $v$
\end_inset

 הוא צאצא של 
\begin_inset Formula $u$
\end_inset

 בעץ
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 אם ורק אם כאשר האלגוריתם הופעל לראשונה על 
\begin_inset Formula $u$
\end_inset

 היה מסלול בגרף ממנו אל 
\begin_inset Formula $v$
\end_inset

 שכולל כולו צמתים לבנים.
\end_layout

\begin_layout Proof
כיוון ראשון )
\begin_inset Quotes erd
\end_inset

צאצא
\begin_inset Quotes erd
\end_inset

 גורר 
\begin_inset Quotes eld
\end_inset

קיום מסלול לבן
\begin_inset Quotes erd
\end_inset

(: אם 
\begin_inset Formula $v=u$
\end_inset

 המשפט בבירור נכון כי כאשר האלגוריתם מופעל על 
\begin_inset Formula $u$
\end_inset

, הוא עדיין לבן )שורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ב-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\numeric on
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ב-
\lang english
DFS_visit
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
דורשות זאת במפורש(.
 אם 
\begin_inset Formula $v$
\end_inset

 הוא צאצא כלשהו של 
\begin_inset Formula $u$
\end_inset

 ששונה ממנו, אז לפי המשפט הקודם, 
\begin_inset Formula $u.d<v.d$
\end_inset

.
 מכיוון שצבעו של צומת משתנה )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
4
\numeric off
( רק אחרי שערכו של 
\begin_inset Formula $d$
\end_inset

 שלו נקבע )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\numeric off
( נובע מכך שכאשר האלגוריתם מופעל על 
\begin_inset Formula $u$
\end_inset

, מכיוון ש-
\begin_inset Formula $v.d$
\end_inset

 טרם נקבע גם צבעו של 
\begin_inset Formula $v$
\end_inset

 טרם השתנה והוא לבן.
 מכיוון שהדבר נכון 
\series bold
לכל
\series default
 הצאצים של 
\begin_inset Formula $u$
\end_inset

, הוא נכון בפרט לאלו שנמצאים על המסלול בינו לבין כל 
\begin_inset Formula $v$
\end_inset

 קונקרטי שהוא צאצא שלו בעץ ה-
\lang english
DFS
\lang hebrew
.
\end_layout

\begin_layout Proof
כיוון שני )
\begin_inset Quotes erd
\end_inset

קיום מסלול לבן
\begin_inset Quotes erd
\end_inset

 גורר 
\begin_inset Quotes eld
\end_inset

צאצא
\begin_inset Quotes erd
\end_inset

(: יהא 
\begin_inset Formula $u$
\end_inset

 צומת כלשהו ונתבונן על מסלול לבן כלשהו בגרף בזמן הגילוי של 
\begin_inset Formula $u$
\end_inset

.
 נניח שלא כל צמתי המסלול הם צאצאים של 
\begin_inset Formula $u$
\end_inset

 בעץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וניקח בתור 
\begin_inset Formula $v$
\end_inset

 את הראשון שמביניהם על המסלול.
 בהכרח 
\begin_inset Formula $v\ne u$
\end_inset

 כי 
\begin_inset Formula $u$
\end_inset

 הוא תמיד צאצא של עצמו.
 לכן קיים צומת 
\begin_inset Formula $w$
\end_inset

 שהוא הקודם המיידי ל-
\begin_inset Formula $v$
\end_inset

 במסלול ו-
\begin_inset Formula $w$
\end_inset

 
\series bold
כן
\series default
 שייך לעץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Proof
ממשפט תכונת הסוגריים נובע ש-
\begin_inset Formula $u.d<w.d<w.f<u.f$
\end_inset

.
 כעת, מכיוון ש-
\begin_inset Formula $v$
\end_inset

 הוא בן של 
\begin_inset Formula $w$
\end_inset

 הוא יהיה אחד מהצמתים שעוברים עליהם בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS_visit
\lang hebrew
.
 לכן האלגוריתם יבקר בו בשלב זה, אם לא ביקר בו עוד מוקדם יותר, ולכן יתקיים
 
\begin_inset Formula $v.f<w.f<u.f$
\end_inset

.
 כמו כן, מכיוון ש-
\begin_inset Formula $v$
\end_inset

 היה לבן כאשר 
\begin_inset Formula $u$
\end_inset

 התגלה, 
\begin_inset Formula $u.d<v.d$
\end_inset

.
 כלומר אנחנו בסיטואציה 
\begin_inset Formula $u.d<v.d<v.f<u.f$
\end_inset

 של משפט תכונת הסוגריים ולכן 
\begin_inset Formula $v$
\end_inset

 הוא צאצא של 
\begin_inset Formula $u$
\end_inset

 בעץ ה-
\lang english
DFS
\lang hebrew
.
\end_layout

\begin_layout Subsubsection
סיווג הקשתות באלגוריתם
\family roman
\series bold
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\end_layout

\begin_layout Standard
בריצתו,
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בונה 
\series bold
עץ
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series bold
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)למעשה, יער(.
 הקשתות בעץ הזה הן קשתות בגרף המקורי 
\begin_inset Formula $G$
\end_inset

 שעליו רץ האלגוריתם.
 נשאלת השאלה - מה בדבר הקשתות האחרות? מתברר שמשתלם לסווג אותן לשלושה סוגים
 נוספים.
\end_layout

\begin_layout Definition
בהינתן עץ
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עבור גרף 
\begin_inset Formula $G$
\end_inset

 נסווג את קשתות 
\begin_inset Formula $G$
\end_inset

 ביחס לעץ:
\end_layout

\begin_layout Enumerate

\series bold
קשת עץ
\series default
 תהיה כל קשת השייכת לעץ ה-
\lang english
DFS
\lang hebrew
.
 כלומר, כל קשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 כך ש-
\begin_inset Formula $v.\pi=u$
\end_inset

.
\end_layout

\begin_layout Enumerate

\series bold
קשת אחורית
\series default
 תהיה קשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 כך ש-
\begin_inset Formula $v$
\end_inset

 הוא 
\series bold
אב קדמון
\series default
 של 
\begin_inset Formula $u$
\end_inset

 בעץ ה-
\lang english
DFS
\lang hebrew
.
 גם קשת מ-
\begin_inset Formula $u$
\end_inset

 לעצמו תיחשב קשת אחורית.
\end_layout

\begin_layout Enumerate

\series bold
קשת קדמית
\series default
 תהיה קשת 
\begin_inset Formula $\text{\left(u,v\right)}$
\end_inset

 כך ש-
\begin_inset Formula $v$
\end_inset

 הוא צאצא של 
\begin_inset Formula $u$
\end_inset

 בעץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אך הקשת אינה שייכת לעץ ה-
\lang english
DFS
\lang hebrew
.
\end_layout

\begin_layout Enumerate

\series bold
קשת חוצה
\series default
 תהיה כל קשת אחרת בגרף )כזו שמחברת שני צמתים שאף אחד מהם אינו אב קדמון של
 השני בעץ ה-
\lang english
DFS
\lang hebrew
(.
\end_layout

\begin_layout Standard
על מנת להיות פורמליים יש להוכיח כי כל קשת בגרף משתייכת בדיוק לאחת מהקבוצות
 הללו; נדלג על ההוכחה כאן.
\end_layout

\begin_layout Standard
אלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
יכול להיעזר בצבע הצמתים שהוא פוגש בגרף כדי לבצע סיווג חלקי של הקשתות עוד
 במהלך ריצתו.
 לצורך כך אפשר להרחיב את הבדיקה שמתבצעת בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\numeric off
, שבו במהלך סריקת צומת 
\begin_inset Formula $u$
\end_inset

 אנו בודקים את צבע השכן שלו 
\begin_inset Formula $v$
\end_inset

:
\end_layout

\begin_layout Itemize
אם צבע 
\begin_inset Formula $v$
\end_inset

 לבן אז 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 תהיה קשת עץ )בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אנחנו מוסיפים אותה לעץ(
\end_layout

\begin_layout Itemize
אם צבע 
\begin_inset Formula $v$
\end_inset

 אפור אז 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 היא קשת אחורית )כי הצבע האפור של 
\begin_inset Formula $v$
\end_inset

 מצביע על כך שאנחנו כרגע במהלך סריקת תת-עץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שלו(
\end_layout

\begin_layout Itemize
אם צבע 
\begin_inset Formula $v$
\end_inset

 שחור אז 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 היא או קשת קדמית )במקרה שבו כבר סרקנו את 
\begin_inset Formula $v$
\end_inset

, חזרנו קצת אחורה בעץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ואז נתקלנו בה שוב( או קשת חוצה )במקרה שבו 
\begin_inset Formula $v$
\end_inset

 בכלל הייתה שייכת לעץ
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אחר ביער ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שנסרק קודם(.
\end_layout

\begin_layout Subsubsection
מיון טופולוגי
\end_layout

\begin_layout Standard
כזכור, מיון 
\begin_inset Quotes eld
\end_inset

רגיל
\begin_inset Quotes erd
\end_inset

 של קבוצת איברים הוא מספור שלה, 
\begin_inset Formula $\left(v_{0},v_{1},\ldots,v_{n-1}\right)$
\end_inset

 כך ש-
\begin_inset Formula $v_{0}<v_{1}<\ldots<v_{n-1}$
\end_inset

.
 במיון כזה אנחנו מניחים שאפשר להשוות כל זוג איברים על פי יחס סדר לינארי,
 וכתוצאה מכך הרשימה הממוינת היא יחידה.
\end_layout

\begin_layout Standard
כעת נעסוק במקרה שבו התנאים מעט שונים: ייתכן שחלק מהאיברים לא יהיו ניתנים
 להשוואה כלל, והדרישה היחידה מהרשימה היא שאם 
\begin_inset Formula $v_{i}<v_{j}$
\end_inset

 אז 
\begin_inset Formula $i<j$
\end_inset

.
\end_layout

\begin_layout Standard
הדוגמא ה
\begin_inset Quotes erd
\end_inset

קלאסית
\begin_inset Quotes erd
\end_inset

 למיון טופולוגי היא לבישת בגדים: אין חשיבות של ממש לשאלה אם לובשים את המכנסיים
 או את החולצה קודם, אך אי אפשר ללבוש את התחתונים לאחר לבישת המכנסיים, או
 את הגרביים לאחר לבישת הנעליים.
 פתרון לבעיית המיון הוא רשימת הבגדים שיש ללבוש, מהראשון עד לאחרון, כך שלבישת
 הבגדים לא תהיה מלווה באסונות.
\end_layout

\begin_layout Standard
הדרך הטבעית לתאר רשימת אילוצים שכזו היא באמצעות גרף מכוון: האיברים שיש למיין
 הם צמתי הגרף, והקשת 
\begin_inset Formula $u\to v$
\end_inset

 פירושה ש-
\begin_inset Formula $u$
\end_inset

 חייב לבוא לפני 
\begin_inset Formula $v$
\end_inset

 במיון הטופולוגי.
 נגדיר זאת פורמלית:
\end_layout

\begin_layout Definition

\series bold
מיון טופולוגי
\series default
 של גרף מכוון 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 הוא פונקציה חח
\begin_inset Quotes erd
\end_inset

ע 
\begin_inset Formula $\varphi:V\to\mathbb{Z}$
\end_inset

 כך שאם קיימת קשת 
\begin_inset Formula $u\to v$
\end_inset

 אז 
\begin_inset Formula $\varphi\left(u\right)<\varphi\left(v\right)$
\end_inset

.
\end_layout

\begin_layout Definition
אם בגרף מכוון קיימים מעגלים, בבירור לא יכול להיות לו מיון טופולוגי, שכן
 אם 
\begin_inset Formula $\varphi$
\end_inset

 היא מיון טופולוגי של גרף שכזה ו-
\begin_inset Formula $u_{1}\to u_{2}\to\cdots\to u_{k}\to u_{1}$
\end_inset

 הוא מעגל, אז על ידי הפעלת 
\begin_inset Formula $\varphi$
\end_inset

 על הצמתים נקבל 
\begin_inset Formula $\varphi\left(u_{1}\right)<\varphi\left(u_{2}\right)<\ldots<\varphi\left(u_{k}\right)<\varphi\left(u_{1}\right)$
\end_inset

 ובפרט נקבל 
\begin_inset Formula $\varphi\left(u_{1}\right)\ne\varphi\left(u_{1}\right)$
\end_inset

 - סתירה.
\end_layout

\begin_layout Definition
לעומת זאת, לגרף מכוון חסר מעגלים )מה שמכונה באנגלית
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DAG
\lang hebrew
:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Directed Acyclic Graph
\lang hebrew
( קיים מיון טופולוגי וניתן להשתמש באלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כדי למצוא כזה:
\end_layout

\begin_layout Theorem
יהא 
\begin_inset Formula $G$
\end_inset

 גרף מכוון חסר מעגלים.
 לאחר הפעלת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על 
\begin_inset Formula $G$
\end_inset

, הפונקציה 
\begin_inset Formula $\varphi\left(v\right)=-v.f$
\end_inset

 היא מיון טופולוגי של 
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Standard
במילים אחרות - אם נסדר את הצמתים בגרף על פי הזמן שבו האלגוריתם סיים את הטיפול
 בהם, 
\series bold
מהסוף להתחלה
\series default
, נקבל מיון טופולוגי של הגרף.
\end_layout

\begin_layout Proof
תהא 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 קשת בגרף.
 עלינו להוכיח כי 
\begin_inset Formula $v.f<u.f$
\end_inset

.
 לצורך כך נפריד בין האפשרויות השונות לקשת זו:
\end_layout

\begin_deeper
\begin_layout Itemize
אם 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 היא קשת עץ או קשת קדמית, אז 
\begin_inset Formula $v$
\end_inset

 הוא צאצא של 
\begin_inset Formula $u$
\end_inset

 בעץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וממשפט תכונת הסוגריים 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:משפט-תכונת-הסוגריים"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $v.f<u.f$
\end_inset

.
\end_layout

\begin_layout Itemize
אם 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 היא קשת חוצה, אז בעת הגעת האלגוריתם אל קשת זו, 
\begin_inset Formula $v$
\end_inset

 כבר יהיה שחור, כלומר ערכו של 
\begin_inset Formula $v.f$
\end_inset

 כבר נקבע.
 עם זאת, ערכו של 
\begin_inset Formula $u.f$
\end_inset

 טרם נקבע
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 )כי האלגוריתם באמצע הסריקה של שכניו( ולכן 
\begin_inset Formula $v.f<u.f$
\end_inset

 גם במקרה זה.
\end_layout

\begin_layout Itemize
אם 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 היא קשת אחורית אז קיים בעץ ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מסלול מ-
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 שאינו משתמש בקשת זו.
 אם נשרשר את 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 לסוף המסלול נקבל מעגל בגרף, בסתירה לכך שהגרף חסר מעגלים.
 מכאן שמקרה זה אינו יכול להתרחש כלל.
\end_layout

\end_deeper
\begin_layout Standard
זמן הריצה של אלגוריתם זה הוא כזמן הריצה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
- 
\begin_inset Formula $O\left(\left|V\right|+\left|E\right|\right)$
\end_inset

.
 עבור מיון 
\begin_inset Quotes eld
\end_inset

רגיל
\begin_inset Quotes erd
\end_inset

 שבו כל זוג איברים ניתנים להשוואה נקבל ש-
\begin_inset Formula $\left|E\right|={\left|V\right| \choose 2}=\Theta\left(\left|V\right|^{2}\right)$
\end_inset

 כך שנקבל אלגוריתם מיון תת-אופטימלי; האלגוריתם שלעיל אפקטיבי בסיטואציות
 שבהן יש מיעוט יחסי של קשתות ב-
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Subsubsection
מציאת רכיבים קשירים היטב בגרף
\end_layout

\begin_layout Standard
נציג כעת שימוש מתוחכם יותר ב-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שמאפשר לנו למצוא 
\series bold
רכיבים קשירים היטב
\series default
 בגרף.
\end_layout

\begin_layout Standard
כזכור, גרף לא מכוון הוא 
\series bold
קשיר
\series default
 אם קיים מסלול בין כל שני צמתים.
 בגרף מכוון הסיטואציה מורכבת יותר כי ייתכן שיש מסלול מ-
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 אבל אין מסלול מ-
\begin_inset Formula $v$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

; המושג של 
\series bold
קשירות היטב 
\series default
בא לאפיין את הסיטואציה בה יש מסלולים בשני הכיוונים.
\end_layout

\begin_layout Definition
)
\series bold
רכיבים קשירים היטב( 
\series default
יהא 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 גרף מכוון.
 נגדיר יחס שקילות על 
\begin_inset Formula $V$
\end_inset

 באופן הבא: 
\begin_inset Formula $u\sim v$
\end_inset

 אם קיים מסלול 
\begin_inset Formula $u\rightsquigarrow v$
\end_inset

 וגם קיים מסלול 
\begin_inset Formula $v\rightsquigarrow u$
\end_inset

.
 מחלקות השקילות של יחס שקילות זה נקראות 
\series bold
הרכיבים הקשירים היטב
\series default
 של 
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Standard
קל לראות כי היחס שהגדרנו לעיל הוא אכן יחס שקילות ולכן מושג הרכיבים הקשירים
 היטב מוגדר היטב.
 בנוסף, עולה מכך שניתן לפרק את הגרף לאוסף של תתי-גרפים קשירים היטב, כך שכל
 צומת בגרף שייך לאחד הרכיבים )אפשר גם לחשוב עליהם בתור תתי-גרפים מקסימליים
 ביחס לתכונת הקשירות-היטב(.
 האתגר שלנו הוא למצוא את הפירוק הזה.
\end_layout

\begin_layout Standard
האלגוריתם כולל שתי הפעלות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
- אחת פשוטה ואחת מעט יותר מחוכמת.
 ראשית, בהינתן גרף 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 נגדיר את 
\begin_inset Formula $G^{R}=\left(V,E^{R}\right)$
\end_inset

 בתור הגרף המתקבל באמצעות היפוך הקשתות: 
\begin_inset Formula $E^{R}\triangleq\left\{ \left(v,u\right)\ |\ \left(u,v\right)\in E\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
כעת האלגוריתם ניתן לתיאור הבא:
\end_layout

\begin_layout Enumerate
הפעילו את
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על הגרף 
\begin_inset Formula $G$
\end_inset


\end_layout

\begin_layout Enumerate
מיינו את 
\begin_inset Formula $V$
\end_inset

 על פי 
\begin_inset Formula $u.f$
\end_inset

 בסדר יורד.
\end_layout

\begin_layout Enumerate
הפעילו את
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על 
\begin_inset Formula $G^{R}$
\end_inset

 עם קבוצת הצמתים הממויינת.
\end_layout

\begin_layout Enumerate
רכיבי הקשירות של 
\begin_inset Formula $G$
\end_inset

 הם העצים השונים ביער ה-
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שמתקבל משלב
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\numeric off
.
\end_layout

\begin_layout Standard
כלומר, האלגוריתם ניתן לביצוע על ידי שימוש בודד בגרסה הרגילה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
( ואז שימוש בוריאציה קלה על
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הרגיל:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def DFS(G):
\end_layout

\begin_layout Plain Layout

2     for u in G.V:
\end_layout

\begin_layout Plain Layout

3         u.color = 'white'
\end_layout

\begin_layout Plain Layout

4         u.pi = None
\end_layout

\begin_layout Plain Layout

5     time = 0
\end_layout

\begin_layout Plain Layout

6     for u in G.V:
\end_layout

\begin_layout Plain Layout

7         if u.color == 'white':
\end_layout

\begin_layout Plain Layout

8             time = DFS_visit(G, u, time)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של אלגוריתם ה-
\lang english
DFS
\lang hebrew
, נוודא שהמעבר על הצמתים מתבצע על פי המיון של שלב
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\numeric off
, ובעת הפעלת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS_visit
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נפעיל את הפונקציה עם מידע נוסף שמאפשר סימון של רכיב השקילות - למשל, את הצומת
 שממנו הבדיקה מתחילה, או מערך שלתוכו יוכנסו איברי הרכיב הקשיר.
\end_layout

\begin_layout Standard
נציג את מימוש האלגוריתם המורחב בשפת פייתון:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def SCC_DFS(G):
\end_layout

\begin_layout Plain Layout

2      for u in G.V:
\end_layout

\begin_layout Plain Layout

3          u.color = 'white'
\end_layout

\begin_layout Plain Layout

4      time = 0
\end_layout

\begin_layout Plain Layout

5      for u in G.V:
\end_layout

\begin_layout Plain Layout

6          if u.color == 'white':
\end_layout

\begin_layout Plain Layout

7              time = DFS_visit(G, u, time)
\end_layout

\begin_layout Plain Layout

8     V_sorted = sorted(G.V, key=lambda u: -u.f)
\end_layout

\begin_layout Plain Layout

9      E_R = [(v,u) for (u,v) in G.E]
\end_layout

\begin_layout Plain Layout

10     G_R = Graph(V_sorted, E_R, directed=True)
\end_layout

\begin_layout Plain Layout

11     for u in G_R.V:
\end_layout

\begin_layout Plain Layout

12         u.color = 'white'
\end_layout

\begin_layout Plain Layout

13     scc = []
\end_layout

\begin_layout Plain Layout

14     for u in G_R.V:
\end_layout

\begin_layout Plain Layout

15         if u.color == 'white':
\end_layout

\begin_layout Plain Layout

16             component = []
\end_layout

\begin_layout Plain Layout

17             SCC_DFS_visit(G_R, u, component)
\end_layout

\begin_layout Plain Layout

18             scc.append(component)
\end_layout

\begin_layout Plain Layout

19     return scc
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

1 def SCC_DFS_visit(G, u, component):
\end_layout

\begin_layout Plain Layout

2     component.append(u)
\end_layout

\begin_layout Plain Layout

3    u.color = 'gray'
\end_layout

\begin_layout Plain Layout

4    for v in G.adjacency(u):
\end_layout

\begin_layout Plain Layout

5        if v.color == 'white':
\end_layout

\begin_layout Plain Layout

6            SCC_DFS_visit(G, v, component)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
הקוד דומה מאוד לקוד של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)ומשתמש ב-
\lang english
DFS_visit
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
המקורי(.
 ההבדל המהותי הוא הורדה של שורות 
\begin_inset Quotes eld
\end_inset

מיותרות
\begin_inset Quotes erd
\end_inset

 )למשל, מעקב הזמנים ב-
\lang english
SCC_DFS_visit
\lang hebrew
(, מיון 
\begin_inset Formula $V$
\end_inset

 שמתבצע בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
והיפוך 
\begin_inset Formula $E$
\end_inset

 שמתבצע בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
9
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SCC_DFS
\lang hebrew
 והכנסת צמתים לרכיבי הקשירות שמתבצעת בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SCC_DFS_visit
\lang hebrew
.
\end_layout

\begin_layout Standard
לא נוכיח פורמלית את נכונות האלגוריתם, אבל נסביר את האינטואיציה שמאחוריו.
 בהינתן גרף 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 ניתן להגדיר את גרף הרכיבים הקשירים היטב שלו 
\begin_inset Formula $G^{\text{SCC}}=\left(V^{\text{SCC}},E^{\text{SCC}}\right)$
\end_inset

 באופן הבא: 
\begin_inset Formula $V^{\text{SCC}}$
\end_inset

 הוא אוסף רכיבי הקשירות היטב של 
\begin_inset Formula $G$
\end_inset

, ואילו 
\begin_inset Formula $E^{\text{SCC}}=\left\{ \left(A,B\right)\ |\ \exists a\in A,b\in B:\left(a,b\right)\in E\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
קל לראות כי 
\begin_inset Formula $G^{\text{SCC}}$
\end_inset

 הוא גרף חסר מעגלים כי מעגל היה מוביל למיזוג כל הרכיבים שעליו )כי הצמתים
 שמרכיבים אותם שייכים כולם לאותו רכיב קשירות היטב(.
 בנוסף ניתן להוכיח )זה החלק המרכזי של ההוכחה( כי אם נגדיר 
\begin_inset Formula $f\left(C\right)=\max\left\{ u.f\ |\ u\in C\right\} $
\end_inset

 אז קיום הקשת 
\begin_inset Formula $A\to B$
\end_inset

 גורר ש-
\begin_inset Formula $f\left(A\right)>f\left(B\right)$
\end_inset

.
 מכאן נובע שסריקת הגרף 
\begin_inset Formula $G^{R}$
\end_inset

 בחלק השני של האלגוריתם כשמיון הצמתים הוא על פי 
\begin_inset Formula $f$
\end_inset

 פירושה שאנחנו עוברים על רכיבי 
\begin_inset Formula $G^{\text{SCC}}$
\end_inset

 על פי 
\series bold
מיון טופולוגי
\series default
.
\end_layout

\begin_layout Standard
מכיוון שאנחנו עוברים על 
\begin_inset Formula $G^{\text{R}}$
\end_inset

, הרי שבמקום הקשת 
\begin_inset Formula $A\to B$
\end_inset

 תהיה לנו הקשת 
\begin_inset Formula $B\to A$
\end_inset

.
 מכיוון שאנו עוברים על הרכיב 
\begin_inset Formula $A$
\end_inset

 קודם, כאשר האלגוריתם יגיע אל קשת זו הרכיב 
\begin_inset Formula $A$
\end_inset

 כבר יהיה מסומן והאלגוריתם לא ייכנס אליו, כך שהאלגוריתם יישאר במסגרת הרכיב
 
\begin_inset Formula $B$
\end_inset

.
\end_layout

\begin_layout Standard
פרטי ההוכחה המלאים מורכבים יותר אבל נסתפק כאן בנפנוף ידיים זה.
\end_layout

\begin_layout Section
עצים פורשים מינימליים
\end_layout

\begin_layout Subsection
מבוא והגדרות
\end_layout

\begin_layout Standard

\series bold
עץ
\series default
 הוא גרף לא מכוון 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 שהוא 
\series bold
קשיר
\series default
 ו
\series bold
חסר מעגלים
\series default
.
 ניתן להוכיח שעץ הוא מקסימלי ביחס לתכונת חוסר המעגלים במובן זה שהוספת כל
 קשת לעץ יוצרת בו מעגל; בדומה, עץ הוא מינימלי ביחס לתכונת הקשירות במובן
 זה שהסרת כל קשת הופכת אותו ללא-קשיר.
 כאשר העץ סופי אז מתקיים 
\begin_inset Formula $\text{\left|E\right|=\left|V\right|}-1$
\end_inset

, וכל גרף קשיר עם 
\begin_inset Formula $\left|V\right|-1$
\end_inset

 קשתות הוא עץ.
\end_layout

\begin_layout Standard
לכל גרף קשיר 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 קיים תת-גרף 
\begin_inset Formula $G^{\prime}=\left(V,E^{\prime}\right)$
\end_inset

 עם 
\begin_inset Formula $E^{\prime}\subseteq E$
\end_inset

 כך ש-
\begin_inset Formula $G^{\prime}$
\end_inset

 הוא עץ.
 תת-גרף כזה נקרא 
\series bold
עץ פורש
\series default
 של 
\begin_inset Formula $G$
\end_inset

.
 עבור גרף סופי קל לראות שקיים עץ פורש: כל עוד קיימת בגרף קשת שהסרה שלה אינה
 הופכת את הגרף לבלתי קשיר, נסיר אותה; כשנגיע למצב שבו אין קשתות כאלו הגרף
 שהתקבל יהיה עץ )עבור גרף אינסופי הטיעון מורכב יותר אך איננו עוסקים בגרפים
 אינסופיים בקורס זה(.
\end_layout

\begin_layout Standard
הבעיה שנעסוק בה היא של מציאת 
\series bold
עץ פורש מינימלי: 
\series default
בבעיה זו יש פונקציית משקל על הקשתות, ואנו רוצים למצוא עץ פורש שסכום המשקלים
 של קשתותיו הוא מינימלי )בכל העצים הפורשים יהיה את אותו מספר קשתות - 
\begin_inset Formula $\left|V\right|-1$
\end_inset

, כך שהמינימליות מתבטאת רק בפונקציית המשקל(.
\end_layout

\begin_layout Standard
דוגמת שימוש קלאסית לבעייה זו היא פרישת רשת כבישים בין ערים: יש קשת בין כל
 זוג ערים שניתן לסלול בינם כביש, ומשקל הקשת הוא מחיר סלילת הכביש.
 אנו רוצים למצוא את המחיר המינימלי שנדרש לסלילת רשת כבישים שתאפשר מסע בין
 כל שתי ערים.
\end_layout

\begin_layout Standard
ננסח פורמלית את הבעיה:
\end_layout

\begin_layout Definition

\series bold
)בעיית עץ פורש מינימלי
\series default
(: יהא 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 גרף לא מכוון וקשיר ו-
\begin_inset Formula $w:E\to\mathbb{R}$
\end_inset

 פונקציית משקל.
 לכל 
\begin_inset Formula $E^{\prime}\subseteq E$
\end_inset

 נסמן 
\begin_inset Formula $w\left(E^{\prime}\right)=\sum_{e\in E^{\prime}}w\left(e\right)$
\end_inset

.
 בעיית העץ הפורש המינימלי היא למצוא את 
\begin_inset Formula $\text{argmin}_{E^{\prime}\subseteq E}\left\{ w\left(E^{\prime}\right)\right\} $
\end_inset

 כאשר 
\begin_inset Formula $E^{\prime}\subseteq E$
\end_inset

 רץ על כל קבוצות הקשתות כך ש-
\begin_inset Formula $\left(V,E^{\prime}\right)$
\end_inset

 הוא עץ.
\end_layout

\begin_layout Subsection
האלגוריתם הגנרי למציאת עץ פורש מינימלי
\end_layout

\begin_layout Standard
נציג שני אלגוריתמים לפתרון בעיית העץ הפורש המינימלי: אלגוריתם קרוסקל ואלגוריתם
 פרים.
 אפשר לחשוב על שני האלגוריתמים הללו בתור מימושים שונים של אלגוריתם כללי
 יותר - 
\begin_inset Quotes eld
\end_inset

גנרי
\begin_inset Quotes erd
\end_inset

 - לפתרון בעיית העץ הפורש.
 האלגוריתם בונה את העץ הפורש 
\begin_inset Quotes eld
\end_inset

מלמטה למעלה
\begin_inset Quotes erd
\end_inset

 - מתחילים עם תת-גרף בלי קשתות כלל, ומוסיפים אליו קשתות עד לקבלת העץ הפורש
 המינימלי.
 
\end_layout

\begin_layout Standard
האלגוריתם מתחיל עם הקבוצה 
\begin_inset Formula $A=\emptyset$
\end_inset

.
 במצב זה, 
\begin_inset Formula $A$
\end_inset

 היא בעלת התכונה שהיא תת-קבוצה של קבוצת הקשתות בעץ פורש מינימלי כלשהו.
 בכל איטרציה של האלגוריתם, הוא מוצא קשת 
\begin_inset Formula $e\in E$
\end_inset

 כך ש-
\begin_inset Formula $A\cup\left\{ e\right\} $
\end_inset

 גם היא תת-קבוצה של קבוצת הקשתות בעץ פורש מינימלי כלשהו.
 קשת כזו נקראת 
\series bold
קשת בטוחה
\series default
 עבור 
\begin_inset Formula $A$
\end_inset

.
\end_layout

\begin_layout Standard
מכיוון שנשמרת האינוריאנטה לפיה 
\begin_inset Formula $A$
\end_inset

 היא תת-קבוצה של קבוצת הקשתות בעץ פורש מינימלי, כאשר מגיעים למצב שבו 
\begin_inset Formula $\left|A\right|=\left|V\right|-1$
\end_inset

, אז 
\begin_inset Formula $A$
\end_inset

 תהווה את קבוצת הקשתות המלאה של עץ פורש מינימלי כלשהו.
\end_layout

\begin_layout Standard
האלגוריתם הגנרי, אם כן, הוא בסך הכל:
\end_layout

\begin_layout Enumerate
אתחלו 
\begin_inset Formula $A=\emptyset$
\end_inset


\end_layout

\begin_layout Enumerate
בצעו 
\begin_inset Formula $\left|V\right|-1$
\end_inset

 פעמים:
\end_layout

\begin_deeper
\begin_layout Enumerate
מצאו קשת בטוחה 
\begin_inset Formula $e$
\end_inset

 עבור 
\begin_inset Formula $A$
\end_inset


\end_layout

\begin_layout Enumerate
הגדירו 
\begin_inset Formula $A\leftarrow A\cup\left\{ e\right\} $
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
החזירו את 
\begin_inset Formula $A$
\end_inset


\end_layout

\begin_layout Standard
כמובן, האלגוריתם כולו נשען על השאלה 
\begin_inset Quotes eld
\end_inset

כיצד למצוא קשת בטוחה עבור 
\begin_inset Formula $A$
\end_inset


\begin_inset Quotes erd
\end_inset

.
 הן קרוסקל והן פרים מוצאים קשת כזו באמצעות בחירת 
\series bold
חתך
\series default
 בגרף.
 כזכור, 
\series bold
חתך 
\series default

\begin_inset Formula $\left(S,V\backslash S\right)$
\end_inset

 הוא פירוק של צמתי הגרף לשתי קבוצות זרות ומשלימות.
 קשת 
\begin_inset Formula $e=\left(u,v\right)$
\end_inset

 
\series bold
חוצה
\series default
 את החתך אם 
\begin_inset Formula $u\in S,v\in V\backslash S$
\end_inset

ֱ או 
\begin_inset Formula $v\in S,u\in V\backslash S$
\end_inset

.
 נאמר שחתך 
\series bold
מכבד
\series default
 את 
\begin_inset Formula $A$
\end_inset

 אם אף קשת של 
\begin_inset Formula $A$
\end_inset

 לא חוצה את החתך )כלומר, תת-הגרף שפורשות הקשתות ב-
\begin_inset Formula $A$
\end_inset

 מוכל כולו באחת הקבוצות בחתך(.
\end_layout

\begin_layout Standard
המשפט המרכזי שלנו נוגע לקשת הקלה ביותר שחוצה חתך:
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:קשת-בטוחה-עץ-פורש"

\end_inset

יהא 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 גרף לא מכוון וקשיר ו-
\begin_inset Formula $w:E\to\mathbb{R}$
\end_inset

 פונקציית משקל.
 תהא 
\begin_inset Formula $A\subseteq E$
\end_inset

 קבוצה שמוכלת בקבוצת הקשתות של עץ פורש מינימלי של 
\begin_inset Formula $G$
\end_inset

 עבור 
\begin_inset Formula $w$
\end_inset

.
 יהא 
\begin_inset Formula $\left(S,V\backslash S\right)$
\end_inset

 חתך של 
\begin_inset Formula $G$
\end_inset

 שמכבד את 
\begin_inset Formula $A$
\end_inset

 ותהא 
\begin_inset Formula $e=\left(u,v\right)$
\end_inset

 קשת שחוצה את החתך ומשקלה מינימלי מבין הקשתות שחוצות את החתך, אז 
\begin_inset Formula $A\cup\left\{ e\right\} $
\end_inset

 גם כן מוכלת בקבוצת הקשתות של עץ פורש מינימלי של 
\begin_inset Formula $G$
\end_inset

 עבור 
\begin_inset Formula $w$
\end_inset

.
\end_layout

\begin_layout Proof
יהא 
\begin_inset Formula $T=\left(V,E_{T}\right)$
\end_inset

 העץ הפורש המינימלי של 
\begin_inset Formula $G$
\end_inset

 שמכיל את 
\begin_inset Formula $A$
\end_inset

 שקיומו מובטח מתנאי המשפט.
 אם 
\begin_inset Formula $e\in E_{T}$
\end_inset

 סיימנו, כי גם 
\begin_inset Formula $A\cup\left\{ e\right\} $
\end_inset

 מוכלת באותה קבוצת קשתות.
 נניח אם כן כי 
\begin_inset Formula $e\notin E_{T}$
\end_inset

 ונראה כי קיים עץ פורש מינימלי 
\series bold
אחר
\series default
, 
\begin_inset Formula $T^{\prime}$
\end_inset

, שכן מכיל את 
\begin_inset Formula $A\cup\left\{ e\right\} $
\end_inset

, שיתקבל על ידי 
\begin_inset Quotes eld
\end_inset

תיקון
\begin_inset Quotes erd
\end_inset

 של העץ 
\begin_inset Formula $T$
\end_inset

.
\end_layout

\begin_layout Proof
נתבונן בקשת 
\begin_inset Formula $e=\left(u,v\right)$
\end_inset

.
 מכיוון שהקשת חוצה את החתך, מתקיים בלי הגבלת הכלליות ש-
\begin_inset Formula $u\in S$
\end_inset

 ו-
\begin_inset Formula $v\in V\backslash S$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $T$
\end_inset

 הוא עץ פורש, קיים מסלול ב-
\begin_inset Formula $T$
\end_inset

 מ-
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

, והמסלול חייב לחצות את החתך בשלב כלשהו )כי הצומת הראשון הוא ב-
\begin_inset Formula $S$
\end_inset

 והאחרון אינו ב-
\begin_inset Formula $S$
\end_inset

 ולכן קיימת קשת שמעבירה מ-
\begin_inset Formula $S$
\end_inset

 אל מחוץ ל-
\begin_inset Formula $S$
\end_inset

(.
 נסמן ב-
\begin_inset Formula $\left(x,y\right)$
\end_inset

 את הקשת על המסלול שחוצה את החתך, כך ש-
\begin_inset Formula $x\in S,y\in V\backslash S$
\end_inset

.
 בפרט, קיימים המסלולים 
\begin_inset Formula $x\rightsquigarrow u,v\rightsquigarrow y$
\end_inset

.
\end_layout

\begin_layout Proof
מכיוון שהחתך מכבד את 
\begin_inset Formula $A$
\end_inset

, מתקיים ש-
\begin_inset Formula $\left(x,y\right)\notin A$
\end_inset

.
 לכן 
\begin_inset Formula $A$
\end_inset

 מוכלת בקבוצה 
\begin_inset Formula $E_{T^{\prime}=}\left(E_{T}\backslash\left\{ \left(x,y\right)\right\} \right)\cup\left\{ e\right\} $
\end_inset

 שמתקבלת מהחלפת 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 ב-
\begin_inset Formula $\left(u,v\right)$
\end_inset

.
 נשאר רק להראות שקבוצה זו מגדירה עץ פורש מינימלי.
 מכיוון ש-
\begin_inset Formula $e\notin E_{T}$
\end_inset

 הרי שאחרי הסרת הקשת 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 והוספת 
\begin_inset Formula $e$
\end_inset

 קיבלנו 
\begin_inset Formula $\left|E_{T^{\prime}}\right|=\left|E_{T}\right|=\left|V\right|-1$
\end_inset

 ולכן אם הגרף 
\begin_inset Formula $T^{\prime}$
\end_inset

 קשיר, הוא עץ.
 
\end_layout

\begin_layout Proof
ניקח שני צמתים כלשהם בגרף.
 היה קיים ב-
\begin_inset Formula $T$
\end_inset

 מסלול שמחבר את שניהם.
 אם הוא לא עבר דרך 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 הוא קיים גם ב-
\begin_inset Formula $T^{\prime}$
\end_inset

.
 אם הוא עובר דרך 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 אז נתקן את המסלול כך: עם ההגעה ל-
\begin_inset Formula $x$
\end_inset

 ימשיך המסלול אל 
\begin_inset Formula $v$
\end_inset

 דרך המסלול 
\begin_inset Formula $x\rightsquigarrow u$
\end_inset

 שאת קיומו ראינו קודם, יעבור אל 
\begin_inset Formula $v$
\end_inset

 דרך הקשת 
\begin_inset Formula $e=\left(u,v\right)$
\end_inset

 ולבסוף ימשיך אל 
\begin_inset Formula $y$
\end_inset

 דרך 
\begin_inset Formula $v\rightsquigarrow y$
\end_inset

 ומשם ימשיך כמו במסלול המקורי.
 הראינו כי 
\begin_inset Formula $T^{\prime}$
\end_inset

 קשיר ולכן עץ.
\end_layout

\begin_layout Proof
נותר להראות כי 
\begin_inset Formula $T^{\prime}$
\end_inset

 הוא עץ פורש מינימלי.
 מכיוון שהוא התקבל מהעץ הפורש המינימלי 
\begin_inset Formula $T$
\end_inset

 על ידי הסרת 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 והוספת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 די להראות ש-
\begin_inset Formula $w\left(u,v\right)\le w\left(x,y\right)$
\end_inset

, כלומר החלפת הקשת יכולה רק להקטין את משקל העץ.
 מכיוון שגם 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 וגם 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 חוצות את החתך 
\begin_inset Formula $\left(S,V\backslash S\right)$
\end_inset

 ו-
\begin_inset Formula $\left(u,v\right)$
\end_inset

 נבחרה להיות בעל משקל מינימלי מבין כל הקשתות שחוצות את החתך, קיבלנו 
\begin_inset Formula $w\left(u,v\right)\le w\left(x,y\right)$
\end_inset

 כמבוקש.
\end_layout

\begin_layout Subsection
אלגוריתם קרוסקל
\end_layout

\begin_layout Standard
הרעיון באלגוריתם קרוסקל הוא לבנות את העץ הפורש על ידי 
\series bold
מיזוג
\series default
 של תתי-עצים שונים יחד.
 בתחילת ריצת האלגוריתם, כל צומת בגרף הוא 
\begin_inset Quotes eld
\end_inset

עץ
\begin_inset Quotes erd
\end_inset

 בפני עצמו, ללא קשתות.
 בכל צעד של האלגוריתם נבחרת הקשת הקלה ביותר שהוספתה לעץ תאחד שני רכיבי קשירות
 שעד כה היו נפרדים.
 ניתן לראות כי זוהי קשת בטוחה עבור קבוצת הקשתות שנבחרו עד כה, ולכן האלגוריתם
 תואם את המבנה של האלגוריתם הגנרי ומניב עץ פורש מינימלי.
\end_layout

\begin_layout Standard
על מנת לממש את האלגוריתם יש צורך במבנה נתונים של 
\series bold
קבוצת זרות
\series default
.
 המבנה הזה כולל אוסף של קבוצות זרות של איברים, וצריך לתמוך ביעילות בשתי
 פעולות: 
\series bold
מציאת
\series default
 הקבוצה שבה נמצא איבר נתון, ו
\series bold
איחוד
\series default
 שתי קבוצות זרות.
 מבנה נתונים כזה נקרא 
\begin_inset Quotes eld
\end_inset

מבנה נתונים 
\lang english
Disjoint-set
\lang hebrew

\begin_inset Quotes erd
\end_inset

 או 
\begin_inset Quotes eld
\end_inset

מבנה נתונים
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Union-find
\lang hebrew

\begin_inset Quotes erd
\end_inset

 על שם שתי הפעולות שבהן הוא נועד לתמוך.
 קיימים מימושים מחוכמים למדי למבנה נתונים זה אך אנו נסתפק כאן במימוש נאיבי
 בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\lang hebrew
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 class DisjointSets():
\end_layout

\begin_layout Plain Layout

2     def __init__(self, elements):
\end_layout

\begin_layout Plain Layout

3         self.sets = {element: element for element in elements}
\end_layout

\begin_layout Plain Layout

4     def find(self, element):
\end_layout

\begin_layout Plain Layout

5         if self.sets[element] == element:
\end_layout

\begin_layout Plain Layout

6             return element
\end_layout

\begin_layout Plain Layout

7         return self.find(self.sets[element])
\end_layout

\begin_layout Plain Layout

8     def union(self, element_1, element_2):
\end_layout

\begin_layout Plain Layout

9         self.sets[self.find(element_1)] = self.find(element_2)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
פרטי המימוש אינם חשובים כאן - הרעיון הוא לייצג כל קבוצה באמצעות נציג, כאשר
 המידע שנשמר בפועל, עבור כל איבר, הוא מה נציג הקבוצה שלו.
 איחוד קבוצות מתבצע על ידי שינוי הנציג של אחת הקבוצות כך שיצביע על נציג
 הקבוצה השניה במקום על עצמו.
\end_layout

\begin_layout Standard
בסיוע מבנה נתונים זה, הקוד ב-
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של אלגוריתם קרוסקל הוא פשוט:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def kruskal(G):
\end_layout

\begin_layout Plain Layout

2     A = []
\end_layout

\begin_layout Plain Layout

3     sets = DisjointSets(G.V)
\end_layout

\begin_layout Plain Layout

4     sorted_E = sorted(G.E, key=lambda e: G.w[e])
\end_layout

\begin_layout Plain Layout

5     for (u,v) in sorted_E:
\end_layout

\begin_layout Plain Layout

6         if sets.find(u) != sets.find(v):
\end_layout

\begin_layout Plain Layout

7             A.append((u,v))
\end_layout

\begin_layout Plain Layout

8             sets.union(u,v)
\end_layout

\begin_layout Plain Layout

9     return A
\end_layout

\end_inset


\end_layout

\begin_layout Standard
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מאותחלת רשימת הקשתות בעץ להיות הרשימה הריקה; בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מאותחלת הקבוצות שלנו כך שבהתחלה כל צומת הוא קבוצה בפני עצמה, ובשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
4
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 ממויינת רשימת הקשתות בסדר עולה על פי המשקל של כל קשת.
\end_layout

\begin_layout Standard
לאחר מכן, בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עוברים על הקשתות על פי הסדר, בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בודקים האם הקשת הנוכחית מחברת בין שני רכיבי קשירות נפרדים, ואם כן מוסיפים
 אותה ל-
\begin_inset Formula $A$
\end_inset

 בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 ומאחדים את רכיבי הקשירות בשורה 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\numeric off
.
\end_layout

\begin_layout Standard
מדוע קשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 שמקיימת את התנאי בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא קשת בטוחה עבור 
\begin_inset Formula $A$
\end_inset

? נתבונן בחתך 
\begin_inset Formula $\left(S,V\backslash S\right)$
\end_inset

 שבו 
\begin_inset Formula $S$
\end_inset

 היא רכיב הקשירות של 
\begin_inset Formula $u$
\end_inset

.
 החתך מכבד את 
\begin_inset Formula $A$
\end_inset

 שכן קשת מ-
\begin_inset Formula $A$
\end_inset

 שחוצה אותו משמעותה ששני צדי הקשת שייכים לרכיב הקשירות של 
\begin_inset Formula $u$
\end_inset

 וזוהי סתירה לכך שהצד השני של הקשת אמור להיות ב-
\begin_inset Formula $V\backslash S$
\end_inset

.
 כמו כן, הקשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 חוצה את החתך )כי התנאי בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתקיים( וכל קשת אחרת שחוצה את החתך חייבת להיות בעל משקל גדול או שווה לה,
 כי אם לקשת היה משקל נמוך יותר האלגוריתם היה עובר עליה קודם ומוסיף אותה
 )כי שני צדדיה הם כעת בשני רכיבי קשירות שונים ולכן בוודאי שהיו כך גם קודם(.
 מכאן שעל פי משפט 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:קשת-בטוחה-עץ-פורש"
plural "false"
caps "false"
noprefix "false"

\end_inset

 אלגוריתם קרוסקל הוא מימוש אפשרי של האלגוריתם הגנרי לעץ פורש מינימלי.
\end_layout

\begin_layout Standard
נותר להבין את הסיבוכיות של האלגוריתם.
 שלב מיון הקשתות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
4
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ניתן לביצוע בסיבוכיות 
\begin_inset Formula $O\left(\left|E\right|\log\left|E\right|\right)$
\end_inset

.
 סיבוכיות המשך הקוד תלויה במימוש של מבנה הנתונים שבו אנו משתמשים עבור
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DisjointSets
\lang hebrew
.
 במימוש הנאיבי שהצגנו, הסיבוכיות של פעולות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
find
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ושל
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
union
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא 
\begin_inset Formula $O\left(\left|V\right|\right)$
\end_inset

.
 מכיוון שפעולה זו מתבצעת 
\begin_inset Formula $O\left(\left|E\right|\right)$
\end_inset

 פעמים אנו מקבלים סיבוכיות של 
\begin_inset Formula $O\left(\left|V\right|\cdot\left|E\right|\right)$
\end_inset

.
\end_layout

\begin_layout Standard
קיים למבנה הנתונים
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DisjointSet
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מימוש יעיל בהרבה שלא נציג כאן שסיבוכיות הריצה שלו עבור ביצוע 
\begin_inset Formula $m$
\end_inset

 פעולות היא 
\begin_inset Formula $O\left(m\cdot\alpha\left(n\right)\right)$
\end_inset

 כאשר 
\begin_inset Formula $\alpha$
\end_inset

 היא פונקציה עם קצב גידול קטן מאוד.
 במקרה שלנו שימוש במבנה הנתונים הזה יניב שסיבוכיות כל השלב הזה היא 
\begin_inset Formula $O\left(\left|E\right|\log\left|E\right|\right)$
\end_inset

 ולכן זוהי גם סיבוכיות האלגוריתם כולו.
\end_layout

\begin_layout Subsection
אלגוריתם פרים
\end_layout

\begin_layout Standard
הרעיון באלגוריתם פרים הוא לבנות את העץ הפורש על ידי 
\series bold
הרחבה הדרגתית
\series default
 של עץ יחיד.
 האלגוריתם מתחיל מצומת 
\begin_inset Formula $r$
\end_inset

 שישמש בתור שורש העץ, ובכל שלב בוחר להוסיף לעץ צומת חדש על ידי חיבור שלו
 לצומת שכבר בעץ, כאשר הצומת נבחר בצורה חמדנית, בתור הצומת שמחיר ההוספה שלו
 לעץ )כלומר, משקל הקשת שמחברת אותו לעץ( הוא מינימלי.
\end_layout

\begin_layout Standard
המבנה של האלגוריתם כמעט זהה לזה של אלגוריתם דייקסטרה - ניתן להשתמש באותו
 קוד כמו עבור דייקסטרה עם שינויים מינוריים.
 בפרט, הרכיב המרכזי באלגוריתם הוא 
\series bold
תור עדיפויות
\series default
 שבו מוחזקים צמתי הגרף כשהם ממויינים, ובכל איטרציה מוצא ממנו הצומת שמשקלו
 מינימלי.
 המשקל של כל צומת, כאמור, הוא משקל הקשת הקלה ביותר שמחברת אותו לצומת כלשהו
 בעץ; כדי לוודא שמספר זה מעודכן, עם כל הוספת צומת לעץ עוברים על שכניו שמחוץ
 לעץ ומעדכנים את המשקל שלהם במידת הצורך.
\end_layout

\begin_layout Standard
נציג מימוש של האלגוריתם בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\lang hebrew
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def prim(G, s):
\end_layout

\begin_layout Plain Layout

2      for v in G.V:
\end_layout

\begin_layout Plain Layout

3          v.d = math.inf
\end_layout

\begin_layout Plain Layout

4          v.pi = None    
\end_layout

\begin_layout Plain Layout

5      s.d = 0
\end_layout

\begin_layout Plain Layout

6      Q = [v for v in G.V]
\end_layout

\begin_layout Plain Layout

7      while len(Q) > 0:
\end_layout

\begin_layout Plain Layout

8          u = pop_min(Q)
\end_layout

\begin_layout Plain Layout

9          for v in G.adjacency(u):
\end_layout

\begin_layout Plain Layout

10             if v in Q and G.w[(u,v)] < v.d:
\end_layout

\begin_layout Plain Layout

11                 v.d = G.w[(u,v)]
\end_layout

\begin_layout Plain Layout

12                 v.pi = u
\end_layout

\end_inset


\end_layout

\begin_layout Standard
במימוש שאנו מציגים פה, בדומה לדייקסטרה, אנו מתחילים מצומת 
\begin_inset Formula $s$
\end_inset

 בגרף )בחירת צמתים שונים עשויה להניב עצים פורשים שונים(.
 לכל צומת אנו מגדירים את 
\begin_inset Formula $v.d$
\end_inset

 בתור ה
\begin_inset Quotes erd
\end_inset

מחיר
\begin_inset Quotes erd
\end_inset

 של הוספת 
\begin_inset Formula $v$
\end_inset

 לעץ )בהתחלה 
\begin_inset Formula $v.d=\infty$
\end_inset

 לכל צומת למעט 
\begin_inset Formula $s$
\end_inset

 שמחירה 
\begin_inset Formula $0$
\end_inset

(.
 את הקשתות של העץ נשמור בתוך 
\begin_inset Formula $v.\pi$
\end_inset

 שעבור כל צומת מצביע על אביו בעץ, בדומה למה שעשינו עבור דייקסטרה.
\end_layout

\begin_layout Standard
בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נבנה תור עדיפויות ובשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מוצא ממנו האיבר המינימלי 
\begin_inset Formula $u$
\end_inset

 )אנו משתמשים באותה פונקציה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
pop_min
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כמו בדייקסטרה(.
 הוספת 
\begin_inset Formula $u$
\end_inset

 לעץ מתבצעת באופן מובלע על ידי הסרתו מתור העדיפויות; בזמן ההוצאה של 
\begin_inset Formula $u$
\end_inset

, הקשת 
\begin_inset Formula $u.\pi$
\end_inset

 היא זו שמחירה מינימלי מבין כל אלו שמחברות את 
\begin_inset Formula $u$
\end_inset

 לעץ, ולכן זוהי הקשת ש
\begin_inset Quotes erd
\end_inset

מתווספת לעץ
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
לבסוף, שורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10-12
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מעדכנות עבור כל שכני הצומת שהוספנו לעץ את משקל הקשת המינימלית שמחברת אותם
 לעץ - זאת בהינתן והקשת שמחברת אותם לצומת החדש בעץ קלה יותר מאשר המשקל המינימלי
 הקודם.
\end_layout

\begin_layout Standard
נכונות האלגוריתם מתבססת על משפט 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:קשת-בטוחה-עץ-פורש"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 כדי לראות זאת, נסתכל בשלב כלשהו באלגוריתם על חתך 
\begin_inset Formula $\left(S,V\backslash S\right)$
\end_inset

 שבו 
\begin_inset Formula $S$
\end_inset

 כוללת את כל הצמתים שהתווספו עד כה אל העץ.
 הקשת שנבחרת בשלב זה להוספה לגרף היא זו של הצומת שנשלף בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\numeric off
.
 משקל הצומת הזה הוא משקל הקשת שאנו מוסיפים לעץ, ומשקל זה הוא מינימלי מבין
 זה של כל הקשתות שמחברות את צמתי העץ לצמתים שב-
\begin_inset Formula $Q$
\end_inset

, מה שממלא את תנאי המשפט.
\end_layout

\begin_layout Standard
סיבוכיות האלגוריתם תלויה במימוש של 
\begin_inset Formula $Q$
\end_inset

.
 במימוש באמצעות ערימה, שלב האתחול בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
דורש זמן 
\begin_inset Formula $O\left(\left|V\right|\right)$
\end_inset

.
 פעולת הוצאת האיבר המינימלי בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מתבצעת 
\begin_inset Formula $\left|V\right|$
\end_inset

 פעמים בסיבוכיות 
\begin_inset Formula $O\left(\log\left|V\right|\right)$
\end_inset

 פעמים כך שאנחנו מקבלים סיבוכיות 
\begin_inset Formula $O\left(\left|V\right|\log\left|V\right|\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
לבסוף, שורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10-12
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מבוצעות פעמיים עבור כל קשת בגרף, כלומר 
\begin_inset Formula $2\left|E\right|$
\end_inset

 פעמים )כי הן מתבצעות פעם אחת לכל נקודת קצה של קשת(.
 בכל פעם כזו יש לבדוק שייכות ל-
\begin_inset Formula $Q$
\end_inset

, מה שניתן למימוש בזמן 
\begin_inset Formula $O\left(1\right)$
\end_inset

 במימוש חכם )למשל שדה נוסף לכל צומת שאומר האם הוא ב-
\begin_inset Formula $Q$
\end_inset

 או לא ומעודכן בהתאם(.
 בנוסף, שינוי הערך בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
11
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מצריך עדכון של הערימה, בסיבוכיות 
\begin_inset Formula $O\left(\log\left|V\right|\right)$
\end_inset

, כך שבסך הכל אנחנו מקבלים שזמן ריצת האלגוריתם הוא 
\begin_inset Formula $O\left(\left|E\right|\log\left|V\right|\right)$
\end_inset

, וזה הגורם הדומיננטי בסיבוכיות זמן הריצה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)מכיוון שהגרף קשיר יש בו לפחות 
\begin_inset Formula $\left|V\right|-1$
\end_inset

 קשתות, כלומר 
\begin_inset Formula $\left|V\right|=O\left(\left|E\right|\right)$
\end_inset

.
\end_layout

\begin_layout Standard
כמו באלגוריתם דייקסטרה, מימוש 
\begin_inset Formula $Q$
\end_inset

 באמצעות 
\series bold
ערימת פיבונאצ'י
\series default
 יכול לשפר את זמן הריצה עוד יותר, אך לא נציג זאת כאן.
\end_layout

\begin_layout Section
קידוד חסר רעש וקוד האפמן
\end_layout

\begin_layout Subsection
מבוא
\end_layout

\begin_layout Standard
טקסטים במחשב מיוצגים על ידי 
\series bold
קידוד
\series default
 של התווים בטקסט לסדרות של ביטים.
 דוגמא פשוטה לקידוד הזה היא קוד
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
ASCII
\lang hebrew
: בקוד הזה מיוצגים
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
256
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תווים שונים על ידי
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ביטים.
 כך למשל התו 
\begin_inset Quotes eld
\end_inset


\lang english
F
\lang hebrew

\begin_inset Quotes erd
\end_inset

 מיוצג על ידי המחרוזת 
\begin_inset Formula $01000110$
\end_inset

 ואילו התו 
\begin_inset Quotes eld
\end_inset


\lang english
E
\lang hebrew

\begin_inset Quotes erd
\end_inset

 הקודם לו מיוצג על ידי המספר הקודם, 
\begin_inset Formula $01000101$
\end_inset

.
\end_layout

\begin_layout Standard
שיטה זו ודומות לה הן שימושיות ומועילות באופן כללי, אך בבירור יש בהן 
\series bold
בזבוז
\series default
 של ביטים.
 זאת מכיוון שלא כל התווים מופיעים בטקסט באותה תדירות.
 הסימן 
\begin_inset Formula $\}$
\end_inset

 כנראה יופיע בטקסט פחות מאשר האות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
e
\lang hebrew
.
 איך ניתן לנצל זאת? אם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
e
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תיוצג באמצעות 
\series bold
פחות ביטים
\series default
, מה שיתבטא בכך שתווים פחות נפוצים יהיו מיוצגים באמצעות 
\series bold
יותר ביטים
\series default
.
\end_layout

\begin_layout Standard
נדגים זאת באמצעות דוגמא פשוטה.
 המילה 
\lang english
GATTACAA
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 היא בעלת 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אותיות שכולן בקבוצה 
\begin_inset Formula $\text{\left\{  G,A,C,T\right\}  }$
\end_inset

.
 
\end_layout

\begin_layout Standard
מכיוון שיש רק ארבע אותיות, קידוד נאיבי שלהן יתבסס על שני ביטים:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
קידוד
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
אות
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $C$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
הייצוג של 
\lang english
GATTACAA
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בצורה זו יהיה מאורך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
16
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ביטים )
\numeric on
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תווים כפול
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ביטים לתו(:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0001111101100101
\numeric off
.
\end_layout

\begin_layout Standard
ננסה למצוא קידוד חסכוני יותר.
\end_layout

\begin_layout Standard
על ידי מעבר בודד על המילה ניתן לספור את המופעים של כל אות ואת התדירות שבה
 היא מופיעה במילה )מספר המופעים שלה חלקי אורך המילה:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
תדירות
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
מופעים
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
אות
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{8}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\lang english
G
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\lang english
A
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{8}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\lang english
C
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{1}{4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\lang english
T
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
בבירור
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
A
\lang hebrew
 היא האות הנפוצה ביותר ולכן כדאי לתת לה 
\begin_inset Quotes eld
\end_inset

עדיפות
\begin_inset Quotes erd
\end_inset

, בזמן ש-
\lang english
T
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא בעדיפות שניה ואילו
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
G,C
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
חולקות את המקום האחרון.
 נציע אם כן שיטת קידוד שנדמה ששלפנו מהשרוול אך בהמשך נראה כיצד ניתן למצוא
 אלגוריתמית:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
קידוד
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
אות
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
110
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
111
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $C$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
בשיטה זו קיצרנו את קידוד
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
A
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בביט והמחיר ש
\begin_inset Quotes erd
\end_inset

שילמנו
\begin_inset Quotes erd
\end_inset

 על כך הוא הגדלת אורך הקידוד של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
G,C
\lang hebrew
.
 נחשב מה כעת יהיה אורך הקידוד של המילה: 
\begin_inset Formula $4\cdot1+2\cdot2+1\cdot3+1\cdot3=14$
\end_inset

 - כלומר, חסכנו שני ביטים
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)
\numeric on
12.5
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אחוז מאורך המילה(.
 קידוד המילה בשיטה החדשה יהיה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
11001010011100
\numeric off
.
\end_layout

\begin_layout Standard
באופן כללי, כל טקסט שמורכב מארבע אותיות אלו בהתפלגות התדירות הזו ואורכו
 הוא 
\begin_inset Formula $N$
\end_inset

 ידרוש 
\begin_inset Formula $2N$
\end_inset

 ביטים בקידוד נאיבי ו-
\begin_inset Formula $\left(\frac{1}{2}+\frac{2}{4}+\frac{3}{8}+\frac{3}{8}\right)N=1.75N$
\end_inset

 ביטים בקידוד המשופר שהצענו.
 ככל שיש אותיות רבות יותר שהתפלגות התדירויות שלהן רחוקה מלהיות אחידה, כך
 שיטת קידוד באורך משתנה הופכת לחסכונית יותר ויותר.
\end_layout

\begin_layout Subsection
קודי רישא
\end_layout

\begin_layout Standard

\series bold
קידוד 
\series default
מחרוזת מתבצע בקלות על ידי החלפת כל תו במחרוזת בסדרת הביטים שמקודדת אותו,
 שנקראת 
\series bold
מילת הקוד
\series default
 או 
\series bold
הקידוד
\series default
 של המחרוזת.
 
\series bold
פיענוח
\series default
 קידוד הוא המרה של הייצוג באמצעות ביטים חזרה למחרוזת.
 כאשר מספר הביטים לכל תו הוא קבוע, הקידוד ניתן לביצוע בקלות: מחלקים את מילת
 הקוד לסדרות בהתאם לאורך )למשל, סדרות מאורך 
\numeric on
8
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בקוד
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
ASCII
\lang hebrew
( ומתרגמים כל סדרה בנפרד חזרה לתו שהיא מקודדת.
\end_layout

\begin_layout Standard
לרוע המזל, כשעוברים לקידוד באמצעות סדרות מאורך משתנה, נהיה פחות ברור כיצד
 לפענח ובבחירה לא טובה של קוד הפיענוח עשוי להיות לא חד-ערכי כלל.
 למשל, אם האות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
A
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מקודדת על ידי
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1010
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
והאות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
B
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מקודדת על ידי
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אז הסדרה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
101010
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מקודדת הן את
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
AB
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
והן את
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BA
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ואין לנו דרך לדעת מה היה במקור.
\end_layout

\begin_layout Standard
דרך פתרון פשוטה לבעיה זו, שמבטיחה גם שלא תהיה 
\begin_inset Quotes eld
\end_inset

התנגשות
\begin_inset Quotes erd
\end_inset

 של קידודים וגם פיענוח קל, היא שימוש ב
\series bold
קודי רישא
\series default
.
 בקודים הללו, הקידוד של אף אות אינו רישא של קידוד של אות אחרת, ולכן כאשר
 קוראים את מילת הקוד אין שלב שבו אנו עומדים בפני הדילמה האם הסתיימה אות
 בקידוד ומתחילה אות חדשה, או שמא אנחנו רק באמצע האות הנוכחית.
\end_layout

\begin_layout Standard
הקוד שהצגנו קודם הוא דוגמא לקוד רישא שכזה:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
קידוד
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
אות
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
110
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
111
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $C$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\numeric on
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $T$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
פענוח מתבצע בצורה הבאה: אם הביט הבא הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\numeric off
, התו הבא הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
A
\lang hebrew
; אם הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אנו משהים את השיפוט להמשך.
 אם הביט השני הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אז התו הבא הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
T
\lang hebrew
, ואם הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אנו משהים את השיפוט להמשך, והביט השלישי קובע האם מדובר על
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
G
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
או
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
C
\lang hebrew
.
 ניתן לתאר את התהליך בצורה פשוטה באמצעות 
\series bold
עץ בינארי
\series default
 שקשתותיו מסומנות ב-
\numeric on
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\numeric on
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וכל עלה בו מייצג את אחת האותיות, כך שהקידוד של האות רשום על הקשתות במסלול
 מהשורש אל העלה הזה.
\end_layout

\begin_layout Standard
נעבור להגדרות פורמליות.
 מטעמי נוחות ה
\begin_inset Quotes erd
\end_inset

אותיות
\begin_inset Quotes erd
\end_inset

 שלנו יהיו פשוט המספרים בקבוצה 
\begin_inset Formula $\left\{ 1,2,\ldots,M\right\} $
\end_inset

 עבור 
\begin_inset Formula $M$
\end_inset

 טבעי חיובי כלשהו.
\end_layout

\begin_layout Definition

\series bold
קוד רישא
\series default
 הוא קבוצת מילים בינאריות 
\begin_inset Formula $w_{1},\ldots,w_{M}\in\left\{ 0,1\right\} ^{*}$
\end_inset

 כך שלכל 
\begin_inset Formula $i\ne j$
\end_inset

, 
\begin_inset Formula $w_{i}$
\end_inset

 אינה רישא של 
\begin_inset Formula $w_{j}$
\end_inset

 )כלומר, 
\begin_inset Formula $w_{j}\ne w_{i}u$
\end_inset

 עבור 
\begin_inset Formula $u\in\left\{ 0,1\right\} ^{*}$
\end_inset

(.
\end_layout

\begin_layout Theorem
יהא 
\begin_inset Formula $\left\{ w_{1},\ldots,w_{M}\right\} $
\end_inset

 קוד רישא, אז כל קידוד של מילה באמצעות הקוד הוא יחיד.
 כלומר אם עבור שתי סדרות 
\begin_inset Formula $\left(i_{1},\ldots,i_{k}\right)$
\end_inset

 ו-
\begin_inset Formula $\left(j_{1},\ldots,j_{t}\right)$
\end_inset

 מתקיים 
\begin_inset Formula $w_{i_{1}}\cdots w_{i_{k}}=w_{j_{1}}\cdots w_{j_{t}}$
\end_inset

 אז 
\begin_inset Formula $k=t$
\end_inset

 ו-
\begin_inset Formula $i_{r}=j_{r}$
\end_inset

 לכל 
\begin_inset Formula $1\le r\le k$
\end_inset

.
\end_layout

\begin_layout Proof
נוכיח את הטענה באינדוקציה על 
\begin_inset Formula $k$
\end_inset

.
 נניח ש-
\begin_inset Formula $w_{i_{1}}\cdots w_{i_{k}}=w_{j_{1}}\cdots w_{j_{t}}$
\end_inset

 ונתבונן ב-
\begin_inset Formula $w_{i_{1}},w_{j_{1}}$
\end_inset

.
 אם אחת מהמילים הללו ארוכה מהשניה, אז בגלל ששתיהן מופיעות החל מתחילת המילה
 האותיות שלהן זהות עד לשלב שבו המילה הקצרה יותר נגמרת - כלומר, מילה אחת
 היא רישא של המילה השניה, בסתירה להנחה שלנו שזהו קוד רישא.
\end_layout

\begin_layout Proof
אם כן, 
\begin_inset Formula $\left|w_{i_{1}}\right|=\left|w_{j_{1}}\right|$
\end_inset

 ומכיוון ששתי המילים מופיעות בתחילת מילת הקוד, האותיות שלהן זהות, כלומר
 
\begin_inset Formula $w_{i_{1}}=w_{j_{1}}$
\end_inset

.
 כעת נפעיל את הנחת האינדוקציה על 
\begin_inset Formula $w_{2}\cdots w_{i_{k}}=w_{j_{2}}\cdots w_{j_{t}}$
\end_inset

 ונקבל את המבוקש.
\end_layout

\begin_layout Theorem
יהא 
\begin_inset Formula $\left\{ w_{1},\ldots,w_{M}\right\} $
\end_inset

 קוד רישא, אז קיים אלגוריתם שלכל סדרה 
\begin_inset Formula $u=b_{1}\cdots b_{n}$
\end_inset

 של 
\begin_inset Formula $n$
\end_inset

 ביטים, אם קיימת סדרה 
\begin_inset Formula $\left(i_{1},\ldots,i_{k}\right)$
\end_inset

 כך ש-
\begin_inset Formula $u=w_{i_{1}}\cdots w_{i_{k}}$
\end_inset

 אז הוא מוצא אותה ואחרת מחזיר שאין כזו ופועל בסיבוכיות 
\begin_inset Formula $O\left(n\right)$
\end_inset

.
\end_layout

\begin_layout Proof
נתבונן בעץ שצמתיו הם כל הרישות של מילים מ-
\begin_inset Formula $\text{\left\{  w_{1},\ldots,w_{M}\right\}  }$
\end_inset

.
 השורש מייצג את הרישא 
\begin_inset Formula $\varepsilon$
\end_inset

 )המילה הריקה(.
 לצומת שמייצג את 
\begin_inset Formula $u$
\end_inset

 יהיו לכל היותר שני בנים - הצמתים שמייצגים את 
\begin_inset Formula $u\cdot0$
\end_inset

 ואת 
\begin_inset Formula $u\cdot1$
\end_inset

, והקשתות אל בנים אלו יסומנו ב-
\numeric on
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\numeric on
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בהתאמה.
 עלי העץ הם בדיוק המילים 
\begin_inset Formula $\left\{ w_{1},\ldots,w_{M}\right\} $
\end_inset

 שכן העובדה שאף מילה בקבוצה היא רישא של מילה אחרת בה מבטיחה שלא יצאו קשתות
 מהצמתים שמתאימים למילים אלו.
\end_layout

\begin_layout Proof
נשים לב שלכל צומת 
\begin_inset Formula $u=\sigma_{1}\cdots\sigma_{k}$
\end_inset

, סדרת סימוני הקשתות שמובילה מ-
\begin_inset Formula $\varepsilon$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 היא בדיוק 
\begin_inset Formula $\sigma_{1},\ldots,\sigma_{k}$
\end_inset

 )קל להוכיח זאת באינדוקציה(.
\end_layout

\begin_layout Proof
כעת בהינתן סדרה 
\begin_inset Formula $u=b_{1}\cdots b_{n}$
\end_inset

 של ביטים, האלגוריתם שלנו יפעל באופן הבא:
\end_layout

\begin_deeper
\begin_layout Enumerate
התחל מהצומת 
\begin_inset Formula $\varepsilon$
\end_inset

 בעץ.
\end_layout

\begin_layout Enumerate
קרא את האות 
\begin_inset Formula $b_{i}$
\end_inset

 הבאה מהקלט 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Enumerate
אם לא קיימת קשת יוצאת מ-
\begin_inset Formula $u$
\end_inset

 עם הסימון 
\begin_inset Formula $b_{i}$
\end_inset

, החזר 
\begin_inset Quotes eld
\end_inset

לא קיים פיענוח
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Enumerate
אם קיימת קשת יוצאת מ-
\begin_inset Formula $u$
\end_inset

 עם הסימון 
\begin_inset Formula $b_{i}$
\end_inset

, עבור אל הצומת שמתאים לקשת זו.
\end_layout

\begin_layout Enumerate
אם הצומת אליו הגעת הוא עלה המתאים למילה 
\begin_inset Formula $w$
\end_inset

, הוסף את 
\begin_inset Formula $w$
\end_inset

 לפלט וחזור לצומת 
\begin_inset Formula $\varepsilon$
\end_inset

 בעץ.
\end_layout

\begin_layout Enumerate
אם הקלט נגמר והאלגוריתם אינו בצומת 
\begin_inset Formula $\varepsilon$
\end_inset

, החזר 
\begin_inset Quotes eld
\end_inset

לא קיים פיענוח
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Enumerate
אם הקלט נגמר והאלגוריתם בצומת 
\begin_inset Formula $\varepsilon$
\end_inset

 החזר את רשימת האינדקסים של ה-
\begin_inset Formula $w$
\end_inset

 שהתווספו לפלט במהלך הריצה.
\end_layout

\begin_layout Enumerate
חזור לשלב
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\numeric off
.
\end_layout

\begin_layout Standard
ניתן להוכיח כי אלגוריתם זה אכן מפענח את קידוד המילה ומכיוון שהוא קורא כל
 אות ב-
\begin_inset Formula $u$
\end_inset

 בדיוק פעם אחת ומבצע פעולות בסיבוכיות קבועה לכל אות כזו, סיבוכיות הריצה
 שלו היא 
\begin_inset Formula $O\left(n\right)$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection
קוד האפמן
\end_layout

\begin_layout Standard
ראינו את השימושיות של קודי רישא ואת האופן שבו ניתן לייצג אותם באמצעות עץ.
 כעת נרצה לעסוק בשאלה - מה קוד הרישא 
\series bold
האופטימלי
\series default
 בהינתן שאנו יודעים את תדירות האותיות בטקסט שאנחנו רוצים לקודד? )למשל, על
 ידי ביצוע מעבר בודד על הטקסט וחישוב שלהן(
\end_layout

\begin_layout Standard
נפתח בהגדרה:
\end_layout

\begin_layout Definition
יהא 
\begin_inset Formula $C$
\end_inset

 אלפבית כלשהו ונניח כי לכל 
\begin_inset Formula $c\in C$
\end_inset

 נתונה לנו תדירות, 
\begin_inset Formula $f\left(c\right)\in\left[0,1\right]$
\end_inset

 כך ש-
\begin_inset Formula $\sum_{c\in C}f\left(c\right)=1$
\end_inset

.
 יהא קוד רישא עבור 
\begin_inset Formula $C$
\end_inset

 שמיוצג באמצעות עץ 
\begin_inset Formula $T$
\end_inset

, ולכל 
\begin_inset Formula $c\in C$
\end_inset

 נסמן ב-
\begin_inset Formula $d_{T}\left(c\right)$
\end_inset

 את עומק העלה של 
\begin_inset Formula $c$
\end_inset

 בעץ 
\begin_inset Formula $T$
\end_inset

.
 אז 
\series bold
מחיר
\series default
 הקוד 
\begin_inset Formula $T$
\end_inset

 ביחס להתפלגות הנתונה מוגדר בתור 
\begin_inset Formula $B\left(T\right)=\sum_{c\in C}d_{T}\left(c\right)\cdot f\left(c\right)$
\end_inset

.
\end_layout

\begin_layout Standard
במילים אחרות, 
\begin_inset Formula $B\left(T\right)$
\end_inset

 הוא 
\series bold
ממוצע משוקלל
\series default
 של המחיר בביטים של כל 
\begin_inset Formula $c\in C$
\end_inset

 כשהמשקלות הם התדירויות של האותיות ב-
\begin_inset Formula $C$
\end_inset

.
 קל לראות כי עומק העלה של 
\begin_inset Formula $c$
\end_inset

 ב-
\begin_inset Formula $T$
\end_inset

 אכן שווה למספר הביטים שבהם מיוצג 
\begin_inset Formula $c$
\end_inset

 בעץ.
\end_layout

\begin_layout Standard
המשימה העומדת לפנינו כעת היא פשוטה לניסוח: בהינתן התדירויות 
\begin_inset Formula $f\left(c\right)$
\end_inset

 של כל 
\begin_inset Formula $c\in C$
\end_inset

, ברצוננו לבנות קוד רישא 
\begin_inset Formula $T$
\end_inset

 עבור 
\begin_inset Formula $C$
\end_inset

 כך ש-
\begin_inset Formula $B\left(T\right)$
\end_inset

 הוא מינימלי.
 האלגוריתם של האפמן משיג מטרה זו בגישה 
\series bold
חמדנית
\series default
 שבונה את העץ של הקוד 
\begin_inset Quotes eld
\end_inset

מלמטה למעלה
\begin_inset Quotes erd
\end_inset

.
 אנו מתחילים כשבגרף שלנו נכללים רק עלי העץ עם כל האותיות ב-
\begin_inset Formula $C$
\end_inset

, ובכל איטרציה אנחנו מאחדים את שני הצמתים בעלי תדירות 
\series bold
מינימלית
\series default
 )ככל שצומת מאוחד מהר יותר, כך הוא יהיה נמוך יותר בעץ ולכן בעל משקל גבוה
 יותר(.
 האיחוד מתבטא בהוספת צומת פנימי חדש בעץ שהצמתים המאוחדים הם בניו; מכאן אפשר
 להמשיך באינדוקציה כשמתייחסים לצומת הפנימי בתור 
\begin_inset Quotes eld
\end_inset

עלה
\begin_inset Quotes erd
\end_inset

 חדש, עם תדירות ששווה לסכום התדירויות של בניו.
\end_layout

\begin_layout Standard
מבחינה רעיונית האלגוריתם מזכיר את האלגוריתם של קרוסקל לעץ פורש מינימלי במובן
 זה שאנחנו מתחילים עם איבר מבודדים ומבצעים סדרה של 
\begin_inset Quotes eld
\end_inset

איחודים
\begin_inset Quotes erd
\end_inset

 עד שכולם נמצאים באותו עץ.
 עם זאת, האלגוריתם שונה בכך שהקשתות אינן נתונות מראש אלא נתונות לבחירתו
 של האלגוריתם, והאופן שבו מזהים את הצמתים בעלי תדירוות מינימלית היא באמצעות
 
\series bold
תור עדיפויות
\series default
 כמו זה ששימש אותנו באלגוריתם של פרים ודייקסטרה.
\end_layout

\begin_layout Standard
נציג מימוש של האלגוריתם בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\lang hebrew
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def huffman(C):
\end_layout

\begin_layout Plain Layout

2      Q = []
\end_layout

\begin_layout Plain Layout

3      for c, freq in C.items():
\end_layout

\begin_layout Plain Layout

4          v = Vertex(c)
\end_layout

\begin_layout Plain Layout

5          v.freq = freq
\end_layout

\begin_layout Plain Layout

6          Q.append(v)    
\end_layout

\begin_layout Plain Layout

7      for i in range(len(C) - 1):
\end_layout

\begin_layout Plain Layout

8          x = pop_min(Q)
\end_layout

\begin_layout Plain Layout

9          y = pop_min(Q)
\end_layout

\begin_layout Plain Layout

10         z = Vertex(i)
\end_layout

\begin_layout Plain Layout

11         z.left = x
\end_layout

\begin_layout Plain Layout

12         z.right = y
\end_layout

\begin_layout Plain Layout

13         z.freq = x.freq + y.freq
\end_layout

\begin_layout Plain Layout

14         Q.append(z)
\end_layout

\begin_layout Plain Layout

15     return pop_min(Q)        
\end_layout

\end_inset


\end_layout

\begin_layout Standard
בקוד אנחנו מניחים שנתון לנו מילון
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
C
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שכולל זוגות של תו )
\lang english
c
\lang hebrew
( והתדירות שלו )
\lang english
freq
\lang hebrew
(.
 לכל זוג כזה אנחנו מייצרים צומת חדש בגרף עם שדה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
freq
\lang hebrew
; צמתים אלו ישמשו בתור העלים.
 בלולאה שמתחילה בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אנו מייצרים את הצמתים הפנימיים בגרף.
 תור העדיפויות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Q
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נבנה כך שהשליפה ממנו מתבצעת על פי שדה ה-
\lang english
freq
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של האיברים.
\end_layout

\begin_layout Standard
בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
8-9
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אנו מוצאים את הצמתים בעלי התדירויות הנמוכות ביותר.
 בשורות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10-13
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אנחנו מייצרים צומת חדש
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $z$
\end_inset

 שישמש בתור האב של שני צמתים אלו בעץ, וקובעים את התדירות שלו להיות סכום
 התדירויות של הבנים.
\end_layout

\begin_layout Standard
סיבוכיות האלגוריתם תלויה במימוש
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Q
\lang hebrew
.
 במימוש סטנדרטי באמצעות ערימה, האתחול דורש זמן 
\begin_inset Formula $O\left(n\right)$
\end_inset

 והלולאה הפנימית מתבצעת 
\begin_inset Formula $n$
\end_inset

 פעמים כשבכל פעם מופעלות על 
\begin_inset Formula $Q$
\end_inset

 פעולות שדורשות זמן 
\begin_inset Formula $O\left(\log n\right)$
\end_inset

 כך שסיבוכיות הזמן הכוללת היא 
\begin_inset Formula $O\left(n\log n\right)$
\end_inset

.
\end_layout

\begin_layout Standard
נותר להשתכנע בכך שהקוד שהאלגוריתם מחזיר הוא אכן קוד הרישא האופטימלי עבור
 רשימת התדירויות שהתקבלה כקלט.
 לשם כך נשים לב לאופן הפעולה של האלגוריתם בכל איטרציה שלו:
\end_layout

\begin_layout Itemize
בונה מהמילון 
\begin_inset Formula $C$
\end_inset

 מילון חדש 
\begin_inset Formula $C^{\prime}$
\end_inset

 שמתקבל על ידי הסרת 
\begin_inset Formula $x,y\in C$
\end_inset

 והוספת 
\begin_inset Formula $z\in C^{\prime}$
\end_inset

 כך ש-
\begin_inset Formula $f\left(z\right)=f\left(x\right)+f\left(y\right)$
\end_inset

 ואז ממשיך את הריצה עליו.
\end_layout

\begin_layout Itemize
בונה עץ 
\begin_inset Formula $T$
\end_inset

 עבור 
\begin_inset Formula $C$
\end_inset

 על ידי כך שהוא מחבר אל העץ 
\begin_inset Formula $T^{\prime}$
\end_inset

 שנוצר מתוך 
\begin_inset Formula $C^{\prime}$
\end_inset

 את הצמתים עבור 
\begin_inset Formula $x,y$
\end_inset

 בתור בנים של הצומת שנוצר עבור 
\begin_inset Formula $z$
\end_inset

 )וכעת מאבד את הסימון הזה שלו ונשאר צומת פנימי חסר סימון(.
\end_layout

\begin_layout Standard
אם נוכיח שבניית 
\begin_inset Formula $T$
\end_inset

 באופן הזה מתוך עץ 
\series bold
אופטימלי
\series default
 עבור 
\begin_inset Formula $C^{\prime}$
\end_inset

 מניבה עץ אופטימלי עבור 
\begin_inset Formula $C$
\end_inset

 ההוכחה תסתיים באמצעות אינדוקציה פשוטה.
 ראשית ננסה להעריך את 
\begin_inset Quotes eld
\end_inset

הפרש המחיר
\begin_inset Quotes erd
\end_inset

 בין 
\begin_inset Formula $T$
\end_inset

 ו-
\begin_inset Formula $T^{\prime}$
\end_inset

.
 כזכור, הגדרנו 
\begin_inset Formula $B\left(T\right)=\sum_{c\in C}d_{T}\left(c\right)\cdot f\left(c\right)$
\end_inset

.
 כעת:
\end_layout

\begin_layout Itemize
\begin_inset Formula $C=\left(C^{\prime}\backslash\left\{ z\right\} \right)\cup\left\{ x,y\right\} $
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $f\left(z\right)=f\left(x\right)+f\left(y\right)$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $d_{T}\left(x\right)=d_{T}\left(y\right)=d_{T^{\prime}}\left(z\right)+1$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $d_{T}\left(c\right)=d_{T^{\prime}}\left(c\right)$
\end_inset

 לכל 
\begin_inset Formula $c\in C\cap C^{\prime}$
\end_inset

 )כי לא שינינו את הצמתים של תווים אלו בעץ(.
\end_layout

\begin_layout Standard
בהינתן כל אלו, נבצע חישוב אלגברי פשוט:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
B\left(T\right) & =\sum_{c\in C}d_{T}\left(c\right)f\left(c\right)\\
 & =\sum_{c\in C\cap C^{\prime}}d_{T}\left(c\right)f\left(c\right)+d_{T}\left(x\right)f\left(x\right)+d_{T}\left(y\right)f\left(y\right)\\
 & =\sum_{c\in C\cap C^{\prime}}d_{T^{\prime}}\left(c\right)f\left(c\right)+\left(d_{T^{\prime}}\left(z\right)+1\right)\left(f\left(x\right)+f\left(y\right)\right)\\
 & =\sum_{c\in C\cap C^{\prime}}d_{T^{\prime}}\left(c\right)f\left(c\right)+d_{T^{\prime}}\left(z\right)f\left(z\right)+f\left(z\right)\\
 & =\sum_{c\in C^{\prime}}d_{T^{\prime}}\left(c\right)f\left(c\right)+f\left(z\right)\\
 & =B\left(T^{\prime}\right)+f\left(z\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
בהמשך נוכיח כי עבור 
\begin_inset Formula $C$
\end_inset

 קיים עץ 
\begin_inset Formula $T_{\text{opt}}$
\end_inset

 כך ש-
\begin_inset Formula $B\left(T_{\text{opt}}\right)$
\end_inset

 מינימלי ו-
\begin_inset Formula $x,y$
\end_inset

 הם אחים, כלומר בנים של אותו צומת.
 נראה כיצד ניתן להשתמש בעץ כזה כדי להוכיח ש-
\begin_inset Formula $B\left(T\right)=B\left(T_{\text{opt}}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
נבנה מתוך 
\begin_inset Formula $T_{\text{opt}}$
\end_inset

 עץ חדש 
\begin_inset Formula $T_{\text{opt}}^{\prime}$
\end_inset

 על ידי הסרת 
\begin_inset Formula $x,y$
\end_inset

 והחלפתם בצומת 
\begin_inset Formula $z$
\end_inset

 עם 
\begin_inset Formula $f\left(z\right)=f\left(x\right)+f\left(y\right)$
\end_inset

.
\end_layout

\begin_layout Standard
מהשוויון שראינו קודם, נקבל 
\begin_inset Formula $B\left(T_{\text{opt}}\right)=B\left(T_{\text{opt}}^{\prime}\right)+f\left(z\right)$
\end_inset

.
\end_layout

\begin_layout Standard
כמו כן, 
\begin_inset Formula $T^{\prime}$
\end_inset

 נבחר להיות אופטימלי, ולכן 
\begin_inset Formula $B\left(T^{\prime}\right)\le B\left(T_{\text{opt}}^{\prime}\right)$
\end_inset

.
 נקבל:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
B\left(T\right) & =B\left(T^{\prime}\right)+f\left(z\right)\\
 & \le B\left(T_{\text{opt}}^{\prime}\right)+f\left(z\right)\\
 & =B\left(T_{\text{opt}}\right)\le B\left(T\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
כלומר 
\begin_inset Formula $B\left(T_{\text{opt}}\right)=B\left(T\right)$
\end_inset

, כמבוקש.
\end_layout

\begin_layout Standard
נותר להוכיח כי אכן קיים עץ 
\begin_inset Formula $T_{\text{opt}}$
\end_inset

 אופטימלי עבור 
\begin_inset Formula $C$
\end_inset

 שבו 
\begin_inset Formula $x,y$
\end_inset

 הם אחים.
 הרעיון הוא לקחת עץ אופטימלי 
\begin_inset Formula $T_{\text{opt}}$
\end_inset

 
\series bold
כלשהו
\series default
 ואם הוא לא מתאים לקריטריון - לתקן אותו בהתאם.
\end_layout

\begin_layout Standard
יהא 
\begin_inset Formula $T_{\text{opt}}$
\end_inset

 עץ אופטימלי ונסתכל על צומת 
\begin_inset Formula $a$
\end_inset

 מעומק מקסימלי בעץ.
 אם לא קיים ל-
\begin_inset Formula $a$
\end_inset

 אח אז אפשר להחליף את אביו של 
\begin_inset Formula $a$
\end_inset

 ב-
\begin_inset Formula $a$
\end_inset

 עצמו ולקבל עץ בעל מחיר קטן יותר, כך שקיים ל-
\begin_inset Formula $a$
\end_inset

 אח 
\begin_inset Formula $b$
\end_inset

.
 כזכור, 
\begin_inset Formula $x,y$
\end_inset

 נבחרו כך שערך ה-
\begin_inset Formula $f$
\end_inset

 שלהם מינימלי.
 בלי הגבלת הכלליות נניח ש-
\begin_inset Formula $f\left(x\right)\le f\left(y\right)$
\end_inset

 ו-
\begin_inset Formula $f\left(a\right)\le f\left(b\right)$
\end_inset

 ולכן נוכל להסיק:
\end_layout

\begin_layout Itemize
\begin_inset Formula $f\left(x\right)\le f\left(a\right)$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $f\left(y\right)\le f\left(b\right)$
\end_inset


\end_layout

\begin_layout Standard
)ההסקה השניה נובעת מכך שאם 
\begin_inset Formula $f\left(b\right)<f\left(y\right)$
\end_inset

 אז מתקבלת השרשרת 
\begin_inset Formula $f\left(x\right)\le f\left(a\right)\le f\left(b\right)<f\left(y\right)$
\end_inset

 שמראה ש-
\begin_inset Formula $y$
\end_inset

 אינו אחד משני הצמתים המינימליים בעץ(.
\end_layout

\begin_layout Standard
מכיוון ש-
\begin_inset Formula $a,b$
\end_inset

 נבחרו להיות בעלי עומק מקסימלי ב-
\begin_inset Formula $T_{\text{opt}}$
\end_inset

, נקבל:
\end_layout

\begin_layout Itemize
\begin_inset Formula $d_{T_{\text{opt}}}\left(x\right)\le d_{T_{\text{opt}}}\left(a\right)$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $d_{T_{\text{opt}}}\left(y\right)\le d_{T_{\text{opt}}}\left(b\right)$
\end_inset


\end_layout

\begin_layout Standard
כעת נחליף את מיקומי הצמתים 
\begin_inset Formula $a,x$
\end_inset

 ונקבל עץ חדש 
\begin_inset Formula $T_{\text{opt}}^{\prime}$
\end_inset

.
 נשווה את מחירו למחיר 
\begin_inset Formula $T_{\text{opt}}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
B\left(T_{\text{opt}}\right)-B\left(T_{\text{opt}}^{\prime}\right) & =\sum_{c\in C}d_{T_{\text{opt}}}\left(c\right)f\left(c\right)-\sum_{c\in C}d_{T_{\text{opt}}^{\prime}}\left(c\right)f\left(c\right)\\
 & =d_{T_{\text{opt}}}\left(a\right)f\left(a\right)+d_{T_{\text{opt}}}\left(x\right)f\left(x\right)-d_{T_{\text{opt}}^{\prime}}\left(a\right)f\left(a\right)-d_{T_{\text{opt}}^{\prime}}\left(x\right)f\left(x\right)\\
 & =d_{T_{\text{opt}}}\left(a\right)f\left(a\right)+d_{T_{\text{opt}}}\left(x\right)f\left(x\right)-d_{T_{\text{opt}}}\left(x\right)f\left(a\right)-d_{T_{\text{opt}}}\left(a\right)f\left(x\right)\\
 & =\left(d_{T_{\text{opt}}}\left(a\right)-d_{T_{\text{opt}}}\left(x\right)\right)\left(f\left(a\right)-f\left(x\right)\right)\\
 & \ge0
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
כאשר אי השוויון האחרון נובע מכך ש-
\begin_inset Formula $d_{T_{\text{opt}}}\left(a\right)\le d_{T_{\text{opt}}}\left(x\right)$
\end_inset

 ומצד שני 
\begin_inset Formula $f\left(a\right)\ge f\left(x\right)$
\end_inset

 כפי שראינו.
\end_layout

\begin_layout Standard
מכאן שפעולת ההחלפה בין 
\begin_inset Formula $a,x$
\end_inset

 יכלה רק להקטין את משקל העץ ומכיוון ש-
\begin_inset Formula $T_{\text{opt}}$
\end_inset

 היה אופטימלי, משקלם שווה וגם 
\begin_inset Formula $T_{\text{opt}}^{\prime}$
\end_inset

 אופטימלי.
\end_layout

\begin_layout Standard
כעת נחליף את 
\begin_inset Formula $y,b$
\end_inset

 באותו אופן ונקבל בעזרת אותו חישוב שהעץ החדש שקיבלנו הוא אופטימלי.
 עץ חדש זה הוא גם בעל התכונה ש-
\begin_inset Formula $x,y$
\end_inset

 הם אחים בו, כמבוקש.
\end_layout

\begin_layout Section
רשתות זרימה
\end_layout

\begin_layout Subsection
מבוא והגדרות
\end_layout

\begin_layout Standard
רשתות זרימה משמשות אותנו למידול סיטואציות שבהן קיים 
\begin_inset Quotes eld
\end_inset

חומר
\begin_inset Quotes erd
\end_inset

 כלשהו שיש להעביר בין שתי נקודות - מנקודת 
\series bold
המקור
\series default
 אל נקודת 
\series bold
היעד
\series default
, כאשר יש מסלולים שונים להעברת החומר וניתן לפצל אותו ביניהם.
 במסלולים קיימים אילוצי 
\series bold
קיבולת
\series default
 שמגבילים את כמות החומר שניתן להעביר בכל מסלול, והבעיה המרכזית שבה נעסוק
 היא מציאת הדרך האופטימלית לפצל את החומר בין מסלולים שונים כך שכמות החומר
 שעוברת מהמקור אל היעד ביחידת זמן היא אופטימלית.
\end_layout

\begin_layout Standard
אפשר להשתמש ברשתות זרימה כדי למדל סיטואציות רבות - זרימת נוזלים, זרימה חשמלית,
 העברת מידע ברשת האינטרנט, תנועת רכבים וכדומה, אך לא נעסוק בשימושים אלו
 כאן אלא רק במידול האבסטרקטי של הבעיה.
\end_layout

\begin_layout Definition

\series bold
רשת זרימה
\series default
 היא גרף מכוון 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 כך שקיימים שני צמתים מובחנים בגרף, 
\begin_inset Formula $s,t\in V$
\end_inset

 הנקראים 
\series bold
מקור
\series default
 ו
\series bold
יעד
\series default
 בהתאמה וקיימת פונקציה 
\begin_inset Formula $c:V\times V\to\mathbb{R}$
\end_inset

 הנקראת 
\series bold
פונקציית קיבול
\series default
 כך שמתקיים:
\end_layout

\begin_deeper
\begin_layout Itemize
כל צומת 
\begin_inset Formula $v\in V$
\end_inset

 נמצא על מסלול 
\begin_inset Formula $s\rightsquigarrow v\rightsquigarrow t$
\end_inset

 מהמקור אל היעד.
\end_layout

\begin_layout Itemize
אם קיימת קשת 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 אז לא קיימת קשת בכיוון ההפוך: 
\begin_inset Formula $\left(v,u\right)\notin E$
\end_inset

.
 בנוסף לא קיימות לולאות עצמיות, כלומר 
\begin_inset Formula $\left(u,u\right)\notin E$
\end_inset

.
\end_layout

\begin_layout Itemize
לכל 
\begin_inset Formula $u,v\in V\times V$
\end_inset

 מתקיים 
\begin_inset Formula $c\left(u,v\right)\ge0$
\end_inset

 ואם 
\begin_inset Formula $\left(u,v\right)\notin E$
\end_inset

 אז 
\begin_inset Formula $c\left(u,v\right)=0$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
רשת הזרימה מגדירה את הקלט לבעיה שלנו.
 ה
\begin_inset Quotes erd
\end_inset

פתרון
\begin_inset Quotes erd
\end_inset

 לבעיה הזו היא זרימה שמתאימה לרשת:
\end_layout

\begin_layout Definition
תהא 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 רשת זרימה עם פונקציית קיבול 
\begin_inset Formula $c$
\end_inset

.
 
\series bold
זרימה
\series default
 
\begin_inset Formula $f:V\times V\to\mathbb{R}$
\end_inset

 היא פונקציה המקיימת:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
אילוץ הקיבול
\series default
: 
\begin_inset Formula $0\le f\left(u,v\right)\le c\left(u,v\right)$
\end_inset

 לכל 
\begin_inset Formula $u,v\in V$
\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
שימור הזרימה
\series default
: לכל 
\begin_inset Formula $u\in V\backslash\left\{ s,t\right\} $
\end_inset

 מתקיים שהזרימה שנכנסת ל-
\begin_inset Formula $u$
\end_inset

 שווה לזרימה שיוצאת ממנו, כלומר 
\begin_inset Formula $\sum_{v\in V}f\left(v,u\right)=\sum_{v\in V}f\left(u,v\right)$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
לבסוף, מכיוון שאנו רוצים לפתור בעיית אופטימיזציה, אנחנו צריכים להגדיר את
 פונקציית המטרה שלנו - הערך שאנחנו מנסים במקרה זה למקסם:
\end_layout

\begin_layout Definition
תהא 
\begin_inset Formula $f$
\end_inset

 זרימה עבור רשת זרימה 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

.
 אז נגדיר את 
\series bold
ערך הזרימה
\series default
 
\begin_inset Formula $\left|f\right|$
\end_inset

 בתור כמות הזרימה שיוצאת מ-
\begin_inset Formula $s$
\end_inset

 פחות כמות הזרימה שנכנסת ל-
\begin_inset Formula $s$
\end_inset

: 
\begin_inset Formula $\left|f\right|=\sum_{v\in V}f\left(s,v\right)-\sum_{v\in V}f\left(v,s\right)$
\end_inset


\end_layout

\begin_layout Standard
אינטואיטיבית נראה שאל 
\begin_inset Formula $s$
\end_inset

 לא צריכות להיכנס קשתות כלל ואין הגיון בהכנסת זרימה אל 
\begin_inset Formula $s$
\end_inset

; בהמשך נראה שמועיל לאפשר זאת בתור כלי עזר עבור אלגוריתמים שמוצאים זרימה
 מקסימלית.
\end_layout

\begin_layout Subsection
שיטת פורד-פולקרסון
\end_layout

\begin_layout Standard
הבעיה שאיתה אנו מתמודדים היא זו: בהינתן רשת זרימה, למצוא זרימה עבורה כך
 שערך הזרימה הוא מקסימלי.
 דרך אחת להתמודד עם הבעיה היא 
\series bold
שיטת פורד-פולקרסון
\series default
, שהיא שיטה כללית למציאת זרימה מקסימלית בגרף שיש לה מימושים שונים רבים,
 בדומה לאלגוריתם הגנרי למציאת עץ פורש מינימלי.
\end_layout

\begin_layout Standard
השיטה נסמכת על שני מושגים: 
\end_layout

\begin_layout Itemize

\series bold
רשת שיורית
\series default
: בהינתן רשת זרימה 
\begin_inset Formula $G$
\end_inset

 וזרימה 
\begin_inset Formula $f$
\end_inset

 עבורה, הרשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 היא רשת )שאינה עונה על כל הדרישות מרשת זרימה( שבה קיבולי הקשתות מתארות
 במובן מסויים עד כמה ניתן 
\series bold
להגדיל
\series default
 או 
\series bold
להקטין 
\series default
את זרימת 
\begin_inset Formula $f$
\end_inset

 ברשת המקורית.
\end_layout

\begin_layout Itemize

\series bold
מסלול שיפור
\series default
: הוא מסלול מהמקור אל היעד בתוך רשת שיורית 
\begin_inset Formula $G_{f}$
\end_inset

, שאפשר להסיק ממנו שינויים בזרימה 
\begin_inset Formula $f$
\end_inset

 ש
\series bold
ישפרו
\series default
 את ערך הזרימה של 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Standard
שיטת פורד-פולקרסון כעת מתוארת בצורה הכללית מאוד הבאה:
\end_layout

\begin_layout Enumerate
אתחלו זרימה 
\begin_inset Formula $f=0$
\end_inset

.
\end_layout

\begin_layout Enumerate
כל עוד ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 קיים מסלול שיפור 
\begin_inset Formula $p$
\end_inset

:
\end_layout

\begin_deeper
\begin_layout Enumerate
שפרו את 
\begin_inset Formula $f$
\end_inset

 על פי 
\begin_inset Formula $p$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
החזירו את 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Standard
כדי שהשיטה לעיל תהיה בעלת משמעות עבורנו עלינו להגדיר במדויק רשת שיורית ומסלול
 שיפור, ולהציע אלגוריתם קונקרטי שמוצא מסלול שיפור ברשת השיורית.
 נפתח עם ההגדרות.
\end_layout

\begin_layout Standard
הרעיון מאחורי 
\series bold
רשת שיורית
\series default
 
\begin_inset Formula $G_{f}$
\end_inset

 הוא לבנות רשת שמייצגת שני פרטים: כמה ניתן עוד 
\series bold
להגדיל
\series default
 זרימה על קשת ב-
\begin_inset Formula $G$
\end_inset

 )זה מתבטא בהפרש בין הקיבול של הקשת והזרימה הנוכחית( וכמה ניתן 
\series bold
להקטין
\series default
 זרימה על קשת )זה מתבטא בגודל הזרימה הנוכחי(.
\end_layout

\begin_layout Definition
תהא 
\begin_inset Formula $G$
\end_inset

 רשת זרימה עם פונקציית קיבול 
\begin_inset Formula $c$
\end_inset

 ו-
\begin_inset Formula $f$
\end_inset

 זרימה ברשת.
 נגדיר פונקציית קיבול חדשה, 
\series bold
הקיבול השיורי
\series default
 
\begin_inset Formula $c_{f}:V\times V\to\mathbb{R}$
\end_inset

, באופן הבא:
\end_layout

\begin_layout Definition
\begin_inset Formula 
\begin{align*}
c_{f}\left(u,v\right) & =\begin{cases}
c\left(u,v\right)-f\left(u,v\right) & \left(u,v\right)\in E\\
f\left(v,u\right) & \left(v,u\right)\in E\\
0 & \text{else}
\end{cases}
\end{align*}

\end_inset


\end_layout

\begin_layout Definition
נגדיר כעת 
\begin_inset Formula $E_{f}=\left\{ \left(u,v\right)\in V\times V\ |\ c_{f}\left(u,v\right)>0\right\} $
\end_inset

, ונגדיר את הרשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 בתור הגרף 
\begin_inset Formula $G_{f}=\left(V,E_{f}\right)$
\end_inset

 עם פונקציית הקיבול 
\begin_inset Formula $c_{f}$
\end_inset

.
\end_layout

\begin_layout Standard
נשים לב לכך ש-
\begin_inset Formula $c_{f}$
\end_inset

 מוגדרת היטב, שכן כפי שהנחנו, ברשת זרימה 
\begin_inset Formula $E$
\end_inset

 אם קיימת הקשת 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 אז 
\begin_inset Formula $\left(v,u\right)\notin E$
\end_inset

 ולכן שני המקרים הראשונים בהגדרת 
\begin_inset Formula $c_{f}$
\end_inset

 אינם יכולים להתקיים בו-זמנית.
 עם זאת, ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 עצמה 
\series bold
יכולות
\series default
 להופיע קשתות בשני הכיוונים ולכן זוהי אינה רשת זרימה בעצמה אך פרט להבדל
 זה רשת שיורית זהה לרשת זרימה, ובפרט ניתן להגדיר זרימה גם עבורה באותו אופן
 שבו הגדרנו עבור רשת זרימה.
\end_layout

\begin_layout Standard
המטרה של הרשת השיורית היא להצביע על שינויים אפשריים בזרימה 
\begin_inset Formula $f$
\end_inset

.
 זאת נעשה באמצעות פונקציית זרימה 
\begin_inset Formula $f^{\prime}$
\end_inset

 עבור הרשת השיורית, שמשפיעה על הזרימה המקורית באופן הבא:
\end_layout

\begin_layout Definition
תהא 
\begin_inset Formula $f$
\end_inset

 זרימה ברשת זרימה 
\begin_inset Formula $G$
\end_inset

 ו-
\begin_inset Formula $f^{\prime}$
\end_inset

 זרימה ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

.
 נגדיר את 
\series bold
השיפור
\series default
 
\begin_inset Formula $f\uparrow f^{\prime}$
\end_inset

 של 
\begin_inset Formula $f$
\end_inset

 באמצעות 
\begin_inset Formula $f^{\prime}$
\end_inset

 על ידי
\end_layout

\begin_layout Definition
\begin_inset Formula 
\begin{align*}
f & \uparrow f^{\prime}\left(u,v\right)\triangleq\begin{cases}
f\left(u,v\right)+f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right) & \left(u,v\right)\in E\\
0 & \text{else}
\end{cases}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
ההגדרה הזו תופסת את המהות של הזרימה השיורית מ-
\begin_inset Formula $u$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 כמתארת 
\series bold
הגדלה
\series default
 של הזרימה המקורית ושל הזרימה השיורית מ-
\begin_inset Formula $v$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 כמתארת 
\series bold
הקטנה
\series default
 של הזרימה המקורית.
 האילוץ שלנו שלא יתקיים 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 וגם 
\begin_inset Formula $\left(v,u\right)\in E$
\end_inset

 מונע 
\begin_inset Quotes eld
\end_inset

בלבול בתפקידים
\begin_inset Quotes erd
\end_inset

 בין שני סוגי הזרימות השיוריות הללו.
\end_layout

\begin_layout Standard
לא מובן מאליו שההגדרה 
\begin_inset Quotes eld
\end_inset

עובדת
\begin_inset Quotes erd
\end_inset

 - יש להוכיח זאת:
\end_layout

\begin_layout Theorem
\begin_inset Formula $f\uparrow f^{\prime}$
\end_inset

 היא זרימה ברשת 
\begin_inset Formula $G$
\end_inset

 ו-
\begin_inset Formula $\left|f\uparrow f^{\prime}\right|=\left|f\right|+\left|f^{\prime}\right|$
\end_inset


\end_layout

\begin_layout Proof
\begin_inset Branch Drafts
inverted 0
status collapsed

\begin_layout Proof
כדי להראות כי 
\begin_inset Formula $f\uparrow f^{\prime}$
\end_inset

 היא זרימה יש להראות כי היא מקיימת את 
\series bold
אילוץ הקיבול
\series default
 ואת 
\series bold
שימור הזרימה
\series default
.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
הוכחה מסורבלת אבל כנראה בספר של קורמן יש טעות.
\end_layout

\end_inset


\end_layout

\begin_layout Proof
נפתח עם אילוץ הקיבול.
 עבור 
\begin_inset Formula $\left(u,v\right)\notin E$
\end_inset

 מתקיים 
\begin_inset Formula $f\uparrow f^{\prime}\left(u,v\right)=0=c\left(u,v\right)$
\end_inset

 ולכן 
\begin_inset Formula $0\le f\uparrow f^{\prime}\left(u,v\right)\le c\left(u,v\right)$
\end_inset

.
 נותר לטפל במקרה 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

.
\end_layout

\begin_layout Proof
במקרה זה, 
\begin_inset Formula $f^{\prime}\left(u,v\right)\le c_{f}\left(u,v\right)=c\left(u,v\right)-f\left(u,v\right)$
\end_inset

 ולכן 
\begin_inset Formula $f\left(u,v\right)+f^{\prime}\left(u,v\right)\le c\left(u,v\right)$
\end_inset

 ומכאן
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
f\uparrow f^{\prime}\left(u,v\right) & =f\left(u,v\right)+f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\\
 & \le f\left(u,v\right)+f^{\prime}\left(u,v\right)\\
 & \le c\left(u,v\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כמו כן, במקרה זה 
\begin_inset Formula $f^{\prime}\left(v,u\right)\le c_{f}\left(v,u\right)=f\left(u,v\right)$
\end_inset

 
\begin_inset Formula $f\left(u,v\right)-f^{\prime}\left(v,u\right)\ge0$
\end_inset

, ומכאן
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
f\uparrow f^{\prime}\left(u,v\right) & =f\left(u,v\right)+f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\\
 & \ge f\left(u,v\right)-f^{\prime}\left(v,u\right)\\
 & \ge0
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
וקיבלנו ש-
\begin_inset Formula $0\le f\uparrow f^{\prime}\left(u,v\right)\le c\left(u,v\right)$
\end_inset

 גם במקרה זה.
 זה מסיים את ההוכחה עבור אילוץ הקיבול.
\end_layout

\begin_layout Proof
נעבור להוכחת שימור הזרימה: יהא 
\begin_inset Formula $u\in V\backslash\left\{ s,t\right\} $
\end_inset

.
 עלינו להוכיח כי 
\begin_inset Formula $\sum_{v\in V}f\uparrow f^{\prime}\left(v,u\right)=\sum_{v\in V}f\uparrow f^{\prime}\left(u,v\right)$
\end_inset


\end_layout

\begin_layout Proof
מכיוון ש-
\begin_inset Formula $f$
\end_inset

 היא זרימה, היא מקיימת את שימור הזרימה: 
\begin_inset Formula $\sum_{v\in V}f\left(v,u\right)=\sum_{v\in V}f\left(u,v\right)$
\end_inset

.
 נעביר אגפים:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\sum_{v\in V}\left(f\left(u,v\right)-f\left(v,u\right)\right) & =0
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
בדומה, גם 
\begin_inset Formula $f^{\prime}$
\end_inset

 מקיימת את אילוץ הזרימה:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\sum_{v\in V}\left(f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\right) & =0
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
לכן על מנת לסיים די אם נוכיח את הטענה הבאה:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\sum_{v\in V}\left(f\uparrow f^{\prime}\left(v,u\right)-f\uparrow f^{\prime}\left(u,v\right)\right) & =\sum_{v\in V}\left(f\left(u,v\right)-f\left(v,u\right)\right)+\sum_{v\in V}\left(f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
לשם כך די אם נראה כי לכל 
\begin_inset Formula $v\in V$
\end_inset

 מתקיים 
\begin_inset Formula 
\begin{align*}
f & \uparrow f^{\prime}\left(u,v\right)-f\uparrow f^{\prime}\left(v,u\right)=\left(f\left(u,v\right)-f\left(v,u\right)\right)+\left(f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
נפריד בין שלושת המקרים האפשריים:
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $\left(u,v\right)\notin E$
\end_inset

 וגם 
\begin_inset Formula $\left(v,u\right)\notin E$
\end_inset

 אז בפרט 
\begin_inset Formula $c\left(u,v\right)=c\left(v,u\right)=0$
\end_inset

 ומכאן ש-
\begin_inset Formula $f\left(u,v\right)=f\left(v,u\right)=f^{\prime}\left(u,v\right)=f^{\prime}\left(v,u\right)=0$
\end_inset

.
 לכן: 
\begin_inset Formula 
\begin{align*}
f\uparrow f^{\prime}\left(u,v\right)-f\uparrow f^{\prime}\left(v,u\right) & =0\\
 & =\left(f\left(u,v\right)-f\left(v,u\right)\right)+\left(f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 אז בהכרח 
\begin_inset Formula $\left(v,u\right)\notin E$
\end_inset

 ולכן 
\begin_inset Formula $f\left(v,u\right)=0$
\end_inset

 ו-
\begin_inset Formula $f\uparrow f^{\prime}\left(v,u\right)=0$
\end_inset

 ומכאן
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
f\uparrow f^{\prime}\left(u,v\right)-f\uparrow f^{\prime}\left(v,u\right) & =f\left(u,v\right)+f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\\
 & =\left(f\left(u,v\right)-f\left(v,u\right)\right)+\left(f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $\left(v,u\right)\in E$
\end_inset

 אז בהכרח 
\begin_inset Formula $\left(u,v\right)\notin E$
\end_inset

 ולכן 
\begin_inset Formula $f\left(u,v\right)=0$
\end_inset

 ו-
\begin_inset Formula $f\uparrow f^{\prime}\left(u,v\right)=0$
\end_inset

 ומכאן
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
f\uparrow f^{\prime}\left(u,v\right)-f\uparrow f^{\prime}\left(v,u\right) & =-\left(f\left(v,u\right)+f^{\prime}\left(v,u\right)-f^{\prime}\left(u,v\right)\right)\\
 & =-f\left(v,u\right)+\left(f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\right)\\
 & =\left(f\left(u,v\right)-f\left(v,u\right)\right)+\left(f^{\prime}\left(u,v\right)-f^{\prime}\left(v,u\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כנדרש.
\end_layout

\begin_layout Proof
נותר להוכיח כי 
\begin_inset Formula $\left|f\uparrow f^{\prime}\right|=\left|f\right|+\left|f^{\prime}\right|$
\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
להשלים, אם יהיה לך כוח, זה יותר מדי מכדי לתת בקורס שלא במסגרת תרגיל בית
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Branch Class
inverted 0
status collapsed

\begin_layout Standard
תרגיל.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
ראינו כי כל זרימה ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 מאפשרת לנו 
\begin_inset Quotes eld
\end_inset

לתקן
\begin_inset Quotes erd
\end_inset

 את הזרימה 
\begin_inset Formula $f$
\end_inset

 ברשת המקורית 
\begin_inset Formula $G$
\end_inset

.
 נדבר כעת על סוג ספציפי של זרימה ברשת השיורית - כזו שנובעת מ
\series bold
מסלול שיפור
\series default
.
\end_layout

\begin_layout Definition
תהא 
\begin_inset Formula $G$
\end_inset

 רשת זרימה עם זרימה 
\begin_inset Formula $f$
\end_inset

.
 מסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $t$
\end_inset

 ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 נקרא 
\series bold
מסלול שיפור
\series default
.
\end_layout

\begin_layout Standard
מסלול השיפור לכשעצמו לא נותן לנו זרימה - הרעיון הוא להגדיל את הזרימה ככל
 הניתן לאורך המסלול הזה.
 מה שמגביל אותנו הוא 
\begin_inset Quotes eld
\end_inset

צוואר הבקבוק
\begin_inset Quotes erd
\end_inset

 של המסלול - הקשת בעלת הקיבולת המינימלית שעליו:
\end_layout

\begin_layout Definition
בהינתן מסלול שיפור 
\begin_inset Formula $p$
\end_inset

 ב-
\begin_inset Formula $G_{f}$
\end_inset

 נגדיר את 
\series bold
הקיבול השיורי
\series default
 של מסלול השיפור בתור 
\begin_inset Formula $c_{f}\left(p\right)\triangleq\min\left\{ c_{f}\left(u,v\right)\ |\ \left(u,v\right)\in p\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
כעת ניתן להשתמש במושג זה כדי להגדיר את הזרימה שאנו יוצרים מתוך מסלול שיפור:
\end_layout

\begin_layout Claim
תהא 
\begin_inset Formula $G_{f}$
\end_inset

 רשת שיורית עם מסלול שיפור 
\begin_inset Formula $p$
\end_inset

.
 נגדיר פונקציה 
\begin_inset Formula $f^{\prime}:V\times V\to\mathbb{R}$
\end_inset

 על ידי 
\begin_inset Formula $f_{p}\left(u,v\right)=\begin{cases}
c_{f}\left(p\right) & \left(u,v\right)\in p\\
0 & \text{else}
\end{cases}$
\end_inset


\end_layout

\begin_layout Claim
אז 
\begin_inset Formula $f_{p}$
\end_inset

 היא זרימה ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 ו-
\begin_inset Formula $\left|f_{p}\right|=c_{f}\left(p\right)$
\end_inset

.
\end_layout

\begin_layout Proof
\begin_inset Branch Class
inverted 0
status collapsed

\begin_layout Standard
תרגיל
\end_layout

\end_inset


\end_layout

\begin_layout Standard
נשים לב לכך שהקיבול השיורי של מסלול שיפור הוא תמיד מספר חיובי )גדול מאפס(
 כי מלכתחילה הגדרנו את קשתות הרשת השיורית בתור הקשתות שהקיבול שלהן חיובי.
 מכאן נקבל:
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:מסלול-שיפור-אכן-משפר"

\end_inset

אם 
\begin_inset Formula $p$
\end_inset

 מסלול שיפור ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 אז 
\begin_inset Formula $\left|f\uparrow f_{p}\right|=\left|f\right|+\left|f_{p}\right|>\left|f\right|$
\end_inset


\end_layout

\begin_layout Standard
במילים אחרות - מסלול שיפור אכן מאפשר לנו לשפר את 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Standard
כעת סיימנו להגדיר במפורש את כל המרכיבים של שיטת פורד-פולקרסון - עדיין נותר
 להבין מדוע היא עובדת )מחזירה את הזרימה המקסימלית ברשת( וכיצד ניתן למצוא
 מסלול שיפור ב-
\begin_inset Formula $G_{f}$
\end_inset

 בפועל.
\end_layout

\begin_layout Subsection
משפט חתך-מינימלי-זרימה-מקסימלית
\end_layout

\begin_layout Standard
אלגוריתם פורד-פולקרסון מסתיים כאשר הוא מגיעה לזרימה 
\begin_inset Formula $f$
\end_inset

 שעבורה ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 לא קיימים יותר מסלולי שיפור.
 אנו רוצים להוכיח כי בשלב זה, 
\begin_inset Formula $f$
\end_inset

 היא זרימה מקסימלית )לא קיימת ב-
\begin_inset Formula $G$
\end_inset

 זרימה עם ערך גבוה יותר(.
 כדי להוכיח זאת, נוכיח שזרימה היא מקסימלית אם ורק אם ערכה שווה ל
\series bold
ערך הקיבול של חתך 
\series default
ברשת.
 לצורך כך נצטרך להגדיר את מושג ה
\series bold
חתך
\series default
 והקיבול שלו.
\end_layout

\begin_layout Standard
כשעסקנו בעצים פורשים, 
\series bold
חתך
\series default
 היה חלוקה של צמתי הגרף לשתי קבוצות.
 כאן ההגדרה תהיה דומה עם התוספת לפיה החתך חייב להפריד בין 
\begin_inset Formula $s$
\end_inset

 ו-
\begin_inset Formula $t$
\end_inset

:
\end_layout

\begin_layout Definition
תהא 
\begin_inset Formula $G$
\end_inset

 רשת זרימה.
 
\series bold
חתך
\series default
 של 
\begin_inset Formula $G$
\end_inset

 הוא זוג קבוצות 
\begin_inset Formula $\left(S,T\right)$
\end_inset

 כך ש-
\begin_inset Formula $s\in S,t\in T$
\end_inset

 ו-
\begin_inset Formula $V=S\cup T$
\end_inset

.
\end_layout

\begin_layout Definition

\series bold
קיבול
\series default
 של חתך הוא סכום הקיבולים של הקשתות שחוצות את החתך מ-
\begin_inset Formula $S$
\end_inset

 אל 
\begin_inset Formula $T$
\end_inset

 )
\series bold
ללא
\series default
 הקשתות בכיוון ההפוך(:
\end_layout

\begin_layout Definition
\begin_inset Formula 
\begin{align*}
c\left(S,T\right) & =\sum_{u\in S}\sum_{v\in T}c\left(u,v\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Definition

\series bold
חתך מינימלי
\series default
 ב-
\begin_inset Formula $G$
\end_inset

 הוא חתך שערך הקיבול שלו מינימלי.
\end_layout

\begin_layout Definition
תהא 
\begin_inset Formula $f$
\end_inset

 זרימה ב-
\begin_inset Formula $G$
\end_inset

.
 
\series bold
הזרימה הכוללת
\series default
 של 
\begin_inset Formula $f$
\end_inset

 מ-
\begin_inset Formula $S$
\end_inset

 אל 
\begin_inset Formula $T$
\end_inset

 היא:
\end_layout

\begin_layout Definition
\begin_inset Formula 
\begin{align*}
\sum_{u\in S}\sum_{v\in T} & f\left(u,v\right)-\sum_{u\in S}\sum_{v\in T}f\left(v,u\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
הזרימה הכוללת של 
\begin_inset Formula $f$
\end_inset

 מ-
\begin_inset Formula $S$
\end_inset

 אל 
\begin_inset Formula $T$
\end_inset

, עבור כל חתך ב-
\begin_inset Formula $G$
\end_inset

, שווה ל-
\begin_inset Formula $\left|f\right|$
\end_inset

.
 האינטואיציה היא ש
\begin_inset Quotes erd
\end_inset

אין לזרימה לאן לברוח
\begin_inset Quotes erd
\end_inset

.
 המקום היחיד שאליו הזרימה שיוצאת מ-
\begin_inset Formula $s$
\end_inset

 יכולה להתנקז הוא 
\begin_inset Formula $t$
\end_inset

 )כי זרימה שמתנקזת אל 
\begin_inset Formula $s$
\end_inset

 לא נספרת כחלק מ-
\begin_inset Formula $\left|f\right|$
\end_inset

( ולכן היא תהיה חייבת לעבור מ-
\begin_inset Formula $S$
\end_inset

 אל 
\begin_inset Formula $T$
\end_inset

, בלי תלות בחתך.
 מכיוון שהזרימה הכוללת מ-
\begin_inset Formula $S$
\end_inset

 אל 
\begin_inset Formula $T$
\end_inset

 חסומה על ידי קיבול החתך, המסקנה היא ש-
\begin_inset Formula $\left|f\right|$
\end_inset

 חסום על ידי קיבול החתך 
\begin_inset Formula $\left(S,T\right)$
\end_inset

, וזאת 
\series bold
לכל
\series default
 חתך של רשת הזרימה.
 מכאן שכשהערך 
\begin_inset Formula $\left|f\right|$
\end_inset

 יהיה 
\series bold
מקסימלי
\series default
 הוא יהיה שווה לכל היותר לערך 
\series bold
המינימלי
\series default
 של קיבול חתך כלשהו של 
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Standard
פורמלית:
\end_layout

\begin_layout Theorem
יהא 
\begin_inset Formula $\left(S,T\right)$
\end_inset

 חתך של רשת הזרימה 
\begin_inset Formula $G$
\end_inset

 ו-
\begin_inset Formula $f$
\end_inset

 זרימה כלשהי.
 אז 
\begin_inset Formula $\left|f\right|$
\end_inset

 שווה לזרימה הכוללת של 
\begin_inset Formula $f$
\end_inset

 מ-
\begin_inset Formula $S$
\end_inset

 אל 
\begin_inset Formula $T$
\end_inset

.
\end_layout

\begin_layout Proof
\begin_inset Branch Class
inverted 0
status collapsed

\begin_layout Standard
תרגיל.
\end_layout

\end_inset


\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:זרימה-חסומה-על-ידי-חתך"

\end_inset

לכל זרימה 
\begin_inset Formula $f$
\end_inset

 ב-
\begin_inset Formula $G$
\end_inset

 ולכל חתך 
\begin_inset Formula $\left(S,T\right)$
\end_inset

 של 
\begin_inset Formula $G$
\end_inset

 מתקיים 
\begin_inset Formula $\left|f\right|\le c\left(S,T\right)$
\end_inset


\end_layout

\begin_layout Proof
ישירות מההגדרה ובהסתמך על המשפט הקודם:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\left|f\right| & =\sum_{u\in S}\sum_{v\in T}f\left(u,v\right)-\sum_{u\in S}\sum_{v\in T}f\left(v,u\right)\\
 & \le\sum_{u\in S}\sum_{v\in T}f\left(u,v\right)\\
 & \le\sum_{u\in S}\sum_{v\in T}c\left(u,v\right)\\
 & =c\left(S,T\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
כעת נוכל להוכיח את המשפט המרכזי שלנו:
\end_layout

\begin_layout Theorem
)
\begin_inset Quotes erd
\end_inset

חתך-מינימלי-זרימה-מקסימלית
\begin_inset Quotes erd
\end_inset

( תהא 
\begin_inset Formula $G$
\end_inset

 רשת זרימה עם זרימה 
\begin_inset Formula $f$
\end_inset

.
 התנאים הבאים שקולים:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f$
\end_inset

 היא זרימה מקסימלית ב-
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Enumerate
ברשת השיורית 
\begin_inset Formula $G_{f}$
\end_inset

 לא קיים מסלול שיפור.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\left|f\right|=c\left(S,T\right)$
\end_inset

 עבור חתך 
\begin_inset Formula $\left(S,T\right)$
\end_inset

 כלשהו של 
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Proof
נוכיח על ידי שרשרת הגרירות 
\begin_inset Formula $1\Rightarrow2\Rightarrow3\Rightarrow1$
\end_inset


\end_layout

\begin_layout Proof
\begin_inset Formula $1\Rightarrow2$
\end_inset

:
\end_layout

\begin_layout Proof
אם ב-
\begin_inset Formula $G_{f}$
\end_inset

 קיים מסלול שיפור 
\begin_inset Formula $p$
\end_inset

 אז כפי שראינו במסקנה 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:מסלול-שיפור-אכן-משפר"
plural "false"
caps "false"
noprefix "false"

\end_inset

, הזרימה 
\begin_inset Formula $f\uparrow f_{p}$
\end_inset

 ב-
\begin_inset Formula $G$
\end_inset

 מקיימת 
\begin_inset Formula $\left|f\uparrow f_{p}\right|>\left|f\right|$
\end_inset

, בסתירה למקסימליות 
\begin_inset Formula $f$
\end_inset

.
 מכאן שלא קיים מסלול שיפור ב-
\begin_inset Formula $G_{f}$
\end_inset

.
\end_layout

\begin_layout Proof
\begin_inset Formula $2\Rightarrow3$
\end_inset

:
\end_layout

\begin_layout Proof
נגדיר חתך של 
\begin_inset Formula $G$
\end_inset

 באופן הבא: 
\begin_inset Formula $S$
\end_inset

 תכלול את כל הצמתים ב-
\begin_inset Formula $V$
\end_inset

 שקיים מסלול אליהם מ-
\begin_inset Formula $s$
\end_inset

 בגרף השיורי 
\begin_inset Formula $G_{f}$
\end_inset

.
 נגדיר 
\begin_inset Formula $T=V\backslash S$
\end_inset

.
 מכיוון שלא קיים מסלול שיפור ב-
\begin_inset Formula $G_{f}$
\end_inset

, בפרט 
\begin_inset Formula $t\notin S$
\end_inset

 ולכן 
\begin_inset Formula $t\in T$
\end_inset

 ומכאן ש-
\begin_inset Formula $\left(S,T\right)$
\end_inset

 הוא חתך.
\end_layout

\begin_layout Proof
יהיו 
\begin_inset Formula $u\in S,v\in T$
\end_inset

 כלשהם.
 נפריד בין שלושה מקרים:
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 אז הקיבול השיורי של קשת זו הוא 
\begin_inset Formula $c_{f}\left(u,v\right)=c\left(u,v\right)-f\left(u,v\right)$
\end_inset

.
 אם 
\begin_inset Formula $f\left(u,v\right)<c\left(u,v\right)$
\end_inset

 אז 
\begin_inset Formula $c_{f}\left(u,v\right)>0$
\end_inset

 ולכן הקשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 תהיה שייכת ל-
\begin_inset Formula $G_{f}$
\end_inset

 ומכאן שקיים מסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

 )המסלול אל 
\begin_inset Formula $u$
\end_inset

 והצעד הנוסף אל 
\begin_inset Formula $v$
\end_inset

 דרך הקשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

(, בסתירה לשייכות 
\begin_inset Formula $v$
\end_inset

 אל 
\begin_inset Formula $T$
\end_inset

.
 מכאן ש-
\begin_inset Formula $f\left(u,v\right)=c\left(u,v\right)$
\end_inset

 במקרה זה, ואילו 
\begin_inset Formula $f\left(v,u\right)=0$
\end_inset

.
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $\left(u,v\right)\notin E$
\end_inset

 אז 
\begin_inset Formula $c\left(u,v\right)=0$
\end_inset

 ולכן 
\begin_inset Formula $f\left(u,v\right)=0=c\left(u,v\right)$
\end_inset

.
 נעבור לבדוק מה קורה במקרה זה ל-
\begin_inset Formula $f\left(v,u\right)$
\end_inset

 ונפצל לשני מקרים:
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $\left(v,u\right)\in E$
\end_inset

 אז 
\begin_inset Formula $c_{f}\left(u,v\right)=f\left(v,u\right)$
\end_inset

 ולכן אם 
\begin_inset Formula $f\left(v,u\right)\ne0$
\end_inset

 קיימת הקשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 ב-
\begin_inset Formula $G_{f}$
\end_inset

 ונגיע לסתירה כמו קודם.
 מכאן ש-
\begin_inset Formula $f\left(v,u\right)=0$
\end_inset

.
\end_layout

\begin_layout Proof
אם 
\begin_inset Formula $\left(v,u\right)\notin E$
\end_inset

 אז בגלל שגם 
\begin_inset Formula $\left(u,v\right)\notin E$
\end_inset

 נקבל 
\begin_inset Formula $c_{f}\left(v,u\right)=0$
\end_inset

, כלומר 
\begin_inset Formula $f\left(v,u\right)=0$
\end_inset

 גם במקרה זה.
\end_layout

\begin_layout Proof
נסכם: בכל שלושת המקרים קיבלנו ש-
\begin_inset Formula $f\left(u,v\right)=c\left(u,v\right)$
\end_inset

 ואילו 
\begin_inset Formula $f\left(v,u\right)=0$
\end_inset

, ומכאן
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\left|f\right| & =\sum_{u\in S}\sum_{v\in T}f\left(u,v\right)-\sum_{u\in S}\sum_{v\in T}f\left(v,u\right)\\
 & =\sum_{u\in S}\sum_{v\in T}c\left(u,v\right)-\sum_{u\in S}\sum_{v\in T}0\\
 & =c\left(S,T\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
\begin_inset Formula $3\Rightarrow1$
\end_inset

:
\end_layout

\begin_layout Proof
כפי שראינו במסקנה 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:זרימה-חסומה-על-ידי-חתך"
plural "false"
caps "false"
noprefix "false"

\end_inset

, לכל זרימה ב-
\begin_inset Formula $G$
\end_inset

 ערכה חסום מלעיל על ידי 
\begin_inset Formula $c\left(S,T\right)$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $\left|f\right|=c\left(S,T\right)$
\end_inset

 זוהי זרימה בעלת ערך מקסימלי.
\end_layout

\begin_layout Subsection
אלגוריתם אדמונדס-קארפ
\end_layout

\begin_layout Standard
אלגוריתם אדמונדס-קארפ הוא מימוש יעיל של שיטת פורד-פולקרסון.
 האלגוריתם מתחזק זרימה שמאותחלת להיות 
\begin_inset Formula $0$
\end_inset

 על כל קשתות הרשת, ובכל איטרציה מבצע הרצת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על הגרף השיורי 
\begin_inset Formula $G_{f}$
\end_inset

 למציאת מסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $t$
\end_inset

 משפר את 
\begin_inset Formula $f$
\end_inset

 בהתאם למסלול זה, ומסיים כאשר לא קיים מסלול כזה בגרף )מה שמוכיח את מקסימליות
 
\begin_inset Formula $f$
\end_inset

 בעזרת משפט חתך-מינימלי-זרימה-מקסימלית(.
 כזכור,
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מחזיר את המסלול 
\series bold
הקצר ביותר
\series default
, ונראה כי זה מבטיח התכנסות מהירה של האלגוריתם.
\end_layout

\begin_layout Standard
נציג מימוש של האלגוריתם בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\lang hebrew
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def edmonds_karp(flow_network):
\end_layout

\begin_layout Plain Layout

2      G,s,t,c = flow_network
\end_layout

\begin_layout Plain Layout

3      f = {(u,v): 0 for (u,v) in G.E}
\end_layout

\begin_layout Plain Layout

4      max_found = False
\end_layout

\begin_layout Plain Layout

5      while not max_found:
\end_layout

\begin_layout Plain Layout

6          p = find_augmenting_path(flow_network, f)
\end_layout

\begin_layout Plain Layout

7          if p is None:
\end_layout

\begin_layout Plain Layout

8              max_found = True
\end_layout

\begin_layout Plain Layout

9          else:
\end_layout

\begin_layout Plain Layout

10             f = augment_path(flow_network, f, p)
\end_layout

\begin_layout Plain Layout

11     return f
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

1  def find_augmenting_path(flow_network, f):
\end_layout

\begin_layout Plain Layout

2     G,s,t,c = flow_network
\end_layout

\begin_layout Plain Layout

3     E_f, c_f = residual_network(flow_network, f)
\end_layout

\begin_layout Plain Layout

4     G_f = Graph(G.V, E_f, directed=True)
\end_layout

\begin_layout Plain Layout

5     return BFS_shortest_path(G_f, s, t)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

1  def augment_path(flow_network, f, p):
\end_layout

\begin_layout Plain Layout

2      G,s,t,c = flow_network
\end_layout

\begin_layout Plain Layout

3      E_f, c_f = residual_network(flow_network, f)
\end_layout

\begin_layout Plain Layout

4      path_edges = [(p[i], p[i+1]) for i in range(len(p) - 1)]
\end_layout

\begin_layout Plain Layout

5      min_c_p = min([c_f[(u,v)] for (u,v) in path_edges])
\end_layout

\begin_layout Plain Layout

6      for (u,v) in path_edges:
\end_layout

\begin_layout Plain Layout

7          if (u,v) in G.E:
\end_layout

\begin_layout Plain Layout

8              f[(u,v)] = f[(u,v)] + min_c_p
\end_layout

\begin_layout Plain Layout

9          else:
\end_layout

\begin_layout Plain Layout

10             f[(v,u)] = f[(v,u)] - min_c_p
\end_layout

\begin_layout Plain Layout

11     return f
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

1  def residual_network(flow_network, f):
\end_layout

\begin_layout Plain Layout

2      G,s,t,c = flow_network
\end_layout

\begin_layout Plain Layout

3      c_f = {}
\end_layout

\begin_layout Plain Layout

4      for (u,v) in G.E:
\end_layout

\begin_layout Plain Layout

5          c_f[(u,v)] = c[(u,v)] - f[(u,v)]
\end_layout

\begin_layout Plain Layout

6          c_f[(v,u)] = f[(u,v)]
\end_layout

\begin_layout Plain Layout

7      E_f = [(u,v) for (u,v) in product(G.V, G.V) if c_f.get((u,v), 0) > 0]
\end_layout

\begin_layout Plain Layout

8      return (E_f,c_f)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
אדמונדס-קארפ מאתחל את 
\begin_inset Formula $f$
\end_inset

 להיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
לכל קשת בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\numeric off
.
 בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
6
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נקראת הפרוצדורה שמחפש מסלול שיפור, ואם נמצא כזה 
\begin_inset Formula $f$
\end_inset

 משופרת בשורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
10
\numeric off
.
 אם לא נמצא כזה, האלגוריתם מסתיים.
\end_layout

\begin_layout Standard
מציאת מסלול שיפור מתבצעת באמצעות בניה של הגרף השיורי והרצת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
רגיל עליו החל מ-
\begin_inset Formula $s$
\end_inset

, תוך בניית המסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $t$
\end_inset

 על ידי מעבר על הסדרה 
\begin_inset Formula $t.\pi,t.\pi.\pi,\ldots$
\end_inset

 עד להגעה אל 
\begin_inset Formula $s$
\end_inset

.
\end_layout

\begin_layout Standard
שיפור 
\begin_inset Formula $f$
\end_inset

 מתבצע על ידי חישוב 
\begin_inset Formula $c_{f}\left(p\right)$
\end_inset

 )הקיבול המינימלי בגרף השיורי על מסלול השיפור( והגדלת/הקטנת 
\begin_inset Formula $f$
\end_inset

 בהתאם.
\end_layout

\begin_layout Standard
לבסוף, הרשת השיורית עצמה נבנית ישירות מההגדרה שהצגנו קודם עבור 
\begin_inset Formula $c_{f}\left(u,v\right)=\begin{cases}
c\left(u,v\right)-f\left(u,v\right) & \left(u,v\right)\in E\\
f\left(u,v\right) & \left(v,u\right)\in E
\end{cases}$
\end_inset

 ו-
\begin_inset Formula $E_{f}=\left\{ \left(u,v\right)\ |\ c_{f}\left(u,v\right)>0\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
נעבור להוכחת נכונות האלגוריתם.
 על פניו הנכונות של שיטת פורד-פולקרסון ברורה, כי ראינו שהתנאי 
\begin_inset Quotes eld
\end_inset

אין מסלול שיפור
\begin_inset Quotes erd
\end_inset

 שקול לתנאי 
\begin_inset Quotes eld
\end_inset

הזרימה מקסימלית
\begin_inset Quotes erd
\end_inset

, אולם ההנחה המובלעת שלנו הייתה ששיטת פורד-פולקרסון בהכרח מסתיימת מתישהו,
 מה שעלול לא לקרות כלל אם קיבולות הקשתות אינן מספרים טבעיים - הזרימה אמנם
 תגדל בכל איטרציה, אבל בצורה שלא מתכנסת אל הזרימה המקסימלית.
\end_layout

\begin_layout Standard
למרבה המזל, באלגוריתם אדמונדס-קארפ הגדלת הזרימה מתקשרת בצורה חזקה אל 
\series bold
אורך המסלולים הקצרים ביותר
\series default
 בגרף השיורי, מה שמאפשר לנו לחסום את מספר האיטרציות.
\end_layout

\begin_layout Claim
\begin_inset CommandInset label
LatexCommand label
name "claim:אדמונדס-קארפ-מגדיל-מרחקים"

\end_inset

בכל איטרציה של אדמונדס-קארפ על רשת זרימה 
\begin_inset Formula $f$
\end_inset

 ולכל 
\begin_inset Formula $v\notin\left\{ s,t\right\} $
\end_inset

, המרחק המינימלי 
\begin_inset Formula $\delta_{f}\left(s,v\right)$
\end_inset

 של 
\begin_inset Formula $v$
\end_inset

 מ-
\begin_inset Formula $s$
\end_inset

 ברשת השיורית עולה מונוטונית )כלומר, אחרי איטרציה ערך זה אינו יכול לרדת(.
\end_layout

\begin_layout Proof
נניח בשלילה ש-
\begin_inset Formula $v\notin\left\{ s,t\right\} $
\end_inset

 הוא צומת כך שבשלב מסויים של אדמונדס-קארפ, שיפור 
\begin_inset Formula $f$
\end_inset

 מוביל להקטנת 
\begin_inset Formula $\delta_{f}\left(s,v\right)$
\end_inset

.
 נסמן ב-
\begin_inset Formula $f$
\end_inset

 את הזרימה לפני ההגדלה הראשונה שמובילה להקטנה כזו וב-
\begin_inset Formula $f^{\prime}$
\end_inset

 את הזרימה לאחריה, כלומר 
\begin_inset Formula $\delta_{f^{\prime}}\left(s,v\right)<\delta_{f}\left(s,v\right)$
\end_inset

.
 בלי הגבלת הכלליות, מבין כל הצמתים ששיפור 
\begin_inset Formula $f$
\end_inset

 מקטין את 
\begin_inset Formula $\delta_{f}$
\end_inset

 עבורם נבחר את 
\begin_inset Formula $v$
\end_inset

 להיות זה שעבורו 
\begin_inset Formula $\delta_{f^{\prime}}\left(s,v\right)$
\end_inset

 הוא מינימלי.
 נסמן ב-
\begin_inset Formula $p=s\rightsquigarrow u\to v$
\end_inset

 מסלול קצר ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $v$
\end_inset

, כלומר 
\begin_inset Formula $\left(u,v\right)\in E_{f^{\prime}}$
\end_inset

 ו-
\begin_inset Formula $\delta_{f^{\prime}}\left(s,u\right)=\delta_{f^{\prime}}\left(s,v\right)-1$
\end_inset

.
\end_layout

\begin_layout Proof
מכיוון שבחרנו את 
\begin_inset Formula $v$
\end_inset

 להיות בעל ערך 
\begin_inset Formula $\delta_{f^{\prime}}\left(s,v\right)$
\end_inset

 מינימלי מבין כל הצמתים ש-
\begin_inset Formula $\delta_{f}$
\end_inset

 שלהם מוקטן, 
\begin_inset Formula $u$
\end_inset

 אינו צומת כזה.
 כלומר 
\begin_inset Formula $\delta_{f}\left(s,u\right)\le\delta_{f^{\prime}}\left(s,u\right)$
\end_inset

.
\end_layout

\begin_layout Proof
כעת נראה כי 
\begin_inset Formula $\text{\left(u,v\right)\ensuremath{\notin E_{f}}}$
\end_inset

, שכן אחרת היינו מגיעים לסתירה הבאה:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\delta_{f}\left(s,v\right) & \le\delta_{f}\left(s,u\right)+1\\
 & \le\delta_{f^{\prime}}\left(s,u\right)+1\\
 & =\delta_{f^{\prime}}\left(s,v\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כלומר, הקשת 
\begin_inset Formula $\left(u,v\right)\in E_{f}$
\end_inset

 הייתה מבטיחה את הגדלת 
\begin_inset Formula $\delta_{f}\left(s,v\right)$
\end_inset

, בסתירה להנחה שלנו.
\end_layout

\begin_layout Proof
אם כן, במעבר מ-
\begin_inset Formula $E_{f}$
\end_inset

 אל 
\begin_inset Formula $E_{f^{\prime}}$
\end_inset

 הקשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 
\series bold
התווספה
\series default
 אל הגרף.
 אם 
\begin_inset Formula $\text{\left(u,v\right)\ensuremath{\in E}}$
\end_inset

 זה יכול לקרות אם השיפור 
\series bold
מקטין
\series default
 את 
\begin_inset Formula $f\left(u,v\right)$
\end_inset

 )כדי שיפסיק להתקיים 
\begin_inset Formula $c\left(u,v\right)-f\left(u,v\right)=0$
\end_inset

(, כלומר אם הזרימה השיורית במסלול השיפור 
\begin_inset Formula $p$
\end_inset

 היא מ-
\begin_inset Formula $v$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

.
 אם 
\begin_inset Formula $\left(u,v\right)\notin E$
\end_inset

 אז השיפור צריך 
\series bold
להגדיל
\series default
 את 
\begin_inset Formula $f\left(v,u\right)$
\end_inset

 )כדי שיפסיק להתקיים 
\begin_inset Formula $f\left(v,u\right)=0$
\end_inset

( - כלומר גם במקרה זה הזרימה השיורית היא מ-
\begin_inset Formula $v$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Proof
כעת נשתמש באופן שבו אלגוריתם אדמונדס-קארפ עובד: מסלול השיפור שהוא מוצא הוא
 תמיד המסלול הקצר ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $t$
\end_inset

, כך שהוא גם המסלול הקצר ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל כל צומת שעל המסלול.
 בפרט המסלול מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 הוא כזה, כלומר הקשת 
\begin_inset Formula $\left(v,u\right)$
\end_inset

 היא הקשת האחרונה במסלול הקצר ביותר מ-
\begin_inset Formula $s$
\end_inset

 אל 
\begin_inset Formula $u$
\end_inset

 ב-
\begin_inset Formula $G_{f}$
\end_inset

.
 מכאן נסיק:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\delta_{f}\left(s,v\right) & =\delta_{f}\left(s,u\right)-1\\
 & \le\delta_{f^{\prime}}\left(s,u\right)-1\\
 & =\delta_{f^{\prime}}\left(s,v\right)-2
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
וזאת בסתירה להנחה המקורית שלנו ש-
\begin_inset Formula $\delta_{f^{\prime}}\left(s,v\right)<\delta_{f}\left(s,v\right)$
\end_inset

.
 מכאן שלא קיים צומת 
\begin_inset Formula $v$
\end_inset

 שהאיטרציה של אדמונדס-קארפ מקטינה את המרחק המינימלי עבורו.
\end_layout

\begin_layout Standard
בעזרת טענת העזר נוכל להוכיח את הסיבוכיות )ולכן גם את הנכונות( של אדמונדס-קארפ:
\end_layout

\begin_layout Theorem
סיבוכיות זמן הריצה של אלגוריתם אדמונדס-קארפ על רשת זרימה 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 היא 
\begin_inset Formula $O\left(\left|V\right|\left|E\right|\right)$
\end_inset

.
\end_layout

\begin_layout Proof
נאמר שקשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 ברשת שיורית 
\begin_inset Formula $G_{f}$
\end_inset

 היא 
\series bold
קריטית
\series default
 על מסלול שיפור 
\begin_inset Formula $p$
\end_inset

 אם היא שייכת למסלול והקיבול שלה שווה לקיבול המסלול, כלומר 
\begin_inset Formula $c_{f}\left(p\right)=c_{f}\left(u,v\right)$
\end_inset

.
 בכל מסלול שיפור קיימת קשת שכזו )כי קיבול המסלול נקבע על ידי המינימום מבין
 קיבולי הקשתות שעליו( ואחרי שיפור הזרימה בהתאם למסלול השיפור, הקשת תיעלם
 מהרשת השיורית )כי אם 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 אז השיפור גרם ל-
\begin_inset Formula $f$
\end_inset

 להגיע למלוא הקיבולת של 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 ואילו אם 
\begin_inset Formula $\left(v,u\right)\in E$
\end_inset

 אז השיפור איפס את 
\begin_inset Formula $f$
\end_inset

 ולכן ביטל את הקשת השיורית בכיוון השני(.
\end_layout

\begin_layout Proof
נוכיח כי במהלך ריצת אדמונדס-קארפ, כל קשת עשויה להפוך לקריטית לכל היותר 
\begin_inset Formula $\frac{\left|V\right|}{2}+1$
\end_inset

 פעמים.
 מכיוון שבכל איטרציה קשת כלשהי חייבת להפוך לקריטית, ובגרף השיורי מספר הקשתות
 הוא 
\begin_inset Formula $O\left(\left|E\right|\right)$
\end_inset

 )כי הוא שווה למספר הקשתות ב-
\begin_inset Formula $G$
\end_inset

 ואולי גם חלק מהקשתות בכיוון ההפוך, כתלות ב-
\begin_inset Formula $f$
\end_inset

( הרי שמספר האיטרציות חסום על ידי 
\begin_inset Formula $O\left(\left|V\right|\left|E\right|\right)$
\end_inset

.
\end_layout

\begin_layout Proof
יהיו 
\begin_inset Formula $u,v\in V$
\end_inset

 צמתים שמחוברים ביניהם בקשת )ולכן יכולה להיות קשת ביניהם בשני הכיוונים בגרף
 השיורי(.
 בפעם הראשונה שבה הקשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 היא קריטית, מכיוון שהיא נחה על מסלול שיפור ובאדמונדס-קארפ מסלול שיפור הוא
 מסלול קצר ביותר, הרי ש-
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\delta_{f} & \left(s,v\right)=\delta_{f}\left(s,u\right)+1
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
אחרי ביצוע השיפור הקשת 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 מוסרת מהגרף השיורי.
 על מנת להפוך שוב לקשת קריטית, היא צריכה להתווסף בהמשך.
 זה יכול לקרות רק אם יהיה בהמשך מסלול שיפור שבו מופיעה הקשת בכיוון הנגדי,
 
\begin_inset Formula $\left(v,u\right)$
\end_inset

 )לאו דווקא מופיעה בתור קשת קריטית(.
\end_layout

\begin_layout Proof
תהא 
\begin_inset Formula $f^{\prime}$
\end_inset

 הזרימה ב-
\begin_inset Formula $G$
\end_inset

 כאשר מופיע מסלול השיפור הזה.
 אז מאותו נימוק על מסלולים קצרים, נקבל
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\delta_{f^{\prime}}\left(s,u\right) & =\delta_{f^{\prime}}\left(s,v\right)+1
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כעת נשתמש בטענה 
\begin_inset CommandInset ref
LatexCommand ref
reference "claim:אדמונדס-קארפ-מגדיל-מרחקים"
plural "false"
caps "false"
noprefix "false"

\end_inset

 שהוכחנו קודם ולפיה בכל איטרציה של אדמונדס-קארפ המרחק המינימלי של כל צומת
 מ-
\begin_inset Formula $s$
\end_inset

 לא יכול לקטון.
 כלומר
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\delta_{f}\left(s,v\right) & \le\delta_{f^{\prime}}\left(s,v\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
ומכאן נסיק:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
\delta_{f^{\prime}}\left(s,u\right) & =\delta_{f^{\prime}}\left(s,v\right)+1\\
 & \ge\delta_{f}\left(s,v\right)+1\\
 & =\delta_{f}\left(s,u\right)+2
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
כלומר, בין שתי נקודות הזמן שבהן 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 הופכת לקריטית, המרחק של 
\begin_inset Formula $u$
\end_inset

 מ-
\begin_inset Formula $s$
\end_inset

 גדל לפחות ב-
\numeric on
2
\numeric off
.
\end_layout

\begin_layout Proof
כעת, המרחק המקסימלי של 
\begin_inset Formula $u$
\end_inset

 מ-
\begin_inset Formula $s$
\end_inset

 הוא חסום על ידי 
\begin_inset Formula $\left|V\right|$
\end_inset

, ולכן מספר הפעמים הנוספות שבהן 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 עשויה להפוך לקריטית חסום על ידי 
\begin_inset Formula $\frac{\left|V\right|}{2}$
\end_inset

 ובסך הכל מספר הפעמים שבהן הקשת עשויה להפוך לקריטית חסום על ידי 
\begin_inset Formula $\frac{\left|V\right|}{2}+1$
\end_inset

 כנדרש.
 זה מסיים את ההוכחה.
\end_layout

\begin_layout Subsection
מציאת שידוך מקסימום בגרף דו-צדדי
\end_layout

\begin_layout Standard
נציג כעת שימוש של רשתות זרימה כדי לפתור את הבעיה הקומבינטורית של מציאת 
\series bold
שידוך מקסימום בגרף דו צדדי
\series default
.
 שימוש זה הוא דוגמא ל
\series bold
רדוקציה
\series default
 - האופן שבו ממירים את הקלט של בעיה אחת בקלט של בעיה אחרת, כך שפתרון לבעיה
 האחרת מתורגם ישירות לפתרון של הבעיה המקורית.
\end_layout

\begin_layout Standard
נפתח בחזרה על ההגדרות הרלוונטיות מתורת הגרפים:
\end_layout

\begin_layout Definition
יהא 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 גרף לא מכוון.
 
\series bold
שידוך
\series default
 ב-
\begin_inset Formula $G$
\end_inset

 הוא תת-קבוצה 
\begin_inset Formula $M\subseteq E$
\end_inset

 של קשתות כך שלכל 
\begin_inset Formula $v\in V$
\end_inset

, הוא מופיע לכל היותר באחת מהקשתות ב-
\begin_inset Formula $M$
\end_inset

.
 
\series bold
שידוך מקסימום
\series default
 ב-
\begin_inset Formula $G$
\end_inset

 הוא שידוך ב-
\begin_inset Formula $G$
\end_inset

 כך שלכל שידוך 
\begin_inset Formula $M^{\prime}$
\end_inset

 ב-
\begin_inset Formula $G$
\end_inset

 מתקיים 
\begin_inset Formula $\left|M^{\prime}\right|\le\left|M\right|$
\end_inset

.
\end_layout

\begin_layout Standard
המושג מכונה 
\begin_inset Quotes eld
\end_inset

שידוך
\begin_inset Quotes erd
\end_inset

 שכן הוא יוצר זוגות מבין צמתי הגרף )כל זוג הוא נקודות הקצה של אחת מהקשתות
 בשידוך( תוך שמירה על הקריטריון שהשידוך הוא 
\begin_inset Quotes eld
\end_inset

מונוגמי
\begin_inset Quotes erd
\end_inset

 - אין צומת שמשודך לשני צמתים שונים.
\end_layout

\begin_layout Standard
לשידוכים יש שימושים רבים, כששימוש בולט אחד הוא ב
\series bold
הקצאת משאבים
\series default
: למשל, אם יש לנו אוסף 
\begin_inset Formula $L$
\end_inset

 של משימות חישוביות ואוסף 
\begin_inset Formula $R$
\end_inset

 של מחשבים שניתן להריץ משימות חישוביות עליהם, כשיש קשת בין משימה מ-
\begin_inset Formula $L$
\end_inset

 לכל מחשב ב-
\begin_inset Formula $R$
\end_inset

 שמסוגל להתמודד איתה, ואנו מעוניינים להקצות מחשבים לפתרון כמות גדולה ככל
 הניתן של משימות חישוביות.
\end_layout

\begin_layout Standard
בדוגמא זו ובדוגמאות דומות לה יש בגרף שלנו שתי קבוצות מובחנות של צמתים, כשיש
 קשת רק בין איברי קבוצה אחת לשניה ולא בתוך הקבוצות עצמן.
 סוג מיוחד זה של גרפים זוכה לשם משל עצמו:
\end_layout

\begin_layout Definition
גרף 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 נקרא 
\series bold
דו-צדדי
\series default
 אם 
\begin_inset Formula $V=L\cup R$
\end_inset

 כך ש-
\begin_inset Formula $L\cap R=\emptyset$
\end_inset

 ולכל 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 מתקיים 
\begin_inset Formula $u\in L,v\in R$
\end_inset

 או ההפך, 
\begin_inset Formula $u\in R,v\in L$
\end_inset

.
\end_layout

\begin_layout Standard
ניתן לבדוק האם גרף הוא דו-צדדי באמצעות הרצת אלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\lang hebrew
; אנו נניח כאן כי הגרפים כבר נתונים עם תיאור מפורש של הקבוצות 
\begin_inset Formula $L,R$
\end_inset

.
\end_layout

\begin_layout Standard
נרצה לפתור את הבעיה הבאה: בהינתן קלט של גרף דו-צדדי 
\begin_inset Formula $G=\text{\left(L\cup R,E\right)}$
\end_inset

, למצוא שידוך מקסימום 
\begin_inset Formula $M$
\end_inset

 עבור 
\begin_inset Formula $G$
\end_inset

.
 נפתור בעיה זו באמצעות 
\series bold
רדוקציה
\series default
 לבעיית מציאת זרימה מקסימלית:
\end_layout

\begin_layout Standard
מתוך 
\begin_inset Formula $G$
\end_inset

 נבנה רשת זרימה 
\begin_inset Formula $G^{\prime}=\left(V^{\prime},E^{\prime}\right)$
\end_inset

 כך ש-
\begin_inset Formula $V^{\prime}=L\cup R\cup\left\{ s,t\right\} $
\end_inset

 עבור צמתים חדשים 
\begin_inset Formula $s,t$
\end_inset

, וקשתות 
\begin_inset Formula 
\begin{align*}
E^{\prime} & =\left\{ \left(s,u\right)\ |\ u\in L\right\} \cup\left\{ \left(u,v\right)\ |\ \left(u,v\right)\in E\right\} \cup\left\{ \left(v,t\right)\ |\ v\in R\right\} 
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
דהיינו, אנחנו מוסיפים קשת מ-
\begin_inset Formula $s$
\end_inset

 לכל צמתי 
\begin_inset Formula $L$
\end_inset

, קשת מכל צמתי 
\begin_inset Formula $R$
\end_inset

 אל 
\begin_inset Formula $t$
\end_inset

, ומכוונים את כל הקשתות ב-
\begin_inset Formula $E$
\end_inset

 כך שילכו מ-
\begin_inset Formula $L$
\end_inset

 אל 
\begin_inset Formula $R$
\end_inset

.
\end_layout

\begin_layout Standard
לבסוף, נגדיר פונקציית קיבול 
\begin_inset Formula $c:E^{\prime}\to\mathbb{R}$
\end_inset

 על ידי 
\begin_inset Formula $c\left(e\right)=1$
\end_inset

 לכל 
\begin_inset Formula $e\in E^{\prime}$
\end_inset

.
\end_layout

\begin_layout Standard
בהינתן זרימה 
\begin_inset Formula $f$
\end_inset

 עבור 
\begin_inset Formula $G^{\prime}$
\end_inset

, נגדיר באמצעותה שידוך באופן הבא: 
\begin_inset Formula $M_{f}=\left\{ \left(u,v\right)\in L\times R\ |\ f\left(u,v\right)=1\right\} $
\end_inset

.
\end_layout

\begin_layout Claim
\begin_inset Formula $M_{f}$
\end_inset

 הוא שידוך ב-
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Proof
ראשית נשים לב לכך ש-
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 אחרת היה מתקיים 
\begin_inset Formula $c\left(u,v\right)=0$
\end_inset

 ואז 
\begin_inset Formula $f\left(u,v\right)=1$
\end_inset

 היה מפר את אילוץ הקיבול.
\end_layout

\begin_layout Proof
נניח כעת בשלילה שקיימים 
\begin_inset Formula $v_{1}\ne v_{2}\in R$
\end_inset

 כך ש-
\begin_inset Formula $\left(u,v_{1}\right)\in M_{f}$
\end_inset

 וגם 
\begin_inset Formula $\left(u,v_{2}\right)\in M_{f}$
\end_inset

.
 אז 
\begin_inset Formula $\sum_{v\in V}f\left(u,v\right)\ge2$
\end_inset

 אבל 
\begin_inset Formula $\sum_{v\in V}f\left(v,u\right)=f\left(s,u\right)\le1$
\end_inset

 כי הקשת הנכנסת היחידה אל 
\begin_inset Formula $u$
\end_inset

 היא מ-
\begin_inset Formula $s$
\end_inset

.
 מכאן שאילוץ שימור הזרימה מופר.
 לכן לא קיימים 
\begin_inset Formula $v_{1},v_{2}$
\end_inset

 כנ
\begin_inset Quotes erd
\end_inset

ל.
 בדומה מטופל גם המקרה של התנגשות עבור צומת ב-
\begin_inset Formula $R$
\end_inset

.
\end_layout

\begin_layout Standard
ראינו שמכל זרימה 
\begin_inset Formula $f$
\end_inset

 ניתן לקבל שידוך 
\begin_inset Formula $M_{f}$
\end_inset

.
 גם ההפך נכון: אם 
\begin_inset Formula $M$
\end_inset

 שידוך, אפשר לקבל ממנו זרימה על ידי העברת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בכל קשת השייכת לשידוך, תוך הזרמת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מ-
\begin_inset Formula $s$
\end_inset

 ואל 
\begin_inset Formula $t$
\end_inset

 מהצמתים שמופיעים בשידוך.
 בצורה זו מתקבלת זרימה 
\begin_inset Formula $f_{M}$
\end_inset

 כך ש-
\begin_inset Formula $\left|f_{M}\right|=\left|M\right|$
\end_inset

.
\end_layout

\begin_layout Standard
מה שטרם הוכחנו הוא את ההפך: שבמקרה שבו בונים שידוך מתוך זרימה, 
\begin_inset Formula $\left|M_{f}\right|=\left|f\right|$
\end_inset

.
 אם נוכיח זאת נסיים באופן הבא: אם 
\begin_inset Formula $f$
\end_inset

 היא זרימה מקסימלית אז נובע מכך ש-
\begin_inset Formula $M_{f}$
\end_inset

 הוא שידוך מקסימום שכן אם היה קיים שידוך 
\begin_inset Formula $M$
\end_inset

 עם 
\begin_inset Formula $\left|M_{f}\right|<\left|M\right|$
\end_inset

 היינו מקבלים סתירה למקסימליות 
\begin_inset Formula $f$
\end_inset

: 
\begin_inset Formula $\left|f\right|=\left|M_{f}\right|<\left|M\right|=\left|f_{M}\right|$
\end_inset

.
\end_layout

\begin_layout Standard
הקושי היחיד שלנו הוא בהוכחה ש-
\begin_inset Formula $\left|M_{f}\right|=\left|f\right|$
\end_inset

.
 הבעיה עשויה לנבוע מכך שבנוסף לזוגות 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 שעבורם 
\begin_inset Formula $f\left(u,v\right)=1$
\end_inset

 יהיו עוד זוגות שדרכם מועברת זרימה 
\series bold
שאינה מספר שלם
\series default
 ומאפשרת הגדלה נוספת של הזרימה, כך שמתקבל 
\begin_inset Formula $\left|M_{f}\right|<\left|f\right|$
\end_inset

.
 
\begin_inset Branch Not
inverted 0
status collapsed

\begin_layout Standard
הדבר בהחלט עשוי להתרחש בפועל, דהיינו שתהיה קיימת בגרף זרימה מקסימלית שבה
 לא כל הקשתות מעבירות זרימה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
.
\end_layout

\end_inset

.
 בחינה מדוקדקת של אלגוריתם אדמונדס-קארפ מעלה שדבר כזה לא יכול להתרחש בו
 במקרה )כמו זה שלנו( שבו הגרף כולל רק קיבולים שהם מספרים שלמים - במקרה כזה,
 כל השינויים בזרימה יהיו עם ערכים שהם מספר שלם.
\end_layout

\begin_layout Section
אלגוריתמים בסיסיים בתורת המספרים
\end_layout

\begin_layout Subsection
הסיבוכיות של אלגוריתמים על מספרים
\end_layout

\begin_layout Standard
מספר טבעי הוא 
\series bold
ראשוני
\series default
 אם הוא מתחלק רק בעצמו וב-
\numeric on
1
\numeric off
.
 אם 
\begin_inset Formula $n=ab$
\end_inset

 אז לא ייתכן ש-
\begin_inset Formula $a>\sqrt{n}$
\end_inset

 וגם 
\begin_inset Formula $b>\sqrt{n}$
\end_inset

 כי אז היינו מקבלים 
\begin_inset Formula $n=ab>n$
\end_inset

 וזו סתירה.
 לכן אם מחפשים ל-
\begin_inset Formula $n$
\end_inset

 פירוק מהצורה 
\begin_inset Formula $n=ab$
\end_inset

 מספיק לבדוק רק 
\series bold
עד השורש
\series default
 של 
\begin_inset Formula $n$
\end_inset

.
 זה מניב את אלגוריתם 
\begin_inset Quotes eld
\end_inset

עד השורש
\begin_inset Quotes erd
\end_inset

 לבדיקת ראשוניות:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

def is_prime(n):
\end_layout

\begin_layout Plain Layout

    for a in range(2, math.ceil(math.sqrt(n) + 1)):
\end_layout

\begin_layout Plain Layout

        if n % a == 0:
\end_layout

\begin_layout Plain Layout

            return False
\end_layout

\begin_layout Plain Layout

    return True
\end_layout

\end_inset

האלגוריתם עונה נכון לכל 
\begin_inset Formula $n\ge2$
\end_inset

, וסיבוכיות זמן הריצה שלו היא 
\begin_inset Formula $O\left(\sqrt{n}\right)/$
\end_inset

.
 לכאורה זהו זמן ריצה טוב, אך בפועל זהו אלגוריתם גרוע ביותר מבחינת סיבוכיות,
 שאין טעם להפעיל אלא עבור קלטים קטנים.
\end_layout

\begin_layout Standard
הסיבה לכך היא שסיבוכיות של אלגוריתמים שפועלים על מספרים נמדדת על פי רוב
 ביחס ל
\series bold
גודל הייצוג
\series default
 של המספר - למספר הספרות שלו.
 בכל בסיס שאינו אונרי, מספר הספרות של 
\begin_inset Formula $n$
\end_inset

 הוא מסדר גודל של 
\begin_inset Formula $\ln\left(n\right)$
\end_inset

, ולכן סיבוכיות האלגוריתם נמדדת ביחס לגודל זה.
 כך למשל הסיבוכיות של אלגוריתם 
\series bold
חיבור ארוך
\series default
 היא 
\begin_inset Formula $O\left(\log n\right)$
\end_inset

, והסיבוכיות של אלגוריתם כפל ארוך היא 
\begin_inset Formula $O\left(\log^{3}n\right)$
\end_inset

.
 לעומת זאת, הסיבוכיות של אלגוריתם 
\begin_inset Quotes eld
\end_inset

עד השורש
\begin_inset Quotes erd
\end_inset

 היא 
\begin_inset Formula $O\left(\sqrt{n}\right)=O\left(\sqrt{2^{\lg n}}\right)=O\left(\left(\sqrt{2}\right)^{\lg n}\right)$
\end_inset

 - אקספוננציאלית ב-
\begin_inset Formula $\lg n$
\end_inset

.
\end_layout

\begin_layout Standard
אלגוריתם בדיקת ראשוניות שהוא פולינומי ב-
\begin_inset Formula $\lg n$
\end_inset

 היה אתגר מהותי עבור מדעי המחשב.
 בהמשך נראה אלגוריתם 
\series bold
הסתברותי
\series default
 לבדיקת ראשוניות שפועל בזמן פולינומי; אלגוריתם 
\series bold
דטרמיניסטי
\series default
 כזה התגלה רק ב-
\numeric on
2002
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)אלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
AKS
\lang hebrew
( ולא נציג אותו כאן.
\end_layout

\begin_layout Standard
לצורך פשטות, נמדוד סיבוכיות של אלגוריתמים על מספרים באמצעות ספירת 
\series bold
פעולות אטומיות
\series default
 שכולן ניתנות למימוש בזמן יעיל )פולינומי בגודל הייצוג עם פולינום קטן( -
 חיבור, חיסור, כפל ו
\series bold
חילוק עם שארית
\series default
.
 נזכיר את האחרון:
\end_layout

\begin_layout Standard
בהינתן זוג מספרים טבעיים 
\begin_inset Formula $a,b$
\end_inset

 ניתן למצוא 
\begin_inset Formula $q,r$
\end_inset

 טבעיים כך ש-
\begin_inset Formula $a=qb+r$
\end_inset

 כך ש-
\begin_inset Formula $0\le r<b$
\end_inset

.
\end_layout

\begin_layout Standard
אפשר להכליל את מעט את המשפט אם מרשים ל-
\begin_inset Formula $a,q$
\end_inset

 להיות 
\series bold
שלמים
\series default
 )כלומר, לאפשר גם שליליים(.
\end_layout

\begin_layout Subsection
אלגוריתם למציאת המחלק המשותף המקסימלי
\end_layout

\begin_layout Subsubsection
הגדרה והאלגוריתם הבסיסי
\end_layout

\begin_layout Standard

\series bold
המחלק המשותף המקסימלי
\series default
 )
\lang english
gcd
\lang hebrew
, ראשי תיבות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
greatest common divisor
\lang hebrew
( של זוג מספרים טבעיים 
\begin_inset Formula $a,b$
\end_inset

 הוא המספר הטבעי 
\begin_inset Formula $d$
\end_inset

 המקסימלי כך ש-
\begin_inset Formula $d|a$
\end_inset

 וגם 
\begin_inset Formula $d|b$
\end_inset

 )לכל 
\begin_inset Formula $a,b$
\end_inset

 לכל הפחות 
\begin_inset Formula $d=1$
\end_inset

 מקיים תכונה זו כך שה-
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 קיים תמיד(.
 נסמן 
\begin_inset Formula $d=\text{gcd}\left(a,b\right)$
\end_inset

 ולרוב כשזה יהיה ברור מההקשר נשמיט את ה-
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 ונכתוב פשוט 
\begin_inset Formula $\left(a,b\right)$
\end_inset

.
 קיום אלגוריתם יעיל לחישוב ה-
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של שני מספרים היה ידוע כבר לאוקלידס, והיעילות שלו היא הבסיס לרוב התוצאות
 שנראה בהמשך.
\end_layout

\begin_layout Standard
לצורך חישוב ה-
\lang english
gcd
\lang hebrew
, נשים לב לאבחנה הבאה:
\end_layout

\begin_layout Claim
אם 
\begin_inset Formula $a=qb+r$
\end_inset

 אז 
\begin_inset Formula $\left(a,b\right)=\left(b,r\right)$
\end_inset


\end_layout

\begin_layout Proof
נסמן 
\begin_inset Formula $d=\left(a,b\right)$
\end_inset

 ו-
\begin_inset Formula $d^{\prime}=\left(b,r\right)$
\end_inset

.
 מכך ש-
\begin_inset Formula $d|a$
\end_inset

 ו-
\begin_inset Formula $d|b$
\end_inset

 נובע שהוא מחלק כל צירוף לינארי שלהם, בפרט 
\begin_inset Formula $d|a-qb=r$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $d^{\prime}$
\end_inset

 הוא המקסימלי שמחלק את 
\begin_inset Formula $b,r$
\end_inset

 אז 
\begin_inset Formula $d\le d^{\prime}$
\end_inset

.
 באופן דומה מוכיחים ש-
\begin_inset Formula $d^{\prime}\le d$
\end_inset

, ושני אלו מראים ש-
\begin_inset Formula $d=d^{\prime}$
\end_inset

.
\end_layout

\begin_layout Standard
אבחנה זו מניבה אלגוריתם רקורסיבי פשוט.
 נציג אותו בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\lang hebrew
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def gcd(a,b):
\end_layout

\begin_layout Plain Layout

2     if b == 0:
\end_layout

\begin_layout Plain Layout

3         return a
\end_layout

\begin_layout Plain Layout

4     return gcd(b, a % b)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
תנאי העצירה של האלגוריתם הוא המקרה שבו 
\begin_inset Formula $b=0$
\end_inset

, ובמקרה זה 
\begin_inset Formula $\left(a,0\right)=a$
\end_inset

 )כי 
\begin_inset Formula $a|0$
\end_inset

 ו-
\begin_inset Formula $a\ge0$
\end_inset

(.
 בכל מקרה אחר, מחושב ה-
\begin_inset Formula $r$
\end_inset

 בביטוי 
\begin_inset Formula $a=qb+r$
\end_inset

 והאלגוריתם ממשיך רקורסיבית עבור הזוג 
\begin_inset Formula $b,r$
\end_inset

.
\end_layout

\begin_layout Subsubsection
ניתוח סיבוכיות האלגוריתם הבסיסי
\end_layout

\begin_layout Standard
על מנת למצוא את זמן הריצה של האלגוריתם, נתחיל מלשאול את עצמנו מה המספרים
 שעבורם הביצוע שלו הוא הגרוע ביותר ביחס לגודל הייצוג שלהם - לכל 
\begin_inset Formula $k$
\end_inset

, מה המספרים הקטנים ביותר שעדיין דורשים 
\begin_inset Formula $k$
\end_inset

 צעדי חישוב? התשובה היא 
\series bold
מספרי פיבונאצ'י
\series default
 שנזכיר כאן:
\end_layout

\begin_layout Definition

\series bold
סדרת פיבונאצ'י
\series default
 היא סדרת המספרים 
\begin_inset Formula $0,1,1,2,3,5,8,13,\ldots$
\end_inset

 המוגדרת על ידי נוסחת הנסיגה הבאה:
\end_layout

\begin_layout Definition
\begin_inset Formula $F_{k}=\begin{cases}
0 & k=0\\
1 & k=1\\
F_{k-1}+F_{k-2} & k\ge2
\end{cases}$
\end_inset


\end_layout

\begin_layout Standard
לסדרת פיבונאצ'י שימושים רבים ושונים, וההופעה שלה בהקשר של אלגוריתם ה-
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא טבעית למדי כפי שנוכיח כעת:
\end_layout

\begin_layout Claim
אם 
\begin_inset Formula $a>b\ge1$
\end_inset

 והרצת 
\begin_inset Formula $\text{gcd}\left(a,b\right)$
\end_inset

 ביצעה 
\begin_inset Formula $k\ge1$
\end_inset

 קריאות רקורסיביות, אז 
\begin_inset Formula $a\ge F_{k+2}$
\end_inset

 ו-
\begin_inset Formula $b\ge F_{k+1}$
\end_inset

.
\end_layout

\begin_layout Proof
נוכיח את הטענה באינדוקציה על 
\begin_inset Formula $k$
\end_inset

.
 
\end_layout

\begin_layout Proof

\series bold
בסיס: 
\series default
עבור 
\begin_inset Formula $k=1$
\end_inset

, מכיוון ש-
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ביצעה קריאה רקורסיבית לא ייתכן ש-
\begin_inset Formula $b=0$
\end_inset

 ולכן 
\begin_inset Formula $b\ge1=F_{2}$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $a>b$
\end_inset

 הרי ש-
\begin_inset Formula $a\ge2=F_{3}$
\end_inset

.
\end_layout

\begin_layout Proof

\series bold
צעד:
\series default
 נניח נכונות עבור 
\begin_inset Formula $k-1$
\end_inset

 ונוכיח עבור 
\begin_inset Formula $k$
\end_inset

.
 נניח ש-
\begin_inset Formula $\text{gcd}\left(a,b\right)$
\end_inset

 ביצעה 
\begin_inset Formula $k>1$
\end_inset

 קריאות רקורסיביות, אז 
\begin_inset Formula $\text{gcd}\left(b,r\right)$
\end_inset

 ביצעה 
\begin_inset Formula $k-1\ge1$
\end_inset

 קריאות רקורסיביות עבור 
\begin_inset Formula $a=qb+r$
\end_inset

 ולכן ניתן להשתמש עליה בהנחת האינדוקציה ולקבל: 
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $b\ge F_{\left(k-1\right)+2}=F_{k+1}$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $r\ge F_{\left(k-1\right)+1}=F_{k}$
\end_inset


\end_layout

\begin_layout Standard
כעת נסיק: 
\begin_inset Formula $a=qb+r\ge b+r=F_{k+1}+F_{k}=F_{k+2}$
\end_inset

, כמבוקש.
\end_layout

\end_deeper
\begin_layout Standard
נשים לב שההוכחה גם מצביעה לנו על הסיטואציה שבה החסם מושג: המעבר 
\begin_inset Formula $qb+r\ge b+r$
\end_inset

 שהוא שוויון כאשר 
\begin_inset Formula $q=1$
\end_inset

 הוא המקרה הגרוע ביותר )כי אז ה
\begin_inset Quotes erd
\end_inset

הקטנה
\begin_inset Quotes erd
\end_inset

 שאנחנו מקבלים במעבר מ-
\begin_inset Formula $a$
\end_inset

 אל 
\begin_inset Formula $r$
\end_inset

 היא הנמוכה ביותר - מחסרים את 
\begin_inset Formula $b$
\end_inset

 בדיוק פעם אחת(.
\end_layout

\begin_layout Corollary
לכל 
\begin_inset Formula $k\ge1$
\end_inset

, אם 
\begin_inset Formula $a>b\ge1$
\end_inset

 ו-
\begin_inset Formula $b<F_{k+1}$
\end_inset

 אז 
\begin_inset Formula $\text{gcd}\left(a,b\right)$
\end_inset

 מבצע פחות מ-
\begin_inset Formula $k$
\end_inset

 קריאות רקורסיביות.
\end_layout

\begin_layout Standard
כעת נוכל לחסום את זמן הריצה של 
\begin_inset Formula $\text{gcd}\left(a,b\right)$
\end_inset

.
 ראשית, מספר צעדי החישוב ש-
\begin_inset Formula $\text{gcd}\left(a,b\right)$
\end_inset

 מבצע הוא לינארי במספר הקריאות הרקורסיביות )כי אין לולאה פרט לקריאה הרקורסיבית(.
 שנית, אם 
\begin_inset Formula $b\ge a$
\end_inset

 אז אחרי הקריאה הרקורסיבית הראשונה נקבל 
\begin_inset Formula $a>b$
\end_inset

 )במקרה זה 
\begin_inset Formula $a=b$
\end_inset

 של הסיבוב הקודם ו-
\begin_inset Formula $b=r$
\end_inset

 של הסיבוב הקודם( ולכן תוספת של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
למספר הקריאות הרקורסיביות מבטיחה שניכנס לתנאי הטענה שהוכחנו קודם.
 לבסוף, אנו יודעים במדויק מה קצב הגידול של 
\begin_inset Formula $F_{k}$
\end_inset

, מכיוון שידועה לנו נוסחה סגורה לסדרה זו: 
\begin_inset Formula $F_{k}=\frac{\phi^{k}+\phi_{-1}^{k}}{\sqrt{5}}$
\end_inset

 כאשר 
\begin_inset Formula $\phi=\frac{1+\sqrt{5}}{2}$
\end_inset

 הוא 
\series bold
יחס הזהב
\series default
 ו-
\begin_inset Formula $\phi_{-}=\frac{1-\sqrt{5}}{2}$
\end_inset

.
 עם זאת, ניתן להסתפק גם בחסם תחתון נאיבי יותר:
\end_layout

\begin_layout Standard
\begin_inset Formula $F_{k}=F_{k-1}+F_{k-2}\ge2F_{k-2}\ge\ldots\ge2^{\left\lfloor \frac{k}{2}\right\rfloor }\ge\frac{1}{2}\left(\sqrt{2}\right)^{k}$
\end_inset


\end_layout

\begin_layout Standard
כעת, בהינתן 
\begin_inset Formula $b$
\end_inset

, יהא 
\begin_inset Formula $F_{k}$
\end_inset

 מספר פיבונאצ'י המקסימלי כך ש-
\begin_inset Formula $F_{k}\le b$
\end_inset

.
 כלומר, מצד אחד 
\begin_inset Formula $b<F_{k+1}$
\end_inset

 ולכן 
\begin_inset Formula $\text{gcd}\left(a,b\right)$
\end_inset

 מבצע פחות מ-
\begin_inset Formula $k$
\end_inset

 קריאות רקורסיביות; מצד שני, 
\begin_inset Formula $b\ge F_{k}\ge\frac{1}{2}\left(\sqrt{2}\right)^{k}$
\end_inset

 ולכן 
\begin_inset Formula $\lg\left(b\right)\ge\lg\left(\frac{1}{2}\left(\sqrt{2}\right)^{k}\right)=k\lg\left(\sqrt{2}\right)-1$
\end_inset

, כלומר 
\begin_inset Formula $k=O\left(\log b\right)$
\end_inset

 וזהו גם חסם זמן הריצה של האלגוריתם.
\end_layout

\begin_layout Subsubsection
האלגוריתם האוקלידי המורחב
\end_layout

\begin_layout Standard
בשימוש פרקטי באלגוריתם האוקלידי על פי רוב אנחנו מעוניינים לא רק במציאת ה-
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אלא גם במציאת ייצוג שלו בתור 
\series bold
צירוף לינארי
\series default
 של 
\begin_inset Formula $a,b$
\end_inset

, מה שניתן לביצוע על ידי הרחבה קלה של האלגוריתם האוקלידי שאינה כרוכה בהגדלת
 הסיבוכיות.
\end_layout

\begin_layout Theorem
אם 
\begin_inset Formula $d=\left(a,b\right)$
\end_inset

 אז קיימים שלמים 
\begin_inset Formula $x,y$
\end_inset

 כך ש-
\begin_inset Formula $d=ax+by$
\end_inset


\end_layout

\begin_layout Proof
נוכיח באינדוקציה שלמה על 
\begin_inset Formula $b$
\end_inset

.
 אם 
\begin_inset Formula $b=0$
\end_inset

 אז 
\begin_inset Formula $\left(a,b\right)=a=a\cdot1+b\cdot0$
\end_inset

 .
 אחרת, 
\begin_inset Formula $a=qb+r$
\end_inset

 כך ש-
\begin_inset Formula $0\le r<b$
\end_inset

 ומהנחת האינדוקציה ומכך ש-
\begin_inset Formula $d=\left(b,r\right)$
\end_inset

, קיימים 
\begin_inset Formula $x^{\prime},y^{\prime}$
\end_inset

 כך ש-
\begin_inset Formula $d=bx^{\prime}+ry^{\prime}$
\end_inset

.
\end_layout

\begin_layout Proof
נציב בנוסחה עבור 
\begin_inset Formula $d$
\end_inset

 את 
\begin_inset Formula $r=a-qb$
\end_inset

 ונקבל:
\end_layout

\begin_layout Proof
\begin_inset Formula $d=bx^{\prime}+\left(a-qb\right)y^{\prime}=ay^{\prime}+b\left(x^{\prime}-qy^{\prime}\right)$
\end_inset


\end_layout

\begin_layout Proof
על כן, נגדיר:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $x=y^{\prime}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $y=x^{\prime}-qy^{\prime}$
\end_inset


\end_layout

\begin_layout Standard
ונקבל 
\begin_inset Formula $d=ax+by$
\end_inset

 כמבוקש.
\end_layout

\end_deeper
\begin_layout Standard
ההוכחה כוללת בתוכה גם את השיטה שבה ניתן לחשב את 
\begin_inset Formula $x,y$
\end_inset

 מתוך הקריאה הרקורסיבית.
 נשתמש בכך על מנת להרחיב את אלגוריתם ה-
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שראינו:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def extended_gcd(a,b):
\end_layout

\begin_layout Plain Layout

2     if b == 0:
\end_layout

\begin_layout Plain Layout

3         return (a, 1, 0)
\end_layout

\begin_layout Plain Layout

4     d, x, y = extended_gcd(b, a % b)
\end_layout

\begin_layout Plain Layout

5     return (d, y, x - (a // b) * y)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
סיבוכיות האלגוריתם זהה לזו שכבר ראינו, כי לא שינינו את המבנה הרקורסיבי שלו
 אלא רק הוספנו חישוב אריתמטי לכל איטרציה.
\end_layout

\begin_layout Subsubsection
חישוב הכפולה המשותפת המינימלית
\end_layout

\begin_layout Standard

\series bold
הכפולה המשותפת המינימלית
\series default
 
\begin_inset Formula $\text{lcm}\left(a,b\right)$
\end_inset

 היא מעין מושג אנלוגי ל-
\begin_inset Formula $\text{gcd}$
\end_inset

.
 בעוד ה-
\begin_inset Formula $\text{gcd}$
\end_inset

 הוא המספר 
\begin_inset Formula $d$
\end_inset

 
\series bold
הגדול ביותר
\series default
 כך ש-
\begin_inset Formula $d|a$
\end_inset

 וגם 
\begin_inset Formula $d|b$
\end_inset

, 
\begin_inset Formula $\text{lcm}$
\end_inset

 הוא המספר הטבעי האי שלילי 
\begin_inset Formula $f$
\end_inset

 
\series bold
הקטן ביותר
\series default
 כך ש-
\begin_inset Formula $a|f$
\end_inset

 וגם 
\begin_inset Formula $b|f$
\end_inset

.
 למרבה המזל, תכונה פשוטה שקושרת בין ה-
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וה-
\lang english
lcm
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מאפשרת לנו חישוב יעיל של השני:
\end_layout

\begin_layout Theorem
\begin_inset Formula $\text{lcm}\left(a,b\right)=\frac{ab}{\text{gcd}\left(a,b\right)}$
\end_inset


\end_layout

\begin_layout Proof
די להוכיח כי 
\begin_inset Formula $\text{lcm}\left(a,b\right)\cdot\text{gcd}\left(a,b\right)=ab$
\end_inset

.
\end_layout

\begin_layout Proof
נכתוב 
\begin_inset Formula $a=p_{1}^{k_{1}}\cdots p_{n}^{k_{n}}$
\end_inset

 ו-
\begin_inset Formula $b=p_{1}^{t_{1}}\cdots p_{n}^{t_{n}}$
\end_inset

 כאשר 
\begin_inset Formula $p_{1},\ldots,p_{n}$
\end_inset

 הם הראשוניים שמחלקים את 
\begin_inset Formula $a$
\end_inset

 ואלו שמחלקים את 
\begin_inset Formula $b$
\end_inset

 )אם ראשוני מחלק רק אחד משניהם, הוא יופיע בחזקת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
במכפלה השניה(.
 נשים לב לכך שמתקיים
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\text{gcd}\left(a,b\right)=p_{1}^{\min\left\{ k_{1},t_{1}\right\} }\cdots p_{n}^{\min\left\{ k_{n},t_{n}\right\} }$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\text{lcm}\left(a,b\right)=p_{1}^{\text{max}\left\{ k_{1},t_{1}\right\} }\cdots p_{n}^{\text{max}\left\{ k_{n},t_{n}\right\} }$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $ab=p_{1}^{k_{1}+t_{1}}\cdots p_{n}^{k_{n}+t_{n}}$
\end_inset


\end_layout

\end_deeper
\begin_layout Proof
המשפט כעת נובע מיידית מכך ש-
\begin_inset Formula $x+y=\text{min}\left\{ x,y\right\} +\text{max}\left\{ x,y\right\} $
\end_inset

 לכל זוג מספרים 
\begin_inset Formula $x,y$
\end_inset

 )שכן אחד מהם שווה למינימום והשני שווה למקסימום(.
\end_layout

\begin_layout Standard
נסיים באבחנה על תכונה שימושית של ה-
\lang english
gcd
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וה-
\lang english
lcm
\lang hebrew
:
\end_layout

\begin_layout Theorem
יהיו 
\begin_inset Formula $a,b$
\end_inset

 טבעיים כלשהם.
 אז 
\begin_inset Formula $\text{gcd}\left(a,b\right)$
\end_inset

 מתחלק בכל מספר שמחלק גם את 
\begin_inset Formula $a$
\end_inset

 וגם את 
\begin_inset Formula $b$
\end_inset

, ואילו 
\begin_inset Formula $\text{lcm}\left(a,b\right)$
\end_inset

 מחלק כל מספר שמתחלק גם ב-
\begin_inset Formula $a$
\end_inset

 וגם ב-
\begin_inset Formula $b$
\end_inset

.
\end_layout

\begin_layout Proof
ראינו כי 
\begin_inset Formula $\text{gcd}\left(a,b\right)=ax+by$
\end_inset

 עבור 
\begin_inset Formula $x,y$
\end_inset

 כלשהם.
 אם 
\begin_inset Formula $c$
\end_inset

 הוא מספר כך ש-
\begin_inset Formula $c|a$
\end_inset

 וגם 
\begin_inset Formula $c|b$
\end_inset

 אז הוא מחלק גם את המכפלה שלהם בקבוע ואת סכומם, כלומר 
\begin_inset Formula $c|ax+by=\text{gcd}\left(a,b\right)$
\end_inset

.
\end_layout

\begin_layout Proof
יהא כעת 
\begin_inset Formula $c$
\end_inset

 כך ש-
\begin_inset Formula $a|c$
\end_inset

 וגם 
\begin_inset Formula $b|c$
\end_inset

.
 נסמן 
\begin_inset Formula $m=\text{lcm}\left(a,b\right)$
\end_inset

 ונחלק את 
\begin_inset Formula $c$
\end_inset

 ב-
\begin_inset Formula $m$
\end_inset

: 
\begin_inset Formula $c=mq+r$
\end_inset

 כאשר 
\begin_inset Formula $0\le r<m$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $a|c$
\end_inset

 וגם 
\begin_inset Formula $a|m$
\end_inset

 אז 
\begin_inset Formula $a|c-mq=r$
\end_inset

.
 בדומה גם 
\begin_inset Formula $b|r$
\end_inset

.
 כלומר, 
\begin_inset Formula $r$
\end_inset

 הוא כפולה משותפת של 
\begin_inset Formula $a,b$
\end_inset

 שקטנה מ-
\begin_inset Formula $m$
\end_inset

 ולכן בהכרח 
\begin_inset Formula $r=0$
\end_inset

 אחרת נקבל סתירה להגדרת 
\begin_inset Formula $m$
\end_inset

 כמינימלי.
 מכאן ש-
\begin_inset Formula $c$
\end_inset

 מתחלק ב-
\begin_inset Formula $m$
\end_inset

 ללא שארית.
\end_layout

\begin_layout Subsection
אריתמטיקה מודולרית
\end_layout

\begin_layout Standard
תורת המספרים אינה עוסקת רק בחוג השלמים 
\begin_inset Formula $\mathbb{Z}$
\end_inset

 אלא בחוגים רבים נוספים בעלי תכונות פחות או יותר דומות לאלו של 
\begin_inset Formula $\mathbb{Z}$
\end_inset

.
 הדוגמא השימושית והנפוצה ביותר היא החוג 
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

 שבו נעסוק כאן.
\end_layout

\begin_layout Standard
בהינתן 
\begin_inset Formula $n$
\end_inset

 טבעי כלשהו אפשר לחלק את המספרים השלמים ל
\series bold
מחלקות שקילות 
\series default
על פי השארית שהם מחזירים בחלוקה ב-
\begin_inset Formula $n$
\end_inset

 )שהיא מספר בתחום 
\begin_inset Formula $0,1,\ldots,n-1$
\end_inset

(.
 למשל, עבור 
\begin_inset Formula $n=3$
\end_inset

 נקבל את מחלקות השקילות:
\end_layout

\begin_layout Standard
\begin_inset Formula $\left\{ 0,3,-3,6,-6,\ldots\right\} $
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\left\{ 1,4,-2,7,-5,\ldots\right\} $
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\left\{ 2,5,-1,8,-4,\ldots\right\} $
\end_inset


\end_layout

\begin_layout Standard
אוסף מחלקות השקילות של היחס הזה מסומן ב-
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

.
 נהוג לסמן את אבריו פשוט בתור 
\begin_inset Formula $\mathbb{Z}_{n}=\left\{ 0,1,2,\ldots,n-1\right\} $
\end_inset

 ולהגדיר עליהם פעולות חיבור וכפל שמושרות מהפעולות המתאימות על 
\begin_inset Formula $\mathbb{Z}$
\end_inset

.
 אנו אומרים ש-
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

 הוא 
\series bold
חוג
\series default
 מכיוון שהוא קבוצה שמוגדרות עליה פעולות חיבור וכפל שמקיימות חלק מהתכונות
 הבסיסיות שמתקיימות עבור פעולות אלו ב-
\begin_inset Formula $\mathbb{Z}$
\end_inset

.
\end_layout

\begin_layout Standard
פורמלית, לבקיאים בתורת החוגים, 
\begin_inset Formula $\mathbb{Z}_{n}=\mathbb{Z}/n\mathbb{Z}$
\end_inset

 עם הפעולות המושרות 
\begin_inset Formula $\left[a\right]+\left[b\right]=\left[a+b\right]$
\end_inset

 ו-
\begin_inset Formula $\left[a\right]\cdot\left[b\right]=\left[a\cdot b\right]$
\end_inset

.
\end_layout

\begin_layout Standard
ביצוע פעולות ה
\series bold
חיבור
\series default
 וה
\series bold
כפל
\series default
 של איברים ב-
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

 הוא פשוט: מבצעים עבורם את פעולות החיבור והכפל הרגילות, ולאחר מכן מוצאים
 את השארית של חלוקת התוצאה ב-
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Standard
נעסוק כעת בשתי פעולות נוספות שניתן לבצע ב-
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

: חילוק והעלאה בחזקה.
\end_layout

\begin_layout Subsubsection
הופכי כפלי וחילוק ב-
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset


\end_layout

\begin_layout Standard
בהינתן 
\begin_inset Formula $a\in\mathbb{Z}_{n}$
\end_inset

, נאמר ש-
\begin_inset Formula $x\in\mathbb{Z}_{n}$
\end_inset

 הוא 
\series bold
הופכי כפלי
\series default
 של 
\begin_inset Formula $a$
\end_inset

 אם 
\begin_inset Formula $ax=1$
\end_inset

.
 למשל, בחוג 
\begin_inset Formula $\mathbb{Z}_{7}$
\end_inset

, ההופכי הכפלי של 
\begin_inset Formula $3$
\end_inset

 הוא 
\begin_inset Formula $5$
\end_inset

 כי 
\begin_inset Formula $3\cdot5=15$
\end_inset

 ואחרי חלוקה ב-
\numeric on
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ולקיחת שארית נקבל
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
.
\end_layout

\begin_layout Standard
תופעה זו, שבה מוכפלים 
\begin_inset Formula $a,b$
\end_inset

 ששונים מ-
\begin_inset Formula $\pm1$
\end_inset

 ומתקבל 
\begin_inset Formula $1$
\end_inset

 לא מתרחשת ב-
\begin_inset Formula $\mathbb{Z}$
\end_inset

.
 זה מאפשר לנו להגדיר 
\series bold
חלוקה
\series default
 עבור מספרים הפיכים: אם 
\begin_inset Formula $a$
\end_inset

 הפיך עם הופכי 
\begin_inset Formula $b$
\end_inset

, אז חלוקה ב-
\begin_inset Formula $a$
\end_inset

 מוגדרת ככפל בהופכי שלו, 
\begin_inset Formula $b$
\end_inset

.
 עם זאת, לא לכל מספר ב-
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

 קיים הפיך:
\end_layout

\begin_layout Theorem
יהא 
\begin_inset Formula $n$
\end_inset

 טבעי כלשהו ו-
\begin_inset Formula $a\in\mathbb{Z}_{n}$
\end_inset

.
 אז 
\begin_inset Formula $a$
\end_inset

 הפיך אם ורק אם 
\begin_inset Formula $\left(a,n\right)=1$
\end_inset

.
\end_layout

\begin_layout Proof
בכיוון אחד, אם 
\begin_inset Formula $\text{gcd}\left(a,n\right)=1$
\end_inset

 אז קיימים 
\begin_inset Formula $x,y$
\end_inset

 כך ש-
\begin_inset Formula $ax+yn=1$
\end_inset

.
 אם נתבונן על משוואה זו מודולו 
\begin_inset Formula $n$
\end_inset

, נקבל 
\begin_inset Formula $ax=1$
\end_inset

 כך ש-
\begin_inset Formula $x$
\end_inset

 הוא ההופכי של 
\begin_inset Formula $a$
\end_inset

.
\end_layout

\begin_layout Proof
בכיוון השני, אם 
\begin_inset Formula $d=\text{gcd}\left(a,n\right)>1$
\end_inset

 נתבונן ב-
\begin_inset Formula $b=\frac{n}{d}$
\end_inset

.
 זהו מספר טבעי המקיים 
\begin_inset Formula $0<b<n$
\end_inset

 ובפרט 
\begin_inset Formula $b\in\mathbb{Z}_{n}$
\end_inset

.
 עם זאת, 
\begin_inset Formula $ba=a\frac{n}{d}=\frac{a}{d}n$
\end_inset

 ו-
\begin_inset Formula $\frac{a}{d}n$
\end_inset

 הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מודולו 
\begin_inset Formula $n$
\end_inset

 כי הוא מתחלק ב-
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Proof
כעת, נניח בשלילה כי 
\begin_inset Formula $a$
\end_inset

 הפיך, כלומר קיים 
\begin_inset Formula $x$
\end_inset

 כך ש-
\begin_inset Formula $ax=1$
\end_inset

.
 אז נקבל 
\begin_inset Formula $b=b\cdot1=b\cdot\left(ax\right)=\left(ba\right)x=0\cdot x=0$
\end_inset

 וקיבלנו ש-
\begin_inset Formula $b=0$
\end_inset

 בסתירה לכך שראינו כי 
\begin_inset Formula $b>0$
\end_inset

.
\end_layout

\begin_layout Standard
בלשון תורת החוגים, ההוכחה הראתה שכל איבר שונה מ-
\numeric on
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ב-
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

 הוא או הפיך או 
\series bold
מחלק אפס
\series default
, כלומר קיים איבר שונה מאפס כך שמכפלתם שווה לאפס )גם תופעה זו אינה קיימת
 ב-
\begin_inset Formula $\mathbb{Z}$
\end_inset

(.
 תכונה זו נותנת מוטיבציה להגדרה הבאה:
\end_layout

\begin_layout Definition
יהא 
\begin_inset Formula $n$
\end_inset

 טבעי.
 
\series bold
חבורת ההפיכים
\series default
 מודולו 
\begin_inset Formula $n$
\end_inset

 היא הקבוצה 
\begin_inset Formula $\mathbb{Z}_{n}^{*}\triangleq\left\{ a\in\mathbb{Z}_{n}\ |\ \left(a,n\right)=1\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
אנו מכנים את 
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

 בשם 
\series bold
חבורה
\series default
 כי אם משמיטים ממנה את פעולת החיבור ונותרים עם פעולת הכפל, מתקבל המבנה האלגברי
 
\series bold
חבורה
\series default
.
\end_layout

\begin_layout Standard
אם 
\begin_inset Formula $\left(a,b\right)=1$
\end_inset

 אנו אומרים ש-
\begin_inset Formula $a,b$
\end_inset

 הם 
\series bold
זרים
\series default
.
 אם כן, התוצאה שראינו היא כי כדי להיות הפיך מודולו 
\begin_inset Formula $n$
\end_inset

 מספיק והכרחי להיות זרים אליו.
\end_layout

\begin_layout Standard
מכיוון שבידינו אלגוריתם יעיל לחישוב
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
gcd
\lang hebrew
, ניתן להשתמש בו למציאת הופכי מודולורי או קביעה שאין כזה:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def modular_inverse(a,n):
\end_layout

\begin_layout Plain Layout

2     d, x, y = extended_gcd(a,n)
\end_layout

\begin_layout Plain Layout

3     if d > 1:
\end_layout

\begin_layout Plain Layout

4         return None
\end_layout

\begin_layout Plain Layout

5     return x
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
העלאה מהירה בחזקה
\end_layout

\begin_layout Standard
כאשר אנו עובדים במספרים שלמים, ביצוע אלגוריתמי של העלאה בחזקה גבוהה, למשל
 חישוב 
\begin_inset Formula $2^{10^{10}}$
\end_inset

, הוא עניין קשה בגלל 
\series bold
גודל הייצוג
\series default
 הגדול של התוצאה.
 שיקולי זמן ריצה הופכים להיות משניים בחישוב כזה.
 לעומת זאת, אם אנו מבצעים חישובים מודולו 
\begin_inset Formula $n$
\end_inset

 כאשר 
\begin_inset Formula $n$
\end_inset

 מסדר גודל סביר )גוגול, 
\begin_inset Formula $10^{100}$
\end_inset

 הוא עדיין סדר גודל סביר שכזה, למשל( הרי שתוצאה של העלאה בחזקה גבוהה 
\begin_inset Formula $k$
\end_inset

 שכזו תהיה בעלת ייצוג בגודל סביר אבל חישוב פעולת ההעלאה בחזקה על ידי ביצוע
 סדרתי של 
\begin_inset Formula $k$
\end_inset

 פעולות כפל הוא איטי שלא לצורך.
 נראה כאן כיצד ניתן לחשב את 
\begin_inset Formula $a^{k}$
\end_inset

 בסיבוכיות 
\begin_inset Formula $O\left(\log k\right)$
\end_inset

 פעולות כפל.
 האלגוריתם תקף גם במספרים שלמים - אך כאמור, השימושיות שלו מוגבלת יותר שם
 עקב הגודל העצום של התוצאה.
\end_layout

\begin_layout Standard
בהינתן 
\begin_inset Formula $a$
\end_inset

, ניתן לכפול אותו בעצמו לקבלת 
\begin_inset Formula $a^{2}$
\end_inset

.
 מספר זה ניתן לכפול בעצמו לקבלת 
\begin_inset Formula $a^{4}$
\end_inset

, וכן הלאה.
 נקבל את הסדרה:
\end_layout

\begin_layout Standard
\begin_inset Formula $a,a^{2},a^{4},a^{8},a^{16},a^{32},\ldots,a^{2^{t}},\ldots$
\end_inset


\end_layout

\begin_layout Standard
שבה חישוב 
\begin_inset Formula $a^{2^{t}}$
\end_inset

 דרש רק 
\begin_inset Formula $t$
\end_inset

 פעולות כפל.
\end_layout

\begin_layout Standard
על מנת לחשב את 
\begin_inset Formula $a^{k}$
\end_inset

 עבור כל מספר 
\begin_inset Formula $k$
\end_inset

, ניזכר ראשית בכך שניתן לייצג את 
\begin_inset Formula $k$
\end_inset

 ב
\series bold
ייצוג בינארי
\series default
, בתור סכום חזקות של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\numeric off
:
\end_layout

\begin_layout Standard
\begin_inset Formula $k=\sum_{i=0}^{t}b_{i}2^{i}$
\end_inset


\end_layout

\begin_layout Standard
כאשר 
\begin_inset Formula $b_{i}\in\left\{ 0,1\right\} $
\end_inset

 ו-
\begin_inset Formula $t=\left\lfloor \lg k\right\rfloor $
\end_inset

.
\end_layout

\begin_layout Standard
ולכן ניתן לכתוב את 
\begin_inset Formula $a^{k}$
\end_inset

 כך:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
a^{k} & =a^{\sum_{i=0}^{t}b_{i}2^{i}}=\prod_{i=0}^{t}a^{b_{i}2^{i}}=\prod_{b_{i}=0}a^{2^{i}}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
כלומר, כדי לחשב את 
\begin_inset Formula $a^{k}$
\end_inset

 אנחנו יכולים לאתחל איבר 
\begin_inset Formula $x=1$
\end_inset

 ולחשב את הסדרה 
\begin_inset Formula $a,a^{2},a^{4},\ldots,a^{2^{t}}$
\end_inset

 כך שבכל פעם שבה הגענו אל 
\begin_inset Formula $i$
\end_inset

 עבורו 
\begin_inset Formula $b_{i}=1$
\end_inset

, אנו כופלים את האיבר 
\begin_inset Formula $a^{2^{i}}$
\end_inset

 שהגענו אליו ב-
\begin_inset Formula $x$
\end_inset

.
\end_layout

\begin_layout Standard
נקבל את האלגוריתם הבא:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def modular_power(a,k,n):
\end_layout

\begin_layout Plain Layout

2     x = 1
\end_layout

\begin_layout Plain Layout

3     a_power = a
\end_layout

\begin_layout Plain Layout

4     while k > 0:
\end_layout

\begin_layout Plain Layout

5         if k % 2 == 1:
\end_layout

\begin_layout Plain Layout

6             x = (x * a_power) % n
\end_layout

\begin_layout Plain Layout

7         k = k // 2
\end_layout

\begin_layout Plain Layout

8         a_power = (a_power * a_power) % n
\end_layout

\begin_layout Plain Layout

9     return x
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
משפט השאריות הסיני
\end_layout

\begin_layout Standard
משפט השאריות הסיני נותן לנו את היכולת לפתור 
\series bold
מערכת משוואות מודולריות
\series default
.
 נפתח עם דוגמא, ברוח 
\begin_inset Quotes eld
\end_inset

פגישת התאומים
\begin_inset Quotes erd
\end_inset

 של אפרים קישון: לצורך תיקון דליפה בצינור בדירה עלינו להביא אליה בו זמנית
 את שטוקס האינסטלטור שיתקן את הצינור ואת גדעון הבנאי שיפתח את הקיר.
 לרוע המזל שטוקס פנוי רק ביום ג' כל שבוע ואילו גדעון פנוי רק ביום ה' כל
 שבועיים, כך שנראה שאין דרך להפגיש אותם.
 למרבה המזל, לאחר מעט שכנוע הצלחנו לגרום לגדעון לחשוב שיום שבת מגיע רק אחת
 לשבועיים, כך שהם כוללים רק
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
13
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ימים.
 האם כעת נוכל לגרום להם להיפגש?
\end_layout

\begin_layout Standard
בתרגום למתמטיקה, השאלה היא האם קיים 
\begin_inset Formula $x$
\end_inset

 כך ש-
\end_layout

\begin_layout Standard
\begin_inset Formula $x\equiv_{7}3$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $x\equiv_{13}5$
\end_inset


\end_layout

\begin_layout Standard
על מנת למצוא את הפתרון נשתמש בתעלול הבא: נניח שהצלחנו למצוא זוג מספרים 
\begin_inset Formula $a,b$
\end_inset

 המקיימים
\end_layout

\begin_layout Standard
\begin_inset Formula $a\equiv_{7}1$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $a\equiv_{13}0$
\end_inset


\end_layout

\begin_layout Standard
ו-
\end_layout

\begin_layout Standard
\begin_inset Formula $b\equiv_{7}0$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $b\equiv_{13}1$
\end_inset


\end_layout

\begin_layout Standard
במקרה זה, אם נגדיר 
\begin_inset Formula $x=3a+5b$
\end_inset

 נקבל את התוצאה המבוקשת:
\end_layout

\begin_layout Standard
\begin_inset Formula $x\equiv_{7}3\cdot1+5\cdot0=3$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $x\equiv_{13}3\cdot0+5\cdot1=5$
\end_inset


\end_layout

\begin_layout Standard
יתר על כן, אם נמצא 
\begin_inset Formula $a,b$
\end_inset

 כאלו נוכל לפתור גם 
\series bold
כל משוואה אחרת
\series default
 מודולו
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 ו-
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
13
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
- פשוט נכפיל את 
\begin_inset Formula $a,b$
\end_inset

 בתוצאות המבוקשות, בהתאם.
\end_layout

\begin_layout Standard
כיצד נמצא 
\begin_inset Formula $a,b$
\end_inset

 מתאימים? ראשית, מכיוון ש-
\begin_inset Formula $\left(7,13\right)=1$
\end_inset

 הרי ש-
\begin_inset Formula $13$
\end_inset

 הפיך מודולו 
\begin_inset Formula $7$
\end_inset

, כלומר קיים 
\begin_inset Formula $s$
\end_inset

 כך ש-
\begin_inset Formula $13s\equiv_{7}1$
\end_inset

.
 בנוסף, 
\begin_inset Formula $13s\equiv_{13}0$
\end_inset

.
 אם נשתמש באלגוריתם האוקלידי נקבל 
\begin_inset Formula $s=-1$
\end_inset

, ועל כן נגדיר 
\begin_inset Formula $a=-13$
\end_inset

.
\end_layout

\begin_layout Standard
באופן דומה, מכיוון ש-
\numeric on
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הפיך מודולו 
\begin_inset Formula $13$
\end_inset

 עם הופכי
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\numeric off
, נגדיר 
\begin_inset Formula $b=14$
\end_inset

.
\end_layout

\begin_layout Standard
כעת נקבל 
\begin_inset Formula $x=3\cdot\left(-13\right)+5\cdot14=-39+70=31$
\end_inset

.
 זהו מספר הימים שנחכה עד ששטוקס וגדעון יוכלו להיפגש.
\end_layout

\begin_layout Standard
נעבור כעת למקרה הכללי.
 מהדוגמא שראינו עולה שאם המודולוסים אינם זרים )כמו במקרה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\numeric on
14
\numeric off
( אז ייתכן שלמערכת המשוואות לא תהיה פתרון, אבל אם הם זרים אז לכל בחירת ערכים
 לאגף ימין של המשוואה, קיים פתרון למשוואה.
 זה נכון גם באופן כללי:
\end_layout

\begin_layout Theorem
)משפט השאריות הסיני( יהיו 
\begin_inset Formula $n_{1},\ldots,n_{k}$
\end_inset

 מספרים טבעיים חיוביים כך ש-
\begin_inset Formula $\left(n_{i},n_{j}\right)=1$
\end_inset

 לכל 
\begin_inset Formula $i\ne j$
\end_inset

, ויהיו 
\begin_inset Formula $b_{1},\ldots,b_{k}$
\end_inset

 מספרים שלמים כלשהם.
 אז למערכת המשוואות
\end_layout

\begin_layout Theorem
\begin_inset Formula 
\begin{align*}
x & \equiv_{n_{1}}b_{1}\\
 & \vdots\\
x & \equiv_{n_{k}}b_{k}
\end{align*}

\end_inset


\end_layout

\begin_layout Theorem
קיים פתרון והוא יחיד מודולו 
\begin_inset Formula $n=\prod_{i=1}^{k}n_{i}$
\end_inset

.
\end_layout

\begin_layout Proof
לכל 
\begin_inset Formula $1\le i\le n$
\end_inset

 נסמן 
\begin_inset Formula $a_{i}=\frac{n}{n_{i}}$
\end_inset

.
 בהכרח 
\begin_inset Formula $\left(a_{i},n_{i}\right)=1$
\end_inset

 כי אם 
\begin_inset Formula $p|a_{i}=\frac{n}{n_{i}}$
\end_inset

 אז בהכרח 
\begin_inset Formula $p|n_{j}$
\end_inset

 עבור 
\begin_inset Formula $j\ne i$
\end_inset

 ואז נקבל ש-
\begin_inset Formula $p$
\end_inset

 הוא גורם משותף של 
\begin_inset Formula $n_{i},n_{j}$
\end_inset

 בסתירה לכך ש-
\begin_inset Formula $\left(n_{i},n_{j}\right)=1$
\end_inset

.
\end_layout

\begin_layout Proof
מכיוון ש-
\begin_inset Formula $\left(a_{i},n_{i}\right)=1$
\end_inset

 קיים ל-
\begin_inset Formula $a_{i}$
\end_inset

 הופכי מודולו 
\begin_inset Formula $n_{i}$
\end_inset

 שנסמן 
\begin_inset Formula $a_{i}^{-1}$
\end_inset

.
 נגדיר 
\begin_inset Formula $d_{i}=a_{i}^{-1}a_{i}$
\end_inset

, אז מתקיים
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $d_{i}\equiv_{n_{i}}1$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $d_{i}\equiv_{n_{j}}0$
\end_inset

 לכל 
\begin_inset Formula $j\ne i$
\end_inset


\end_layout

\end_deeper
\begin_layout Proof
כאשר המשוואה השנייה נובעת מכך ש-
\begin_inset Formula $a_{i}=\frac{n}{n_{i}}$
\end_inset

 ובפרט 
\begin_inset Formula $n_{j}|a_{i}$
\end_inset

.
\end_layout

\begin_layout Proof
נגדיר כעת 
\begin_inset Formula $x=\sum_{i=1}^{n}b_{i}d_{i}$
\end_inset

, ונקבל לכל 
\begin_inset Formula $i$
\end_inset

 
\begin_inset Formula $x\equiv_{i}b_{i}$
\end_inset

, כמבוקש.
\end_layout

\begin_layout Proof
נותר להראות כי הפתרון הוא יחיד מודולו 
\begin_inset Formula $n$
\end_inset

.
 ראשית ניתן את הדעת לטענה הבאה: אם 
\begin_inset Formula $a,b$
\end_inset

 זרים, כלומר 
\begin_inset Formula $\text{gcd}\left(a,b\right)=1$
\end_inset

, אז 
\begin_inset Formula $\text{lcm}\left(a,b\right)=\frac{ab}{\text{gcd}\left(a,b\right)}=ab$
\end_inset

.
 כלומר, כל מספר שמתחלק ב-
\begin_inset Formula $a,b$
\end_inset

 זרים מתחלק גם במכפלתם ובאינדוקציה הדבר נובע לכל 
\begin_inset Formula $n$
\end_inset

 מספרים זרים.
\end_layout

\begin_layout Proof
נניח ש-
\begin_inset Formula $x_{1},x_{2}$
\end_inset

 שניהם פתרונות למערכת המשוואות.
 אז לכל 
\begin_inset Formula $i$
\end_inset

 מתקיים 
\begin_inset Formula $x_{1}\equiv_{n_{i}}x_{2}$
\end_inset

, כלומר, 
\begin_inset Formula $x_{1}-x_{2}$
\end_inset

 מתחלק על ידי 
\begin_inset Formula $n_{i}$
\end_inset

.
 מכיוון שהוא מתחלק על ידי מספרים זרים, הוא מתחלק גם על ידי מכפלתם, כלומר
 על ידי 
\begin_inset Formula $n$
\end_inset

, וקיבלנו 
\begin_inset Formula $x_{1}\equiv_{n}x_{2}$
\end_inset

.
\end_layout

\begin_layout Standard
ניתן לממש את האלגוריתם בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באופן הבא:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def crt(pairs):
\end_layout

\begin_layout Plain Layout

2      n = 1
\end_layout

\begin_layout Plain Layout

3      x = 0
\end_layout

\begin_layout Plain Layout

4      for (ni,bi) in pairs:
\end_layout

\begin_layout Plain Layout

5          n *= ni
\end_layout

\begin_layout Plain Layout

6      ds = []
\end_layout

\begin_layout Plain Layout

7      for (ni,bi) in pairs:
\end_layout

\begin_layout Plain Layout

8          ai = n // ni
\end_layout

\begin_layout Plain Layout

9          di = modular_inverse(ai, ni) * ai
\end_layout

\begin_layout Plain Layout

10         x = x + di*bi
\end_layout

\begin_layout Plain Layout

11     return x
\end_layout

\end_inset


\end_layout

\begin_layout Standard
מסקנה אחת ממשפט השאריות הסיני נוגעת למבנה של 
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

:
\end_layout

\begin_layout Theorem
אם 
\begin_inset Formula $\left(a,b\right)=1$
\end_inset

 אז 
\begin_inset Formula $\mathbb{Z}_{ab}\cong\mathbb{Z}_{a}\times\mathbb{Z}_{b}$
\end_inset

 וגם 
\begin_inset Formula $\mathbb{Z}_{ab}^{*}\cong\mathbb{Z}_{a}^{*}\times\mathbb{Z}_{b}^{*}$
\end_inset


\end_layout

\begin_layout Proof
נגדיר פונקציה 
\begin_inset Formula $\varphi:\mathbb{Z}_{ab}\to\mathbb{Z}_{a}\times\mathbb{Z}_{b}$
\end_inset

 על ידי 
\begin_inset Formula $\varphi\left(x\right)=\left(x\text{ mod }a,x\text{ mod }b\right)$
\end_inset

.
 הפונקציה היא על בגלל טענת ה
\series bold
קיום
\series default
 של משפט השאריות הסיני, והיא חח
\begin_inset Quotes erd
\end_inset

ע בגלל טענת 
\series bold
היחידות
\series default
 של משפט השאריות הסיני.
\end_layout

\begin_layout Proof
אותה פונקציה מראה ש-
\begin_inset Formula $\mathbb{Z}_{ab}^{*}\cong\mathbb{Z}_{a}^{*}\times\mathbb{Z}_{b}^{*}$
\end_inset

; רק יש להוסיף את האבחנה לפיה 
\begin_inset Formula $\left(x,ab\right)=1$
\end_inset

 אם ורק אם 
\begin_inset Formula $\left(x,a\right)=1$
\end_inset

 וגם 
\begin_inset Formula $\left(x,b\right)=1$
\end_inset

.
\end_layout

\begin_layout Subsubsection
פונקציית אוילר
\end_layout

\begin_layout Standard
נגדיר את 
\series bold
פונקציית אוילר
\series default
: 
\begin_inset Formula $\varphi\left(n\right)\triangleq\left|\mathbb{Z}_{n}^{*}\right|$
\end_inset

.
 כלומר, 
\begin_inset Formula $\varphi\left(n\right)$
\end_inset

 היא מספר המספרים הקטנים מ-
\begin_inset Formula $n$
\end_inset

 וזרים לו.
\end_layout

\begin_layout Standard
העניין המרכזי שלנו בפונקציית ינבע מאחת מתכונותיה:
\end_layout

\begin_layout Theorem
)משפט אוילר(: אם 
\begin_inset Formula $\left(a,n\right)=1$
\end_inset

 אז 
\begin_inset Formula $a^{\varphi\left(n\right)}\equiv_{n}1$
\end_inset

.
\end_layout

\begin_layout Standard
הוכחת המשפט מתבססת על משפט מרכזי בתורת החבורות האלמנטרית הנקרא 
\series bold
משפט לגראנז'
\series default
.
 לפיו, אם 
\begin_inset Formula $G$
\end_inset

 חבורה ו-
\begin_inset Formula $a\in G$
\end_inset

 אז 
\begin_inset Formula $a^{\left|G\right|}=e$
\end_inset

 כאשר 
\begin_inset Formula $e$
\end_inset

 הוא איבר היחידה של החבורה.
 לא נוכיח את משפט לגראנז' כאן.
 משפט אוילר נובע ממנו מיידית בזכות היות 
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

 חבורה.
\end_layout

\begin_layout Standard
בשל השימושיות של פונקציית אוילר, מעניין אותנו לחשב אותה.
 נפתח במספר אבחנות פשוטות:
\end_layout

\begin_layout Claim
לכל ראשוני 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula $\varphi\left(p\right)=p-1$
\end_inset

.
\end_layout

\begin_layout Proof
מכיוון ש-
\begin_inset Formula $p$
\end_inset

 ראשוני, לכל מספר 
\begin_inset Formula $a$
\end_inset

 כך ש-
\begin_inset Formula $\left(a,p\right)\ne1$
\end_inset

 חייב להתקיים 
\begin_inset Formula $\left(a,p\right)=p$
\end_inset

 )שכן אין עוד מחלקים של 
\begin_inset Formula $p$
\end_inset

(, כלומר בפרט 
\begin_inset Formula $p|a$
\end_inset

.
 לכן אם 
\begin_inset Formula $1\le a<p$
\end_inset

 בהכרח 
\begin_inset Formula $\left(a,p\right)=1$
\end_inset

 ולכן 
\begin_inset Formula $a\in\mathbb{Z}_{p}^{*}$
\end_inset

, כלומר 
\begin_inset Formula $\mathbb{Z}_{p}^{*}=\left\{ 1,2,3,\ldots,p-1\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
כאשר מסתכלים על משפט אוילר במקרה הפרטי של 
\begin_inset Formula $p$
\end_inset

 ראשוני, מקבלים את התוצאה 
\begin_inset Formula $a^{p-1}\equiv_{p}1$
\end_inset

.
 בשל חשיבותה ההיסטורית, התוצאה הזו זכתה לשם מיוחד - 
\series bold
המשפט הקטן של פרמה
\series default
.
\end_layout

\begin_layout Claim
לכל ראשוני 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula $\varphi\left(p^{n}\right)=p^{n-1}\left(p-1\right)$
\end_inset


\end_layout

\begin_layout Proof
באותו אופן כמו קודם, נסיר מהקבוצה 
\begin_inset Formula $\left\{ 1,2,3,\ldots,p^{n}\right\} $
\end_inset

 את כל הכפולות של 
\begin_inset Formula $p$
\end_inset

.
 הכפולות הללו נמצאות בהתאמה חח
\begin_inset Quotes erd
\end_inset

ע ועל עם הקבוצה 
\begin_inset Formula $\left\{ 1,2,3,\ldots,p^{n-1}\right\} $
\end_inset

 באופן הבא: 
\begin_inset Formula $n\mapsto p\cdot n$
\end_inset

.
 לכן מקבוצה מגודל 
\begin_inset Formula $p^{n}$
\end_inset

 הסרנו קבוצה מגודל 
\begin_inset Formula $p^{n-1}$
\end_inset

 וקיבלנו קבוצה מגודל 
\begin_inset Formula $p^{n}-p^{n-1}=p^{n-1}\left(p-1\right)$
\end_inset

.
\end_layout

\begin_layout Claim
אם 
\begin_inset Formula $\left(a,b\right)=1$
\end_inset

 אז 
\begin_inset Formula $\varphi\left(ab\right)=\varphi\left(a\right)\varphi\left(b\right)$
\end_inset

, כלומר 
\begin_inset Formula $\varphi$
\end_inset

 כפלית על מספרים זרים.
\end_layout

\begin_layout Proof
זו תוצאה מיידית ממשפט השאריות הסיני: 
\begin_inset Formula $\mathbb{Z}_{ab}^{*}=\mathbb{Z}_{a}^{*}\times\mathbb{Z}_{b}^{*}$
\end_inset

 ולכן 
\begin_inset Formula $\left|\mathbb{Z}_{ab}^{*}\right|=\left|\mathbb{Z}_{a}^{*}\right|\cdot\left|\mathbb{Z}_{b}^{*}\right|$
\end_inset

.
\end_layout

\begin_layout Standard
מתוצאות פשוטות אלו נובעת נוסחה כללית לחישוב 
\begin_inset Formula $\varphi$
\end_inset

.
 יהא 
\begin_inset Formula $n>1$
\end_inset

 ויהא 
\begin_inset Formula $n=p_{1}^{k_{1}}\cdots p_{n}^{k_{n}}$
\end_inset

 הפירוק לגורמים ראשוניים שלו.
 אז 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\varphi\left(n\right) & =\varphi\left(p_{1}^{k_{1}}\cdots p_{n}^{k_{n}}\right)\\
 & =\varphi\left(p_{1}^{k_{1}}\right)\cdots\varphi\left(p_{n}^{k_{n}}\right)\\
 & =p_{1}^{k_{1}-1}\left(p_{1}-1\right)\cdots p_{n}^{k_{n}-1}\left(p_{n}-1\right)\\
 & =p_{1}^{k_{1}}\left(1-\frac{1}{p_{1}}\right)\cdots p_{n}^{k_{n}}\left(1-\frac{1}{p_{n}}\right)\\
 & =p_{1}^{k_{1}}\cdots p_{n}^{k_{n}}\left(1-\frac{1}{p_{1}}\right)\cdots\left(1-\frac{1}{p_{n}}\right)\\
 & =n\prod_{p|n}\left(1-\frac{1}{p}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
כאשר המכפלה בסיום נלקחת על כל הגורמים הראשוניים של 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Standard
נוסחה זו נותנת דרך פשוטה לחשב את 
\begin_inset Formula $\varphi\left(n\right)$
\end_inset

 כאשר ידועים לנו כל הגורמים הראשוניים של 
\begin_inset Formula $n$
\end_inset

.
 לרוע המזל, איננו מכירים דרך יעילה למצוא את הגורמים הראשוניים הללו.
 למרבה המזל, אנחנו יודעים לנצל את חוסר הידע הזה לצורך מערכת ההצפנה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA
\lang hebrew
, שנראה בהמשך.
\end_layout

\begin_layout Subsection
בדיקת ראשוניות וייצור ראשוניים
\end_layout

\begin_layout Subsubsection
אלגוריתם מילר-רבין
\end_layout

\begin_layout Standard
ראינו כבר כי אלגוריתם בדיקת ראשוניות 
\begin_inset Quotes eld
\end_inset

עד השורש
\begin_inset Quotes erd
\end_inset

 הוא בלתי יעיל בצורה קיצונית.
 נשאלת השאלה מה 
\series bold
כן
\series default
 יעיל.
 לצורך כך נתחיל מאבחנה פשוטה לגבי מה 
\series bold
לא יכול
\series default
 להיות יעיל.
 כיום לא ידוע שום אלגוריתם יעיל עבור 
\series bold
פירוק לגורמים
\series default
 של מספר; במילים אחרות, לא מוכר אלגוריתם יעיל אשר בהינתן מספר 
\begin_inset Formula $n=ab$
\end_inset

 כך ש-
\begin_inset Formula $a,b>1$
\end_inset

 מוצא את 
\begin_inset Formula $a$
\end_inset

 או את 
\begin_inset Formula $b$
\end_inset

.
\end_layout

\begin_layout Standard
בהינתן שזה המצב, לא ייתכן שמבחן ראשוניות שמתבסס על מציאת פירוק של 
\begin_inset Formula $n$
\end_inset

 יהיה יעיל.
 על מבחן הראשוניות להכריע בצורה כלשהי לגבי הפריקות/אי הפריקות של 
\begin_inset Formula $n$
\end_inset

 בצורה 
\begin_inset Quotes eld
\end_inset

עיוורת
\begin_inset Quotes erd
\end_inset

.
 כיצד ניתן לעשות זאת?
\end_layout

\begin_layout Standard
התשובה היא שלראשוניים יש נטייה ליצור מבנים אלגבריים 
\begin_inset Quotes eld
\end_inset

יפים
\begin_inset Quotes erd
\end_inset

 בזמן שעבור מספרים פריקים חלק מהתכונות היפות משתבשות, ומספיק לאתר תכונה
 אחת שהשתבשה כדי להגיע למסקנה שהמספר שהמבנה יצר אינו ראשוני.
 המבנה האלגברי שעליו נתבסס הפעם הוא 
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

.
 ספציפית, נתבסס על שתי התכונות הבאות:
\end_layout

\begin_layout Itemize
המשפט הקטן של פרמה: עבור 
\begin_inset Formula $p$
\end_inset

 ראשוני, לכל 
\begin_inset Formula $a\in\mathbb{Z}_{p}^{*}$
\end_inset

 מתקיים 
\begin_inset Formula $a^{p-1}=1$
\end_inset

 )כשהחשבון הוא ב-
\begin_inset Formula $\mathbb{Z}_{p}^{*}$
\end_inset

(
\end_layout

\begin_layout Itemize
עבור 
\begin_inset Formula $p$
\end_inset

 ראשוני, 
\begin_inset Formula $\mathbb{Z}_{p}$
\end_inset

 הוא 
\series bold
שדה
\end_layout

\begin_layout Standard
התכונה הראשונה נותנת לנו מבחן בדיקת ראשוניות מיידי, שנקרא 
\series bold
מבחן פרמה
\series default
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

def fermat_primality_test(n):
\end_layout

\begin_layout Plain Layout

    a = random.randint(2,n-1)
\end_layout

\begin_layout Plain Layout

    if modular_power(a, n-1, n) != 1:
\end_layout

\begin_layout Plain Layout

        return False
\end_layout

\begin_layout Plain Layout

    return True
\end_layout

\end_inset


\end_layout

\begin_layout Standard
לרוע המזל, המבחן אינו אמין דיו לכשעצמו.
 זאת מכיוון שהמשפט הקטן של פרמה איננו 
\begin_inset Quotes eld
\end_inset

אם ורק אם
\begin_inset Quotes erd
\end_inset

; בהחלט ייתכן שעבור 
\begin_inset Formula $n$
\end_inset

 פריק יהיו קיימים ערכי 
\begin_inset Formula $a$
\end_inset

 כך ש-
\begin_inset Formula $a^{n-1}=1$
\end_inset

.
 גרוע מכך, יש מספרים פריקים שעבורם 
\series bold
לכל
\series default
 
\begin_inset Formula $a$
\end_inset

 שזר להם מתקיים 
\begin_inset Formula $a^{n-1}=1$
\end_inset

 - מספרים אלו מכונים 
\series bold
מספרי קרמייקל
\series default
 והקטן שבהם הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
561
\numeric off
.
 בגלל בעיות אלו מבחן פרמה אינו מספיק טוב לכשעצמו.
\end_layout

\begin_layout Standard
עם זאת, שינוי קטן באופן שבו מחושבת החזקה 
\begin_inset Formula $a^{n-1}$
\end_inset

 במהלך מבחן פרמה מאפשר לנו להוסיף 
\series bold
עוד
\series default
 בדיקה 
\begin_inset Quotes eld
\end_inset

על הדרך
\begin_inset Quotes erd
\end_inset

, והשילוב של הבדיקה של משפט פרמה והבדיקה הנוספת מאפשר לנו לזהות מספרים פריקים
 בהסתברות טובה: אם מספר הוא פריק, אז ההסתברות שלו 
\begin_inset Quotes eld
\end_inset

לרמות
\begin_inset Quotes erd
\end_inset

 ולעבור בהצלחה את המבחן היא 
\begin_inset Formula $\frac{1}{4}$
\end_inset

.
\end_layout

\begin_layout Standard
בהינתן 
\begin_inset Formula $n$
\end_inset

, ניתן לחשב במהירות את הפירוק 
\begin_inset Formula $n-1=2^{k}\cdot d$
\end_inset

 כאשר 
\begin_inset Formula $d$
\end_inset

 הוא אי זוגי - פשוט מחלקים את 
\begin_inset Formula $n-1$
\end_inset

 ב-
\begin_inset Formula $2$
\end_inset

 כל עוד לא קיבלנו מספר אי-זוגי.
 כעת ניתן לשנות את אופן חישוב 
\begin_inset Formula $a^{n-1}$
\end_inset

.
 ראשית כל מחשבים את 
\begin_inset Formula $a^{d}$
\end_inset

 בעזרת אלגוריתם ההעלאה בחזקה הרגיל.
 כעת מציבים 
\begin_inset Formula $x\leftarrow a^{d}$
\end_inset

 ובמהלך 
\begin_inset Formula $k$
\end_inset

 איטרציות מבצעים את הפעולה 
\begin_inset Formula $x\leftarrow x^{2}$
\end_inset

.
 כל העלאה בחזקה של 
\begin_inset Formula $x$
\end_inset

 משולה לכפל החזקה של 
\begin_inset Formula $a^{d}$
\end_inset

 ב-
\numeric on
2
\numeric off
, כך שלאחר 
\begin_inset Formula $k$
\end_inset

 צעדים נקבל בדיוק את 
\begin_inset Formula $a^{2^{k}d}=a^{n-1}$
\end_inset

 המבוקש.
 
\end_layout

\begin_layout Standard
מה שאנו מחפשים בשלב ההעלאה-בריבוע-המתמשכת הוא 
\series bold
שורש לא טריוויאלי של
\family roman
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\series default
\numeric off
.
 נסביר זאת: במספרים ממשיים, אנו יודעים שלמשוואה 
\begin_inset Formula $x^{2}=1$
\end_inset

 קיימים בדיוק שני פתרונות: 
\begin_inset Formula $x=\pm1$
\end_inset

.
 זה מקרה פרטי של טענה כללית יותר - מעל שדה, לפולינום ממעלה 
\begin_inset Formula $n$
\end_inset

 יש לכל היותר 
\begin_inset Formula $n$
\end_inset

 שורשים.
 כאשר 
\begin_inset Formula $p$
\end_inset

 הוא ראשוני, 
\begin_inset Formula $\mathbb{Z}_{p}$
\end_inset

 הוא שדה והפתרונות היחידים של המשוואה 
\begin_inset Formula $x^{2}=1$
\end_inset

 הם 
\begin_inset Formula $1,p-1$
\end_inset

 )כאן 
\begin_inset Formula $p-1$
\end_inset

 הוא שקול ל-
\begin_inset Formula $-1$
\end_inset

(.
 לעומת זאת, אם 
\begin_inset Formula $n$
\end_inset

 הוא פריק, אז 
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

 איננו שדה ובהחלט יכולים להיות פתרונות נוספים.
 כך למשל עבור 
\begin_inset Formula $\mathbb{Z}_{8}$
\end_inset

 מתקיים 
\begin_inset Formula $1^{2}=3^{2}=5^{2}=7^{2}=1$
\end_inset

, כך ש-
\begin_inset Formula $3,5$
\end_inset

 שניהם שורשים 
\begin_inset Quotes eld
\end_inset

לא טריוויאליים
\begin_inset Quotes erd
\end_inset

 של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
.
 
\end_layout

\begin_layout Standard
בהתאם לכך, כאשר האלגוריתם מבצע את החישוב 
\begin_inset Formula $x\leftarrow x^{2}$
\end_inset

, אם התוצאה שהתקבלה הייתה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אבל 
\begin_inset Formula $x$
\end_inset

 עצמו לא היה 
\begin_inset Formula $\pm1$
\end_inset

, ניתן לדעת מיידית ש-
\begin_inset Formula $n$
\end_inset

 הוא פריק ולעצור את ריצת האלגוריתם.
\end_layout

\begin_layout Standard
קיבלנו את האלגוריתם הבא:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def miller_rabin(n):
\end_layout

\begin_layout Plain Layout

2      a = random.randint(1,n-1)
\end_layout

\begin_layout Plain Layout

3      k = 0
\end_layout

\begin_layout Plain Layout

4      d = n-1
\end_layout

\begin_layout Plain Layout

5      while d % 2 == 0:
\end_layout

\begin_layout Plain Layout

6          k += 1
\end_layout

\begin_layout Plain Layout

7          d //= 2
\end_layout

\begin_layout Plain Layout

8      x = modular_power(a,d,n)
\end_layout

\begin_layout Plain Layout

9      for i in range(k):
\end_layout

\begin_layout Plain Layout

10         x_new = (x*x) % n
\end_layout

\begin_layout Plain Layout

11         if x != 1 and x != n-1 and x_new == 1:
\end_layout

\begin_layout Plain Layout

12             return False
\end_layout

\begin_layout Plain Layout

13         x = x_new
\end_layout

\begin_layout Plain Layout

14     if x != 1:
\end_layout

\begin_layout Plain Layout

15         return False
\end_layout

\begin_layout Plain Layout

16     return True
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
סיבוכיות ונכונות אלגוריתם מילר-רבין
\end_layout

\begin_layout Standard
סיבוכיות אלגוריתם מילר רבין זהה לסיבוכיות של העלאה בחזקה מודולרית.
 אנו נזקקים רק ל-
\begin_inset Formula $O\left(\lg n\right)$
\end_inset

 פעולות כפל ומציאת שארית מודולרית, כך שהאלגוריתם יעיל.
 השאלה המהותית יותר היא לגבי נכונותו.
\end_layout

\begin_layout Standard
ראשית, אם 
\begin_inset Formula $n$
\end_inset

 ראשוני, האלגוריתם עונה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
True
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בודאות; הדרך היחידה שבה האלגוריתם עונה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
False
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא אם המשפט הקטן של פרמה נכשל )שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
15
\numeric off
( או שהתגלה שורש לא טריוויאלי של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)שורה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
12
\numeric off
( ושני אלו לא יכולים לקרות עבור 
\begin_inset Formula $n$
\end_inset

 ראשוני.
\end_layout

\begin_layout Standard
נותר להוכיח שאם 
\begin_inset Formula $n$
\end_inset

 לא ראשוני, אז עבור כמות גדולה מספיק של 
\begin_inset Formula $a$
\end_inset

-ים ב-
\begin_inset Formula $\mathbb{Z}_{n}$
\end_inset

, האלגוריתם יחזיר
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
False
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Standard
נשים לב לדבר המדויק שאנו מוכיחים כאן: מטרתנו היא להוכיח ש
\series bold
לכל
\series default
 
\begin_inset Formula $n$
\end_inset

 פריק, קיימת הסתברות גדולה מספיק להחזיר
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
False
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עליו.
 תוצאה זו חזקה משמעותית מתוצאות כמו 
\begin_inset Quotes eld
\end_inset

עבור 
\begin_inset Formula $n$
\end_inset

 אקראי בהסתברות טובה האלגוריתם מחזיר עליו את התשובה הנכונה
\begin_inset Quotes erd
\end_inset

 שהן חסרות כל ערך )כי, למשל, אלגוריתם שמחזיר
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
False
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
על כל תוצאה אפשרית יענה את התשובה הנכונה בהסתברות טובה על כל קלט, כי רוב
 הקלטים האקראיים לא יהיו ראשוניים(.
\end_layout

\begin_layout Theorem
לכל 
\begin_inset Formula $n$
\end_inset

 פריק אי זוגי, מספר האיברים 
\begin_inset Formula $1\le a<n$
\end_inset

 שעליהם אלגוריתם מילר-רבין מחזיר
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
False
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא לכל היותר 
\begin_inset Formula $\frac{n-1}{2}$
\end_inset


\end_layout

\begin_layout Proof
ההוכחה שלנו תסתמך שוב על משפט לגראנז' מתורת החבורות, בניסוח הכללי יותר שלו:
 אם 
\begin_inset Formula $G$
\end_inset

 חבורה ו-
\begin_inset Formula $H$
\end_inset

 תת-חבורה של 
\begin_inset Formula $G$
\end_inset

, אז 
\begin_inset Formula $\left|H\right||\left|G\right|$
\end_inset

 )גודל 
\begin_inset Formula $H$
\end_inset

 מחלק את גודל 
\begin_inset Formula $G$
\end_inset

(.
 לא נזדקק למושג הכללי של חבורה ותת-חבורה; די לדבר על החבורה 
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

.
 
\series bold
תת-חבורה
\series default
 של 
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

 היא תת-קבוצה 
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

 שסגורה לפעולת הכפל )אם 
\begin_inset Formula $a,b\in H$
\end_inset

 אז גם 
\begin_inset Formula $ab\in H$
\end_inset

(.
\end_layout

\begin_layout Proof
ראשית, נניח ש-
\begin_inset Formula $n$
\end_inset

 אינו מספר קרמייקל, כלומר קיים 
\begin_inset Formula $1\le a<n$
\end_inset

 אחד לפחות כך ש-
\begin_inset Formula $a\in\mathbb{Z}_{n}^{*}$
\end_inset

 ש-
\begin_inset Formula $a^{n-1}\not\equiv_{n}1$
\end_inset

.
 נגדיר כעת תת-חבורה של 
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

 באופן הבא: 
\begin_inset Formula 
\begin{align*}
H & =\left\{ x\in\mathbb{Z}_{n}^{*}\ |\ x^{n-1}\equiv_{n}1\right\} 
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
מצד אחד 
\begin_inset Formula $H$
\end_inset

 אינה ריקה כי 
\begin_inset Formula $1\in H$
\end_inset

, ו-
\begin_inset Formula $H$
\end_inset

 סגורה לכפל )כי 
\begin_inset Formula $\left(xy\right)^{n-1}=x^{n-1}y^{n-1}\equiv_{n}1\cdot1=1$
\end_inset

( ולכן היא תת-חבורה של 
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

, ומצד שני 
\begin_inset Formula $H\ne\mathbb{Z}_{n}^{*}$
\end_inset

 כי 
\begin_inset Formula $a\notin H$
\end_inset

.
 ממשפט לגראנז' נסיק כעת כי 
\begin_inset Formula $\left|H\right|\le\frac{1}{2}\left|\mathbb{Z}_{n}^{*}\right|\le\frac{n-1}{2}$
\end_inset

.
\end_layout

\begin_layout Proof
בכך הראינו כי מבחן פרמה עובד טוב כמעט לכל המספרים; רק מספרי קרמייקל נותרו
 המקרה הבעייתי.
 עבור מקרה זה נגדיר את 
\begin_inset Formula $H$
\end_inset

 בצורה מעט מורכבת יותר, וגם ההוכחה שקיים איבר ב-
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

 שאינו שייך אליה תהיה מורכבת יותר.
\end_layout

\begin_layout Proof
כזכור, 
\begin_inset Formula $n-1=2^{k}d$
\end_inset

 כאשר 
\begin_inset Formula $d$
\end_inset

 אי זוגי.
 נתבונן כעת בקבוצת כל הזוגות 
\begin_inset Formula $\left(v,j\right)$
\end_inset

 כך ש-
\begin_inset Formula $v\in\mathbb{Z}_{n}^{*}$
\end_inset

 ו-
\begin_inset Formula $0\le j\le k$
\end_inset

 המקיימים 
\begin_inset Formula $v^{2^{j}d}\equiv_{n}-1$
\end_inset

.
 כלומר, אלו כל האיברים שהפעלת מילר-רבין עליהם תוביל ל-
\begin_inset Formula $-1$
\end_inset

, מה שיוביל לתשובה לא נכונה של האלגוריתם )כי 
\begin_inset Formula $n$
\end_inset

 מקיים את מבחן פרמה, ומ-
\begin_inset Formula $-1$
\end_inset

 מגיעים בצעד הבא אל 
\begin_inset Formula $1$
\end_inset

 מבלי לעבור דרך שורש לא טריוויאלי(.
\end_layout

\begin_layout Proof
זוג אחד מסוג זה בוודאי קיים: 
\begin_inset Formula $\left(n-1,0\right)$
\end_inset

, כי 
\begin_inset Formula $\left(n-1\right)^{2^{0}\cdot d}\equiv_{n}-1$
\end_inset

.
 לכן קיים 
\begin_inset Formula $j$
\end_inset

 מקסימלי שעבורו עדיין קיים זוג 
\begin_inset Formula $\left(v,j\right)$
\end_inset

 שכזה.
 כעת נגדיר את 
\begin_inset Formula $H$
\end_inset

:
\end_layout

\begin_layout Proof
\begin_inset Formula 
\begin{align*}
H & =\left\{ x\in\mathbb{Z}_{n}^{*}\ |\ x^{2^{j}d}\equiv_{n}\pm1\right\} 
\end{align*}

\end_inset


\end_layout

\begin_layout Proof
קל לראות ש-
\begin_inset Formula $H$
\end_inset

 סגורה לכפל והיא לא ריקה שכן 
\begin_inset Formula $v\in H$
\end_inset

 שייך אליה.
 מכאן שהיא תת-חבורה של 
\begin_inset Formula $\mathbb{Z}_{n}^{*}$
\end_inset

.
 על כן, אם נוכיח כי קיים איבר שאינו שייך ל-
\begin_inset Formula $H$
\end_inset

 אבל כל האיברים שעליהם האלגוריתם נכשל שייכים ל-
\begin_inset Formula $H$
\end_inset

, נסיים כמו קודם.
\end_layout

\begin_layout Proof
יהא 
\begin_inset Formula $a\in\mathbb{Z}_{n}^{*}$
\end_inset

 כלשהו שעליו האלגוריתם נכשל.
 נתבונן על 
\begin_inset Formula $a^{2^{j}d}$
\end_inset

.
 אם 
\begin_inset Formula $a^{2^{j}d}\equiv_{n}\pm1$
\end_inset

 אז 
\begin_inset Formula $a\in H$
\end_inset

 כמבוקש.
 אחרת, נתבונן בסדרה 
\begin_inset Formula $a^{2^{j}d},a^{2^{j+1}d},\ldots,a^{2^{k}d}$
\end_inset

.
 אנו יודעים כי:
\end_layout

\begin_deeper
\begin_layout Itemize
בסדרה זו 
\begin_inset Formula $-1$
\end_inset

 אינו מופיע כלל אחרת נקבל סתירה למקסימליות 
\begin_inset Formula $j$
\end_inset

.
\end_layout

\begin_layout Itemize
סדרה זו מסתיימת ב-
\begin_inset Formula $1$
\end_inset

 )כי 
\begin_inset Formula $n$
\end_inset

 הוא מספר קרמייקל, ולכן 
\begin_inset Formula $a^{n-1}\equiv_{1}n$
\end_inset

 לכל 
\begin_inset Formula $a\in\mathbb{Z}_{n}^{*}$
\end_inset

( אך אינה נפתחת ב-
\numeric on
1
\numeric off
.
\end_layout

\end_deeper
\begin_layout Proof
נתבונן במקום הראשון שבו מופיע
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בסדרה.
 האיבר במקום שלפניו אינו
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
או 
\begin_inset Formula $-1$
\end_inset

 ולכן הוא שורש לא טריוויאלי של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שהאלגוריתם היה אמור לאתר - מכאן שהאלגוריתם אינו נכשל על 
\begin_inset Formula $a$
\end_inset

, בסתירה להנחה שלנו; המסקנה היא שמתקיים 
\begin_inset Formula $a^{2^{j}d}\equiv_{n}\pm1$
\end_inset

 ולכן 
\begin_inset Formula $a\in H$
\end_inset

.
\end_layout

\begin_layout Proof
נותר האתגר של מציאת איבר 
\begin_inset Formula $a\in\mathbb{Z}_{n}^{*}$
\end_inset

 כך ש-
\begin_inset Formula $a\notin H$
\end_inset

.
 לצורך כך נסתמך על כך שמספר קרמייקל 
\begin_inset Formula $n$
\end_inset

 אינו חזקה 
\begin_inset Formula $p^{t}$
\end_inset

 של ראשוני; נוכיח זאת בהמשך.
 ניקח אם כן פירוק 
\begin_inset Formula $n=n_{1}n_{2}$
\end_inset

 כך ש-
\begin_inset Formula $\left(n_{1},n_{2}\right)=1$
\end_inset

.
 כזכור, מצאנו קודם איבר 
\begin_inset Formula $v$
\end_inset

 כך ש-
\begin_inset Formula $v^{2^{j}d}\equiv_{n}-1$
\end_inset

 ולכן בפרט גם מודולו 
\begin_inset Formula $n_{1}$
\end_inset

 נקבל 
\begin_inset Formula $v^{2^{j}d}\equiv_{n_{1}}-1$
\end_inset

.
 על פי משפט השאריות הסיני, קיים 
\begin_inset Formula $a$
\end_inset

 כך ש-
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $a\equiv_{n_{1}}v$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $a\equiv_{n_{2}}1$
\end_inset


\end_layout

\end_deeper
\begin_layout Proof
ולכן נקבל
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $a^{2^{j}d}\equiv_{n_{1}}-1$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $a^{2^{j}d}\equiv_{n_{2}}1$
\end_inset


\end_layout

\end_deeper
\begin_layout Proof
כעת, אם היה מתקיים 
\begin_inset Formula $a^{2^{j}d}\equiv_{n}1$
\end_inset

 בפרט היה נובע מכך 
\begin_inset Formula $a^{2^{j}d}\equiv_{n_{1}}1$
\end_inset

, בסתירה למשוואה הראשונה; ואם היה מתקיים 
\begin_inset Formula $a^{2^{j}d}\equiv_{n}-1$
\end_inset

 היה בפרט נובע מכך 
\begin_inset Formula $a^{2^{j}d}\equiv_{n_{2}}-1$
\end_inset

 בסתירה למשוואה השניה.
 המסקנה היא ש-
\begin_inset Formula $a^{2^{j}d}\not\equiv_{n}\pm1$
\end_inset

 ולכן 
\begin_inset Formula $a\notin H$
\end_inset

.
\end_layout

\begin_layout Proof
עדיין יש להראות כי 
\begin_inset Formula $a\in\mathbb{Z}_{n}^{*}$
\end_inset

.
 ראשית, מכיוון ש-
\begin_inset Formula $a\equiv_{n_{1}}v$
\end_inset

 ו-
\begin_inset Formula $v\in\mathbb{Z}_{n}^{*}$
\end_inset

 נקבל ש-
\begin_inset Formula $\left(a,n_{1}\right)=1$
\end_inset

 כי אם היה מחלק משותף ל-
\begin_inset Formula $a,n_{1}$
\end_inset

 הוא היה מחלק גם את 
\begin_inset Formula $v=a+n_{1}t$
\end_inset

 ולכן היה ל-
\begin_inset Formula $v,n$
\end_inset

 מחלק משותף.
 נימוק דומה עובד גם עבור 
\begin_inset Formula $n_{2}$
\end_inset

 כי 
\begin_inset Formula $\left(1,n_{2}\right)=1$
\end_inset

 ולכן נקבל 
\begin_inset Formula $\left(a,n_{2}\right)=1$
\end_inset

.
 מכאן ש-
\begin_inset Formula $\left(a,n\right)=1$
\end_inset

 כי כל מחלק משותף של 
\begin_inset Formula $a,n$
\end_inset

 מחלק או את 
\begin_inset Formula $n_{1}$
\end_inset

 או את 
\begin_inset Formula $n_{2}$
\end_inset

.
\end_layout

\begin_layout Proof
נותר רק להשלים את החוב שלנו לפיו מספר קרמייקל לא יכול להיות מהצורה 
\begin_inset Formula $p^{t}$
\end_inset

.
 נניח בשלילה ש-
\begin_inset Formula $n=p^{t}$
\end_inset

 כאשר 
\begin_inset Formula $p$
\end_inset

 אי זוגי.
 במקרה זה, אפשר להוכיח ש-
\begin_inset Formula $\mathbb{Z}_{p^{t}}^{*}$
\end_inset

 הוא חבורה ציקלית, כלומר כל איבריה הם חזקות של איבר נתון יחיד 
\begin_inset Formula $g$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $\left|\mathbb{Z}_{p^{t}}^{*}\right|=\varphi\left(p^{t}\right)=p^{t-1}\left(p-1\right)$
\end_inset

 אנו יודעים שהסדר של 
\begin_inset Formula $g$
\end_inset

 )המספר החיובי הקטן ביותר 
\begin_inset Formula $s$
\end_inset

 כך ש-
\begin_inset Formula $g^{s}=1$
\end_inset

( הוא 
\begin_inset Formula $p^{t-1}\left(p-1\right)$
\end_inset

.
 בנוסף לכך, מתקיים 
\begin_inset Formula $g^{n-1}=1$
\end_inset

 שכן 
\begin_inset Formula $n$
\end_inset

 הוא מספר קרמייקל.
\end_layout

\begin_layout Proof
נשתמש כעת במשפט מתורת החבורות שקובע שהסדר של איבר מחלק כל חזקה אחרת שלו
 שמחזירה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
, ונקבל:
\end_layout

\begin_layout Proof
\begin_inset Formula $p^{t-1}\left(p-1\right)|p^{t}-1$
\end_inset


\end_layout

\begin_layout Proof
אבל אם 
\begin_inset Formula $t>1$
\end_inset

 כמו במקרה שלנו, 
\begin_inset Formula $p$
\end_inset

 מחלק את אגף שמאל אבל לא את אגף ימין, מה שמוביל לסתירה.
 זה מסיים את ההוכחה.
\end_layout

\begin_layout Subsubsection
שימוש בפועל באלגוריתם מילר-רבין 
\end_layout

\begin_layout Standard
הוכחנו כי אלגוריתם מילר-רבין עונה נכון לכל ראשונית ולכל מספר אי זוגי שאינו
 ראשוני הוא עונה נכון בהסתברות 
\begin_inset Formula $\frac{1}{2}$
\end_inset

 .
 ניתן להוכיח תוצאות חזקות יותר אולם נסתפק במה שעשינו עד כה כדי לקבל אלגוריתם
 יעיל ואמין לבדיקת ראשוניות.
\end_layout

\begin_layout Standard
באופן כללי, ניתן לשפר את הסתברות ההצלחה של אלגוריתם הסתברותי על ידי מספר
 הרצות שלו.
 במקרה הנוכחי האלגוריתם הוא בעל טעות 
\begin_inset Quotes eld
\end_inset

חד-צדדית
\begin_inset Quotes erd
\end_inset

, מה שאומר שאם הוא החזיר תשובה שלילית )
\begin_inset Quotes erd
\end_inset

המספר פריק
\begin_inset Quotes erd
\end_inset

( ניתן בודאות להחזיר תשובה זו, ולכן ניתן לפעול כך: בהינתן קלט, לבצע מספר
 הפעלות של מילר-רבין עליו ולהחזיר תשובה חיובית רק אם בכל ההרצות הייתה תשובה
 חיובית.
 בצורה זו, ההסתברות לענות נכון על מספר ראשוני היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וההסתברות לענות נכון על מספר לא ראשוני היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
פחות הסתברות הכשלון.
 כדי להיכשל, הכרחי להיכשל בכל ההרצות, וההסתברות לכך היא 
\begin_inset Formula $\frac{1}{2^{t}}$
\end_inset

 כש-
\begin_inset Formula $t$
\end_inset

 הוא מספר ההרצות שבוצעו.
 לכן הסתברות ההצלחה היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Formula $1-\frac{1}{2^{t}}$
\end_inset

.
\end_layout

\begin_layout Standard
אופטימיזציה אחת שתמיד כדאי לנקוט בה היא בדיקה האם 
\begin_inset Formula $n$
\end_inset

 מתחלק בקבוצה כלשהי של ראשוניים קטנים - בדיקת חלוקה כזו אינה יקרה מבחינה
 חישובית ועשויה לחסוך הרצה יקרה יותר של מילר-רבין )ולכן גם אין צורך להטריח
 את עצמנו בשאלה מה קורה כשמריצים את אלגוריתם מילר-רבין על מספר זוגי(.
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def is_prime(n):
\end_layout

\begin_layout Plain Layout

2     for p in [2,3,5,7,11,13,17,19]:
\end_layout

\begin_layout Plain Layout

3         if n % p == 0:
\end_layout

\begin_layout Plain Layout

4             return False
\end_layout

\begin_layout Plain Layout

5     for _ in range(10):
\end_layout

\begin_layout Plain Layout

6         if not miller_rabin(n):
\end_layout

\begin_layout Plain Layout

7             return False
\end_layout

\begin_layout Plain Layout

8     return True
\end_layout

\end_inset


\end_layout

\begin_layout Standard
הקוד הוא דוגמא אקראית בלבד; על פי רוב נבדקת כמות גדולה בהרבה של ראשוניים
 קטנים, ואין צורך ב-
\numeric on
10
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 הרצות של מילר-רבין.
\end_layout

\begin_layout Subsubsection
מציאת ראשוניים גדולים
\end_layout

\begin_layout Standard
השימוש שאנו מייעדים למילר-רבין הוא מציאה של מספרים ראשוניים גדולים על מנת
 להשתמש בהם בבניית מערכת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA
\lang hebrew
.
 כאן 
\begin_inset Quotes eld
\end_inset

גדולים
\begin_inset Quotes erd
\end_inset

 פירושו 
\begin_inset Quotes eld
\end_inset

בני מאות ספרות
\begin_inset Quotes erd
\end_inset

.
 מילר-רבין יכול לבדוק ביעילות האם מספר בן מאות ספרות הוא ראשוני או לא, אך
 כיצד 
\series bold
לייצר
\series default
 מספרים כאלו? הדרך הפשוטה ביותר היא להגריל מספרים גדולים ולבדוק.
 כאן בא לעזרתנו 
\series bold
משפט המספרים הראשוניים
\series default
 שאומר שמספר הראשוניים בתחום 
\begin_inset Formula $\left\{ 1,2,,\ldots,n\right\} $
\end_inset

 הוא בערך 
\begin_inset Formula $\frac{n}{\ln n}$
\end_inset

, כלומר ההסתברות להגריל ראשוני אקראי מ-
\numeric on
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עד 
\begin_inset Formula $n$
\end_inset

 היא בערך 
\begin_inset Formula $\frac{1}{\ln n}$
\end_inset

 - בערך מסדר גודל של מספר הספרות של 
\begin_inset Formula $n$
\end_inset

.
 דהיינו, אם אנו מעוניינים להגריל ראשוני מסדר גודל של מאות ספרות, נצטרך לבדוק
 מאות מספרים בלבד - משימה קלה בסיוע מילר-רבין.
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1 def generate_prime(digits):
\end_layout

\begin_layout Plain Layout

2    for _ in range(10000):
\end_layout

\begin_layout Plain Layout

3        candidate = random.randrange(10**(digits-1), 10**digits)
\end_layout

\begin_layout Plain Layout

4        if is_prime(candidate):
\end_layout

\begin_layout Plain Layout

5            return candidate
\end_layout

\begin_layout Plain Layout

6    return None
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
מערכת ההצפנה
\family roman
\series bold
\shape up
\size large
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA
\end_layout

\begin_layout Subsubsection
מבוא למערכות הצפנה
\end_layout

\begin_layout Standard

\series bold
מערכת הצפנה
\series default
 באה לפתור את הבעיה הבאה: נניח שאליס ובוב חולקים ערוץ תקשורת כלשהו )האינטרנט,
 קו טלפון, יוני דואר, שליח, פרפרים, צעקות( ורוצים להעביר בו אינפורמציה בצורה
 מאובטחת, כך שגם במקרה שבו ערוץ התקשורת נופל קורבן למתקפה של גורם עוין המידע
 שאליס ובוב חולקים לא יגיע אל אותו גורם עוין.
 
\series bold
מערכת הצפנה
\series default
 באה לספק יכולת זו, לכל הפחות בצורה חלקית.
\end_layout

\begin_layout Standard
הסיטואציה הנפוצה ביותר היא זו שבה הגורם העוין, שנכנה 
\begin_inset Quotes eld
\end_inset

איב
\begin_inset Quotes erd
\end_inset

 יכולה אך ורק לצותת לערוץ התקשורת אך לא להשתלט עליו ולשנות בו דברים )כדי
 להתמודד עם הסיטואציה הבעייתית יותר צריך מערכות מורכבות יותר מאלו שנדבר
 עליהן(.
 הפתרון הוא 
\series bold
לשנות
\series default
 את המידע טרם שליחתו כך שייראה כמו ג'יבריש, אך שניתן יהיה לבצע תיקון של
 המידע לאחר שהתקבל בצד השני.
 כדי לבצע את 
\begin_inset Quotes eld
\end_inset

קלקול
\begin_inset Quotes erd
\end_inset

 ואת 
\begin_inset Quotes eld
\end_inset

תיקון
\begin_inset Quotes erd
\end_inset

 המידע מתבססים אליס ובוב על מידע סודי שידוע לשניהם - 
\series bold
מפתח ההצפנה
\series default
.
 היה עליהם לשתף את המפתח מראש, בערוץ תקשורת מאובטח )למשל, פגישה פיזית( אולם
 מרגע שיש להם מפתח משותף הם מסוגלים לשתף באמצעותו כמות גדולה של מידע )אבטחה
 
\begin_inset Quotes eld
\end_inset

מושלמת
\begin_inset Quotes erd
\end_inset

 ניתן להשיג רק כאשר המפתח הוא חד-פעמי וגודלו כגודל המידע שאותו רוצים לשתף,
 אולם בעזרת מפתח קטן מאוד אפשר להשיג אבטחה טובה מאוד לכמויות גדולות של מידע(.
\end_layout

\begin_layout Standard
פורמלית, אם לאליס יש הודעה 
\begin_inset Formula $M$
\end_inset

 שברצונה לשלוח )הודעה כזו נקראת 
\begin_inset Quotes eld
\end_inset

כתב גלוי
\begin_inset Quotes erd
\end_inset

,
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Plaintext
\lang hebrew
( היא קוראת לפונקציה 
\begin_inset Formula $\text{encrypt}$
\end_inset

 שמקבלת את ההודעה ואת המפתח הסודי 
\begin_inset Formula $K$
\end_inset

 ומוציאה 
\begin_inset Quotes eld
\end_inset

כתב סתר
\begin_inset Quotes erd
\end_inset

 )
\lang english
Ciphertext
\lang hebrew
( שנראה כמו ג'יבריש: 
\begin_inset Formula $C=\text{encrypt}\left(M,K\right)$
\end_inset

.
 את 
\begin_inset Formula $C$
\end_inset

 אליס שולחת לבוב, והוא משתמש בפונקציה משלו, 
\begin_inset Formula $M=\text{decrypt}\left(C,K\right)$
\end_inset

.
 אם איב מצותת להתרחשות הזו היא מקבלת את 
\begin_inset Formula $C$
\end_inset

 אך לא את 
\begin_inset Formula $M$
\end_inset

, ואם שיטת ההצפנה טובה דיה, איב לא תוכל לשחזר את 
\begin_inset Formula $C$
\end_inset

 מתוך 
\begin_inset Formula $M$
\end_inset

 בהינתן היכולות החישוביות המוגבלות שלה.
\end_layout

\begin_layout Standard
החיסרון במערכת הצפנה שכזו ברור - על אליס ובוב לשתף את המפתח 
\begin_inset Formula $K$
\end_inset

 ביניהם מראש, או להשתמש בערוץ מאובטח לצורך השיתוף שלו.
 למרות הקושי המהותי הזה, מערכות הצפנה היו בשימוש נרחב לאורך מרבית ההיסטוריה.
\end_layout

\begin_layout Standard
בשנות ה-
\numeric on
70
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של המאה ה-
\numeric on
20
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוצעה גישה נוספת להצפנה, שמצליחה להתמודד עם בעיית שיתוף המפתחות - גישת 
\series bold
המפתח הפומבי
\series default
.
 בגישה זו אליס ובוב אינם זקוקים למפתח משותף על מנת לקיים תקשורת מאובטחת.
 נניח שהסיטואציה היא זו שבה אליס רוצה ליזום את התקשורת עם בוב.
 כדי לאפשר זאת, בוב משתמש בשיטת הצפנה שכוללת 
\series bold
שני
\series default
 מפתחות שונים, 
\begin_inset Formula $K_{public}$
\end_inset

 ו-
\begin_inset Formula $K_{private}$
\end_inset

.
 את המפתח הפומבי 
\begin_inset Formula $K_{public}$
\end_inset

 הוא מפרסם לכלל העולם, ואילו את המפתח הפרטי 
\begin_inset Formula $K_{private}$
\end_inset

 הוא שומר בסוד אך ורק לעצמו.
\end_layout

\begin_layout Standard
כאשר אליס רוצה להצפין הודעה 
\begin_inset Formula $M$
\end_inset

 ולשלוח לבוב, היא משתמשת בפונקציה 
\begin_inset Formula $C=\text{encrypt}\left(M,K_{public}\right)$
\end_inset

.
 התוצאה היא כתב סתר 
\begin_inset Formula $C$
\end_inset

 שגם אליס עצמה אינה יודעת איך לפענח )אם למשל היא שכחה את 
\begin_inset Formula $M$
\end_inset

 פתאום(.
 אליס שולחת את 
\begin_inset Formula $C$
\end_inset

 אל בוב, שמפענח אותו באמצעות פונקציה 
\begin_inset Formula $M=\text{decrypt}\left(C,K_{private}\right)$
\end_inset

 שמתבססת על המפתח הפרטי שלו.
\end_layout

\begin_layout Standard
ניתן לחשוב על הסיטואציה באופן ציורי כך:
\end_layout

\begin_layout Standard
בהצפנה 
\begin_inset Quotes eld
\end_inset

רגילה
\begin_inset Quotes erd
\end_inset

, יש לאליס ובוב מנעולים שננעלים ונפתחים באמצעות אותו מפתח כך שלאליס יש עותק
 אחד של המפתח ולבוב עותק אחר.
 כאשר אליס רוצה לשלוח לבוב הודעה היא שמה אותה בקופסה, ומשתמשת במפתח שלה
 כדי לנעול את הקופסה באמצעות המנעול שמשותף לה ולבוב.
 הקופסה עוברת מאליס אל בוב ואיב לא מסוגלת לפתוח אותה מכיוון שאין לה את המפתח;
 כשהיא מגיעה אל בוב, הוא פותח אותה עם המפתח שבצד שלו.
\end_layout

\begin_layout Standard
לעומת זאת, בהצפנה פומבית בוב דואג מבעוד מועד לשים בכיכר העיר קופסה שמלאה
 בעותקים זהים של מנעול קפיצי.
 אליס לוקחת לעצמה אחד מהמנעולים ומשתמשת בו כדי לנעול את הקופסה; מרגע זה
 ואילך היא אינה יכולה לפתוח את הקופסה בעצמה.
 היא שולחת אותה אל בוב, שפותח אותה בעזרת המפתח הפרטי שלו.
 בתיאור זה, המפתח הפומבי הוא למעשה המנעול עצמו.
\end_layout

\begin_layout Standard
על פי רוב השימוש של הצפנת מפתח פומבי היא ביצירת קשר ראשוני בין שני הצדדים
 וניהול פרוטוקול שבסופו מיוצר מפתח הצפנה אקראי ששני הצדדים מחזיקים, ומרגע
 זה ואילך התקשורת נמשכת באמצעות שיטת הצפנה רגילה, מהירה יותר.
 לכאורה בזאת נפתרה בעיית שיתוף המפתחות של המערכות הקלאסיות, אך בפועל עדיין
 קיימים היבטים נוספים שיש להתייחס אליהם )אם בוב שם ארגז מלא מנועלים בכיכר
 העיר מה מונע מאיב להכניס פנימה מנעול משל עצמה ולפתוח את הקופסה שאליס שולחת?(
 אך לא ניכנס אליהם - ואל הפתרונות הקיימים אליהם - כאן, אלא נסתפק בהצגת מערכת
 הצפנה באמצעות מפתח ציבורי.
\end_layout

\begin_layout Subsubsection
שיטת ההצפנה
\family roman
\series bold
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA
\end_layout

\begin_layout Standard
הרעיון בשיטת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא ביצוע הצפנה ופענוח באמצעות העלאה בחזקה מודולרית.
 המודולוס 
\begin_inset Formula $N$
\end_inset

 והחזקה 
\begin_inset Formula $e$
\end_inset

 שבה מעלים על מנת להצפין נבחרים באקראי ומתפרסמים בפומבי; החזקה 
\begin_inset Formula $d$
\end_inset

 שבה יש להעלות כדי לפענח הודעה מוצפנת ניתנת לחישוב מתוך 
\begin_inset Formula $e,\varphi\left(N\right)$
\end_inset

.
 בטיחות מערכת ההצפנה מסתמכת, אם כן, על שני דברים:
\end_layout

\begin_layout Itemize
הקושי של היפוך פעולת ההעלאה בחזקה מודולרית.
\end_layout

\begin_layout Itemize
הקושי של חישוב 
\begin_inset Formula $\varphi\left(N\right)$
\end_inset

 מתוך 
\begin_inset Formula $N$
\end_inset

.
\end_layout

\begin_layout Standard
נעסוק בהמשך בפירוט רחב יותר בהנחות אלו.
\end_layout

\begin_layout Standard
ראינו כבר כי חישוב 
\begin_inset Formula $\varphi\left(N\right)$
\end_inset

 הוא משימה קלה אם ידועים הגורמים הראשוניים של 
\begin_inset Formula $N$
\end_inset

.
 בפרט, במקרה הפשוט שבו 
\begin_inset Formula $N$
\end_inset

 הוא מכפלה של זוג ראשוניים 
\begin_inset Formula $N=pq$
\end_inset

 הרי ש-
\begin_inset Formula $\varphi\left(N\right)=\left(p-1\right)\left(q-1\right)$
\end_inset

.
 על כן, היתרון של בוב על פני יתר העולם יהיה שהוא יבנה את 
\begin_inset Formula $N$
\end_inset

 באופן הבא: יגריל 
\begin_inset Formula $p,q$
\end_inset

 ראשוניים ויחשב מתוכם את 
\begin_inset Formula $N=pq$
\end_inset

.
 את 
\begin_inset Formula $e$
\end_inset

 הוא יכול להגריל באופן כמעט חופשי.
 לאחר מכן הוא ישתמש בהיכרות שלו עם 
\begin_inset Formula $p,q$
\end_inset

 על מנת למצוא 
\begin_inset Formula $d$
\end_inset

 שהופך את פעולת ההצפנה; לאחר מכן די לו לשמור את 
\begin_inset Formula $d$
\end_inset

 אצלו ואין לו צורך שמור את 
\begin_inset Formula $p,q$
\end_inset

 )אבל אסור לגלות אותם לעולם!(.
\end_layout

\begin_layout Standard
אם כן, בהינתן 
\begin_inset Formula $N,e,d$
\end_inset

, מערכת ההצפנה כוללת את הפונקציות הבאות:
\end_layout

\begin_layout Itemize

\series bold
הצפנה
\series default
: 
\begin_inset Formula $\text{encrypt}\left(M,\left(e,N\right)\right)=M^{e}\text{ mod }N$
\end_inset


\end_layout

\begin_layout Itemize

\series bold
פענוח
\series default
: 
\begin_inset Formula $\text{decrypt}\left(C,\left(d,N\right)\right)=C^{d}\text{ mod }N$
\end_inset


\end_layout

\begin_layout Standard
כיצד על 
\begin_inset Formula $d$
\end_inset

 להיבחר כדי שיתקיים 
\begin_inset Formula $\text{decrypt}\left(\text{encrypt}\left(M,\left(e,N\right)\right),\left(d,N\right)\right)=M$
\end_inset

?
\end_layout

\begin_layout Standard
אנו מעוניינים שתתקיים המשוואה הבאה: 
\begin_inset Formula $\left(M^{e}\right)^{d}\equiv_{N}M$
\end_inset

, כלומר 
\begin_inset Formula $M^{ed-1}\equiv_{N}1$
\end_inset

.
 על פי משפט אוילר, 
\begin_inset Formula $M^{\varphi\left(N\right)}\equiv_{N}1$
\end_inset

, ולכן אם 
\begin_inset Formula $\varphi\left(N\right)|ed-1$
\end_inset

, נקבל 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
M^{ed-1} & =M^{k\varphi\left(N\right)}\\
 & =\left(M^{\varphi\left(N\right)}\right)^{k}\\
 & \equiv_{N}1^{k}=1
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
על מנת שיתקיים 
\begin_inset Formula $\varphi\left(N\right)|ed-1$
\end_inset

 צריך שיתקיים 
\begin_inset Formula $ed\equiv_{\varphi\left(N\right)}1$
\end_inset

, דהיינו 
\begin_inset Formula $d$
\end_inset

 נבחר להיות ההופכי המודולרי של 
\begin_inset Formula $e$
\end_inset

 מודולו 
\begin_inset Formula $\varphi\left(N\right)$
\end_inset

.
\end_layout

\begin_layout Standard
את בניית מערכת ההצפנה ופונקציות ההצפנה והפענוח )הזהות( אפשר לכתוב כך בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\lang hebrew
:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

1  def generate_rsa_cryptosystem(digits):
\end_layout

\begin_layout Plain Layout

2      p = generate_prime(digits // 2)
\end_layout

\begin_layout Plain Layout

3      q = generate_prime(digits // 2)
\end_layout

\begin_layout Plain Layout

4      N = p*q
\end_layout

\begin_layout Plain Layout

5      for _ in range(10):
\end_layout

\begin_layout Plain Layout

6          e = random.randrange(2,N-1)
\end_layout

\begin_layout Plain Layout

7          d = modular_inverse(e, (p-1)*(q-1))
\end_layout

\begin_layout Plain Layout

8          if d is not None:
\end_layout

\begin_layout Plain Layout

9              return ((N,e),(N,d))
\end_layout

\begin_layout Plain Layout

10     return None
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

1 def rsa_encrypt(M, public_key):
\end_layout

\begin_layout Plain Layout

2     N,e = public_key
\end_layout

\begin_layout Plain Layout

3     return modular_power(M, e, N)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

1 def rsa_decrypt(C, private_key):
\end_layout

\begin_layout Plain Layout

2     N,d = private_key
\end_layout

\begin_layout Plain Layout

3     return modular_power(C, d, N)
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
שיטת
\family roman
\series bold
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA-CRT
\end_layout

\begin_layout Standard
שיטת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA-CRT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באה לשפר את זמני הפענוח של הודעת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מוצפנת בערך פי
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
4
\numeric off
, ובכך לסייע להגדלת הקיבולת של מערכות שצריכות להתמודד עם כמות גדולה של פענוחים
 בו זמנית.
 למשל: חנות אלקטרונית שמאות אלפי לקוחות מנסים להתחבר אליה בו זמנית; כל לקוח
 יכול להרשות לעצמו זמן חישוב גדול של הצפנת ה-
\lang english
RSA
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שאיתה הוא יוזם את הפניה לחנות, אבל החנות עצמה צריכה להתמודד עם כמות גדולה
 של פניות בבת אחת ולכן זקוקה לפענוח מהיר.
\end_layout

\begin_layout Standard
בשיטת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
RSA-CRT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בניית מערכת ההצפנה מתחילה באופן הרגיל:
\end_layout

\begin_layout Enumerate
הגרילו שני מספרים ראשוניים גדולים דיו 
\begin_inset Formula $p,q$
\end_inset

.
\end_layout

\begin_layout Enumerate
חשבו 
\begin_inset Formula $N=pq$
\end_inset


\end_layout

\begin_layout Enumerate
הגרילו 
\begin_inset Formula $e\in\mathbb{Z}_{N}^{*}$
\end_inset

.
\end_layout

\begin_layout Enumerate
חשבו 
\begin_inset Formula $d\in\mathbb{Z}_{N}^{*}$
\end_inset

 כך ש-
\begin_inset Formula $ed\equiv_{\varphi\left(N\right)}1$
\end_inset

.
\end_layout

\begin_layout Standard
ב-
\lang english
RSA
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
רגיל, בשלב זה 
\begin_inset Formula $p,q$
\end_inset

 
\begin_inset Quotes eld
\end_inset

ייזרקו לפח
\begin_inset Quotes erd
\end_inset

 אולם ב-
\lang english
RSA-CRT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אנו שומרים אותם, ובנוסף לכך מחשבים:
\end_layout

\begin_layout Standard
\begin_inset Formula $d_{p}=d\ \text{mod}\left(p-1\right)$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $d_{q}\equiv d\ \text{mod}\left(q-1\right)$
\end_inset


\end_layout

\begin_layout Standard
המפתח הפומבי יהיה כמקודם 
\begin_inset Formula $\left(N,e\right)$
\end_inset

 ואילו המפתח הפרטי יהיה 
\begin_inset Formula $\left(p,q,d_{p},d_{q}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
הצפנה מבוצעת כמקודם: 
\begin_inset Formula $\text{encrypt}\left(M,\left(e,N\right)\right)=M^{e}\text{ mod }N$
\end_inset

.
\end_layout

\begin_layout Standard
פענוח מתבצע באופן הבא.
 ראשית מחשבים:
\end_layout

\begin_layout Standard
\begin_inset Formula $M_{p}=C^{d_{p}}\text{ mod }p$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $M_{q}=C^{d_{q}}\text{ mod }q$
\end_inset


\end_layout

\begin_layout Standard
כעת משתמשים במשפט השאריות הסיני כדי למצוא את ה-
\begin_inset Formula $M$
\end_inset

 היחיד מודולו 
\begin_inset Formula $N=pq$
\end_inset

 המקיים:
\end_layout

\begin_layout Standard
\begin_inset Formula $M\equiv_{p}M_{p}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $M\equiv_{q}M_{q}$
\end_inset


\end_layout

\begin_layout Standard
עלינו להראות כי בצורה זו הפענוח משחזר את ההודעה המקורית.
 נניח אם כן כי 
\begin_inset Formula $C=M^{e}\text{ mod }N$
\end_inset

.
 אז בפרט מתקיים
\end_layout

\begin_layout Standard
\begin_inset Formula $M_{p}\equiv_{p}M^{ed_{p}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $M_{q}\equiv_{q}M^{ed_{q}}$
\end_inset


\end_layout

\begin_layout Standard
כעת נוכיח כי 
\begin_inset Formula $M\equiv_{p}M^{ed_{p}}$
\end_inset

: לשם כך די להראות כי 
\begin_inset Formula $M^{ed_{p}-1}\equiv_{p}1$
\end_inset

.
 מכיוון ש-
\begin_inset Formula $M^{\varphi\left(p\right)}\equiv_{p}1$
\end_inset

, די להראות כי 
\begin_inset Formula $\varphi\left(p\right)|ed_{p}-1$
\end_inset

, כלומר ש-
\begin_inset Formula $ed_{p}\equiv_{\varphi\left(p\right)}1$
\end_inset

.
\end_layout

\begin_layout Standard
כזכור, 
\begin_inset Formula $\varphi\left(p\right)=p-1$
\end_inset

.
\end_layout

\begin_layout Standard
כמו כן 
\begin_inset Formula $d_{p}\equiv_{p-1}d$
\end_inset

 ו-
\begin_inset Formula $ed\equiv_{\varphi\left(n\right)}1$
\end_inset

, כלומר בפרט 
\begin_inset Formula $ed\equiv_{p-1}1$
\end_inset


\end_layout

\begin_layout Standard
מכל אלו נסיק: 
\begin_inset Formula $ed_{p}\equiv_{p-1}ed\equiv_{p-1}1$
\end_inset

 כנדרש.
\end_layout

\begin_layout Standard
באותו האופן ניתן להראות כי 
\begin_inset Formula $M\equiv_{q}M_{q}$
\end_inset

.
 משני אלו נובע ש-
\begin_inset Formula $M$
\end_inset

 הוא אכן פתרון של מערכת המשוואות
\end_layout

\begin_layout Standard
\begin_inset Formula $x\equiv_{p}M_{p}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $x\equiv_{q}M_{q}$
\end_inset


\end_layout

\begin_layout Standard
ומכיוון שהפתרון הוא יחיד מודולו 
\begin_inset Formula $N$
\end_inset

, אז החישוב שאנו מבצעים באמצעות משפט השאריות הסיני אכן מחזיר את 
\begin_inset Formula $M$
\end_inset

.
\end_layout

\begin_layout Section
מבוא לתורת הסיבוכיות
\end_layout

\begin_layout Subsection
המחלקות
\family roman
\series bold
\shape up
\size large
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
P
\family roman
\series bold
\shape up
\size large
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\lang english
NP
\end_layout

\begin_layout Standard

\series bold
תורת הסיבוכיות
\series default
 עוסקת במודלים חישוביים שונים ומשונים ובכוחם החישובי - בבעיות שהם יכולים
 לפתור ואלו שאינם יכולים לפתור.
 מכיוון שבתחום זה עדיין רב הנסתר על הגלוי, לעתים קרובות תוצאות בתורת הסיבוכיות
 הן יחסיות: למשל, הוכחה ששני מודלים חישוביים שונים הם שקולים בכוחם, או הוכחה
 שאם בעיה מסויימת ניתנת לפתרון במודל חישובי מסויים אז הדבר מוכיח את השקילות
 של מודלים אחרים, וכדומה.
\end_layout

\begin_layout Standard
על מנת להגדיר מודל חישובי קונקרטי יש לתת הגדרה מתמטית מדויקת, ולצורך כך
 נעזרים לעתים קרובות במודל שנקרא 
\series bold
מכונת טיורינג
\series default
 אך לא נציג כאן בצורה מפורשת.
 עבור מה שנעשה כאן די לחשוב על שפת תכנות קונקרטית, דוגמת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\lang hebrew
, כמגדירה מודל חישובי, כך שכל תוכנית מחשב בשפה זו שייכת למודל החישובי.
 בפועל כל תוכנית בשפת פייתון ניתנת למימוש גם באמצעות מכונת טיורינג, כאשר
 ה
\begin_inset Quotes erd
\end_inset

מחיר
\begin_inset Quotes erd
\end_inset

 הוא שעל כל פקודה בשפת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Python
\lang hebrew
, כמות הצעדים שמכונת הטיורינג תזדקק לה כדי לממש פקודה זו הוא 
\series bold
פולינומי
\series default
 בגודל הקלט של המכונה.
\end_layout

\begin_layout Standard
נגדיר במדויק מושג זה:
\end_layout

\begin_layout Definition
נאמר שחישוב כלשהו מתבצע 
\series bold
בזמן פולינומי
\series default
 אם הוא מתבצע בסיבוכיות זמן 
\begin_inset Formula $O\left(n^{k}\right)$
\end_inset

 עבור 
\begin_inset Formula $k\ge0$
\end_inset

 קבוע כלשהו.
\end_layout

\begin_layout Standard
לחישובים פולינומיים יש את התכונה המועילה ש
\series bold
הרכבה
\series default
 שלהם היא פולינומית; חישוב שמתבצע בזמן פולינומי יכול להוציא פלט שהוא לכל
 היותר פולינומי בגודל הקלט המקורי, ואם פלט זה מועבר לחישוב פולינומי שני
 גודל הפלט שהחישוב השני ייתן יהיה פולינומי בגודל הקלט המקורי.
 תכונה זו עומדת בבסיס הבחירה להגדיר 
\series bold
חישוב יעיל
\series default
 בתור חישוב פולינומי, אף שלכאורה זו הגדרה רחבה 
\series bold
מדי
\series default
 שכן יש חישובים פולינומיים שכלל לא נראים לנו יעילים )למשל אלגוריתם שדורש
 
\begin_inset Formula $n^{10000}$
\end_inset

 צעדים(.
 האינטואיציה היא שהמטרה המרכזית שלנו בתורת הסיבוכיות היא לאפיין בעיות ש
\series bold
אין להן פתרון יעיל
\series default
.
 בפרט אי-קיום של אלגוריתם פולינומי יגרור אי-קיום של פתרון יעיל )תחת הסתייגויות
 שנתייחס אליהן בהמשך(.
\end_layout

\begin_layout Standard
רוב הבעיות האלגוריתמיות מנוסחת בתור 
\series bold
בעיות חיפוש
\series default
: בהינתן קלט, למצוא פלט המותאם לקלט זה ומקיים 
\series bold
אילוצים
\series default
 מסויימים.
 למשל: מציאת התמורה הממיינת של סדרה; מציאת מסלול קל ביותר בין שני צמתים
 בגרף; מציאת זרימת מקסימום בגרף.
 לפעמים הפלט האפשרי הוא יחיד ולעתים יש כמה פלטים אפשריים.
 לבעיות אלו קוראים 
\series bold
בעיות חיפוש
\series default
 שכן אנו 
\begin_inset Quotes eld
\end_inset

מחפשים
\begin_inset Quotes erd
\end_inset

 במרחב הפלטים האפשריים )למשל, מרחב התמורות האפשריות של סדרה( את זה שעונה
 על התנאים הדרושים לנו )למשל, שהסדרה אחרי הפעלת התמורה תהיה ממויינת(.
\end_layout

\begin_layout Standard
סוג נוסף של בעיות אלגוריתמיות הוא 
\series bold
בעיות הכרעה
\series default
.
 בהינתן קלט כלשהו, התשובה היא 
\begin_inset Quotes eld
\end_inset

כן/לא
\begin_inset Quotes erd
\end_inset

 בלבד, בהתאם לשאלה האם הקלט עונה לקריטריונים מסויימים.
 למשל, האם גרף מסויים הוא קשיר; האם רשימה היא ממויינת; האם קיים מסלול מאורך
 לכל היותר
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
7
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 בין זוג צמתים נתונים בגרף, וכדומה.
\end_layout

\begin_layout Standard
בגלל הפשטות היחסית של הפלט בבעיות הכרעה, הגדרות רבות בתורת הסיבוכיות עוסקות
 בהן.
 ההרחבה לבעיות חיפוש ולחישובי פונקציות באופן כללי היא לרוב פשוטה יחסית אחרי
 שמחלקות הסיבוכיות הרלוונטיות הוגדרו.
\end_layout

\begin_layout Standard
עבור בעיות הכרעה, נהוג להשתמש בטרמינולוגיה של 
\series bold
שפה
\series default
: שפה 
\begin_inset Formula $L$
\end_inset

 היא אוסף של מילים, כאשר כל מילה היא סדרה סופית של איברים מתוך קבוצה סופית
 
\begin_inset Formula $\Sigma$
\end_inset

 שמכונה 
\series bold
אלפבית
\series default
.
 כל האובייקטים שאנו עוסקים בהם בדרך כלל במסגרת אלגוריתם כלשהו ניתנים לקידוד
 באמצעות סדרות בינאריות של תווים, כך שהטרמינולוגיה לא מגבילה אותנו.
\end_layout

\begin_layout Standard
ב-
\begin_inset Formula $\Sigma^{*}$
\end_inset

 נסמן את אוסף כל המילים מעל 
\begin_inset Formula $\Sigma$
\end_inset

, כלומר אוסף הסדרות הסופיות עם איברים מתוך 
\begin_inset Formula $\Sigma$
\end_inset

.
 כעת נוכל להגדיר פורמלית בעיית הכרעה:
\end_layout

\begin_layout Definition
בהינתן שפה 
\begin_inset Formula $L$
\end_inset

, 
\series bold
בעיית ההכרעה
\series default
 שמוגדרת על ידי 
\begin_inset Formula $L$
\end_inset

 היא הבעיה הבאה: בהינתן מילה 
\begin_inset Formula $w\in\Sigma^{*}$
\end_inset

, יש לקבוע האם 
\begin_inset Formula $w\in L$
\end_inset

 או 
\begin_inset Formula $w\notin L$
\end_inset

.
 נאמר שאלגוריתם 
\begin_inset Formula $A$
\end_inset

 
\series bold
מקבל
\series default
 מילה 
\begin_inset Formula $w$
\end_inset

 אם 
\begin_inset Formula $A$
\end_inset

 מסיים את ריצתו על 
\begin_inset Formula $w$
\end_inset

 עם החזרת הפלט 
\begin_inset Quotes eld
\end_inset

כן
\begin_inset Quotes erd
\end_inset

, ונאמר ש-
\begin_inset Formula $A$
\end_inset

 
\series bold
דוחה
\series default
 מילה 
\begin_inset Formula $w$
\end_inset

 אם הוא מסיים את ריצתו עליה עם הפלט 
\begin_inset Quotes eld
\end_inset

לא
\begin_inset Quotes erd
\end_inset

.
 נאמר ש-
\begin_inset Formula $A$
\end_inset

 
\series bold
מכריע
\series default
 את השפה 
\begin_inset Formula $L$
\end_inset

 אם לכל 
\begin_inset Formula $w\in L$
\end_inset

, 
\begin_inset Formula $A$
\end_inset

 מקבל את 
\begin_inset Formula $w$
\end_inset

, ולכל 
\begin_inset Formula $w\notin L$
\end_inset

, 
\begin_inset Formula $A$
\end_inset

 דוחה את 
\begin_inset Formula $w$
\end_inset

.
\end_layout

\begin_layout Standard
כדוגמא פשוטה, אפשר לחשוב על 
\begin_inset Formula $L$
\end_inset

 בתור שפת כל הסדרות הממויינות של מספרים טבעיים, כאשר איבר לדוגמא בשפה זו
 הוא המילה 
\begin_inset Formula $\left[2,5,17\right]$
\end_inset

 )הסוגריים המרובעים והפסיקים הם חלק מהאלפבית במקרה זה(.
 בדיקת שייכות ל-
\begin_inset Formula $L$
\end_inset

 היא פשוטה: בהינתן 
\begin_inset Formula $w$
\end_inset

, האלגוריתם עובר סדרתית על התווים בו וממיר אותם למספרים, ובכל פעם שהתקבל
 מספר חדש בודק אם הוא גדול מקודמו.
 אם לא - האלגוריתם עוצר ועונה 
\begin_inset Quotes eld
\end_inset

לא
\begin_inset Quotes erd
\end_inset

 ואחרת בסוף הרשימה הוא עוצר ועונה 
\begin_inset Quotes eld
\end_inset

כן
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
סיבוכיות זמן הריצה של האלגוריתם הזה היא פולינומית ב-
\begin_inset Formula $\left|w\right|$
\end_inset

.
\end_layout

\begin_layout Standard
זה מוביל אותנו להגדרה המרכזית הראשונה שלנו: מחלקת הסיבוכיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
P
\lang hebrew
.
 כזכור, אלגוריתם 
\begin_inset Formula $A$
\end_inset

 הוא 
\series bold
פולינומי
\series default
 אם קיים 
\begin_inset Formula $k$
\end_inset

 כך שלכל קלט 
\begin_inset Formula $w$
\end_inset

, זמן הריצה של 
\begin_inset Formula $A$
\end_inset

 על 
\begin_inset Formula $w$
\end_inset

 הוא 
\begin_inset Formula $O\left(\left|w\right|^{k}\right)$
\end_inset

.
\end_layout

\begin_layout Definition
נאמר ששפה 
\begin_inset Formula $L$
\end_inset

 שייכת למחלקת הסיבוכיות 
\begin_inset Formula $\text{P}$
\end_inset

 אם קיים אלגוריתם פולינומי 
\begin_inset Formula $A$
\end_inset

 שמכריע את 
\begin_inset Formula $L$
\end_inset

.
\end_layout

\begin_layout Standard
כל הבעיות שעסקנו בהן בקורס הזה נפתרו בזמן פולינומי ולכן בניסוח שלהן כבעיות
 הכרעה )
\begin_inset Quotes erd
\end_inset

האם ברשת הזרימה הנתונה קיימת זרימה שערכה לפחות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
73
\numeric off
?
\begin_inset Quotes erd
\end_inset

( כולן שייכות ל-
\begin_inset Formula $\text{P}$
\end_inset

.
 נציג כעת בעיית הכרעה שאיננו יודעים אם היא שייכת ל-
\begin_inset Formula $\text{P}$
\end_inset

 או לא:
\end_layout

\begin_layout Definition
בהינתן גרף 
\begin_inset Formula $G$
\end_inset

 )שיכול להיות מכוון או לא מכוון(, 
\series bold
מסלול המילטוני
\series default
 ב-
\begin_inset Formula $G$
\end_inset

 הוא מסלול ב-
\begin_inset Formula $G$
\end_inset

 כך שכל צומת ב-
\begin_inset Formula $V$
\end_inset

 מופיע בו בדיוק פעם אחת.
 
\series bold
מעגל המילטוני
\series default
 הוא מעגל ב-
\begin_inset Formula $G$
\end_inset

 שכל צומת ב-
\begin_inset Formula $V$
\end_inset

 מופיע בו בדיוק פעם אחת למעט צומת התחלת המעגל ששווה לצומת סיום המעגל.
\end_layout

\begin_layout Standard
ההגדרה של מסלול/מעגל המילטוני מזכירה את זו של מסלול/מעגל 
\series bold
אוילרי
\series default
.
 עבור מסלול/מעגל אוילרי, הדרישה היא לעבור בכל 
\series bold
קשתות
\series default
 
\begin_inset Formula $G$
\end_inset

 בדיוק פעם אחת; עבור מסלול/מעגל המילטוני הדרישה היא לעבור בכל 
\series bold
צמתי
\series default
 
\begin_inset Formula $G$
\end_inset

 בדיוק פעם אחת.
\end_layout

\begin_layout Definition
בעיית המסלול ההמילטוני 
\begin_inset Formula $\text{HL}$
\end_inset

 הוא שפת כל הגרפים הלא מכוונים 
\begin_inset Formula $G$
\end_inset

 בעלי מסלול המילטוני.
 בדומה מגדירים את 
\begin_inset Formula $\text{DHL}$
\end_inset

 עבור גרפים מכוונים עם מסלול המילטוני, ואת 
\begin_inset Formula $\text{HC}$
\end_inset

 ו-
\begin_inset Formula $\text{DHC}$
\end_inset

 עבור גרפים לא מכוונים/מכוונים עם מעגל המילטוני.
\end_layout

\begin_layout Standard
כאמור, איננו יודעים אם 
\begin_inset Formula $\text{HL}$
\end_inset

 )או יתר הבעיות שהגדרנו( שייכת ל-
\begin_inset Formula $\text{P}$
\end_inset

 וכפי שנראה בהמשך, ההשערה שלנו היא שאינה שייכת )וזאת בניגוד חריף לבעיית
 המסלול/מעגל האוילרי, שקיים לה פתרון פולינומי פשוט(.
 עם זאת, יש לבעיה הזו אספקט פשוט אחד: קל לנו 
\series bold
לבדוק
\series default
 שמסלול נתון הוא המילטוני.
 כלומר, אם אנו נתקלים בפתרון של הבעיה, קל לנו 
\series bold
לוודא
\series default
 את נכונות הפתרון.
 תכונה זו חשובה דיו כדי להצדיק הגדרה פורמלית:
\end_layout

\begin_layout Definition
אלגוריתם 
\begin_inset Formula $A$
\end_inset

 
\series bold
מוודא
\series default
 שפה 
\begin_inset Formula $L$
\end_inset

 אם מתקיימים שני התנאים הבאים:
\end_layout

\begin_deeper
\begin_layout Itemize
אם 
\begin_inset Formula $w\in L$
\end_inset

 אז 
\series bold
קיים
\series default
 
\begin_inset Formula $\pi\in\Sigma^{*}$
\end_inset

 כך ש-
\begin_inset Formula $A$
\end_inset

 מקבל את הקלט 
\begin_inset Formula $\left(w,\pi\right)$
\end_inset


\end_layout

\begin_layout Itemize
אם 
\begin_inset Formula $w\notin L$
\end_inset

 אז 
\series bold
לכל
\series default
 
\begin_inset Formula $\pi\in\Sigma^{*}$
\end_inset

 
\begin_inset Formula $A$
\end_inset

 דוחה את הקלט 
\begin_inset Formula $\left(w,\pi\right)$
\end_inset


\end_layout

\end_deeper
\begin_layout Standard
עבור בעיית המסלול ההמילטוני, 
\begin_inset Formula $A$
\end_inset

 יכול להיות אלגוריתם שמקבל את הקלט 
\begin_inset Formula $\left(G,\pi\right)$
\end_inset

 כך ש-
\begin_inset Formula $\pi=\left[v_{1},v_{2},\ldots,v_{k}\right]$
\end_inset

 היא רשימת צמתים.
 
\begin_inset Formula $A$
\end_inset

 עובר על הרשימה, מוודא שכל 
\begin_inset Formula $v\in V$
\end_inset

 מופיע ברשימה בדיוק פעם אחת; שכל צומת מ-
\begin_inset Formula $\pi$
\end_inset

 אכן מופיע ב-
\begin_inset Formula $V$
\end_inset

; ושהקשת 
\begin_inset Formula $v_{i}\to v_{i+1}$
\end_inset

 שייכת ל-
\begin_inset Formula $E$
\end_inset

 לכל 
\begin_inset Formula $1\le i<k$
\end_inset

.
 אם 
\begin_inset Formula $\pi$
\end_inset

 עבר את כל המבחנים הללו, 
\begin_inset Formula $A$
\end_inset

 יקבל את הקלט.
\end_layout

\begin_layout Standard
כעת, אם 
\begin_inset Formula $G$
\end_inset

 הוא גרף בעל מסלול המילטוני 
\begin_inset Formula $\pi$
\end_inset

 אז 
\begin_inset Formula $A$
\end_inset

 יקבל את הקלט 
\begin_inset Formula $\left(G,\pi\right)$
\end_inset

; לעומת זאת אם 
\begin_inset Formula $G$
\end_inset

 אינו בעל מסלול המילטוני, אז 
\begin_inset Formula $A$
\end_inset

 ידחה כל קלט 
\begin_inset Formula $\left(G,\pi\right)$
\end_inset

 כי המבחנים של 
\begin_inset Formula $A$
\end_inset

 יכולים לעבור רק במקרה שבו 
\begin_inset Formula $\pi$
\end_inset

 הוא מסלול המילטוני.
 המסקנה היא ש-
\begin_inset Formula $A$
\end_inset

 מוודא את השפה 
\begin_inset Formula $\text{HL}$
\end_inset

 )באופן דומה ניתן לוודא את השפות 
\begin_inset Formula $\text{HC,DHL,DHC}$
\end_inset

(.
\end_layout

\begin_layout Standard
אנו רוצים לעסוק במקרים שבהם תהליך הוידוא מבוצע ביעילות, כלומר בזמן פולינומי,
 אולם נשאלת השאלה - פולינומי 
\series bold
במה
\series default
? אם 
\begin_inset Formula $A$
\end_inset

 צריך להיות פולינומי ב-
\begin_inset Formula $\left|\left(w,\pi\right)\right|$
\end_inset

 אז 
\begin_inset Quotes eld
\end_inset

הוכחה
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $\pi$
\end_inset

 יכולה להיות פשוט סדרה ארוכה מאוד של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
-ים כך ש-
\begin_inset Formula $A$
\end_inset

 יוכל לבצע חישוב ארוך ומסובך לבדיקת 
\begin_inset Formula $w$
\end_inset

 וחישוב זה ייחשב 
\begin_inset Quotes eld
\end_inset

פולינומי
\begin_inset Quotes erd
\end_inset

 כי הוא פולינומי באורך 
\begin_inset Formula $\pi$
\end_inset

.
 על כן, נניח כי 
\begin_inset Formula $A$
\end_inset

 פולינומי ב-
\begin_inset Formula $\left|w\right|$
\end_inset

.
 נשים לב כי במקרה זה, אם 
\begin_inset Formula $\pi$
\end_inset

 היא מאורך גדול כל כך עד ש-
\begin_inset Formula $A$
\end_inset

 אינו יכול לקרוא את כל 
\begin_inset Formula $\pi$
\end_inset

 תוך עמידה במגבלת הזמנים, הרי שאפשר 
\begin_inset Quotes eld
\end_inset

לקצר
\begin_inset Quotes erd
\end_inset

 את 
\begin_inset Formula $\pi$
\end_inset

 ולהשאיר רק את החלק שאותו 
\begin_inset Formula $A$
\end_inset

 מסוגל לקרוא.
\end_layout

\begin_layout Standard
כעת ניתן להגדיר את המחלקה המתאימה לתכונת ה
\begin_inset Quotes erd
\end_inset

קל לבדוק
\begin_inset Quotes erd
\end_inset

:
\end_layout

\begin_layout Definition
נאמר ששפה 
\begin_inset Formula $L$
\end_inset

 שייכת למחלקה 
\begin_inset Formula $\text{NP}$
\end_inset

 אם קיים אלגוריתם 
\begin_inset Formula $A$
\end_inset

 פולינומי ב-
\begin_inset Formula $\left|w\right|$
\end_inset

 שמוודא את 
\begin_inset Formula $L$
\end_inset

.
\end_layout

\begin_layout Standard
ה-
\begin_inset Formula $\text{P}$
\end_inset

 בשמות המחלקות 
\begin_inset Formula $\text{P,NP}$
\end_inset

 הוא מהמילה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Polynomial
\lang hebrew
.
 ה-
\begin_inset Formula $\text{N}$
\end_inset

 שב-
\begin_inset Formula $\text{NP}$
\end_inset

 בא לציין 
\begin_inset Quotes eld
\end_inset


\lang english
Nondeterministic
\lang hebrew

\begin_inset Quotes erd
\end_inset

 שמתייחס להגדרה אחרת, מיושנת יותר, של מחלקה זו; לא נעסוק בהגדרה זו כאן.
\end_layout

\begin_layout Subsection
שאלת 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset


\end_layout

\begin_layout Standard
אחת מהשאלות הפתוחות המרכזיות במדעי המחשב התיאורטיים, אם לא המרכזית שבהן,
 היא השאלה האם 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

.
 כיוון אחד של הכלה הוא קל: אם 
\begin_inset Formula $L\in\text{P}$
\end_inset

 עם אלגוריתם 
\begin_inset Formula $A$
\end_inset

 שמכריע אותה, אז אותו 
\begin_inset Formula $A$
\end_inset

 גם מוודא את אותה שפה )כאשר חושבים עליו ככזה שעל הקלט 
\begin_inset Formula $\left(w,\pi\right)$
\end_inset

 פשוט מתעלם מה-
\begin_inset Formula $\pi$
\end_inset

 ומבצע את החישוב על 
\begin_inset Formula $w$
\end_inset

 כרגיל( ולכן 
\begin_inset Formula $\text{P}\subseteq\text{NP}$
\end_inset

.
 מכאן שאת שאלת 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

 אפשר לנסח בתור השאלה 
\begin_inset Quotes eld
\end_inset

האם כל שפה שניתנת לוידוא ביעילות ניתנת גם להכרעה ביעילות
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
על פניו, המשמעות של קיום השוויון 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

 היא מרחיקת לכת.
 למשל, רוב שיטות ההצפנה הקיימות הן כאלו שבהן בהינתן מפתח 
\begin_inset Formula $K$
\end_inset

 קל לבדוק אם הוא אכן המפתח הנכון )פשוט מנסים לפענח את ההודעה המוצפנת ורואים
 אם התוצאה הגיונית; קיימות שיטות הצפנה כדוגמת 
\begin_inset Quotes eld
\end_inset

פנקס חד פעמי
\begin_inset Quotes erd
\end_inset

 שבהן גישה זו לא תעבוד( ולכן 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

 משמעותו שקל 
\series bold
למצוא
\series default
 מפתח )כלומר, לשבור את ההצפנה( עבור שיטות אלו.
 השלכה דומה יש על שלל בעיות שונות ומשונות )מכיוון שקל לבדוק את המבחן באלגוריתמים
 קומבינטוריים נובע מכך שלפתור את המבחן באלגוריתמים קומבינטוריים זה גם קל(.
 עם זאת, יש להימנע מייחוס משמעויות מופרזות לשוויון הזה; אם בעיה ניתנת לוידוא
 בזמן 
\begin_inset Formula $O\left(n\right)$
\end_inset

 אבל להכרעה בזמן 
\begin_inset Formula $O\left(n^{10000}\right)$
\end_inset

 כנראה שלא תצא לנו שיטה פרקטית לשבירת צפנים מכך.
\end_layout

\begin_layout Standard
האמונה הרווחת בקרב העוסקות והעוסקים במדעי המחשב היא ש-
\begin_inset Formula $\text{P}\ne\text{NP}$
\end_inset

.
 כפי שנראה בקרוב, קיימות אלפי בעיות שונות ומשונות מתחומים רבים של מדעי המחשב
 שפתרון יעיל עבור 
\series bold
אחת
\series default
 מהן יוכיח ש-
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

, אולם למרות האינטרס הגדול לפתור בעיות אלו והשיטות הפרקטיות הרבות שהוצעו
 כדי להתמודד איתן, לא נמצא אלגוריתם יעיל עבור אף אחת מהן.
\end_layout

\begin_layout Standard
למרות זאת, אף שהבעיה תוארה כבר לפני כ-
\numeric on
50
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שנים, טרם נמצאה הוכחה לכך ש-
\begin_inset Formula $\text{P}\ne\text{NP}$
\end_inset

.
 התחושה היא שהטכניקות המתמטיות הקיימות כיום בתורת הסיבוכיות אינן חזקות מספיק
 כדי להוכיח טענה כמו זו )כך למשל מאמר של 
\lang english
Baker-Gill-Solovay
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
משנת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1975
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הראה ששיטות מקובלות בתחום כדוגמת 
\series bold
לכסון
\series default
 שנראה בהמשך לא יכולות לעבוד(.
 במידה מסויימת זה מזכיר את גורלן של בעיות קשות במתמטיקה כדוגמת המשפט האחרון
 של פרמה, שהיה קל מאוד לניסוח אך הוכח רק לאחר
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
350
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שנים בעזרת טכניקות מתמטיות מתקדמות ביותר שלא היו קיימות בזמנו של פרמה.
\end_layout

\begin_layout Standard
ניסוח שקול של 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

, שממחיש את הכוח הרב שהשוויון הזה טומן בחובו, הוא 
\begin_inset Quotes eld
\end_inset

זיהוי יעיל גורר חיפוש יעיל
\begin_inset Quotes erd
\end_inset

:
\end_layout

\begin_layout Theorem
אם 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

 אז לכל שפה 
\begin_inset Formula $L\in\text{NP}$
\end_inset

 ומוודא 
\begin_inset Formula $A$
\end_inset

 עבורה קיים אלגוריתם פולינומי שבהינתן 
\begin_inset Formula $w\in L$
\end_inset

 מחזיר 
\begin_inset Formula $\pi\in\Sigma^{*}$
\end_inset

 כך ש-
\begin_inset Formula $A$
\end_inset

 מקבל את 
\begin_inset Formula $\left(w,\pi\right)$
\end_inset

.
\end_layout

\begin_layout Standard
על מנת להבין את משמעות המשפט, נתבונן במשמעותו עבור שפת המסלול ההמילטוני
 
\begin_inset Formula $\text{HL}$
\end_inset

 שראינו.
 אם ניקח בתור 
\begin_inset Formula $A$
\end_inset

 את המוודא שראינו קודם, אז המשפט אומר שאם 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

 הרי שבהינתן 
\begin_inset Formula $G$
\end_inset

, קיים אלגוריתם שמוצא ביעילות מסלול המילטוני עבור 
\begin_inset Formula $G$
\end_inset

.
 כלומר, היכולת שלנו 
\series bold
לזהות
\series default
 מתי 
\begin_inset Formula $\pi$
\end_inset

 הוא 
\begin_inset Quotes eld
\end_inset

פתרון נכון
\begin_inset Quotes erd
\end_inset

 עבור 
\begin_inset Formula $w$
\end_inset

 מתורגמת ליכולת שלנו 
\series bold
למצוא
\series default
 
\begin_inset Formula $\pi$
\end_inset

 כזה.
\end_layout

\begin_layout Standard
כיצד ניתן להוכיח את המשפט עבור המקרה הפרטי של מסלול המילטוני? נגדיר שפה
 חדשה, 
\begin_inset Formula $\text{Partial-HL}$
\end_inset

, שהמילים בה הן זוגות של גרף 
\begin_inset Formula $G$
\end_inset

 והתחלה של מסלול המילטוני עבור 
\begin_inset Formula $G$
\end_inset

 - כלומר, מסלול ב-
\begin_inset Formula $G$
\end_inset

 שעובר בכל צומת של 
\begin_inset Formula $G$
\end_inset

 לכל היותר פעם אחת, וניתן 
\series bold
להמשיך אותו
\series default
 כדי לקבל מסלול המילטוני ב-
\begin_inset Formula $G$
\end_inset

 )אבל הוא עצמו לא בהכרח מכיל מספיק צמתים כדי להיות מסלול המילטוני(.
 השפה הזו בבירור שייכת ל-
\begin_inset Formula $\text{NP}$
\end_inset

 כי בהינתן זוג של גרף ומסלול, ה-
\begin_inset Formula $\pi$
\end_inset

 עבור המוודא יכלול את המשך המסלול.
 אם כן, מכך ש-
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

 נסיק ש-
\begin_inset Formula $\text{Partial-HL}\in\text{P}$
\end_inset

.
\end_layout

\begin_layout Standard
כעת, בהינתן גרף 
\begin_inset Formula $G$
\end_inset

, נבנה מסלול המילטוני עבורו כך: נבחר צומת 
\begin_inset Formula $v\in V$
\end_inset

 באופן שרירותי ונתחיל את המסלול ממנו.
 נבדוק אם 
\begin_inset Formula $G$
\end_inset

 יחד עם המסלול שכבר בנינו שייך ל-
\begin_inset Formula $\text{Partial-HL}$
\end_inset

; אם כן, זה היה רעיון טוב להתחיל עם 
\begin_inset Formula $v$
\end_inset

 כי אפשר להמשיך עם המסלול שבנינו עד שנגיע למסלול המילטוני.
 אם לא, נעבור לבחור איבר אחר של 
\begin_inset Formula $V$
\end_inset

 ונבדוק עליו.
 כך נעבור לכל היותר על כל אברי 
\begin_inset Formula $V$
\end_inset

 ובסיום איטרציה זו או שנדע שאין מסלול המילטוני ב-
\begin_inset Formula $G$
\end_inset

 או שנדע 
\series bold
בודאות
\series default
 על צומת 
\begin_inset Formula $v$
\end_inset

 שמתחיל מסלול המילטוני.
\end_layout

\begin_layout Standard
כעת ניקח את המסלול שהתחלנו לבנות, ונוסיף לו את הצומת הבא באותו האופן - מבין
 הצמתים שנותרו, נעבור אחד אחד ונבדוק איזה מהם, לאחר שהוא מתווסף למסלול,
 מותיר אותנו ב-
\begin_inset Formula $\text{Partial-HL}$
\end_inset

, וכן הלאה.
\end_layout

\begin_layout Standard
בצורה זו נדרשות 
\begin_inset Formula $\left|V\right|$
\end_inset

 איטרציות, שבכל אחת מהן 
\begin_inset Formula $\left|V\right|$
\end_inset

 צעדים לכל היותר, כך שכל צעד כולל בדיקת שייכות ל-
\begin_inset Formula $\text{Partial-HL}$
\end_inset

 - פולינומי בסך הכל.
\end_layout

\begin_layout Standard
נעבור כעת להוכחה הכללית של המשפט, שמתבססת על אותה הטכניקה בדיוק, בניסוח
 פורמלי יותר.
\end_layout

\begin_layout Proof
בהינתן 
\begin_inset Formula $L$
\end_inset

 עם מוודא 
\begin_inset Formula $A$
\end_inset

 פולינומי, נגדיר שפה 
\begin_inset Formula $L^{\prime}=\left\{ \left(w,\pi^{\prime}\right)\ |\ \exists\pi^{\prime\prime}\in\Sigma^{*}:A\left(w,\pi^{\prime}\pi^{\prime\prime}\right)=\text{True}\right\} $
\end_inset

.
\end_layout

\begin_layout Proof
\begin_inset Formula $L^{\prime}\in\text{NP}$
\end_inset

 שכן קיים לה מוודא 
\begin_inset Formula $A^{\prime}$
\end_inset

 שפועל כך: על קלט 
\begin_inset Formula $\left(\left(w,\pi^{\prime}\right),\pi^{\prime\prime}\right)$
\end_inset

, מריץ את 
\begin_inset Formula $A$
\end_inset

 על 
\begin_inset Formula $\left(w,\pi^{\prime}\pi^{\prime\prime}\right)$
\end_inset

 ועונה כמוהו.
\end_layout

\begin_layout Proof
מכיוון שהנחנו ש-
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

, נקבל ש-
\begin_inset Formula $L^{\prime}\in\text{P}$
\end_inset

.
\end_layout

\begin_layout Proof
נציג כעת אלגוריתם פולינומי שבהינתן 
\begin_inset Formula $w\in L$
\end_inset

 מחזיר 
\begin_inset Formula $\pi\in\Sigma^{*}$
\end_inset

 כך ש-
\begin_inset Formula $A$
\end_inset

 מקבל את 
\begin_inset Formula $\left(w,\pi\right)$
\end_inset

:
\end_layout

\begin_deeper
\begin_layout Enumerate
נאתחל 
\begin_inset Formula $\pi=\varepsilon$
\end_inset

 )המילה הריקה, סדרה ריקה של תווים(.
\end_layout

\begin_layout Enumerate
כל עוד 
\begin_inset Formula $A$
\end_inset

 אינו מקבל את 
\begin_inset Formula $\left(w,\pi\right)$
\end_inset

:
\end_layout

\begin_deeper
\begin_layout Enumerate
לכל 
\begin_inset Formula $\sigma\in\Sigma$
\end_inset

:
\end_layout

\begin_deeper
\begin_layout Enumerate
נבדוק האם 
\begin_inset Formula $\left(w,\pi\sigma\right)\in L^{\prime}$
\end_inset


\end_layout

\begin_layout Enumerate
אם כן, נגדיר 
\begin_inset Formula $\pi\leftarrow\pi\sigma$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
אם הבדיקה לעיל נכשלה לכל 
\begin_inset Formula $\sigma\in\Sigma$
\end_inset

 נחזיר
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
None
\end_layout

\end_deeper
\begin_layout Enumerate
נחזיר את 
\begin_inset Formula $\pi$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Proof
ניתן להראות שאלגוריתם זה מחזיר 
\begin_inset Formula $\pi$
\end_inset

 כמבוקש.
\end_layout

\begin_layout Subsection
רדוקציות פולינומיות
\end_layout

\begin_layout Standard
איננו מכירים פתרון יעיל ל-
\begin_inset Formula $\text{HL}$
\end_inset

.
 אבל 
\series bold
נניח
\series default
 שהיינו מכירים כזה - האם היינו יכולים להיעזר בפתרון זה כדי לפתור בעיות נוספות?
 ראינו דוגמאות לכך במהלך הקורס; היכולת לבצע
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ביעילות תורגמה באופן מיידי ליכולת לבצע מיון טופולוגי ביעילות; היכולת לבצע
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ביעילות תורגמה ליכולת למציאת זרימת מקסימום ביעילות )בסיוע אלגוריתם אדמונדס-קארפ(
, ויכולת זו תורגמה ליכולת למצוא שידוך מקסימום בגרף.
\end_layout

\begin_layout Standard
במקרה של שימוש ב-
\lang english
BFS
\lang hebrew
, השתמשנו ב-
\lang english
BFS
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בתור 
\begin_inset Quotes eld
\end_inset

קופסה שחורה
\begin_inset Quotes erd
\end_inset

 שנקראת מספר פעמים במהלך ריצת אדמונדס-קארפ.
 במקרה של שידוך מקסימום, עשינו דבר פשוט יותר: בהינתן קלט בעיית שידוך מקסימום
 )כלומר, גרף דו צדדי( 
\series bold
המרנו
\series default
 את הקלט הזה לקלט לבעיית זרימת מקסימום, פתרנו את בעיית זרימת המקסימום ואז
 
\begin_inset Quotes eld
\end_inset

תרגמנו חזרה
\begin_inset Quotes erd
\end_inset

 את הפתרון שמצאנו אל פתרון של בעיית שידוך מקסימום.
\end_layout

\begin_layout Standard
שתי גישות אלו שימושיות בתורת הסיבוכיות.
 הראשונה, גישת ה
\begin_inset Quotes erd
\end_inset

קופסה שחורה
\begin_inset Quotes erd
\end_inset

 מתוארת באמצעות המושג הפורמלי של 
\series bold
אורקל
\series default
 ולא נעסוק בה כאן אף שיש בה עניין רב.
 השניה, של 
\begin_inset Quotes eld
\end_inset

המרת קלט של בעיה אחת לקלט של בעיה אחרת
\begin_inset Quotes erd
\end_inset

 מתוארת באמצעות המושג הפורמלי של 
\series bold
רדוקציית העתקה
\series default
 או בקיצור 
\begin_inset Quotes eld
\end_inset

רדוקציה
\begin_inset Quotes erd
\end_inset

, והיא הכלי שנעסוק בו כאן.
\end_layout

\begin_layout Definition
בהינתן שפות 
\begin_inset Formula $L_{1},L_{2}$
\end_inset

, 
\series bold
רדוקציה
\series default
 מ-
\begin_inset Formula $L_{1}$
\end_inset

 אל 
\begin_inset Formula $L_{2}$
\end_inset

 היא פונקציה 
\begin_inset Formula $f:L_{1}\to L_{2}$
\end_inset

 הניתנת לחישוב אלגוריתמי, כך שמתקיים 
\begin_inset Formula $x\in L_{1}\iff f\left(x\right)\in L_{2}$
\end_inset

.
 אם 
\begin_inset Formula $f$
\end_inset

 ניתנת לחישוב בזמן פולינומי אומרים ש-
\begin_inset Formula $f$
\end_inset

 היא 
\series bold
רדוקציה פולינומית
\series default
.
 אם קיימת רדוקציה מ-
\begin_inset Formula $L_{1}$
\end_inset

 אל 
\begin_inset Formula $L_{2}$
\end_inset

 מסמנים זאת 
\begin_inset Formula $L_{1}\le L_{2}$
\end_inset

 ואם הרדוקציה היא פולינומית מסמנים זאת 
\begin_inset Formula $L_{1}\le_{p}L_{2}$
\end_inset

.
\end_layout

\begin_layout Standard
הרעיון ברדוקציה הוא להיעזר בפתרון של 
\begin_inset Formula $L_{2}$
\end_inset

 כדי לפתור את 
\begin_inset Formula $L_{1}$
\end_inset

.
 לשם כך ממירים את הבעיה ב-
\begin_inset Formula $L_{1}$
\end_inset

 )שמסומנת ב-
\begin_inset Formula $x$
\end_inset

( לבעיה 
\begin_inset Formula $f\left(x\right)$
\end_inset

 של 
\begin_inset Formula $L_{2}$
\end_inset

.
 נשים לב לכך שאין שום צורך ש-
\begin_inset Formula $f$
\end_inset

 תהיה על, כלומר אין צורך שהרדוקציה שלנו תיעזר ב
\begin_inset Quotes erd
\end_inset

מלוא הכוח
\begin_inset Quotes erd
\end_inset

 של השפה 
\begin_inset Formula $L_{2}$
\end_inset

; ואכן, לעתים קרובות התוצרים של הרדוקציה ייראו כמו מקרים מאוד ספציפיים של
 
\begin_inset Formula $L_{2}$
\end_inset

.
\end_layout

\begin_layout Claim
אם 
\begin_inset Formula $L_{2}\in\text{P}$
\end_inset

 וגם 
\begin_inset Formula $L_{1}\le_{p}L_{2}$
\end_inset

 אז 
\begin_inset Formula $L_{1}\in\text{P}$
\end_inset


\end_layout

\begin_layout Proof
נניח כי 
\begin_inset Formula $A$
\end_inset

 הוא אלגוריתם פולינומי המכריע את 
\begin_inset Formula $L_{2}$
\end_inset

.
 נכריע את 
\begin_inset Formula $L_{1}$
\end_inset

 כך: בהינתן 
\begin_inset Formula $x\in\Sigma^{*}$
\end_inset

 נחשב את 
\begin_inset Formula $f\left(x\right)$
\end_inset

 בזמן פולינומי, נריץ את 
\begin_inset Formula $A$
\end_inset

 על 
\begin_inset Formula $f\left(x\right)$
\end_inset

 ונענה כמוה.
 מכיוון ש-
\begin_inset Formula $x\in L_{1}\iff f\left(x\right)\in L_{2}$
\end_inset

 נקבל ש-
\begin_inset Formula $x\in L_{1}$
\end_inset

 אם ורק אם 
\begin_inset Formula $A$
\end_inset

 ענתה 
\begin_inset Quotes eld
\end_inset

כן
\begin_inset Quotes erd
\end_inset

, מה שמראה את נכונות הפתרון.
 כמו כן, זמן הריצה של 
\begin_inset Formula $A$
\end_inset

 על 
\begin_inset Formula $f\left(x\right)$
\end_inset

 הוא פולינומי ב-
\begin_inset Formula $\left|f\left(x\right)\right|$
\end_inset

 ומכיוון ש-
\begin_inset Formula $\left|f\left(x\right)\right|$
\end_inset

 הוא פולינומי ב-
\begin_inset Formula $\left|x\right|$
\end_inset

 נקבל שזמן הריצה של 
\begin_inset Formula $A$
\end_inset

 הוא פולינומי ב-
\begin_inset Formula $\left|x\right|$
\end_inset

.
\end_layout

\begin_layout Standard
טענה זו מסבירה את הסימון 
\begin_inset Formula $\le$
\end_inset

: אם 
\begin_inset Formula $L_{1}\le_{p}L_{2}$
\end_inset

 אז בכל הנוגע לחישוב פולינומי, 
\begin_inset Formula $L_{2}$
\end_inset

 היא בעיה 
\begin_inset Quotes eld
\end_inset

קשה לפחות כמו
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $L_{1}$
\end_inset

 כי אם ניתן לפתור את 
\begin_inset Formula $L_{2}$
\end_inset

 בזמן פולינומי, ניתן לפתור גם את 
\begin_inset Formula $L_{1}$
\end_inset

.
 כמובן, ניתן להפוך את התוצאה החיובית על פיה כדי לקבל תוצאה שלילית:
\end_layout

\begin_layout Claim
אם 
\begin_inset Formula $L_{1}\notin\text{P}$
\end_inset

 וגם 
\begin_inset Formula $L_{1}\le_{p}L_{2}$
\end_inset

 אז 
\begin_inset Formula $L_{2}\notin\text{P}$
\end_inset


\end_layout

\begin_layout Standard
בצורה זו רדוקציה יכולה לשמש כדי להוכיח אי-שייכות של שפה למחלקה כלשהי - מראים
 רדוקציה 
\series bold
אל
\series default
 השפה משפה שהקושי שלה כבר הוכחץ
\end_layout

\begin_layout Standard
נראה דוגמא לרדוקציה בכך שנראה 
\begin_inset Formula $\text{HC}\le_{p}\text{HL}$
\end_inset

.
 כלומר, בהינתן גרף לא מכוון 
\begin_inset Formula $G$
\end_inset

 נראה איך לבנות ממנו גרף 
\begin_inset Formula $G^{\prime}$
\end_inset

 כך שב-
\begin_inset Formula $G$
\end_inset

 יש 
\series bold
מעגל
\series default
 המילטוני אם ורק אם ב-
\begin_inset Formula $G^{\prime}$
\end_inset

 יש 
\series bold
מסלול
\series default
 המילטוני.
\end_layout

\begin_layout Standard
אם נגדיר סתם 
\begin_inset Formula $G^{\prime}=G$
\end_inset

, הרדוקציה לא תעבוד.
 אמנם, אם 
\begin_inset Formula $G\in\text{HC}$
\end_inset

 אז בפרט 
\begin_inset Formula $G^{\prime}\in\text{HL}$
\end_inset

 כי כל מעגל המילטוני הוא בפרט מסלול המילטוני, אבל בהחלט ייתכן ש-
\begin_inset Formula $G^{\prime}\in\text{HL}$
\end_inset

 אבל אין ב-
\begin_inset Formula $G$
\end_inset

 מסלול המילטוני )למשל, גרף 
\begin_inset Quotes eld
\end_inset

שרוך
\begin_inset Quotes erd
\end_inset

(.
\end_layout

\begin_layout Standard
ננקוט אם כן בתעלול הבא: אם ב-
\begin_inset Formula $G$
\end_inset

 יש מעגל, אז כל צומת בגרף יכול לשמש בתור נקודת ההתחלה/סיום של המעגל.
 נבחר צומת שרירותי 
\begin_inset Formula $v\in V$
\end_inset

 ונפצל אותו לשניים, 
\begin_inset Formula $v_{1},v_{2}$
\end_inset

 כך שלכל 
\begin_inset Formula $v\ne u\in V$
\end_inset

 מתקיים 
\begin_inset Formula $\left(v_{i},u\right)\in E^{\prime}\iff\left(v,u\right)\in E$
\end_inset

.
 כעת נרצה 
\begin_inset Quotes eld
\end_inset

להכריח
\begin_inset Quotes erd
\end_inset

 כל מסלול המילטוני בגרף החדש להתחיל ב-
\begin_inset Formula $v_{1}$
\end_inset

 ולהסתיים ב-
\begin_inset Formula $v_{2}$
\end_inset

 או ההפך; לצורך כך נוסיף שני צמתים 
\begin_inset Formula $w_{1},w_{2}$
\end_inset

 ואת הקשתות 
\begin_inset Formula $\left(w_{1},v_{1}\right),\left(w_{2},v_{2}\right)\in E^{\prime}$
\end_inset

.
 פרט אליהן 
\begin_inset Formula $w_{1},w_{2}$
\end_inset

 לא מחוברים לקשתות נוספות ומכיוון שמסלול המילטוני חייב לעבור בצמתים אלו
 הוא חייב להתחיל ולהסתיים בהם.
\end_layout

\begin_layout Standard
כעת, אם מצאנו ב-
\begin_inset Formula $G^{\prime}$
\end_inset

 את המסלול ההמילטוני 
\begin_inset Formula $w_{1}\to v_{1}\to\ldots\to v_{2}\to w_{2}$
\end_inset

 אז על ידי הסרת 
\begin_inset Formula $w_{1},w_{2}$
\end_inset

 מהמסלול והחלפת 
\begin_inset Formula $v_{1},v_{2}$
\end_inset

 ב-
\begin_inset Formula $v$
\end_inset

 נקבל מעגל המילטוני ב-
\begin_inset Formula $G$
\end_inset

; ובדומה אפשר להמיר מעגל המילטוני ב-
\begin_inset Formula $G$
\end_inset

 במסלול המילטוני ב-
\begin_inset Formula $G^{\prime}$
\end_inset

, מה שמוכיח את נכונות הרדוקציה.
 פולינומיות הרדוקציה נובעת מהשינוי הפשוט שביצענו - בחירת צומת, הסרה שלו,
 הוספת כמה צמתים חדשים וקשתות שמחוברות אליהם דורשים כולם זמן פולינומי.
\end_layout

\begin_layout Subsection
בעיות
\family roman
\series bold
\shape up
\size large
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמות
\end_layout

\begin_layout Standard
הרדוקציה 
\begin_inset Formula $\text{HC}\le_{p}\text{HL}$
\end_inset

 שהצגנו הייתה 
\begin_inset Quotes eld
\end_inset

יצירתית
\begin_inset Quotes erd
\end_inset

 - השתמשנו בתעלול כלשהו עבורה שהתבסס בצורה חזקה על המאפיינים של שתי הבעיות
 שביניהן עשינו רדוקציה.
 האם יש משהו כללי יותר שאפשר לעשות? האם יש דרך שיטתית כלשהי לבצע רדוקציה
 בין שפות?
\end_layout

\begin_layout Standard
תוצאה מפתיעה ומעניינת במיוחד היא שאכן יש דרך כזו עבור שפות ב-
\begin_inset Formula $\text{NP}$
\end_inset

 )וגם עבור מחלקות נוספות של סיבוכיות שלא נעסוק בהן(.
 נפתח עם הגדרה:
\end_layout

\begin_layout Definition
שפה 
\begin_inset Formula $L$
\end_inset

 נקראת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series bold
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-קשה
\series default
 אם לכל 
\begin_inset Formula $L^{\prime}\in\text{NP}$
\end_inset

 קיימת רדוקציה 
\begin_inset Formula $L^{\prime}\le_{p}L$
\end_inset

.
 אם בנוסף 
\begin_inset Formula $L\in\text{NP}$
\end_inset

 אז 
\begin_inset Formula $L$
\end_inset

 נקראת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\series bold
\lang hebrew
-שלמה
\end_layout

\begin_layout Standard
השפה הראשונה שעליה הוכח כי היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה היא השפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שנציג כעת, ודורשת מושגים בסיסיים מתחשיב הפסוקים בלוגיקה:
\end_layout

\begin_layout Definition
)פסוקי 
\lang english
CNF
\lang hebrew
(
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
משתנה בוליאני
\series default
 
\begin_inset Formula $x$
\end_inset

 הוא משתנה שיכול לקבל ערך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
T
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
או
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\lang hebrew
.
\end_layout

\begin_layout Itemize

\series bold
ליטרל
\series default
 הוא משתנה 
\begin_inset Formula $x$
\end_inset

 או שלילה 
\begin_inset Formula $\neg x$
\end_inset

 של משתנה.
\end_layout

\begin_layout Itemize

\series bold
פסוקית
\family roman
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא ביטוי מהצורה 
\begin_inset Formula $C=\left(l_{1}\vee l_{2}\vee\ldots\vee l_{k}\right)$
\end_inset

 כאשר כל 
\begin_inset Formula $l_{i}$
\end_inset

 הוא ליטרל.
\end_layout

\begin_layout Itemize

\series bold
פסוק
\family roman
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא ביטוי מהצורה 
\begin_inset Formula $C_{1}\wedge C_{2}\wedge\ldots\wedge C_{n}$
\end_inset

 כאשר כל 
\begin_inset Formula $C_{i}$
\end_inset

 הוא פסוקית
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\lang hebrew
.
\end_layout

\end_deeper
\begin_layout Standard
הרעיון בפסוקי
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא שניתן 
\series bold
להציב
\series default
 במשתנים ערכי אמת:
\end_layout

\begin_layout Definition

\series bold
השמה
\series default
 
\begin_inset Formula $\tau$
\end_inset

 לפסוק
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא פונקציה 
\begin_inset Formula $\tau:\left\{ x_{1},\ldots,x_{n}\right\} \to\left\{ \text{T,F}\right\} $
\end_inset

 מקבוצת המשתנים שמופיעים בפסוק לקבוצת ערכי האמת האפשריים.
\end_layout

\begin_layout Standard
בהינתן השמה, ניתן לחשב את ערך האמת שהיא נותנת לפסוק כולו באופן הבא: לכל
 ליטרל, אם הוא מהצורה 
\begin_inset Formula $x$
\end_inset

 אז הוא מקבל את ערך האמת שההשמה נתנה למשתנה 
\begin_inset Formula $x$
\end_inset

 ואם הוא מהצורה 
\begin_inset Formula $\neg x$
\end_inset

 הוא מקבל את ערך האמת שההשמה לא נתנה ל-
\begin_inset Formula $x$
\end_inset

.
 פסוקית
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מקבלת ערך 
\begin_inset Formula $\text{T}$
\end_inset

 אם לפחות אחד מהליטרלים בה קיבל 
\begin_inset Formula $\text{T}$
\end_inset

.
 פסוק
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מקבל ערך 
\begin_inset Formula $\text{T}$
\end_inset

 אם כל פסוקיות ה-
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שלו קיבלו ערך 
\begin_inset Formula $\text{T}$
\end_inset

.
\end_layout

\begin_layout Standard
ניתן להוכיח כי כל טבלת אמת ניתנת למימוש באמצעות פסוק
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אך לא נעשה זאת כאן.
 אנו מתעניינים בשאלה פשוטה יותר - האם פסוק ה-
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שלנו הוא זהותית 
\begin_inset Formula $\text{F}$
\end_inset

 או לא.
\end_layout

\begin_layout Definition
פסוק
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא 
\series bold
ספיק
\series default
 אם קיימת השמה כלשהי שנותנת לו את הערך 
\begin_inset Formula $\text{T}$
\end_inset

.
\end_layout

\begin_layout Standard
כך למשל הפסוק 
\begin_inset Formula $\left(x_{1}\vee x_{2}\right)\wedge\left(\neg x_{1}\vee x_{3}\right)$
\end_inset

 הוא ספיק על ידי ההשמה שנותנת 
\begin_inset Formula $\text{T}$
\end_inset

 ל-
\begin_inset Formula $x_{1},x_{3}$
\end_inset

 ולא משנה מה ל-
\begin_inset Formula $x_{2}$
\end_inset

.
 לעומת זאת הפסוק 
\begin_inset Formula $\left(x_{1}\vee x_{2}\right)\wedge\left(\neg x_{1}\right)\wedge\left(\neg x_{2}\right)$
\end_inset

 אינו ספיק.
\end_layout

\begin_layout Standard
כעת ניתן להגדיר את השפה שלנו:
\end_layout

\begin_layout Definition
השפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא שפת כל פסוקי ה-
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הספיקים.
\end_layout

\begin_layout Standard
קל לראות ש-
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שייכת ל-
\begin_inset Formula $\text{NP}$
\end_inset

: בהינתן פסוק 
\begin_inset Formula $\varphi$
\end_inset

, ה
\begin_inset Quotes erd
\end_inset

הוכחה
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $\pi$
\end_inset

 לשייכותו ל-
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תהיה פשוט השמה שמספקת אותו.
 השמה שכזו היא בסך הכל סדרה של 
\begin_inset Formula $n$
\end_inset

 ביטים כך ש-
\begin_inset Formula $n$
\end_inset

 הוא מספר המשתנים השונים שמופיעים ב-
\begin_inset Formula $\varphi$
\end_inset

 כך ש-
\begin_inset Formula $\left|\pi\right|\le\left|\varphi\right|$
\end_inset

 ובפרט 
\begin_inset Formula $\pi$
\end_inset

 פולינומי בגודלו ובדיקת ספיקות בהינתן ההשמה היא פולינומית.
\end_layout

\begin_layout Standard
הסיבה לחשיבות הגדולה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא המשפט הבא:
\end_layout

\begin_layout Theorem
)משפט קוק-לוין(:
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה.
\end_layout

\begin_layout Standard
לא נוכיח משפט זה כאן.
 ההוכחה היא טכנית אך אינה קשה בצורה חריגה; אולם על מנת להוכיח בצורה פורמלית
 את המשפט אנחנו צריכים מודל פורמלי של חישוב, ונמנענו מלעשות זאת.
 הרעיון שמאחורי ההוכחה הוא זה: בהינתן שפה 
\begin_inset Formula $L\in\text{NP}$
\end_inset

 כלשהי לוקחים מודל חישוב פשוט עבור וידוא שלה - 
\series bold
מכונת טיורינג
\series default
.
 אופן הפעולה של מכונת טיורינג הוא פשוט דיו עד כדי כך שניתן לייצג את כל המצבים
 האפשריים של המכונה במהלך כל החישוב בידי כמות לא גדולה של משתנים בוליאניים,
 ולכתוב פסוק שמוודא שהמשתנים הללו
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\numeric off
( מקודדים את המצב התחלתי של המכונה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
2
\numeric off
( מקודדים את ההגעה של המכונה למצב מקבל ו-
\numeric on
3
\numeric off
( מקודדים את החישוב שהמכונה מבצעת.
\end_layout

\begin_layout Standard
דהיינו, הוכחת המשפט מצביעה על דרך שיטתית לייצר רדוקציה מ-
\begin_inset Formula $L$
\end_inset

 אל 
\begin_inset Formula $\text{SAT}$
\end_inset

 בהינתן שיש לנו מכונת טיורינג עבור 
\begin_inset Formula $L$
\end_inset

 )קיימת כזו שכן 
\begin_inset Formula $L\in\text{NP}$
\end_inset

(.
 אפשר לחשוב עליו כאומר ש-
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא שפה 
\begin_inset Quotes eld
\end_inset

מורכבת מספיק
\begin_inset Quotes erd
\end_inset

 כדי שאפשר יהיה לקודד כל בעיה אחרת ב-
\lang english
NP
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
באמצעות אובייקטים מהעולם ש-
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
עוסקת בו.
\end_layout

\begin_layout Standard
למרבה השמחה, מרגע שבידינו שפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה אחת, קל יותר להוכיח כי גם שפות אחרות הן כאלו:
\end_layout

\begin_layout Theorem
אם 
\begin_inset Formula $L_{1}$
\end_inset

 היא שפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-קשה ו-
\begin_inset Formula $L_{1}\le_{p}L_{2}$
\end_inset

 אז גם 
\begin_inset Formula $L_{2}$
\end_inset

 היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-קשה.
\end_layout

\begin_layout Proof
תהא 
\begin_inset Formula $L\in\text{NP}$
\end_inset

 כלשהי.
 אז 
\begin_inset Formula $L\le_{p}L_{1}$
\end_inset

 מכיוון ש-
\begin_inset Formula $L_{1}$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-קשה.
 תהא 
\begin_inset Formula $f:L\to L_{1}$
\end_inset

 הרדוקציה הפולינומית המתאימה ו-
\begin_inset Formula $g:L_{1}\to L_{2}$
\end_inset

 הרדוקציה הפולינומית המתאימה ל-
\begin_inset Formula $L_{1}\le_{p}L_{2}$
\end_inset

.
 אז 
\begin_inset Formula $gf:L\to L_{2}$
\end_inset

 היא רדוקציה פולינומית )הפולינומיות של זמן הריצה נובעת שוב מכך שהרכבת פולינומים
 היא פולינום(.
\end_layout

\begin_layout Standard
כלומר, אם אנו רוצים להוכיח ששפה כלשהי ב-
\lang english
NP
\lang hebrew
 היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה, אנחנו מתחילים משפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה מוכרת ועושים רדוקציה 
\series bold
ממנה
\series default
 אל השפה שאנחנו רוצים להוכיח את הקושי שלה )זו נקודה שקל להתבלבל בה ולנסות
 למצוא רדוקציה בכיוון השני, למרות שקיום רדוקציה כזו כבר מובטח לנו ממילא(.
\end_layout

\begin_layout Standard
מה המשמעות של כך ששפה היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה? מסקנה אחת היא מיידית:
\end_layout

\begin_layout Theorem
אם 
\begin_inset Formula $L$
\end_inset

 היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה ו-
\begin_inset Formula $L\in\text{P}$
\end_inset

 אז 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

.
\end_layout

\begin_layout Proof
לכל 
\begin_inset Formula $L^{\prime}\in\text{NP}$
\end_inset

 קיימת רדוקציה 
\begin_inset Formula $L^{\prime}\le_{p}L$
\end_inset

 ולכן אם 
\begin_inset Formula $L\in\text{P}$
\end_inset

 אז 
\begin_inset Formula $L^{\prime}\in\text{P}$
\end_inset

.
\end_layout

\begin_layout Standard
משמעות הדבר היא שאם 
\begin_inset Formula $\text{P}\ne\text{NP}$
\end_inset

 אז בודאות כל שפה 
\begin_inset Formula $\text{NP}$
\end_inset

-שלמה אינה ב-
\begin_inset Formula $\text{P}$
\end_inset

; שפות אלו הן במובן מסויים 
\begin_inset Quotes eld
\end_inset

השפות הקשות ביותר ב-
\begin_inset Formula $\text{NP}$
\end_inset


\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Subsection
דוגמאות לשפות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמות
\end_layout

\begin_layout Standard
נציג כעת מספר דוגמאות לשפות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמות.
 נציג את השפות עצמן וסקיצה של רדוקציה אליהן משפה 
\begin_inset Formula $\text{NP}$
\end_inset

-שלמה מוכרת.
 לא נוכיח שהשפות הן ב-
\lang english
NP
\lang hebrew
; הדבר לרוב פשוט למדי.
\end_layout

\begin_layout Subsubsection
השפה
\family roman
\series bold
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
3SAT
\end_layout

\begin_layout Standard
השפה 
\lang english
3SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
זהה ל-
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הרגילה פרט לכך שכל פסוקית מכילה בדיוק שלושה ליטרלים )השפה הדומה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
2SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שייכת ל-
\begin_inset Formula $\text{P}$
\end_inset

(.
 רדוקציה 
\begin_inset Formula $\text{SAT}\le_{p}\text{3SAT}$
\end_inset

 מתבססת על פירוק כל פסוקית
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של הפסוק המקורי ל
\begin_inset Quotes erd
\end_inset

שרשרת
\begin_inset Quotes erd
\end_inset

 של פסוקיות מגודל
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בעזרת משתני עזר חדשים:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\left(l_{1}\vee\ldots\vee l_{n}\right) & \mapsto\left(l_{1}\vee l_{2}\vee b_{1}\right)\wedge\left(\neg b_{1}\vee l_{3}\vee b_{2}\right)\wedge\left(\neg b_{2}\vee l_{4}\vee b_{3}\right)\wedge\ldots\wedge\left(\neg b_{n-3}\vee l_{n-1}\vee l_{n}\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
כל 
\begin_inset Formula $b$
\end_inset

 משתתף בשתי פסוקיות בדיוק, פעם כ-
\begin_inset Formula $b$
\end_inset

 ופעם כשלילתו, ולכן על ידי הצבה ל-
\begin_inset Formula $b$
\end_inset

 מסויים אפשר 
\begin_inset Quotes eld
\end_inset

לבטל
\begin_inset Quotes erd
\end_inset

 את אחת הפסוקיות.
 יש 
\begin_inset Formula $n-3$
\end_inset

 משתני 
\begin_inset Formula $b$
\end_inset

 שכאלו אבל 
\begin_inset Formula $n-2$
\end_inset

 פסוקיות ולכן אחרי השמה ל-
\begin_inset Formula $n$
\end_inset

-ים עדיין נשארת פסוקית אחת שחייבת להסתפק בעזרת אחד ה-
\begin_inset Formula $l$
\end_inset

-ים, כך שהפסוק החדש מסתפק תחת השמה נתונה למשתנים של ה-
\begin_inset Formula $l$
\end_inset

-ים אם ורק אם ההשמה הזו סיפקה את הפסוקית המקורית.
\end_layout

\begin_layout Subsubsection
השפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Vertex Cover
\end_layout

\begin_layout Standard

\series bold
כיסוי בצמתים
\series default
 של גרף לא מכוון 
\begin_inset Formula $G$
\end_inset

 הוא תת-קבוצה 
\begin_inset Formula $A\subseteq V$
\end_inset

 כך שלכל 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

, 
\begin_inset Formula $u\in A$
\end_inset

 או 
\begin_inset Formula $v\in A$
\end_inset

 )או שניהם(.
\end_layout

\begin_layout Standard
השפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Vertex Cover
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ובקיצור
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
VC
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
מורכבת מזוגות 
\begin_inset Formula $\left(G,k\right)$
\end_inset

 כך ש-
\begin_inset Formula $G$
\end_inset

 גרף לא מכוון ו-
\begin_inset Formula $k$
\end_inset

 מספר טבעי, כך שקיים ל-
\begin_inset Formula $G$
\end_inset

 כיסוי בצמתים מגודל לכל היותר 
\begin_inset Formula $m$
\end_inset

.
\end_layout

\begin_layout Standard
נראה רדוקציה 
\begin_inset Formula $\text{3SAT}\le_{p}\text{VC}$
\end_inset

:
\end_layout

\begin_layout Standard
בהינתן פסוק 
\begin_inset Formula $\varphi$
\end_inset

 עם 
\begin_inset Formula $n$
\end_inset

 משתנים ו-
\begin_inset Formula $m$
\end_inset

 פסוקיות, נבנה גרף 
\begin_inset Formula $G$
\end_inset

 בצורה הבאה:
\end_layout

\begin_layout Standard
ראשית, לכל משתנה 
\begin_inset Formula $x$
\end_inset

 ב-
\begin_inset Formula $\varphi$
\end_inset

 נוסיף צמתים שמסומנים ב-
\begin_inset Formula $x$
\end_inset

 וב-
\begin_inset Formula $\neg x$
\end_inset

 ונחבר אותם בקשת.
 על מנת לכסות קשתות אלו, יש צורך לבחור לפחות צומת אחד מכל זוג.
 את הפרמטר 
\begin_inset Formula $k$
\end_inset

 של גודל הכיסוי בצמתים נכוונן כך שיהיה ניתן לבחור גם 
\series bold
לכל היותר
\series default
 צומת אחד מכל זוג, כך שניתן יהיה לזהות את בחירת הצמתים עם בחירת 
\series bold
השמה
\series default
 לפסוק המקורי.
\end_layout

\begin_layout Standard
בנוסף, לכל פסוקית 
\begin_inset Formula $\left(l_{1}\vee l_{2}\vee l_{3}\right)$
\end_inset

 נוסיף שלושה צמתים המסומנים ב-
\begin_inset Formula $l_{1},l_{2},l_{3}$
\end_inset

 כך שכל זוג צמתים מתוכם מחובר בקשת.
 על מנת לכסות את ה
\begin_inset Quotes erd
\end_inset

משולש
\begin_inset Quotes erd
\end_inset

 הזה הכרחי לבחור שניים מבין שלושת הצמתים שבו.
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename images/sat_to_vc.PNG
	scale 50

\end_inset


\end_layout

\begin_layout Standard
קיבלנו שכדי לכסות את הקשתות שתיארנו עד כה, כיסוי בצמתים חייב להכיל לפחות
 
\begin_inset Formula $n+2m$
\end_inset

 איברים.
 נקבע כעת 
\begin_inset Formula $k=n+2m$
\end_inset

, מה ש
\begin_inset Quotes erd
\end_inset

מכריח
\begin_inset Quotes erd
\end_inset

 כל כיסוי פוטנציאלי בצמתים לכלול בדיוק צומת אחד מכל 
\begin_inset Quotes eld
\end_inset

רכיב משתנה
\begin_inset Quotes erd
\end_inset

 ושני צמתים מכל 
\begin_inset Quotes eld
\end_inset

רכיב פסוקית
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
לסיום, לכל צומת ששייך ל
\begin_inset Quotes erd
\end_inset

רכיב פסוקית
\begin_inset Quotes erd
\end_inset

 ומתאים לליטרל 
\begin_inset Formula $l$
\end_inset

, נחבר צומת זה בקשת עם הצומת ב
\begin_inset Quotes erd
\end_inset

רכיב משתנה
\begin_inset Quotes erd
\end_inset

 שמסומן ב-
\begin_inset Formula $l$
\end_inset

.
 בצורה זו, אם כל שלושת הליטרלים של רכיב פסוקית אחד קיבלו
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בהשמה, נהיה חייבים להוסיף את שלושת צמתי הליטרלים ונחרוג מהחסם של 
\begin_inset Formula $k$
\end_inset

.
\end_layout

\begin_layout Subsubsection
השפות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Independent Set
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\lang english
Clique
\end_layout

\begin_layout Standard
בהינתן גרף לא מכוון 
\begin_inset Formula $G$
\end_inset

, 
\series bold
קבוצה בלתי תלויה
\series default
 ב-
\begin_inset Formula $G$
\end_inset

 היא קבוצה 
\begin_inset Formula $A\subseteq V$
\end_inset

 כך שלכל 
\begin_inset Formula $u,v\in A$
\end_inset

 מתקיים 
\begin_inset Formula $\left(u,v\right)\notin E$
\end_inset

.
\end_layout

\begin_layout Standard
המושג המשלים הוא 
\series bold
קליק
\series default
 ב-
\begin_inset Formula $G$
\end_inset

 שהוא קבוצה 
\begin_inset Formula $A\subseteq V$
\end_inset

 כך שלכל 
\begin_inset Formula $u,v\in A$
\end_inset

 מתקיים 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

.
\end_layout

\begin_layout Standard
בהתאם, השפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
IS
\lang hebrew
 כוללת את כל הזוגות 
\begin_inset Formula $\left(G,k\right)$
\end_inset

 כך שבגרף 
\begin_inset Formula $G$
\end_inset

 יש קבוצה בלתי תלויה מגודל 
\begin_inset Formula $k$
\end_inset

 לכל הפחות, והשפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CLIQUE
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
את כל הזוגות 
\begin_inset Formula $\left(G,k\right)$
\end_inset

 כך שבגרף 
\begin_inset Formula $G$
\end_inset

 יש קליק מגודל 
\begin_inset Formula $k$
\end_inset

 לכל הפחות.
\end_layout

\begin_layout Standard
קל לראות כי 
\begin_inset Formula $\text{IS}\le_{p}\text{CLIQUE}$
\end_inset

 על ידי הרדוקציה שמעבירה את הגרף 
\begin_inset Formula $G=\left(V,E\right)$
\end_inset

 לגרף 
\begin_inset Formula $\left(V,E^{\prime}\right)$
\end_inset

 כך ש-
\begin_inset Formula $E^{\prime}=\left\{ \left(u,v\right)\ |\ \left(u,v\right)\notin E\right\} $
\end_inset

 ומשאירה את 
\begin_inset Formula $k$
\end_inset

 ללא שינוי.
 אותה רדוקציה בדיוק מראה גם כי 
\begin_inset Formula $\text{CLIQUE}\le_{p}\text{IS}$
\end_inset

.
 כלומר, די להראות שאחת משפות אלו היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה כדי להראות זאת עבור שתיהן.
\end_layout

\begin_layout Standard
נראה רדוקציה 
\begin_inset Formula $\text{VC}\le_{p}\text{IS}$
\end_inset

: 
\begin_inset Formula $f\left(G,k\right)=\left(G,\left|V\right|-k\right)$
\end_inset

.
\end_layout

\begin_layout Standard
על מנת לראות את נכונות הרדוקציה, נשים לב לכך שאם 
\begin_inset Formula $A$
\end_inset

 היא כיסוי בצמתים של 
\begin_inset Formula $V$
\end_inset

, אז 
\begin_inset Formula $V\backslash A$
\end_inset

 היא קבוצה בלתי תלויה.
 זאת מכיוון שלכל קשת 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

, או ש-
\begin_inset Formula $u\in A$
\end_inset

 או ש-
\begin_inset Formula $v\in A$
\end_inset

 )מהגדרת כיסוי בצמתים( כך שלא ייתכן ש-
\begin_inset Formula $u,v\in V\backslash A$
\end_inset

 שניהם.
\end_layout

\begin_layout Standard
אם כן, בגרף יש כיסוי בצמתים מגודל לכל היותר 
\begin_inset Formula $k$
\end_inset

 אם ורק אם יש בו קבוצה בלתי תלויה מגודל 
\begin_inset Formula $\left|V\right|-k$
\end_inset

 לפחות, כנדרש.
\end_layout

\begin_layout Subsubsection
השפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
3COL
\end_layout

\begin_layout Standard
נגדיר 
\begin_inset Formula $k$
\end_inset

-צביעה של גרף לא מכוון בתור פונקציה 
\begin_inset Formula $f:V\to\left\{ 1,2,\ldots,k\right\} $
\end_inset

 כך שלכל 
\begin_inset Formula $\left(u,v\right)\in E$
\end_inset

 מתקיים 
\begin_inset Formula $f\left(u\right)\ne f\left(v\right)$
\end_inset

.
\end_layout

\begin_layout Standard
נאמר שגרף הוא 
\begin_inset Formula $k$
\end_inset

-צביע אם קיימת לו 
\begin_inset Formula $k$
\end_inset

-צביעה.
\end_layout

\begin_layout Standard
נגדיר את השפה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
3COL
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בתור שפת הגרפים ה-
\numeric on
3
\numeric off
-צביעים.
 נוכיח שבעיה זו היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-קשה על ידי רדוקציה 
\begin_inset Formula $\text{3SAT}\le_{p}\text{3COL}$
\end_inset

 )לעומת זאת, 
\begin_inset Formula $\text{2COL}\in\text{P}$
\end_inset

(.
\end_layout

\begin_layout Standard
הרעיון הוא בניה של גרף שבו יהיו צמתים עבור כל משתנה וליטרל שלו, בדומה לכיסוי
 בצמתים, כך שמבין שלושת הצבעים שבהם הגרף נצבע, צבע אחד ייצג את
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
T
\lang hebrew
, שני את
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ושלישי יהיה 
\begin_inset Quotes eld
\end_inset

נייטרלי
\begin_inset Quotes erd
\end_inset

 ולא ישתתף בצביעה של צמתי הליטרלים.
 בנוסף, לכל פסוקית נבנה תת-גרף שיהיה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
צביע אם ורק אם אחד מצמתי הליטרלים שמחוברים לתת-הגרף צבוע בצבע של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
T
\lang hebrew
.
\end_layout

\begin_layout Standard
המבנה הכללי של הגרף, ללא תיאור של רכיבי הפסוקיות לעת עתה, הוא זה:
\end_layout

\begin_layout Standard
ראשית יהיו בגרף צמתים לכל ליטרל כך שזוג הצמתים שמתאימים לאותו משתנה מחוברים
 בקשת כך שמובטח שייצבעו בצבעים שונים )שהולכים לייצג את
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
T
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\lang english
F
\lang hebrew
( שנית, נוסיף לגרף צומת מיוחד, 
\begin_inset Quotes eld
\end_inset


\lang english
G
\lang hebrew

\begin_inset Quotes erd
\end_inset

 )
\begin_inset Quotes erd
\end_inset

קרקע
\begin_inset Quotes erd
\end_inset

( שיחובר לכל צמתי הליטרלים ובכך יהיה מובטח שהצבע שלו )שעליו נחשוב כ
\begin_inset Quotes erd
\end_inset

נייטרלי
\begin_inset Quotes erd
\end_inset

( יהיה שונה מהצבעים של צבעי הליטרלים.
 כמו כן נוסיף עוד צומת מיוחד 
\lang english

\begin_inset Quotes eld
\end_inset

S
\begin_inset Quotes erd
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)
\begin_inset Quotes erd
\end_inset

שמיים
\begin_inset Quotes erd
\end_inset

( שיחובר אל הקרקע ובכך יהיה מובטח שצבעו ייצג את אחד מערכי האמת.
 נבחר לחשוב על הצבע של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
S
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בתור ערך האמת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ובהתאם לכך נבנה את רכיבי הפסוקיות.
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename images/3col-A.PNG
	scale 50

\end_inset


\end_layout

\begin_layout Standard
כדי להבין איך נבנה רכיב פסוקית, ראשית נביט בדוגמא פשוטה יותר, עבור פסוקית
 בת שני ליטרלים.
 אנו רוצים לבנות רכיב בעל שני צמתי 
\begin_inset Quotes eld
\end_inset

כניסה
\begin_inset Quotes erd
\end_inset

 )אלו יהיו צמתי הליטרלים עצמם( וצומת 
\begin_inset Quotes eld
\end_inset

יציאה
\begin_inset Quotes erd
\end_inset

 כך שמתקיים:
\end_layout

\begin_layout Itemize
אם לפחות אחד מצמתי הכניסה צבוע ב-
\lang english
T
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אז קיימת צביעה של הרכיב שבו צומת היציאה צבוע ב-
\lang english
T
\end_layout

\begin_layout Itemize
אם שני צמתי הכניסה צבועים ב-
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אז בכל צביעה של הרכיב צומת היציאה צבוע ב-
\lang english
F
\end_layout

\begin_layout Standard
האפקט המבוקש מושג על ידי חיבור של 
\series bold
משולש
\series default
 לשני צמתי הקלט:
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename images/3col-B.PNG
	scale 50

\end_inset


\end_layout

\begin_layout Standard
אם שני צמתי הקלט צבועים באותו צבע, אז שני הצמתים שמעליהם יהיו חייבים להיות
 צבועים בשני הצבעים האחרים )כאן הצבע השלישי, ה
\begin_inset Quotes erd
\end_inset

נייטרלי
\begin_inset Quotes erd
\end_inset

 של הצביעה בא לידי ביטוי( ואז הצומת העליון יהיה חייב להיות צבוע באותו צבע
 כמו צמתי הקלט.
 לעומת זאת, אם שני צמתי הקלט צבועים בצבעים שונים )כלומר, אחד הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
T
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
והשני הוא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\lang hebrew
( אז עדיין 
\series bold
אפשר
\series default
 לצבוע את שני הצמתים שמעליהם ב-
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
והצבע הנייטרלי: נצבע את הצומת שמחובר ל-
\lang english
T
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 ב-
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ואת הצומת שמחובר ל-
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בצבע הנייטרלי.
 זה יאפשר לנו לצבוע את הצומת העליון ב-
\lang english
T
\lang hebrew
.
\end_layout

\begin_layout Standard
כעת ננקוט באותו תעלול עבור 
\series bold
שלושה
\series default
 ליטרלי קלט פשוט על ידי שימוש כפול ברכיב שהצגנו: נבנה את הרכיב על שניים
 משלושת צמתי הקלט, ואז נשתמש בפלט שלו בתור צומת קלט נוסף לעותק של הרכיב,
 כשהליטרל השלישי הוא צומת הקלט השני:
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename images/3col-C.PNG
	scale 50

\end_inset


\end_layout

\begin_layout Standard
כל שנותר הוא לרכב את הרכיבים הללו לגרף שכבר בנינו - הקלטים יהיו צמתי הליטרלים,
 והפלטים יחוברו כולם אל
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
S
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כדי להבטיח שאם אחד מהפלטים יקבל את הערך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\lang hebrew
, הצביעה של הגרף תיהרס )כי
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הוא הרי צבעו של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
S
\lang hebrew
(.
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename images/3col-D.PNG
	scale 50

\end_inset


\end_layout

\begin_layout Standard
שימו לב כי ה-
\numeric on
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
3SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
וה-
\numeric on
3
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
3COL
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
התבטאו בבניה בדרכים שונות לגמרי; עבור
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
3COL
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
הדבר התבטא בכך שיכלנו להשתמש בצבע 
\begin_inset Quotes eld
\end_inset

נייטרלי
\begin_inset Quotes erd
\end_inset

 ובכך לבנות את הרכיבים שמדמים חישוב של ערך האמת של פסוקיות; ה-
\lang english
3
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
3SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
התבטא בכך שהרכיבים הללו הם פשוטים יחסית ומורכבים משרשור בודד של הרכיב לשני
 ליטרלים על עצמו )עבור פסוקיות של 
\begin_inset Formula $k$
\end_inset

 ליטרלים היינו נזקקים ל-
\begin_inset Formula $k-2$
\end_inset

 שרשורים שכאלו(.
\end_layout

\begin_layout Subsubsection
תכנון בשלמים
\end_layout

\begin_layout Standard
בעיית 
\series bold
תכנון לינארי
\series default
 )
\lang english
Linear programming
\lang hebrew
( היא בעיית אופטימיזציה תחת אילוצים.
 למשל, בעיה מהצורה 
\begin_inset Quotes eld
\end_inset

מצאו 
\begin_inset Formula $x,y,z$
\end_inset

 שממקסמים את הפונקציה 
\begin_inset Formula $2x+3y+5z$
\end_inset

 תחת האילוצים 
\begin_inset Formula $x+y\le4$
\end_inset

 ו-
\begin_inset Formula $1\le x+z$
\end_inset


\begin_inset Quotes erd
\end_inset

.
 ה
\series bold
לינאריות
\series default
 בשם הבעיה נובעת מכך שפונקציית המטרה והאילוצים הם כולם לינאריים במשתנים.
\end_layout

\begin_layout Standard
ניסוח כללי לבעיית תכנון לינארי הוא זה:
\end_layout

\begin_layout Standard
מצאו וקטור 
\begin_inset Formula $x\in\mathbb{R}^{n}$
\end_inset


\end_layout

\begin_layout Standard
אשר ממקסם את 
\begin_inset Formula $c\cdot x$
\end_inset

 עבור 
\begin_inset Formula $c\in\mathbb{R}^{n}$
\end_inset

 )
\begin_inset Formula $c$
\end_inset

 מגדיר את פונקציית המטרה(
\end_layout

\begin_layout Standard
תחת האילוצים 
\begin_inset Formula $Ax\le b$
\end_inset

 עבור 
\begin_inset Formula $A\in\mathbb{R}^{m\times n}$
\end_inset

 ו-
\begin_inset Formula $b\in\mathbb{R}^{m}$
\end_inset

 )
\begin_inset Formula $A$
\end_inset

 ו-
\begin_inset Formula $b$
\end_inset

 מגדירים 
\begin_inset Formula $m$
\end_inset

 אילוצי אי שוויונים שונים(
\end_layout

\begin_layout Standard
בעיית התכנון הלינארי היא בעיה מרכזית במדעי המחשב וקיימים שלל אלגוריתמים
 לפתרונה, כולל אלגוריתמים פולינומיים.
 אלגוריתמים אלו מסתמכים על היכולת של המשתנים 
\begin_inset Formula $x$
\end_inset

 להכיל ערכים 
\series bold
שבריים
\series default
; כאשר דורשים שהערכים של ה-
\begin_inset Formula $x$
\end_inset

-ים יהיו מספרים 
\series bold
שלמים
\series default
, אפילו בעיית ההכרעה המתאימה )לבדוק אם קיים פתרון כלשהו שעונה על האילוצים,
 בלי למקסם פונקציית מטרה( הופכת ל-
\lang english
NP
\lang hebrew
-שלמה, וזאת אפילו אם מגבילים את ערכי המשתנים להיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
ו-
\numeric on
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בלבד.
\end_layout

\begin_layout Standard
נסמן ב-
\lang english
ILP
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
את השפה המתאימה: שפת כל הזוגות 
\begin_inset Formula $\left(A,b\right)$
\end_inset

 כך שקיים פתרון 
\begin_inset Formula $x\in\mathbb{Z}^{n}$
\end_inset

 לאילוצים 
\begin_inset Formula $Ax\le b$
\end_inset

.
\end_layout

\begin_layout Standard
נראה רדוקציה פולינומית 
\begin_inset Formula $\text{3SAT}\le_{p}\text{ILP}$
\end_inset

:
\end_layout

\begin_layout Standard
יהא 
\begin_inset Formula $\varphi$
\end_inset

 פסוק
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
3CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כלשהו.
 יהיו 
\begin_inset Formula $x_{1},\ldots,x_{n}$
\end_inset

 המשתנים שמופיעים בו; אלו יהיו גם משתני בעיית התכנון בשלמים שלנו.
 הרעיון יהיה שהשמה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
0
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בהם תתורגם להשמה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
F
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
והשמה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
1
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
תתורגם להשמה של
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
T
\lang hebrew
.
\end_layout

\begin_layout Standard
ראשית, לכל משתנה 
\begin_inset Formula $x_{i}$
\end_inset

 שמופיע בפסוק ה-
\lang english
CNF
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
נוסיף שני אי שווינים:
\end_layout

\begin_layout Standard
\begin_inset Formula $x_{i}\le1$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $0\le x_{i}$
\end_inset

 )פורמלית, אי שוויון זה הוא 
\begin_inset Formula $-x_{i}\le0$
\end_inset

(
\end_layout

\begin_layout Standard
נדגים תרגום של פסוקית לאי שוויון: למשל עבור הפסוקית 
\begin_inset Formula $\left(x_{1}\vee\neg x_{2}\vee x_{3}\right)$
\end_inset

 נבנה את אי השוויון
\end_layout

\begin_layout Standard
\begin_inset Formula $x_{1}+\left(1-x_{2}\right)+x_{3}\ge1$
\end_inset


\end_layout

\begin_layout Standard
ובאופן דומה כל פסוקית תתורגם לסכום של שלושה ביטויים כאשר כל ביטוי הוא או
 משתנה 
\begin_inset Formula $x$
\end_inset

 )אם הליטרל המקורי היה 
\begin_inset Formula $x$
\end_inset

( או 
\begin_inset Formula $1-x$
\end_inset

 )אם הליטרל המקורי היה 
\begin_inset Formula $\neg x$
\end_inset

(
\end_layout

\begin_layout Subsection
המשמעות של 
\begin_inset Quotes eld
\end_inset

קושי
\begin_inset Quotes erd
\end_inset

 בעיות
\family roman
\series bold
\shape up
\size large
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-קשות
\end_layout

\begin_layout Standard
לסיום הנושא, יש צורך להבהיר מה בעצם משמעות התוצאות שראינו.
\end_layout

\begin_layout Standard
הוכחנו עבור מספר בעיות שהן
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמות.
 המשמעות הפרקטית של הוכחה כזו היא: 
\begin_inset Quotes eld
\end_inset

אין טעם לחפש אלגוריתם שפותר את הבעיה ביעילות במקרה הגרוע ביותר
\begin_inset Quotes erd
\end_inset

, כדוגמת היתר האלגוריתמים שראינו במהלך הקורס.
 אמנם, אלגוריתם כזה 
\series bold
עשוי
\series default
 להתקיים, אולם מציאה שלו תפתור בעיה פתוחה מרכזית במדעי המחשב מזה כ-
\numeric on
50
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שנים שהאמונה הרווחת היא שהפתרון שלה הוא 
\series bold
הפוך
\series default
.
 דהיינו, אפילו אם אלגוריתם כזה קיים מציאה שלו תהיה קשה ביותר וכלל לא מובטח
 שהוא יהיה שימושי בפועל.
\end_layout

\begin_layout Standard
האם מכך ניתן להסיק שאם בעיה היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה אז אפשר לאבד כל תקווה לפתרון שלה? 
\series bold
חד משמעית לא
\series default
.
\end_layout

\begin_layout Standard
בכל הקורס עסקנו בניתוח סיבוכיות 
\series bold
במקרה הגרוע ביותר
\series default
, אולם בשימושים פרקטיים לא בהכרח צץ המקרה הגרוע ביותר, ודאי שלא ברוב הפעמים
 שבהן האלגוריתם מופעל.
 אם אלגוריתם רץ היטב על
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\numeric on
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
99
\family roman
\series medium
\shape up
\size normal
\emph off
\numeric off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אחוז מהקלטים שצצים בשימושים פרקטיים, הוא ימצא שימוש פרקטי גם אם אין לנו
 ביסוס תיאורטי לטיב שלו.
\end_layout

\begin_layout Standard
כזה הוא בדיוק המצב בתחום שעוסק באלגוריתמים שפותרים את בעיית
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT
\lang hebrew
, שמכונים
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT-solvers
\lang hebrew
.
 אלגוריתמים אלו לרוב מבצעים וריאציה על אלגוריתם
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
DPLL
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
שהוא אלגוריתם אקספוננציאלי לפתרון
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
בעזרת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
Backtracking
\lang hebrew
.
 וריאציות חכמות על שיטה בסיסית זו כדוגמת
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
CDCL
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
)
\lang english
Conflict-driven clause learning
\lang hebrew
( רצות היטב בפועל על מקרים פרקטיים רבים, אף שלא קשה להנדס קלט שעליהן הן
 ייכשלו בצורה מביכה )וגם על מקרים פרקטיים רבים הן נכשלות, כמובן(.
\end_layout

\begin_layout Standard
מכיוון שבעיות רבות ניתנות לתרגום לבעיית
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT
\lang hebrew
, ניתן להשתמש ב-
\lang english
SAT solvers
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
כדי לפתור בעיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמות עבור מקרים פרקטיים רבים.
 בנוסף, עבור גדלי קלט 
\begin_inset Quotes eld
\end_inset

סבירים
\begin_inset Quotes erd
\end_inset

 אפילו אלגוריתמים פשוטים למדי יעבדו - דוגמא קלאסית היא 
\series bold
סודוקו
\series default
 שבגרסתו הכללית הוא בעיה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה אך ניתן בנקל לתכנת אלגוריתם שיפתור מהר את גרסת ה-
\begin_inset Formula $9\times9$
\end_inset

 הנפוצה שלו.
\end_layout

\begin_layout Standard
שאלה מעניינת אחרת היא האם אלגוריתמים 
\series bold
הסתברותיים
\series default
 יכולים לפתור ביעילות בעיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמות גם במקרה הגרוע ביותר )דהיינו, זמן הריצה שלהם יהיה פולינומי במקרה
 הגרוע ביותר, והם יטעו רק, נאמר, ב-
\begin_inset Formula $\frac{1}{3}$
\end_inset

 מן ההרצות שלהם(.
 בלשון תורת הסיבוכיות זוהי השאלה האם 
\begin_inset Formula $\text{NP}\subseteq\text{BPP}$
\end_inset

, שהיא שאלה פתוחה בימינו )אם כי גם עבורה ההשערה היא שהתשובה היא שלילית(.
\end_layout

\begin_layout Standard
נקודה אחרת שיש לתת עליה את הדעת היא שלא כל בעיה קשה ב-
\lang english
NP
\lang hebrew
 חייבת להיות
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה.
 הדוגמא הקלאסית היא בעיית 
\series bold
הפירוק לגורמים
\series default
 שלא ידוע לה אלגוריתם יעיל )אפילו לא ברמה הפרקטית ולא במובן של המקרה הגרוע
 ביותר( אך אין הוכחה שהיא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה וההשערה הרווחת היא שהיא אינה כזו.
 מאחר ואם 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

 אז כל שפה )למעט השפה הריקה ושפת כל המילים( ב-
\lang english
NP
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
היא
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה, לא נוכח להוכיח שפירוק לגורמים אינה בעיה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה מבלי לפתור את שאלת 
\begin_inset Formula $\text{P}=\text{NP}$
\end_inset

 
\begin_inset Quotes eld
\end_inset

על הדרך
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
עם זאת, עדיין ניתן לשאול את השאלה - אם 
\series bold
נניח
\series default
 ש-
\begin_inset Formula $\text{P}\ne\text{NP}$
\end_inset

, האם ניתן להוכיח כעת כי פירוק לגורמים אינה
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
NP
\lang hebrew
-שלמה? זוהי עדיין שאלה פתוחה, אך ידועות שפות אחרות, שנבנות בצורה מלאכותית
 מתוך
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
\lang english
SAT
\lang hebrew
, כך שאם 
\begin_inset Formula $\text{P}\ne\text{NP}$
\end_inset

 אז הן לא ב-
\lang english

\begin_inset Formula $\text{P}$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\lang hebrew
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color inherit
אך גם אינן 
\begin_inset Formula $\text{NP}$
\end_inset

-שלמות )זוהי תוצאה של 
\series bold
משפט לדנר
\series default
(.
\end_layout

\end_body
\end_document
