---
id: 3096
title: "טורי פורייה - מה זה בכלל?"
date: 2014-04-28 22:39:20
layout: post
categories: 
  - אנליזה מתמטית
tags: 
  - טורי פורייה
js_libraries:
  - flot/jquery.flot
social_media_share: true
---
מתמטיקאים אוהבים לפרק דברים לגורמים. כל מספר טבעי קל יותר להבין אם מפרקים אותו למכפלה של ראשוניים. גם עם פונקציות ממשיות זה עובד כך - אחד מהדברים האהובים על מתמטיקאים הוא לקחת פונקציה ממשית {% equation %}f\left(x\right){% endequation %} ולכתוב אותה בתור <strong>טור חזקות</strong>: {% equation %}f\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n}{% endequation %}. בצורה הזו הפונקציה נכתבת כסכום אינסופי של פונקציות פשוטות במיוחד - {% equation %}x^{n}{% endequation %} - כשלכל פונקציה פשוטה שכזו יש <strong>מקדם</strong>, {% equation %}a_{n}{% endequation %}, שהוא מספר ממשי שמלמד אותנו עד כמה הרכיב {% equation %}x^{n}{% endequation %} משתתף בסכום שמהווה את {% equation %}f\left(x\right){% endequation %}. אם אנחנו יודעים ייצוג של {% equation %}f\left(x\right){% endequation %} כטור חזקות קל מאוד לעשות איתה דברים מסויימים - למשל, כדי לגזור אותה די לנו לגזור את הטור "איבר איבר", ואת זה קל מאוד לעשות כי אנחנו יודעים איך גוזרים פונקציה פשוטה כמו {% equation %}x^{n}{% endequation %} - מקבלים {% equation %}f^{\prime}\left(x\right)=\sum_{n=1}^{\infty}na_{n}x^{n-1}{% endequation %}. באופן דומה גם אינטגרל לפונקציה ניתן לתיאור על ידי ביצוע אינטגרציה לטור "איבר איבר". אמנם, לא כל פונקציה אפשר לתאר כטור שכזה, ולא תמיד קל למצוא את הטור, אבל זו המחשה פשוטה ונאה לכוח שבפירוק שכזה.

הטור שתיארתי כרגע נקרא <strong>טור טיילור</strong>, והוא לחלוטין לא האופן היחיד שבו ניתן לפרק פונקציה לגורמים. הדרך שאני רוצה לתאר כעת, שהומצאה בידי פורייה, מפרקת את הפונקציה לרכיבים שמצד אחד אינם פשוטים כמו {% equation %}x^{n}{% endequation %}, ומצד שני הם מעניינים יותר במובן מסויים - פונקציות מחזוריות; ספציפית, <strong>סינוסים וקוסינוסים</strong>. הפירוק הזה נותן לנו דרך התבוננות חדשה על פונקציות, שלעתים קרובות מאוד נותנת לנו תובנות חדשות עליהן; ללא צל של ספק, הפירוק הזה של פורייה הוא אחד מהרעיונות הפורים והחשובים ביותר במתמטיקה. בפוסט הזה (ובהמשכיו) אני רוצה לתת תיאור על קצה המזלג שלו. מראש אזהיר ש<strong>אני לא מראה שימושים כאן</strong>, למרות שכאמור - יש אינספור שימושים. אחת מהסיבות שבגללן אני כותב את הפוסט הזה היא כדי שאוכל בעתיד להציג תוצאות שעושות שימוש בסוג כלשהו של אנליזת פורייה ואוכל להפנות לכאן בשביל הבסיס.

עוד אזהרה היא שהפוסט הזה <strong>מניח ידע קודם במתמטיקה</strong>, ספציפית ידע כלשהו באלגברה לינארית ובחשבון אינפיניטסימלי וטיפה על מרחבי הילברט. זה מצער אותי מאוד, אבל טורי פורייה הם פשוט לא נושא שאפשר להציג בצורה טובה, לטעמי, בלי להיכנס לפרטים הטכניים שלהם (שדורשים אינפי) ובלי להציג קצת מהתמונה הגדולה שסביבם (שדורשת אלגברה).

דבר אחד שצריך להבין כשמדברים על אנליזת פורייה הוא שמדובר על תחום רחב, עם המון גרסאות שונות שעמוק בפנים הן כולן נובעות מאותו בסיס משותף. אם שמעתם על פורייה יש סיכוי לא רע ששמעתם לפחות על שלושה דברים: <strong>טורי פורייה</strong>, <strong>התמרת פורייה</strong> ו<strong>התמרת פורייה הבדידה.</strong> אלו שלושה דברים שונים, אבל עם קשרים מאוד חזקים ביניהם. אני הולך בפוסטים הקרובים לדבר על כולם ולהציג את הקשרים הללו, אבל לפחות בינתיים אני לא הולך עמוק מכך לתיאוריה הכללית יותר - אז קחו בחשבון שאנחנו רק מגרדים פה את פני השטח. בפוסט הזה אני הולך לדבר רק על טורי פורייה, אז לעת עתה נשכח מכך שאמורים להיות עוד סוגים.

נתחיל מהכוכבים שלנו - הפונקציות הטריגונומטריות, סינוס וקוסינוס. <a href="http://www.gadial.net/2010/03/31/sine_and_cosine_via_ode/">כבר הצגתי אותן פעם בבלוג</a> בצורה שאני מחשיב לצורה ה"נכונה" להסתכל עליהן - בתור הפתרונות הבסיסיים של משוואה דיפרנציאלית חשובה מסויימת. אולי התכונה הבולטת ביותר של שתי הפונקציות הללו היא שהן <strong>מחזוריות</strong>, עם מחזור של {% equation %}2\pi{% endequation %}; באופן כללי, פונקציה {% equation %}f{% endequation %} היא מחזורית עם מחזור {% equation %}a{% endequation %} אם {% equation %}f\left(x\right)=f\left(x+a\right){% endequation %}. כעת נשאלת השאלה - אילו פונקציות מחזוריות אפשר לכתוב בתור צירוף לינארי כזה של סינוסים וקוסינוסים?

התשובה - וזו תשובה די מפתיעה - היא ש<strong>הרבה</strong>.

אני הולך לדבר רק על פונקציות עם מחזור של {% equation %}2\pi{% endequation %}, אבל זה לא באמת מגביל אותי - אפשר את מה שאני עושה כאן להכליל לפונקציות עם מחזורים שונים עם תיקונים קטנים בלבד. כמו כן, אם {% equation %}f:\mathbb{R}\to\mathbb{R}{% endequation %} היא פונקציה מחזורית, אין לי צורך אמיתי להתעסק עם כל {% equation %}\mathbb{R}{% endequation %} בתור התחום שלה - מספיק לי להבין את הפונקציה הזו בתוך קטע מאורך {% equation %}2\pi{% endequation %} כדי שאבין אותה בכל הישר הממשי (כי ההתנהגות שלה מחוץ לקטע הזה זהה להתנהגות שלה בתוך הקטע). לכן אני הולך לדבר מעכשיו על פונקציות כלשהן {% equation %}f:\left[-\pi,\pi\right]\to\mathbb{R}{% endequation %}, והשאלה שלי היא מתי אפשר להציג אותן בתור צירוף לינארי של סינוסים וקוסינוסים. כעת, מכיוון שאני מדבר על מרחב של פונקציות ממשיות, הרי שזה לא מרחב סוף-ממדי; וכבר<a href="http://www.gadial.net/2014/02/19/orthonormal_basis_in_hilbert_space/"> דיברתי בבלוג</a> על כך שזה עושה לנו בעיות אם אנחנו רוצים להסתפק בצירופים לינאריים <strong>סופיים</strong> ואנחנו מעדיפים לדבר על צירופים לינארים אינסופיים. מה יהיו אברי הבסיס שלי? סינוסים וקוסינוסים, אבל לא רק {% equation %}\sin x{% endequation %} ו-{% equation %}\cos x{% endequation %} אלא {% equation %}\sin nx{% endequation %} ו-{% equation %}\cos nx{% endequation %} לכל {% equation %}n{% endequation %} טבעי. בלשון של מרחבי הילברט, אני רוצה לטעון שקבוצת הפונקציות הללו היא <strong>מערכת אורתונורמלית שלמה</strong> במרחב של פונקציות שהן "נחמדות מספיק". בשביל להשתמש במושג כמו "אורתונורמליות" אני צריך להגדיר מכפלה פנימית, אז הנה היא:

{% equation %}\left\langle f,g\right\rangle =\int_{-\pi}^{\pi}f\left(x\right)g\left(x\right)dx{% endequation %}

והמרחב שלי יכלול את כל הפונקציות שההגדרה הזו "עובדת" בשבילן - כלומר, כל הפונקציות שמקיימות {% equation %}\int_{-\pi}^{\pi}f^{2}\left(x\right)dx&lt;\infty{% endequation %}.

כדי לפשט חישובים בהמשך, בואו ניזכר בכמה תכונות של סינוסים וקוסינוסים. ראשית כל, סינוס הוא מה שנקרא <strong>פונקציה אי זוגית</strong>, ואילו קוסינוס הוא מה שנקרא <strong>פונקציה זוגית</strong>. פונקציה אי זוגית היא פונקציה שמקיימת {% equation %}f\left(-x\right)=-f\left(x\right){% endequation %} ופונקציה זוגית היא פונקציה שמקיימת {% equation %}f\left(-x\right)=f\left(x\right){% endequation %}. לפונקציות אי זוגיות שאינטגרביליות בתחום מסויים שהוא סימטרי סביב הראשית יש את התכונה הנחמדה שהאיטגרל שלהן הוא 0, כי

{% equation %}\int_{-a}^{a}f\left(x\right)dx=\int_{0}^{a}f\left(x\right)dx+\int_{-a}^{0}f\left(x\right)dx=\int_{0}^{a}f\left(x\right)dx+\int_{0}^{a}f\left(-x\right)dx={% endequation %}

{% equation %}=\int_{0}^{a}f\left(x\right)dx-\int_{0}^{a}f\left(x\right)dx=0{% endequation %}

מה שאומר שבפרט, במקרה שלנו, {% equation %}\int_{-\pi}^{\pi}\sin nxdx=0{% endequation %}. עכשיו, קוסינוס זה סיפור די דומה אבל לא זהה. בגלל שהוא פונקציה זוגית, אז {% equation %}\int_{-\pi}^{\pi}\cos nxdx=2\int_{0}^{\pi}\cos nxdx{% endequation %}. בואו נזכור שקוסינוס הוא בסך הכל סינוס שנתנו לו יתרון של {% equation %}\frac{\pi}{2}{% endequation %} במירוץ, כלומר {% equation %}\cos x=\sin\left(x+\frac{\pi}{2}\right){% endequation %} ובאופן כללי יותר, {% equation %}\cos nx=\sin\left(nx+\frac{\pi}{2}\right){% endequation %}. זה אומר שקוסינוס הוא פונקציה אי-זוגית אם מסתכלים עליו סביב הנקודה {% equation %}\frac{\pi}{2}{% endequation %} ולא סביב 0, ולכן {% equation %}\int_{0}^{\pi}\cos nxdx=0{% endequation %}.

הדבר האחרון שצריך לזכור הוא את הזהויות הטריגונומטריות הנוגעות למכפלה של סינוסים וקוסינוסים. הנה הן:

{% equation %}\sin x\sin y=\frac{\cos\left(x-y\right)-\cos\left(x+y\right)}{2}{% endequation %}.

{% equation %}\cos x\cos y=\frac{\cos\left(x-y\right)+\cos\left(x+y\right)}{2}{% endequation %}.

{% equation %}\sin x\cos y=\frac{\sin\left(x+y\right)+\sin\left(x-y\right)}{2}{% endequation %}.

כל הזהויות הללו עושות באופן כללי את אותו הדבר - הופכות מכפלה של שני סינוסים או שני קוסינוסים לסכום-עם-מקדמים של סינוסים וקוסינוסים בודדים (שלא מוכפלים באף אחד).

עכשיו קל לראות שכל הסינוסים והקוסינוסים הללו אורתוגונליים אחד לשני. {% equation %}\int_{-\pi}^{\pi}f\left(x\right)g\left(x\right)dx{% endequation %} כאשר {% equation %}f,g{% endequation %} הם סינוסים או קוסינוסים הולך להפוך לסכום אינטגרלים של כמה סינוסים וקוסינוסים וכבר ראינו שכל האינטגרלים הללו יצאו 0. אתם מוזמנים לנסות כמה מקרים באופן מפורש כדי להשתכנע. יש רק מקרה אחד שבו זה יכול להשתבש - כאשר אנחנו כופלים פונקציה <strong>בעצמה.</strong> במקרה הזה, נקבל בנוסחאות {% equation %}\cos\left(x-x\right)=\cos0=1{% endequation %} ולכן נקבל אינטגרל שונה מאפס. למשל:

{% equation %}\left\langle \sin nx,\sin nx\right\rangle =\int_{-\pi}^{\pi}\sin nx\sin nxdx=\frac{1}{2}\int_{-\pi}^{\pi}\left(1-\cos nx\right)=\frac{1}{2}\cdot2\pi=\pi{% endequation %}

באופן דומה, נקבל {% equation %}\pi{% endequation %} גם עבור קוסינוס. אבל רגע, זה לא מה שאנחנו רוצים, אם אנחנו רוצים בסיס אורתונורמלי! אנחנו רוצים לקבל 1! לכן מה שנעשה הוא לתקן קצת את המכפלה הפנימית - ההגדרה ה"נכונה" היא זו:

{% equation %}\left\langle f,g\right\rangle =\frac{1}{\pi}\int_{-\pi}^{\pi}f\left(x\right)g\left(x\right)dx{% endequation %}

עכשיו כל הפונקציות הטריגונומטריות הן אורתונורמליות - כמעט. נשאר לנו עדיין המקרה של {% equation %}\cos\left(0x\right)=1{% endequation %}. דווקא הפונקציה התמימה הזו אינה אורתונורמלית, כי {% equation %}\frac{1}{\pi}\int_{-\pi}^{\pi}dx=2{% endequation %}. כדי לקבל פונקציה קבועה אורתונורמלית אצטרך לקחת את {% equation %}\frac{\sqrt{2}}{2}{% endequation %} שלא נראית טוב במיוחד, אז מה עושים? נדבוק ב-{% equation %}\cos\left(0x\right){% endequation %} ופשוט יהיה לו מקדם קצת מוזר, כפי שתכף נראה.

עכשיו אנחנו מרוצים - הקבוצה {% equation %}\left\{ \sin nx\ |\ n\in\mathbb{N}\right\} \cup\left\{ \cos nx\ |\ n\in\mathbb{N}\right\} {% endequation %} היא סדרה אורתונורמלית במרחב שלנו (שוב, למעט הקטע הזה עם הקבוע, שאינו בעייתי). אבל למעשה, היא יותר מזה - היא מה שקראתי לו <strong>סדרה אורתונורמלית שלמה</strong>, מה שאומר שאין איבר במרחב שאורתוגונלי לכל אבריה ושונה מאפס. ההוכחה של הטענה הזו מורכבת יותר ממה שעשיתי עד כה ואמנע ממנה לעת עתה כי זה פוסט מבוא שמנסה בעיקר להציג את הרעיונות ולא להוכיח דברים לעומק. מה שחשוב הוא המסקנה: <strong>כל</strong> פונקציה במרחב שלנו ניתנת לתיאור בתור צירוף לינארי אינסופי של אברי הקבוצה. את הצירוף הלינארי הזה נהוג לסמן בצורה הבאה:

{% equation %}f\left(x\right)=\frac{a_{0}}{2}+\sum_{n=1}^{\infty}a_{n}\cos nx+\sum_{n=1}^{\infty}b_{n}\sin nx{% endequation %}

אבל צריך להיות <strong>זהירים מאוד</strong> לגבי האופן שבו אנחנו קוראים את הביטוי הזה. הוא נראה כאילו הוא אומר שלכל {% equation %}x{% endequation %} שנציב באגף שמאל, נקבל את אותו מספר באגף ימין. זה <strong>לא נכון</strong>. השוויון פה אומר, פורמלית, שאם ניקח את אגף שמאל ונחסר ממנו את אגף ימין וניקח את הנורמה של כל זה במרחב שלנו, אז נקבל 0. זה מה שנקרא <strong>התכנסות בנורמה</strong>. השאלה מה קורה לכל {% equation %}x{% endequation %} - שאלת <strong>ההתכנסות הנקודתית</strong> - היא מורכבת יותר ואתייחס אליה בהמשך.

קרוב לודאי שאתם תוהים למה כתבתי את המקדם החופשי בתור {% equation %}\frac{a_{0}}{2}{% endequation %} ולא סתם בתור {% equation %}a_{0}{% endequation %} - זה נובע מהבעיה של המקדם החופשי שדיברתי עליה ותכף נראה למה זה פותר אותה. בואו נדבר עכשיו על השאלה הבוערת - איך מוצאים את המקדמים הללו עבור פונקציה {% equation %}f{% endequation %} קונקרטית? ובכן, מכיוון שהסדרה של הפונקציות הטריגונומטריות אורתונורמלית, אנחנו גם יודעים מה יהיו המקדמים: כזכור, אם {% equation %}e_{n}{% endequation %} הוא איבר של סדרה אורתונורמלית, אז המקדם שלו בצירוף הלינארי שנותן את {% equation %}f{% endequation %} הוא {% equation %}\left\langle f,e_{n}\right\rangle {% endequation %}. למקדם הזה קוראים - כמה הולם - <strong>מקדם פורייה</strong> של {% equation %}f{% endequation %} (ביחס לסדרה הספציפית שלנו). כלומר, אנחנו מקבלים את הנוסחאות הבאות:

{% equation %}a_{n}=\left\langle f,\cos nx\right\rangle =\frac{1}{\pi}\int_{-\pi}^{\pi}f\left(x\right)\cos nxdx{% endequation %}

{% equation %}b_{n}=\left\langle f,\sin nx\right\rangle =\frac{1}{\pi}\int_{-\pi}^{\pi}f\left(x\right)\sin nxdx{% endequation %}

הנוסחאות הללו עובדות עבור {% equation %}n\ge1{% endequation %}, אבל במקרה של {% equation %}a_{n}{% endequation %} הינדסנו את הכל כדי שהיא תעבוד גם עבור {% equation %}a_{0}{% endequation %}. מה שקורה הוא שמכיוון ש-{% equation %}1{% endequation %} אינה אורתונורמלית, אז {% equation %}\left\langle f,1\right\rangle {% endequation %} לא יחזיר את המקדם של {% equation %}1{% endequation %} בייצוג של {% equation %}f{% endequation %}, אלא את המקדם הזה כשהוא מוכפל בנורמה של 1, כלומר 2. כלומר המקדם צריך להיות {% equation %}\frac{a_{0}}{2}{% endequation %} שבו אנו משתמשים, והכתיב המוזר הזה משתלם לנו כי יש לנו נוסחה יחידה עבור {% equation %}a_{n}{% endequation %} בלי חלוקה למקרים.

עכשיו אפשר לשים את התיאוריה הכללית בצד לרגע ולראות מקרה פרטי, בעיניים. בלי לראות דוגמה קונקרטית ולהרגיש אותה כל העסק לא ממש שווה כלום, כי קשה לראות את ה"קסם". מה שנעשה הוא לקחת פונקציה פשוטה, אבל כזו שבכלל לא מזכירה סינוסים וקוסינוסים פרט לכך שהיא מחזורית, ולראות איך יוצא טור הפורייה שלה. יותר חשוב מכך - לראות איך הטור הזה נראה כשמציירים אותו.

הפונקציה בסך הכל תקבל את הערכים 1 ו-{% equation %}-1{% endequation %}, כשהיא מחליפה ביניהם אחרי מרחק של {% equation %}\pi{% endequation %}. כלומר, נגדיר

{% equation %}f\left(x\right)=\begin{cases}-1 & -\pi\le x&lt;0\\1 & 0\le x\le\pi\end{cases}{% endequation %}

וכמובן, אפשר להרחיב את הפונקציה הזו לכל {% equation %}\mathbb{R}{% endequation %} באופן מחזורי (כלומר, שיתקיים {% equation %}f\left(x+2\pi\right)=f\left(x\right){% endequation %}). התוצאה היא פונקציה שנראית כך:

<a href="{{site.baseurl}}{{site.post_images}}/2014/04/step_func.png"><img class="alignnone size-full wp-image-3097" src="{{site.baseurl}}{{site.post_images}}/2014/04/step_func.png" alt="step_func" width="864" height="473" /></a>

זה מזכיר את סינוס בכך שזו פונקציה מחזורית שהערכים המינימלי והמקסימלי שלה הם {% equation %}-1{% endequation %} ו-{% equation %}1{% endequation %}, אבל כאן הדמיון נגמר - סינוס עוברת בצורה רציפה בין כל הערכים שלה והפונקציה הזו לא; סינוס היא פונקציה עגולה ונחמדה, והפונקציה הזו ישרה. איך סכום של הרבה סינוסים יכול לתת לנו את הזוועה הזו?

ובכן, יש לנו נוסחה פשוטה לחישוב מקדמים, בואו נשתמש בה!

{% equation %}\left\langle f,\cos nx\right\rangle =\frac{1}{\pi}\int_{-\pi}^{\pi}f\left(x\right)\cos nx=\frac{1}{\pi}\left[\int_{-\pi}^{0}-\cos nxdx+\int_{0}^{\pi}\cos nxdx\right]{% endequation %}

{% equation %}=\frac{2}{\pi}\int_{0}^{\pi}\mbox{cos}nxdx=0{% endequation %}

קיבלנו 0 כי, כזכור, {% equation %}\mbox{cos}nx{% endequation %} הוא אנטיסימטרי סביב {% equation %}\frac{\pi}{2}{% endequation %} וכל זה. ומה יקרה עם סינוס?

{% equation %}\left\langle f,\sin nx\right\rangle =\frac{2}{\pi}\int_{0}^{\pi}\mbox{sin}nxdx=\frac{2}{\pi}\left[-\frac{\cos nx}{n}\right]_{0}^{\pi}=\frac{2}{\pi}\left[\frac{-\cos n\pi+1}{n}\right]{% endequation %}

עכשיו הכל תלוי בשאלה מהו {% equation %}\cos n\pi{% endequation %}. אם {% equation %}n{% endequation %} זוגי, אז {% equation %}\cos n\pi=1{% endequation %}; לעומת זאת, אם {% equation %}n{% endequation %} אי זוגי אז {% equation %}\cos n\pi=-1{% endequation %}. במקרה שבו {% equation %}n{% endequation %} זוגי המונה יתאפס ונקבל מקדם 0; במקרה השני נקבל {% equation %}\frac{4}{\pi n}{% endequation %}. אם לסכם:

{% equation %}\left\langle f,\sin nx\right\rangle =\begin{cases}\frac{4}{\pi n} & n\equiv_{2}1\\0 & n\equiv_{2}0\end{cases}{% endequation %}

ולכן אפשר לכתוב את טור הפורייה הבא:

{% equation %}f\left(x\right)=\frac{4}{\pi}\left(\sin x+\frac{1}{3}\sin3x+\frac{1}{5}\sin5x+\dots\right)=\frac{4}{\pi}\sum_{k=0}^{\infty}\frac{\sin\left(2k+1\right)x}{2k+1}{% endequation %}

ושוב, <strong>זו אינה התכנסות נקודתית</strong>! כלומר, השוויון שכתוב שם לא אומר שהשוויון מתקיים לכל {% equation %}x{% endequation %}. קל לראות את זה, למשל, על ידי הצבת {% equation %}x=0{% endequation %}: באגף שמאל נקבל {% equation %}1{% endequation %} על פי הגדרת {% equation %}f{% endequation %}, אבל באגף ימין נקבל 0. אז את השוויון צריך להבין בתור התכנסות בנורמה - כפי שכבר אמרתי, ההפרש בין שני האגפים שואף לאפס כאשר מספר המחוברים באגף ימין שואף לאינסוף, כשהשאיפה לאפס היא על פי הנורמה שנובעת מהמכפלה הפנימית שהצגנו קודם.

בואו ונראה איך נראה, למשל, סכום 15 האיברים הראשונים של הטור שבאגף ימין (בכחול):

<a href="{{site.baseurl}}{{site.post_images}}/2014/04/step_fourier_15.png"><img class="alignnone size-full wp-image-3098" src="{{site.baseurl}}{{site.post_images}}/2014/04/step_fourier_15.png" alt="step_fourier_15" width="858" height="463" /></a>

זה נראה די טוב! המבנה הכללי זהה לזה של הפונקציה שאנחנו מנסים לקרב עם הטור. ה-0 ב-{% equation %}x=0{% endequation %} די ברור כעת - זה בדיוק השלב שבו הטור (שמגדיר פונקציה רציפה) "מטייל" בין {% equation %}1{% endequation %} ל-{% equation %}-1{% endequation %}. הדבר היחיד שנראה קצת מציק הוא הצ'ופצ'יקים הבולטים בקצוות של הקטעים, בדיוק ליד נקודות אי-הרציפות של הפונקציה המקורית. הצ'ופצ'יקים הללו נמצאים שם לא במקרה - מדובר על תופעה שנקראת <strong>אפקט גיבס</strong> ואולי אתאר מתישהו בפוסט נפרד. לבינתיים, הנה משהו שחלקכם יוכלו לשחק איתו: גרסה אינטראקטיבית של הטור שבה אתם יכולים לבחור את כמות האיברים בסכום ולראות מה קורה - איך מתרחש הקסם שבו אוסף של סינוסים הופך לאט לאט למשהו שנראה בדיוק כמו {% equation %}f{% endequation %} (ושימו לב איך הקפיצה ליד נקודות אי הרציפות אמנם מתכווצת מבחינת הרוחב שלה, אבל הגובה שלה נותר תמיד מעל רמה מסויימת ולא טריוויאלית של שגיאה).
<div id="content"><div id="fourier_graph" class="demo-placeholder"></div></div>
<input id="n_slider" style="direction: ltr;" max="50" min="1" type="range" value="1" />

יש עוד נקודה שכדאי לתת עליה את הדעת בדוגמה שלי. אמרנו שטור פורייה הוא טור של סינוסים וקוסינוסים, אז איפה הקוסינוסים? ובכן, בחישוב הפורמלי ראינו שהמקדמים של כולם יצאו 0, אבל האם זה מקרי? כמובן שלא. {% equation %}f{% endequation %} שלנו היא בבירור פונקציה <strong>אנטי-סימטרית</strong> סביב {% equation %}x=0{% endequation %} כמעט בכל נקודה, בדיוק כמו סינוס עצמה. זה מבטיח שהמקדמים של {% equation %}\cos x{% endequation %} עבורה יצאו 0 ונקבל טור טיילור שהוא טור סינוסים בלבד. באופן דומה, פונקציה <strong>סימטרית </strong>תהיה בעלת טור קוסינוסים בלבד. בשני המקרים הסימטריה או האנטי-סימטריה לא חייבות להיות מושלמות - גם אם הן נכשלות במספר סופי של נקודות זה לא ישפיע על כלום כי אינטגרל של פונקציה לא משתנה אם משנים את הפונקציה במספר סופי של נקודות. יותר מכך, אם {% equation %}f{% endequation %} היא אנטיסימטרית אז {% equation %}f\left(x\right)\sin nx{% endequation %} היא סימטרית, ואם {% equation %}f{% endequation %} סימטרית כך גם {% equation %}f\left(x\right)\cos nx{% endequation %}. זה אומר שאפשר לפשט טיפה את נוסחת האינטגרל ולהתעסק רק עם חצי מהתחום:

אם {% equation %}f{% endequation %} אנטיסימטרית אז {% equation %}f\left(x\right)=\sum b_{n}\sin nx{% endequation %} כאשר {% equation %}b_{n}=\frac{2}{\pi}\int_{0}^{\pi}f\left(x\right)\sin nxdx{% endequation %}

אם {% equation %}f{% endequation %} סימטרית אז {% equation %}f\left(x\right)=\sum a_{n}\cos nx{% endequation %} כאשר {% equation %}a_{n}=\frac{2}{\pi}\int_{0}^{\pi}f\left(x\right)\cos nxdx{% endequation %}

באופן כללי, כל פונקציה ניתן לתאר בתור סכום של פונקציה זוגית ופונקציה אי זוגית: אם {% equation %}f{% endequation %} היא פונקציה כלשהי, אז {% equation %}\frac{f\left(x\right)+f\left(-x\right)}{2}{% endequation %} היא פונקציה זוגית, {% equation %}\frac{f\left(x\right)-f\left(-x\right)}{2}{% endequation %} היא פונקציה אי זוגית, ומתקיים {% equation %}f\left(x\right)=\frac{f\left(x\right)+f\left(-x\right)}{2}+\frac{f\left(x\right)-f\left(-x\right)}{2}{% endequation %} (תרגיל נחמד: להוכיח שזה הייצוג <strong>היחיד</strong> של {% equation %}f{% endequation %} כסכום של פונקציה זוגית ופונקציה אי זוגית). אז אפשר לחשוב על הסינוסים בטור הפורייה בתור הייצוג של החלק האנטי סימטרית ועל הקוסינוסים בתור הייצוג של החלק הסימטרי.

עכשיו בואו נעבור לדבר קצת על שאלת ההתכנסות הנקודתית. נניח ש-{% equation %}f\left(x\right)=\frac{a_{0}}{2}+\sum a_{n}\cos nx+\sum b_{n}\sin nx{% endequation %}, כשהשוויון מייצג, כרגיל, התכנסות בנורמה. מה בעצם הבעיה המרכזית שמונעת מאיתנו להיות בטוחים שיש גם התכנסות נקודתית? פשוט מאוד, העובדה שציינתי כבר קודם: המקדמים נקבעים על ידי חישוב של אינטגרל שכולל את {% equation %}f{% endequation %}; אבל אם נשנה את הערך של {% equation %}f{% endequation %} בנקודה אחת, זה לא ישנה את הערך של האינטגרלים. בעצם, לכל טור פורייה {% equation %}\frac{a_{0}}{2}+\sum a_{n}\cos nx+\sum b_{n}\sin nx{% endequation %} אנחנו מסוגלים למצוא מחלקה לא קטנה של פונקציות שמתוארות על ידו. אם תחשבו על זה רגע, תשימו לב שכל הפונקציות הללו יהיו <strong>במרחק </strong><strong>0</strong> אחת מהשניה כשאנחנו מודדים מרחקים עם הנורמה שנובעת מהמכפלה הפנימית שלנו, וזה לא הכי תקין מתמטית כי פונקציית מרחק ("מטריקה") אמורה להבטיח ששני איברים הם במרחק 0 אחד מהשני רק אם הם זהים. למטריקה שכושלת בעניין הזה קוראים "פסאודומטריקה" והדרך המקובלת "לתקן" אותה היא להגדיר יחס שקילות על אברי המרחב שלנו - שני איברים הם שקולים אם המרחק ביניהם הוא 0. עכשיו אפשר לעבור מהמרחב שלנו למרחב חדש, שהוא מרחב המנה שמתקבל מיחס השקילות הזה, ובו המטריקה תהיה תקינה. ועכשיו, איזה נציג אנחנו רוצים לבחור לכל מחלקת שקילות?

אתם לא חייבים להבין את כל הנאום שלמעלה כדי להבין את הרעיון: אותו טור פורייה מייצג כמה פונקציות שונות, והשאלה היא מי מביניהן היא הפונקציה ה"מוצלחת" ביותר, מבחינת זה שההתכנסות הנקודתית בה אופטימלית. באופן כללי זו גם לא שאלה טריוויאלית, אבל תחת תנאים מסויימים אפשר להבטיח התכנסות נקודתית. אתן אחד מהם שיחסית קל לנסח, למרות שיש עוד: אם הפונקציה רציפה וגזירה אז הטור שלה מתכנס אליה נקודתית. גם אם נקלקל ונוסיף נקודות אי רציפות של "קפיצה" בין שני ערכים, הטור עדיין יתכנס נקודתית פרט לנקודות אי הרציפות שבה הטור יתכנס לממוצע של שני הערכים (בדיוק מה שקרה עם הדוגמה שלנו). מה שכן, ההתכנסות הזו היא לא בהכרח <strong>התכנסות במידה שווה</strong>, למי שמכירים את המושג. לא פורמלית, התכנסות במידה שווה פירושו שאם נסכום מספיק איברים של הטור, אז לא תהיה לנו בשום מקום שגיאה "גדולה". אפקט גיבס - הצ'ופצ'יקים ליד נקודות אי הרציפות - הוא דוגמה נגדית במקרה שלנו להתכנסות במידה שווה; ככל שנסכום יותר איברים כך הצ'ופצ'יק יתכווץ - יהיו פחות ערכים שבהם יש צ'ופצ'יק - אבל הוא לעולם לא יקטן מספיק בגובה שלו, כלומר תמיד תהיה נקודה כלשהי שבה יש שגיאה גדולה יחסית (אם נחבר עוד ערכים אז הנקודה הזו תהפוך למדוייקת יותר, אבל עדיין תהיה נקודה <strong>אחרת</strong> שבה יש שגיאה גדולה).

מה על פונקציות שהן "סתם" רציפות, בלי הנחות מיוחדות לגבי הנגזרת שלהן? רציפות היא תכונה מאוד נחמדה מצד אחד, שמונעת מאיתנו "לקלקל" פונקציות בצורה נקודתית כדי להבטיח שטור הפורייה שלהן יטעה באותן נקודות - אבל עדיין, אם אין לנו שליטה על גודל הנגזרת, הפונקציה יכולה להיות די משוגעת. לא אתן דוגמאות נגדיות מפורשות, אבל ניתן לבנות פונקציות רציפות שטור הפורייה שלהן בכלל לא מתכנס נקודתית בשום מקום. אז מה עושים? ובכן, מסתבר שגרסה יותר כללית של התכנסות עדיין עובדת כאן. בואו נסתכל שניה על סדרת הסכומים החלקיים של טור פורייה כלשהו, כלומר נגדיר {% equation %}S_{m}\left(x\right)=\frac{a_{0}}{2}+\sum_{n=1}^{m}\left(a_{n}\cos nx+b_{n}\sin nx\right){% endequation %}. ייתכן, כאמור, שהסדרה {% equation %}S_{0}\left(x\right),S_{1}\left(x\right),S_{2}\left(x\right),\dots{% endequation %} לא מתכנסת בכלל עבור ערכים מסויימים של {% equation %}x{% endequation %}, אבל אפשר להסתכל על <strong>סדרת הממוצעים</strong> שלה:

{% equation %}\sigma_{m}\left(x\right)=\frac{S_{0}\left(x\right)+\dots+S_{m}\left(x\right)}{m+1}{% endequation %}

ניתן להוכיח - ושוב, לא אעשה זאת כרגע - שאם {% equation %}f{% endequation %} היא פונקציה רציפה ואנו סוכמים את טור הפורייה שלה בצורה הזו של סדרת הממוצעים, אז הסכום הזה מתכנס לערך של {% equation %}f{% endequation %} בכל נקודה שבה {% equation %}f{% endequation %} רציפה. שיטת הסכימה הזו - סכימה של הממוצעים - נקראת "סכימת צזארו" ו<a href="http://www.gadial.net/2014/01/18/sum_of_naturals/">הזכרתי אותה לא מזמן</a> בפוסט שעסק בשוויון המוזר {% equation %}1+2+3+\dots=-\frac{1}{12}{% endequation %}. שם הסכימה הזו נתנה את הסכום הלא אינטואיטיבי {% equation %}1-1+1-1+1-\dots=\frac{1}{2}{% endequation %}, ולא מעט אנשים התקשו לקבל אותו כלגיטימי; אני מקווה שהשימוש הנוכחי של סכימת צזארו, שמראה שאפשר עם קצת תושייה לשחזר את הפונקציה המקורית גם מתוך טור פורייה שאינו מתכנס נקודתית, יסייע קצת להפחתת הסקפטיות בנוגע לשיטת הסכימה הנחמדה הזו.

לסיום הפוסט הזה אני רוצה לחשב את טור הפורייה של עוד פונקציה פשוטה - מכיוון שהחישוב הזה יניב תוצאה יפה ולא טריוויאלית (שכבר הראיתי בבלוג בדיוק באותו האופן אבל מי זוכר). הפונקציה היא {% equation %}f\left(x\right)=x{% endequation %} בתחום {% equation %}\left[-\pi,\pi\right]{% endequation %}. זו פונקציה אנטיסימטרית ולכן הפיתוח שלה הוא לטור סינוסים {% equation %}f\left(x\right)=\sum b_{n}\sin nx{% endequation %} כאשר {% equation %}b_{n}{% endequation %} נתון על ידי האינטגרל {% equation %}\frac{2}{\pi}\int_{0}^{\pi}x\sin nxdx{% endequation %}. זה לא אינטגרל מסובך, אבל צריך להשתמש בתעלול אינטגרציה בסיסי בשבילו - אינטגרציה בחלקים. נקבל:

{% equation %}\int_{0}^{\pi}x\sin nxdx=\left[-\frac{x\cos nx}{n}\right]_{0}^{\pi}-\int_{0}^{\pi}\frac{\cos nx}{n}dx=\left(-1\right)^{n+1}\frac{\pi}{n}{% endequation %}

(האינטגרל עם הקוסינוס מתאפס, כפי שכבר ראינו לא מעט בפוסט)

מסקנה, אחרי שנכפול מחדש ב-{% equation %}\frac{2}{\pi}{% endequation %}: {% equation %}b_{n}=\frac{2}{n}\left(-1\right)^{n+1}{% endequation %}. כלומר, ניתן לכתוב את הטור במפורש כך:

{% equation %}x=2\sin x-\sin2x+\frac{2}{3}\sin3x-\frac{1}{2}\sin4x+\dots{% endequation %}

אבל זה לא מה שנחמד. מה שנחמד הוא מה שקורה כאשר אנחנו מחשבים את הנורמה של הפונקציה הזו. בואו נחשב אותה לרגע בצורה ישירה:

{% equation %}\|x\|^{2}=\frac{1}{\pi}\int_{-\pi}^{\pi}x^{2}dx=\frac{1}{\pi}\left[\frac{x^{3}}{3}\right]_{-\pi}^{\pi}=\frac{1}{\pi}\frac{\pi^{3}+\pi^{3}}{3}=\frac{2}{3}\pi^{2}{% endequation %}

עדיין לא נראה מעניין במיוחד, אבל אפשר להשתמש ב"משפט פיתגורס" של מרחבי מכפלה פנימית אינסוף ממדיים - שוויון פרסבל, שאומר שאם {% equation %}f=\sum a_{n}e_{n}{% endequation %} כאשר {% equation %}e_{n}{% endequation %} הם אברי בסיס אורתונורמלי, אז {% equation %}\|f\|^{2}=\sum a_{n}^{2}{% endequation %}. במקרה שלנו, {% equation %}b_{n}^{2}=\frac{4}{n^{2}}{% endequation %}, אז קיבלנו את השוויון הבא:

{% equation %}\frac{2}{3}\pi^{2}=\sum_{n=1}^{\infty}\frac{4}{n^{2}}{% endequation %}

ועל ידי חלוקה ב-4 של שני האגפים נקבל:

{% equation %}\sum_{n=1}^{\infty}\frac{1}{n^{2}}=\frac{\pi^{2}}{6}{% endequation %}

השוויון הזה הוא אחת התוצאות החביבות עלי במתמטיקה - באגף שמאל יש לנו את אחד הטורים המתכנסים הפשוטים ביותר. על פניו בכלל לא ברור איך לחשב את סכומו; ופתאום, באגף ימין יש לנו את הסכום באופן מדויק, וצץ שם {% equation %}\pi{% endequation %} השד יודע מאיפה למרות שלסכום הזה אין לכאורה שום קשר למעגלים. לדעתי זה נפלא. אם אתם רוצים לראות עוד הוכחות (ההוכחה של אוילר נפלאה אפילו עוד יותר) - כאמור, <a href="http://www.gadial.net/2010/03/14/happy_pi_day/">כבר יש לי פוסט</a> על התוצאה הזו. עם זאת, אפשר להשתמש בטורי פורייה של פונקציות נוספות כדי לקבל עוד סכומים דומים, אבל לבינתיים נראה לי שהנקודה הובהרה.

<script type="text/javascript">
	$(function() {
		var n = 15;
		
		function piTickGenerator(axis) {
			var res = [], i = Math.floor(axis.min / Math.PI);
			do {
			  var v = i * Math.PI;
			  res.push([v, i + "\u03c0"]);
			  ++i;
			} while (v < axis.max);
			
			return res;
		  }
  
		function f(x){
			var sum = 0;
			for (var i = 0; i < n; i++){
				var k = 2*i+1;
				sum += Math.sin(k*x) / k
			}
			return sum*4/Math.PI;
		}
		function g(x){
			if (x < -Math.PI)
				return g(x+2*Math.PI);
			if (x > Math.PI)
				return g(x-2*Math.PI);
			if (x < 0)
				return -1;
			return 1;
		}
		
		function plot_functions(fs){
			var d = [];
			for (var k = 0; k < fs.length; k++){
				var vals = [];
				for (var i = -2*Math.PI; i <= 2*Math.PI+0.01; i += 0.001) {
					vals.push([i, fs[k](i)]);
				}
				d.push(vals);
			}
			return d;
		}
		
		function plot(){
			$.plot("#fourier_graph", plot_functions([g,f]), {xaxis:{ticks:piTickGenerator}});
		}
		
		$("#n_slider").on("change", function(){n = this.value; plot();})
		plot();
	});

	</script>