---
id: 2532
title: "אז מה זה חשבון מודולרי?"
date: 2013-05-13 23:44:38
layout: post
categories: 
  - תורת המספרים
tags: 
  - האלגוריתם האוקלידי
  - חשבון מודולרי
social_media_share: true
---
אני רוצה להקדיש פוסט לנושא שלא כתבתי לו מעולם פוסט ייעודי בבלוג, למרות שהוא הופיע בשלל פוסטים מכאן ועד להודעה חדשה - חשבון מודולרי. מכיוון שהמתמטיקה הבסיסית שמאחורי חשבון מודולרי איננה מסובכת, אני מתכוון לפתח את הכל בתוך הפוסט - מה שאומר שהוא יהפוך די מהר לטכני; עם זאת, אני מקווה שכמעט כל אדם שמתעניין במתמטיקה יוכל להבין את הטכניקה גם אם אין לו השכלה מתמטית מיוחדת, ואני חושב שהרווח מהבנה של המתמטיקה הזו הוא אדיר.

לפני שנתחיל להיכנס לפרטים, הנה האינטואיציה הקלאסית: חשבון מודולורי הוא מה שכולנו עושים כשאנחנו מנסים לדעת מה תהיה השעה עוד כך וכך שעות. אם עכשיו השעה היא 19:00 ואנחנו שואלים "מה תהיה השעה עוד 10 שעות?" אנחנו מוסיפים 10 ל-19, מקבלים 29, ואז מחלקים ב-24 (מספר השעות ביממה), לוקחים את השארית - 5, וזו התשובה. חלקנו עושים את זה אחרת, כמובן; ראשית שואלים "עוד כמה שעות יש עד 24?", רואים שזה 5, ואומרים "אוקיי, אז אחרי חצות יש עוד 5 שעות להוסיף, ומגיעים ל-5" אבל האפקט בשני המקרים הוא אותו אפקט, ואנחנו מקבלים את המספר שמתקבל מפעולת החשבון ה"רגילה" כשאחריה מחלקים ב-24 ולוקחים את השארית. חשבון מודולרי זה בדיוק זה, רק לאו דווקא עם 24 בתור מה שמחלקים בו.

ועכשיו בואו נעבור לפרטים.

מה זה חשבון "רגיל", כולנו יודעים - יש לנו מספרים, יש לנו פעולות של חיבור, כפל, חיסור וחילוק, ואנחנו עושים איתן... דברים. בדרך כלל אנחנו מתחילים את המשחק מהמספרים הטבעיים - {% equation %}0,1,2,3,\dots{% endequation %} (שאני כולל בהם גם את 0). עכשיו, אני רוצה שתשימו לב לכך שבמובן מסויים אפשר להסתפק רק בפעולות של חיבור וכפל, ולהגדיר חיסור וחילוק באמצעותן. למשל, הפתרון למשוואה {% equation %}x=5-2{% endequation %} הוא מספר {% equation %}x{% endequation %} אשר מקיים {% equation %}2+x=5{% endequation %} (כלומר 3), והפתרון למשוואה {% equation %}x=6:3{% endequation %} הוא מספר אשר מקיים {% equation %}3\cdot x=6{% endequation %} (כלומר 2). לא תמיד קיימים פתרונות למשוואות הללו במספרים הטבעיים, למשל למשוואה {% equation %}x=2-5{% endequation %} אין פתרון במספרים הטבעיים, ולכן אנחנו מכניסים לתמונה <strong>מספרים שליליים</strong> ו<strong>שברים</strong>; אבל בפוסט הזה לא אדבר עליהם בכלל כי לא יהיה בכך צורך.

אם כן, נדבר על המספרים הטבעיים ועל פעולות החיבור והכפל. יש להודות שאפילו על הכפל אפשר לוותר ולתאר אותו עם חיבור בלבד, אבל אני מעדיף לדבר על שתי הפעולות הללו גם כי זה יהיה פשוט יותר, וגם כי במתמטיקה כללית יותר (שלא תופיע בפוסט) יש לחיבור ולכפל משמעויות נוספות ולא תמיד ניתן להגדיר את הכפל בעזרת החיבור.

עכשיו, אם יש לנו מספר טבעי {% equation %}a{% endequation %} ומספר טבעי {% equation %}n{% endequation %} שהוא גדול מאפס, אז אפשר <strong>לחלק עם שארית</strong> את {% equation %}a{% endequation %} ב-{% equation %}n{% endequation %}, כפי שרובנו למדנו בבית הספר היסודי. המשמעות של זה היא שאפשר למצוא מספרים שלמים {% equation %}q{% endequation %} ("מנה") ו-{% equation %}r{% endequation %} ("שארית") כך שמתקיים השוויון {% equation %}a=nq+r{% endequation %}, ובנוסף לכך {% equation %}0\le r<n{% endequation %}. דרך נוחה להוכיח שאפשר לעשות זאת היא באינדוקציה על הגודל של {% equation %}a{% endequation %}: אם {% equation %}0\le a<n{% endequation %} אז {% equation %}a=n\cdot0+a{% endequation %} הוא השוויון שלנו (כלומר, {% equation %}q=0,r=a{% endequation %} עובד במקרה הזה). אם {% equation %}a\ge n{% endequation %} אז נתבונן על {% equation %}a-n{% endequation %}: מהנחת האינדוקציה אנחנו יודעים שקיימים {% equation %}q,r{% endequation %} כך ש-{% equation %}a-n=nq+r{% endequation %} כך ש-{% equation %}0\le r<n{% endequation %}, ולכן (על ידי העברת אגפים) נקבל ש-{% equation %}a=n\left(q+1\right)+r{% endequation %} וזה שוב שוויון כפי שרצינו לקבל.

אם {% equation %}a=nq{% endequation %}, כלומר השארית של חלוקת {% equation %}a{% endequation %} ב-{% equation %}n{% endequation %} היא 0, אומרים (באופן מתבקש למדי) ש-{% equation %}n{% endequation %} <strong>מחלק</strong> את {% equation %}a{% endequation %} והסימון המקובל לכך הוא {% equation %}n|a{% endequation %}.

כעת נציג הגדרה חשובה במיוחד: שני מספרים {% equation %}a,b{% endequation %} (טבעים או אפילו שלמים - כלומר, כולל שליליים, שלא תיארתי בפוסט הזה) הם <strong>שקולים מודולו {% equation %}n{% endequation %}</strong>, ואני כותב זאת {% equation %}a\equiv_{n}b{% endequation %}, אם השארית שלהם בחלוקה ב-{% equation %}n{% endequation %} היא זהה. כלומר, אם קיים {% equation %}0\le r<n{% endequation %} וקיימים {% equation %}q_{1},q_{2}{% endequation %} כך ש-{% equation %}a=nq_{1}+r{% endequation %} ו-{% equation %}b=nq_{2}+r{% endequation %} אז {% equation %}a\equiv_{n}b{% endequation %}. שימו לב שאם השוויונות הללו מתקיימים אז {% equation %}a-b=n\left(q_{1}-q_{2}\right)+\left(r-r\right)=n\left(q_{1}-q_{2}\right){% endequation %}, כלומר {% equation %}n|a-b{% endequation %}, וגם ההפך נכון: אם {% equation %}n|a-b{% endequation %} אז {% equation %}a-b=nq{% endequation %} עבור איזה שהוא {% equation %}q{% endequation %}, כלומר {% equation %}a=nq+b{% endequation %}. נכתוב {% equation %}b=nt+r{% endequation %} כך ש-{% equation %}0\le r<n{% endequation %} ונקבל ש-{% equation %}a=n\left(q+t\right)+r{% endequation %}, כלומר השארית של חלוקת {% equation %}a{% endequation %} ב-{% equation %}n{% endequation %} שווה לשארית של חלוקת {% equation %}b{% endequation %} ב-{% equation %}n{% endequation %} והיא {% equation %}r{% endequation %}. מסקנה: {% equation %}a\equiv_{n}b{% endequation %} אם ורק אם {% equation %}n|a-b{% endequation %}. זה תנאי נוח יותר לבדיקה לעתים קרובות ולכן הצגתי אותו. עוד הערה קטנה היא שלרוב בספרות המתמטית כותבים {% equation %}a\equiv b\left(\text{mod }n\right){% endequation %} כדי לציין שקילות מודולו {% equation %}n{% endequation %}; אני אישית פחות אוהב את הסימון הזה והוא פחות נוח לי ולכן אני משתמש ב-{% equation %}a\equiv_{n}b{% endequation %} (שגם הוא סימון סטנדרטי אבל הרבה פחות מקובל).

עכשיו, שקילות מודולו {% equation %}n{% endequation %} היא מה שנקרא במתמטיקה <strong>יחס שקילות</strong>. זה אומר שהיא מקיימת שלוש תכונות: ראשית, {% equation %}a\equiv_{n}a{% endequation %} לכל {% equation %}a,n{% endequation %} טבעיים (כש-{% equation %}n>0{% endequation %}; לא אטרח לציין זאת במפורש כל פעם). זאת מכיוון ש-{% equation %}a-a=0{% endequation %} וכמובן ש-{% equation %}n|0{% endequation %}. התכונה לפיה כל {% equation %}a{% endequation %} שקול מודולו {% equation %}n{% endequation %} לעצמו נקראת <strong>רפלקסיביות</strong>.

כמו כן, שקילות מודולו {% equation %}n{% endequation %} היא <strong>סימטרית</strong>, כלומר אם {% equation %}a\equiv_{n}b{% endequation %} אז זה אומר ש-{% equation %}n|a-b{% endequation %} ולכן {% equation %}n=q\left(a-b\right){% endequation %} עבור {% equation %}q{% endequation %} כלשהו, ולכן {% equation %}n=-q\left(b-a\right){% endequation %} ולכן {% equation %}b\equiv_{n}a{% endequation %}, כלומר השאלה מי בצד ימין ומי בצד שמאל אינה ממש חשובה כשמדברים על שקילות מודולו {% equation %}n{% endequation %}.

לבסוף, שקילות מודולו {% equation %}n{% endequation %} היא <strong>טרנזיטיבית</strong>, ומשמעות הדבר היא זו: אם {% equation %}a\equiv_{n}b{% endequation %} וגם {% equation %}b\equiv_{n}c{% endequation %} אז זה אומר שקיימים {% equation %}q_{1},q_{2}{% endequation %} כך ש-{% equation %}q_{1}n=a-b{% endequation %} ו-{% equation %}q_{2}n=b-c{% endequation %}. נחבר את שתי המשוואות ונקבל ש-{% equation %}\left(q_{1}+q_{2}\right)n=\left(a-b\right)+\left(b-c\right)=a-c{% endequation %} ולכן {% equation %}a\equiv_{n}c{% endequation %}.

באופן כללי במתמטיקה, כל יחס שקילות שמוגדר על קבוצה כלשהי - במקרה שלנו, קבוצת המספרים הטבעיים {% equation %}\mathbb{N}{% endequation %}, אבל באותה מידה זה יעבוד עבור השלמים {% equation %}\mathbb{Z}{% endequation %} - משרה על הקבוצה <strong>חלוקה למחלקות שקילות</strong>. מחלקת שקילות של מספר {% equation %}a{% endequation %} כלשהי, שמסומנת בתור {% equation %}\left[a\right]{% endequation %}, היא קבוצת כל המספרים ששקולים לו על פי יחס השקילות הזה. זה מושג לא קל להבנה, אז בואו נראה מה הוא עבור המקרים שלנו. נתחיל בקטן - שקילות מודולו {% equation %}2{% endequation %}. מהי מחלקת השקילות של 0 מודולו 2? היא כוללת את כל המספרים {% equation %}a{% endequation %} כך ש-{% equation %}2|a-0{% endequation %}, כלומר ש-{% equation %}2|a{% endequation %}, כלומר את כל הזוגיים. מסמנים זאת {% equation %}\left[0\right]=\left\{ 0,2,4,6,8,\dots\right\} {% endequation %}. באופן דומה, {% equation %}\left[1\right]=\left\{ 1,3,5,7,9,\dots\right\} {% endequation %}, כלומר מחלקת השקילות של 1 כוללת את כל האי זוגיים (כי אי זוגי הוא תמיד מהצורה {% equation %}2k+1{% endequation %}, ולכן כשנחסר ממנו 1 נקבל משהו שמתחלק ב-2), ואלו כל מחלקות השקילות של היחס "שקילות מודולו 2".

אפשר לעשות את אותו דבר עבור 3, ונגלה שיש שלוש מחלקות שקילות מודולו 3: {% equation %}\left[0\right]=\left\{ 0,3,6,9,12,\dots\right\} {% endequation %} של כל המספרים שמתחלקים ב-3; {% equation %}\left[1\right]=\left\{ 1,4,7,10,13,\dots\right\} {% endequation %} של כל המספרים שמתחלקים ב-3 עם שארית 1, ו-{% equation %}\left[2\right]=\left\{ 2,5,8,11,14,\dots\right\} {% endequation %} של כל המספרים שמתחלקים ב-3 עם שארית 2. ומה קורה באופן כללי? עבור שקילות מודולו {% equation %}n{% endequation %} יהיו לנו {% equation %}n{% endequation %} מחלקות שקילות, שנוח לתאר בתור {% equation %}\left[0\right],\left[1\right],\dots,\left[n-1\right]{% endequation %} - כאן המספרים {% equation %}0,1,2,\dots,n-1{% endequation %} משמשים בתור <strong>נציגים</strong> של מחלקות השקילות.

ועכשיו נכנסת לתמונה ההגדרה המתמטית המרכזית בפוסט: לכל {% equation %}n{% endequation %} טבעי, אנו מגדירים את הקבוצה {% equation %}\mathbb{Z}_{n}=\left\{ \left[0\right],\left[1\right],\dots,\left[n-1\right]\right\} {% endequation %} של כל מחלקות השקילות מודולו {% equation %}n{% endequation %} של מספרים טבעיים (אם לחדד, לרוב מדברים על מחלקות שקילות של מספרים שלמים, כלומר כולל השליליים, אבל לא היה לי צורך בזה כאן). הקבוצה הזו לכשעצמה היא לא מעניינת; מה שמעניין הוא שאפשר להגדיר עליה פעולות חדשות של חיבור וכפל ש"מושרות" באופן טבעי מהפעולות עבור מספרים רגילים. איך? ובכן, בהינתן {% equation %}\left[a\right],\left[b\right]{% endequation %}, איך אפשר להגדיר בצורה הטבעית ביותר את {% equation %}\left[a\right]+\left[b\right]{% endequation %}? בבירור מתבקש להגדיר זאת על ידי {% equation %}\left[a\right]+\left[b\right]=\left[a+b\right]{% endequation %}. כלומר, מחלקת השקילות שתוחזר מהחיבור של מחלקות השקילות {% equation %}\left[a\right]{% endequation %} ו-{% equation %}\left[b\right]{% endequation %} תהיה מחלקת השקילות של האיבר {% equation %}a+b{% endequation %}. אלא שיש כאן בעיה שצצה באופן כללי כשמגדירים דברים על מחלקות שקילות בעזרת נציגים שלהן: לא מובטח שההגדרה עובדת, כי ייתכן שהיא <strong>תלויה בנציג</strong>, וצריך להוכיח במפורש שהיא לא.

למה אני מתכוון? ובכן, אני צריך להוכיח שהסיטואציה הבאה אינה אפשרית: שיש לנו {% equation %}a,a^{\prime}{% endequation %} שמייצגים אותה מחלקת שקילות, כלומר {% equation %}\left[a\right]=\left[a^{\prime}\right]{% endequation %}, ושיש {% equation %}b,b^{\prime}{% endequation %} כך ש-{% equation %}\left[b\right]=\left[b^{\prime}\right]{% endequation %}, אבל שמתקיים {% equation %}\left[a+b\right]\ne\left[a^{\prime}+b^{\prime}\right]{% endequation %}. כי אם שתי אלו הן מחלקות שונות, אני אקבל ש-{% equation %}\left[a\right]+\left[b\right]=\left[a+b\right]\ne\left[a^{\prime}+b^{\prime}\right]=\left[a^{\prime}\right]+\left[b^{\prime}\right]=\left[a\right]+\left[b\right]{% endequation %} וקיבלתי סתירה במתמטיקה, שמצביעה על כך שפעולת החיבור של מחלקות שקילות שהגדרתי היא לא חוקית. למרבה המזל, זה לא מה שקורה בפועל; בואו נוכיח את זה.

אני רוצה להראות ש-{% equation %}\left[a+b\right]=\left[a^{\prime}+b^{\prime}\right]{% endequation %}, כלומר ש-{% equation %}a+b\equiv_{n}a^{\prime}+b^{\prime}{% endequation %}, כלומר ש-{% equation %}n|\left(a-a^{\prime}\right)+\left(b-b^{\prime}\right){% endequation %}. כעת, אני יודע ש-{% equation %}a\equiv_{n}a^{\prime}{% endequation %} ולכן יש {% equation %}q_{1}{% endequation %} כך ש-{% equation %}a-a^{\prime}=nq_{1}{% endequation %}. בדומה, {% equation %}b\equiv_{n}b^{\prime}{% endequation %} ולכן {% equation %}b-b^{\prime}=nq_{2}{% endequation %} עבור איזה שהוא {% equation %}q_{2}{% endequation %}. מסקנה: {% equation %}\left(a-a^{\prime}\right)+\left(b-b^{\prime}\right)=n\left(q_{1}+q_{2}\right){% endequation %} ולכן באמת מתקיים {% equation %}a+b\equiv_{n}a^{\prime}+b^{\prime}{% endequation %} ופעולת החיבור מוגדרת היטב. מעולה. ומה עם כפל?

כפל יעבוד באותו האופן: {% equation %}\left[a\right]\left[b\right]=\left[ab\right]{% endequation %}, אבל ההוכחה טיפה יותר טריקית. כמקודם, אנחנו יודעים ש-{% equation %}a-a^{\prime}=nq_{1}{% endequation %} ו-{% equation %}b-b^{\prime}=nq_{2}{% endequation %}, אבל איך מגיעים מכאן לכך ש-{% equation %}ab-a^{\prime}b^{\prime}=nq{% endequation %} עבור {% equation %}q{% endequation %} כלשהו? נסו לעשות זאת בעצמכם לרגע כדי להרגיש את ה"בעיה".

הפתרון, למרבה המזל, אינו מסובך, ומשתמש בתעלול אלגברי נפוץ שחלקכם ודאי זוכרים מבית הספר: להוסיף ולהחסיר איבר "ביניים" כלשהו שמקל עלינו לפשט את הביטוי:

{% equation %}ab-a^{\prime}b^{\prime}=ab-ab^{\prime}+ab^{\prime}-a^{\prime}b^{\prime}=a\left(b-b^{\prime}\right)+b^{\prime}\left(a-a^{\prime}\right)=n\left(aq_{2}+b^{\prime}q_{1}\right){% endequation %}

זה מוכיח שפעולת הכפל של מחלקות שקילות מוגדרת היטב. אם כל זה קצת אבסטרקטי מדי עבורכם, הנה ניסוח "ברמת המשוואה" של מה שראינו: אם {% equation %}a\equiv_{n}a^{\prime}{% endequation %} ו-{% equation %}b\equiv_{n}b^{\prime}{% endequation %}, אז

{% equation %}a+b\equiv_{n}a^{\prime}+b^{\prime}{% endequation %}

{% equation %}ab\equiv_{n}a^{\prime}b^{\prime}{% endequation %}

מה שאומר שבכל פעם שיש לנו משוואה פולינומית מודולרית, אפשר לקחת כל מספר שמופיע בה ולהחליף אותו במספר ששקול לו, מה שלעתים קרובות עוזר לפשט את התוצאה. הנה דוגמא: נניח שאנו רוצים לדעת מהו {% equation %}10^{100}{% endequation %} מודולו 9. אז אנחנו כותבים את המשוואה {% equation %}x\equiv_{9}10^{100}{% endequation %}. מה עכשיו? מכיוון ש-{% equation %}10\equiv_{9}1{% endequation %}, אפשר להמשיך את המשוואה ולכתוב:

{% equation %}x\equiv_{9}10^{100}\equiv_{9}1^{100}\equiv_{9}1{% endequation %}

קלי קלות, כי אנחנו יודעים ש-1 בחזקת כל דבר הוא 1. גם בחשבון מודולרי.

אם כן, חשבון מודולרי מודולו {% equation %}n{% endequation %} הוא חשבון שמתבצע עם האיברים של {% equation %}\mathbb{Z}_{n}{% endequation %} במקום עם מספרים טבעיים רגילים, או מנקודת מבט קצת אחרת - זה חשבון שמתבצע עם מספרים טבעיים רגילים, אבל כזה שבו אנחנו מחליטים על קבוצת נציגים (שהם מספרים טבעיים) למחלקות השקילות שמהוות את {% equation %}\mathbb{Z}_{n}{% endequation %}, עובדים רק עם הנציגים הללו, ובכל פעם שבה אנחנו "חורגים" מהם, אנחנו חוזרים אליהם (על ידי חלוקה ולקיחת שארית). מכיוון שלכתוב {% equation %}\left[0\right]{% endequation %} ו-{% equation %}\left[a\right]{% endequation %} וכדומה כל הזמן זה מסורבל, אנחנו לרוב נוקטים בפועל בשיטה השניה.

עכשיו בואו נדבר על שתי הפעולות שעליהן טרם דיברתי - חיסור וחילוק. מה זה חיסור, באופן כללי? ובכן, נתחיל מחיבור דווקא: יש לנו איבר שהוא "אדיש" לחיבור, במובן זה שאם מחברים אותו עם {% equation %}x{% endequation %} כלשהו, מקבלים {% equation %}x{% endequation %}. האיבר הזה הוא 0. עכשיו, לכל מספר טבעי {% equation %}a{% endequation %} קיים מספר <strong>נגדי</strong>, שאם מחברים אותו עם {% equation %}a{% endequation %} מקבלים את האיבר האדיש לחיבור, כלומר {% equation %}0{% endequation %}. אנחנו מסמנים את המספר הנגדי הזה ב-{% equation %}-a{% endequation %}, ואנחנו יודעים שהוא לא מספר טבעי (אלא <strong>מספר שלילי</strong>). אלא שבחשבון מודולרי מתרחש "קסם" - אנחנו לא צריכים להרחיב את מערכת המספרים שלנו כדי לקבל איברים נגדיים: הנגדי של {% equation %}a{% endequation %} הוא פשוט {% equation %}n-a{% endequation %}. מה שאומר שלפעמים איבר יכול להיות אפילו הנגדי של עצמו. למשל, בחשבון מודולו {% equation %}6{% endequation %}, הנגדי של 2 הוא 4, והנגדי של 3 הוא 3. זה אומר שאפשר לכתוב משוואות כמו {% equation %}3\equiv_{6}-3{% endequation %} והן יהיו תקינות לחלוטין.

איך זה קשור לחיסור? ובכן, כי חיסור אפשר תמיד לראות כפעולה של "חיבור עם נגדי". בואו ננסה להיזכר מאיפה נוצר הצורך בפעולת חיסור בכלל: נניח שיש לנו משוואה מהצורה {% equation %}x+a=b{% endequation %}; הדרך לפתור אותה היא לחסר {% equation %}a{% endequation %} משני האגפים ולקבל {% equation %}x=b-a{% endequation %}. הסיבה שאנחנו מחסרים היא שאנחנו רוצים להיפטר מ-{% equation %}a{% endequation %} באגף שמאל; אבל מה שאנחנו בעצם עושים כאן הוא <strong>לחבר</strong> לאגף שמאל את ה<strong>נגדי</strong> של {% equation %}a{% endequation %}, ש"מאפס" אותו. לכן בחשבון מודולרי אפשר לחסר בלי בעיות - פשוט מחברים עם הנגדי. למשל, אם יש לנו את המשוואה {% equation %}x+2\equiv_{6}5{% endequation %} פשוט מחברים 4 לשני האגפים ומקבלים {% equation %}x\equiv_{6}5+4\equiv_{6}9\equiv_{6}3{% endequation %}. לרוב אנחנו מרשים לעצמנו לכתוב דברים כמו {% equation %}-2{% endequation %} גם בחשבון מודולרי, מתוך הבנה שזה ייצוג של הנגדי של {% equation %}2{% endequation %} (שמודולו 6, למשל, הוא 4). אגב, דרך פשוטה אחרת לחשוב על זה היא ש-{% equation %}-2{% endequation %} הוא פשוט מחלקת השקילות של {% equation %}-2{% endequation %} על פי יחס השקילות מודולו (כאשר מגדירים אותו על כל {% equation %}\mathbb{Z}{% endequation %}; אבל חלק מהפואנטה שלי בפוסט הזה היא שאפשר לחשוב על חשבון מודולרי גם בלי לדבר על שלילייים).

חילוק הוא כבר סיפור מעניין יותר. ראשית, התיאוריה הכללית, שמאוד דומה לזו של חיבור. יש לנו איבר אדיש לכפל - 1. לכל מספר {% equation %}a{% endequation %} אפשר להגדיר את <strong>ההופכי</strong> שלו בתור מספר {% equation %}a^{\prime}{% endequation %}כך ש-{% equation %}aa^{\prime}=1{% endequation %}. מסמנים את ההופכי לרוב בתור {% equation %}a^{-1}{% endequation %}. עכשיו אפשר להגדיר חילוק בתור כפל בהופכי: אם {% equation %}ax=b{% endequation %} אז {% equation %}x=a^{-1}b{% endequation %} (למה?). לרוע המזל, כאן יש לנו בעיה: ל-0 אין הופכי. אפשר להוכיח בקלות ש-{% equation %}0{% endequation %} כפול כל מספר יהיה 0, ולכן לא נוכל לקבל אף פעם 1 באופן הזה. הנה הוכחה קצרה:

{% equation %}0\cdot a=\left(0+0\right)\cdot a=0\cdot a+0\cdot a{% endequation %}

ועל ידי העברת אגפים מקבלים {% equation %}0\cdot a=0{% endequation %}.

הדרך היחידה לפתור את הבעיה הזו בצורה שעדיין מותירה תקווה שיהיה הופכי ל-0 היא לטעון ש-{% equation %}0=1{% endequation %}, אבל אז לכל {% equation %}a{% endequation %} נקבל {% equation %}0=0\cdot a=1\cdot a=a{% endequation %}, כלומר <strong>הכל</strong> שווה לאפס ואנחנו בוודאי לא רוצים את זה. אז אין ברירה: אנחנו מצהירים ש-0 אינו הפיך, ולכן גם לא ניתן לחלק ב-0.

הבעיה בחשבון מודולרי היא שזה יכול לקרות לעוד איברים חוץ מ-0.

נתחיל ממקרה פשוט שבו זה דווקא לא קורה, חשבון מודולו 7: מי הוא, למשל, ההופכי של 3 מודולו 7? קל לראות שזה 5, כי {% equation %}3\cdot5\equiv_{7}15\equiv_{7}1{% endequation %}. אבל האם יש דרך שיטתית ומסודרת למצוא הופכי של מספרים מודולו משהו? התשובה חיובית ואסביר זאת בקרוב.

כעת, אם אני רוצה לחלק ב-3 מודולו 7, אני פשוט כופל ב-5. למשל, כדי לחלק את 6 ב-3 אני כופל ב-5 ומקבל 30, ששקול מודולו 7 ל-2. קסם! בדרך דומה אפשר לחלק בכל מספר מ-1 עד 6, אבל לא ב-0. אם כן, איפה כן יש בעיות עם מספרים ששונים מאפס?

בואו נעבור לדבר על חשבון מודולו 6. בחשבון מודולו 6 לא קשה לראות ש-5 הוא הפיך - תכפלו אותו <strong>בעצמו</strong> ותקבלו 1. אז כפל ב-5 וחלוקה ב-5 זה בעצם אותו דבר. כנ"ל עבור 1. אבל מה עם שאר המספרים? בואו נתחיל מ-2 ו-3. שימו לב שהמכפלה של שניהם נותנת 6, ששקול מודולו 6 לאפס, כלומר {% equation %}2\cdot3\equiv_{6}0{% endequation %}. זו תופעה שפשוט לא קיימת בחשבון "רגיל" - כופלים שני מספרים שונים מאפס, ומקבלים אפס. למספרים כאלו קוראים <strong>מחלקי אפס</strong>, ואני טוען שאם מספר הוא מחלק אפס מודולו {% equation %}n{% endequation %} הוא לא יכול להיות הפיך מודולו {% equation %}n{% endequation %}. הסיבה פשוטה: אם {% equation %}ab\equiv_{n}0{% endequation %} ו-{% equation %}b\not\equiv_{n}0{% endequation %}, ואם {% equation %}a{% endequation %} הפיך, אז אפשר לחלק ב-{% equation %}a{% endequation %} ולקבל {% equation %}b\equiv_{n}0{% endequation %}, בסתירה למה שהנחנו.

במי עוד לא טיפלנו מודולו 6? ב-4. קל לראות שגם הוא מחלק 0, כי {% equation %}4\cdot3=12\equiv_{6}0{% endequation %}. זה מסיים את הסיפור: האיברים שהם הפיכים מודולו {% equation %}6{% endequation %} הם רק {% equation %}1,5{% endequation %}. באופן כללי, את האיברים ב-{% equation %}\mathbb{Z}_{n}{% endequation %} שהם הפיכים מודולו {% equation %}n{% endequation %} נהוג לסמן בתור {% equation %}\mathbb{Z}_{n}^{*}{% endequation %}. כלומר, ראינו ש-{% equation %}\mathbb{Z}{}_{7}^{*}=\left\{ 1,2,3,4,5,6\right\} {% endequation %} ואילו {% equation %}\mathbb{Z}_{6}^{*}=\left\{ 1,5\right\} {% endequation %}. אבל האם יש הגיון כללי שמאפשר לדעת מתי איבר הוא הפיך או מחלק אפס מודולו {% equation %}n{% endequation %}? והאם איבר הוא בהכרח או זה או זה? (שימו לב לכך שבמספרים השלמים הטענה "איבר הוא או מחלק אפס או הפיך" אינה נכונה - למשל, 2 אינו הפיך ואינו מחלק אפס). כאן צריך להכניס לתמונה עוד קצת מתמטיקה; בפרט את מה שנקרא <strong>האלגוריתם האוקלידי</strong>.

בואו נתחיל מלדבר על שאלה שבמבט ראשון אולי נראית לא קשורה. נניח שיש לנו שני מספרים שלמים {% equation %}a,b{% endequation %}, ואנחנו מסתכלים על כל המספרים שניתן לקבל מחיבורים וחיסורים שלהם, כלומר על כל <strong>הצירופים הלינאריים</strong> {% equation %}ax+by{% endequation %} כאשר {% equation %}x,y{% endequation %} הם מספרים שלמים. האם יש דרך פשוטה לתאר את כל המספרים שיכולים להתקבל בצורה הזו?

יש שלל סיבות שבגללן השאלה הזו מעניינת, אבל בהקשר שלנו היא מעניינת כי תשובה לה נותנת לנו תשובה לשאלה "אילו ערכים מודולו {% equation %}n{% endequation %} יש לכפולות של {% equation %}a{% endequation %}?". מה שנעשה הוא להתבונן על כל המספרים מהצורה {% equation %}t=ax+ny{% endequation %}, וכשניקח את המשוואה מודולו {% equation %}n{% endequation %} נקבל {% equation %}t\equiv_{n}ax{% endequation %} (כי {% equation %}ny\equiv_{n}0{% endequation %}). בפרט, {% equation %}a{% endequation %} הפיך מודולו {% equation %}n{% endequation %} אם ורק אם קיימים {% equation %}x,y{% endequation %} כך ש-{% equation %}ax+ny=1{% endequation %}. אם כן, שווה לחקור בצורה קצת יותר כללית את אוסף כל הצירופים הלינאריים {% equation %}ax+by{% endequation %} ולהבין איך הוא מתנהג עבור {% equation %}a,b{% endequation %} כלשהם.

נתחיל מאבחנה פשוטה: אם {% equation %}d{% endequation %} הוא מספר טבעי כלשהו כך ש-{% equation %}d|a{% endequation %} וגם {% equation %}d|b{% endequation %} אז {% equation %}d|ax+by{% endequation %} (זה תרגיל קל שדומה לחישובים שכבר עשינו בפוסט). לכן אפשר להציג את כל המספרים מהצורה {% equation %}ax+ny{% endequation %} בתור כפולה של כל {% equation %}d{% endequation %} אשר מחלק את {% equation %}a,b{% endequation %}. האם זה אומר גם ההפך - שכל כפולה של {% equation %}d{% endequation %} ניתן לייצג כצירוף לינארי שכזה? הבה ונראה דוגמה. ניקח את המספרים {% equation %}a=12,b=8{% endequation %}. שניהם מתחלקים על ידי 2 ולכן ברור שכל צירוף לינארי שלהם יהיה זוגי, אבל האם אפשר לכתוב את 2 כצירוף לינארי שלהם? על פניו לא ברור איך. את 4 קל לכתוב: {% equation %}4=12-8{% endequation %}. אבל את 2? אפשר לנסות לפעול שיטתית כך: ראשית "נקפיא" את {% equation %}12{% endequation %} ונראה אילו מספרים אפשר לקבל כשמחברים ומחסרים את 8 ממנו: נגלה את הסדרה {% equation %}\dots,-20,-12,-4,4,12,20,\dots{% endequation %}. נראה ש"פספסנו" את 2. עכשיו, בואו נחבר את 12 לעצמו ונקבל 24. איזו סדרה אפשר לקבל כשמחברים או מחסרים כפולות של 8 מ-24? הסדרה {% equation %}\dots,-16,-8,0,8,16,24,32,\dots{% endequation %}. שוב "פספסנו" את 2. אבל אולי אם נתחיל מ-36? הבנתם את הרעיון.

בואו נעצור לרגע ונתבונן בכל המספרים שמצאנו עד כה כצירופים לינאריים של 8 ו-12. כולם מתחלקים ב-2 וזה לא מפתיע, אבל כולם גם מתחלקים ב-4. גם זה לא מפתיע, שכן 4 מחלק גם הוא את 8 ו-12; מה שמעניין הוא שנראה שאכן הצלחנו לתפוס את <strong>כל</strong> הכפולות של 4, למרות שלא תפסנו את כל הכפולות של 2. מה הופך את 4 למיוחד מבין המחלקים המשותפים של 8 ו-12 כדי שהתכונה הזו תתקיים עבורו? התשובה פשוטה: 4 הוא <strong>המחלק המשותף המקסימלי</strong> של 12 ו-8. אין להם מחלק משותף גדול יותר.

הסיבה שבגללה כל כפולה של 4 יכולה להתקבל היא שאפשר לקבל את 4 עצמו בתור צירוף לינארי של 12 ו-8. באופן כללי, אם עבור {% equation %}d{% endequation %} כלשהו מתקיים {% equation %}d=ax+by{% endequation %} אז כדי לקבל כפולה כלשהי של {% equation %}d{% endequation %} פשוט נכפיל את המשוואה במה שאנו זקוקים לו, ונקבל {% equation %}td=axt+aty{% endequation %}. מה שהופך את 4 למיוחד הוא שמצד אחד, אפשר לקבל את כל הכפולות שלו כצירוף לינארי של 8 ו-12, ומצד שני הוא מחלק כל צירוף לינארי של 8 ו-12, ולכן קבוצת "הצירופים הלינאריים של 8 ו-12" וקבוצת "הכפולות של 4" הן בדיוק אותה קבוצה. זה גם מבהיר מדוע אנחנו לא מסוגלים לקבל את 2 כצירוף לינארי של 8 ו-12: פשוט מאוד, 4 אינו מחלק את 2.

הטענה הזו עובדת באופן כללי. בהינתן {% equation %}a,b{% endequation %} אנו מסמנים ב-{% equation %}d=\text{gcd}\left(a,b\right){% endequation %} את המחלק המשותף המקסימלי של {% equation %}a,b{% endequation %}. כדי להוכיח שכל כפולה של {% equation %}d{% endequation %} מתקבלת כצירוף לינארי של {% equation %}a,b{% endequation %} צריך להוכיח שקיים צירוף לינארי שלהם שנותן את {% equation %}d{% endequation %} עצמו, כלומר שקיימים {% equation %}x,y{% endequation %} כך ש-{% equation %}ax+by=d{% endequation %}. אציג כעת אלגוריתם, <strong>האלגוריתם האוקלידי</strong> שבהינתן {% equation %}a,b{% endequation %} גם מוצא את {% equation %}d{% endequation %} וגם כותב אותו כצירוף לינארי של {% equation %}a,b{% endequation %}, ובנוסף לכך הוא גם עושה זאת ביעילות, מה שקריטי לחלוטין עבור תורת המספרים החישובית.

האלגוריתם הוא רקורסיבי באופיו, כלומר מתבסס על קריאה לעצמו על מקרה פשוט יותר. בואו נניח שאנחנו מקבלים כקלט {% equation %}a,b{% endequation %} שהם טבעיים ומקיימים {% equation %}a>b{% endequation %}. אז אפשר לחלק את {% equation %}a{% endequation %} ב-{% equation %}b{% endequation %} עם שארית ולקבל {% equation %}a=qb+r{% endequation %}. כעת, אם {% equation %}r=0{% endequation %} זה אומר ש-{% equation %}b{% endequation %} מחלק את {% equation %}a{% endequation %} ולכן המחלק המשותף הגדול ביותר של שניהם הוא {% equation %}b{% endequation %} עצמו, שאפשר להציג בתור צירוף לינארי טריוויאלי: {% equation %}a\cdot0+b\cdot1=b{% endequation %}.

כעת, אם {% equation %}r{% endequation %} גדול מ-0, מגיעה האבחנה המרכזית הבאה: {% equation %}\text{gcd}\left(a,b\right)=\text{gcd}\left(b,r\right){% endequation %}. כדי לראות זאת, מספיק לשים לב לכך ש-{% equation %}a=qb+r{% endequation %} ולכן אם מישהו מחלק את {% equation %}b,r{% endequation %} הוא בוודאי מחלק את {% equation %}a{% endequation %}, וש-{% equation %}r=a-qb{% endequation %} ולכן אם מישהו מחלק את {% equation %}a,b{% endequation %} הוא בוודאי מחלק את {% equation %}r{% endequation %}. לכן הקבוצה "המחלקים המשותפים של {% equation %}a,b{% endequation %}" והקבוצה "המחלקים המשותפים של {% equation %}b,r{% endequation %}" שוות. הוכחנו את האבחנה, וממנה נובעת שארית האלגוריתם: באופן רקורסיבי, אנו מוצאים {% equation %}x^{\prime},y^{\prime}{% endequation %} כך ש-{% equation %}\text{gcd}\left(a,b\right)=bx^{\prime}+ry^{\prime}{% endequation %}, וכעת אנו מציבים {% equation %}a-qb{% endequation %} במקום {% equation %}r{% endequation %}, ומקבלים {% equation %}\text{gcd}\left(a,b\right)=ay^{\prime}+b\left(x^{\prime}-qy^{\prime}\right){% endequation %}, כלומר {% equation %}\text{gcd}\left(a,b\right)=ax+by{% endequation %} כאשר {% equation %}x=y^{\prime}{% endequation %} ו-{% equation %}y=x^{\prime}-qy^{\prime}{% endequation %}. קל מאוד לתכנת את זה בפועל.

חזרה לענייננו: יהא {% equation %}n{% endequation %} טבעי כלשהו ונרצה לדעת מתי {% equation %}a{% endequation %} הפיך מודולו {% equation %}n{% endequation %}. כפי שהראיתי כבר, אם {% equation %}\text{gcd}\left(a,n\right)=1{% endequation %} אז קיימים {% equation %}x,y{% endequation %} כך ש-{% equation %}ax+ny=1{% endequation %} ולכן {% equation %}ax\equiv_{n}1{% endequation %} ומכאן ש-{% equation %}a{% endequation %} הפיך ו-{% equation %}x{% endequation %} הוא ההופכי שלו ויש לנו אלגוריתם יעיל למצוא אותו (ולכן אלגוריתם יעיל לביצוע פעולות חילוק מודולו {% equation %}n{% endequation %}). ומה אם {% equation %}\text{gcd}\left(a,n\right)=d&gt;1{% endequation %}? במקרה הזה {% equation %}a{% endequation %} הוא מחלק אפס, כי בואו נסתכל על {% equation %}a\cdot\frac{n}{d}{% endequation %}: מכיוון ש-{% equation %}d{% endequation %} מחלק את {% equation %}n{% endequation %}, הרי ש-{% equation %}\frac{n}{d}{% endequation %} הוא מספר שלם, וקטן מ-{% equation %}n{% endequation %} (כי {% equation %}d>1{% endequation %}). מצד שני, הביטוי הזה שווה ל-{% equation %}\frac{a}{d}\cdot n\equiv_{n}0{% endequation %} כי {% equation %}d{% endequation %} מחלק גם את {% equation %}a{% endequation %}. אז מצאנו ש-{% equation %}a{% endequation %} כפול משהו שאיננו 0 מודולו {% equation %}n{% endequation %} שווה ל-0 מודולו {% equation %}n{% endequation %}, והמסקנה היא ש-{% equation %}a{% endequation %} אינו הפיך.

אם כן, מצאנו ש-{% equation %}a{% endequation %} הפיך מודולו {% equation %}n{% endequation %} אם ורק אם המחלק המשותף הגדול ביותר שלהם הוא 1; זו תכונה כל כך חשובה שנותנים לה שם: {% equation %}a{% endequation %} ו-{% equation %}n{% endequation %} הם <strong>זרים</strong> אם המחלק המשותף המקסימלי שלהם הוא 1. לכן {% equation %}\mathbb{Z}_{n}^{*}{% endequation %} היא קבוצת כל המספרים שזרים ל-{% equation %}n{% endequation %} וקטנים ממנו. זה מסביר למה {% equation %}\mathbb{Z}{}_{7}^{*}=\left\{ 1,2,3,4,5,6\right\} {% endequation %}: עבור מספר ראשוני, כל מספר חיובי קטן ממנו זר לו. זה גם מסביר למה {% equation %}\mathbb{Z}_{6}^{*}=\left\{ 1,5\right\} {% endequation %}: 2 מחלק את 6 וכך גם 3, ואילו ל-4 יש מחלק משותף גדול מ-1 עם 6: 2.

אם כן, זהו חשבון מודולרי על קצה המזלג; ראינו מה ה"עולם" שבו הוא מתרחש ואיך לבצע במסגרתו את ארבע פעולות החשבון - חיבור, כפל, חיסור וחילוק. כמובן שזו רק ההתחלה (אפשר למשל לשאול מה קורה עבור הוצאת שורשים, וזה סיפור מרתק בפני עצמו) וכמובן שהשאלה המעניינת באמת היא איך משתמשים בכל זה. התשובה היא שיש שלל שימושים, שאת חלקם כבר הראיתי בבלוג; בזכות הפוסט הזה יהיה לי נוח יותר להראות שימושים נוספים בעתיד.

