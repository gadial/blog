---
title: "מה הקטע עם השלמת סדרות ואיך זה קשור לאינטרפולציה פולינומית?"
layout: post
categories:
  - אלגברה
tags:
  - אינטרפולציה פולינומית
---

ברשתות החברתיות יש הרבה סוגי שיקוצים שכל מטרתם היא למשוך אנשים כדי שיגיבו ואפילו טוב מכך - שיריבו, כי ריבים וסבל והרס שווים כסף עבור יוצרי השיקוצים הללו. ואחד מהשיקוצים הנאלחים ביותר הן חידות "מתמטיות" של השלמת סדרות. לדוגמא, זו:

<img src="{{site.baseurl}}{{site.post_images}}/2026/OnlyGenius.png" alt=""/>

יש כאן כמה דברים ממש מעצבנים עבורי: משפט המחץ על "רק גאון יכול לפתור", סכמת הצבעים הגועלית, השימוש הלא נכון בסימן "=" - אבל כל אלו שטויות, הדברים הללו מהונדסים כדי לעצבן וכדי שנגיב (אבל לא תגובה כמו שלי, של תלונה בבלוג, אלא תגובה לציוץ המקורי בטוויטר כדי להכניס כסף ליוצרים שלו). מעבר לדברים המעצבנים הללו, מה התוכן המתמטי שיש כאן? ובכן, זה משהו שעתיק בהרבה מהרשתות החברתיות - בעיה שבה מציגים לנו סדרה כלשהי של מספרים ושואלים מה האיבר הבא בסדרה. אבל צריך קצת להיזהר - כאן יש **שתי** סדרות של מספרים. בעצם, מראים לנו מין התאמה שכזו בין המספר מצד שמאל למספר מצד ימין, ואנחנו צריכים להבין את החוקיות של ההתאמה הזו וליישם את החוקיות הזו על האיבר האחרון.

תגובה נפוצה שלי על חידות כאלו היא שזה הכל בולשיט כי **כל** התאמה היא אפשרית. הרי כל ניחוש שלנו לגבי החוקיות כאן הוא ניחוש בלבד, ויש הרבה סדרות מספרים שבהן נדמה לנו שיש כלל טבעי נחמד אבל בעצם יש המון כללים אפשריים שנותנים תוצאות שונות. למשל, נניח שאני נותן את הסדרה {% equation %}2,3,5,7,11{% endequation %} ושואל מה האיבר הבא - לכאורה נראה ש-13 מתאים (זו התשובה שאני הייתי נותן) כי הסדרה כללה את כל המספרים הראשוניים עד וכולל 11 והבא בתור הוא 13. אבל בעצם, גם 101 מתאים אם אנחנו לא רוצים סתם מספרים ראשוניים אלא מספרים ראשוניים **פלינדרומיים**, כאלו שנכתבים בייצוג עשרוני בצורה כזו שאם הם נקראים מימין או משמאל הם אותו הדבר. או שאולי 17 הוא האיבר הבא בתור שמתאים כי הסדרה היא בכלל{% equation %}\left\lfloor \frac{3^{n}}{2^{n}}\right\rfloor{% endequation %} עבור {% equation %}n=2,3,4,5,6,7{% endequation %} ? ואולי האיבר הבא הוא 16 כי הסדרה סופרת כמה עלים יכולים להיות בעץ בינארי? את כל הדוגמאות הללו לא טרחתי להמציא - נכנסתי [לאתר המופלא](https://oeis.org/) של האנציקלופדיה לסדרות מספרים, הקלדתי {% equation %}2,3,5,7,11{% endequation %} ובדקתי אילו השלמות הזויות הוא ימצא לי. ככה זה - העולם גדול ורחב ומעניין וההמשך ה"טבעי" שאנחנו חושבים עליו הוא לאו דווקא מה שחשבו עליו כשיצרו את הסדרה.

אבל בואו ננסה לגשת לחידות הללו מנקודת מבט חיובית: נניח שכן יש פתרון אחד שהוא הרבה יותר סביר מכל פתרון אחר, וננסה למצוא אותו. הנה חידה שכזו, וריאציה על הסגנון של החידה הקודמת:

<img src="{{site.baseurl}}{{site.post_images}}/2026/OnlyGenius2.png" alt=""/>

אני אסביר בסוף את הפתרון של החידה הזו. בואו ננסה עכשיו לחשוב מה יכול להיות הפתרון של החידה הקודמת, זו שבה סדרת המספרים היא:

{% equation %}88,70,54,40,??{% endequation %}

 כשיש לנו סדרות של מספרים ואנחנו רוצים לדעת מה האיבר הבא, השאלה שאנחנו שואלים היא - נניח שהסדרה היא הדבר הכי **פשוט** שיכול להיות מבין כל מה שתואם את המספרים שאנחנו רואים - מהו הדבר הפשוט הזה?

הסדרה הכי פשוטה היא זו שבה כל הערכים הם **קבועים**, כלומר למשל {% equation %}42,42,42,42,\ldots{% endequation %} . אבל זו לא סדרה כזו מעניינת. דרך אחת לגוון היא שכל איבר יהיה שווה לאיבר הקודם **ועוד משהו**. לסדרה כזו קוראים "סדרה חשבונית". למשל הסדרה {% equation %}2,12,22,33,42,\ldots{% endequation %} היא כזו: כל איבר בה שווה לאיבר הקודם ועוד 10. סדרות כאלו לא חייבות לעלות, הן יכולות גם לרדת. למשל {% equation %}78,66,54,42,\ldots{% endequation %} היא סדרה שכל איבר בה שווה לאיבר הקודם ועוד {% equation %}-12{% endequation %} , כלומר פחות 12.

האם הסדרה {% equation %}88,70,54,40{% endequation %} היא חשבונית? לא, כי בואו נסתכל על הסדרה שמתקבלת ממנה כשלוקחים את **ההפרש** בין כל זוג איברים סמוך:

{% equation %}-18,-16,-14,\ldots{% endequation %}

 אבל - אה-הא! הסדרה הזו של **ההפרשים** היא כן סדרה חשבונית! בכל פעם מוסיפים 2 לאיבר הבא! אז אפשר לנחש שההפרש הבא יהיה {% equation %}-12{% endequation %} ! ולכן, אם מוסיפים {% equation %}-12{% endequation %} אל {% equation %}40{% endequation %} שהיה האיבר האחרון שראינו, מקבלים {% equation %}28{% endequation %} ולכן זה הפתרון!

נשמע סביר והגיוני? זה באמת סביר והגיוני! אבל נפלתי **במלכודת**. זכרו, החידה המקורית לא הייתה שעשוע מחשבה חביב למען רווחת הציבור; היא כלי שאנשים מניפולטיביים משתמשים בו כדי לעורר מהומות שיכניסו לכיסם כסף. אי לכך ובהתאם לזאת, החידה הזו כללה הטרלה: הטעיה מהסוג הניג'סי ביותר. כי אם נסתכל על העמודה השמאלית של המספרים, כתוב שם {% equation %}8,7,6,5,3{% endequation %} - שמים לב לקפיצה? ועכשיו יש שלושה סוגי פותרים: 1. פותרים שבכלל לא מתעניינים במה שקורה בעמודה השמאלית. מבחינתם מה שמגדיר את הסדרה הוא מה שיש בעמודה הימנית וזהו ולכן הפתרון הוא 28.

1. פותרים שרואים בעמודה השמאלית סוג של אינדקס ולכן אם קפצנו מ-5 אל 3 זה אומר שקפצנו על איבר, והאיבר הבא בתור אמור להיות 18 (למה? בשלב הזה כבר אפשר להבין) ולכן זה הפתרון.

1. פותרים שחושבים כמו האלו מ-2 אבל פשוט פספסו או שכחו את הקפיצה הזו וחושבים במובלע שכתוב שם 4 ולכן לדעתם התשובה אמורה להיות 28 והם ירגישו מה-זה מטומטמים כשיבינו שעבדו עליהם.

בגלל שיש כאן שתי תשובות לגיטימיות, זה מזמין ויכוחים ומהומות בין שני צדדים שכל אחד לשיטתו צודק לגמרי - ועוד גל של אנשים ש"טועים"ואחרים שיתקנו אותם, ואז הטועים יגידו וואי וואי וואי איזה טיפשים היינו ועוד ועוד מלל יישפך על הבעיה המיותרת הזו כדי שנצלן אינטרנטי כלשהו יקבל עוד כמה גרושים. כל זה לא חדש, זה כמו המהומות סביב המשוואה {% equation %}6\div2(1+2){% endequation %} [שכתבתי עליה פעם פוסט](https://gadial.net/2011/05/02/damn_stupid_equation/).

אבל אני רוצה לנצל את החידה הזו בצורה פרודקטיבית, כדי להציג משהו נחמד במתמטיקה. אז בשביל זה, בואו נפסיק לחשוב על {% equation %}88,70,54,40,??{% endequation %} סתם בתור "סדרה"ונחשוב עליה בתור "התאמה": אנחנו מתאימים ל-8 את 88, ול-7 את 70 וכן הלאה. להתאמות כאלו יש שם במתמטית: **פונקציות**. אני מסמן פונקציה עם סימון כמו {% equation %}f\left(x\right){% endequation %} שאומר "{% equation %}x{% endequation %} הוא **משתנה**, אפשר להציב בו ערכים שונים ומשונים, ו-{% equation %}f{% endequation %} זה הסימון שמתאר את הפונקציה עצמה וכשאני מציב ערך קונקרטי ב-{% equation %}x{% endequation %} היא מחזירה לי תוצאה קונקרטית". במקרה שלנו זה ייראה כך:

{% equation %}f\left(8\right)=88{% endequation %}

{% equation %}f\left(7\right)=70{% endequation %}

{% equation %}f\left(6\right)=54{% endequation %}

{% equation %}f\left(5\right)=40{% endequation %}

{% equation %}f\left(3\right)=??{% endequation %}

 לכתוב פונקציה על ידי כך שכותבים את כל הערכים שלה במפורש זה מעייף. השאלה המעניינת היא האם יש דרך **פשוטה** לכתוב פונקציה, ולעתים קרובות יש. בואו נסתכל לרגע על הסדרה {% equation %}2,12,22,33,42,\ldots{% endequation %} . נניח שהטור השמאלי של מספרים שמתאים לה הוא {% equation %}0,1,2,3,4,\ldots{% endequation %} . במקרה הזה, קל לכתוב את הפונקציה שיוצרת את ההתאמה בין שני הטורים:

{% equation %}f\left(x\right)=10x+2{% endequation %} מה זה אומר? זה מתכון לאיך ליצור את הפלט בהינתן הקלט. נתנו לנו {% equation %}x{% endequation %} ? נכפיל אותו ב-10 ונוסיף 2 לתוצאה. למשל {% equation %}f\left(3\right)=10\cdot3+2=32{% endequation %} . זה עובד תמיד - קיבלנו כתיב קומפקטי יחסית עבור הסדרה הזו.

האם אפשר לעשות את זה עבור החידה המקורית? הנה דרך לנסות לגלות. בואו נשתמש באותיות {% equation %}a,b{% endequation %} כדי לסמן מה שנקרא **פרמטרים** - ערכים מספריים שאני לא מתחייב עליהם כרגע. עכשיו אני אכתוב את הפונקציה בעזרת הפרמטרים:

{% equation %}f\left(x\right)=ax+b{% endequation %} הפונקציה {% equation %}f\left(x\right)=10x+2{% endequation %} שראינו לפני רגע התקבלה עבור הפרמטרים {% equation %}a=10{% endequation %} ו-{% equation %}b=2{% endequation %} , אבל כל הצבה של ערכים שונים לפרמטרים תניב לנו פונקציה שונה. מה ההבדל בין "משתנה"ובין "פרמטר"? אין הבדל עקרוני, פשוט אנחנו חושבים על הפרמטרים בתור משהו שאנחנו מציבים בו ערכים כדי לקבל **פונקציה** מתוך משפחה גדולה של פונקציות, ועל המשתנים בתור משהו שאנחנו מציבים בו ערך אחרי שכבר יש לנו ביד פונקציה קונקרטית, ואנחנו רוצים לדעת מה היא מחזירה על קלט קונקרטי.

יופי, אז אני מסמן {% equation %}f\left(x\right)=ax+b{% endequation %} . עכשיו, אני יודע ש-{% equation %}f\left(8\right)=99{% endequation %} אז אם אני אציב את זה בנוסחה אני אקבל

{% equation %}8a+b=88{% endequation %} זה נותן לנו קשר כלשהו שצריך להתקיים בין {% equation %}a,b{% endequation %} אבל יש המון דרכים שונות לקיים אותו. למשל, {% equation %}a=10,b=8{% endequation %} . או למשל, {% equation %}a=0,b=88{% endequation %} . זה יותר מדי חופש, אז בואו ננסה לבדוק איזה קשר {% equation %}f\left(7\right)=70{% endequation %} מציע:

{% equation %}7a+b=70{% endequation %} עכשיו קיבלנו מערכת של שתי משוואות בשני משתנים. אפשר לנקוט בתעלול נפוץ - **נחסר** את המשוואה השניה מהראשונה, מה שייתן לנו

{% equation %}a=18{% endequation %} ועכשיו אפשר להסיק מהמשוואה הראשונה לבדה ש-{% equation %}b=-56{% endequation %} , כלומר הפונקציה שלנו היא {% equation %}f\left(x\right)=18x-56{% endequation %} ...? זה היה... מפתיע? זה בהחלט לא היה הדבר הראשון שחשבנו עליו. אבל כן, אפשר להוכיח את זה (ואסביר בהמשך גם איך) - **אם** יש פונקציה מהצורה {% equation %}f\left(x\right)=ax+b{% endequation %} שמתארת את הסדרה שבחידה, זו **חייבת** להיות הפונקציה הזו.

רק שלרוע המזל, היא לא. אם נציב {% equation %}x=6{% endequation %} נקבל {% equation %}f\left(x\right)=52{% endequation %} וזה, מה לעשות, לא ה-54 שהיינו אמורים לקבל. כל מה שעשינו כרגע קרס ונחרב בקול רעש גדול. פשוט **לא קיימת** פונקציה מהצורה {% equation %}f\left(x\right)=ax+b{% endequation %} שמחזירה את הסדרה הזו.

אז בואו נתפשר על פונקציה קצת פחות פשוטה. כשמסתכלים על משהו כמו {% equation %}f\left(x\right)=10x+2{% endequation %} , אילו פעולות בעצם ביצענו עם {% equation %}x{% endequation %} המסכן? הרשינו **לחבר** לו מספר כלשהו (וגם לחסר - אם היינו מחברים מספר שלילי). גם הרשינו **לכפול** אותו במספר קבוע כמו 10 (ואם היינו כופלים ב-{% equation %}\frac{1}{2}{% endequation %} זה היה כמו לחלק ב-2). מה שלא עשינו היה להרשות ל-{% equation %}x{% endequation %} לבצע פעולות **עם עצמו**. עכשיו, אם אני מחבר את {% equation %}x{% endequation %} עם עצמו אני מקבל {% equation %}x+x=2x{% endequation %} וזה כאילו כפלתי אותו ב-2 ואת זה אנחנו כבר מרשים, אז זה לא מעניין. אבל מה אם אני יכול **לכפול** את {% equation %}x{% endequation %} בעצמו? אני אקבל את {% equation %}x^{2}{% endequation %} , וזה כבר משהו חדש. אולי פונקציה מהצורה {% equation %}f\left(x\right)=ax^{2}+bx+c{% endequation %} כן תעבוד לנו?

אפשר לעשות בדיוק את מה שעשינו קודם - להציב ערכים קונקרטיים בנוסחה הכללית הזו ולחלץ מהם קשרים בין {% equation %}a,b,c{% endequation %} . יש לנו שלושה משתנים אז נזדקק לשלוש משוואות. אני אציב את {% equation %}x=8,7,6{% endequation %} , אפשט ואקבל

{% equation %}64a+8b+c=88{% endequation %}

{% equation %}49a+7b+c=70{% endequation %}

{% equation %}36a+6b+c=54{% endequation %}

 נחסר את המשוואה השניה מהראשונה, ואת השלישית מהשניה, ונקבל

{% equation %}15a+b=18{% endequation %}

{% equation %}13a+b=16{% endequation %}

 נחסר את המשוואה השניה מהראשונה ונקבל

{% equation %}2a=2{% endequation %}

כלומר 

{% equation %}a=1{% endequation %}

 
 התקדמנו! נציב את זה בשתי המשוואות שקיבלנו לפני רגע ונקבל

{% equation %}15+b=18{% endequation %}

{% equation %}13+b=16{% endequation %}

 כלומר 
 
 {% equation %}b=3{% endequation %}
 
  התקדמנו! נציב את זה ב-{% equation %}64a+8b+c=88{% endequation %} שממנה התחלנו, ונקבל

{% equation %}64+24+c=88{% endequation %}

 כלומר 
 
 {% equation %}c=0{% endequation %}
 
  היי, זה יצא די פשוט! קיבלנו את הפונקציה {% equation %}f\left(x\right)=x^{2}+3x{% endequation %} . אם אציב {% equation %}x=3{% endequation %} אקבל {% equation %}f\left(3\right)=9+9=18{% endequation %} , וזו אכן התשובה ה"נכונה". יופי!

האם היה אפשר להגיע לזה יותר בקלות? בוודאי. כשאני ראיתי את החידה לא פתרתי אותה ככה. אמרתי לעצמי - "יש פה {% equation %}8{% endequation %} ו-{% equation %}88{% endequation %} , כלומר {% equation %}8{% endequation %} כפול 11. אה, השורה הבאה זה 7 כפול 10. הבנתי את הקטע, מה שכופלים בו גם כן קטן ב-1. ההפרש ביניהם יישאר 3 באופן קבוע, כלומר זו המכפלה {% equation %}x\left(x+3\right){% endequation %} ."זו בהחלט דרך סבירה להגיע לפתרון ואני מנחש שרוב הפותרים עושים משהו כזה, אבל מה שחשוב לי להדגיש פה הוא שיש דרך **מסודרת** להגיע לפתרון - בדיוק באמצעות כתיבת מערכת המשוואות שהצגתי. העניין הוא שיש דרך אפילו **עוד יותר מסודרת** ובמובן מסוים עוד יותר קלה להגיע לפתרון הזה - מה שנקרא **אינטרפולציה פולינומית**.

יש כאן שתי מילים מפחידות, נתחיל עם השניה. **פולינום** זה מה שמקבלים כשיש לנו ביד {% equation %}x{% endequation %} ואנחנו מתעללים בו בדרכים שכבר ראינו: מחברים אותו עם דברים וכופלים אותו עם דברים, כולל איתו עצמו. אם אני כופל את {% equation %}x{% endequation %} בעצמו פעם אחת אני מקבל את {% equation %}x^{2}{% endequation %} , אבל אפשר להמשיך עם זה ולקבל את {% equation %}x^{3}{% endequation %} ואת {% equation %}x^{4}{% endequation %} וכן הלאה. פולינום זה משהו שמתקבל אחרי מספר סופי של פעולות כאלו, ולא קשה להשתכנע שהצורה הכללית שלו תהיה

{% equation %}a_{n}x^{n}+a_{n-1}x^{n-1}+\ldots+a_{1}x+a_{0}{% endequation %} כש-{% equation %}a_{0},a_{1},\ldots,a_{n}{% endequation %} הם מספרים שאני מכנה **המקדמים** של הפולינום ({% equation %}a_{k}{% endequation %} הוא המקדם של החזקה {% equation %}x^{k}{% endequation %} של {% equation %}x{% endequation %} ), ואני גם מוסיף את הדרישה ש-{% equation %}a_{n}=0{% endequation %} , כלומר {% equation %}x^{n}{% endequation %} היא החזקה הכי גבוהה של {% equation %}x{% endequation %} שמופיעה בפולינום הזה. הנתון הזה - מה החזקה הכי גבוהה של {% equation %}x{% endequation %} שמופיעה בפולינום - הוא די חשוב, אז אני נותן לו שם: **הדרגה** של הפולינום, או **המעלה** שלו (אלו מילים נרדפות פה). אז למשל {% equation %}x^{2}+3x{% endequation %} שראינו קודם הוא פולינום ממעלה שניה. כשבתיכון לומדים "לפתור משוואות ממעלה שניה"בעצם מה שקורה הוא שנתון פולינום {% equation %}p\left(x\right)=ax^{2}+bx+c{% endequation %} ממעלה שניה, ומחפשים ערכים להציב בו כך שיתקיים {% equation %}p\left(x\right)=0{% endequation %} .

יש בעולם עוד כל מני דברים חוץ מפולינומים, למשל הפונקציה {% equation %}f\left(x\right)=2^{x}{% endequation %} היא לא פולינום, וגם {% equation %}f\left(x\right)=\sin x{% endequation %} וכדומה. מה שמעניין בפולינומים הוא שהם פונקציות **פשוטות** יחסית - ראינו שהם נבנים רק מפעולות חשבון הבסיסיות של חיבור, חיסור וכפל - אפילו לא חילוק! (אם היינו מרשים חילוק היינו מקבלים אובייקטים כמו {% equation %}\frac{1}{1+x}{% endequation %} שהם מעניינים בפני עצמם אבל הם לא פולינומים והסיפור שלהם מסובך יותר). הפשטות הזו מובילה לכך שבהרבה מקרים כשיש לנו פונקציה מסובכת, או מידע מבולגן, אנחנו שואלים את עצמנו - האם אפשר לתאר את אותו הדבר בעזרת פולינום? אולי אפילו רק **בערך**?

התשובה למרבה השמחה היא "כן", מתברר שפולינומים הם עניין מועיל בשלל הקשרים. למשל הפונקציה {% equation %}f\left(x\right)=\sin x{% endequation %} שהזכרתי לפני שניה ממודלת לא רע על ידי הפולינום {% equation %}x-\frac{x^{3}}{6}+\frac{x^{5}}{120}{% endequation %} עבור ערכים קרובים לאפס של {% equation %}x{% endequation %} (ועבור ערכים רחוקים מאפס עדיין אפשר להיעזר בפולינום הזה תוך התבססות על כך שסינוס זו פונקציה שחוזרת שוב ושוב על תבנית בסיסית קטנה יחסית - אני מדבר על זה [כאן](https://gadial.net/2021/05/13/trigonometry_intro/)). אפשר ובצדק לשאול מאיפה הפולינום המוזר הזה צץ - זה קשור למשהו שנקרא **טורי טיילור** ולא אכנס אליו פה אבל [יש לי פוסט](https://gadial.net/2024/05/03/taylor_series/) בנושא. אני רוצה לדבר הפעם על שימוש אחר בפולינומים לצורך קירובים - בפרט עבור המקרה של "מידע מבולגן"שהזכרתי.

הרעיון הוא כזה - נניח שיש לנו אוסף של פרטי מידע של זוגות מספרים. בואו נראה דוגמא עם נתונים שלקחתי מהאינטרנט ואין לי מושג אם הם נכונים - **מרחק עצירה**:

<img src="{{site.baseurl}}{{site.post_images}}/2026/stopping_distance.png" alt=""/>

מרחק עצירה הוא המרחק שרכב עובר במקרה של בלימת פתע, החל מהרגע שבו הנהג מזהה את הסכנה שמצריכה בלימת פתע ועד שהרכב עוצר בפועל. זה כולל את המרחק שהרכב עובר בזמן שלוקח לנהג להתחיל לבלום, ואת המרחק שהוא עובר בזמן שהרכב מאט עד לעצירה מוחלטת. מן הסתם המרחק הזה מושפע משלל גורמים, החל במהירות התגובה של הנהג וכלה באיכות הבלמים של הרכב. לכן מלכתחילה הנתון הזה הוא לא איזו אמת מתמטית אבסולוטית שנחתה עלינו משמיים אלא **הערכה** בלבד, שהדרך הנכונה לאסוף אותה היא לבחון אותה בשטח ולקחת... ממוצע? עזבו, אני אפילו לא בטוח שזו הדרך הנכונה לאמוד אותה. אני כאמור נקטתי בשיטה הלא כל כך אמינה "לגגל באקראי באינטרנט כי אני בסך הכל רוצה מספרים לעבוד איתם".

מבין כל הגורמים שמשפיעים על מרחק העצירה, מה הכי קריטי? שוב, בלי ניסוי מסודר קשה לדעת, אבל די סביר להניח ש**מהירות** הרכב הנוסע תהיה קריטית - רכב שנוסע מהר יותר לוקח יותר זמן לעצור, ובזמן שלוקח לעצור אותו הוא נוסע מרחק גדול יותר. אז הדיאגרמה שלנו מציגה את הזוגות של מהירות ומרחק העצירה שמתאים לה. הזוגות הם:

{% equation %}\left(20,8\right),\left(30,15\right),\left(40,23\right),\left(50,33\right),\left(60,45\right),\left(70,60\right),\left(80,78\right),\left(90,95\right),\left(100,114\right){% endequation %} הנתונים שלקחתי נותנים את מרחק העצירה עבור מהירויות שמתחלקות ב-10, אבל מה אם אני רוצה לדעת את מרחק העצירה עבור 13? ובכלל, אם אני רוצה לדעת מה הפונקציה שמחזירה לכל מהירות את מרחק העצירה שמתאים לה? ובכן, אף אחד לא אומר שהפונקציה הזו הולכת להיראות נחמד - ככה זה עם מידע "מלוכלך"מהעולם האמיתי. אבל אם אני רוצה פונקציה פשוטה, אני יכול לקבל את זה שהיא בסך הכל תהיה **קירוב** של הדבר האמיתי, וכל עוד זה קירוב לא רע אני אהיה בסדר עם זה. קירוב כזה נקרא **מודל** ובסטטיסטיקה אוהבים להגיד "כל המודלים שגויים; חלקם יעילים"כדי שלא נשלה את עצמנו שהמודל הוא-הוא המציאות.

בסטטיסטיקה יש תחום שלם שמוקדש למציאת המודל ה"אופטימלי", כזה שמביא למינימום את השגיאה בין המודל ובין המידע הנצפה, ומודל כזה נקרא **רגרסיה** וזה תחום מרתק שלא אגיד עליו כלום הפעם כי אני רוצה להסתפק בדיבור על משהו פשוט - אני רוצה למצוא מודל שמתאים **בדיוק** לחלק מהנתונים, ואני אהיה בסדר עם זה שהוא לא יתאר את היתר בצורה אופטימלית. ואני ארצה שהמודל שלי יהיה **פולינום**.

הזוג הראשון של קלט/פלט הוא {% equation %}\left(20,9\right){% endequation %} . הנה פולינום פשוט שעל קלט 20 מחזיר פלט 9: {% equation %}p\left(x\right)=9{% endequation %} . זה... קצת כמו רמאות? פולינום שבכלל לא מתייחס ל-{% equation %}x{% endequation %} ? כן, אבל הוא עובד! אבל בסדר, ברור שהוא לא עובד **טוב**. למשל, הזוג השני הוא {% equation %}\left(30,15\right){% endequation %} והפולינום המגוחך שלנו מחזיר 9 גם על הקלט 30 וזה כבר די רחוק מהמספר הנכון. אז אנחנו רוצים פולינום שבו {% equation %}x{% endequation %} כן משתתף. אבל שימו לב רגע למשהו: הזוג {% equation %}\left(80,78\right){% endequation %} . בזוג הזה הקלט גדול **פי ****4** מאשר בזוג {% equation %}\left(20,9\right){% endequation %} אבל הפלט גדול **פי ****9**(בערך). זה רומז לנו שהיחס בין הקלט לפלט הוא לא יחס ישר (מה שפולינום ממעלה ראשונה מתאר) אלא יותר מזה - אז מה שמעניין אותי הוא למצוא פולינום **ממעלה שניה** שמתאים לנתונים. איך נעשה את זה? וכמה פולינומים כאלו יש? כאן אני רוצה לגלוש טיפה לתיאוריה.

הנה הטענה התיאורטית המרכזית: אם יש לי סדרה של {% equation %}d+1{% endequation %} זוגות, {% equation %}\left(x_{0},y_{0}\right),\ldots,\left(x_{d},y_{d}\right){% endequation %} אז **קיים** פולינום **יחיד** {% equation %}p\left(x\right){% endequation %} ממעלה לכל היותר {% equation %}d{% endequation %} כך ש-{% equation %}p\left(x_{i}\right)=y_{i}{% endequation %} לכל {% equation %}0\le i\le d{% endequation %} .

מכירות את הקטע הזה של "דרך כל שתי נקודות עובר קו ישר יחיד"? זה בדיוק זה - קו ישר הוא פונקציה שאפשר לתאר על ידי פולינום ממעלה ראשונה, ושני נקודות הן שני זוגות {% equation %}\left(x,y\right){% endequation %} של מספרים. אז שתי נקודות קובעות חד משמעית קו ישר, ושלוש נקודות יקבעו חד משמעית פרבולה/מעגל (אלו אובייקטים שמתוארים על ידי משוואה ממעלה שניה, אם כי בצורה טיפה יותר מסובכת מאשר סתם פולינום אבל זה מגיע מאותו מקום) וכן הלאה. אני קודם רוצה להסביר למה הפולינום הזה הוא **יחיד** ואז נגיע לאקשן האמיתי - איך למצוא אותו.

היחידות נובעת מטענה יותר בסיסית על פולינומים: לפולינום ממעלה {% equation %}d{% endequation %} יש לכל היותר {% equation %}d{% endequation %} שורשים - כש"שורש"הוא מספר שמציבים בפולינום ומחזיר 0. בהינתן הטענה הזו, הטענה על היחידות די קלה. נניח שיש לנו שני פולינומים {% equation %}p\left(x\right),q\left(x\right){% endequation %} ממעלה לכל היותר {% equation %}d{% endequation %} כך ששניהם מקיימים {% equation %}p\left(x_{i}\right)=y_{i}=q\left(x_{i}\right){% endequation %} לכל {% equation %}1\le i\le d{% endequation %} . עכשיו, בואו נסתכל על ההפרש שלהם, {% equation %}a\left(x\right)=p\left(x\right)-q\left(x\right){% endequation %} . **גם ההפרש הוא פולינום** ממעלה לכל היותר {% equation %}d{% endequation %} , אבל הוא מקיים {% equation %}a\left(x_{i}\right)=p\left(x_{i}\right)-q\left(x_{i}\right)=0{% endequation %} לכל {% equation %}0\le x_{i}\le d{% endequation %} , כלומר יש לו {% equation %}d+1{% endequation %} שורשים **שונים**(אני מניח שכל ה-{% equation %}x{% endequation %} -ים שונים אחד מהשני כי אם אותו {% equation %}x{% endequation %} מופיע פעמיים זה חייב להיות עם אותו {% equation %}y{% endequation %} כי הרי זו פונקציה, אבל אז סתם שכפלתי מידע קיים ולא הוספתי מידע חדש). לכאורה הגענו לסתירה, אבל יש חריג אחד למשפט שאמרתי קודם - אם הפולינום הוא פולינום **האפס**, כלומר הפולינום {% equation %}a\left(x\right)=0{% endequation %} , אז מן הסתם יש לו אינסוף שורשים - לכן לפעמים מגדירים את הדרגה שלו בתור {% equation %}\infty{% endequation %} במקום 0 כמו שנראה שזה אמור להיות. אבל אם {% equation %}p\left(x\right)-q\left(x\right)=a\left(x\right)=0{% endequation %} אז {% equation %}p\left(x\right)=q\left(x\right){% endequation %} לכל נקודה, מה שמראה את היחידות.

אם אני כבר בשוונג - למה המשפט על "לכל היותר {% equation %}d{% endequation %} שורשים"הוא נכון? זו כבר טיפה סטייה מהנושא אבל למה לא. בבסיס העניין נמצאת העובדה שאפשר **לחלק** פולינומים: אם יש לנו {% equation %}a\left(x\right),b\left(x\right){% endequation %} אז קיימים {% equation %}q\left(x\right),r\left(x\right){% endequation %} כך ש-{% equation %}a\left(x\right)=q\left(x\right)b\left(x\right)+r\left(x\right){% endequation %} כך שדרגת {% equation %}r{% endequation %} קטנה ממש מדרגת {% equation %}q{% endequation %} (או ש-{% equation %}r{% endequation %} הוא פולינום האפס).

עכשיו, אם {% equation %}p\left(x\right){% endequation %} הוא פולינום ו-{% equation %}\alpha{% endequation %} הוא שורש שלו, כלומר {% equation %}p\left(\alpha\right)=0{% endequation %} , אז בואו נחלק את {% equation %}p{% endequation %} בפולינום ממעלה ראשונה {% equation %}x-\alpha{% endequation %} : נקבל שיש {% equation %}q\left(x\right){% endequation %} ו-{% equation %}r\left(x\right){% endequation %} כך ש-{% equation %}p\left(x\right)=q\left(x\right)\left(x-\alpha\right)+r\left(x\right){% endequation %} . אם נציב עכשיו {% equation %}x=\alpha{% endequation %} אז נקבל:

{% equation %}0=p\left(\alpha\right)=q\left(\alpha\right)\left(\alpha-\alpha\right)r\left(\alpha\right)=r\left(\alpha\right){% endequation %} העניין הוא ש-{% equation %}r{% endequation %} הוא ממעלה קטנה מ-{% equation %}x-\alpha{% endequation %} , כלומר הוא ממעלה 0 **או** שהוא פולינום האפס. אבל אם הוא ממעלה 0, כלומר קבוע, והוא שווה ל-{% equation %}0{% endequation %} כש"מציבים"בו {% equation %}\alpha{% endequation %} הוא חייב להיות קבוע 0. המסקנה היא ש-{% equation %}\left(x-\alpha\right){% endequation %} מחלק את {% equation %}p\left(x\right){% endequation %} ללא שארית, עבור כל שורש {% equation %}\alpha{% endequation %} של {% equation %}p\left(x\right){% endequation %} . כלומר, {% equation %}p\left(x\right)=q\left(x\right)\left(x-\alpha\right){% endequation %} - כאן {% equation %}q{% endequation %} הוא ה"מנה"של החלוקה. שימו לב שכל שורש של {% equation %}p{% endequation %} ששונה מ-{% equation %}\alpha{% endequation %} יהיה גם שורש של {% equation %}q{% endequation %} .

עכשיו אפשר להוכיח את הטענה על מספר השורשים באינדוקציה: לפולינום ממעלה 1 בבירור יש רק שורש אחד (כי פולינום כללי ממעלה {% equation %}1{% endequation %} הוא מהצורה {% equation %}ax+b{% endequation %} כאשר {% equation %}a\ne0{% endequation %} וזה מתאפס אך ורק עבור {% equation %}x=-\frac{b}{a}{% endequation %} ). נניח שלפולינום ממעלה {% equation %}d{% endequation %} יש לכל היותר {% equation %}d{% endequation %} שורשים, אז עבור פולינום ממעלה {% equation %}d+1{% endequation %} , אם קיים לו שורש {% equation %}\alpha{% endequation %} אז נחלק אותו ב-{% equation %}x-\alpha{% endequation %} , נקבל פולינום ממעלה {% equation %}d{% endequation %} , נפעיל עליו את הנחת האינדוקציה - יש לו לכל היותר {% equation %}d{% endequation %} שורשים. נצרף אליהם את {% equation %}\alpha{% endequation %} וקיבלנו של-{% equation %}p{% endequation %} יש לכל היותר {% equation %}d+1{% endequation %} שורשים, וסיימנו.

כמובן, עדיין לא הוכחתי את הטענה על חלוקת פולינומים, אבל נראה לי שאעצור כאן - רק שימו לב שהטענה הזו **לא נכונה** באופן כללי; זה תלוי איפה הפולינומים "חיים". אצלנו אני מניח במובלע שהפולינומים הם עם מקדמים **ממשיים**, אבל בסיטואציות יותר מורכבות (פולינומים מעל שדות סופיים למשל) לא בהכרח מתקיימת תכונת החלוקה היפה שדיברתי עליה ולפולינום ממעלה {% equation %}d{% endequation %} יכולים להיות יותר מ-{% equation %}d{% endequation %} שורשים (דוגמא קלאסית למי שמכירות: מעל {% equation %}\mathbb{Z}_{8}{% endequation %} לפולינום {% equation %}x^{2}-1{% endequation %} יש ארבעה שורשים).

חזרה אלינו - הראיתי שאם יש פולינום אינטרפולציה של {% equation %}d+1{% endequation %} נקודות אז הוא יחיד (מבין כל הפולינומים ממעלה עד וכולל {% equation %}d{% endequation %} ). אבל איך מוצאים אותו? יש לכך כמה דרכים, ואני אראה את הדרך הנפוצה - **אינטרפולציית לגראנז'**. אני יכול כמובן פשוט להפיל עלינו את הנוסחה ה"מפחידה", לתת לכולנו להיבהל ואז להסביר מה הולך שם - אבל אני לא אוהב את הגישה הזו, אני מעדיף להראות בדיוק מאיפה הנוסחה הזו מגיעה לפני שמציגים אותה בשלמותה. ולמרבה המזל, הרעיון הבסיסי שמאחוריה הוא פשוט מאוד.

בואו נחזור על מה שיש לנו - אוסף של {% equation %}d+1{% endequation %} זוגות קלט/פלט: {% equation %}\left(x_{0},y_{0}\right),\ldots,\left(x_{d},y_{d}\right){% endequation %} . אני רוצה לבנות פולינום {% equation %}p\left(x\right){% endequation %} שמקיים {% equation %}p\left(x_{i}\right)=y_{i}{% endequation %} עבור {% equation %}0\le i\le d{% endequation %} . עכשיו, בואו נניח שהצלחתי למצוא בדרך פלא פולינום {% equation %}p_{i}{% endequation %} שהוא בעל התכונה המופלאה הבאה: על {% equation %}x_{i}{% endequation %} הוא מחזיר את {% equation %}y_{i}{% endequation %} ועל כל {% equation %}x_{j}{% endequation %} אחר מבין הקלטים הוא מחזיר 0. כלומר

{% equation %}p_{i}\left(x_{j}\right)=\begin{cases}
y_{i} & j=i\\
0 & j\ne i
\end{cases}{% endequation %}

 אם מצאתי {% equation %}p_{i}{% endequation %} כזה לכל {% equation %}0\le i\le d{% endequation %} , סיימתי! אני אגדיר {% equation %}p\left(x\right)=p_{0}\left(x\right)+p_{1}\left(x\right)+\ldots+p_{d}\left(x\right){% endequation %} , ועכשיו כשאני מציב {% equation %}x_{i}{% endequation %} ב-{% equation %}p{% endequation %} , כל המחוברים מתאפסים חוץ מ-{% equation %}p_{i}\left(x_{i}\right)=y_{i}{% endequation %} .

אז המטרה שלי עכשיו היא להבין איך לממש את {% equation %}p_{i}{% endequation %} . אבל לפני כן, בואו נציב לעצמנו מטרה קצת יותר צנועה - לבנות פולינום שמתאפס על כל {% equation %}x_{j}{% endequation %} עבורו {% equation %}j\ne i{% endequation %} , ולא חשוב כרגע מה הוא מחזיר על {% equation %}x_{i}{% endequation %} . האם אנחנו יודעים לבנות פולינום כזה? ובכן, כן! ראינו את זה לפני רגע למעשה. ראינו שאם {% equation %}\alpha{% endequation %} מאפס פולינום כלשהו, הפולינום **חייב** להתחלק ב-{% equation %}x-\alpha{% endequation %} , ולכן פולינום שמתאפס על כל {% equation %}x_{j}{% endequation %} כך ש-{% equation %}j\ne i{% endequation %} **חייב** להתחלק בכל ה-{% equation %}x-x_{j}{% endequation %} -ים הללו. אז בואו פשוט נכפול את כולם:

{% equation %}p_{i}\left(x\right)=\left(x-x_{0}\right)\left(x-x_{1}\right)\ldots\left(x-x_{i-1}\right)\left(x-x_{i+1}\right)\ldots\left(x-x_{d}\right){% endequation %}

 אוקיי הצילו, זה כתיב מסורבל מדי. בואו נכניס את הכתיב המקובל לכפל מקוצר:

{% equation %}p_{i}\left(x\right)=\prod_{j\ne j}\left(x-x_{j}\right){% endequation %}

 הבעיה עם הפולינום הזה היא שכשמציבים בו {% equation %}x_{i}{% endequation %} , לא מקבלים את {% equation %}y_{i}{% endequation %} . מקבלים איזה שהוא ערך שהוא עיסת מישמש לא ברורה:

{% equation %}p_{i}\left(x_{i}\right)=\prod_{j\ne j}\left(x_{i}-x_{j}\right){% endequation %} 

**אין לי מושג** מה המספר הזה, אני רק יודע שהוא לא 0, כי {% equation %}x_{i}-x_{j}\ne0{% endequation %} לכל {% equation %}i\ne j{% endequation %} . ואם המספר הזה הוא לא 0 אז אפשר **לחלק** בו. אז בואו נגדיר מחדש את {% equation %}p_{i}{% endequation %} :

{% equation %}p_{i}\left(x\right)=\prod_{i\ne j}\frac{x-x_{j}}{x_{i}-x_{j}}{% endequation %}

 הפולינום הזה הוא בעל תכונה מאוד נחמדה:

{% equation %}p_{i}\left(x_{j}\right)=\begin{cases}
1 & j=i\\
0 & j\ne i
\end{cases}{% endequation %}

 מה שעשיתי כאן נקרא **לנרמל** - היה לי משהו שהגודל שלו הוא לא 1, אז חילקתי אותו בגודל שלו והופס, קיבלתי משהו מגודל 1. זה מעולה, אבל אני הרי רציתי שהפולינום יחזיר {% equation %}y_{i}{% endequation %} . למרבה המזל, מרגע שנירמלתי אני פשוט יכול לכפול את הכל ב-{% equation %}y_{i}{% endequation %} , כלומר להגיע להגדרה הסופית של {% equation %}p_{i}{% endequation %} :

{% equation %}p_{i}\left(x\right)=\prod_{i\ne j}\frac{x-x_{j}}{x_{i}-x_{j}}y_{i}{% endequation %}

 ועכשיו אפשר להשתמש בסימון המקוצר לחיבור, ולקבל את פולינום האינטרפולציה:

{% equation %}p\left(x\right)=\sum_{i=0}^{d}\prod_{i\ne j}\frac{x-x_{j}}{x_{i}-x_{j}}y_{i}{% endequation %}

 הפולינום הזה **עובד**. שימו לב לכך שהוא ממעלה {% equation %}d{% endequation %} , כי במכפלה {% equation %}\prod_{i\ne j}\frac{x-x_{j}}{x_{i}-x_{j}}{% endequation %} משתתפים רק {% equation %}d{% endequation %} מוכפלים, כל אחד מהם תורם 1 לחזקה של {% equation %}x{% endequation %} . סיימנו! זו הנוסחה המפחידה שדיברתי עליה!

עכשיו אפשר לחזור אל הנתונים הגולמיים שראינו קודם. אם נלך לנתוני מרחק העצירה, ונבצע אינטרפולציה על הנקודות {% equation %}\left(20,9\right),\left(30,15\right),\left(40,23\right){% endequation %} נקבל את הפולינום {% equation %}\frac{x^{2}}{100}+\frac{x}{10}+3{% endequation %} ובאמת אם ננסה להציב בו {% equation %}20,30,40{% endequation %} נקבל {% equation %}9,15,23{% endequation %} בהתאמה. קסם! אבל מה עם יתר הערכים שיש לנו? אם נציב 50 נקבל 33 ואם נציב 60 נקבל 45, בדיוק כמו בנתונים שלנו! אבל... אם נציב 70 נקבל 59, לא 60. כאן המודל שלנו כבר חורג מהתוצאות הנצפות בפועל.

כמובן, אפשר לנסות לבצע אינטרפולציה חדשה שכוללת את אותן הנקודות {% equation %}\left(20,9\right),\left(30,15\right),\left(40,23\right){% endequation %} מקודם ובנוסף לכך את הנקודה החדשה {% equation %}\left(70,60\right){% endequation %} . התוצאה תהיה פולינום ממעלה שלוש שנראה די מפחיד:

{% equation %}\frac{x^{3}}{6000}+\frac{17x^{2}}{2000}+\frac{43x}{300}+\frac{13}{5}{% endequation %} הפולינום הזה תואם את כל הנקודות שהזנתי לאינטרפולציה, אבל הוא מזייף בנקודות אחרות. למשל, עבור {% equation %}80{% endequation %} הוא יחזיר 77 ולא 78. אבל גרוע מכך, על 50 הוא יחזיר {% equation %}\frac{331}{10}=33.1{% endequation %} , לא 33 - איבדנו תוצאה שקיבלנו קודם "במזל"(כי היא הייתה על ערך שלא השתתף באינטרפולציה). אני חושב שהרעיון ברור - אינטרפולציה במובן שהצגתי כאן נותנת התאמה מדויקת לערכים שהזנתי לה, במחיר של ויתור על כל יתר הערכים שלא הזנתי. לכן השיטה הזו היא רק תחילת הסיפור, לא סופו. אבל זו התחלה יפה!

בואו נחזור עכשיו לחידה מתחילת הפוסט:

<img src="{{site.baseurl}}{{site.post_images}}/2026/OnlyGenius.png" alt=""/>

מה שיש לנו פה הוא את סדרת הנקודות {% equation %}\left(8,88\right),\left(7,70\right),\left(6,54\right),\left(5,40\right){% endequation %} . להזין את זה לנוסחת האינטרפולציה יניב באופן לא מפתיע את הפולינום {% equation %}x^{2}+3x{% endequation %} שהצבה של 3 בו מחזירה 18. האם זה אומר ש-18 הוא אכן הפתרון לחידה? רק אם אנחנו בוחרים להניח שהחידה שואלת משהו בסגנון "אם מוצאים פונקציה פשוטה ביותר שמייצגת את הקשר שמעביר את הקלטים באגף שמאל לפלטים באף ימין ומציבים בה את הערך התחתון ביותר באגף שמאל מה נקבל?" ומוסיפים על זה את ההנחה ש"פשוטה ביותר" זה "פולינומית ממעלה מינימלית". אז כן, אפשר להניח את כל ההנחות הללו, אבל... במקרה הזה, מה בעצם נשאר מהחידה? כמו שאנחנו רואים, אין כאן חשיבה, יש אלגוריתם אינטרפולציה כללי שפשוט צריך להפעיל אותו פה. **מה הכיף כאן?** אוקיי, ומה עם החידה השניה שהצגתי?

<img src="{{site.baseurl}}{{site.post_images}}/2026/OnlyGenius2.png" alt=""/>

כאן אינטרפולציה של ארבעת הזוגות הראשונים תניב את הפולינום {% equation %}p\left(x\right)=-32335x^{3}+392510x^{2}-950185x+591010{% endequation %} שאיך נגיד, לא מעורר תחושות פשוטות במיוחד. להציב בו {% equation %}x=5{% endequation %} ייתן {% equation %}1610960{% endequation %} שהוא... מספר... כלשהו? מה הקטע פה? ובכן הקטע כמובן הוא שסדרת המספרים הזו **לא** הגיעה משום פולינום או משום דבר מתמטי כלשהו אלא מהראש המאוד כאוטי של דני סנדרסון - ההתאמה פה היא "{% equation %}n{% endequation %} עובר למספר שאותו שרים בשורה ה-{% equation %}n{% endequation %} בבית האחרון של השיר 'אלף כבאים'": 

<blockquote>
<p>אלף כבאים, לא יצליחו לכבות</p>
<p>אלפיים צבעים, לא יצליחו לכבות</p>
<p>ארבע מאות אלף פרשים, לא יצליחו לכבות</p>
<p>מיליון ותשע מאות תשעים, לא יצליחו לכבות</p>
<p>אלף כבאים, לא יצליחו לכבות אותי</p>
</blockquote>
אז התשובה היא 1,000. סליחה, פולינומים, מתברר שפשוט יש דברים שאתם לא מתאימים להם. 