---
id: 198
title: "על סכומי ריבועים והקשר להדדיות ריבועית"
date: 2009-06-26 13:02:57
layout: post
categories: 
  - תורת המספרים
---
<a href="http://www.gadial.net/2009/02/15/constructing_regular_polygons/">לא מזמן</a> הרשיתי לעצמי ללכלך על <a href="http://he.wikipedia.org/wiki/%D7%A4%D7%99%D7%99%D7%A8_%D7%93%D7%94_%D7%A4%D7%A8%D7%9E%D7%94">פרמה</a> ועל ההשערה הלא כל כך מוצלחת שלו בדבר ראשוניותם של מספרי פרמה. כפיצוי, אני רוצה לעסוק הפעם באחת מהתוצאות המוצלחות של פרמה - תוצאה שהיא דוגמה נאה לדחיפה שפרמה נתן לתורת המספרים, ובפרט לעיסוק של <a href="http://he.wikipedia.org/wiki/%D7%9C%D7%90%D7%95%D7%A0%D7%A8%D7%93_%D7%90%D7%95%D7%99%D7%9C%D7%A8">לאונרד אוילר</a> בה. פרט לכך שהתוצאה של פרמה מעניינת לכשעצמה, הטיפול של אוילר בה מגרד את הסף של אחד מהמשפטים החשובים (ועם זאת, הבסיסיים, כך שאפילו אני מכיר אותו) בתורת המספרים - משפט ההדדיות הריבועית. היופי שבדבר הוא שהגישה של אוילר מגיעה אל המשפט הזה מכיוון שונה לגמרי מאשר זה שבו הוא בדרך כלל מוצג (ואותו הכרתי), ודרך זו היא במובן מסויים "טבעית" יותר. בפוסט הזה אציג את המשפט בצורה סטנדרטית; אני מקווה להציג את הגישה של אוילר בפוסט נפרד.

אם כן, נתחיל מהתחלה. פרמה נהג, כידוע, לתאר תגליות מתמטית במכתבים לידידים, לרוב בלי הוכחה של ממש. כך היה גם במכתב מ-1640 למרסן (אותו מרסן ממספרי מרסן שגם כן הזכרתי כשדיברתי על פרמה). פרמה טען שהוא יודע מתי מספר ראשוני {% equation %}p{% endequation %} ניתן להצגה כסכום של שני ריבועים שלמים, כלומר {% equation %}p=x^{2}+y^{2}{% endequation %} עם {% equation %}x,y{% endequation %} שלמים; הוא טען שזה מתרחש בדיוק כאשר {% equation %}p{% endequation %} מותיר שארית של 1 כאשר מחלקים אותו ב-4. בכתיבה מודרנית, זה מתואר כך: {% equation %}p\equiv1\left(4\right){% endequation %}. פרמה לא עצר כאן - הוא טען שניתן להציג את {% equation %}p{% endequation %} בתור {% equation %}p=x^{2}+2y^{2}{% endequation %} בדיוק כאשר {% equation %}p\equiv1,3\left(8\right){% endequation %}, ולקינוח טען שניתן להציג את {% equation %}p{% endequation %} בתור {% equation %}p=x^{2}+3y^{2}{% endequation %} אך ורק כאשר {% equation %}p\equiv1\left(3\right){% endequation %} (או כאשר {% equation %}p=3{% endequation %} בעצמו, אבל זה מקרה בודד ולכן לא מעניין). תאמרו שלא ברור למה להתעמק דווקא בראשוניים ולא בכל המספרים - הסיבה לכך היא שכל מספר ניתן לכתיבה כמכפלה של ראשוניים, ולכן הבנת הטענה על הראשוניים היא הצעד הראשון והחשוב ביותר בדרך לטענה כללית על כל המספרים.

פרמה טען במכתב שיש לו "הוכחות מוצקות" לטענות הללו, אך לא כתב אותן. למעשה, לא כל כך ברור מה היו ההוכחות שלו - פשפוש בכתביו מעלה רק הוכחה בסגנון הבא: "אם {% equation %}p\equiv1\left(4\right){% endequation %} אבל לא ניתן להציג אותו כסכום ריבועים, אז חייב להיות ראשוני קטן יותר מאותה הצורה שגם אותו לא ניתן להציג כסכום של שני ריבועים, וכן הלאה בנסיגה אינסופית עד שמגיעים ל-5 - סתירה". זו לא ממש הוכחה - פרמה לא מסביר למה <strong>יש</strong> ראשוני קטן יותר, או <strong>איך</strong> למצוא אותו. נעשו ניתוחים כלשהם של כתבי פרמה שניסו לשחזר הוכחה מסודרת יותר, אך לא אכנס אליהם כאן כי אני רוצה להעביר את הכדור לאוילר - ואוילר, כששמע על פרמה ומשפטיו, לא ידע הרבה יותר משאנחנו יודעים. המשפטים הללו של פרמה נראה לו כמו השערות מעניינות (ואכן, פרמה דייק לגמרי; המשפטים הללו נכונים), אך הייתה חסרה לו ההוכחה.

אוילר שמע על פרמה לראשונה בגיל 22, בשנת 1729, בהתכתבות עם גולדבך (אותו גולדבך מ<a href="http://he.wikipedia.org/wiki/%D7%94%D7%A9%D7%A2%D7%A8%D7%AA_%D7%92%D7%95%D7%9C%D7%93%D7%91%D7%9A">השערת גולדבך</a>, שלמעשה הייתה השערה שאוילר העלה, בתגובה להשערה פשוטה יותר של גולדבך). במכתבו הראשון של גולדבך לאוילר הוא הזכיר את השערתו של פרמה באשר למספרי פרמה. שלוש שנים לאחר מכן חיסל אותה אוילר על ידי כך שמצא מחלק למספר פרמה הבא בתור. כאמור, אוילר לא היה מרוצה במיוחד מההוכחות והרמזים של פרמה באשר למשפטים שלו על סכומי ריבועים, וניסה להוכיח אותם בעצמו. אפשר לחלק באופן גס את ההוכחה שלו לשני שלבים - שלב הנסיגה, שהוא ניסוח פורמלי של הטענה של פרמה; ושלב ההדדיות, ש"מתניע" את הנסיגה.

מבחינה היסטורית, את שלב הנסיגה אוילר סיים יחסית מהר - הוא תיאר אותו במכתב לגולדבך בשנת 1741. רק בשנת 1749 עלה בידי אוילר לפתור את שלב ההדדיות עבור המקרה של {% equation %}p=x^{2}+y^{2}{% endequation %}; המקרים האחרים דרשו לו זמן רב יותר, והעבודה נשלמה רק בשנת 1772 - יותר מ-40 שנים לאחר שאוילר שמע על הבעיה לראשונה.

בין לבין הוא עשה עוד דברים.

ובכן, מהם שני השלבים? אתאר ראשית את שלב הנסיגה עבור המקרה של סכום שני ריבועים, שהוא הפשוט ביותר; בשני המקרים האחרים ההכללה די מיידית אך מעט יותר מסובכת. אני מזהיר מראש שהשלב הזה טכני למדי ואינו המטרה העיקרית שלי בפוסט, כך שמי שמתייאש יכול לדלג. שלב הנסיגה אומר שאם הראשוני {% equation %}p{% endequation %} <strong>מחלק</strong> סכום של שני ריבועים, {% equation %}a^{2}+b^{2}{% endequation %}, אז הוא ניתן לכתיבה כסכום של שני ריבועים בעצמו. ההוכחה של הטענה הולכת כך: מניחים שלא ניתן לכתוב את {% equation %}p{% endequation %} כסכום של שני ריבועים, ומוכיחים כי נובע מכך שקיים ראשוני {% equation %}q&lt;p{% endequation %} שגם הוא מחלק סכום של שני ריבועים אך אינו ניתן לכתיבה כסכום של שני ריבועים. מכאן שאפשר שוב לחזור על הטענה ולקבל עוד ראשוני {% equation %}q^{\prime}&lt;q{% endequation %} שגם כן מקיים את התכונה הזו, וכן הלאה וכן הלאה - וכך נגיע לראשוניים קטנים יותר ויותר, עד שניתקע עם ראשוני קטן מדי, שכן ניתן להציג כסכום של שני ריבועים (למשל, 2).

עד כה לא אמרנו הרבה יותר מאשר פרמה - רק פרטים קצת יותר מדוייקים. עלינו להראות כיצד, בהינתן {% equation %}p{% endequation %} שמחלק סכום של שני ריבועים אך אינו סכום שכזה בעצמו, ניתן למצוא {% equation %}q&lt;p{% endequation %} דומה. לב העניין הוא באבחנה שאם {% equation %}N=a^{2}+b^{2}{% endequation %} הוא סכום של שני ריבועים זרים ("זרים" פירושו שאין ל-{% equation %}a,b{% endequation %} מחלק משותף גדול מ-1) ו-{% equation %}q{% endequation %} הוא ראשוני שהוא בעצמו סכום של שני ריבועים, אז גם {% equation %}\frac{N}{q}{% endequation %} הוא סכום של שני ריבועים זרים. ההוכחה של האבחנה הזו היא טכנית ומכילה כמה משוואות ואני מעדיף לא להיכנס אליה.

אם כן, נתון לנו ש-{% equation %}N=a^{2}+b^{2}{% endequation %}, כך ש-{% equation %}p|a^{2}+b^{2}{% endequation %} (הקו פירושו "{% equation %}p{% endequation %} מחלק את {% equation %}a^{2}+b^{2}{% endequation %}"). נשים לב שאפשר לחסר או לחבר את {% equation %}p{% endequation %} בחופשיות הן ל-{% equation %}a{% endequation %} והן ל-{% equation %}b{% endequation %} ועדיין ש-{% equation %}p{% endequation %} יחלק את סכום הריבועים שלהם (בדקו זאת!), ולכן אפשר להניח כי שניהם קטנים יחסית ל-{% equation %}p{% endequation %}, נניח {% equation %}\left|a\right|,\left|b\right|&lt;\frac{p}{2}{% endequation %} (אחרת אפשר לחסר מהם את {% equation %}p{% endequation %} שוב ושוב עד שהם נהיים קטנים מספיק). אחרי שעשינו זאת צריך לחלק את {% equation %}a,b{% endequation %} שקיבלנו בגורם המשותף הגדול ביותר שלהם כדי להבטיח ששני המספרים שנקבל יהיו זרים זה לזה (למה {% equation %}p{% endequation %} עדיין יחלק את {% equation %}a^{2}+b^{2}{% endequation %} גם אחרי שנחלק אותם בגורם הזה? כי {% equation %}p{% endequation %} לא מחלק את הגורם הזה בעצמו - למה, ולמה זה מספיק?)

אם כן, נסכם את מה שמגיעים אליו: שקיים {% equation %}N=a^{2}+b^{2}{% endequation %} כך ש-{% equation %}p|N{% endequation %} וכמו כן {% equation %}a,b{% endequation %} זרים זה לזה ומקיימים {% equation %}\left|a\right|,\left|b\right|&lt;\frac{p}{2}{% endequation %}, כלומר {% equation %}N=a^{2}+b^{2}&lt;\frac{p^{2}}{4}+\frac{p^{2}}{4}=\frac{p^{2}}{2}{% endequation %}. מכאן עולה שאם {% equation %}q{% endequation %} הוא גורם ראשוני של {% equation %}N{% endequation %} השונה מ-{% equation %}p{% endequation %}, הוא בהכרח קטן מ-{% equation %}p{% endequation %}; אחרת היינו מקבלים {% equation %}\frac{p^{2}}{2}&gt;N\ge pq\ge p^{2}{% endequation %} - סתירה. כעת, אם {% equation %}q{% endequation %} הוא סכום של שני ריבועים, אז מהאבחנה שתיארתי לעיל היה נובע שגם {% equation %}\frac{N}{q}{% endequation %} הוא סכום של שני ריבועים; ואם היינו חוזרים על החלוקה הזו לכל גורם של {% equation %}N{% endequation %} שאיננו {% equation %}p{% endequation %}, היינו מקבלים בסופו של דבר את {% equation %}p{% endequation %} כסכום של שני ריבועים (וזה מה שרצינו). לכן אם {% equation %}p{% endequation %} איננו סכום של שני ריבועים, אז קיים {% equation %}q&lt;p{% endequation %} שגם הוא איננו סכום של שני ריבועים, ועם זאת {% equation %}q|N=a^{2}+b^{2}{% endequation %}, כלומר זה הראשוני הקטן יותר שחיפשנו - וזה מסיים את ההוכחה.

אני מניח שההוכחה הזו מעט קשה לעיכול למי שטרם רגיל לתורת המספרים האלמנטרית, שטיעוני חלוקה כאלו הם די סטנדרטיים בה. מי שלא הצליח לעקוב אחרי כל השלבים - לא נורא, מדובר בסופו של דבר בהוכחה טכנית יחסית, אבל זהו צעד ראשון הכרחי לפני שעוברים לשלב השני בהוכחה של אוילר.

השלב השני בהוכחה של אוילר הוא מה שמכונה "שלב ההדדיות". בשלב הנסיגה, נקודת המוצא הייתה ש-{% equation %}p{% endequation %} מחלק סכום של שני ריבועים, או בלשון מודרנית, ש-{% equation %}a^{2}+b^{2}\equiv0\left(p\right){% endequation %}, עבור {% equation %}a,b{% endequation %} זרים (ולכן בפרט לא שקולים שניהם לאפס מודולו {% equation %}p{% endequation %} - כלומר, אנחנו רוצים פתרון "לא טריוויאלי" למשוואה). האתגר של שלב ההדדיות הוא להראות עבור אילו ערכי {% equation %}p{% endequation %} הדבר הזה מתקיים. אוילר הוכיח בשיטה משלו - חשבון הפרשים, המקבילה הדיסקרטית של החשבון הדיפרנציאלי, נושא מעניין לכשעצמו - כי כדי שלמשוואה הזו יהיה פתרון צריך להתקיים {% equation %}p\equiv1\left(4\right){% endequation %}. עם זאת, אני רוצה לגשת לשאלה הזו מנקודת מבט מעט יותר מודרנית, ותוך התייחסות לשתי הבעיות הנוספות - אוילר גם רצה לדעת באילו תנאים על {% equation %}p{% endequation %} יש פתרון למשוואה {% equation %}a^{2}+2b^{2}\equiv0\left(p\right){% endequation %}, ובאילו תנאים יש פתרון למשוואה {% equation %}a^{2}+3b^{2}\equiv0\left(p\right){% endequation %}.

נתחיל מהמשוואה {% equation %}a^{2}+b^{2}\equiv0\left(p\right){% endequation %}. על ידי העברת אגפים נקבל {% equation %}a^{2}\equiv-b^{2}\left(p\right){% endequation %}. מכיוון שאנו מניחים ש-{% equation %}b\not\equiv0\left(p\right){% endequation %} (כי {% equation %}b\equiv0\left(p\right){% endequation %} יתן לנו את הפתרון הטריוויאלי של המשוואה, שכאמור לא מועיל לנו) אפשר לחלק בו ולקבל {% equation %}\left(\frac{a}{b}\right)^{2}\equiv-1\left(p\right){% endequation %}. על ידי החלפת משתנים אפשר לכתוב את המשוואה הזו בתור {% equation %}x^{2}\equiv-1\left(p\right){% endequation %}. כלומר, הצטמצמנו לשאלה הבאה: מתי {% equation %}-1{% endequation %} הוא ריבוע מודולו {% equation %}p{% endequation %}? ובטרמינולוגיה שבדרך כלל משתמשים בה: מתי {% equation %}-1{% endequation %} הוא <strong>שארית ריבועית</strong> מודולו {% equation %}p{% endequation %}?

נעבור למשוואה השניה. אחרי העברת אגפים וחלוקה נקבל את השאלה מתי {% equation %}-2{% endequation %} הוא שארית ריבועית מודולו {% equation %}p{% endequation %}. המשוואה השלישית תצטמצם לשאלה (הפתעה הפתעה) מתי {% equation %}-3{% endequation %} הוא שארית ריבועית מודולו {% equation %}p{% endequation %}. אם כן, זו שאלה מעניינת באופן כללי - איך ניגשים אליה?

כדי לטפל בבעיה הזו בצורה רצינית, מאוד מועיל לבצע שינוי נוסף של נקודת המבט - במקום להמשיך לדבר על מספרים מודולו {% equation %}p{% endequation %} כל הזמן, אפשר לעבור ולדבר על איברים ב<a href="http://he.wikipedia.org/wiki/%D7%97%D7%91%D7%95%D7%A8%D7%94_)%D7%9E%D7%91%D7%A0%D7%94_%D7%90%D7%9C%D7%92%D7%91%D7%A8%D7%99(">חבורה</a> {% equation %}\mathbb{Z}_{p}^{*}{% endequation %} - אוסף כל המספרים {% equation %}\left\{ 1,\dots,p-1\right\} {% endequation %} עם פעולה של כפל מודולו {% equation %}p{% endequation %} (כופלים שני מספרים, מחלקים ב-{% equation %}p{% endequation %} והתוצאה היא השארית). החבורה הזו היא אחד מהאובייקטים הבסיסיים בתורת המספרים, וידוע עליה הרבה מאוד - בפרט, שהיא ציקלית, כלומר לכל {% equation %}p{% endequation %} קיים {% equation %}g\in\mathbb{Z}_{p}^{*}{% endequation %} כך שכל איבר {% equation %}a\in\mathbb{Z}_{p}^{*}{% endequation %} ניתן לכתיבה בתור {% equation %}a=g^{k}{% endequation %} עבור {% equation %}k{% endequation %} מתאים כלשהו. ברור שאם {% equation %}a=g^{2k}{% endequation %}, כלומר {% equation %}a{% endequation %} הוא חזקה זוגית של {% equation %}g{% endequation %}, אז {% equation %}a{% endequation %} הוא שארית ריבועית, כי הוא ניתן לכתיבה בתור {% equation %}\left(g^{k}\right)^{2}{% endequation %}; ניתן להראות גם את ההפך, שאם {% equation %}a=g^{2k+1}{% endequation %}, כלומר הוא חזקה אי זוגית, אז הוא אינו שארית ריבועית (זהו תרגיל נחמד לאלו מכם שבקיאים בתורת החבורות). כעת, {% equation %}g{% endequation %} מקיים {% equation %}g^{p-1}=1{% endequation %} (זהו "<a href="http://he.wikipedia.org/wiki/%D7%94%D7%9E%D7%A9%D7%A4%D7%98_%D7%94%D7%A7%D7%98%D7%9F_%D7%A9%D7%9C_%D7%A4%D7%A8%D7%9E%D7%94">המשפט הקטן של פרמה</a>"), ולכן ברור שאם {% equation %}a=g^{2k}{% endequation %} אז {% equation %}a^{\frac{p-1}{2}}=\left(g^{p-1}\right)^{k}=1{% endequation %}; ולעומת זאת, אם {% equation %}a=g^{2k+1}{% endequation %} אז {% equation %}a^{\frac{p-1}{2}}=\left(g^{2k}\cdot g\right)^{\frac{p-1}{2}}=\left(g^{p-1}\right)^{k}\cdot g^{\frac{p-1}{2}}=g^{\frac{p-1}{2}}=-1{% endequation %} - שוב, הבקיאים בתורת החבורות ודאי ירצו להצדיק לעצמם את המעבר האחרון, דהיינו ש-{% equation %}g^{\frac{p-1}{2}}=-1{% endequation %} (רמז: מהו אגף שמאל בריבוע? ומדוע ידוע לנו שאגף שמאל שונה מ-1?). האבחנות הללו מובילות אותנו למה שמכונה "קריטריון אוילר" (אם כי לא ברור לי כלל שאוילר הגיע אליו כך): מספר {% equation %}a{% endequation %} הוא שארית ריבועית מודולו {% equation %}p{% endequation %} אם ורק אם {% equation %}a^{\frac{p-1}{2}}\equiv1\left(p\right){% endequation %}.

הקריטריון הזה מחסל לנו מייד את המקרה של {% equation %}-1{% endequation %}: {% equation %}\left(-1\right)^{\frac{p-1}{2}}=1{% endequation %} אם ורק אם {% equation %}\frac{p-1}{2}{% endequation %} הוא זוגי, כלומר אם ורק אם {% equation %}p-1{% endequation %} מתחלק ב-4, כלומר אם ורק אם {% equation %}p\equiv1\left(4\right){% endequation %}. כדי להתחיל את הטיפול במקרים האחרים, אני רוצה להכניס לתמונה סימון נוח - סימן לג'נדר. סימן לג'נדר של {% equation %}a{% endequation %} מעל {% equation %}p{% endequation %} מסומן בתור {% equation %}\left(\frac{a}{p}\right){% endequation %}, מה שמזכיר באופן מבלבל שבר, אבל ניתן כמעט תמיד להבין מההקשר שמדובר בסימן לג'נדר ולא בשבר. הוא מוגדר כך: אם {% equation %}a{% endequation %} אינו זר ל-{% equation %}p{% endequation %}, אז {% equation %}\left(\frac{a}{p}\right)=0{% endequation %}; אם {% equation %}a{% endequation %} הוא שארית ריבועית מודולו {% equation %}p{% endequation %} אז {% equation %}\left(\frac{a}{p}\right)=1{% endequation %}, ואם הוא אינו שארית ריבועית מודולו {% equation %}p{% endequation %}, אז {% equation %}\left(\frac{a}{p}\right)=-1{% endequation %}. אם כן, את קריטריון אוילר ניתן לכתוב בצורה קומפקטית באופן הבא: {% equation %}\left(\frac{a}{p}\right)\equiv a^{\frac{p-1}{2}}\left(p\right){% endequation %}.

סימן לג'נדר מאפשר לנו לתת תיאור קומפקטי של עוד עובדות בסיסיות, למשל {% equation %}\left(\frac{ab}{p}\right)=\left(\frac{a}{p}\right)\left(\frac{b}{p}\right){% endequation %} - נסו להבהיר לעצמכם שאתם מבינים מה זה אומר (ולבקיאים בתורת החבורות - איך להוכיח את זה?). כמו כן, אם {% equation %}a\equiv b\left(p\right){% endequation %} אז {% equation %}\left(\frac{a}{p}\right)=\left(\frac{b}{p}\right){% endequation %}. לבסוף, הוא מאפשר לנו לתאר בצורה פשוטה גם את התכונה המשמעותית ביותר של שאריות ריבועיות - <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A9%D7%A4%D7%98_%D7%94%D7%94%D7%93%D7%93%D7%99%D7%95%D7%AA_%D7%94%D7%A8%D7%99%D7%91%D7%95%D7%A2%D7%99%D7%AA;">משפט ההדדיות הריבועית</a>. הוא מנוסח בפשטות כך: אם {% equation %}p,q{% endequation %} שניהם ראשוניים אי זוגיים שונים זה מזה, אז מתקיים הקשר הבא: {% equation %}\left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=\left(-1\right)^{\left(\frac{p-1}{2}\right)\left(\frac{q-1}{2}\right)}{% endequation %}. בניסוח מילולי, אפשר לומר שמשפט ההדדיות אומר שסימן לג'נדר של {% equation %}p{% endequation %} מעל {% equation %}q{% endequation %} וסימן לג'נדר של {% equation %}q{% endequation %} מעל {% equation %}p{% endequation %} הם זהים תמיד, פרט למקרה שבו {% equation %}p\equiv q\equiv3\left(4\right){% endequation %}, ואז הם הפוכים זה לזה.

הפעם לא אבקש מבקיאים בתורת החבורות להוכיח את המשפט - אף שעלה בידי אוילר לשער את המשפט הזה (בניסוח שקול אך שונה למדי), הראשון שהוכיח אותו היה גאוס, וגם זה לאחר שהמשפט "ייסר אותי במשך שנה" כפי שהוא כתב ביומנו. גאוס אהב את המשפט הזה כל כך עד שנתן לו שש הוכחות שונות, וכיום ידועות עוד רבות נוספות - אך אף אחת מהן אינה טריוויאלית. מדובר ללא ספק במשפט "עמוק" (אם כי, כרגיל במתמטיקה, הוא מהווה רק את קצה הקרחון של תורה שלמה ועמוקה פי כמה, שבסופה נמצא <a href="http://en.wikipedia.org/wiki/Artin_reciprocity_law">משפט הדדיות כללי וחזק פי כמה וכמה</a>).

לא אכנס כאן לניתוח של השאלה מתי {% equation %}-2{% endequation %} הוא שארית ריבועית מודולו {% equation %}p{% endequation %} (מן הסתם המסקנה הסופית היא ש-{% equation %}p\equiv1,3\left(8\right){% endequation %}) כי הוא טכני ולא מחכים עד כדי כך. לעומת זאת, הניתוח של המקרה של {% equation %}-3{% endequation %} נותן לנו הזדמנות יפה לראות את משפט ההדדיות הריבועית בשיא כוחו (והעובדה שאני נזקק להדדיות ריבועית רומזת משהו על הקושי שהיה לאוילר, שלא הכיר את משפט ההדדיות הריבועית, כשניסה לטפל במקרה הזה בעצמו). זאת מכיוון ש-3 הוא ראשוני, ולכן אפשר להשתמש בו בתור ה-{% equation %}q{% endequation %} שמופיע במשפט ההדדיות הריבועית. היתרון של משפט ההדדיות הריבועית יהיה בכך שהוא יהפוך את השאלה "מתי {% equation %}3{% endequation %} הוא שארית ריבועית מודולו {% equation %}p{% endequation %}?" לשאלה "מתי {% equation %}p{% endequation %} הוא שארית ריבועית מודולו 3?", ומהתכונה שהצגתי קודם, לפיה אם {% equation %}a\equiv b\left(q\right){% endequation %} אז {% equation %}\left(\frac{a}{q}\right)=\left(\frac{b}{q}\right){% endequation %} אפשר לראות שזו שאלה יחסית קלה כי מספיק לבדוק באופן ישיר מספר קטן של מקרים: לא קשה לראות כי {% equation %}\left(\frac{1}{3}\right)=1{% endequation %} ואילו {% equation %}\left(\frac{2}{3}\right)=-1{% endequation %}.

אם כן, נשתמש בהדדיות ריבועית ובמה שכבר גילינו על {% equation %}\left(\frac{-1}{p}\right)=\left(-1\right)^{\frac{p-1}{2}}{% endequation %} ונקבל את החישוב הישיר הבא:

{% equation %}\left(\frac{-3}{p}\right) = \left(\frac{-1}{p}\right)\left(\frac{3}{p}\right)=\left(-1\right)^{\frac{p-1}{2}}\left(\frac{p}{3}\right)\left(-1\right)^{\frac{p-1}{2}}=\left(\frac{p}{3}\right){% endequation %}

כלומר, משפט ההדדיות הריבועית לימד אותנו ש-{% equation %}\left(\frac{-3}{p}\right){% endequation %} הוא <strong>בדיוק</strong> {% equation %}\left(\frac{p}{3}\right){% endequation %}, ולכן הוא 1 אם ורק אם {% equation %}p\equiv1\left(3\right){% endequation %}, בדיוק כפי שציפינו שנקבל. כמובן שהשתמשתי כאן בתותח כבד; אבל מכיוון שמטרת הפוסט העיקרית הייתה להציג את התותח הזה, אין לי חרטות.
