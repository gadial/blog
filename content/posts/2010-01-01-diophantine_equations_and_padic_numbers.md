---
id: 223
title: "משוואות דיופנטיות, ולמה בגללן אנחנו מתעניינים במספרים p-אדיים?"
date: 2010-01-01 13:38:11
layout: post
categories: 
  - תורת המספרים
tags: 
  - המשפט האחרון של פרמה
  - משוואות דיופנטיות
  - משוואת פל
  - משפט השאריות הסיני
---
לפעמים מתקבל הרושם השגוי שמה שהמתמטיקאים עוסקים בו הוא "פתרון משוואות". לכן מחשבים אנושיים שמסוגלים לומר מהו השורש השביעי של 5434245346 תוך חלקיק שניה נחשבים מייד לעילויי מתמטיקה. כמובן שהמתמטיקה ה"אמיתית" אינה כזו, ועם זאת העיסוק במשוואות הוא עדיין מרכזי מאוד במתמטיקה - אך באיזה מובן? מה שהמתמטיקאי עושה איננו לפתור משוואות ספציפיות על ידי הפעלה של אלגוריתם ידוע כלשהו - הוא עוסק במציאת <strong>דרכים</strong> לפתור משוואות, בפיתוח אלגוריתמים חדשים למציאת הפתרון, ובחקירת התכונות של הפתרונות.

הדוגמה הקלאסית היא משוואות ממעלה שניה. כל תלמיד תיכון יודע שכדי למצוא את פתרונות המשוואה {% equation %}ax^{2}+bx+c=0{% endequation %} יש לחשב את {% equation %}\frac{-b\pm\sqrt{b^{2}-4ac}}{2a}{% endequation %}, וחלק נכבד מלימודי המתמטיקה בתיכון מוקדש להצבת דברים בנוסחה זו. המתמטיקאי לא מציב בנוסחה זו להנאתו; כשהוא אומר שהוא "פותר משוואות ממעלה שנייה", כוונתו לכך שהוא <strong><a href="http://www.gadial.net/2008/01/26/solving_quadratic_equations/">מוצא את הנוסחה</a></strong> הזו מלכתחילה. ואכן, על פניו לא ברור למה הנוסחה עובדת בכלל; יש כאן מין "קסם", שמהנוסחה המפחידה הזו יוצאים הפתרונות של המשוואה. זהו תפקידו של המתמטיקאי לגלות את הקסם ולתרגם אותו לשיטת פעולה פשוטה יחסית - במקרה זה, הצבה בנוסחה.

בפוסט הזה ובהמשכים שלו אני רוצה להתמקד במחלקה מיוחדת וחשובה ביותר של משוואות - <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A9%D7%95%D7%95%D7%90%D7%94_%D7%93%D7%99%D7%95%D7%A4%D7%A0%D7%98%D7%99%D7%AA">משוואות דיופנטיות</a>. משוואה דיופנטית היא משוואה בנעלם אחד או יותר, שכל המקדמים בה הם מספרים שלמים, והפתרונות שאנו מחפשים גם הם מספרים שלמים (לעתים מרשים גם מספרים רציונליים כי ניתן לתרגם משוואה רציונלית שכזו למשוואה בשלמים, אבל ברשותכם לא אכנס לכך). משוואות דיופנטיות הן טבעיות מאוד, כי המספרים שאנו פוגשים בחיי היום-יום הם מספרים שלמים (ורציונליים), ופתרונות שאינם שלמים לרוב אינם מועילים לנו. דוגמה חביבה לכך היא בעיית כדורי התותח: נשאלת השאלה האם ניתן לקחת קבוצת כדורי תותח המסודרת על הקרקע בריבוע מושלם (כלומר, אין בו חורים של כדורים חסרים), ולבנות מהם פירמידה מושלמת (פירמידה במקרה זה מורכבת מריבוע עם אורך צלע {% equation %}k{% endequation %} של כדורים, שעליו מושם ריבוע עם אורך צלע {% equation %}k-1{% endequation %} וכן הלאה). כלומר, השאלה היא האם קיימים {% equation %}k,n{% endequation %} כך ש-{% equation %}\sum_{i=1}^{k}i^{2}=n^{2}{% endequation %}. נוסחה ידועה עבור הסכום שבאגף שמאל נותנת את המשוואה {% equation %}\frac{k\left(k+1\right)\left(2k+1\right)}{6}-n^{2}=0{% endequation %}. זוהי משוואה בשני נעלמים עם מקדמים רציונליים - את המקדמים הרציונליים אפשר לבטל על ידי הוצאת גורם משותף, כך שמתקבלת בסופו של דבר המשוואה הדיופנטית הבאה: {% equation %}k\left(k+1\right)\left(2k+1\right)-6n^{2}=0{% endequation %}. מן הסתם פתרון שאיננו שלם למשוואה הזו הוא חסר טעם - אנחנו לא יכולים להשתעשע עם מחצית כדור תותח, או עם {% equation %}\frac{1}{\pi}{% endequation %} כדור תותח. אם כן, מהם פתרונות המשוואה? אפשר לגלות על ידי ניסוי וטעייה ש-{% equation %}\left(1,1\right){% endequation %} ו-{% equation %}\left(24,70\right){% endequation %} הם פתרונות, אבל האם קיימים עוד? מסתבר שלא, אך ההוכחה אינה פשוטה בכלל.

וכאן אנחנו מגיעים לנקודה המרכזית שלי - העיסוק במשוואות דיופנטיות איננו קל, בכלל. הוא מאוד, מאוד קשה. כל כך קשה, שאפשר לכתוב ספרים שלמים רק על משוואה אחת (אני טיפה מגזים אך תכף אסביר). כל כך קשה שתורות מתמטיות שלמות מפותחות סביב מקרים פרטיים של משוואות. דיופנטיות. כל כך קשה עד ש<a href="http://he.wikipedia.org/wiki/%D7%94%D7%91%D7%A2%D7%99%D7%94_%D7%94%D7%A2%D7%A9%D7%99%D7%A8%D7%99%D7%AA_%D7%A9%D7%9C_%D7%94%D7%99%D7%9C%D7%91%D7%A8%D7%98">יש הוכחה מתמטית</a> לכך שאין שום אלגוריתם שבהינתן משוואה דיופנטית אומר אם היא פתירה או לא (ומכאן שיש משוואות שאין לנו שום דרך לדעת שאינן פתירות). קשה, קשה, קשה.

דוגמה: <a href="http://he.wikipedia.org/wiki/%D7%94%D7%9E%D7%A9%D7%A4%D7%98_%D7%94%D7%90%D7%97%D7%A8%D7%95%D7%9F_%D7%A9%D7%9C_%D7%A4%D7%A8%D7%9E%D7%94">המשפט האחרון של פרמה</a>. המשוואה הדיופנטית {% equation %}x^{2}+y^{2}=z^{2}{% endequation %} ניתנת לפתרון - למעשה, יש לה אינסוף פתרונות, וזו שאלה מעניינת (אם כי בעלת <a href="http://www.gadial.net/2008/11/04/pythagorean_triplets/">תשובה פשוטה יחסית</a>) למצוא את כולם. והנה בא פרמה וטען שהוא סגר את כל המשוואות הדומות: שכל משוואה מהצורה {% equation %}x^{n}+y^{n}=z^{n}{% endequation %} אינה ניתנת לפתרון כאשר {% equation %}n{% endequation %} טבעי גדול מ-2. נדרשו כ-300 שנים להוכחת הטענה הזו, כשבאמצע הדרך מומצא התחום של תורת המספרים האלגברית כדי לטפל במקרים פרטיים שלה. הפתרון מגיע בסופו של דבר מתחום שעוסק בפתרונות של משוואות דיופנטיות אחרות - משוואות מהצורה {% equation %}y^{2}=x^{3}+ax+b{% endequation %} - "עקומים אליפטיים". למעשה, בהקשר של משפט פרמה העניין הוא בפתרונות רציונליים של המשוואה ולא רק שלמים, אך גם לזה לא אוכל להיכנס כרגע.

עוד דוגמה יפה במיוחד היא <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A9%D7%95%D7%95%D7%90%D7%AA_%D7%A4%D7%9C">משוואת פל</a> - משוואה מהצורה {% equation %}x^{2}-Dy^{2}=1{% endequation %} עבור {% equation %}D{% endequation %} שאינו ריבוע (יש עוד הכללות שלה - ה-1 באגף ימין יכול להיות מוחלף במספרים אחרים, במחיר סיבוך של התורה). המשוואה הזו נראית לא מזיקה ממבט ראשון, אבל יש לה נטייה לצוץ בהקשרים רבים ושונים. אחד מהחביבים עלי הוא בחידה מס' 100 מפרויקט אוילר: יש קופסה עם כדורים אדומים וכחולים, ואנו שולפים שניים באקראי. מה צריך להיות הרכב הכדורים בתיבה כדי שההסתברות ששני הכדורים שישלפו יהיו כחולים תהיה בדיוק חצי? הרכב אפשרי אחד הוא של 15 כדורים כחולים ו-6 כדורים אדומים, אבל יש מן הסתם הרכבים רבים נוספים. אפשר לתרגם באופן מסויים את מציאתם למציאת פתרונות עבור משוואת פל מסויימת (עם מינוס 1 באגף ימין ולא 1, אך ההבדל כאמור אינו כה גדול).

למשוואת פל (כפי שראיתם, מדובר בעצם על "משפחה" של משוואות, כתלות ב-{% equation %}D{% endequation %} ואולי גם במה שבאגף ימין) יש תורה מפותחת ויפה, שעליה באמת נכתבו ספרים שלמים. בבסיסה, הרעיון הוא כזה: למשוואה יש אינסוף פתרונות, שאחד מהם, שהוא במובן מסויים הקטן ביותר, "מייצר" את כל היתר (ניתן לחשוב עליהם כעל חזקה שלו, כשחושבים על הפתרונות כאיברים בתוך הרחבה מסויימת של המספרים השלמים). כדי למצוא את הפתרון היסודי הזה משתמשים בשיטות שמערבות את התורה של שברים משולבים. בקיצור, כיף חיים. ארחיב על כך בפוסט נפרד מתישהו.

הסיבה שבגללה אני מזכיר כעת את עולם המשוואות הדיופנטיות היא שאני רוצה להשתמש בהן בתור המוטיבציה להצגת יצורים מתמטיים מעניינים מאוד ומוזרים מאוד במבט ראשון - המספרים ה-p-אדיים. בפרט, המוטיבציה שלי תהיה משפט ידוע של הסה ומינקובסקי על פתרון של משוואות דיופנטיות ריבועיות (ליתר דיוק - תבניות ריבועיות), הקושר בין הפתירות של משוואות כאלו ובין הפתירות שלהן במספרים p-אדיים. חשוב להבהיר שמדובר במוטיבציה בלבד - למספרים ה-p-אדיים שימושים רבים ושונים בתורת המספרים שאת רובם אני בכלל לא מכיר.

ראשית, שימו לב שמשוואה דיופנטית הופכת למעניינת רק מרגע שיש בה שני משתנים או יותר. אם {% equation %}p\left(x\right){% endequation %} הוא פולינום במשתנה יחיד, אז אין קושי מהותי למצוא את כל השורשים שלו תוך שימוש בשיטות אנליטיות (<a href="http://www.gadial.net/2007/10/31/finding_square_roots/">ניוטון-רפסון</a>, למשל) - ולבדוק פרטנית לכל שורש האם הוא מספר שלם או לא (ניוטון-רפסון נותן רק קירוב וכשאנו עובדים במחשב יש לנו דיוק מוגבל; אבל אם קיבלנו שהשורש הוא בערך 4.0000001, נוכל פשוט להציב 4 בפולינום ולבדוק אם קיבלנו אפס). הסיבה שבגללה זה כל כך קל היא שיש ל-{% equation %}p\left(x\right){% endequation %} מספר סופי של שורשים (לכל היותר כדרגת {% equation %}p{% endequation %}). לעומת זאת, למשוואה בשני נעלמים ויותר יכולים להיות אינסוף פתרונות (כך המצב במשוואת פל, למשל) ולכן שיטה אנליטית כמו זו שהצעתי עובדת הרבה פחות טוב. אם קיים פתרון, אז המצב לא כל כך גרוע - תמיד אפשר יהיה למצוא אותו, ולו על ידי בדיקה סדרתית של כל ההצבות האפשריות למשתנים; מה שמעניין אותנו הוא לגלות מתי למשוואה אין בכלל פתרון (אני כמובן מגזים - אחד מהדברים החשובים במשוואת פל הוא שכל כך קל <strong>לחשב</strong> את הפתרונות).

בואו נביט לרגע במשוואה {% equation %}2x+4y=3{% endequation %}. האם קיים למשוואה פתרון? מייד אפשר לראות שהתשובה שלילית. למה? כי המספר שבאגף ימין אי זוגי, ואילו לא משנה מה נציב בתור {% equation %}x,y{% endequation %} באגף שמאל, נקבל שם מספר זוגי.

באופן דומה גם למשוואה {% equation %}3x^{2}+9y^{17}=5{% endequation %} אין פתרון, הפעם בגלל תכונת התחלקות ב-3. הדרך לטפל באופן מסודר בכללי האצבע הללו היא להסתכל על המשוואות <a href="http://he.wikipedia.org/wiki/%D7%97%D7%A9%D7%91%D7%95%D7%9F_%D7%9E%D7%95%D7%93%D7%95%D7%9C%D7%A8%D7%99">מודולו</a> מספר כלשהו {% equation %}n{% endequation %}.

חשבון מודולו {% equation %}n{% endequation %} דומה לחשבון רגיל, תחת המגבלה שאחרי שאנו מבצעים פעולה כלשהי אנו מחלקים את התוצאה ב-{% equation %}n{% endequation %} ולוקחים רק את השארית. כך למשל אם {% equation %}n=7{% endequation %}, אז תוצאת החיבור {% equation %}5+3{% endequation %} היא 1, כי {% equation %}5+3=8{% endequation %} וכאשר מחלקים {% equation %}8{% endequation %} ב-{% equation %}7{% endequation %} מקבלים 1. שני מספרים הם שווים מודולו {% equation %}n{% endequation %} אם הם מחזירים את אותה שארית בחלוקה ב-{% equation %}n{% endequation %}; כך למשל {% equation %}3\equiv_{7}10{% endequation %}. הרעיון בחשבון מודולו {% equation %}n{% endequation %} הוא להצטמצם לדיון על אוסף השאריות האפשריות בחלוקה ב-{% equation %}n{% endequation %} - בדיוק המספרים {% equation %}0,1,2,\dots,n-1{% endequation %}. משוואה דיופנטית שמסתכלים עליה מודולו {% equation %}n{% endequation %} היא קלה הרבה יותר לפתרון ממשוואה דיופנטית רגילה, מהטעם הפשוט שיש רק מספר סופי של הצבות ערכים אפשריות לבדוק (אם אנחנו עובדים מודולו {% equation %}n=7{% endequation %} וכבר הצבנו {% equation %}x=3{% endequation %}, אין טעם להציב גם {% equation %}x=10{% endequation %} למשל, כי נקבל את אותה תוצאה). למשל, הבה ונביט במשוואה {% equation %}3x\equiv_{7}5{% endequation %} - אפשר פשוט להציב בה את כל המספרים מ-0 ועד {% equation %}6{% endequation %} ולראות מתי נקבל 5 (למשל, עבור {% equation %}x=4{% endequation %} נקבל ש-{% equation %}3x=12\equiv_{7}5{% endequation %}).

האבחנה המרכזית כאן היא שאם משוואה דיופנטית כלשהי היא פתירה בשלמים, אז היא בוודאי פתירה מודולו {% equation %}n{% endequation %} לכל {% equation %}n{% endequation %} (למה?). לכן אם נצליח למצוא ולו {% equation %}n{% endequation %} אחד ויחיד כך שהמשוואה אינה פתירה מודולו {% equation %}n{% endequation %}, ינבע מכך שאין לה פתרון כלל. לרוע המזל, ההפך אינו נכון - קיימות משוואות שהן פתירות מודולו כל {% equation %}n{% endequation %} אך למרות זאת אין להן פתרון בשלמים. עם זאת, זו עדיין התקדמות כלשהי, שגם מציגה את דרך העבודה הכללית בתורת המספרים: כדי להגיד משהו מעניין על המספרים השלמים, אנחנו עוברים לבחון את הבעיה בתוך אוסף מספרים אחר (במקרה הזה, אוסף השאריות מודולו {% equation %}n{% endequation %}, שמסומן בדרך כלל ב-{% equation %}\mathbb{Z}_{n}{% endequation %}).

האם באמת צריך לנסות ולפתור את המשוואה מודולו כל {% equation %}n{% endequation %}? ובכן, לא. כאן נכנס לעזרתנו משפט מתורת המספרים - "<a href="http://www.gadial.net/2007/11/10/modular_square_roots_hardness/">משפט השאריות הסיני</a>". בבסיסו, המשפט אומר שאם {% equation %}n=ab{% endequation %} כאשר {% equation %}a,b{% endequation %} זרים זה לזה - אין להם מחלק משותף גדול מ-1, אז משוואה היא פתירה מודולו {% equation %}n{% endequation %} אם ורק אם היא פתירה מודולו {% equation %}a{% endequation %} ופתירה מודולו {% equation %}b{% endequation %}. למעשה, כיוון אחד כאן הוא טריוויאלי - אם המשוואה פתירה מודולו {% equation %}n{% endequation %} אותו פתרון טוב הן מודולו {% equation %}a{% endequation %} והן מודולו {% equation %}b{% endequation %} - הכוח של המשפט נעוץ בכך שהוא מראה כיצד ניתן לבנות מפתרון אחד למשוואה מודולו {% equation %}a{% endequation %} ומפתרון אחר למשוואה מודולו {% equation %}b{% endequation %} פתרון "משולב" עבור המשוואה מודולו {% equation %}n{% endequation %} (ליתר דיוק, זה לא בדיוק מה שהמשפט אומר אלא תוצאה כמעט מיידית שלו).

הנה דוגמה: נניח ש-{% equation %}n=119{% endequation %}, כלומר {% equation %}a=7,b=17{% endequation %} במקרה זה, ואנו מתבוננים במשוואה {% equation %}x^{2}=2{% endequation %}. לא קשה לראות שמודולו 7 המשוואה הזו פתירה עם {% equation %}x=3{% endequation %}, ואילו מודולו 17 המשוואה הזו פתירה עם {% equation %}x=6{% endequation %}. מהו הפתרון מודולו 119? על ידי חיפוש ממצה אפשר לגלות ש-11 הוא פתרון שכזה, אולם משפט השאריות הסיני (שכבר תיארתי בעבר ולכן לא אפרט עליו כעת) נותן לדרך "לבנות" את 11 באופן אלגוריתמי ויעיל מתוך שני הפתרונות הידועים.

המשפט ניתן להכללה ללא קושי עבור כל פירוק של {% equation %}n{% endequation %} לגורמים זרים זה לזה; ולכן הדבר המתבקש ביותר הוא להסתכל על הפירוק ה"מקסימלי" של {% equation %}n{% endequation %}, לכמה שיותר גורמים - דהיינו, פירוק ל<a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A1%D7%A4%D7%A8_%D7%A8%D7%90%D7%A9%D7%95%D7%A0%D7%99">ראשוניים</a>. {% equation %}n=p_{1}^{k_{1}}\dots p_{t}^{k_{t}}{% endequation %}. מהפירוק הזה עולה שמספיק לבדוק האם המשוואה פתירה מודולו {% equation %}p_{i}^{k_{i}}{% endequation %} לכל {% equation %}1\le i\le t{% endequation %} כדי לגלות אם היא פתירה מודולו {% equation %}n{% endequation %}. אי אפשר לפרק גם את {% equation %}p_{i}^{k_{i}}{% endequation %} למכפלות קטנות יותר של {% equation %}p_{i}{% endequation %}, שכן אז נקבל מספרים שאינם זרים זה לזה ({% equation %}p{% endequation %} ו-{% equation %}p^{2}{% endequation %} הם בעלי מחלק משותף גדול מ-1: {% equation %}p{% endequation %}).

אם כן, הדיון שלנו הצטצמם כעת לבחינת משוואות מודלו {% equation %}p^{n}{% endequation %} כאשר {% equation %}p{% endequation %} ראשוני ו-{% equation %}n{% endequation %} טבעי כלשהו. האינטואיציה הראשונה היא לעסוק במשוואה מודולו {% equation %}p{% endequation %}, ולראות האם בהינתן פתרון מודולו {% equation %}p{% endequation %} ניתן לבנות ממנו פתרון גם עבור מודולו {% equation %}p^{2}{% endequation %}, וממנו פתרון עבור {% equation %}p^{3}{% endequation %} וכן הלאה. הסיבה לכך שעבודה מודולו {% equation %}p{% endequation %} היא קורצת כל כך היא שלאוסף המספרים מודולו {% equation %}p{% endequation %}, {% equation %}\mathbb{Z}_{p}{% endequation %}, יש מבנה מוצלח במיוחד: הם מהווים <a href="http://he.wikipedia.org/wiki/%D7%A9%D7%93%D7%94_%28%D7%9E%D7%91%D7%A0%D7%94_%D7%90%D7%9C%D7%92%D7%91%D7%A8%D7%99%29">שדה</a> - סגורים לכל ארבע פעולות החשבון. עבור חזקות של ראשוניים זה כבר לא עובד כך (אלו מכם שלמדו על שדות סופיים ודאי זוכרים שכל שדה סופי מכיל {% equation %}p^{n}{% endequation %} איברים, עבור {% equation %}p{% endequation %} ראשוני ו-{% equation %}n{% endequation %} טבעי, אבל חשוב להבין ש-{% equation %}\mathbb{F}_{p^{n}}{% endequation %} שונה במבנהו מהקבוצה {% equation %}\mathbb{Z}_{p^{n}}{% endequation %}; בתור התחלה, ב-{% equation %}\mathbb{Z}_{p^{n}}{% endequation %} ישנם איברים שונים מאפס שמכפלתם נותנת 0, למשל {% equation %}p{% endequation %} ו-{% equation %}p^{n-1}{% endequation %}; ב-{% equation %}\mathbb{F}_{p^{n}}{% endequation %} אין דבר כזה).

ובכן, זו התחלה טובה, והיא תיתן לנו אינטואיציה לגבי המשך הדרך - ובסופה של הדרך נגיע לשדה אחר של מספרים, שמכיל בתוכו את המספרים הרציונליים, והאיברים ה"שלמים" בו הם מעין הכללה של המספרים השלמים הרגילים, ואשר מקיים את התכונה שאם משוואה היא פתירה בו בשלמים (ה"שלמים" של אותו שדה, לא השלמים הרגילים) אז אותה משוואה פתירה בשלמים "רגילים" מודולו {% equation %}p^{n}{% endequation %}, <strong>לכל</strong> {% equation %}n{% endequation %}. כלומר, אברי השדה הזו מקודדים איכשהו מידע על כל מה שקורה ב-{% equation %}\mathbb{Z}_{p^{n}}{% endequation %}, לכל {% equation %}n{% endequation %}. לשדה בעל התכונה המעניינת הזו קוראים שדה המספרים ה-p-אדיים (כפי שהשם מרמז, קיים כזה לכל {% equation %}p{% endequation %} ראשוני), ואותו אציג בפוסט הבא.
