<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>בהינתן שאנחנו יודעים הסתברות בסיסית, כמה קל להבין הסתברות מותנית? | לא מדויק</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="בהינתן שאנחנו יודעים הסתברות בסיסית, כמה קל להבין הסתברות מותנית?" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<link rel="canonical" href="http://gadial.net/2010/08/05/conditional_probability/" />
<meta property="og:url" content="http://gadial.net/2010/08/05/conditional_probability/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-08-05T13:16:29+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="twitter:title" content="בהינתן שאנחנו יודעים הסתברות בסיסית, כמה קל להבין הסתברות מותנית?" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"url":"http://gadial.net/2010/08/05/conditional_probability/","@type":"BlogPosting","description":"לא מדויק - בלוג על מתמטיקה ומדעי המחשב","headline":"בהינתן שאנחנו יודעים הסתברות בסיסית, כמה קל להבין הסתברות מותנית?","dateModified":"2010-08-05T13:16:29+00:00","datePublished":"2010-08-05T13:16:29+00:00","image":"http://gadial.net/assets/img/main/default-card.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2010/08/05/conditional_probability/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/post_list">רשימת הפוסטים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">פוסטים אקראיים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/lecture_notes">סיכומי הרצאות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2010/07/29/probability_intro/">&laquo; הסתברות בסיסית - אחד חלקי קומבינטוריקה</a>
    
    
      <a class="next" href="/2010/08/10/breaking_news_p_vs_np_proof/">הוכחה ש-P שונה מ-NP? &raquo;</a>
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">בהינתן שאנחנו יודעים הסתברות בסיסית, כמה קל להבין הסתברות מותנית?</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2010-08-05T13:16:29+00:00" itemprop="datePublished">Aug 5, 2010
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="http://www.gadial.net/2010/07/29/probability_intro/">בפוסט הקודם</a> התחלתי לדבר על הסתברות בסיסית והצגתי כמה רעיונות בסיסיים. אמרתי שאנחנו ממדלים סיטואציה הסתברותית עם <strong>מרחב הסתברות</strong> שכולל קבוצה <span>\( X \)</span> (<strong>מרחב </strong>המדגם)<strong> של</strong> כל התוצאות האפשריות של הסיטואציה ההסתברותית, כך שלכל <span>\( a\in X \)</span> (לכל תוצאה <span>\( a \)</span> אפשרית ששייכת לקבוצה <span>\( X \)</span>) מותאם גם מספר <span>\( P\left(a\right) \)</span> בין 0 ל-1 שאומר מה ההסתברות של התוצאה הזו, וסכום ההסתברויות של כולם הוא 1. כמו כן אמרתי שמה שמעניין אותנו בדרך כלל הוא <strong>מאורעות</strong>, שהם תת-קבוצות של <span>\( X \)</span> (מסמנים זאת <span>\( A\subseteq X \)</span>) ומהווים אוסף של כמה תוצאות אפשריות בעלות משמעות “דומה”. למשל, בהטלת קוביה התוצאות הבסיסיות הן <span>\( 1,2,3,4,5,6 \)</span> ואילו מאורעות אפשריים הם “הקוביה נפלה על מספר זוגי”, “הקוביה נפלה על מספר גדול מ-4”, “הקוביה נפלה על 2, או על 3, או על 5”וכדומה. ההסתברות של מאורע, שסימנתי <span>\( P\left(A\right) \)</span>, הייתה פשוט סכום ההסתברויות של איבריו.</p>

<p>בואו נעבור עכשיו לשאלה יותר מורכבת: “בהינתן שידוע שהקוביה נפלה על מספר זוגי, מה ההסתברות שהיא נפלה על 2?”. איך מתמודדים עם שאלה שכזו?</p>

<p>האינטואיציה היא בערך כך: אם נפלתי על מספר זוגית אז ההסתברות שנפלתי על 1,3,5 היא אפס - הם יצאו מהמשחק. כלומר, נפלתי או על 2, או על 4, או על 6. מכיוון שקודם ההסתברות שלי ליפול על כל אחד מהם הייתה זהה, והמידע החדש לא מסייע לי להבדיל ביניהם, גם עכשיו ההסתברות שלי ליפול על כל אחד מהם היא זהה, ומכיוון שסכומם צריך להיות 1, ההסתברות של כל אחד מהם היא <span>\( \frac{1}{3} \)</span>. לכן ההסתברות של 2 היא <span>\( \frac{1}{3} \)</span> וזו התשובה. אכן, אם תעשו סימולציה ממוחשבת של הטלת קובייה ותבדקו באיזה אחוז מהמקרים מקבלים 2 <strong>אם</strong> בהטלת הקוביה התקבל מספר זוגי (ואחרת פשוט מתעלמים מהטלת הקוביה הזו), תקבלו בערך <span>\( \frac{1}{3} \)</span>. אז איך אפשר להצדיק את הקסם הזה פורמלית ולטפל בסיטואציות יותר מורכבות?</p>

<p>הרעיון הבסיסי של הסתברות מותנית הוא שינוי מרחב ההסתברות שלנו. אם יש לנו מרחב מדגם <span>\( X \)</span> ומאורע <span>\( B \)</span> ואומרים לנו שהמאורע <span>\( B \)</span> התרחש, זה אומר שאפשר לשכוח מהקבוצה <span>\( X \)</span> המקורית ולהגדיר מרחב הסתברות חדש שבו מרחב המדגם הוא <span>\( B \)</span>. יש “לתקן” את ההסתברויות בהתאם, כדי שסכום ההסתברויות של התוצאות שנמצאות ב-<span>\( B \)</span> יהיה 1; לפעולה הזו קוראים <strong>נורמליזציה</strong> והיא נפוצה למדי במתמטיקה. מה שעושים הוא פשוט לחשב את סכום כל התוצאות שב-<span>\( B \)</span> (שהוא פשוט <span>\( P\left(B\right) \)</span>) ואז לחלק את ההסתברות של כל איבר ב-<span>\( B \)</span> במספר זה. כעת ברור שסכום כל ההסתברויות החדשות של אברי <span>\( B \)</span> יסתכם ל-1. אם נסמן ב-<span>\( P^{\prime} \)</span> את ההסתברות החדשה שנתנו לכל איבר של <span>\( B \)</span> אז <span>\( P^{\prime}\left(a\right)=\frac{P\left(a\right)}{P\left(B\right)} \)</span> לכל <span>\( a\in B \)</span>, ועל כן</p>

<p><span>\( \sum_{a\in B}P^{\prime}\left(a\right)=\sum_{a\in B}\frac{P\left(a\right)}{P\left(B\right)}=\frac{1}{P\left(B\right)}\sum_{a\in B}P\left(a\right)=\frac{P\left(B\right)}{P\left(B\right)}=1 \)</span></p>

<p>כך שפורמלית השגנו את המטרה שלנו.</p>

<p>מהדבר הזה נובעת נוסחה פשוטה יחסית: אם <span>\( A,B\subseteq X \)</span> הם מאורעות כלשהם במרחב המדגם המקורי, ואנחנו רוצים לדעת מה ההסתברות ש-<span>\( A \)</span> יתקיים אם ידוע ש-<span>\( B \)</span> התקיים, אז מפתה לכתוב שהסתברות זו היא <span>\( \frac{P\left(A\right)}{P\left(B\right)} \)</span>. לרוע המזל, זה לא נכון כי ייתכן שחלק מאברי <span>\( A \)</span> בכלל לא נמצאים ב-<span>\( B \)</span>. אם <span>\( A=X \)</span> עצמו, אז נקבל את התוצאה הלא הגיונית שההסתברות שהקוביה תיפול על <strong>משהו</strong> (שהיא כמובן 1) הופכת פתאום ל-<span>\( \frac{1}{3} \)</span> כשאנחנו יודעים שהתקבל מספר זוגי. לכן צריך לתקן קצת את הנוסחה - מה שבמונה צריך להתייחס רק לאיברים של <span>\( A \)</span> <strong>שהם גם איברים של</strong> <span>\( B \)</span>. מסמנים את קבוצת האיברים המשותפים של <span>\( A,B \)</span> כ-<span>\( A\cap B \)</span> (ה<strong>חיתוך</strong> של <span>\( A \)</span> ו-<span>\( B \)</span>), ולכן הנוסחה הנכונה היא <span>\( \frac{P\left(A\cap B\right)}{P\left(B\right)} \)</span>. לצורך פשטות נהוג לסמן זאת כ-<span>\( P\left(A|B\right)=\frac{P\left(A\cap B\right)}{P\left(B\right)} \)</span> (כלומר, <span>\( P\left(A|B\right) \)</span> הוא ההסתברות של “<span>\( A \)</span> בהינתן <span>\( B \)</span>”). אגב, שימו לב שאם <span>\( P\left(B\right)=0 \)</span> הנוסחה אינה חוקית כי קיבלתי חלוקה באפס; ואכן, אין ממש הגיון בלשאול מה ההסתברות ש-<span>\( A \)</span> יתרחש אם <strong>נתון</strong> שהתרחש <span>\( B \)</span> למרות של-<span>\( B \)</span> אין שום סיכוי לקרות.</p>

<p>דרך אחרת ונחמדה לכתוב את הנוסחה הזו היא <span>\( P\left(B\right)\cdot P\left(A|B\right)=P\left(A\cap B\right) \)</span>. כלומר, ההסתברות שגם <span>\( A \)</span> וגם <span>\( B \)</span> יתרחשו ניתנת לחישוב כתהליך דו שלבי - קודם מחשבים מה ההסתברות ש-<span>\( B \)</span> יתקיים, ואז מחשבים מה ההסתברות ש-<span>\( A \)</span> יתקיים בהינתן ש-<span>\( B \)</span> מתקיים. לעתים קרובות חישוב מותנה שכזה קל לביצוע באופן ישיר ואז אופן החישוב הזה חוסך לנו עבודה. עוד דבר שנראה בבירור בנוסחה הזו הוא הסימטריה שלה - באותו האופן בדיוק אני יכול לכתוב <span>\( P\left(A\right)\cdot P\left(B|A\right)=P\left(A\cap B\right) \)</span>, ואז לקבל את השוויון <span>\( P\left(B\right)\cdot P\left(A|B\right)=P\left(A\right)\cdot P\left(B|A\right) \)</span>. על ידי העברת אגפים קלה מקבלים את הנוסחה הבאה, שהיא חשובה ביותר:</p>

<p><span>\( P\left(A|B\right)=\frac{P\left(A\right)}{P\left(B\right)}P\left(B|A\right) \)</span></p>

<p>הנוסחה הזו מכונה “נוסחת בייס”, והיא מאפשרת לנו לחשב הסתברות מותנית שנדמית “הפוכה” בעזרת הכרה של ההסתברות של שני המאורעות בנפרד ושל ההסתברות המותנית “ההגיונית”. כאן המקום לזרוק לפח את דוגמת הקוביה ולעבור לתאר סיטואציות יותר מעניינות שבהן ה”מוזרות” שבנוסחת בייס בולטת הרבה יותר. עיקר החוכמה היא בבחירה של מאורעות <span>\( A,B \)</span> כך שכלל לא נראה ש-<span>\( B \)</span> גורר את <span>\( A \)</span> בצורה כלשהי, אלא ההפך. יוסי לוי <a href="http://www.sci-princess.info/archives/885">השתמש בבלוג שלו</a> בדוגמה של בדיקת סמים לספורטאי; אצלו <span>\( A \)</span> היה “השחקן משתמש בסמים” ו-<span>\( B \)</span> היה “בבדיקה התגלו סמים”. כאן נראה ש-<span>\( A \)</span> הוא זה שמשפיע על <span>\( B \)</span> ולא להפך - אם יודעים משהו על איכות בדיקת הסמים אפשר לחשוב באופן ישיר מה ההסתברות שהיא תצליח בהינתן שהשחקן באמת משתמש בסמים - אך איך אפשר להסיק מכך את ההפך? בניסוח קצת חרטטני - אם הסתברות מותנית נראית לנו במבט ראשון ככלי שבו אנחנו מסיקים מידע לגבי ההשפעה של העבר על העתיד (“השחקן השתמש בסמים וכתוצאה מכך הוא נכשל בבדיקה”), נוסחת בייס מראה לנו שגם ניתן להסיק מהעתיד על העבר.</p>

<p>דוגמאות סטנדרטיות לתיאור נוסחת בייס מדברות למשל על בדיקת מחלות וסמים וכדומה. אנסה לתת דוגמה קצת פחות קודרת, שמבוססת על סיפור אמיתי. במקצוע קשה מסויים בטכניון מרבית הסטודנטים כשלו וקיבלו ציונים נמוכים. לכעסם הרב התברר להם שלא היה פקטור בבחינה (הגדלה מלאכותית של הציונים שמיועדת לתקן את הממוצע או לפצות על מבחן קשה). כשהסטודנטים באו להתלונן למרצה הוא לא הבין על מה הם מדברים וטען שהמבחן היה קל - עובדה, היה סטודנט שקיבל 103, ואם הוא הצליח, כל אחד יכול.</p>

<p>הסטודנטים הזועמים רוצים לדעת מי דפק להם את הפקטור. ליתר דיוק, האם הוא עתודאי או לא (העתודאים הם דופקי פקטורים ידועים לשמצה ובשל כך - בין היתר - נחשבים למעמד התחתון בהיררכיית המזון האוניברסיטאית). איזה חישוב עליהם לעשות? ובכן, <span>\( A \)</span> יהיה המאורע “הסטודנט הוא עתודאי” ו-<span>\( B \)</span> יהיה המאורע “הסטודנט קיבל 103 במבחן הבלתי אפשרי”, ואנחנו רוצים לדעת מהו <span>\( P\left(A|B\right) \)</span>. שימו לב שכדי לדעת זאת אנחנו צריכים לדעת שלושה פרטים: <span>\( P\left(A\right) \)</span>, שהוא ההסתברות לכך שסטודנט יהיה עתודאי; <span>\( P\left(B\right) \)</span> שהוא ההסתברות שסטודנט כלשהו יקבל 103 במבחן הבלתי אפשרי; ו-<span>\( P\left(B|A\right) \)</span>, שהיא ההסתברות ש<strong>עתודאי</strong> יקבל 103 במבחן הבלתי אפשרי. מכיוון שלא מדובר בבעיה מתמטית מופשטת ברור שאין לנו דרך אמיתית לקבל את הנתונים הללו, אבל אפשר להעריך אותם סטטיסטית.</p>

<p>ובכן, נניח שמספר הסטודנטים הכולל בטכניון הוא 10,000 ומתוכם יש 50 עתודאים. אז מה ההסתברות שסטודנט אקראי יהיה עתודאי? <span>\( P\left(A\right)=\frac{50}{10000}=\frac{1}{200} \)</span>.</p>

<p>הנתון לגבי ההסתברות לקבל 103 במבחן הבלתי אפשרי הוא הרבה יותר קשה לחילוץ, שהרי המבחן הזה ניתן רק פעם אחת, ועל קבוצה יחסית קטנה של סטודנטים. אבל כאמור, אנחנו לא רציניים כאן לגמרי. אז בואו נסתכל על מה שקורה “בדרך כלל” במבחנים קשים ונעשה מיצוע לאורך זמן. נניח שהתוצאה מראה לנו שבדרך כלל סטודנט אחד ממאה מצליח לקבל ציון שכזה - כלומר, ההסתברות לסטודנט גנרי כלשהו לקבל 103 במבחן הבלתי אפשרי היא <span>\( P\left(B\right)=\frac{1}{100} \)</span>.</p>

<p>ועכשיו, מה ההסתברות של <strong>עתודאי</strong> לקבל 103 במבחן הבלתי אפשרי? מכיוון שעתודאים הם צורת חיים חדשה ומתקדמת אפשר להניח שההסתברות שלהם להצליח היא לא פחות מ-<span>\( P\left(B|A\right)=\frac{99}{100} \)</span>. עכשיו בואו ונדחוף את כל הנתונים לנוסחה ונראה מה נקבל: <span>\( P\left(A|B\right)=\frac{P\left(A\right)}{P\left(B\right)}P\left(B|A\right)=\frac{1/200}{1/100}\frac{99}{100}=\frac{100}{200}\frac{99}{100}=\frac{99}{200} \)</span>. כלומר, קיבלנו הסתברות של כמעט חמישים אחוז. מצד אחד, זה הרבה. מצד שני, אולי זה לא הרבה כפי שציפינו. תחשבו על הפער האדיר הזה: אם ניקח סטודנט מהרחוב, ההסתברות שלו לקבל 103 במבחן היא אפסית - <span>\( \frac{1}{100} \)</span>. מצד שני, לעתודאי ההבטחה כמעט מוצלחת - <span>\( \frac{99}{100} \)</span>. ועם זאת, ההסתברות שמי שקלקל את המבחן היה סתם סטודנט ולא עתודאי היא הגדולה יותר. למה זה קרה? בגלל הנתון (הלא ריאליסטי, המהונדס לצרכי השאלה - אבל כך גם ה-<span>\( \frac{99}{100} \)</span> של העתודאי להצליח במבחן) שרק אחד מכל מאתיים סטודנטים הוא עתודאי.</p>

<p>ב<a href="http://www.ynet.co.il/articles/1,7340,L-2917313,00.html">מאמר</a> ב-Ynet מראה ישראל בנימיני עד כמה התופעה הזו יכולה להיות מבלבלת, בהקשר העגום של בדיקת מחלות. אציג את מה שהמאמר הציג בצורה קצת מפושטת ובנוסף אשתיל פנימה טעות מזעזעת (שאתייחס אליה אחר כך) ונראה אם תגלו מהי. ובכן, נניח שיש לנו בדיקה מעולה לגילוי מחלה מסויימת, שעל 100 אחוז מהאנשים החולים מחזירה תוצאה חיובית, ורק על אחוז אחד מהאנשים הבריאים מחזירה תוצאה חיובית. כמו כן ידוע לנו ששיעור המחלה באוכלוסיה הוא אחד מאלף אנשים. אם נסמן ב-<span>\( A \)</span> את “האדם חולה” וב-<span>\( B \)</span> את “תוצאת הבדיקה חיובית”, הרי ש-<span>\( P\left(B|A\right)=1 \)</span>, <span>\( P\left(A\right)=\frac{1}{1000} \)</span> ו-<span>\( P\left(B\right)=\frac{1}{100} \)</span>. נוסחת בייס נותנת לנו כאן מייד ש-<span>\( P\left(A|B\right)=\frac{1}{10} \)</span>, תוצאה שנראית מפתיעה ביותר ממבט ראשון - למרות שהבדיקה כל כך טובה ומדוייקת (לכאורה…), רק עשרה אחוז מהאנשים שמקבלים תשובה חיובית אכן חולים במחלה! זו אחת מהנקודות שחשוב לזכור גם בחיי היום יום שלנו: גם אם מבחן נראה לנו טוב במדד של “ההסתברות שהוא טועה היא נמוכה” זה עדיין לא אומר שהוא טוב גם במובן שחשוב לנו באמת, של “כשמפעילים את המבחן שוב ושוב, כמעט ולא יהיו טעויות”. כך הדבר בבדיקת מחלות, או בבדיקה האם הודעות הן דואר זבל, או בבדיקה האם מוצר שיצא מקו ייצור הוא פגום, וכדומה. נוסחת בייס היא השיעור הראשון בסקפטיות שיש ללמוד כשבאים להתייחס לתוצאות סטטיסטיות.</p>

<p>הבה נביא עוד דוגמה אחת (אולי קצת יותר קשה למי שחסר נסיון במתמטיקה, אז לא להתייאש אם לא מבינים) - <a href="http://www.gadial.net/2009/08/09/miller_rabin/">דיברתי בעבר</a> על מבחן מילר-רבין לבדיקת ראשוניות. זהו מבחן הסתברותי, במובן זה שאם מפעילים אותו על מספר ראשוני הוא תמיד יענה נכון, אבל אם מפעילים אותו על מספר שאינו ראשוני יש סיכוי כלשהו שהוא יטען שהמספר כן ראשוני (מה שעשוי להביא לתוצאות הרסניות). הכוח של מילר-רבין הוא בכך שאפשר לצמצם את גודל השגיאה שלו כרצוננו, במחיר כמה הפעלות נוספות שלו, אבל נשאלת השאלה - כמה זה “מספיק”? המבחן משמש אותנו כשאנחנו רוצים להגריל מספר ראשוני; דרך העבודה הסטנדרטית היא להגריל מספר גדול כלשהו, ואז להפעיל עליו את מילר-רבין. צריך לשפוט את הביטחון שמילר-רבין מספק לנו לאור התהליך הזה, ונוסחת בייס היא בדיוק הכלי שבו צריך להשתמש כאן (רק אעיר שאני משקר - בהגרלת ראשוני “אמיתית”ההגרלה לרוב מבוצעת רק על תת-קבוצה מסויימת של מספרים - למשל, אף פעם לא מגרילים זוגיים - וטרם הפעלת מילר-רבין מפעילים עוד מבחנים יותר פשוטים, כך שאני מציג כאן גרסה מפושטת למדי של המציאות).</p>

<p>ובכן, נסמן ב-<span>\( A \)</span> את “המספר ראשוני” וב-<span>\( B \)</span> את “המספר עבר בהצלחה את המבחן”. ברור כי <span>\( P\left(B|A\right)=1 \)</span>. נניח שאנחנו מגרילים מספרים בתחום שבין <span>\( 1 \)</span> ו-<span>\( n \)</span>, אז <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A9%D7%A4%D7%98_%D7%94%D7%9E%D7%A1%D7%A4%D7%A8%D7%99%D7%9D_%D7%94%D7%A8%D7%90%D7%A9%D7%95%D7%A0%D7%99%D7%99%D7%9D">משפט המספרים הראשוניים</a> מראה כי ההסתברות שלנו לפגוע בראשוני היא <span>\( \frac{1}{\ln n} \)</span>. במילים אחרות, <span>\( P\left(A\right)=\frac{1}{\ln n} \)</span>. הנעלם בכל הסיפור הזה הוא ההסתברות של מילר-רבין לטעות, ואותה אנחנו מסמנים ב-<span>\( x \)</span>. אם כן, <span>\( P\left(B\right)=x \)</span> ו… רגע, רגע, רגע. אי אפשר לעשות את אותה הטעות פעמיים, חייבים כבר להתייחס אליה במפורש. קודם התחמקתי ממנה כדי לא לסבך את הפשטות של ההצגה עם איזו מהומה טכנית, אבל עכשיו אין מנוס מלהוציא את הפרטים המלוכלכים החוצה. <span>\( P\left(B\right) \)</span> אינו יכול להיות שווה ל-<span>\( x \)</span>, כי <span>\( x \)</span> מייצג את ההסתברות שהמבחן יגיד “כן” רק על קלטים שהם <strong>לא ראשוניים</strong>, בעוד ש-<span>\( P\left(B\right) \)</span> מייצג את ההסתברות שהמבחן יגיד כן על קלט <strong>כלשהו!</strong> אז מה עושים? אין מנוס מלחשב את <span>\( P\left(B\right) \)</span> בצורה קצת יותר רצינית, פשוט על ידי חלוקה למקרים: <strong>אם</strong> המספר הוא ראשוני, אז ההסתברות שהמבחן יגיד “כן” היא 1; ו<strong>אם</strong> המספר הוא פריק, אז ההסתברות שהמבחן יגיד “כן”היא <span>\( x \)</span>. יש לנו כאן סכום של שתי הסתברויות מותנות שונות. אולי תזכרו שבפוסט הקודם אמרתי שאם <span>\( A \)</span> הוא מאורע אז מסמנים ב-<span>\( \overline{A} \)</span> את המאורע ה”משלים” לו וההסתברות שלו היא <span>\( P\left(\overline{A}\right)=1-P\left(A\right) \)</span>? זה בדיוק מה שנשתמש בו כעת. על פי התיאור שנתתי למעלה, <span>\( P\left(B\right)=P\left(A\right)\cdot P\left(B|A\right)+P\left(\overline{A}\right)\cdot P\left(B|\overline{A}\right) \)</span>. הנוסחה הזו היא מקרה פרטי של מה שמכונה “נוסחת ההסתברות השלמה”, ואתאר אותה במדוייק עוד מעט.</p>

<p>כעת נשתמש בנתונים שידועים לנו ונוכל לחשב בקלות את <span>\( P\left(B\right) \)</span>: <span>\( P\left(B\right)=\frac{1}{\ln n}\cdot1+\left(1-\frac{1}{\ln n}\right)\cdot x \)</span>. עכשיו נוכל להציב את הכל בנוסחת בייס ולקבל: <span>\( P\left(A|B\right)=\frac{\frac{1}{\ln n}}{\frac{1}{\ln n}+\left(1-\frac{1}{\ln n}\right)x}=\frac{1}{1+\left(\ln n-1\right)x} \)</span>. באופן בלתי מפתיע גילינו שההסתברות תלויה גם ב-<span>\( n \)</span> וגם ב-<span>\( x \)</span>. אם אנחנו רוצים הסתברות גבוהה להצלחה, אנחנו צריכים ש-<span>\( x \)</span> יהיה קטן דיו כדי לבטל את האפקט של <span>\( \left(\ln n-1\right) \)</span>. למשל, אם אנחנו רוצים הצלחה ב-99 אחוז מהמקרים אנחנו רוצים שיתקיים <span>\( \frac{1}{1+\left(\ln n-1\right)x}=\frac{99}{100} \)</span>, כלומר <span>\( 100=99+99\left(\ln n-1\right)x \)</span>, כלומר <span>\( x=\frac{1}{99\left(\ln n-1\right)} \)</span>. באופן כללי כדי להשיג הצלחה ב-<span>\( a \)</span> אחוז מהמקרים צריך שיתקיים <span>\( x=\frac{1}{a}\cdot\frac{1}{\ln n-1} \)</span>; אפשר לראות כאן היטב כיצד <span>\( x \)</span> מורכב משני מרכיבים - גם ה”קבוע”של <span>\( \frac{1}{a} \)</span> שתלוי רק באחוז ההצלחה שאנו שואפים אליו; אבל גם במידע נוסף של גודל התחום שעליו מתבצעת ההגרלה, שבא לידי ביטוי ב-<span>\( \frac{1}{\ln n-1} \)</span>.</p>

<p>הבה נעבור כעת לדבר על נוסחת ההסתברות השלמה. בתחילת הפוסט אמרתי שלעתים קל יותר לחשב את ההסתברות המותנית של משהו מאשר את ההסתברות ה”אמיתית”שלנו וראינו את הדוגמה כרגע, עם חישוב ההסתברות שהמבחן יחזיר תשובה חיובית. הסיבה לכך הייתה שלעתים קרובות ההסתברות ניתנת לתיאור באופן הפשוט ביותר באמצעות חלוקה למקרים, ואז ניתן לטפל בכל מקרה בנפרד. נוסחת ההסתברות השלמה מאפשרת לנו לעשות זאת. נניח שאנחנו מחלקים את מרחב המדגם <strong>כולו</strong> (את כל <span>\( X \)</span>) לאוסף של מאורעות זרים (זרים פירושו שאין להם תוצאה משותפת) <span>\( B_{1},B_{2},\dots,B_{k} \)</span>. אז ההסתברות של מאורע <span>\( A \)</span> כלשהו היא ההסתברות שהוא יתרחש בהינתן ש-<span>\( B_{1} \)</span> יתרחש, כפול ההסתברות ש-<span>\( B_{1} \)</span> יתרחש; ועוד ההסתברות שהוא יתרחש בהינתן ש-<span>\( B_{2} \)</span> יתרחש, כפול ההסתברות ש-<span>\( B_{2} \)</span> יתרחש; וכן הלאה. מכיוון שה-<span>\( B \)</span>-ים תופסים את כל מרחב המדגם, מובטח לנו שלא נפספס אף מקרה. בסיכומו של דבר הנוסחה היא <span>\( P\left(A\right)=\sum_{i=1}^{k}P\left(A|B_{i}\right)P\left(B_{i}\right) \)</span>. על פניו היא נראית כמו דרך מסובכת יותר לכתוב את <span>\( P\left(A\right) \)</span>, אך כאמור - לעתים קרובות הדרך הנוחה ביותר לחשב את <span>\( P\left(A\right) \)</span> היא על ידי חלוקה למקרים שמיוצגים על ידי ה-<span>\( B_{i} \)</span>.</p>

<p>מה שאני עשיתי למעלה היה שימוש בנוסחת ההסתברות השלמה עבור חלוקה פשוטה למדי של מרחב המדגם, לשתי קבוצות שונות - <span>\( B \)</span> והמשלימה שלה. אך כמובן שאפשר לחלק גם ליותר. כתרגיל כדי לראות שהכל ברור תוכלו לנסות ולבדוק מה ההסתברות <strong>האמיתית</strong> שמי שקיבל תשובה חיובית בבדיקת המחלה שבדוגמה שלמעלה אכן חולה באמת (תגלו שהיא לא שונה במיוחד מהתוצאה שקיבלתי…).</p>

<p>מושג ההסתברות המותנית יכול לשמש אותנו גם להגדרת מושג נוסף שמתאים מאוד לתפיסה האינטואיטיבית שלנו - מאורעות בלתי תלויים. שני מאורעות <span>\( A,B \)</span> הם בלתי תלויים, אינטואיטיבית, אם הידיעה על כך שאחד התרחש לא משפיעה על ההערכה שלנו לגבי ההסתברות שהשני יתרחש. למשל, אם אני מטיל שתי קוביות ומקבל 3 בקוביה הראשונה, זה לא משפיע בכלל על ההסתברות שאקבל מספר זוגי בקוביה השניה, כך שהמאורע “בקוביה הראשונה התקבל 3” והמאורע” בקוביה השניה התקבל מספר זוגי” הם בלתי תלויים. פורמלית זה אומר שמתקיים <span>\( P\left(A|B\right)=P\left(A\right) \)</span> (ההסתברות ש-<span>\( A \)</span> יתקיים, בלי ידע נוסף בעניין, זהה להסתברות ש-<span>\( A \)</span> יתקיים אם ידוע לנו ש-<span>\( B \)</span> יתקיים). על פי הנוסחה שלנו של <span>\( P\left(A|B\right) \)</span> אפשר לראות ש-<span>\( A,B \)</span> הם בלתי תלויים אם ורק אם <span>\( P\left(A\cap B\right)=P\left(A\right)P\left(B\right) \)</span>, כלומר אם ההסתברות ששניהם גם יחד יתקיימו היא בדיוק מכפלת ההסתברויות שכל אחד יתקיים בנפרד. למי שזוכר את עקרון הכפל בקומבינטוריקה, זה בדיוק העיקרון הזה, וזה גם ממחיש לנו מתי <strong>אי אפשר</strong> להשתמש בעקרון הכפל - בדיוק כשיש תלות כלשהי בין שני הדברים שאנו “סופרים”.</p>

<p>דוגמה יפה לשימוש במושג זה באה מתחום הקריפטוגרפיה - קלוד שנון, אבי תורת האינפורמציה, עסק גם בשאלה איך ניתן לומר על שיטת הצפנה שהיא “מושלמת”. הגדרתו היפה היא פשוטה: נניח שיש התפלגות כלשהי על כל הטקסטים שעשויים להיות מוצפנים באמצעות השיטה (וברור שיש כזו - למשל, התפלגות של כל הטקסטים באנגלית) ונסתכל על התפלגות התוצאות שמקבלים מהצפנות בעזרת השיטה. יהי <span>\( X \)</span> טקסט אפשרי אחד ו-<span>\( Y \)</span> תוצאת הצפנה אפשרית אחת - אז שיטת ההצפנה היא מושלמת אם לכל <span>\( X,Y \)</span> שכאלו מתקיים <span>\( P\left(X|Y\right)=P\left(X\right) \)</span>, כלומר אם אנחנו מסתכלים רק על <span>\( Y \)</span>, זה לא משפר את הידע שלנו שהטקסט המקורי היה <span>\( X \)</span> - ההסתברות שהטקסט המקורי היה <span>\( X \)</span> זהה בעינינו למה שידענו עליו גם קודם.</p>

<p>בלבול נפוץ אחד הוא בין מאורעות <strong>זרים</strong> ומאורעות בלתי תלויים. מכיוון שמאורעות זרים מקיימים <span>\( A\cap B=\emptyset \)</span> (קבוצה ריקה) אז <span>\( P\left(A\cap B\right)=0 \)</span> ומכאן ש-<span>\( P\left(A\right)=0 \)</span> או <span>\( P\left(B\right)=0 \)</span> אם הם גם מאורעות בלתי תלויים. מכאן עולה ששני מאורעות בעלי הסתברות חיובית <strong>אינם יכולים להיות זרים</strong> אם הם בלתי תלויים. בדוגמת הטלת הקוביות שלי, התוצאה <span>\( \left(3,2\right) \)</span> (“בקוביה הראשונה התקבל 3 ובשניה 2”) היא משותפת לשני המאורעות כך שברור שהם אינם זרים.</p>

<p>אם כן, לסיכום - הוספנו למשחק ההסתברותי מושג פשוט חדש, שהגדרתו המתמטית כמעט טריוויאלית, וקיבלנו כלי רב עוצמה שמשמש אותנו גם בחישובים אמיתיים ושופך אור פורמלי על מושגים אינטואיטיביים. המתמטיקה בשיא יופייה.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2010/07/29/probability_intro/">&laquo; הסתברות בסיסית - אחד חלקי קומבינטוריקה</a>
    
    
      <a class="next" href="/2010/08/10/breaking_news_p_vs_np_proof/">הוכחה ש-P שונה מ-NP? &raquo;</a>
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2010/08/05/conditional_probability/';
      this.page.identifier = 'http://gadial.net/2010/08/05/conditional_probability/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2010/08/05/conditional_probability/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script>

<!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
