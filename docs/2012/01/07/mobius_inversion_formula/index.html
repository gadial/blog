<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>נוסחת ההיפוך של מביוס | לא מדויק</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="נוסחת ההיפוך של מביוס" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<link rel="canonical" href="http://gadial.net/2012/01/07/mobius_inversion_formula/" />
<meta property="og:url" content="http://gadial.net/2012/01/07/mobius_inversion_formula/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-01-07T13:08:03+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="twitter:title" content="נוסחת ההיפוך של מביוס" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"url":"http://gadial.net/2012/01/07/mobius_inversion_formula/","@type":"BlogPosting","description":"לא מדויק - בלוג על מתמטיקה ומדעי המחשב","headline":"נוסחת ההיפוך של מביוס","dateModified":"2012-01-07T13:08:03+00:00","datePublished":"2012-01-07T13:08:03+00:00","image":"http://gadial.net/assets/img/main/default-card.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2012/01/07/mobius_inversion_formula/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/post_list">רשימת הפוסטים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">פוסטים אקראיים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/lecture_notes">סיכומי הרצאות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2011/12/31/inclusion_exclusion_principle/">&laquo; עקרון ההכלה וההפרדה, ואז הכללה והפחדה</a>
    
    
      <a class="next" href="/2012/01/09/primary_decomposition_theorem/">משפט הפירוק הפרימרי &raquo;</a>
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">נוסחת ההיפוך של מביוס</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2012-01-07T13:08:03+00:00" itemprop="datePublished">Jan 7, 2012
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2><strong>נוסחת ההיפוך הקלאסית</strong></h2>
<p>נתחיל מדוגמה. ככה יהיה הרבה יותר קל להבין מה אני רוצה. בפוסט הקודם הזכרתי את <strong>פונקציית אוילר</strong> <span>\( \varphi\left(n\right) \)</span> שלכל מספר טבעי מחזירה את מספר המספרים הקטנים ממנו שזרים לו. בנוסף לכל מעלותיה, היא מקיימת את התכונה היפה הבאה: <span>\( \sum_{d|n}\varphi\left(d\right)=n \)</span>. כלומר, כל מספר טבעי שווה לסכום הערכים של פונקציית אוילר כל כל מחלקיו.</p>

<p>לנוסחה הזו יש הוכחה קומבינטורית פשוטה שלחלוטין לא רלוונטית לפוסט אז העצלנים יכולים לדלג עליה - נספור את כל המספרים מ-1 עד <span>\( n \)</span> (בדיוק <span>\( n \)</span>) בדרך קצת שונה - לכל מספר <span>\( 1\le k\le n \)</span>, נסמן ב-<span>\( N_{k} \)</span> את מספרם של המספרים בין 1 ו-<span>\( n \)</span> שהמחלק המשותף המקסימלי שלהם ושל <span>\( n \)</span> הוא בדיוק <span>\( k \)</span>, כלומר <span>\( N_{k}=\left|\left\{ 1\le a\le n|\gcd\left(a,n\right)=k\right\} \right| \)</span>. בבירור אם <span>\( k \)</span> לא מחלק את <span>\( n \)</span> אז <span>\( N_{k}=0 \)</span>; מהו <span>\( N_{k} \)</span> אם <span>\( k|n \)</span>? ובכן, זהו מספרם של המספרים מהצורה <span>\( k,2k,3k,\dots,n \)</span> שאין להם מחלק משותף גדול מ-<span>\( k \)</span> עם <span>\( n \)</span>, כלומר מספרים מהצורה <span>\( tk \)</span> כך ש-<span>\( t \)</span> זר ל-<span>\( \frac{n}{k} \)</span> (תעצרו, תנשמו עמוק ותסבירו את זה לעצמכם - אם אתם לא מצליחים, לא נורא כי זה לא קשור ממש לפוסט). נסמן <span>\( d=\frac{n}{k} \)</span> ונקבל ש-<span>\( N_{k}=\varphi\left(d\right) \)</span>, ומכאן נובעת הנוסחה.</p>

<p>יופי, בשביל מה זה היה טוב? ובכן, זו דוגמה לסיטואציה שבה יש לנו פונקציה מסובכת <span>\( f \)</span> שסכום שלה על פני המחלקים של <span>\( n \)</span> יוצא משהו פשוט יותר. פורמלית, זה אומר שקיימת פונקציה <span>\( g\left(n\right) \)</span> כך ש-<span>\( g\left(n\right)=\sum_{d|n}f\left(d\right) \)</span>. היינו רוצים איכשהו “לחלץ” את <span>\( f \)</span> מתוך הנוסחה הזו ולכתוב אותה כפונקציה כלשהי של <span>\( g \)</span> הפשוטה יותר. נוסחת ההיפוך של מביוס נותנת לנו בדיוק את זה.</p>

<p>אפשר עכשיו פשוט להציג את הנוסחה, אבל חבל - אני רוצה לנצל את ההזדמנות כדי להכיר לכם מושג חדש, שממנו אפשר יהיה להגיע לנוסחה באופן טבעי יותר - קונבולוציית דיריכלה. קונבולוציה “רגילה” של שתי פונקציות <span>\( f,g \)</span> שמוגדרות על הטבעיים היא פונקציה חדשה <span>\( h \)</span> שמוגדרת כך: <span>\( h\left(n\right)=\sum_{k=0}^{n}f\left(k\right)g\left(n-k\right) \)</span>. דוגמה קלאסית לסיטואציה מתמטית שבה קונבולוצייה רגילה צצה מאליה היא כפל של פולינומים: אם <span>\( p\left(x\right)=\sum a_{i}x^{i} \)</span> ו-<span>\( q\left(x\right)=\sum b_{j}x^{j} \)</span> אז כל מקדם של המכפלה שלהם הוא קונבולוציה: המקדם של <span>\( x^{n} \)</span> ב-<span>\( p\left(x\right)q\left(x\right) \)</span> הוא <span>\( \sum_{k=0}^{n}a_{k}b_{n-k} \)</span>. שימו לב, שניתן לכתוב קונבולוציה גם עם חיבור ולא חיסור: <span>\( h\left(n\right)=\sum_{k+r=n}f\left(k\right)g\left(r\right) \)</span>.</p>

<p>קונבולוציית דיריכלה היא דומה באופיה, רק שבמקום חיבור/חיסור משתמשים בכפל/חילוק, דהיינו אם <span>\( h\left(n\right) \)</span> היא קונבולוציית דיריכלה של <span>\( f\left(n\right),g\left(n\right) \)</span> אז</p>

<p><span>\( h\left(n\right)=\sum_{d\cdot e=n}f\left(d\right)g\left(e\right)=\sum_{d|n}f\left(d\right)g\left(\frac{n}{d}\right) \)</span></p>

<p>זה כבר טיפה מזכיר את מה שהלך למעלה.</p>

<p>בואו נסמן <span>\( h=f*g \)</span> כדי לומר ש-<span>\( h \)</span> היא קונבולוציית דיריכלה של <span>\( f,g \)</span>. אז האלגבראיסט הפנימי שבנו מתלהב מכך שמצאנו פעולה חשבונית חדשה ודוחק בנו לחקור את התכונות שלה. למשל, <span>\( \left(f*g\right)*h=f*\left(g*h\right) \)</span> עבור שלוש פונקציות <span>\( f,g,h \)</span> כלשהן (שמוגדרות על טבעיים; זה תמיד ההקשר של הדיון), כך שקונבלוציית דיריכלה היא <strong>אסוציאטיבית</strong>. זה מגביר את ההתלהבות של האלגבראיסט הפנימי לשמיים כי הוא מקווה שיש לנו כאן <strong>חבורה</strong>, כלומר מבנה אלגברי שהפעולה שלו היא אסוציאטיבית, עם איבר יחידה, ועם הופכי לכל איבר. ובכן, איבר יחידה בהחלט יש: נסמן ב-<span>\( \epsilon \)</span> את הפונקציה שמקיימת <span>\( \epsilon\left(1\right)=1 \)</span> ו-<span>\( \epsilon\left(n\right)=0 \)</span> לכל <span>\( n&gt;1 \)</span>, אז קל מאוד לראות מההגדרה ש-<span>\( \epsilon*f=f*\epsilon=f \)</span>.</p>

<p>וכעת, מה עם הופכי? ובכן, נניח שעבור <span>\( f \)</span> קיימת <span>\( g \)</span> כך ש-<span>\( f*g=\epsilon \)</span>, זה אומר ש-<span>\( \sum_{d|1}f\left(d\right)g\left(\frac{n}{d}\right)=1 \)</span>, כלומר <span>\( f\left(1\right)g\left(1\right)=1 \)</span>; אבל אם <span>\( f\left(1\right)=0 \)</span> אז אבוד לנו - המשוואה הזו לעולם לא תתקיים. לכן תנאי הכרחי לכך ש-<span>\( f \)</span> יהיה הפיך הוא ש-<span>\( f\left(1\right)\ne0 \)</span>. מסתבר שזה גם תנאי מספיק, אבל נעזוב את החיפוש אחר הופכי במקרה הכללי כרגע ובמקום זאת נתמקד בהופכי של פונקציה פשוטה במיוחד: הפונקציה שמחזירה 1 לכל קלט, שאסמן פשוט כ-<span>\( \mathbb{I} \)</span>. את ההופכי שלה, שתכף נוכיח את קיומו, נסמן ב-<span>\( \mu \)</span> מסיבות היסטורית. אם כן, <span>\( \mathbb{I}*\mu=\epsilon \)</span>. בואו נראה מה נובע מכך.</p>

<p>זכרו שהתחלנו את כל הסיפור מהמשוואה <span>\( g\left(n\right)=\sum_{d|n}f\left(d\right) \)</span>. עם הטרמינולוגיה החדשה שלנו ניתן לנסח זאת בתור <span>\( g=f*\mathbb{I} \)</span>. כעת נכפול את שני האגפים ב-<span>\( \mu \)</span>, נשתמש באסוציאטיביות, ונקבל:</p>

<p><span>\( g*\mu=f*\left(\mathbb{I}*\mu\right)=f*\epsilon=f \)</span></p>

<p>במילים אחרות, <span>\( g=f*\mathbb{I} \)</span> אם ורק אם <span>\( f=g*\mu \)</span>, ובניסוח המקורי שלנו <span>\( g\left(n\right)=\sum_{d|n}f\left(d\right) \)</span> אם ורק אם <span>\( f\left(n\right)=\sum_{d|n}g\left(d\right)\mu\left(\frac{n}{d}\right) \)</span>. זוהי <strong>נוסחת ההיפוך של מביוס</strong>, והפונקציה <span>\( \mu \)</span> נקראת, בהתאם, <strong>פונקצית מביוס</strong>. בואו נבין איך היא נראית.</p>

<p>ראשית, <span>\( \mu\left(1\right)=1 \)</span> בבירור על פי ההגדרה, כי צריך שיתקיים <span>\( \mu\left(1\right)\mathbb{I}\left(1\right)=1 \)</span>. שנית, לכל <span>\( n&gt;1 \)</span> צריך שיתקיים <span>\( 0=\epsilon\left(n\right)=\sum_{d|n}\mu\left(d\right)\mathbb{I}\left(\frac{n}{d}\right)=\sum_{d|n}\mu\left(d\right) \)</span>. כלומר, אם לסכם באופן קומפקטי, פונקציית מביוס חייבת לקיים <span>\( \sum_{d|n}\mu\left(d\right)=\delta_{1n} \)</span>. מכאן אפשר להסיק בשלבים איך <span>\( \mu \)</span> נראית על כל מספר טבעי. נתחיל מהמספרים הקלים ביותר לטיפול בהקשר הזה (כמו שקורה לעתים קרובות ביותר בתורת המספרים) - ראשוניים, אם <span>\( d|p \)</span> עבור <span>\( p \)</span> ראשוני, אז <span>\( d=1 \)</span> או <span>\( d=p \)</span>, ולכן הנוסחה שלעיל מתורגמת עבורנו ל-<span>\( 0=\mu\left(1\right)+\mu\left(p\right) \)</span>, כלומר <span>\( \mu\left(p\right)=-1 \)</span> לכל ראשוני. אפשר להמשיך ולטפל בצורה דומה במכפלות של ראשוניים, אבל אני לא מכיר דרך אלגנטית במיוחד להציג את הניתוח הזה ולכן אקפוץ למסקנה הסופית: <span>\( \mu \)</span> היא כפלית על מספרים זרים. מה זה אומר? שאם <span>\( a,b \)</span> הם שני מספרים ללא מחלק משותף גדול מ-1, אז <span>\( \mu\left(ab\right)=\mu\left(a\right)\mu\left(b\right) \)</span> (באופן הולם למדי, גם <span>\( \varphi \)</span> של אוילר היא כזו). ומה אם <span>\( a,b \)</span> לא זרים? גם אז המצב פשוט: <span>\( \mu\left(ab\right)=0 \)</span>.</p>

<p>כעת אפשר להסיק נוסחה עבור <span>\( \mu \)</span>. נניח ש-<span>\( n=p_{1}p_{2}\cdots p_{k} \)</span> כאשר כל הראשוניים הללו שונים זה מזה, אז <span>\( \mu\left(n\right)=\prod_{i=1}^{k}\mu\left(p_{k}\right)=\left(-1\right)^{k} \)</span>; ואילו אם <span>\( n \)</span> מכיל את אותו ראשוני פעמיים בפירוק שלו, <span>\( \mu\left(n\right)=0 \)</span>.</p>

<p>לא קשה לראות שאכן <span>\( \sum_{d|n}\mu\left(d\right)=0 \)</span> בהגדרה זו לכל <span>\( n&gt;0 \)</span>; אם <span>\( n=p_{1}^{t_{1}}\cdots p_{k}^{t_{k}} \)</span> הרי שהסכום יהיה רק על מחלקים <span>\( d \)</span> מהצורה <span>\( p_{1}^{e_{1}}\cdots p_{k}^{e_{k}} \)</span> עם <span>\( e_{i}\in\left\{ 0,1\right\}  \)</span> (כי היתר יתאפסו), ועבור כל מכפלה כזו, <span>\( \mu\left(p_{1}^{e_{1}}\cdots p_{k}^{e_{k}}\right) \)</span> שווה למינוס 1 בחזקת מספר ה-<span>\( e_{i} \)</span>-ים שהם 1, ולכן <span>\( \sum_{d|n}\mu\left(d\right)=\sum_{i=0}^{k}{k \choose i}\left(-1\right)^{i}=\left(1-1\right)^{k}=0 \)</span> (המעבר האחרון הוא הבינום של ניוטון). כלומר, <span>\( \mu \)</span> שנתתי אכן מקיימת את מה שנדרש ממנה, וזה מבטיח שהיא אכן תהיה ההופכית של <span>\( \mathbb{I} \)</span> ושנוסחת ההיפוך של מביוס תתקיים.</p>

<p>יפה, זה סוגר את העניין בכל הנוגע לנוסחת ההיפוך ה”קלאסית” של מביוס, זו שרואים בספרי תורת המספרים. אבל יש כאן יותר מזה. נתחיל מלהיזכר במה שראינו על ההכללה של עקרון ההכלה וההפרדה בפוסט הקודם. שם היו לנו שתי פונקציות <span>\( f,g \)</span> כך שהתקיים</p>

<p><span>\( g\left(A\right)=\sum_{B\supseteq A}f\left(B\right) \)</span></p>

<p>ואת הנוסחה הזו “הפכנו” לקבלת</p>

<p><span>\( f\left(A\right)=\sum_{B\supseteq A}\left(-1\right)^{\left|B-A\right|}g\left(B\right) \)</span></p>

<p>הדמיון כאן לנוסחת ההיפוך של מביוס אדיר. במקום <span>\( d|n \)</span> יש לנו <span>\( B\supseteq A \)</span> כש-<span>\( B \)</span> על תקן <span>\( d \)</span> ו-<span>\( A \)</span> על תקן <span>\( n \)</span>, ובמקום <span>\( \mu\left(d\right) \)</span> יש לנו <span>\( \left(-1\right)^{\left|B-A\right|} \)</span>, אבל זה כל ההבדל. המבנה הרעיוני זהה. יתר על כן, הדמיון בין חלוקה והכלה של קבוצות הוא משהו שכבר ראינו בבלוג פעם, בהקשר של תורת המספרים האלגברית; אם נגדיר את <span>\( A \)</span> כקבוצת “כל המספרים המתחלקים על ידי <span>\( n \)</span>” ואת <span>\( B \)</span> כקבוצת “כל המספרים המתחלקים על ידי <span>\( d \)</span>” אז <span>\( B\supseteq A \)</span> <strong>שקול</strong> לאמירה <span>\( d|n \)</span> (אבל אז לא ברור מהו <span>\( \left|B-A\right| \)</span> שיהיה אינסופי). הדמיון הרב מאוד בין שני המקרים לא נגמר בהם; הוא נובע מכך ששניהם מקרים פרטיים של נוסחת היפוך כללית ביותר, שתקפה לכל מבנה מתמטי שמכליל את התכונות של “הכלה” או של “חלוקה” שרלוונטיות לעניינו - ולמבנה כזה קוראים <strong>קבוצה סדורה חלקית</strong> (קס”ח).</p>
<h2><strong>קס"חים</strong></h2>
<p>קבוצות סדורות חלקית הן מהמבנים הבסיסיים ביותר במתמטיקה, והצורה הפשוטה ביותר שבה אנו מתארים את הרעיון של <strong>סדר</strong>. בואו ניתן את ההגדרות האבסטרקטיות התורת-קבוצתיות: קבוצה <span>\( X \)</span> הוא סדורה חלקית עם יחס שמסומן ב-<span>\( \le \)</span> (יחס כאן הוא אוסף של זוגות <span>\( \left(a,b\right) \)</span> כך ש-<span>\( a\in X \)</span> וגם <span>\( b\in X \)</span>; אנחנו מסמנים <span>\( a\le b \)</span>) אם <span>\( \le \)</span>מקיים את שלוש התכונות הבאות:</p>
<ol>
	<li> (רפלקסיביות) <span>\( a\le a \)</span> לכל <span>\( a\in X \)</span></li>
	<li> (אנטי-סימטריה) <span>\( a\le b \)</span> וגם <span>\( b\le a \)</span> גורר <span>\( a=b \)</span></li>
	<li> (טרנזיטיביות) <span>\( a\le b \)</span> וגם <span>\( b\le c \)</span> גורר <span>\( a\le c \)</span></li>
</ol>
<p>צריך מייד להבהיר ש-<span>\( \le \)</span> הוא <strong>סימון</strong> של היחס. זה <strong>לא</strong> “גדול או שווה” במשמעות הרגילה שלו. מה שכן, היחס “גדול או שווה” הוא יחס סדר חלקי, אולי אחד מהפשוטים ביותר, ומכאן הסימון. אם כן, <span>\( \mathbb{N} \)</span> עם יחס הסדר “גדול או שווה מ-“ היא דוגמה לקבוצה סדורה חלקית; אבל <span>\( \mathbb{N} \)</span> עם יחד הסדר “מחלק את”, כלומר אם <span>\( a|b \)</span> מסמנים זאת <span>\( a\le b \)</span> היא דוגמה מעניינת הרבה יותר. ברור שזה אכן יחס סדר חלקי כי <span>\( a|a \)</span> לכל <span>\( a\in\mathbb{N} \)</span>, וגם שתי התכונות האחרות נובעות די בקלות מההגדרות; אבל בניגוד ליחס הקטן-או-שווה הרגיל, עבור יחס החלוקה יש לנו איברים ש<strong>אינם ניתנים להשוואה</strong>. למשל, 2 ו-3 לא מחלקים זה את זה ולכן לא מתקיים לא <span>\( 2\le3 \)</span> וגם לא <span>\( 3\le2 \)</span> עבור יחס סדר זה. קבוצה סדורה חלקית שבה כל שני איברים כן ניתנים להשוואה נקראת קבוצה סדורה <strong>מלאה</strong>, או <strong>סדורה לינארית</strong>.</p>

<p>שימו לב שקס”ח היא <strong>זוג</strong> - צריך לציין גם את <span>\( X \)</span> וגם את <span>\( \le \)</span>, כי על אותו <span>\( X \)</span> אפשר להגדיר הרבה יחסי סדר שונים. למרות זאת רוב הזמן אני אכתוב כאן “קס”ח <span>\( X \)</span>” ותו לא, מתוך הנחה שמה שאני אומר תקף <strong>לכל</strong> יחס סדר חלקי שנצמיד ל-<span>\( X \)</span> (לפעמים עם דרישות נוספות שאציין).</p>

<p>אם יש לנו קבוצה <span>\( X \)</span> כלשהי, אז אפשר להגדיר על אוסף תת-הקבוצות שלה <span>\( P\left(X\right) \)</span> יחס סדר על ידי הכלה (כלומר, לכל <span>\( A,B\subseteq X \)</span> מגדירים <span>\( A\le B \)</span> אם <span>\( A\subseteq B \)</span>), וגם, באופן מעניין, על ידי הכלה הפוכה, כלומר <span>\( A\le B \)</span> אם <span>\( B\supseteq A \)</span> (אומרים שהקס”ח שסדורה על ידי הכלה הפוכה <strong>דואלית</strong> לזו שסדורה על ידי הכלה רגילה; אפשר להגדיר דואלי שבו יחס הסדר מתהפך לכל קס”ח). אם כן, המושג של יחס סדר חלקי תופס את ה”עולם” שבו מתקיימות שתי הנוסחאות שהצגתי למעלה, ועכשיו נותר רק לברר איך נראית הנוסחה הכללית ביותר. כדי לספק את הסקרנות שלכם אני אציג אותה כבר עכשיו, ואז נוכל לחשוב איך להציג אותה בצורה <strong>מעניינת</strong>, על ידי הבנה טובה יותר של קבוצות סדורות חלקית (המטרה שלנו תהיה להכליל במובן מסויים את גישת הקונבולוציה של נוסחת ההיפוך הקלאסית).</p>

<p>ובכן, נוסחת ההיפוך הכללית אומרת שאם <span>\( \left(X,\le\right) \)</span> היא קבוצה סדורה חלקית עם יחס הסדר <span>\( \le \)</span> אשר מקיימת תכונת סופיות מסויימת (כל אידאל סדר ראשי הוא סופי - זה יתבהר בהמשך) אז אם יש לנו שתי פונקציות <span>\( f,g:X\to\mathbb{C} \)</span> אשר מקיימות <span>\( g\left(x\right)=\sum_{y\le x}f\left(y\right) \)</span>, אז מתקיים <span>\( f\left(x\right)=\sum_{y\le x}g\left(y\right)\mu\left(y,x\right) \)</span>, כאשר <span>\( \mu \)</span> היא פונקצית מביוס של הקס”ח <span>\( X \)</span>. איך בדיוק היא מוגדרת - גם את זה נבין בהמשך. לכל קס”ח יש את פונקצית המביוס שלו, וכבר ראינו שתיים: את זו של הקס”ח עם יחס החלוקה, שהייתה <span>\( \mu \)</span> הקלאסית; ואז זו של הקס”ח עם יחס ההכלה ההפוך של קבוצות, שקיימה <span>\( \mu\left(B,A\right)=\left(-1\right)^{\left|B-A\right|} \)</span>.</p>

<p>מכיוון שאני רוצה להציג את נוסחת ההיפוך ופונקצית מביוס כנובעים מרעיון עמוק יותר, מעין הכללה של קונבולוציית דיריכלה, אני צריך לתת עוד כמה הגדרות שקשורות לקס”חים. ראשית, לכל שני איברים <span>\( x,y\in X \)</span> אפשר להגדיר את ה<strong>קטע</strong> <span>\( \left[x,y\right]=\left\{ z\in X|x\le z\le y\right\}  \)</span>, כלומר כל האיברים שניתנים להשוואה עם <span>\( x,y \)</span> ונמצאים ביניהם, כולל הם עצמם. אם אין אף איבר בין <span>\( x \)</span> ל-<span>\( y \)</span>, כלומר <span>\( \left[x,y\right]=\left\{ x,y\right\}  \)</span>, אומרים ש-<span>\( y \)</span> <strong>מכסה</strong> את <span>\( x \)</span>. על <span>\( X \)</span> אומרים שהיא סופית מקומית אם כל קטע ב-<span>\( X \)</span> הוא סופי (כך למשל <span>\( \mathbb{Z} \)</span> עם יחס הסדר הרגיל היא סופית מקומית, אבל <span>\( \mathbb{Q} \)</span> עם אותו יחס סדר בדיוק איננה).</p>

<p><strong>שרשרת</strong> היא פשוט קבוצה של איברים ב-<span>\( X \)</span> שכולם ניתנים להשוואה זה עם זה (תת-קבוצה סדורה מלאה של <span>\( X \)</span>), ושמה מגיע מכך שאפשר לכתוב את איבריה כ-<span>\( x_{1}\le x_{2}\le\dots\le x_{n} \)</span> (במקרה שבו השרשרת סופית, אבל ממילא רק זה יעניין אותנו כאן). <strong>אנטי-שרשרת</strong> היא בדיוק ההפך מכך - קבוצה של איברים ב-<span>\( X \)</span> שלא ניתן להשוות אף זוג מהם - למשל, אם ניקח את הטבעיים עם יחס החלוקה, אז כל קבוצה של ראשוניים היא אנטי-שרשרת.</p>

<p><strong>אידאל סדר</strong> <span>\( I \)</span> הוא תת-קבוצה של <span>\( X \)</span> בעלת התכונה שאם <span>\( x\in I \)</span> ו-<span>\( y\le x \)</span> אז <span>\( y\in X \)</span> (מי שמכיר קצת אלגברה מופשטת ודאי רואה את הדמיון להגדרה ה”קלאסית” של אידאל). יש קשר בין אידאלי סדר ואנטי-שרשראות: אם ניקח את כל האיברים המקסימליים באידאל סדר <span>\( I \)</span> כלשהו (איברים <span>\( x\in I \)</span> כך שלא קיים <span>\( y\in I \)</span> כך ש-<span>\( x\le y \)</span>) אז נקבל אנטי-שרשרת, ומצד שני אם ניקח אנטי-שרשרת <span>\( A \)</span> ונגדיר <span>\( I=\left\{ y\in X|\exists x\in A,y\le x\right\}  \)</span> נקבל אידאל סדר, ואם <span>\( X \)</span> סופית זה נותן לנו התאמה חח”ע ועל בין אנטי-שרשרות ואידאלי סדר. באופן כללי אם בהינתן <span>\( A \)</span> מגדירים ממנה <span>\( I \)</span> כפי שתיארתי כאן, אז אומרים ש-<span>\( A \)</span> <strong>יוצרת</strong> את האידאל <span>\( I \)</span>; ואידאל <span>\( I \)</span> הוא אידאל סדר <strong>ראשי</strong> אם הוא נוצר בדיוק על ידי איבר אחד, כלומר קיים <span>\( x\in A \)</span> כך ש-<span>\( I=\left\{ y\le x|y\in X\right\}  \)</span>. במקרה הזה מסמנים לעתים <span>\( I=\left\langle x\right\rangle  \)</span>. שוב, למי שבקיא באלגברה מופשטת הדמיון לאידאלים “קלאסיים” מאוד ברור כאן.</p>
<h2><strong>קונבולוצייה והיפוך, הגרסה המוכללת</strong></h2>
<p>אוקיי, הגענו לאקשן. בואו ניקח קבוצה סדורה חלקית <span>\( X \)</span> שהיא סופית מקומית, ונגדיר פונקציות על קבוצת <strong>כל הקטעים</strong> ב-<span>\( X \)</span> (פונקציות ממשיות, אבל אפשר גם עבור שדות אחרים). במילים אחרות, פונקציות שנראות ככה: <span>\( f\left(\left[x,y\right]\right) \)</span>. לצורך פשטות אפשר לחשוב עליהן כפונקציות בשני משתנים: <span>\( f\left(x,y\right) \)</span>, אבל הכרחי שיתקיים <span>\( x\le y \)</span> אחרת אין משמעות ל-<span>\( \left[x,y\right] \)</span>.</p>

<p>בין כל זוג פונקציות כזה אפשר להגדיר פעולת כפל שתכליל את קונבולוציית דיריכלה, אבל נמאס לי מהכוכב המעצבן הזה אז אני פשוט אשתמש בסימון הסטנדרטי לכפל: שום סימון. אם <span>\( f,g \)</span> הן פונקציות מקבוצת הקטעים של <span>\( X \)</span> אל <span>\( \mathbb{R} \)</span>, אז נגדיר:</p>

<p><span>\( fg\left(x,y\right)=\sum_{x\le z\le y}f\left(x,z\right)g\left(z,y\right) \)</span></p>

<p>כאן העובדה ש-<span>\( X \)</span> סופית מקומית היא קריטית; אחרת הסכום הזה לא בהכרח היה סופי.</p>

<p>בואו נראה איך המושג הזה מכליל את זה של תחילת הפוסט. שם התעסקנו עם פונקציות שמוגדרות על הטבעיים; כאן <span>\( X=\mathbb{N} \)</span> ויחס הסדר הוא חלוקה, כלומר <span>\( a\le b \)</span> פירושו <span>\( a|b \)</span>. כעת, אם <span>\( f \)</span> היא פונקציה שמוגדרת על הטבעיים, אפשר להגדיר אותה גם על קטעים באופן הבא: <span>\( f\left(a,b\right)=f\left(\frac{b}{a}\right) \)</span> (זכרו: בגלל ש-<span>\( \left[a,b\right] \)</span> הוא קטע, <span>\( a\le b \)</span> ולכן <span>\( a|b \)</span>). לכן בפרט <span>\( f\left(a\right)=f\left(1,a\right) \)</span>, ומההגדרה למעלה נקבל:</p>

<p><span>\( fg\left(n\right)=fg\left(1,n\right)=\sum_{1|d|n}f\left(1,d\right)g\left(d,n\right)=\sum_{d|n}f\left(d\right)g\left(\frac{n}{d}\right) \)</span></p>

<p>הופה! בדיוק ההגדרה של קונבולוציית דיריכלה.</p>

<p>אפשר להגדיר <span>\( \epsilon \)</span> כמו קודם: <span>\( \epsilon\left(x,x\right)=1 \)</span> לכל <span>\( x\in X \)</span>, ולכל <span>\( x\ne y \)</span> <span>\( \epsilon\left(x,y\right)=0 \)</span> (למעשה, <span>\( \delta \)</span> מתאים פה יותר, למי שזוכר את הדלתא של קרונקר, אבל לא חשוב). לא קשה לראות ש-<span>\( \epsilon \)</span> היא איבר יחידה ביחס לכפל הפונקציות שהגדרתי לעיל. גם לא קשה לראות שהכפל אסוציאטיבי.</p>

<p>את מקומה של הפונקציה שסימנתי אז <span>\( \mathbb{I} \)</span> תופסת עכשיו פונקציית זטא: <span>\( \zeta\left(x,y\right)=1 \)</span> לכל <span>\( x\le y \)</span>. רגע, למה זטא? אודה ואתוודה - לא יודע, אני לא בטוח מה הקשר של הפונקציה הזו לשאר פונקציות הזטא הקיימות, אבל אלו הסימונים. באופן בלתי מפתיע, מגדירים כעת את פונקצית מביוס של הקס”ח <span>\( X \)</span> בתור ההופכית של <span>\( \zeta \)</span>, כלומר <span>\( \zeta\mu=\mu\zeta=\epsilon \)</span>. כעת, נוסחת ההיפוך של מביוס, בתיאורה האבסטרקטי ביותר, היא פשוט האבחנה הסופר-טריוויאלית ש- <span>\( f\zeta=g \)</span> אם ורק אם <span>\( f=g\mu \)</span> (רק שיש כאן טוויסט כאן שתכף אסביר).</p>

<p>קרוב לודאי שאתם מרגישים שיצאתי יותר מדי בזול מכל העניין. איפה אני מוכיח משהו, בכלל? אתם כמובן צודקים - מה שחסר לי הוא הוכחה ש-<span>\( \zeta \)</span>הפיכה בכלל. כדי לטפל בכך אוכיח משהו כללי יותר - שפונקציה <span>\( f \)</span> היא הפיכה אם ורק אם <span>\( f\left(x,x\right)\ne0 \)</span> לכל <span>\( x\in X \)</span>. חזרנו אל “החיפוש אחרי הופכי במקרה הכללי” של תחילת הפוסט, רק שהפעם אני לא הולך להתחמק.</p>

<p>למרבה המזל, האתגר לא גדול במיוחד. נתונה לי <span>\( f \)</span> ואני רוצה למצוא <span>\( g \)</span> כך ש-<span>\( fg=\epsilon \)</span>. כלומר, כך ש-<span>\( fg\left(x,x\right)=\epsilon\left(x,x\right)=1 \)</span> לכל <span>\( x \)</span>, ומכיוון שעל פי הגדרה <span>\( fg\left(x,x\right)=f\left(x,x\right)g\left(x,x\right) \)</span>, הרי ש-<span>\( g\left(x,x\right)=\left(f\left(x,x\right)\right)^{-1} \)</span> (כאן אני נעזר בכך שהערכים שהפונקציות מקבלות שייכים ל<strong>שדה</strong>), ואנו רואים גם למה הכרחי שיתקיים <span>\( f\left(x,x\right)\ne0 \)</span>.</p>

<p>כעת, לכל <span>\( x\ne y \)</span> שניתנים להשוואה צריך להתקיים <span>\( fg\left(x,y\right)=\epsilon\left(x,y\right)=0 \)</span>, ולכן על פי הנוסחה <span>\( \sum_{x\le z\le y}f\left(x,z\right)g\left(z,y\right)=0 \)</span>. בואו נבודד מהסכום הזה את האיבר שמתקבל כש-<span>\( z=x \)</span> ונעביר אגף, נקבל ש:</p>

<p><span>\( g\left(x,y\right)=-\left(f\left(x,x\right)\right)^{-1}\sum_{x&lt;z\le y}f\left(x,z\right)g\left(z,y\right) \)</span>.</p>

<p>הנוסחה הזו מספיקה כדי <strong>להגדיר</strong> את <span>\( g \)</span> לכל קטע באופן רקורסיבי. זה לא מבטיח לנו נוסחה פשוטה יותר עבור <span>\( g \)</span>, ומכאן בפרט שאין לנו תמיד נוסחה פשוטה עבור <span>\( \mu \)</span>. מה כן יש לנו? ובכן, אם נציב את <span>\( \zeta \)</span> בתור <span>\( f \)</span> בנוסחאות הללו, נקבל ש-<span>\( \mu \)</span> מתוארת על ידי הנוסחאות הבאות:</p>

<p><span>\( \mu\left(x,x\right)=1 \)</span> לכל <span>\( x\in X \)</span>.</p>

<p><span>\( \mu\left(x,y\right)=-\sum_{x&lt;z\le y}\mu\left(z,y\right)=-\sum_{x\le z&lt;y}\mu\left(x,z\right) \)</span> לכל <span>\( x&lt;y \)</span>.</p>

<p>את נוסחת ההיפוך עצמה ניתן לתאר עם סכומים באופן הבא: אם <span>\( f\zeta=g \)</span> זה אומר ש-<span>\( g\left(x,y\right)=\sum_{x\le z\le y}f\left(x,z\right) \)</span>, ולכן <span>\( f\left(x,y\right)=\sum_{x\le z\le y}g\left(x,z\right)\mu\left(z,y\right) \)</span>.</p>

<p>כזכור, נוסחת ההיפוך דיברה על פונקציות שמוגדרות לא על קטעים, אלא על איברים. היא אמרה שמתקיים</p>

<p><span>\( g\left(x\right)=\sum_{y\le x}f\left(y\right) \)</span></p>

<p>אם ורק אם</p>

<p><span>\( f\left(x\right)=\sum_{y\le x}g\left(y\right)\mu\left(y,x\right) \)</span></p>

<p>בניסוח הזה אנחנו חייבים שב-<span>\( X \)</span> כל אידאל סדר ראשי יהיה סופי פשוט כי אחרת הסכום <span>\( \sum_{y\le x} \)</span> (כאשר <span>\( x \)</span> קבוע - כלומר, הסכום הוא בדיוק על איברי אידאל הסדר שנוצר על ידי <span>\( x \)</span>) איננו סופי. למעשה, יש כאן נקודה עדינה למדי - אותן <span>\( f,g \)</span> שאני מדבר עליהן כאן מוגדרות על איברים של <span>\( X \)</span>, לא על קטעים. אין בעיה של ממש לטפל בעניין הזה אבל אני חושב שהתעללתי בקוראים מספיק ואסיים כאן.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2011/12/31/inclusion_exclusion_principle/">&laquo; עקרון ההכלה וההפרדה, ואז הכללה והפחדה</a>
    
    
      <a class="next" href="/2012/01/09/primary_decomposition_theorem/">משפט הפירוק הפרימרי &raquo;</a>
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2012/01/07/mobius_inversion_formula/';
      this.page.identifier = 'http://gadial.net/2012/01/07/mobius_inversion_formula/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2012/01/07/mobius_inversion_formula/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script>

<!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
