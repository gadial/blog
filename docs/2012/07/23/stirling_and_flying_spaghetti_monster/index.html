<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>מהי נוסחת סטירלינג ואיך היא מוכיחה את קיום מפלצת הספגטי המעופפת | לא מדויק</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="מהי נוסחת סטירלינג ואיך היא מוכיחה את קיום מפלצת הספגטי המעופפת" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<link rel="canonical" href="http://gadial.net/2012/07/23/stirling_and_flying_spaghetti_monster/" />
<meta property="og:url" content="http://gadial.net/2012/07/23/stirling_and_flying_spaghetti_monster/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-07-23T17:23:29+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="twitter:title" content="מהי נוסחת סטירלינג ואיך היא מוכיחה את קיום מפלצת הספגטי המעופפת" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://gadial.net/2012/07/23/stirling_and_flying_spaghetti_monster/","image":"http://gadial.net/assets/img/main/default-card.png","headline":"מהי נוסחת סטירלינג ואיך היא מוכיחה את קיום מפלצת הספגטי המעופפת","dateModified":"2012-07-23T17:23:29+00:00","datePublished":"2012-07-23T17:23:29+00:00","description":"לא מדויק - בלוג על מתמטיקה ומדעי המחשב","mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2012/07/23/stirling_and_flying_spaghetti_monster/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  
</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/lecture_notes">סיכומי הרצאות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">דף אקראי</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2012/07/22/counting_sort_and_sort_lower_bound/">&laquo; למה יש מיון מהיר יותר ממיון מהיר אבל בעצם אין</a>
    
    
      <a class="next" href="/2012/07/29/rip_david_chillag/">דוד צילג ז"ל &raquo;</a>
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">מהי נוסחת סטירלינג ואיך היא מוכיחה את קיום מפלצת הספגטי המעופפת</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2012-07-23T17:23:29+00:00" itemprop="datePublished">Jul 23, 2012
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>דף הפייסבוק של “כנסיית מפלצת הספגטי המעופפת” פרסם את <a href="https://www.facebook.com/mifletzet/posts/405446739503293">הסטטוס הבא</a>:</p>
<blockquote>הרמתי היום מטבע, והתפללתי להוד איטריותה שבחצי מהזריקות אני אקבל עץ ובחצי השני אני אקבל פלי. בעזרת הדרכתה של אטרייתה הקדושה, המשאלה התגשמה.</blockquote>
<blockquote>מה גדול כוחה, ונאמר ר'אמן.</blockquote>
<p><a href="/assets/img/2012/07/Flying_Spaghetti_Monster.jpg"><img class="alignnone size-full wp-image-2121" title="Flying_Spaghetti_Monster" src="/assets/img/2012/07/Flying_Spaghetti_Monster.jpg" alt="" width="514" height="514" /></a></p>

<p>בהנחה שזה נכון (ואין סיבה שלא נאמין שזה נכון - זה נכתב בדף הפייסבוק של כנסיית מפלצת הספגטי המעופפת!), אני רוצה לשכנע אתכם שזה מוכיח שמפלצת הספגטי המעופפת קיימת. כלומר, שההסתברות של מה שתואר בציטוט היא אפסית.</p>

<p>כמובן, כופרים יגידו לכם שבעצם מדובר בפרודיה, ושכולם יודעים שבהטלת מטבע הסיכוי לקבל את אותו מספר פעמים עץ ופלי רק הולך וגדל ככל שיש יותר הטלות מטבע; מישהו אולי אפילו יסנן “חוק המספרים הגדולים”. אבל לא! הם טועים! הם טועים ומפלצת הספגטי המעופפת קיימת.</p>

<p>נתחיל בלהגיד מה כן. כאשר יש לנו סדרה של <span>\( 2n \)</span> הטלות מטבע (מטבע הוגן, כלומר הסתברות 50-50 לקבלת עץ או פלי), ה<strong>תוחלת</strong> של מספר ההטלות שיצאו עץ היא <span>\( n \)</span>. בדיוק <span>\( n \)</span>. אבל מה זה אומר, בעצם? תוחלת היא בסך הכל ממוצע משוקלל - אנחנו כופלים 1 בהסתברות שבסדרה של <span>\( 2n \)</span> הטלות מטבע יצא עץ בדיוק פעם אחת, מחברים לזה את 2 כפול ההסתברות שיצא עץ פעמיים, מחברים לזה את 3 כפול ההסתברות שיצא עץ שלוש פעמים, וכן הלאה. לא קשה לראות כאן משיקולי סימטריה שהתוחלת חייבת לצאת <span>\( n \)</span> (כי סכום תוחלת מספר ההטלות שבהן יוצא עץ עם תוחלת מספר ההטלות שבהן יוצא פלי צריכה לצאת שווה לסכום ההטלות הכולל). עם זאת, זה לא אומר שכאשר נטיל מטבע <span>\( 2n \)</span> פעמים, יצא לנו עץ בדיוק <span>\( n \)</span> פעמים!</p>

<p>אחד מהמשפטים שמאפשר לנו להשתמש בתוחלת כדי לומר משהו מהותי על הבעיה ההסתברותית שלנו הוא <strong>חוק המספרים הגדולים</strong>, שבגרסה החזקה יותר שלו, כשהיא מותאמת לסיטואציה הספציפית שלנו, אומר שהמספר <strong>הממוצע</strong> של ההטלות שנפלו על עץ (כלומר, מספר ההטלות שיצאו עץ חלקי מספר ההטלות הקודם) שואף לתוחלת של עץ בהטלה בודדת (שהיא <span>\( \frac{1}{2} \)</span>) בהסתברות 1. במילים אחרות, <strong>כמעט בכל סדרת הטלות</strong> אפשרית, ככל ש-<span>\( n \)</span> גדול יותר, כך כמות הפעמים שיצא “עץ” בסדרה של <span>\( 2n \)</span> ההטלות תהיה קרובה יותר ל-<span>\( n \)</span>, אבל צריך להיות זהירים עם ה”קרוב יותר” הזה. אם יש 10 הטלות ומתוכן 4 יצאו עץ, האם זה טוב יותר או פחות מאשר 100 הטלות שמתוכן 48 יצאו עץ? מצד אחד, במקרה הראשון ציפינו לקבל 5 עצים וההפרש בין 4 ו-5 הוא 1, ולעומת זאת במקרה השני ההפרש בין 48 ו-50 הוא 2, כך שהמקרה השני “פחות טוב”; ומצד שני, במקרה הראשון המספר הממוצע של הטלות שנפלו על עץ הוא <span>\( \frac{4}{10}=\frac{2}{5} \)</span> בעוד שבמקרה השני הוא <span>\( \frac{48}{100}=\frac{12}{25} \)</span>, וזה מספר <strong>קרוב יותר</strong> ל-<span>\( \frac{1}{2} \)</span> מאשר <span>\( \frac{2}{5} \)</span>. חוק המספרים הגדולים מתייחס למקרה השני כטוב יותר מהראשון; זו משמעות “השאיפה”.</p>

<p>אם כן, חוק המספרים הגדולים אומר שאם נבצע <span>\( 2n \)</span> הגרלות ונחלק את מספר העצים שקיבלנו ב-<span>\( 2n \)</span>, נקבל משהו קרוב לחצי, וככל ש-<span>\( n \)</span> יהיה יותר גדול כך רמת הקרבה הזו תגדל עוד יותר. אתם מוזמנים לנסות את זה בעצמכם בסימולציות מחשב ולהיווכח (באופן אמפירי!) שהמתמטיקה עובדת. עבור <span>\( n \)</span> גדול מספיק ייתכן אפילו שהמספר הממוצע שתקבלו יחרוג מרמת הדיוק שלכם ולכן ייראה לכם בדיוק כמו <span>\( \frac{1}{2} \)</span> (חשבו על <span>\( 0.50000000000000001 \)</span> כאשר המחשב שלכם לא מציג את חמש הספרות האחרונות). זה עדיין לא אומר שתקבלו <strong>בדיוק</strong> חצי, אבל שתקבלו משהו <strong>באיזור</strong> חצי, וככל ש-<span>\( n \)</span> יותר גדול, כך האיזור הזה יכול להיות יותר גדול.</p>

<p>אם כן, תשכחו מתוחלת. תשכחו מחוק המספרים הגדולים. בואו נדבר על חישוב פרקטי. נתון <span>\( n \)</span>; מה ההסתברות שבסדרה של <span>\( 2n \)</span> הטלות מטבע נקבל עץ בדיוק <span>\( n \)</span> פעמים?</p>

<p>זו דוגמה ל<strong>משתנה מקרי בינומי </strong>שכבר <a href="http://www.gadial.net/2010/08/14/random_variables/">הזכרתי בבלוג בעבר</a>. החישוב הוא פשוט למדי: בגלל שההסתברות לעץ היא <span>\( \frac{1}{2} \)</span>, וגם ההסתברות לפלי היא <span>\( \frac{1}{2} \)</span>, אז לכל סדרה שהיא של עץ ופלי, ההסתברות שתתקבל בדיוק הסדרה הזו היא <span>\( \frac{1}{2^{2n}} \)</span> (<span>\( \frac{1}{2} \)</span> עבור הסיכוי לקבל בהטלה הראשונה את האיבר הראשון בסדרה, כפול <span>\( \frac{1}{2} \)</span> עבור הסיכוי לקבל בהטלה השניה את האיבר השני בסדרה וכן הלאה). נשאלת רק השאלה - כמה סדרות מאורך <span>\( 2n \)</span> שכוללת בדיוק <span>\( n \)</span> פעמים עץ קיימות? גם זה קל: אנחנו צריכים לבחור <span>\( n \)</span> מקומות עבור עץ, ולכן התוצאה היא <span>\( {2n \choose n} \)</span> (מי שלא מכיר את הסימונים הללו מוזמן לקרוא את הבלוג על משתנים בינומיים, או את הפוסטים שלי על קומבינטוריקה). שימו לב ש-<span>\( {2n \choose n} \)</span> הוא מקדם הבינום הגדול ביותר מבין כל אלו שיש להם <span>\( 2n \)</span> למעלה, כך שההסתברות לקבל <span>\( n \)</span> פעמים עץ היא אכן <strong>הגדולה </strong>מכל ההסתברויות לקבל מספר ספציפי של פעמים עץ; עם זאת, זה עדיין לא אומר שהיא גדולה בפני עצמה, רק שהיא גדולה מכל היתר (והמספר של “היתר” הולך וגדל).</p>

<p>אם כן, ההסתברות היא <span>\( {2n \choose n}2^{-2n} \)</span>. האם זו הסתברות קטנה? גדולה? מה קורה כש-<span>\( n \)</span> שואף לאינסוף, האם ההסתברות שואפת ל-1? ל-0? ל-<span>\( \frac{37}{100} \)</span>? לא ברור איך בדיוק לתקוף את הבעיה הזו במפורש כי אין לנו נוסחה מפורשת נחמדה ל-<span>\( {2n \choose n} \)</span>. מה שאנחנו כן יכולים לעשות הוא ללכת על פי ההגדרה של הסימון של מקדמי הבינום, <span>\( {2n \choose n}=\frac{\left(2n\right)!}{\left(n!\right)^{2}} \)</span>, אבל איך מתקדמים מכאן? אין לנו נוסחה סגורה יפה עבור עצרת…</p>

<p>לעזרתנו נחלץ קירוב. לא סתם קירוב - האמא של הקירובים. הקירוב שבדרך כלל פותר את רוב הבעיות שקשורות לעצרת - נוסחת סטירלינג. נתחיל בלהציג אותה:</p>

<p><span>\( n!\approx\sqrt{2\pi n}\left(\frac{n}{e}\right)^{n} \)</span></p>

<p>מה <span>\( \approx \)</span> אומר? פורמלית, שאם נחלק את שני הביטויים הללו ונשאיף את <span>\( n \)</span> לאינסוף, נקבל 1, כלומר <span>\( \lim_{n\to\infty}\frac{n!}{\sqrt{2\pi n}\left(\frac{n}{e}\right)^{n}}=1 \)</span>. איך לעזאזל מוכיחים דבר כזה, ועוד יותר לעזאזל מאיפה <span>\( \pi \)</span> החליט לדחוף את עצמו לעניין - זה דורש עבודה כלשהי; אני לא מכיר הוכחה לנוסחה שהיא גם אלמנטרית (לא משתמשת בידע מתמטי קודם שהוא לא טריוויאלי) וגם פשוטה. אני מקווה בעתיד להראות הוכחה בבלוג, ובינתיים בואו נראה מה זה אומר על הבעיה שלנו.</p>

<p>אם נשתמש בנוסחת סטירלינג כדי לקבל קירוב עבור המקדם הבינומי שלנו, נקבל את זה:</p>

<p><span>\( {2n \choose n}=\frac{\left(2n\right)!}{\left(n!\right)^{2}}\approx\frac{\sqrt{2\pi2n}\left(2n/e\right)^{2n}}{\sqrt{\left(2\pi n\right)^{2}}\left(n/e\right)^{2n}}=\frac{2\sqrt{\pi n}}{2\pi n}\cdot\frac{2^{2n}\cdot n^{2n}}{n^{2n}}=\frac{2^{2n}}{\sqrt{\pi n}} \)</span></p>

<p>אני מקווה שהמעברים לא היו מהירים יותר מדי, אבל באמת שאין כאן שום דבר מלבד חשבון סטנדרטי. המסקנה? <span>\( {2n \choose n}2^{-2n}\approx\frac{1}{\sqrt{\pi n}} \)</span>. בפרט, מכיוון ש-<span>\( \lim_{n\to\infty}\frac{1}{\sqrt{\pi n}}=0 \)</span> זה אומר ש-<span>\( \lim_{n\to\infty}{2n \choose n}2^{-2n}=0 \)</span>, כלומר אפשר לשכוח מכך שנתקבע על סיכוי של 37 אחוז לקבל חצי-חצי; ככל ש-<span>\( n \)</span> גדול יותר, כך הסיכוי שלנו לקבל חצי-חצי ילך ויתקרב לאפס. אמנם, <strong>הקצב</strong> שבו זה קורה הוא יחסית איטי (כי <span>\( \sqrt{n} \)</span> היא פונקציה שגדלה די לאט), אבל השורה התחתונה נותרת בעינה - באופן שהוא אולי קצת לא מתאים לאינטואיציה, ככל ש-<span>\( n \)</span> גדול יותר, ההסתברות קטנה יותר (למרות ש<strong>הממוצע</strong> יהיה קרוב יותר לחצי).</p>

<p>מה המסקנה מכל זה? שמפלצת הספגטי המעופפת קיימת? שהיא לא קיימת? שצריך להיזהר גם עם טענות מתמטיות שנשמעות טוב אינטואיטיבית? אני אישית הולך עם “סטירלינג זה מגניב!”</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2012/07/22/counting_sort_and_sort_lower_bound/">&laquo; למה יש מיון מהיר יותר ממיון מהיר אבל בעצם אין</a>
    
    
      <a class="next" href="/2012/07/29/rip_david_chillag/">דוד צילג ז"ל &raquo;</a>
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2012/07/23/stirling_and_flying_spaghetti_monster/';
      this.page.identifier = 'http://gadial.net/2012/07/23/stirling_and_flying_spaghetti_monster/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2012/07/23/stirling_and_flying_spaghetti_monster/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
