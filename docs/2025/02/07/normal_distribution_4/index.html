<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>מה הקטע עם התפלגות נורמלית? (חלק ד’ ואחרון: משפט הגבול המרכזי) | לא מדויק</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="מה הקטע עם התפלגות נורמלית? (חלק ד’ ואחרון: משפט הגבול המרכזי)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="איך בערך מוכיחים את משפט הגבול המרכזי ולמה הוא נראה כמו שהוא נראה" />
<meta property="og:description" content="איך בערך מוכיחים את משפט הגבול המרכזי ולמה הוא נראה כמו שהוא נראה" />
<link rel="canonical" href="http://gadial.net/2025/02/07/normal_distribution_4/" />
<meta property="og:url" content="http://gadial.net/2025/02/07/normal_distribution_4/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/2025/histogram_10.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-02-07T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://gadial.net/assets/img/2025/histogram_10.png" />
<meta property="twitter:title" content="מה הקטע עם התפלגות נורמלית? (חלק ד’ ואחרון: משפט הגבול המרכזי)" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2025/02/07/normal_distribution_4/"},"url":"http://gadial.net/2025/02/07/normal_distribution_4/","@type":"BlogPosting","description":"איך בערך מוכיחים את משפט הגבול המרכזי ולמה הוא נראה כמו שהוא נראה","headline":"מה הקטע עם התפלגות נורמלית? (חלק ד’ ואחרון: משפט הגבול המרכזי)","dateModified":"2025-02-07T00:00:00+00:00","datePublished":"2025-02-07T00:00:00+00:00","image":"http://gadial.net/assets/img/2025/histogram_10.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/post_list">רשימת הפוסטים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">פוסטים אקראיים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/lecture_notes">סיכומי הרצאות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2025/02/05/normal_distribution_3/">&laquo; מה הקטע עם התפלגות נורמלית? (חלק ג': על תוחלת וסטיית תקן)</a>
    
    
      <a class="next" href="/2025/03/15/why_0999_equals_1/">אז למה 1=...0.999? &raquo;</a>
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">מה הקטע עם התפלגות נורמלית? (חלק ד&#39; ואחרון: משפט הגבול המרכזי)</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-02-07T00:00:00+00:00" itemprop="datePublished">Feb 7, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2>אז מה משפט הגבול המרכזי אומר?</h2>

<p>סדרת הפוסטים הזו מנסה להבין למה התפלגות נורמלית נראית כמו שהיא נראית. מן הסתם השאלה הראשונה שצריך לענות עליה בשביל זה היא “מה זו בכלל התפלגות נורמלית?” ולזה יש שתי תשובות: אחת יבשה, של לתת את ההגדרה הפורמלית, וזה מה שעשינו בפוסטים הקודמים; והשניה, המהותית יותר, היא להסביר למה בכלל מתעניינים בהתפלגות הזו - והתשובה היא <strong>משפט הגבול המרכזי</strong>. תיארתי אותו בנפנופי ידיים קודם, אז עכשיו הגיע הזמן לתת את הניסוח הפורמלי.</p>

<p>משפט הגבול המרכזי מסתכל על סדרה אינסופית <span>\( X_{1},X_{2},X_{3},\ldots \)</span> של משתנים מקריים שהם בלתי תלויים ובעלי אותה התפלגות (בדומה לתנאים של <strong>חוק המספרים הגדולים</strong> שהזכרתי בפוסט הקודם). אנחנו מסמנים ב-<span>\( \mu \)</span> את התוחלת וב-<span>\( \sigma^{2} \)</span> את השונות שלהם (בפרט, אנחנו מניחים שהמספרים הללו מוגדרים, סופיים וש-<span>\( \sigma\ne0 \)</span>). עכשיו, לכל <span>\( n \)</span> אנחנו מגדירים משתנה מקרי <span>\( Z_{n} \)</span> שהוא בערך הסכום של ה-<span>\( X_{i} \)</span>-ים עד האיבר ה-<span>\( n \)</span>-י, אבל עם שקלול נוסף שאמור לנרמל את הסכום:</p>

<p><span>\( Z_{n}=\frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)</span></p>

<p>אז הסדרה <span>\( Z_{n} \)</span> שואפת להתפלגות הנורמלית <span>\( N\left(0,1\right) \)</span> כאשר <span>\( n \)</span> שואף לאינסוף. פורמלית, לכל <span>\( -\infty&lt;a&lt;\infty \)</span>:</p>

<p><span>\( \lim_{n\to\infty}P\left(Z_{n}\le a\right)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{a}e^{-x^{2}/2}dx \)</span></p>

<p>זה הניסוח הפורמלי, אבל הוא די שונה ממה שהצגתי עד כה בפוסטים שלי. מה שאני תמיד אמרתי הוא “בואו ניקח משתנה מקרי <span>\( X \)</span> כלשהו. עכשיו בואו נחזור על ההגרלה שלו המון פעמים ונחבר את התוצאות” - כלומר, הסתכלתי על הסכום <span>\( X_{1}+\ldots+X_{n} \)</span>. מכאן אמרתי “היי תראו עכשיו אם מציירים היסטוגרמה של הסכום אז פתאום יש עקומה של התפלגות נורמלית שמתארת אותה די במדויק”. כדי לקבל את העקומה, חישבתי את <span>\( \text{E}\left[X\right]=\mu \)</span> ואת <span>\( \text{Var}\left(X\right)=\sigma^{2} \)</span> ואז בניתי את העקומה <span>\( N\left(n\mu,\sqrt{n}\sigma\right) \)</span>. בואו נראה שזה באמת אמור לעבוד, על פי משפט הגבול המרכזי.</p>

<p>ראשית, תזכורת: טענתי בפוסט הקודם שאם <span>\( N\left(\mu,\sigma\right) \)</span> היא התפלגות נורמלית עם תוחלת <span>\( \mu \)</span> וסטיית תקן <span>\( \sigma \)</span> אז <span>\( N\left(0,1\right)=\frac{N\left(\mu,\sigma\right)-\mu}{\sigma} \)</span>, או בניסוח אחר - <span>\( N\left(\mu,\sigma\right)=\sigma N\left(0,1\right)+\mu \)</span>.</p>

<p>עכשיו, אם אני אסמן <span>\( Y_{n}=X_{1}+\ldots+X_{n} \)</span> אז משפט הגבול המרכזי אומר ש-<span>\( N\left(0,1\right) \)</span> היא קירוב טוב של <span>\( Z_{n}=\frac{Y_{n}-n\mu}{\sigma\sqrt{n}} \)</span>. השוויון הזה מלמד אותי ש-<span>\( Y_{n}=\sigma\sqrt{n}Z_{n}+n\mu \)</span>, כך שאני מצפה שקירוב טוב אל <span>\( Y_{n} \)</span> (שהוא המשתנה המקרי שהופיע בהיסטוגרמות שלי) יהיה <span>\( \sigma\sqrt{n}N\left(0,1\right)+n\mu=N\left(n\mu,\sigma\sqrt{n}\right) \)</span>, וזו העקומה שציירתי בפועל. זה מסביר מאיפה האיורים שלי הגיעו אבל עדיין לא ברור למה משפט הגבול המרכזי נראה כמו שהוא נראה; לי למשל מפריע שהחלוקה היא ב-<span>\( \sqrt{n} \)</span> ולא ב-<span>\( n \)</span> כמו שעושים בחוק המספרים הגדולים. בהוכחה של משפט הגבול המרכזי אנחנו נראה למה הדברים הללו הם כמות שהם.</p>

<h2>פונקציות יוצרות מומנטים</h2>

<p>הכלי הטכני המרכזי שבו משתמשים בהוכחה הוא מושג שטרם הזכרתי בסדרת הפוסטים הזו: <strong>פונקציה יוצרת מומנטים</strong>. מה זה מומנטים כן הזכרתי, בחטף: עבור משתנה מקרי <span>\( X \)</span>, <strong>המומנטים</strong> שלו הם הערכים המספריים <span>\( \text{E}\left[X^{n}\right] \)</span> עבור <span>\( n=1,2,\ldots \)</span>. עבור <span>\( n=1 \)</span> המומנט הוא פשוט התוחלת, וראינו שעבור <span>\( n=2 \)</span> המומנט הוא פשוט השונות ועוד התוחלת בריבוע (כי <span>\( \text{Var}\left(X\right)=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)</span>), אבל לא דיברתי על המומנטים עבור חזקות גבוהות יותר. הרעיון הוא שסדרת המומנטים של משתנה מקרי היא כמו ה-DNA שלו: מכילה כמות גדולה כל כך של מידע עליו שאפשר להסיק ממנה דברים מאוד לא טריוויאליים, גם אם היא לבדה לא כל הסיפור.</p>

<p>עוד מושג מאוד מועיל במתמטיקה, <a href="https://gadial.net/2011/08/07/generating_functions_hardcore_1/">שכבר הזכרתי</a> בבלוג כמה פעמים, הוא <strong>פונקציה יוצרת</strong>. הרעיון בפונקציה יוצרת הוא זה: אם יש לנו סדרה מעניינת של מספרים, <span>\( a_{0},a_{1},a_{2},\ldots \)</span>, אחד מהקסמים שאנחנו יכולים לעשות הוא “לשתול” את המספרים הללו בתור מקדמים של טור חזקות, <span>\( \sum_{n=0}^{\infty}a_{n}x^{n} \)</span> ואז פתאום אנחנו מסוגלים לעשות עם הטור הזה מניפולציות מעניינות שמתורגמות לפעולות לא טריוויאליות על כל סדרת המספרים בבת אחת. זה כלי חזק ומרהיב.</p>

<p>על הרעיון הבסיסי הזה יש כמה וריאציות מועילות, ואחת מהן היא מה שנקרא <strong>הפונקציה היוצרת האקספוננציאלית</strong> של סדרת המספרים. כאן הרעיון הוא לשתול את המספרים בתוך הטור <span>\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!} \)</span> שמזכיר קצת את הטור של פונקציית האקספוננט (עבור הסדרה <span>\( a_{n}=1 \)</span> מקבלים בדיוק את הטור של <span>\( e^{x} \)</span>). איכשהו יצא לגמרי במקרה שדיברתי על הפונקציה הזו <a href="https://gadial.net/2024/12/18/bernoulli_numbers/">באחד מהפוסטים האחרונים</a> בבלוג; זה לא יצא ככה בכוונה, פשוט היא כל כך מועילה שהיא מתעקשת לצוץ בשני הקשרים שונים כמעט בו זמנית (אחרי שמעולם לא כתבתי עליה קודם בבלוג לדעתי אבל נעזוב את זה).</p>

<p>מה שנקרא בתורת ההסתברות <strong>פונקציה יוצרת מומנטים</strong> הוא בדיוק זה - הפונקציה היוצרת האקספוננציאלית של סדרת המומנטים, אם כי נוח להגדיר אותה בצורה קצת שונה. ראשית, אני אשתמש במשתנה <span>\( t \)</span> כדי לא לבלבל עם המשתנה המקרי <span>\( X \)</span> שהוא מרכז הדיון שלנו. עכשיו, עם משתנה מקרי אפשר כזכור להשתגע בשלל צורות, כי בסופו של דבר מדובר במשהו שמחזיר מספרים ממשיים אז אפשר לעשות איתו דברים שאנחנו עושים עם מספרים ממשיים - למשל להסתכל על <span>\( e^{X} \)</span>, שזה פשוט משתנה מקרי שאומר “תגריל תוצאה כלשהי, תבדוק מה הערך ש-<span>\( X \)</span> נותן על התוצאה הזו, תעלה את <span>\( e \)</span> בחזקת הערך הזה”. כדי לעשות את זה מעניין אני יכול גם לדחוף פנימה ערך מספרי <span>\( t \)</span> כלשהו שאני מתייחס אליו כפרמטר ומכפיל אותו ב-<span>\( X \)</span>, כלומר אני מסתכל על המשתנה המקרי <span>\( e^{tX} \)</span>. אם זה משתנה מקרי, אפשר לחשב את התוחלת שלו, והיא תהיה תלויה בפרמטר <span>\( t \)</span>, כלומר קיבלנו <strong>פונקציה</strong></p>

<p><span>\( M\left(t\right)=\text{E}\left[e^{tX}\right] \)</span></p>

<p>זו הפונקציה יוצרת המומנטים, ואנחנו ליטרלי יכולים להשתמש בה כדי <strong>ליצור</strong> את המומנטים על ידי “חילוץ” המקדמים מתוך הטור של <span>\( e^{tX} \)</span> על ידי גזירה, כמו שקורה בחדו”א עם מה שנקרא <strong>טור טיילור</strong>. הנה איך שזה עובד:</p>

<p><span>\( M^{\prime}\left(t\right)=\left(\text{E}\left[e^{tX}\right]\right)^{\prime}=\text{E}\left[\left(e^{tX}\right)^{\prime}\right]=\text{E}\left[Xe^{tX}\right] \)</span></p>

<p>אוקיי, קצת מיהרתי פה. אני מבצע <strong>החלפה</strong> בין אופרטור התוחלת ואופרטור הגזירה במעבר האמצעי - למה זה מעבר לגיטימי? אם פותחים את ההגדרה של התוחלת במקרה הסופי מקבלים</p>

<p><span>\( \text{E}\left[e^{tX}\right]=\sum_{i=1}^{k}P\left(X=a_{i}\right)e^{ta_{i}} \)</span></p>

<p>ואפשר להשתמש בכך שנגזרת היא לינארית, כלומר <span>\( \left(f+g\right)^{\prime}=f^{\prime}+g^{\prime} \)</span>, מה שניתן להכללה באינדוקציה לכל סכום סופי, ולכן</p>

<p><span>\( \left[\sum_{i=1}^{k}P\left(X=a_{i}\right)e^{ta_{i}}\right]^{\prime}=\sum_{i=1}^{k}P\left(X=a_{i}\right)\left(e^{ta_{i}}\right)^{\prime}=\sum_{i=1}^{k}P\left(X=a_{i}\right)a_{i}e^{ta_{i}} \)</span></p>

<p>וקיבלנו בדיוק את הביטוי של <span>\( \text{E}\left[Xe^{tX}\right] \)</span>.</p>

<p>העניין הוא שמה שעובד עבור סכום <strong>סופי</strong> לא בהכרח עובד במקרה של סכום אינסופי, או במקרה הרציף שבו התוחלת היא אינטגרל. כלומר, את הקסם הזה אי אפשר לעשות <strong>לכל</strong> משתנה מקרי אלא רק לכאלו שהם “נחמדים מספיק”, אבל בואו לא ניכנס לתנאים המדויקים הפעם. במקום זה, בואו נראה איך אפשר להשתמש בזה: אם <span>\( M^{\prime}\left(t\right)=\text{E}\left[Xe^{tX}\right] \)</span> אז <span>\( M^{\prime}\left(0\right)=\text{E}\left[X\right] \)</span> וקיבלנו את המומנט הראשון.</p>

<p>עכשיו, אפשר להמשיך לגזור את <span>\( Xe^{tX} \)</span>. מכיוון שהנגזרת היא על פי <span>\( t \)</span>, ה-<span>\( X \)</span> שבו מוכפל <span>\( e^{tX} \)</span> הוא בסך הכל קבוע, ולכן מקבלים</p>

<p><span>\( M^{\prime\prime}\left(t\right)=\text{E}\left[X^{2}e^{tX}\right] \)</span></p>

<p>כלומר</p>

<p><span>\( M^{\prime\prime}\left(0\right)=\text{E}\left[X^{2}\right] \)</span></p>

<p>ובאופן כללי נקבל <span>\( M^{\left(i\right)}=\text{E}\left[X^{i}\right] \)</span>. זה בדיוק מה שקורה גם כשגוזרים את הטור <span>\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!} \)</span> בדיוק <span>\( i \)</span> פעמים ומציבים <span>\( x=0 \)</span>; מקבלים את <span>\( a_{i} \)</span>.</p>

<p>איך כל זה מתקשר למשפט הגבול המרכזי? עם הטענה הבאה: אם יש לנו סדרה <span>\( Z_{1},Z_{2},\ldots \)</span> של משתנים מקריים עם פונקציות צפיפות <span>\( F_{Z_{n}} \)</span> ופונקציות יוצרות הסתברות <span>\( M_{Z_{n}} \)</span>, ואם <span>\( Z \)</span> הוא משתנה מקרי עם פונקציית צפיפות <span>\( F_{Z} \)</span> ופונקציה יוצרת הסתברות <span>\( M_{Z} \)</span>, אז אם מתקיים <span>\( \lim_{n\to\infty}M_{Z_{n}}\left(t\right)=M_{Z}\left(t\right) \)</span> עבור כל <span>\( t \)</span>, אז <span>\( F_{Z_{n}}\left(t\right)\to F_{Z}\left(t\right) \)</span> עבור כל <span>\( t \)</span> שעבורו <span>\( F_{Z}\left(t\right) \)</span> רציפה. במילים אחרות - מספיק לנו להראות שאיפה של סדרת הפונקציות יוצרות המומנטים כדי להראות שאיפה של פונקציות הצפיפות, שהן לכאורה האובייקט המורכב יותר.</p>

<p>הטענה הזו היא טענה <strong>כבדה</strong>. כדי להוכיח אותה אני אצטרך כנראה פוסט שלם (או אפילו יותר) ולהיכנס למתמטיקה טכנית יותר מאשר אני רוצה כרגע. המטרה שלי בפוסטים הללו היא לראות איך זה שהתפלגות נורמלית היא מה שהיא גורר את משפט הגבול המרכזי; אז בואו נראה איך טענת העזר הזו מוכיחה לנו את משפט הגבול המרכזי.</p>

<h2>הוכחת משפט הגבול המרכזי</h2>

<p>בואו נזכיר שוב מה אנחנו רוצים להוכיח. אנחנו לוקחים סדרה <span>\( X_{1},X_{2},\ldots \)</span> של משתנים מקריים בלתי תלויים שמתפלגים באותו אופן, עם תוחלת <span>\( \mu \)</span> וסטיית תקן <span>\( \sigma \)</span>, מגדירים</p>

<p><span>\( Z_{n}=\frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)</span></p>

<p>ומקבלים שהסדרה <span>\( Z_{n} \)</span> שואפת להתפלגות הנורמלית <span>\( N\left(0,1\right) \)</span> כאשר <span>\( n \)</span> שואף לאינסוף. מה שנוכיח הוא את המשפט למקרה שבו <span>\( \mu=0,\sigma=1 \)</span>, כי אפשר לבצע רדוקציה מהמקרה הכללי למקרה הזה: אם נגדיר <span>\( Y_{i}=\frac{X_{i}-\mu}{\sigma} \)</span> אז נקבל שהתוחלת של <span>\( Y_{i} \)</span> היא 0 וסטיית התקן היא 1, ולכן <span>\( \frac{Y_{i}+\ldots+Y_{n}}{\sqrt{n}} \)</span> שואפת אל <span>\( N\left(0,1\right) \)</span>. עכשיו נציב את <span>\( Y_{i}=\frac{X_{i}-\mu}{\sigma} \)</span> בביטוי <span>\( \frac{Y_{i}+\ldots+Y_{n}}{\sqrt{n}} \)</span> ששואף ל-<span>\( N\left(0,1\right) \)</span> ונקבל את הביטוי <span>\( \frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)</span> שגם שואף ל-<span>\( N\left(0,1\right) \)</span> כי זה אותו ביטוי.</p>

<p>אם כן, מעתה והלאה נניח <span>\( \mu=0 \)</span> ו-<span>\( \sigma=1 \)</span> ולכן <span>\( Z_{n}=\frac{X_{1}+\ldots+X_{n}}{\sqrt{n}}=\frac{X_{1}}{\sqrt{n}}+\ldots+\frac{X_{n}}{\sqrt{n}} \)</span>. המטרה שלי היא למצוא את <span>\( M_{Z_{n}}\left(t\right) \)</span> - הפונקציה יוצרת המומנטים של <span>\( Z_{n} \)</span>, ולראות לאן היא שואפת (כשאני אראה לאן היא שואפת זה מה ש<strong>יכתיב</strong> לי את האופן שבו התפלגות נורמלית אמורה להיראות). מכיוון שהצגתי את <span>\( Z_{n} \)</span> בתור סכום סופי, בואו קודם נראה איך הפונקציה יוצרת המומנטים של כל איבר בסכום נראית.</p>

<p>ראשית, עבור <span>\( X_{i} \)</span>, הפונקציה יוצרת המומנטים שלו היא <span>\( M\left(t\right)=\text{E}\left[e^{tX_{i}}\right] \)</span>. שנית, עבור האיבר המנורמל <span>\( \frac{X_{i}}{\sqrt{n}} \)</span> הפונקציה יוצרת המומנטים היא <span>\( \text{E}\left[e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\text{E}\left[e^{\frac{t}{\sqrt{n}}X_{i}}\right]=M\left(\frac{t}{\sqrt{n}}\right) \)</span>. ולכן עכשיו נקבל</p>

<p><span>\( M_{Z_{n}}\left(t\right)=\text{E}\left[e^{tZ_{n}}\right]=\text{E}\left[e^{t\sum_{i=1}^{n}\frac{X_{i}}{\sqrt{n}}}\right]=\text{E}\left[\prod_{i=1}^{n}e^{t\frac{X_{i}}{\sqrt{n}}}\right] \)</span></p>

<p>כי זה הקסם של אקספוננט - סכום במעריך הופך למכפלת אקספוננטים (על פי כללי החזקות: <span>\( e^{a+b}=e^{a}\cdot e^{b} \)</span>).</p>

<p>עכשיו, זה <strong>בהחלט לא נכון</strong> באופן כללי שתוחלת של מכפלה היא מכפלת התוחלות, כלומר <span>\( \text{E}\left[XY\right]\ne\text{E}\left[X\right]\text{E}\left[Y\right] \)</span> באופן כללי, וזה די ברור - אם זה היה נכון, היינו מקבלים ש-<span>\( \text{E}\left[X^{2}\right]=\text{E}\left[X\right]^{2} \)</span> וכל מושג סטיית התקן היה נעלם. אבל השוויון <span>\( \text{E}\left[XY\right]=\text{E}\left[X\right]\text{E}\left[Y\right] \)</span> דווקא <strong>כן נכון</strong> אם <span>\( X,Y \)</span> הם משתנים מקריים בלתי תלויים, וזה בדיוק מה שאני מניח כאן - שכל אברי הסדרה <span>\( X_{1},X_{2},\ldots,X_{n} \)</span> הם בלתי תלויים, ולכן גם המשתנים <span>\( e^{t\frac{X_{i}}{\sqrt{n}}} \)</span> שנבנים מתוכם. כך שאני מקבל:</p>

<p><span>\( \text{E}\left[\prod_{i=1}^{n}e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\prod_{i=1}^{n}\text{E}\left[e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\prod_{i=1}^{n}M\left(\frac{t}{\sqrt{n}}\right)=\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)</span></p>

<p>אז מה שאנחנו רוצים להבין הוא את הגבול <span>\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)</span>. זה בעצם המקום הראשון שבו קופץ לעיניים למה “צריך” ש-<span>\( e \)</span> יופיע בהתפלגות נורמלית. כזכור, אחת מהדרכים השקולות לתאר את <span>\( e^{x} \)</span> היא באמצעות גבול: <span>\( e^{x}=\lim_{n\to\infty}\left(1+\frac{x}{n}\right)^{n} \)</span>, אז העובדה שיש לנו בביטוי <span>\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)</span> גבול שתלוי ב-<span>\( n \)</span>, חזקה שהיא <span>\( n \)</span> ואיבר פנימי שהוא <span>\( \frac{t}{\sqrt{n}} \)</span> זה… מעורר חשד.</p>

<p>עכשיו, איך מטפלים בביטוי <span>\( \left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)</span>? ה-<span>\( n \)</span> במעריך הוא מעצבן, והדרך הסטנדרטית להיפטר ממנו היא לקחת לוגריתם להכל, כי <span>\( \left(a^{n}\right)=n\log a \)</span><span>\( \log \)</span>. אז בואו נשאל את עצמנו מהו הגבול</p>

<p><span>\( \lim_{n\to\infty}n\log M\left(\frac{t}{\sqrt{n}}\right) \)</span></p>

<p>אם הגבול הזה יהיה <span>\( A \)</span> והלוגריתם שלי הוא על בסיס <span>\( a \)</span>, אז הגבול של <span>\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)</span> יהיה <span>\( a^{A} \)</span>. איזה בסיס של לוגריתם <strong>כדאי לי</strong> לבחור? אני לא רוצה שיהיו לי החלטות שרירותיות, אז בואו נתקדם עם ההוכחה ונראה איזה בסיס יצוץ מאליו (ספוילר: <span>\( e \)</span>. זה תמיד <span>\( e \)</span>).</p>

<p>אם כן, הביטוי שאנחנו צריכים להבין עכשיו הוא הפונקציה <span>\( \log M\left(\frac{t}{\sqrt{n}}\right) \)</span>. הכל נהיה פשוט יותר אחרי שיש לנו סימונים, אז נסמן: <span>\( L\left(t\right)=\log M\left(t\right) \)</span>, ועכשיו אנחנו רוצים להבין את הגבול <span>\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)</span>. איך עושים את זה? אין לי מושג, אבל לגשש בצורה עיוורת אפשר, ואחד מהכלים המועילים שיש לנו בחישוב גבולות הוא <strong>כלל לופיטל</strong>. הרעיון בו פשוט: אם <span>\( f\left(x\right),g\left(x\right) \)</span> הן שתי פונקציות כך ש-<span>\( \lim_{x\to\infty}f\left(x\right)=\lim_{x\to\infty}g\left(x\right)=0 \)</span> אז <span>\( \lim_{x\to\infty}\frac{f\left(x\right)}{g\left(x\right)}=\lim_{x\to\infty}\frac{f^{\prime}\left(x\right)}{g^{\prime}\left(x\right)} \)</span>. כלומר, בדומה לאינטגרציה בחלקים שבה השתמשתי בפוסט הקודם, גם כאן אפשר לחשב דברים על ידי גזירה של הפונקציות הרלוונטיות עד שיהיו פשוטות מספיק.</p>

<p>אצלנו הגבול הוא לא של פונקציות אלא של סדרה, אבל כל עוד הפונקציות המעורבות הן רציפות מקבלים אותו דבר. אבל בשביל להשתמש בלופיטל אנחנו צריכים <strong>מנה </strong>של שתי פונקציות ששואפות לאפס: אצלנו יש <strong>מכפלה</strong> של שתי פונקציות, <span>\( nL\left(\frac{t}{\sqrt{n}}\right) \)</span>, שאחת מהן (<span>\( n \)</span>) בכלל שואפת לאינסוף… אה, הטריק פה הוא פשוט מאוד: <span>\( nL\left(\frac{t}{\sqrt{n}}\right)=\frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}} \)</span>, ועכשיו הפונקציה במכנה היא <span>\( \frac{1}{n} \)</span> ששואפת לאפס כש-<span>\( n\to\infty \)</span>. ומה קורה במונה? הרציפות של <span>\( L \)</span> אומרת ש-<span>\( L\left(\frac{t}{\sqrt{n}}\right)\to L\left(0\right) \)</span>, אבל מהו <span>\( L\left(0\right) \)</span>? ומה נקבל אחרי שנגזור?</p>

<p>ובכן, כזכור <span>\( L\left(t\right)=\log M\left(t\right) \)</span>. מכיוון ש-<span>\( M\left(t\right)=\text{E}\left[e^{tX_{i}}\right] \)</span> הרי ש-<span>\( M\left(0\right)=\text{E}\left[e^{0\cdot X_{i}}\right]=\text{E}\left[1\right]=1 \)</span> כך ש-<span>\( L\left(0\right)=\log1=0 \)</span>. זה טוב, זה בדיוק מה שאנחנו רוצים. עכשיו, מה עם הנגזרת? יש לנו כאן עסק עם הרכבה של פונקציות: <span>\( \log \)</span> שמורכבת על <span>\( M \)</span>. זה מצריך מאיתנו שני דברים: את הכלל של נגזרת של לוגריתם, ואת כלל השרשרת. והכלל לנגזרת של לוגריתם הוא</p>

<p><span>\( \left(\log_{a}t\right)^{\prime}=\frac{1}{t\ln a} \)</span>, כאשר <span>\( \ln \)</span> הוא לוגריתם על בסיס <span>\( e \)</span>. הביטוי הזה הופך לפשוט יותר אם מלכתחילה הלוגריתם שלנו הוא על בסיס <span>\( e \)</span>; אז מקבלים <span>\( \left(\log t\right)^{\prime}=\frac{1}{t} \)</span>. אז יש לנו סיבה טובה לבחור שהלוגריתם שלנו יהיה על בסיס <span>\( e \)</span>, מה שאומר שאחרי שנצליח לחשב את <span>\( \lim_{n\to\infty}n\log M\left(\frac{t}{\sqrt{n}}\right)=A \)</span>, נקבל ש-<span>\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n}=e^{A} \)</span>.</p>

<p>עכשיו, על פי כלל השרשרת <span>\( \left[f\left(g\left(x\right)\right)\right]^{\prime}=f^{\prime}\left(g\left(x\right)\right)g^{\prime}\left(x\right) \)</span> אנחנו מקבלים</p>

<p><span>\( L^{\prime}=\left(\log M\right)^{\prime}=\frac{M^{\prime}}{M} \)</span> (יש לדבר כזה שם - “הנגזרת הלוגריתמית” של <span>\( M \)</span>)</p>

<p>ראינו כבר ש-<span>\( M\left(0\right)=1 \)</span>. כמו כן, <span>\( M^{\prime}\left(0\right)=\text{E}\left[X\right]=\mu=0 \)</span> (זוכרים? ראינו שככה פונקציה יוצרת מומנטים עובדת). אז קיבלנו ש-<span>\( L^{\prime}\left(0\right)=0 \)</span>, מה שאומר שכלל לופיטל צפוי להיתקל בקשיים כי גם אחרי הגזירה המונה ישאף ל-0. אבל אפשר לגזור שוב! הפעם נשתמש בכלל לגזירה של מנה, <span>\( \left(\frac{f}{g}\right)^{\prime}=\frac{f^{\prime}g-fg^{\prime}}{g^{2}} \)</span> ונקבל</p>

<p><span>\( L^{\prime\prime}=\left(\frac{M^{\prime}}{M}\right)^{\prime}=\frac{M^{\prime\prime}M-\left(M^{\prime}\right)^{2}}{M^{2}} \)</span></p>

<p>ולכן כשנציב <span>\( 0 \)</span> ונשתמש בכך ש-<span>\( M\left(0\right)=1,M^{\prime}\left(0\right)=0,M^{\prime\prime}\left(0\right)=\text{E}\left[X^{2}\right]=\sigma^{2}+\mu^{2}=1 \)</span>, נקבל</p>

<p><span>\( L^{\prime\prime}\left(0\right)=\frac{1-0^{2}}{1}=1 \)</span></p>

<p>וזה כבר משהו לעבוד איתו! כל מה שנשאר לנו הוא לקחת את הביטוי <span>\( \frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}} \)</span> ולגזור בו (בנפרד!) את המונה והמכנה פעמיים. זה לא יהיה כזה נורא, נכון? נקודה אחת שצריך לשים לב אליה היא שהגזירה שלנו היא ביחס למשתנה <span>\( n \)</span>, ואילו דווקא אל <span>\( t \)</span> אנחנו מתייחסים בתור קבוע, כי הגבול שלנו הוא כש-<span>\( n \)</span> רץ לאינסוף. זה הופך את הכל לטיפה יותר מסובך.</p>

<p>כלל הגזירה הבסיסי ביותר הוא <span>\( \left(x^{a}\right)^{\prime}=ax^{a-1} \)</span>. מכאן נקבל ש-<span>\( \left(n^{-1}\right)^{\prime}=-n^{-2} \)</span> וש-<span>\( \left(\frac{1}{\sqrt{n}}\right)^{\prime}=\left(n^{-\frac{1}{2}}\right)^{\prime}=-\frac{1}{2}n^{-\frac{3}{2}} \)</span>.</p>

<p>הנגזרת של <span>\( L\left(\frac{t}{\sqrt{n}}\right) \)</span> על פי כלל השרשרת היא <span>\( \left(\frac{t}{\sqrt{n}}\right)^{\prime}L^{\prime}\left(\frac{t}{\sqrt{n}}\right)=-\frac{t}{2}n^{-\frac{3}{2}}L^{\prime}\left(\frac{t}{\sqrt{n}}\right) \)</span> , ולכן מכלל לופיטל אנחנו מקבלים</p>

<p><span>\( \lim_{n\to\infty}\frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}}=\lim_{n\to\infty}\frac{-\frac{t}{2}n^{-\frac{3}{2}}L^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{-n^{-2}}=\lim_{n\to\infty}\frac{tL^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{2n^{-1/2}} \)</span></p>

<p>המונה עדיין שואף לאפס כש-<span>\( n\to\infty \)</span> (כי ראינו <span>\( L^{\prime}\left(0\right)=0 \)</span>) והמכנה, שהוא עכשיו <span>\( -\frac{2}{\sqrt{n}} \)</span>, גם כן שואף לאפס, אז אפשר להשתמש שוב בכלל לופיטל. הנגזרת של המכנה תהיה <span>\( \left(2n^{-\frac{1}{2}}\right)^{\prime}=-n^{-\frac{3}{2}} \)</span>. המונה יהיה כמו קודם (אל ה-<span>\( t \)</span> שמופיע שם אנחנו כאמור מתייחסים בתור קבוע והוא לא משפיע על הגזירה). לכן נקבל מכלל לופיטל</p>

<p><span>\( \lim_{n\to\infty}\frac{tL^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{2n^{-1/2}}=\lim_{n\to\infty}\frac{-\frac{t^{2}}{2}n^{-\frac{3}{2}}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right)}{-n^{-3/2}}=\lim_{n\to\infty}\frac{t^{2}}{2}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right) \)</span></p>

<p>הופה! העלמנו לגמרי את מה שהופיע במכנה! ועכשיו, בגלל ש-<span>\( L^{\prime\prime}\left(0\right)=1 \)</span>, אנחנו מקבלים גבול פשוט במיוחד: <span>\( \lim_{n\to\infty}\frac{t^{2}}{2}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right)=\frac{t^{2}}{2} \)</span>. זה אומר שמצאנו את מה שהפונקציה יוצרת המומנטים של <span>\( Z_{n} \)</span> שואפת אליו: <span>\( \lim_{n\to\infty}M_{Z_{n}}\left(t\right)=e^{\frac{t^{2}}{2}} \)</span>. זה, סוף כל סוף, מסביר מאיפה מגיע <span>\( e^{\frac{t^{2}}{2}} \)</span> להתפלגות הנורמלית - לפחות מבחינה טכנית - אם כי יש עוד שלב לא טריוויאלי אחד שצריך להתגבר עליו.</p>

<h2>הפונקציה יוצרת המומנטים של התפלגות נורמלית</h2>

<p>ההוכחה עדיין לא בדיוק הסתיימה. מה שהראיתי הוא שאם <span>\( Z \)</span> הוא משתנה מקרי עם פונקציה יוצרת מומנטים <span>\( M_{Z}\left(t\right)=e^{\frac{t^{2}}{2}} \)</span> אז הפונקציה יוצרת המומנטים של אברי הסדרה <span>\( Z_{n} \)</span> תתכנס לפונקציה יוצרת המומנטים של <span>\( Z \)</span>. המסקנה, מטענת העזר שציטטתי בלי הוכחה, היא ש-<span>\( F_{Z_{n}}\left(t\right) \)</span> מתכנסת אל <span>\( F_{Z}\left(t\right) \)</span>. אבל מהי פונקציית הצפיפות <span>\( F_{Z}\left(t\right) \)</span>? זה השלב שבו צריך לקחת את ההתפלגות הנורמלית, לחשב את הפונקציה יוצרת המומנטים שלה ולקבל <span>\( e^{\frac{t^{2}}{2}} \)</span>. זה חישוב די פשוט בהינתן כל החישובים שכבר עברנו, אבל יש כאן גם שאלה מעניינת - האם אפשר ללכת “בכיוון השני”? להתחיל מהשוויון שצריך להתקיים ולהסיק איך ההתפלגות הנורמלית אמורה להיראות?</p>

<p>באופן כללי אני יכול לסמן <span>\( F_{Z}\left(z\right)=f\left(z\right) \)</span> ואז להשתמש בשוויון <span>\( e^{t^{2}/2}=\text{E}\left[e^{tZ}\right] \)</span> כש-<span>\( \text{E}\left[e^{tZ}\right] \)</span> הוא מה ש<strong>מגדיר</strong> את הפונקציה יוצרת המומנטים, ולקבל שאני צריך שיתקיים השוויון</p>

<p><span>\( e^{t^{2}/2}=\int_{-\infty}^{\infty}e^{tz}f\left(z\right)dz \)</span></p>

<p>הדבר הזה נקרא <strong>משוואה אינטגרלית</strong>: בדומה למשוואה דיפרנציאלית, זו משוואה שבה הנעלם הוא לא סתם ערך מספרי אלא <strong>פונקציה</strong>, והמידע שיש לנו על הפונקציה הזו מערב אינטגרל שלה. כמו עם משוואות דיפרנציאליות, פתרון משוואות אינטגרליות זה עניין מסובך והרבה פעמים לומר “אוקיי, בואו ננחש שהפתרון הוא מהצורה כך וכך…” הוא לגיטימי, אבל עבור המשוואה שלעיל דווקא יש שיטת פתרון כללית, פחות או יותר, בעזרת מה שנקרא <strong>התמרת לפלס</strong>. להיכנס לזה לוקח אותי רחוק מדי ממה שאפשר לדבר עליו במרוכז כאן, אז בואו ננקוט בגישה השניה: נתחיל עם ההגדרה הידועה של <span>\( f\left(z\right) \)</span> עבור התפלגות נורמלית ונראה שאנחנו מקבלים את השוויון למעלה. החישובים הספציפיים שנצטרך לבצע הם דומים למדי לחישובים שצריך לעשות אם פותרים את המשוואה האינטגרלית.</p>

<p>אם כן, <span>\( f\left(z\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)</span>, ולכן אנחנו מחשבים את האינטגרל</p>

<p><span>\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{tz}e^{-z^{2}/2}dz \)</span></p>

<p>לב העניין הוא מה שהולך בחזקה של <span>\( e \)</span>. בהתחלה כתוב שם</p>

<p><span>\( tz-\frac{z^{2}}{2} \)</span></p>

<p>לב הרעיון הטכני (גם פה וגם בגישת המשוואה האינטגרלית) הוא <strong>להשלים לריבוע</strong> את הביטוי הזה; להכניס את ה-<span>\( z \)</span>-ים בצורה יפה לסוגריים שאותם מעלים בריבוע, ואולי להוציא החוצה איזה קבוע שקשור ל-<span>\( t \)</span>. זו בדיוק אותה השלמה לריבוע שאיתה גם פותרים משוואה ריבועית, <a href="https://gadial.net/2023/12/16/quadratic_equations/">כמו שהראיתי</a> פעם בבלוג.</p>

<p>אז ראשית, בואו נעשה חישובון:</p>

<p><span>\( tz-\frac{z^{2}}{2}=-\frac{1}{2}\left(z^{2}-2tz\right) \)</span></p>

<p>מה שבתוך הסוגריים כבר די קרוב למשהו ריבועי! רק צריך להוסיף ולחסר <span>\( t^{2} \)</span>:</p>

<p><span>\( -\frac{1}{2}\left(z^{2}-2tz\right)=-\frac{1}{2}\left(z^{2}-2tz+t^{2}-t^{2}\right)=\frac{t^{2}}{2}-\frac{1}{2}\left(z-t\right)^{2} \)</span></p>

<p>בום! ה-<span>\( \frac{t^{2}}{2} \)</span> שקיבלנו יהיה בדיוק אותו <span>\( \frac{t^{2}}{2} \)</span> ב-<span>\( e^{t^{2}/2} \)</span> שאנחנו מצפים לקבל בסוף הדרך. בואו נחזור אל האינטגרל:</p>

<p><span>\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{tz}e^{-z^{2}/2}dz=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{t^{2}/2-\left(z-t\right)^{2}/2}dz \)</span></p>

<p>עכשיו אפשר להוציא את הקבוע החוצה, תוך שימוש בכך ש-<span>\( e^{a-b}=e^{a}e^{-b} \)</span>:</p>

<p><span>\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{t^{2}/2-\left(z-t\right)^{2}/2}dz=e^{t^{2}/2}\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\left(z-t\right)^{2}/2}dz \)</span></p>

<p>את האינטגרל <span>\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\left(z-t\right)^{2}/2}dz \)</span> אנחנו כבר יודעים לחשב; שברנו עליו את הראש כשרצינו להוכיח שפונקציית הצפיפות של ההתפלגות הנורמלית מסתכמת ל-1. העובדה שאנחנו צריכים לעבור דרכו היא “חוק שימור הקושי” - גם אם הייתי מנסה ללכת דרך משוואות אינטגרליות הייתי צריך לצלול בים טכני של טענות כלליות על הלהטוטים שאנחנו יכולים לעשות במסגרת חדו”א; למזלי בגישה הנוכחית אני יכול פשוט לומר שכבר עשינו את זה. מה שראינו היה <span>\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx=1 \)</span>, וזה בדיוק אותו הדבר כמו אצלנו עד כדי החלפת המשתנה <span>\( x=z-t \)</span> שלא משפיעה על האינטגרל כי גבולות האינטגרציה הם ממילא מ-<span>\( -\infty \)</span> עד <span>\( \infty \)</span> והיעקוביאן של ההחלפה (שהוא במקרה הזה פשוט נגזרת) יוצא 1.</p>

<h2>ולסיום - אז למה הדברים הם כמו שהם?</h2>

<p>לסיום סדרת הפוסטים הזו, בואו נחזור אל הפונקציה שאותה רצינו להבין: <span>\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)</span>, פונקציית הצפיפות של התפלגות נורמלית. בשלב הזה אנחנו כבר יודעים ש-<span>\( \pi \)</span> כאן כדי להבטיח שהכל יסתכם ל-1, שה-<span>\( \mu \)</span> וה-<span>\( \sigma \)</span> מייצגים את התוחלת וסטיית התקן ואפשר לנרמל אותם החוצה ושהאקספוננט מגיע, בגדול, מזה שהפונקציה שמתארת התנהלות של סכום משתנים מקריים בלתי תלויים ומפולגים אחיד נראית כמו<span>\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)</span>. וזה בעצם מגיע אל מה שהטריד <strong>אותי</strong> עם משפט הגבול המרכזי: מה זה ה-<span>\( \frac{1}{\sqrt{n}} \)</span> הזה? למה כדי לנרמל מחלקים דווקא בו? מה קרה ל-<span>\( \frac{1}{n} \)</span> הישן והטוב? ולמה לחלק בכלל? בתחילת הפוסט הזכרתי את השימוש שעשיתי במשפט הגבול המרכזי - פשוט חיברתי את ה-<span>\( X_{i} \)</span>-ים שלי וקירבתי את התוצאה הזו עם עקומה נורמלית; בשביל לעשות את זה לא הספיק לדעת רק את <span>\( \mu,\sigma \)</span> אלא הייתי צריך להכניס גם את <span>\( n \)</span> למשוואה: כפלתי ב-<span>\( n \)</span> גם את <span>\( \mu \)</span> וגם את <span>\( \sigma^{2} \)</span> (כלומר, בפועל כפלתי את <span>\( \sigma \)</span> ב-<span>\( \sqrt{n} \)</span> והנה השורש צץ שוב).</p>

<p>אבל מה היה קורה אם מלכתחילה הייתי מנרמל על ידי חלוקה ב-<span>\( n \)</span> ולכן מגיע אל חישוב של <span>\( \lim_{n\to\infty}\left[M\left(\frac{t}{n}\right)\right]^{n} \)</span>? התשובה, כמובן, היא ששום דבר לא היה עובד. כזכור, כדי להתמודד עם הגבול הזה הגדרתי <span>\( L\left(t\right)=\log M\left(t\right) \)</span> ואז חישבתי את הגבול <span>\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)</span> באמצעות כלל לופיטל. עוד לפני שאומרים לופיטל, כבר ברור שהגבול <span>\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)</span> קיים בכלל רק בזכות זה שיש פה שני כוחות שונים וסותרים שמאזנים אחד את השני. ה-<span>\( n \)</span> שבו כופלים שואף לאינסוף, בעוד שה-<span>\( L\left(\frac{t}{\sqrt{n}}\right) \)</span> שואף לאפס. בגבולות מהצורה “משהו ששואף לאינסוף כפול משהו ששואף לאפס” פחות או יותר הכל יכול לקרות, והסיכוי שנקבל תוצאה סופית תלוי ביחסים העדינים בין שתי הפונקציות שאותם כופלים. כלל לופיטל הוא בדיוק דרך “לקלף” מעל שתי הפונקציות המעורבות שכבה אחר שכבה של סיבוכיות עד שמגיעים אל הגרעין העדין שלהן שאנחנו יודעים להשוות. ועכשיו חדל פילוסופיה ובואו נדבר תכל’ס. מה היה קורה אם היינו מחלקים ב-<span>\( n \)</span> ולא ב-<span>\( \sqrt{n} \)</span>? (אם לא היינו מחלקים <strong>בכלל</strong> ב-<span>\( n \)</span> אז היינו מקבלים <span>\( \lim_{n\to\infty}L\left(t\right)=L\left(t\right) \)</span> וקבוע כפול אינסוף הוא אינסוף).</p>

<p>בואו נעשה קופי-פייסט מההוכחה שכתבתי קודם ונחליף כל מופע של -<span>\( \sqrt{n} \)</span> ב-<span>\( n \)</span>, עם ההשלכות המתאימות:</p>

<p>הנגזרת של <span>\( L\left(\frac{t}{n}\right) \)</span> על פי כלל השרשרת היא <span>\( \left(\frac{t}{n}\right)^{\prime}L^{\prime}\left(\frac{t}{n}\right)=-tn^{-2}L^{\prime}\left(\frac{t}{n}\right) \)</span> , ולכן מכלל לופיטל אנחנו מקבלים</p>

<p><span>\( \lim_{n\to\infty}\frac{L\left(\frac{t}{n}\right)}{n^{-1}}=\lim_{n\to\infty}\frac{-tn^{-2}L^{\prime}\left(\frac{t}{n}\right)}{-n^{-2}}=\lim_{n\to\infty}tL^{\prime}\left(\frac{t}{n}\right) \)</span></p>

<p>וזה… טוב? נפטרנו לגמרי מהגורם שבמכנה! אבל ראינו קודם ש-<span>\( L^{\prime}\left(0\right)=0 \)</span>, כלומר <span>\( \lim_{n\to\infty}tL^{\prime}\left(\frac{t}{n}\right)=0 \)</span>, וזה ממש לא טוב לנו. זה אומר שעבור המשתנה המקרי <span>\( Z_{n}=\frac{X_{1}+\ldots+X_{n}}{n} \)</span> מתקיים <span>\( M_{Z}=e^{0}=1 \)</span>, ובמילים אחרות - קיבלנו משתנה מקרי שכל המומנטים שלו הם 0. או, בניסוח שקצת יותר קל להבין - קיבלנו אפס. וזה לא אמור להיות מפתיע שקיבלנו אפס כי זה בדיוק מה שאומר <strong>אי-שוויון צ'בישב</strong> עבור התפלגויות שסטיית התקן שלהן היא אפס. כזכור, הוא אומר באופן כללי ש-</p>

<p><span>\( P\left(\left|X-\mu\right|\ge k\right)\le\frac{\sigma^{2}}{k^{2}} \)</span></p>

<p>ואם סטיית התקן <span>\( \sigma=0 \)</span> זה אומר שלכל <span>\( k&gt;0 \)</span>, ההסתברות ש-<span>\( X \)</span> יקבל ערך שסוטה מהתוחלת ולו ב-<span>\( k \)</span> היא פשוט 0. עגול. לא קירוב ולא כלום. עכשיו שוב, צריך להזכיר שזה <strong>לא</strong> אומר שהמשתנה המקרי הוא זהותית אפס; כשאנחנו עוסקים במשתנים מקריים רציפים כל מה שזה יכול לומר הוא שמידת ההסתברות של קבוצת כל התוצאות ששונות מ-<span>\( \mu \)</span> היא אפס.</p>

<p>את מה שראינו עכשיו אפשר לקחת טיפה יותר רחוק. בפוסט הקודם הגדרתי <span>\( \overline{X}_{n}=\frac{X_{1}+X_{2}\ldots+X_{n}}{n} \)</span> (שזה בדיוק מה שקראתי לו כאן <span>\( Z_{n} \)</span>) ואז הוכחתי שבהסתברות 1 מתקיים <span>\( \overline{X}_{n}\to\mu \)</span>. התוצאה הזו, שנקראה <strong>החוק החזק של המספרים הגדולים</strong>, דיברה על ההתנהגות של כל הסדרה <span>\( \overline{X}_{n} \)</span> “בבת אחת”. אפשר לדבר על זה גם מזווית טיפה שונה. הרי אנחנו יודעים ש-<span>\( \overline{X}_{n} \)</span> לא בהכרח יהיה <strong>שווה</strong> לתוחלת - אנחנו צריכים לקחת עוד ועוד איברים ולהגדיל את <span>\( n \)</span> כדי שהממוצע יתקרב לתוחלת וגם אז הסיכוי שהוא יהיה שווה לה הוא לא בהכרח גדול. אבל אפשר להעריך בצורה גסה מה יהיה גודל הטעות, בעזרת צ’בישב.</p>

<p>אז נניח שיש לי משתנה <span>\( X \)</span> כך ש-<span>\( \text{E}\left[X\right]=\mu \)</span> ו-<span>\( \text{Var}\left(X\right)=\sigma^{2} \)</span>. עכשיו בניתי משתנה חדש, <span>\( \overline{X}_{n}=\frac{X_{1}+\ldots+X_{n}}{n} \)</span>. מה התוחלת שלו? לינאריות התוחלת נותנת לנו</p>

<p><span>\( \text{E}\left[\overline{X}_{n}\right]=\text{E}\left[\frac{X_{1}+\ldots+X_{n}}{n}\right]=\frac{\text{E}\left[X_{1}\right]+\ldots+\text{E}\left[X_{n}\right]}{n}=\frac{\mu+\ldots+\mu}{n}=\mu \)</span></p>

<p>עכשיו, שונות של משתנים מקריים לא מקיימת לינאריות באופן כללי, אבל היא <strong>כן</strong> משמרת חיבור של משתנים מקריים <strong>בלתי תלויים</strong> (די בדומה לאיך שתוחלת של מכפלה של משתנים בלתי תלויים מתפרקת למכפלת תוחלות). בפוסט הקודם גם הזכרתי ש-<span>\( \text{Var}\left(\alpha X\right)=\alpha^{2}X \)</span>. לכן אפשר לחשב:</p>

<p><span>\( \text{Var}\left(\overline{X}_{n}\right)=\text{Var}\left(\frac{X_{1}+\ldots+X_{n}}{n}\right)=\frac{\text{Var}\left(X_{1}\right)+\ldots+\text{Var}\left(X_{n}\right)}{n^{2}}=\frac{\sigma^{2}+\ldots\sigma^{2}}{n^{2}}=\frac{\sigma^{2}}{n} \)</span></p>

<p>ולכן מאי-שוויון צ’בישב:</p>

<p><span>\( P\left(\left|\overline{X}_{n}-\mu\right|\ge\varepsilon\right)\le\frac{\sigma^{2}}{n\varepsilon^{2}} \)</span></p>

<p>המספר המעניין פה הוא ה-<span>\( n \)</span> שנשאר במכנה. בזכותו, אם משאיפים את <span>\( n \)</span> לאינסוף, מקבלים</p>

<p><span>\( \lim_{n\to\infty}P\left(\left|\overline{X}_{n}-\mu\right|\ge\varepsilon\right)=0 \)</span></p>

<p>זה מה שנקרא <strong>החוק החלש של המספרים הגדולים</strong> (כי החוק החזק של המספרים הגדולים גורר אותו - ה”התכנסות” שלו היא חזקה יותר מההתכנסות שיש בחוק החלש) וזו דרך קצת יותר פשוטה לראות את “חוסר הטעם” שבהסתכלות על הממוצעים <span>\( \overline{X}_{n} \)</span> אם אנחנו רוצים לקבל משתנה מקרי שמדמה את ההתפלגות של <span>\( X_{1}+\ldots+X_{n} \)</span> כש-<span>\( n \)</span> גדול. המיצוע שאנחנו עושים הוא “טוב מדי” - הוא משמר את המידע על ההתפלגות שבא לידי ביטוי בתוחלת <span>\( \mu \)</span> אבל מוחק את המידע על ההתפלגות שבא לידי ביטוי בסטיית התקן <span>\( \sigma \)</span>. המיצוע שבו מחלקים ב-<span>\( \sqrt{n} \)</span> הוא “עדין” יותר ומשמר גם את המידע הזה, והוכחת החוק החלש של המספרים הגדולים נותנת עוד דרך לראות את זה - אם היינו מחלקים ב-<span>\( \sqrt{n} \)</span> ומנסים להשתמש בצ’בישב, היינו מקבלים רק <span>\( P\left(\left|\frac{X_{1}+\ldots+X_{n}}{\sqrt{n}}-\mu\right|\ge\varepsilon\right)\le\frac{\sigma^{2}}{\varepsilon^{2}} \)</span> שזו תוצאה מעניינת טיפה בפני עצמה אבל אין בה שאיפה לאפס של ההסתברות אלא רק חסם אחיד לכל הממוצעים, לא משנה כמה רחוק ניקח אותם.</p>

<p>הקסם הגדול של משפט הגבול המרכזי בעיני, כמו שאמרתי כבר לפני כמה פוסטים, הוא שלא משנה כמה המשתנה <span>\( X \)</span> שאנחנו מתחילים איתו הוא מורכב ומתוסבך - ההתנהגות של <span>\( X_{1}+\ldots+X_{n} \)</span> תהיה ניתנת לקירוב מצוין רק עם שני הפרמטרים המספריים <span>\( \mu,\sigma \)</span>. ראינו את זה בתוך ההוכחה של משפט הגבול המרכזי עצמו (היינו צריכים רק לדעת את <span>\( L^{\prime}\left(0\right) \)</span> ואת <span>\( L^{\prime\prime}\left(0\right) \)</span> כדי לקבל אותו ולא משהו שתלוי במומנטים מתקדמים יותר) וראינו את זה גם עם החוק החלש של המספרים הגדולים עכשיו (אם המומנט השני הוא אפס גורלה של ההתפלגות נחרץ להיות קבועה בהסתברות 1), אבל למרות שראינו את זה אני עדיין מתקשה להאמין לזה. אולי כי זו לא סתם תוצאה מספרית - זה משהו שבאמת בא לידי ביטוי אמפירית, במציאות, בעולם שלנו, ומשפיע עלינו בשלל דרכים שונות. גם זה אחד מהקסמים של המתמטיקה.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2025/02/05/normal_distribution_3/">&laquo; מה הקטע עם התפלגות נורמלית? (חלק ג': על תוחלת וסטיית תקן)</a>
    
    
      <a class="next" href="/2025/03/15/why_0999_equals_1/">אז למה 1=...0.999? &raquo;</a>
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2025/02/07/normal_distribution_4/';
      this.page.identifier = 'http://gadial.net/2025/02/07/normal_distribution_4/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2025/02/07/normal_distribution_4/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script>

<!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
