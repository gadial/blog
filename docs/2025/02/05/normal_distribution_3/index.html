<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>מה הקטע עם התפלגות נורמלית? (חלק ג’: על תוחלת וסטיית תקן) | לא מדויק</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="מה הקטע עם התפלגות נורמלית? (חלק ג’: על תוחלת וסטיית תקן)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="מה זה תוחלת ושונות, איך קשורים מרקוב וצ’בישב, ועל הקסם שבהפיכת המתמטיקה למדע אמפירי" />
<meta property="og:description" content="מה זה תוחלת ושונות, איך קשורים מרקוב וצ’בישב, ועל הקסם שבהפיכת המתמטיקה למדע אמפירי" />
<link rel="canonical" href="http://gadial.net/2025/02/05/normal_distribution_3/" />
<meta property="og:url" content="http://gadial.net/2025/02/05/normal_distribution_3/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/2025/histogram_12.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-02-05T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://gadial.net/assets/img/2025/histogram_12.png" />
<meta property="twitter:title" content="מה הקטע עם התפלגות נורמלית? (חלק ג’: על תוחלת וסטיית תקן)" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"url":"http://gadial.net/2025/02/05/normal_distribution_3/","@type":"BlogPosting","description":"מה זה תוחלת ושונות, איך קשורים מרקוב וצ’בישב, ועל הקסם שבהפיכת המתמטיקה למדע אמפירי","headline":"מה הקטע עם התפלגות נורמלית? (חלק ג’: על תוחלת וסטיית תקן)","dateModified":"2025-02-05T00:00:00+00:00","datePublished":"2025-02-05T00:00:00+00:00","image":"http://gadial.net/assets/img/2025/histogram_12.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2025/02/05/normal_distribution_3/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/post_list">רשימת הפוסטים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">פוסטים אקראיים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/lecture_notes">סיכומי הרצאות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2025/02/03/normal_distribution_2/">&laquo; מה הקטע עם התפלגות נורמלית? (חלק ב': על שתי הסתברויות)</a>
    
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">מה הקטע עם התפלגות נורמלית? (חלק ג&#39;: על תוחלת וסטיית תקן)</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-02-05T00:00:00+00:00" itemprop="datePublished">Feb 5, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2>מבוא</h2>

<p>בסדרת הפוסטים הנוכחית אנחנו מנסים להבין למה ההתפלגות הנורמלית <span>\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)</span> נראית כמו שהיא נראית. <a href="https://gadial.net/2025/02/03/normal_distribution_2/">בפוסט הקודם</a> הבנו מה הפונקציה הזו בכלל אומרת - זו <strong>פונקציית צפיפות ההסתברות</strong> של ההתפלגות הנורמלית, כלומר אם <span>\( X \)</span> הוא המשתנה המקרי שמתואר על ידי הפונקציה הזו, אז <span>\( P\left(a\le X\le b\right)=\int_{a}^{b}\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}dx \)</span>. בפוסט הקודם גם ראינו מאיפה ה-<span>\( \pi \)</span> הגיע - זה קבוע נרמול שנדרש כדי שיתקיים <span>\( \int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{x^{2}}{2}}=1 \)</span>. אבל מה הם ה-<span>\( \mu \)</span> וה-<span>\( \sigma \)</span> שמופיעים בנוסחה? אלו שני פרמטרים שמאפיינים לא רק את ההתפלגות הזו, אלא כל התפלגות שהיא: <strong>התוחלת</strong> <span>\( \mu \)</span> של ההתפלגות, <strong>וסטיית התקן</strong> <span>\( \sigma \)</span> שלה. באופן לא פורמלי, תוחלת של התפלגות היא הממוצע שלה, וסטיית התקן מלמדת אותנו כמה גדול הפיזור של ההתפלגות סביב הממוצע הזה. מה שמפליא הוא כמה מידע על ההתפלגות נמצא כבר בשני הערכים המספריים הללו - וההמחשה לזה היא בדיוק <strong>משפט הגבול המרכזי</strong>, שאומר שאם אנחנו יודעים את התוחלת וסטיית התקן של התפלגות, אז נדע בדיוק איך נראה מה שמתקבל מסכומים גדולים של משתנים מקריים בלתי תלויים בעלי ההתפלגות הזו.</p>

<p>בואו נעבור להגדרות פורמליות, ונראה איך זה בא לידי ביטוי בהתפלגות נורמלית ובהתפלגויות אחרות שראינו.</p>

<h2>תוחלת</h2>

<p>מה זה “ממוצע”? אם למשל יש לנו את סדרת המספרים <span>\( 10,30,50,60,90 \)</span> הממוצע שלה היא הסכום של כל המספרים חלקי כמה מספרים יש: <span>\( \frac{10+30+50+60+90}{5}=\frac{240}{5}=48 \)</span>. מה המשמעות של המספר הזה, 48? אפשר לחשוב על זה כך: אם נחליף כל איבר בסדרה ב-48, נקבל סדרה <span>\( 48,48,48,48,48 \)</span> שסכום האיברים שלה שווה לסכום אברי הסדרה המקורית.</p>

<p>את הרעיון הזה אפשר להכליל קצת: אם למשל הסדרה שלנו היא <span>\( 30,60,60 \)</span> אז הממוצע שלה הוא <span>\( 50 \)</span>, אבל אפשר גם “לאחד” את שני ה-60-ים ולהגיד שיש בסדרה שלנו שני איברים: האיבר <span>\( 30 \)</span> עם <strong>המשקל</strong> 1, והאיבר <span>\( 60 \)</span> עם <strong>המשקל</strong> 2. מה שאנחנו עושים הוא לסכום את האיברים כשכל אחד מוכפל במשקל שלו, ולחלק בסכום הכולל של המשקלים. אולי קל יותר להבין את זה עם נוסחה: אם יש לנו את הסדרה <span>\( a_{1},a_{2},\ldots,a_{n} \)</span> ואת המשקלים <span>\( w_{1},\ldots,w_{n} \)</span> אז <strong>הממוצע המשוקלל</strong> הוא <span>\( \frac{\sum_{i=1}^{n}w_{i}a_{i}}{\sum_{i=1}^{n}w_{i}} \)</span>. כאשר כל המשקלים הם 1 אנחנו מקבלים את הגדרת הממוצע הקודמת.</p>

<p>ההגדרה של ממוצע משוקלל לא דורשת שום דבר מהמשקלים, חוץ מכך שהסכום שלהם יהיה שונה מאפס (אחרת יקרה משהו מוזר כשמנסים לחלק) אבל כמובן, ההגדרה הזו יוצאת פשוטה במיוחד אם <span>\( 0\le w_{i}\le1 \)</span> ובנוסף <span>\( \sum_{i=1}^{n}w_{i} \)</span>; אנחנו מקבלים שהממוצע המשוקלל הוא פשוט <span>\( \sum_{i=1}^{n}w_{i}a_{i} \)</span>.</p>

<p>איך כל זה קשור להסתברות? ובכן, הסתברות היא בדיוק המקרה שבו יש לנו איברים <span>\( 0\le w_{i}\le1 \)</span> שמסתכמים ל-1: אם יש לנו מרחב הסתברות ו-<span>\( X \)</span> הוא משתנה מקרי שמקבל מספר <strong>סופי</strong> של ערכים, נאמר הערכים <span>\( a_{1},a_{2},\ldots,a_{n} \)</span>, אז אפשר להסתכל על הממוצע המשוקלל <span>\( \sum_{i=1}^{n}P\left(X=a_{i}\right)\cdot a_{i} \)</span>. כלומר, אנחנו לוקחים את הממוצע המשוקלל של ה-<span>\( a_{i} \)</span>-ים כשהמשקולות הן בדיוק ההסתברויות ש-<span>\( a_{i} \)</span> יעלה בגורל. סכום כזה נקרא <strong>תוחלת</strong> ומסומן ב-<span>\( E\left[X\right] \)</span>. אם מרחב המדגם הוא אינסופי העניינים מן הסתם מסתבכים קצת מתמטית אבל הרעיון זהה: <span>\( \text{E}\left[X\right]=\sum_{i=1}^{\infty}P\left(X=a_{i}\right)\cdot a_{i} \)</span> עבור מרחב מדגם אינסופי בדיד, ו-<span>\( \text{E}\left[X\right]=\int_{-\infty}^{\infty}p\left(x\right)xdx \)</span> עבור מרחב מדגם אינסופי רציף.</p>

<p>למה ממוצע משוקלל כזה הוא מעניין? אנחנו הרי מצפים שהוא ילמד אותנו משהו על המשתנה המקרי <span>\( X \)</span> ולא סתם יהיה הגדרה לשם הגדרה. כאן זו אחת מהסיטואציות הנדירות שבהן המתמטיקה הייתה מדע <strong>אמפירי</strong>: קודם כל התגלתה תופעה, ואחר כך הוכיחו אותה מתמטית. התופעה הייתה האבחנה שאם אנחנו חוזרים על אותו ניסוי הסתברותי מספרי שוב ושוב, <strong>הממוצע</strong> של התוצאות שלנו נוטה להיות יציב יחסית ככל שמספר הניסויים שאנחנו מבצעים גדל. בואו נראה דוגמא קונקרטית לזה עם הטלת קוביה. בימינו, למרבה השמחה, אפשר לרתום את המחשב לניסויים כאלו, אז הנה קוד פייתון קצרצר:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">random</span>
<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]:</span>
  <span class="k">print</span><span class="p">(</span><span class="s">f"</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="nb">sum</span><span class="p">([</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span> <span class="o">/</span> <span class="n">N</span><span class="si">}</span><span class="s">"</span><span class="p">)</span></code></pre></figure>

<p>מה שהקוד הזה עושה הוא להטיל קוביה מספר כלשהו של פעמים שמסומן ב-<span>\( N \)</span>, ואז לחשב את ממוצע ההטלות. אנחנו עושים את הניסוי הזה בנפרד עבור ערכי <span>\( N \)</span> מ-<span>\( 10 \)</span> עד <span>\( 10^{6} \)</span>, ולכל אחד מהם אנחנו מדפיסים את הממוצע. כשאני עשיתי את זה, קיבלתי:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="mi">10</span><span class="p">:</span> <span class="mf">3.1</span>
<span class="mi">100</span><span class="p">:</span> <span class="mf">3.56</span>
<span class="mi">1000</span><span class="p">:</span> <span class="mf">3.372</span>
<span class="mi">10000</span><span class="p">:</span> <span class="mf">3.4951</span>
<span class="mi">100000</span><span class="p">:</span> <span class="mf">3.50129</span>
<span class="mi">1000000</span><span class="p">:</span> <span class="mf">3.499845</span> </code></pre></figure>

<p>די בבירור, הממוצע מתקרב אל <span>\( 3.5 \)</span>. זו אבחנה אמפירית; אבל אם אנחנו רוצים לדעת לאן הממוצע ישאף אנחנו <strong>לא צריכים</strong> לבצע ניסויים בפועל - אנחנו יכולים פשוט <strong>לחשב</strong> את זה, ואיכשהו מובטח שהמציאות תסתדר בהתאם לחישוב שלנו. הערך שאנחנו מחשבים הוא - הפתעה הפתעה - התוחלת של המשתנה המקרי שמתאר את הניסוי.</p>

<p>במקרה שלנו, <span>\( X \)</span> מקבל כל ערך בין 1 ל-6 בהסתברות <span>\( \frac{1}{6} \)</span> לכל איבר, אז על פי הגדרה <span>\( E\left[X\right]=\frac{1+2+3+4+5+6}{6}=\frac{21}{6}=3.5 \)</span>. אין פה הפתעה, אבל מה שכן יש פה הוא חישוב פשוט למדי, שלא מצריך הטלת מיליון קוביות. והיופי פה הוא שזה עובד <strong>תמיד</strong>, לכל משתנה מקרי <span>\( X \)</span> שאנחנו משכפלים <span>\( n \)</span> עותקים זהים שלו שהם בלתי תלויים אחד בשני ומסתכלים על הממוצע של כולם (טוב, <a href="https://gadial.net/2008/07/25/envelope_paradox/">כמעט תמיד</a>).</p>

<p>לתופעה הזו קוראים <strong>חוק המספרים הגדולים</strong>. יש כמה ניסוחים למשפט שאומר “מה הולך פה” והניסוח הנפוץ הוא בדרך כלל של מה שנקרא <strong>החוק החזק של המספרים הגדולים</strong> שלא אוכיח כרגע אבל כן אסביר מה הוא אומר. אנחנו מתחילים עם סדרה אינסופית של משתנים מקריים <span>\( X_{1},X_{2},X_{3},\ldots \)</span> שכולם מתפלגים באותו האופן (כלומר, בעלי אותה פונקצית צפיפות הסתברות) והם בלתי תלויים, במובן הבא: <span>\( X,Y \)</span> הם בלתי תלויים אם לכל שתי קבוצות אפשריות של תוצאות <span>\( A,B \)</span> מתקיים <span>\( P\left(X\in A\wedge Y\in B\right)=P\left(X\in A\right)P\left(Y\in B\right) \)</span>; ראינו את זה טיפה בפוסט הקודם ולא אתעכב על זה הפעם.</p>

<p>עכשיו, מכיוון שכל המשתנים מתפלגים אותו דבר, יש להם אותה תוחלת. באופן כללי תוחלת עשויה להיות אינסופית או לא מוגדרת, אבל נניח שכאן היא מספר סופי, <span>\( E\left[X_{i}\right]=\mu \)</span>. במקרה הזה אנחנו יכולים להסתכל על המשתנה המקרי <span>\( \overline{X}_{n}=\frac{X_{1}+X_{2}\ldots+X_{n}}{n} \)</span>, שהוא המשתנה שמתאר את הממוצע (הרגיל, הלא משוקלל) של <span>\( n \)</span> התוצאות הראשונות בסדרת המשתנים המקריים. החוק החזק של המספרים הגדולים אומר שמתקיים <span>\( \overline{X}_{n}\to\mu \)</span> בהסתברות 1. בואו נבין טיפה יותר מה זה אומר בעצם.</p>

<p>ה-<span>\( \overline{X}_{n} \)</span>-ים שהגדרנו מתארים <strong>סדרה</strong> של משתנים שמתארת את הממוצעים ההולכים-ומשתפרים: <span>\( \overline{X}_{1},\overline{X}_{2},\overline{X}_{3},\ldots \)</span>. אם אנחנו דוגמים איבר <span>\( a \)</span> כלשהו במרחב המדגם שלנו, הוא ייתן למשתנים <span>\( X_{1},X_{2},\dots \)</span> ערכים קונקרטיים שהם מספרים ממשיים: <span>\( X_{1}\left(a\right),X_{2}\left(a\right),\ldots \)</span>, ולכן גם בסדרת הממוצעים נקבל ערכים קונקרטיים <span>\( \overline{X}_{1}\left(a\right),\overline{X}_{2}\left(a\right),\ldots \)</span>; כלומר, בהינתן שאנחנו מסתכלים על איבר קונקרטי של מרחב המדגם, קיבלנו סדרה “רגילה” של מספרים ממשיים. על סדרה “רגילה” של ממשיים אפשר לשאול האם היא מקיימת את התכונה <span>\( \lim_{n\to\infty}\overline{X}_{n}\left(a\right)=\mu \)</span>, כלומר האם לכל <span>\( \varepsilon&gt;0 \)</span> קיים <span>\( N \)</span> כך שלכל <span>\( n&gt;N \)</span> מתקיים <span>\( \left|\overline{X}_{n}\left(a\right)-\mu\right|&lt;\varepsilon \)</span>. לכל <span>\( a \)</span> במרחב המדגם שלנו התשובה לשאלה הזו היא או “כן” או “לא”. החוק החזק של המספרים הגדולים אומר שקבוצת כל ה-<span>\( a \)</span>-ים שעבורה התשובה היא “לא” היא ממידה אפס (זה לא אומר שזה לא יכול לקרות; זה אומר שזה זניח).</p>

<p>אני לא אוכיח כאן את חוק המספרים הגדולים; אני בעיקר משתמש בו כדי לתת מוטיבציה לסיבה שבגללה מושג התוחלת קופץ לנו לפרצוף ודורש שנגדיר אותו. יש עוד שימושים דומים לתוחלת, כשהפשוט שבהם הוא כנראה <strong>אי שוויון מרקוב</strong>: אם <span>\( X \)</span> הוא משתנה מקרי שמקבל רק ערכים אי-שליליים ו-<span>\( a&gt;0 \)</span> כלשהו, אז</p>

<p><span>\( P\left(X\ge a\right)\le\frac{\text{E}\left[X\right]}{a} \)</span></p>

<p>בניסוח שקול שקצת יותר מאפשר להבין מה הקטע אפשר להכניס את התוחלת לתוך אי השוויון:</p>

<p><span>\( P\left(X\ge a\cdot\text{E}\left[X\right]\right)\le\frac{1}{a} \)</span></p>

<p>כלומר, זה נותן הערכה גסה לשאלה מה הסיכוי ש-<span>\( X \)</span> יהיה גדול מפי 2 התוחלת שלו (פחות מחצי), מפי 3 התוחלת שלו (פחות משליש) וכו’. זו באמת הערכה גסה, אבל לעתים קרובות היא מספיקה כדי להוכיח את מה שרוצים לעשות באותו רגע ולכן, בנוסף לפשטות שלו, אי השוויון הזה הוא כלי שימושי מאוד.</p>

<p>ההוכחה של אי שוויון מרקוב מצחיקה בכמה שהיא פשוטה. אני מגדיר משתנה מקרי <span>\( I \)</span> שהוא מה שנקרא <strong>אינדיקטור</strong>: משתנה מקרי שמקבל או 0 או 1, ולכן בעצם נותן “אינדיקציה” לכך שאירוע מסוים קרה או לא. במקרה שלנו:</p>

<p><span>\( I=\begin{cases} 1 &amp; X\ge a\\ 0 &amp; X&lt;a \end{cases} \)</span></p>

<p>התוחלת של אינדיקטור, ממש על פי ההגדרה, היא ההסתברות שהאירוע שנותן 1 קרה, כלומר <span>\( E\left[I\right]=P\left(X\ge a\right) \)</span>. עכשיו, שימו לב ש-<span>\( I\le\frac{X}{a} \)</span> ותאמינו לי שאפשר פשוט לקחת תוחלת לשני האגפים ולהוציא את הקבוע החוצה, ונקבל</p>

<p><span>\( P\left(X\ge a\right)=E\left[I\right]=\frac{E\left[X\right]}{a} \)</span></p>

<p>אתם כמובן לא אמורים להאמין לי שפשוט אפשר לעשות את זה, אבל אני לא אוכיח את זה הפעם. את הקטע עם “להוציא את הקבוע החוצה” אפשר להכליל - התוחלת מקיימת תכונה מועילה מאוד שנקראת <strong>לינאריות</strong>: אם <span>\( X,Y \)</span> הם משתנים מקריים כלשהם (שיכולים להיות גם תלויים) ו-<span>\( \alpha,\beta \)</span> הם קבועים מספריים, אז <span>\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)</span> (ואפשר להכליל את זה לסכום סופי כלשהו של משתנים מקריים).</p>

<p>הראיתי את המושג האבסטרקטי של תוחלת ואיזו דוגמא מסכנה עם הטלת קוביה, אבל זה לא מספיק, בואו נראה דוגמא קונקרטית - מה שנקרא <strong>התפלגות בינומית</strong>. בהתפלגות בינומית יש לנו ניסוי בסיסי שחוזר על עצמו עם הסתברות <span>\( p \)</span> להצליח ו-<span>\( q=1-p \)</span> להיכשל בכל פעם; כבר ראינו שאם חוזרים על הניסוי <span>\( n \)</span> פעמים אז ההסתברות לקבל בדיוק <span>\( k \)</span> הצלחות היא <span>\( p\left(X=k\right)={n \choose k}p^{k}q^{n-k} \)</span>. לכן, התוחלת של המשתנה המקרי הזה היא</p>

<p><span>\( \text{E}\left[X\right]=\sum_{k=0}^{n}k{n \choose k}p^{k}q^{n-k} \)</span></p>

<p>יש טריק מתמטי לא מסובך שמאפשר לחשב את הסכום הזה, אבל למרבה השמחה הוא עובד באופן קצת יותר כללי ויאפשר לחשב לא רק את <span>\( \text{E}\left[X\right] \)</span> אלא גם את <span>\( \text{E}\left[X^{t}\right] \)</span> לכל חזקה טבעית <span>\( t \)</span>, וזה הולך לעזור לנו בקרוב (הערכים <span>\( \text{E}\left[X^{t}\right] \)</span> נקראים <strong>המומנטים</strong> של המשתנה המקרי <span>\( X \)</span> ויש להם חשיבות באופן כללי). הסכום במקרה הכללי יותר הזה הוא</p>

<p><span>\( \text{E}\left[X^{t}\right]=\sum_{k=0}^{n}k^{t}{n \choose k}p^{k}q^{n-k} \)</span></p>

<p>כי הדרך היחידה שבה הערך <span>\( k^{t} \)</span> יכול להתקבל על ידי המשתנה <span>\( X^{t} \)</span> היא אם הערך <span>\( k \)</span> יתקבל על ידי המשתנה <span>\( X \)</span>, כלומר <strong>ההסתברות</strong> היא אותו דבר וכל מה שהשתנה הוא שמופיע בתחילת הסכום <span>\( k^{t} \)</span> במקום סתם <span>\( k \)</span>.</p>

<p>עכשיו, קודם כל שימו לב שאם <span>\( k=0 \)</span> האיבר שמתאים למקרה הזה הוא פשוט אפס, כלומר אפשר לכתוב</p>

<p><span>\( \text{E}\left[X^{t}\right]=\sum_{k=1}^{n}k^{t}{n \choose k}p^{k}q^{n-k} \)</span></p>

<p>הטריק הוא עכשיו לפתוח את ההגדרה של <span>\( {n \choose k}=\frac{n!}{k!\left(n-k\right)!} \)</span> ולקבל</p>

<p><span>\( k{n \choose k}=k\cdot\frac{n!}{k!\left(n-k\right)!}=n\frac{k}{k!}\cdot\frac{\left(n-1\right)!}{\left(n-k\right)!}=n\frac{\left(n-1\right)!}{\left(k-1\right)!\left(n-k\right)!}=n{n-1 \choose k-1} \)</span></p>

<p>נציב את זה אצלנו ועל הדרך נוציא <span>\( p \)</span> אחד החוצה כדי להקטין את החזקה של <span>\( p \)</span> באחד:</p>

<p><span>\( \sum_{k=1}^{n}k^{t}{n \choose k}p^{k}q^{n-k}=np\sum_{k=1}^{n}k^{t-1}{n-1 \choose k-1}p^{k-1}q^{n-k} \)</span></p>

<p>עכשיו נבצע החלפת משתנה <span>\( i=k-1 \)</span>. כלומר כש-<span>\( k=1 \)</span> אז <span>\( i=0 \)</span> ואילו כש-<span>\( k=n \)</span> אז <span>\( i=n-1 \)</span>, ולכן</p>

<p><span>\( np\sum_{k=1}^{n}k^{t-1}{n-1 \choose k-1}p^{k-1}q^{n-k}=np\sum_{i=0}^{n-1}\left(i+1\right)^{t-1}{n-1 \choose i}p^{i}q^{n-i-1} \)</span></p>

<p>עכשיו בואו נסתכל על הביטוי שקיבלנו בסכום:</p>

<p><span>\( \sum_{i=0}^{n-1}\left(i+1\right)^{t-1}{n-1 \choose i}p^{i}q^{n-i-1} \)</span></p>

<p>חוץ מה-<span>\( \left(i+1\right)^{t-1} \)</span> בהתחלה זה נראה בדיוק כמו סכום על ההסתברויות של משתנה בינומי אחר שאסמן <span>\( Y \)</span>, עם <span>\( n-1 \)</span> נסיונות ואותן הסתברויות הצלחה וכישלון <span>\( p,q \)</span>. ה-<span>\( \left(i+1\right)^{t-1} \)</span> בתחילת הסכום נראה קצת מוזר אבל אם חושבים על זה, רואים שהסכום פשוט שווה אל <span>\( \text{E}\left[\left(Y+1\right)^{t-1}\right] \)</span>. כלומר קיבלנו</p>

<p><span>\( \text{E}\left[X^{t}\right]=np\text{E}\left[\left(Y+1\right)^{t-1}\right] \)</span></p>

<p>במקרה הבסיס שבו <span>\( t=1 \)</span> אז <span>\( \left(Y+1\right)^{t-1} \)</span> הוא פשוט הקבוע 1 ולכן התוחלת שלו היא 1 ולכן קיבלנו</p>

<p><span>\( \text{E}\left[X\right]=np \)</span></p>

<p>אבל עם הנוסחה נוכל לחשב בקלות גם את <span>\( \text{E}\left[X^{2}\right] \)</span>, למשל. כי:</p>

<p><span>\( \text{E}\left[X^{2}\right]=np\text{E}\left[Y+1\right]=np\left(\text{E}\left[Y\right]+1\right)=np\left(\left(n-1\right)p+1\right) \)</span></p>

<p>כאן למשל השתמשתי בלינאריות של התוחלת. אבל למה בעצם <span>\( \text{E}\left[X^{2}\right] \)</span> מעניין אותי? או, אנחנו בדיוק מגיעים אל זה.</p>

<h2>שונות וסטיית תקן</h2>

<p>ראינו זה עתה שאם <span>\( X \)</span> הוא משתנה בינומי שמתאר ספירה של הצלחות בניסוי שחוזר על עצמו <span>\( n \)</span> פעמים עם הסתברות הצלחה <span>\( p \)</span> בכל פעם, אז התוחלת שלו היא <span>\( np \)</span>. ראינו גם שהתוחלת של התוצאה בהטלת קובייה הוגנת היא <span>\( 3.5 \)</span>. אז אם נבחר את הפרמטרים של <span>\( X \)</span> להיות <span>\( n=7,p=\frac{1}{2} \)</span> נקבל שהתוחלת של <span>\( X \)</span> היא גם <span>\( 3.5 \)</span>: התוחלת של “הטל מטבע הוגן 7 פעמים וספור כמה פעמים התקבל עץ” היא אותה תוחלת כמו של “הטל קוביה הוגנת ובדוק מה יצא”. אבל אלו בבירור ניסויים שונים למדי זה מזה - בהטלת קוביה לכל תוצאה יש אותו סיכוי, ובניסוי הבינומי אין סימטריה כזו ויש גם ערכים כמו 0 ו-7 שלא יכולים לצוץ בהטלת קוביה. עוד משחק שאני יכול לעשות הוא לשחק “הטלת מטבע” עם מטבע שהערך של צד אחד שלו הוא 0 והערך של הצד השני שלו הוא 7: גם במקרה הזה נקבל תוחלת <span>\( 3.5 \)</span>.</p>

<p>אם אני לוקח את שלושת הניסויים השונים הללו ועושה עליהם את מה שעשיתי בפוסט הראשון בסדרה, כלומר מצייר את העקומה של ההתפלגות הנורמלית שמקרבת את מה שמקבלים אם חוזרים על הניסוי 100 פעמים וסוכמים את התוצאות - זה מה שאני אקבל:</p>

<p><img src="/assets/img/2025/histogram_12.png" alt="" /></p>

<p>יש כאן שלוש עקומות נורמליות, שניסיתי לצבוע בצבעים שונים כדי להבדיל ביניהן (אבל אני לא בטוח אם הצבעים ייראו שונים לכל הקוראים). העקומה שמגיעה הכי גבוהה, שצבועה באדום, מתאימה למשתנה הבינומי; האמצעית, שצבועה בכחול, מתאימה למשתנה של הקוביה; והתחתונה, הירוקה, מתאימה למשתנה של המטבע עם הערכים 0 ו-7.</p>

<p>מה הסיבה להבדל? ככל שעקומה נורמלית היא יותר גבוהה, כך זה אומר שרוב ההסתברות שהיא מייצגת מתארת טווח קטן יחסית. המקרה הקיצוני ביותר הוא המשתנה המקרי שפשוט מחזיר <span>\( 3.5 \)</span> תמיד, שיתואר על ידי קו אנכי בודד בדיוק ב-<span>\( 350 \)</span>. הסיבה שהעקומה הירוקה, הנמוכה, היא כל כך “רחבה” היא שהניסוי שהיא מתארת הוא בעל רק שני ערכים, ששניהם במרחק לא זניח מהתוחלת עצמה ולכן כל אי-אחידות בתוצאות של ההגרלה (נניח, יתרון של 9 הטלות שנתנו 7 במקום 0) “מושך” את הסכום הכולל רחוק מהממוצע הצפוי. זו האינטואיציה, אבל אנחנו רוצים את המתמטיקה הקונקרטית - מדד מספרי שיאפשר לנו לתאר עד כמה סטייה מהתוחלת היא משהו נפוץ או נדיר.</p>

<p>אם <span>\( X \)</span> הוא משתנה מקרי ו-<span>\( \mu=\text{E}\left[X\right] \)</span> היא התוחלת שלו, אפשר להסתכל על משתנה מקרי חדש, <span>\( Y=X-\mu \)</span>. זה המשתנה המקרי המקורי, רק שעכשיו הוא מנורמל כך שהתוחלת שלו תהיה 0. מכיוון שמה שמעניין אותנו הוא גודל ה”סטייה מהממוצע”, והגודל הזה הוא פשוט <span>\( \left|Y\right| \)</span>, אפשר לשאול את עצמנו <strong>מה הסטייה הממוצע מהממוצע</strong>, כלומר <span>\( \text{E}\left[\left|Y\right|\right] \)</span>. זה אמנם מדד מתבקש למדי, אבל הוא פחות מועיל מאשר אפשר היה לקוות. פונקציית הערך המוחלט היא לא “נחמדה” מבחינה מתמטית - בפרט, היא לא גזירה ב-0. עניין אחר הוא שהיא מאותו סדר גודל כמו <span>\( Y \)</span> ודווקא יש עניין בכך שנעבור אל “סדר הגודל הבא”. זה מוביל אותנו להגדרה שאולי נראית פחות טבעית ממבט ראשון אבל היא שימושית בצורה בלתי נתפסת: <span>\( \text{Var}\left(X\right)=\text{E}\left[Y^{2}\right]=\text{E}\left[\left(X-\mu\right)^{2}\right] \)</span> כאשר Var כאן הוא קיצור של Variance, <strong>שונות</strong>. העלאה בריבוע נותנת לנו את היתרונות שרצינו: היא משמשת בתור סוג של ערך מוחלט כי <span>\( a^{2} \)</span> זה אותו דבר כמו <span>\( \left|a\right|^{2} \)</span>; זה עובר לסדר הגודל השני (חשבו על העלאה בריבוע בתור העלאה של סדר הגודל; איך זה באמת חשוב, נראה אחר כך). וזו פונקציה נחמדה לעבודה מבחינה מתמטית.</p>

<p>דבר אחד שקל לראות הוא נוסחה אלטרנטיבית לתוחלת שמתקבלת מכך שפותחים במפורש את הביטוי, מה שאני אדגים במקרה של הסתברות בדידה:</p>

<p><span>\( \text{Var}\left(X\right)=\text{E}\left[\left(X-\mu\right)^{2}\right]=\sum_{a}p\left(X=a\right)\left(a-\mu\right)^{2}= \)</span></p>

<p><span>\( =\sum_{a}P\left(X=a\right)a^{2}-2\mu\sum_{a}P\left(X=a\right)a+\mu^{2}\sum_{a}P\left(X=a\right)= \)</span></p>

<p><span>\( =\text{E}\left[X^{2}\right]-2\mu\text{E}\left[X\right]+\mu^{2}=\text{E}\left[X^{2}\right]-2\mu^{2}+\mu^{2}=\text{E}\left[X^{2}\right]-\mu^{2}=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)</span></p>

<p>בואו נוודא שהבנו מה הולך פה. את הביטוי המקורי פיצלתי לשלושה סכומים על פי הפתיחה של הסוגריים <span>\( \left(a-\mu\right)^{2}=a^{2}-2a\mu+\mu^{2} \)</span>. הסכום הראשון היה <span>\( \sum_{a}P\left(X=a\right)a^{2} \)</span> שזו ממש ההגדרה הפורמלית של <span>\( \text{E}\left[X^{2}\right] \)</span>. הסכום השני היה קבוע כפול <span>\( \sum_{a}P\left(X=a\right)a \)</span> שזו ההגדרה הפורמלית של <span>\( \text{E}\left[X\right] \)</span>, ואחרי שהשתמשתי בכך ש-<span>\( \text{E}\left[X\right]=\mu \)</span> קיבלתי את הערך שרציתי.</p>

<p>הנוסחה <span>\( \text{Var}\left(X\right)=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)</span> בהחלט נראית לי יפה ושימושית יותר מאשר <span>\( \text{E}\left[\left(X-\mu\right)^{2}\right] \)</span>; היא מציגה את השונות בעזרת שני המומנטים הראשונים של <span>\( X \)</span>, שיותר קל לחשב ישירות. עשיתי את זה קודם, בדוגמה למעלה, עבור התפלגות בינומית: קיבלנו ש-<span>\( \text{E}\left[X\right]=np \)</span> ואילו <span>\( \text{E}\left[X^{2}\right]=np\left(\left(n-1\right)p+1\right) \)</span>, ולכן עכשיו אני אוכל לחשב בקלות את השונות של התפלגות בינומית:</p>

<p><span>\( \text{Var}\left(X\right)=np\left(\left(n-1\right)p+1\right)-\left(np\right)^{2}=np\left[\left(n-1\right)p+1-np\right]= \)</span></p>

<p><span>\( =np\left(np-p+1-np\right)=np\left(1-p\right)=npq \)</span></p>

<p>ובסופו של דבר קיבלנו ביטוי פשוט ואלגנטי מאוד עבור השונות. עבור המשתנה הבינומי הקונקרטי שתיארתי למעלה, של ספירת העצים ב-7 הטלות של מטבע הוגן, הפרמטרים היו <span>\( n=7,p=q=0.5 \)</span> ולכן התוחלת היא <span>\( \frac{7}{2}=3.5 \)</span> כפי שכבר ראינו, והשונות היא <span>\( \frac{7}{4}=1.75 \)</span>.</p>

<p>עבור תוחלת ראיתי שמתקיימת תכונת <strong>לינאריות</strong> מועילה מאוד: <span>\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)</span>. עבור שונות אין לנו משהו עד כדי כך נוח, אבל עדיין יש לנו נוסחה מועילה: <span>\( \text{Var}\left(\alpha X+\beta\right)=\alpha^{2}\text{Var}\left(X\right) \)</span>. כלומר - חיבור של <strong>קבוע</strong> לא משפיע (חיבור של משתנה מקרי אחר מסבך את הכל), והכפלה בקבוע מכילה את השונות באותו קבוע בריבוע.</p>

<p>עכשיו, העובדה שהשונות כוללת העלאה בריבוע היא מצד אחד חיובית מהסיבות שציינתי, ומצד שני אנחנו עדיין רוצים לקבל מדד דומה שהוא “מסדר גודל אחד פחות” ובכל זאת מתנהג נחמד. דרך פשוטה לקבל את זה היא להגדיר <span>\( \sigma=\sqrt{\text{Var}\left(X\right)} \)</span> - גם פונקציית השורש היא נחמדה יחסית, ומורידה את סדר הגודל. ה-<span>\( \sigma \)</span> הזה חשוב מספיק כדי שיקבל שם בפני עצמו: <strong>סטיית התקן</strong> של <span>\( X \)</span>, ולעתים קרובות יותר נוח פשוט לכתוב <span>\( \sigma^{2} \)</span> בתור השונות של <span>\( X \)</span> במקום <span>\( \text{Var}\left(X\right) \)</span>. את התוצאה שראינו לפני רגע אפשר לתאר גם בתור “אם כופלים את <span>\( X \)</span> ב-<span>\( \alpha \)</span> כופלים את סטיית התקן של <span>\( X \)</span> ב-<span>\( \alpha \)</span>”.</p>

<p>בואו נראה עכשיו שימוש בשונות כדי לשפר את היכולת שלנו להבין את <span>\( X \)</span> בעזרת מעין שדרוג של אי-שוויון מרקוב שלוקח גם את השונות בחשבון ונקרא <strong>אי-שוויון צ'בישב</strong>.</p>

<p>הרעיון הוא כזה. כזכור, אי-שוויון מרקוב מדבר על משתנה מקרי <strong>אי-שלילי</strong> <span>\( X \)</span> ועבורו, לכל <span>\( a&gt;0 \)</span> , הוא נותן</p>

<p><span>\( P\left(X\ge a\right)=\frac{E\left[X\right]}{a} \)</span></p>

<p>עכשיו, אם <span>\( X \)</span> הוא משתנה מקרי <strong>כלשהו</strong>, לאו דווקא אי שלילי, אז בואו ניזכר ש-<span>\( \text{Var}\left(X\right) \)</span> הוגדרה בתור התוחלת של משתנה מקרי שהוא <strong>כן</strong> אי-שלילי: <span>\( \sigma^{2}=\text{Var}\left(X\right)=\text{E}\left[Z\right] \)</span> כאשר <span>\( Z=\left(X-\mu\right)^{2} \)</span>. על ה-<span>\( Z \)</span> הזה אני כן יכול להשתמש באי שוויון מרקוב; בואו נראה מה קורה אם אנחנו לוקחים <span>\( k&gt;0 \)</span> כלשהו ומשתמשים במרקוב עם <span>\( a=k^{2} \)</span>:</p>

<p><span>\( P\left(Z\ge a\right)\le\frac{\text{E}\left[Z\right]}{a} \)</span></p>

<p>כלומר</p>

<p><span>\( P\left(\left(X-\mu\right)^{2}\ge k^{2}\right)\le\frac{\text{E}\left[\left(X-\mu\right)^{2}\right]}{k^{2}}=\frac{\sigma^{2}}{k^{2}} \)</span></p>

<p>עכשיו, בואו נביט על <span>\( \left(X-\mu\right)^{2}\ge k^{2} \)</span>. הדבר הזה קורה אם ורק אם <span>\( \left|X-\mu\right|\ge k \)</span>, ולכן ההסתברות של שני אי השוויונים זהה, כלומר אני יכול לכתוב</p>

<p><span>\( P\left(\left|X-\mu\right|\ge k\right)\le\frac{\sigma^{2}}{k^{2}} \)</span></p>

<p>זה אי-שוויון צ’בישב. כמו עם אי-שוויון מרקוב, לפעמים קל יותר להבין מה הוא אומר אם “מכניסים את סטיית התקן אל אי השוויון”, כלומר אם אני מנסח אותו על ידי</p>

<p><span>\( P\left(\left|X-\mu\right|\ge k\sigma\right)\le\frac{1}{k^{2}} \)</span></p>

<p>אם למשל נציב <span>\( k=2 \)</span> נקבל את הטענה הבאה: לכל משתנה מקרי <span>\( X \)</span>, הסיכוי שהוא יקבל ערך שהמרחק שלו מהתוחלת של <span>\( X \)</span> הוא יותר משתי סטיות תקן הוא <span>\( \frac{1}{4}=25\% \)</span>. לי זה מרגיש כמו טענה כללית להפתיע, כי לא משנה בכלל כמה <span>\( X \)</span> מורכב ומתוחכם - מרגע שחישבנו את התוחלת ואת סטיית התקן שלו, אנחנו יודעים בדיוק מה האיזור שבו 75\% מהערכים ש-<span>\( X \)</span> נותן הולכים ליפול. יותר מכך - בגלל שבמכנה יש <span>\( k^{2} \)</span> ולא <span>\( k \)</span>, זה אומר לנו שהסיכוי של מישהו להיות במרחק של הרבה סטיות תקן צונח מהר - צונח באופן <strong>ריבוע</strong>. אם הסיכוי להיות במרחק 2 סטיות תקן היה 25\%, עבור 3 סטיות תקן הוא נופל אל <span>\( \frac{1}{9}=11.111\ldots\% \)</span>, ועבור 4 סטיות תקן הוא כבר <span>\( \frac{1}{16}=6.25\% \)</span> וכשנרצה להיות במרחק 10 סטיות תקן הסיכוי כבר יהיה <span>\( \frac{1}{100}=1\% \)</span>, וכן הלאה. ככל שסטיית התקן של <span>\( X \)</span> גדולה יותר כך האיזור שבו רוב הערכים שלו יכולים ליפול הוא רחב יותר, אבל אם נחלק את המרחב לאיזורים שהרוחב של כל אחד מהם הוא <span>\( \sigma \)</span>, נדע בדיוק מה ההסתברות של איבר ליפול בכל אחד מהאיזורים הללו. זו המחשה חזקה מאוד לכוח שיש לשני מספרים בודדים <span>\( \mu,\sigma \)</span> לתאר את <span>\( X \)</span>.</p>

<h2>חזרה אל ההתפלגות הנורמלית</h2>

<p>עכשיו כשהכרנו את המושגים של תוחלת ושונות/סטיית תקן אפשר לחזור סוף סוף אל ההתפלגות הנורמלית. הגדרתי אותה בעזרת פונקציית צפיפות ההסתברות <span>\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)</span>, ועכשיו אפשר לחזור למה שאמרתי בתחילת הפוסט אבל כשיש לנו את ההגדרות הרלוונטיות: ה-<span>\( \mu \)</span> וה-<span>\( \sigma \)</span> הללו הם בדיוק התוחלת וסטיית התקן של ההתפלגות הנורמלית ש-<span>\( \mu,\sigma \)</span> הם הפרמטרים שלה. כלומר, אנחנו מגדירים משתנה מקרי <span>\( N\left(\mu,\sigma\right) \)</span> על ידי פונקציית הצפיפות <span>\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)</span>, וכשנחשב את התוחלת וסטיית התקן שלו הנוסחאות יתנו לנו בדיוק <span>\( \mu,\sigma \)</span>, וזה בדיוק מה שאני רוצה להראות עכשיו. דבר אחד שכדאי לשים אליו לב לפני כן הוא שאפשר להגדיר את ההתפלגות הנורמלית גם בלי להגדיר בכלל סטיית תקן: הרי <span>\( \frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}=\frac{1}{\sqrt{2\pi\sigma^{2}}}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)</span> ולכן אם היינו למשל בוחרים לסמן את השונות שאנחנו רוצים ב-<span>\( \tau \)</span> אז היינו מקבלים שהתפלגות נורמלית עם תוחלת <span>\( \mu \)</span> ושונות <span>\( \tau \)</span> מתוארת על ידי <span>\( f\left(x\right)=\frac{1}{\sqrt{2\pi\tau}}e^{-\left(x-\mu\right)^{2}/2\tau} \)</span>. הבחירה להשתמש ב-<span>\( \sigma \)</span> היא עניין של קונבנציה (ומן העבר השני, אנשים גם כותבים לפעמים <span>\( \frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2} \)</span> כדי שהנוסחה תכלול רק את <span>\( \sigma \)</span> ולא את <span>\( \sigma^{2} \)</span>).</p>

<p>ראשית, הנה טריק מועיל כדי למצוא תוחלת ושונות של דברים. כזכור, ראינו</p>

<p><span>\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)</span></p>

<p><span>\( \text{Var}\left(\alpha X+\beta\right)=\alpha^{2}\text{Var}\left(X\right) \)</span></p>

<p>אז באופן כללי, אם אנחנו רוצים למצוא תוחלת ושונות של משתנה <span>\( X \)</span> אבל זה קשה לנו, אפשר לנסות להגדיר משתנה “מנורמל” <span>\( Z=\frac{X-\mu}{\sigma} \)</span> ולקבל</p>

<p><span>\( \text{E}\left[X\right]=\sigma\text{E}\left[Z\right]+\mu \)</span></p>

<p><span>\( \text{Var}\left(X\right)=\sigma^{2}\text{Var}\left(Z\right) \)</span></p>

<p>אני אשתמש בזה במקרה שלנו. נניח ש-<span>\( X \)</span> הוא משתנה מקרי שמתפלג נורמלית עם פרמטרים <span>\( \mu,\sigma \)</span>, כלומר <span>\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2} \)</span>. אם אני מגדיר את המשתנה החדש <span>\( Z=\frac{X-\mu}{\sigma} \)</span> אני אקבל פונקציית צפיפות הסתברות <span>\( f\left(z\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)</span>. כדי לראות את זה נשים לב לכך ש:</p>

<p><span>\( P\left(a\le Z\le b\right)=P\left(\sigma a+\mu\le X\le\sigma b+\mu\right)=\int_{\sigma a+\mu}^{\sigma b+\mu}\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2}dx \)</span></p>

<p>ועל האינטגרל הזה אפשר לבצע את החלפת המשתנים <span>\( z=\frac{x-\mu}{\sigma} \)</span> שנותנת לנו <span>\( dz=\frac{dx}{\sigma} \)</span>, כלומר מקבלים <span>\( P\left(a\le Z\le b\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)</span>.</p>

<p>המסקנה? אם <span>\( X \)</span> התפלג נורמלית עם פרמטרים <span>\( \mu,\sigma \)</span> אז <span>\( Z=\frac{X-\mu}{\sigma} \)</span> מתפלג נורמלית עם פרמטרים <span>\( 0,1 \)</span>. עכשיו אני אוכיח ש-<span>\( \text{E}\left[Z\right]=0 \)</span> וש-<span>\( \text{Var}\left(Z\right)=1 \)</span> ואז אסיק ש-</p>

<p><span>\( \text{E}\left[X\right]=\sigma\text{E}\left[Z\right]+\mu=\mu \)</span></p>

<p><span>\( \text{Var}\left(X\right)=\sigma^{2}\text{Var}\left(Z\right)=\sigma^{2} \)</span></p>

<p>וזו הטענה הכללית שאני רוצה.</p>

<p>עכשיו, <span>\( \text{E}\left[Z\right] \)</span> זה קל - זה יוצא 0 בגלל שפונקציית הצפיפות <span>\( \frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)</span> היא סימטרית ביחס ל-0 כי <span>\( z^{2} \)</span> היא פונקציה סימטרית ביחס ל-0. זה הופך את האינטגרל שמחשבים עבור התוחלת לאינטגרל של פונקציה <strong>אנטיסימטרית</strong> בגלל ההכפלה ב-<span>\( z \)</span>. הנה משהו פורמלי קצת יותר:</p>

<p><span>\( \text{E}\left[Z\right]=\int_{-\infty}^{\infty}z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2}=\lim_{a\to\infty}\int_{-a}^{a}z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2}= \)</span></p>

<p><span>\( =\frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}\left.e^{-z^{2}/2}\right|_{-a}^{a}=\frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}\left(e^{-a^{2}/2}-e^{-a^{2}/2}\right)= \)</span></p>

<p><span>\( \frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}0=0 \)</span></p>

<p>המעבר מאינטגרל אינסופי בשני הכיוונים לגבול כש-<span>\( a \)</span> שואף לאינסוף של אינטגרל מ-<span>\( -a \)</span> אל <span>\( a \)</span> הוא <strong>לא תקין</strong> באופן כללי אבל בפוסט הקודם כבר אמרנו שבמקרה הנוכחי זה תקין (אבל אפשר להסתדר גם אם עושים שני אינטגרלים, זה פשוט יוצא מסורבל יותר). אז זה מסיים עם התוחלת ומראה שכדי לחשב את השונות צריך פשוט לחשב את <span>\( \text{E}\left[Z^{2}\right] \)</span>. זה יהיה טיפה יותר מסובך ויצריך טריק אינטגרציה סטנדרטי: <strong>אינטגרציה בחלקים</strong>. בואו ניזכר את הטריק הזה הולך.</p>

<p>עבור נגזרות, אחת מהנוסחאות החשובות ביותר היא מה יוצאת הגזירה של מכפלה של פונקציות: <span>\( \left(uv\right)^{\prime}=u^{\prime}v+uv^{\prime} \)</span>. זו אחת מהנוסחאות הבודדות שצרובות בי עוד מהתיכון. עכשיו, אם מעבירים אגפים, מקבלים מן הסתם <span>\( u^{\prime}v=\left(uv\right)^{\prime}-uv^{\prime} \)</span> ואם (ועכשיו אני עובר לקצת נפנוף ידיים) לוקחים אינטגרל לשני האגפים מקבלים <span>\( \int u^{\prime}v=uv-\int uv^{\prime} \)</span>. לכן אם קשה לנו לבצע אינטגרציה לפונקציה שלנו, אנחנו בודקים אם יש דרך נוחה לפרק אותה למכפלה של שתי פונקציות שלאחת מהן (שאנחנו קוראים לה <span>\( u^{\prime} \)</span>) כן קל לנו להוציא אינטגרל, את השניה (שאנחנו קוראים לה <span>\( v \)</span>) קל לנו לגזור, ואז אנחנו מקווים שאחרי שנוציא אינטגרל לאחת ונגזרת לשניה, המכפלה של <strong>זה</strong> תהיה משהו שקל לנו למצוא לו אינטגרל. לפעמים זה נכשל קטסטרופלית ולפעמים, כמו עכשיו, זה עובד יופי. הרי</p>

<p><span>\( \text{E}\left[Z^{2}\right]=\int_{-\infty}^{\infty}z^{2}\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)</span></p>

<p>ולפני רגע, בחישוב התוחלת, ראינו שקל לנו להוציא את האינטגרל של <span>\( u^{\prime}=z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)</span> והאינטגרל יוצא <span>\( u=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)</span>, וכמובן שאת <span>\( v=z \)</span> קל לגזור ולקבל <span>\( v^{\prime}=1 \)</span>. כמו כן <span>\( uv \)</span> הולך לצאת בדיוק הביטוי לתוחלת שראינו לפני רגע שהאינטגרל שלו הוא 0, ו-<span>\( uv^{\prime} \)</span> הולך לצאת בדיוק פונקציית הצפיפות המקורית שראינו כבר (בפוסט הקודם, ולא בקלות) שהאינטגרל שלה יוצא 1. זה מסיים (בנפנוף ידיים) את ההוכחה.</p>

<p>אז אם לסכם עוד סיכום ביניים: אנחנו מנסים להבין למה פונקציית הצפיפות של ההתפלגות הנורמלית נראית ככה: <span>\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)</span>. בינתיים הבנו ש-<span>\( \pi \)</span> שם בתור קבוע נרמול שמגיע בבסיסו מכך ש-<span>\( 2\pi \)</span> הוא היקף מעגל היחידה; ואנחנו רואים עכשיו ש-<span>\( \mu,\sigma \)</span> שמופיעים פה מבטיחים שהתוחלת וסטיית התקן של ההתפלגות יהיו <span>\( \mu,\sigma \)</span>; אבל עדיין לא ברור לנו הדבר העיקרי - מה הקטע עם ה-<span>\( e \)</span> הזה? למה הצורה של העקומה היא (עד כדי קבועים) <span>\( e^{-x^{2}} \)</span>? אני לא רואה איך לענות לשאלה הזו בלי להגיע אל היעד שלנו: <strong>משפט הגבול המרכזי</strong>. את זה נעשה בפוסט הבא.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2025/02/03/normal_distribution_2/">&laquo; מה הקטע עם התפלגות נורמלית? (חלק ב': על שתי הסתברויות)</a>
    
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2025/02/05/normal_distribution_3/';
      this.page.identifier = 'http://gadial.net/2025/02/05/normal_distribution_3/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2025/02/05/normal_distribution_3/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script>

<!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
