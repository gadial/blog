<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>חידת אוילר - הפתרון - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Hamburger menu button */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.8em;
            color: white;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .menu-toggle:hover {
            opacity: 0.8;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .top-nav .nav-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .top-nav .site-title {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0;
                padding: 10px 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            /* Hide nav links by default on mobile */
            .top-nav .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                margin-top: 10px;
            }
            
            /* Show when expanded */
            .top-nav .nav-links.expanded {
                display: flex;
            }
            
            .top-nav .nav-links > a {
                text-align: center;
                padding: 12px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box {
                width: 100%;
                flex-direction: column;
                margin-top: 10px;
                padding-top: 10px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box input {
                width: 100%;
                margin-bottom: 5px;
                min-width: 0;
            }
            
            .top-nav .search-box button {
                width: 100%;
            }
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        /* Force KaTeX content to wrap by overriding its internal structure */
        .katex-html {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .base {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .mord,
        .katex .mbin,
        .katex .mrel,
        .katex .mopen,
        .katex .mclose,
        .katex .mpunct,
        .katex .minner {
            display: inline !important;
            white-space: normal !important;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
            
            /* Hide post navigation on mobile */
            .post-navigation {
                display: none;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <div class="site-title">
                <a href="/" style="color: white; text-decoration: none;">לא מדויק</a>
                <button class="menu-toggle" onclick="toggleMobileMenu()" aria-label="תפריט">
                    ☰
                </button>
            </div>
            <div class="nav-links" id="navLinks">
                <a href="/">דף הבית</a>
                <a href="/random.html">פוסט אקראי</a>
                <a href="/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/2008/10/01/euler_project_riddle/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">חידת אוילר</span>
            </a>
            

            
            <a href="/2008/10/14/probability_paradox/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">מסתבר שלא</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>חידת אוילר - הפתרון</h1>
            <div class="post-meta">
                <span class="date">2008-10-04</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/משחקים וחידות מתמטיות.html">משחקים וחידות מתמטיות</a>
                    
                    <a href="/categories/תורת המספרים.html">תורת המספרים</a>
                    
                </span>
                
                
            </div>
        </header>
        
        <article>
            <p>מכיוון ש<a href="http://www.gadial.net/2008/10/01/euler_project_riddle/">החידה שהצגתי בפוסט הקודם</a> עוסקת ב<a href="http://he.wikipedia.org/wiki/%D7%A4%D7%95%D7%A0%D7%A7%D7%A6%D7%99%D7%99%D7%AA_%D7%90%D7%95%D7%99%D7%9C%D7%A8">פונקצית אוילר</a>, כדאי להבין את הפונקציה יותר טוב על מנת שניתן יהיה להבין את הפתרון. כפי שכתבתי שם, הפונקציה מחזירה לכל מספר טבעי את מספרם של המספרים הטבעיים הקטנים ממנו וזרים לו, כלומר שאין מספר גדול מ-1 שמחלק את שניהם גם יחד. למשל, עבור 8 הפונקציה תחזיר 4, בשל המספרים 1,3,5,7 (שימו לב - 6 אמנם אינו מחלק את 8 אך גם אינו זר לו, שכן 2 מחלק את שניהם). חישוב של הפונקציה על בסיס ההגדרה הזו בלבד יהיה לא יעיל במיוחד - לעבור על כל המספרים שקטנים מ-<span class="math">\(n\)</span>, לבדוק לכל אחד אם הוא זר ל-<span class="math">\(n\)</span> (בעזרת <a href="http://he.wikipedia.org/wiki/%D7%94%D7%90%D7%9C%D7%92%D7%95%D7%A8%D7%99%D7%AA%D7%9D_%D7%94%D7%90%D7%95%D7%A7%D7%9C%D7%99%D7%93%D7%99">האלגוריתם האוקלידי</a> למציאת המחלק המשותף המקסימלי - אלגוריתם שבפני עצמו הוא יעיל למדי), ואם כן - להוסיף אותו לסכום. זה לא פתרון טוב במיוחד, כי זמן הריצה הוא פרופורציוני לגודל המספר, מה שנחשב איטי למדי (אלגוריתמים יעילים על מספרים הם כאלו שזמן הריצה שלהם הוא <a href="http://en.wikipedia.org/wiki/Polylogarithmic">פולינום בלוגריתם של המספר</a>, או בצורה פשוטה יותר - פולינומי במספר הספרות שלו).</p>
<p>לכן אנו מחפשים נוסחה יותר פשוטה לפונקצית אוילר, מתוך תקווה שהיא תפשט את החידה. קיימת נוסחה שכזו ואציג אותה בפוסט הזה; את החידה שהצגתי קודם היא תהפוך לטריוויאלית, ואדגים גם כיצד ניתן להשתמש בה כדי לחשב את הערכים של פונקצית אוילר, כשצריך לחשב אותה לתחום גדול של מספרים רציפים, בצורה יותר יעילה מהצורה הנאיבית שלעיל. לרוע המזל, כפי שיתבהר בהמשך, הנוסחה עדיין לא הופכת את החישוב של נוסחת אוילר ליעיל; הקושי של החישוב שלה יתגלה כקשור בצורה הדוקה לקושי של פירוק מספרים לגורמים (בפרט, <a href="http://www.gadial.net/2007/11/21/public_key_cryptography/">שיטת ההצפנה RSA</a> מתבססת <a href="http://www.gadial.net/2007/11/27/rsa_math/">בצורה חזקה מאוד</a> על כך שקשה לחשב את פונקצית אוילר למספרים מסויימים בלי ידע על הפירוק לגורמים שלהם).</p>
<p>את הנוסחה אפשר להסיק באמצעות שתי תכונות פשוטות של הפונקציה:</p>
<ol>
    <li>אם <span class="math">\(a,b\)</span> זרים, אז <span class="math">\(\varphi(ab)=\varphi(a)\cdot\varphi(b)\)</span>. כלומר, פונקצית אוילר של מכפלת שני מספרים זרים, שווה למכפלות פונקצית אוילר שלהם.</li>
    <li>אם <span class="math">\(p\)</span> הוא ראשוני, אז <span class="math">\(\varphi(p^k)=p^k-p^{k-1}\)</span></li>
</ol>
<p>בעזרת שתי התכונות הללו קל לתת נוסחה עבור פונקצית אוילר לכל מספר, שכן כל מספר ניתן להציג בתור מכפלה של חזקות של ראשוניים (זה נקרא "המשפט היסודי של האריתמטיקה") ויש רק הצגה אחת כזו, וכל שתי חזקות של ראשוניים שונים זרות זו לזו (כי חזקה של ראשוני מתחלקת אך ורק באותו ראשוני ובחזקות שלו, לא בראשוניים אחרים).</p>
<p>כלומר, אם <span class="math">\(n=p_1^{k_1}\cdots p_t^{k_t}\)</span> אז</p>
<p><span class="math">\(\varphi\left(n\right)=\varphi\left(p_{1}^{k_{1}}\cdots p_{t}^{k_{t}}\right)=\varphi\left(p_{1}^{k_{1}}\right)\cdots\varphi\left(p_{t}^{k_{t}}\right)=\left(p_{1}^{k_{1}}-p_{1}^{k_{1}-1}\right)\cdots\left(p_{t}^{k_{t}}-p_{t}^{k_{t}-1}\right)\)</span></p>
<p>זה בפני עצמו לא נראה מרשים כל כך, אבל הנה טוויסט קטן שעושה את הכל הרבה יותר נחמד. אפשר לכתוב את <span class="math">\(p^k-p^{k-1}\)</span> גם בצורה שונה, אם מחלקים את שני האיברים ב-<span class="math">\(p^k\)</span>. מקבלים: <span class="math">\(p^k(1-\frac{1}{p})\)</span>.</p>
<p>"יופי", אתם אומרים, "אז עכשיו גם הכנסת שברים לעניין. ממש פשוט." אבל שימו לב מה קורה כשמכניסים את הטוויסט הזה לנוסחה:</p>
<p><span class="math">\(\varphi\left(n\right)=\left(p_{1}^{k_{1}}-p_{1}^{k_{1}-1}\right)\cdots\left(p_{t}^{k_{t}}-p_{t}^{k_{t}-1}\right)=p_{1}^{k_{1}}\cdots p_{t}^{k_{t}}\left(1-\frac{1}{p_{1}}\right)\cdots\left(1-\frac{1}{p_{t}}\right)=n\cdot\left(1-\frac{1}{p_{1}}\right)\cdots\left(1-\frac{1}{p_{t}}\right)\)</span></p>
<p>אם נשתמש בקיצור הסטנדרטי במתמטיקה לתיאור כפל בהרבה איברים, סימן גדול של האות פאי, אפשר לכתוב את כל העסק ככה:</p>
<p><span class="math">\(\varphi\left(n\right)=n\cdot\prod_{p|n}\left(1-\frac{1}{p}\right)\)</span></p>
<p>במילים: פונקצית אוילר של מספר שווה ל<strong>עצמו</strong> כפול "תיקון" כלשהו, שנבנה מתוך הראשוניים שמחלקים אותו. אחד הדברים היפים כאן הוא שהחזקה שבה הראשוניים מופיעים בפירוק של המספר לגורמים איננה חשובה; צריך רק לדעת מי הראשוניים שמחלקים את המספר, ולא "כמה פעמים" הם מחלקים. כל ראשוני שמחלק את המספר מופיע בנוסחה פעם אחת בלבד.</p>
<p>כדאי לשים לב שה"תיקון" תמיד יהיה מספר רציונלי קטן מ-1, שכן הוא מכפלה של איברים מהצורה "אחד פחות משהו", כשהמשהו הוא קטן יותר ככל שהראשוני שיוצר את האיבר גדול יותר. מכאן גם מגיעים בזריזות לפתרון החידה מהפוסט הקודם. מהו היחס <span class="math">\(\frac{n}{\varphi(n)}\)</span>? אם משתמשים בנוסחה, רואים שהוא <span class="math">\(\frac{1}{\prod_{p|n}\left(1-\frac{1}{p}\right)}\)</span>. אנחנו רוצים לדעת מתי הערך הזה הוא מקסימלי, כלומר מתי <span class="math">\(\prod_{p|n}\left(1-\frac{1}{p}\right)\)</span> הוא מינימלי.</p>
<p>ה"מינימליות" היא די בעייתית כאן. הרי אם ניקח קבוצה של ראשוניים ונכניס אותם למכפלה הזו, התוצאה שנקבל אף פעם לא תהיה מינימלית כי תמיד ניתן יהיה לכפול אותה בעוד גורם שהתקבל מראשוני שלא היה בקבוצה (הרי יש אינסוף ראשוניים) ולקבל משהו שהוא עוד טיפ-טיפה יותר קטן. לכן נדרשת הגבלה על גודל <span class="math">\(n\)</span>. בחידה הגבילו אותו שרירותית למיליון, אבל העיקר פה הוא העיקרון. אם כן, איך נבנה את המספר שערכו הוא מינימלי?</p>
<p>ראשית, ברור שבפירוק לגורמים של המספר, כל ראשוני צריך להופיע פעם אחת (כלומר, המעריך שלו בחזקה יהיה 1; לכן מספר כמו 9 או 18 הוא פסול מראש כי 3 מופיע בפירוק שלו בחזקת 2). למה? כי זו חזקה "מבוזבזת"; היא לא מקטינה עוד יותר את המכפלה, כי הראשוני כבר מופיע בה; לכן, בהינתן מספר שעבורו היחס הוא כך וכך ויש לו ראשוני עם חזקה גבוהה מ-1 בפירוק לגורמים, אפשר להחליף אותו במספר אחר, שבו החזקה של אותו ראשוני היא 1, ונותן בדיוק את אותו היחס. נסו כמה דוגמאות - למשל, 18 חלקי פונקצית אוילר של 18 ייתן בדיוק אותה תוצאה כמו 6 חלקי פונקצית אוילר של 6: 3 בשני המקרים.</p>
<p>אם כן, המספר שלנו יהיה מכפלה של ראשוניים שונים זה מזה. אילו ראשוניים נבחר? הדעת נותנת שאת הקטנים ביותר שרק אפשר, שכן ככל שהראשוני גדול יותר, כך <span class="math">\(1-\frac{1}{p}\)</span> גדול יותר, ואנחנו רוצים שיהיה דווקא קטן. מכאן שהמספר שלנו הוא בהכרח המספר הגדול ביותר שקטן ממיליון ומהווה מכפלה של ראשוניים עוקבים, החל מ-2. לחשב את זה במספרים גבוהים זה כאב ראש, אבל במספרים נמוכים זה לא נורא. אפשר לגלות די בקלות, על ידי בדיקה ממצה אפילו, שהראשוניים הראשונים הם 2,3,5,7,11,13,17; חישוב קצר (לא כיפי בכלל, אבל ניתן לביצוע אפילו עם נייר ועיפרון) יראה כי מכפלתם היא 510,510; ואם נכפול את העסק הזה בראשוני הבא בתור, 19, נקבל מפלצת שעוברת את מיליון בקלות. לכן 510510 הוא המספר המבוקש - זהו פתרון החידה.</p>
<p>הבטחתי שהנוסחה תסייע לנו גם בחישוב פונקצית אוילר עבור תחומים רציפים גדולים. הרעיון הוא להשתמש באלגוריתם דומה ל<a href="http://he.wikipedia.org/wiki/%D7%94%D7%A0%D7%A4%D7%94_%D7%A9%D7%9C_%D7%90%D7%A8%D7%98%D7%95%D7%A1%D7%AA%D7%A0%D7%A1">כברה של ארטוסתנס</a>: בונים מערך גדול מאוד של כל המספרים מ-2 ועד למקסימום שעבורו אנחנו רוצים לחשב, כשבתא ה-<span class="math">\(n\)</span> שמים את הערך <span class="math">\(n\)</span>. כעת מתחילים לעבור על כל הראשוניים שבתחום שלנו (איך מוצאים אותם? זה כבר סיפור אחר ויסופר בפעם אחרת, אבל זה לא קשה עד כדי כך). לכל ראשוני <span class="math">\(p\)</span>, מתחילים לעבור על כל התאים שמספרם הוא כפולה של <span class="math">\(p\)</span>, וכופלים כל אחד מהם ב"תיקון" שנובע ממנו: <span class="math">\(1-\frac{1}{p}\)</span>. זה כל מה שצריך לעשות כדי להבטיח שבסיום האלגוריתם, בכל תא תהיה התוצאה הנכונה (מדוע?). בהתחלה זה ייקח זמן רב (עבור 2 "נתקן" חצי מהתאים שלו) אבל מהר מאוד מגיעים לראשוניים גדולים, והעסק יתחיל לרוץ. נסו לתכנת את השיטה הזו ואת השיטה הנאיבית (לעבור תא-תא ולכל תא בנפרד לחשב את פונקצית אוילר) ותיווכחו במהירות שמבחינה פרקטית, השיטה הראשונה עדיפה פי כמה וכמה (מבחינה תיאורטית, היא עדיין אינה מעשית כשמגיעים לערכים גדולים מדי).</p>
<p>נותר לי רק להסביר איך מוכיחים את שתי התכונות של פונקצית אוילר שעליהן התבססתי בבניית הנוסחה. נתחיל דווקא מהשנייה:  <span class="math">\(\varphi(p^k)=p^k-p^{k-1}\)</span>. הוכחת הנוסחה הזו מתבססת על קומבינטוריקה פשוטה. אנו רוצים לדעת כמה מספרים זרים ל-<span class="math">\(p^k\)</span> יש בתחום <span class="math">\(1,\dots\,p^k\)</span>. התחום כולו מכיל <span class="math">\(p^k\)</span> מספרים, ולכן טכניקת ספירה הגיונית היא לספור כמה מספרים בתחום דווקא <strong>לא</strong> זרים ל-<span class="math">\(p^k\)</span> ולחסר מסך כל המספרים שבתחום. אם כן, כל מה שנשאר לנו להראות הוא שיש בתחום הזה <span class="math">\(p^{k-1}\)</span> מספרים שאינם זרים ל-<span class="math">\(p^k\)</span>.</p>
<p>כאן אנחנו נעזרים בכך ש-<span class="math">\(p\)</span> הוא ראשוני, ולכן המספרים היחידים שמחלקים את <span class="math">\(p^k\)</span> יהיו חזקות של <span class="math">\(p\)</span> עצמו (הטענה הזו אולי נשמעת אינטואיטיבית אבל לא טריוויאלי לגמרי להוכיח אותה - נסו, ושימו לב לאיזה משפט אתם מזדקקים). מכאן שאם יש מספר שאינו זר ל-<span class="math">\(p^k\)</span> (דהיינו, יש לו מחלק משותף עם <span class="math">\(p^k\)</span> שגדול מ-1), אז בפרט הוא מתחלק ב-<span class="math">\(p\)</span>. ברור שגם ההפך נכון - שכל מספר שמתחלק ב-<span class="math">\(p\)</span> אינו זרק ל-<span class="math">\(p^k\)</span>. לכן יש לנו <strong>התאמה חד חד ערכית ועל</strong> בין "קבוצת המספרים שמתחלקים ב-<span class="math">\(p\)</span> בתחום <span class="math">\(1,\dots\,p^k\)</span>" ובין "קבוצת המספרים שאינם זרים ל-<span class="math">\(p^k\)</span> באותו התחום". זו התאמה פשוטה במיוחד - כל איבר מותאם לעצמו - אבל היא אומרת הרבה - שמספיק לנו לספור כמה איברים שמתחלקים ב-<span class="math">\(p\)</span> יש בתחום הזה.</p>
<p>גם את הספירה הזו קל לבצע עם התאמה חח"ע ועל - במקרה הזה, בין התחום <span class="math">\(1,\dots,p^{k-1}\)</span> <strong>כולו</strong> ובין המספרים שמתחלקים ב-<span class="math">\(p\)</span> בתחום הגדול. ההתאמה פשוטה: בהינתן איבר מתוך <span class="math">\(1,\dots,p^{k-1}\)</span> נכפול אותו ב-<span class="math">\(p\)</span>, ונקבל איבר ששייך לתחום הגדול ומתחלק ב-<span class="math">\(p\)</span>. קל להראות שההתאמה היא חד חד ערכית - אם כפלנו שני מספרים ב-<span class="math">\(p\)</span> והגענו לאותה תוצאה, אלו היו אותם מספרים; זה צמצום פשוט. קל גם להראות שההתאמה היא על, שכן אם יש לנו מספר בתחום הגדול שמתחלק ב-<span class="math">\(p\)</span>, פשוט נחלק אותו ב-<span class="math">\(p\)</span> ובהכרח נקבל איבר בתחום הקטן - כלומר מקור של האיבר בתחום הגדול.</p>
<p>אם כן, גודל התחום <span class="math">\(1,\dots,p^{k-1}\)</span> הוא כגודל קבוצת המספרים בתחום הגדול שמתחלקים ב-<span class="math">\(p\)</span>, ולכן יש בדיוק <span class="math">\(p^{k-1}\)</span> מספרים כאלו וגמרנו.</p>
<p>טענת הכפליות היא מורכבת קצת יותר. בהינתן <span class="math">\(n,m\)</span> זרים, אנחנו רוצים להראות שלכל זוג מספרים <span class="math">\(a,b\)</span> כך ש-<span class="math">\(a\)</span> זר ל-<span class="math">\(n\)</span> וקטן ממנו, ו-<span class="math">\(b\)</span> זר ל-<span class="math">\(m\)</span> וקטן ממנו, ניתן להתאים בצורה חד חד ערכית ועל מספר שזר למכפלה <span class="math">\(nm\)</span> וקטן ממנה. טבעי לחשוב שהמספר הזה יהיה <span class="math">\(ab\)</span>; אלא שהעתקה כזו אינה חד חד ערכית. למשל, אם <span class="math">\(n=5\)</span> ואילו <span class="math">\(m=7\)</span>, אז נקבל את המספר 2 גם עבור <span class="math">\(a=2,b=1\)</span> וגם עבור <span class="math">\(a=1,b=2\)</span>. יש מספרים אחרים שזרים למכפלה 35, כמו למשל 31, שאין סיכוי לקבל כמכפלה (הרי 31 הוא ראשוני). צריך אם כן התחכמות נוספת כאן. ההתחכמות מתבססת על משפט חשוב בתורת המספרים האלמנטרית - "<a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A9%D7%A4%D7%98_%D7%94%D7%A9%D7%90%D7%A8%D7%99%D7%95%D7%AA_%D7%94%D7%A1%D7%99%D7%A0%D7%99">משפט השאריות הסיני</a>". אציג כאן גרסה פשוטה מאוד של המשפט, שהיא כל מה שצריך; אולי בהמשך אתאר את הגרסאות הכלליות יותר.</p>
<p>בגרסה הפשוטה, המשפט אומר כך: בהינתן <span class="math">\(n,m\)</span> זרים זה לזה (הכרחי שהם יהיו זרים), ובהינתן <span class="math">\(a,b\)</span> קטנים מהם בהתאמה, ניתן למצוא <span class="math">\(x\)</span> בין 1 והמכפלה <span class="math">\(nm\)</span>, כך שהשארית שהוא מותיר כאשר מחלקים אותו ב-<span class="math">\(n\)</span> היא <span class="math">\(a\)</span>, והשארית שהוא מותיר כאשר מחלקים אותו ב-<span class="math">\(m\)</span> היא <span class="math">\(b\)</span>, והמספר הזה הוא יחיד (אין עוד מספר בתחום הזה שמקיים את אותה תכונה). המספר הזה יהיה בדיוק מה שאנחנו רוצים להתאים לכל זוג. כדי שזה יסיים את ההוכחה רק צריך להיווכח בכך שאם <span class="math">\(x\)</span> הוא מספר בתחום <span class="math">\(1,\dots,nm\)</span> שמקיים את תכונת השאריות הזו עבור <span class="math">\(a,b\)</span> שזרים ל-<span class="math">\(n,m\)</span>, אז הוא עצמו זר ל-<span class="math">\(nm\)</span>, וההפך - אם הוא זר, גם השאריות זרות.</p>
<p>בואו נבין לרגע מה פירוש "השארית של חלוקת <span class="math">\(x\)</span> ב-<span class="math">\(n\)</span> היא <span class="math">\(a\)</span>"; זה אומר שקיים <span class="math">\(q\)</span> כך שמתקיים <span class="math">\(x=qn+a\)</span>. במילים אחרות, <span class="math">\(x-qn=a\)</span>, ולכן אם יש מספר גדול מ-1 שמחלק גם את <span class="math">\(x\)</span> וגם את <span class="math">\(n\)</span>, אז בפרט הוא מחלק את שני המספרים באגף שמאל ולכן גם את הפרשם, ולכן הוא מחלק את אגף שמאל כולו, ולכן גם את אגף ימין, ולכן גם את <span class="math">\(a\)</span>. כלומר: אם <span class="math">\(x\)</span> לא זר ל-<span class="math">\(n\)</span>, גם <span class="math">\(a\)</span> לא זר ל-<span class="math">\(n\)</span>, וההפך - אם <span class="math">\(a\)</span> לא זר ל-<span class="math">\(n\)</span> אז כבר מהמשוואה  <span class="math">\(x=qn+a\)</span> מקבלים שגם <span class="math">\(x\)</span> לא זר ל-<span class="math">\(n\)</span>. כלומר, הוכחנו בדיוק את מה שרצינו.</p>
<p>ההסבר הזה אינו קל להבנה, כמובן; הרבה יותר טבעי להבין אותו כשמדברים בשפת החבורות, ומשפט השאריות הסיני בא לידי ביטוי כטענת איזומורפיזם של חבורות מסויימות. כאמור, אולי אעסוק בכך בעתיד - לעת עתה מה שהיה חשוב לי הוא התוצאה - הנוסחה היפה עבור פונקצית אוילר.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('expanded');
        }
        
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>