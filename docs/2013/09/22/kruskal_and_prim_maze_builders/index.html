<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>קרוסקל את פרים - בוני מבוכים בע&#34;מ - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <meta name="description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://gadial.net/2013/09/22/kruskal_and_prim_maze_builders/">
    <meta property="og:title" content="קרוסקל את פרים - בוני מבוכים בע&#34;מ">
    <meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב">
    <meta property="og:site_name" content="לא מדויק">
    <meta property="og:image" content="http://gadial.net/img/main/default-card.png" />
        
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://gadial.net/2013/09/22/kruskal_and_prim_maze_builders/">
    <meta name="twitter:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב">
    <meta name="twitter:site" content="@" />
    <meta property="twitter:title" content="קרוסקל את פרים - בוני מבוכים בע&#34;מ">
    <meta property="twitter:image" content="http://gadial.net/img/main/default-card.png" />
    
    <!-- RSS Feed -->
    <link rel="alternate" type="application/rss+xml" title="לא מדויק - RSS Feed" href="/feed.xml">
       
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Hamburger menu button */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.8em;
            color: white;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .menu-toggle:hover {
            opacity: 0.8;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .top-nav .nav-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .top-nav .site-title {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0;
                padding: 10px 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            /* Hide nav links by default on mobile */
            .top-nav .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                margin-top: 10px;
            }
            
            /* Show when expanded */
            .top-nav .nav-links.expanded {
                display: flex;
            }
            
            .top-nav .nav-links > a {
                text-align: center;
                padding: 12px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box {
                width: 100%;
                flex-direction: column;
                margin-top: 10px;
                padding-top: 10px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box input {
                width: 100%;
                margin-bottom: 5px;
                min-width: 0;
            }
            
            .top-nav .search-box button {
                width: 100%;
            }
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        /* Force KaTeX content to wrap by overriding its internal structure */
        .katex-html {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .base {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .mord,
        .katex .mbin,
        .katex .mrel,
        .katex .mopen,
        .katex .mclose,
        .katex .mpunct,
        .katex .minner {
            display: inline !important;
            white-space: normal !important;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
            
            /* Hide post navigation on mobile */
            .post-navigation {
                display: none;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <div class="site-title">
                <a href="/" style="color: white; text-decoration: none;">לא מדויק</a>
                <button class="menu-toggle" onclick="toggleMobileMenu()" aria-label="תפריט">
                    ☰
                </button>
            </div>
            <div class="nav-links" id="navLinks">
                <a href="/">דף הבית</a>
                <a href="/random.html">פוסט אקראי</a>
                <a href="/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/2013/09/14/mobius_transformation_and_riemann_sphere/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">העתקות מביוס והספירה של רימן</span>
            </a>
            

            
            <a href="/2013/09/30/graphs_spanning_trees_and_code/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">על גרפים, עצים פורשים ואיך זה נראה בקוד</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>קרוסקל את פרים - בוני מבוכים בע&#34;מ</h1>
            <div class="post-meta">
                <span class="date">2013-09-22</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/מבני נתונים ואלגוריתמים.html">מבני נתונים ואלגוריתמים</a>
                    
                    <a href="/categories/משחקים וחידות מתמטיות.html">משחקים וחידות מתמטיות</a>
                    
                    <a href="/categories/תכנות.html">תכנות</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/אלגוריתמים.html">אלגוריתמים</a>
                    
                    <a href="/tags/האלגוריתם של פרים.html">האלגוריתם של פרים</a>
                    
                    <a href="/tags/האלגוריתם של קרוסקל.html">האלגוריתם של קרוסקל</a>
                    
                    <a href="/tags/מבוכים.html">מבוכים</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <p>נתחיל מהשורה התחתונה - בפוסט הזה אני רוצה להסביר איך אפשר לכתוב תוכנית מחשב שמייצרת מבוכים כמו זה:</p>
<p><a href="/img/2013/09/maze.png"><img src="/img/2013/09/maze.png" alt="maze" width="472" height="472" class="alignnone size-full wp-image-2865" /></a></p>
<p>אבל כרגיל, יש לי גם מטרה נסתרת זדונית; אני רוצה להשתמש במבוכים כתירוץ כדי להציג שלל אלגוריתמים בסיסיים בתורת הגרפים, יחד עם מימוש שלהם, ודיון על סיבוכיות זמן ריצה ומבני נתונים ועוד שלל דברים נפלאים. כך שהמבוכים הם רק תירוץ, ואני מצהיר מראש שאני הולך לעשות דברים בדרך שעשויה להיראות טיפה מסובכת שלא לצורך (ובחלק מהמקרים היא תהיה בכוונה מסובכת שלא לצורך) כך שאני מבקש שתהיו סבלניים איתי.</p>
<p>ראשית כל, מה מאפיין מבוך כמו זה שבתמונה? המיוחד בו הוא שאפשר להגיע מהכניסה שלו (בפינה הימנית-תחתונה שלו) לכל מקום אחר במבוך, והמסלול מהכניסה אל כל נקודה אחרת במבוך הוא <strong>יחיד</strong>. אפשר לתת בתור אתגר הגעה לפינה השמאלית-עליונה של המבוך; אתם מוזמנים לקחת רגע ולשחק במבוך עם סמן העכבר (עוד אין גרסה אינטראקטיבית, אבל אולי נעשה כזו בהמשך?) כדי לוודא שהמבוך אכן פתיר (ואם באמת אין לכם מה לעשות, גם כדי לבדוק שבאמת יש רק פתרון יחיד). חייבים להודות שזו שאלה מעניינת - איך מייצרים מבוך כזה באופן שבו יש פתרון והוא יחיד?</p>
<p>את הבעיה הזו אפשר לראות בתור מקרה פרטי של בעיה מתמטית כללית יותר, ומטרת הפוסטים שלי היא לעסוק בבעיה הזו ובבעיות קשורות לה ובניסוח המתמטי הרלוונטי, ובדיוק בגלל זה אני רוצה שנתחיל דווקא בלי לדבר עליה בכלל, אלא נציג את רעיון הפתרון ה"פרטי", עבור מבוכים בלבד. הגישה שלי היא כזו - אני מתחיל ממבוך שמורכב ממשבצות כאשר כל משבצת מוקפת קירות מכל עבר:</p>
<p><a href="/img/2013/09/maze2.png"><img src="/img/2013/09/maze2.png" alt="maze2" width="475" height="473" class="alignnone size-full wp-image-2867" /></a></p>
<p>ועכשיו אני פשוט הולך להסיר קירות, אחד אחרי השני, עד שאשאר עם מבוך כמו בתמונה למעלה. השאלה היא רק איך לבחור אילו קירות כדאי לי להסיר. התשובה היא שבאופן פחות או יותר אקראי, אבל אם אני סתם בוחר קירות באופן אקראי ומסיר אותם אין ממש סיכוי שאשאר עם פתרון יחיד או שיהיה מובטח לי שיש פתרון - סדר צריך להיות. לכן הגישה היא לבחור קיר באופן אקראי, ואז לחשוב אם באמת כדאי לי להסיר אותו או לא, ורק אם כדאי - להסיר. איך אני מחליט שכדאי להסיר קיר? הקריטריון פשוט: כדאי להסיר קיר רק אם ההסרה שלו <strong>לא מחברת תאים במבוך שכבר יש דרך אחרת ביניהם</strong>. למה? כי אם כבר יש דרך ביניהם, אז אחרי הסרת הקיר יהיו שתי דרכים ביניהם (הדרך הקצרה של פשוט לעבור מהאחד אל השני מייד - כי אין קיר - והדרך הארוכה של לעבור באותה דרך אחרת שאמרנו שקיימת). זה יוצר "לולאה" בתוך המבוך, ולולאה כזו מבטיחה שאם יש פתרון למבוך, זה לא יהיה פתרון יחיד. למה? אשאיר את זה בינתיים כאתגר עבורכם; כשנגיע לניסוח המתמטי המדויק זה יתברר.</p>
<p>אוקיי, אז אני בוחר קירות באקראי, מסיר כל קיר ש"חוקי" עבורי להסיר, ומסמן בלי להסיר קירות ש"לא חוקי" עבורי להסיר. מתי אני מפסיק? ברגע שבו אין לי יותר קירות שאני יכול להסיר. בשלב הזה מובטח שלמבוך יהיה פתרון ושהפתרון הזה יהיה יחיד, כי בשום שלב לא קלקלנו את תכונת היחידות הזו. רגע, למה מובטח שיהיה פתרון? הנה לכם עוד אתגר שיתברר כשאגיע לניסוח המתמטי הפורמלי.</p>
<p>האלגוריתם שהצגתי כרגע הוא מקרי פרטי של מה שנקרא <strong>האלגוריתם של קרוסקל</strong>. נשאלת השאלה עד כמה קל לתכנת אותו. בואו נניח שיש לי רשימה של כל הקירות - לבחור אותם באקראי זה קל, פשוט נערבב את הרשימה ואז נשלוף ממנה קירות אחד-אחד. אבל איך נבדוק אם חוקי או לא חוקי להסיר קיר? אפשר, עבור כל קיר, לערוך חיפוש במבוך הנוכחי ולבדוק אם כבר יש מסלול בין שתי המשבצות שהקיר מפריד, אבל חיפוש כזה לא יהיה זול ויש משהו בזבזני בלערוך אותו לכל זוג משבצות שמופרדות בקיר, בזמן שברור שחיפושים שונים משתמשים בהרבה מאוד אינפורמציה משותפת. אולי יש דרך טובה יותר?</p>
<p>הדרך הטובה יותר היא לתחזק <strong>מבנה נתונים</strong> שמכיל מידע שעונה על השאלה שלנו, והמחיר של ביצוע פעולות <strong>מהסוג שמעניין אותנו</strong> עליו הוא זול יחסית. כל מה שאנחנו צריכים לדעת הוא בהינתן שתי משבצות, האם יש מסלול ביניהן; לא חשוב לנו למצוא את המסלול עצמו, רק לדעת אם הוא קיים או לא. לכן מספיק לנו לתחזק מבנה נתונים שמכיל <strong>קבוצות זרות</strong>, כשכל תא במבוך שייך לאחת מהקבוצות, ושיש מסלול בין שני תאים אם ורק אם הם שייכים לאותה קבוצה. כעת, כדי לבדוק אם קיר הוא "חוקי להסרה" אנחנו בודקים אם שני התאים שסמוכים אליו לא נמצאים כרגע באותה קבוצה; אם הם כן, לא מסירים את הקיר; ואם הם לא, מסירים את הקיר ואז מאחדים את הקבוצות של שני התאים הללו. אם כן, הפעולות שאני דורש ממבנה הנתונים שלי הן <strong>למצוא</strong> לאיזו קבוצה שייך איבר נתון, ו<strong>לאחד</strong> שתי קבוצות; לכן מבנה הנתונים הרלוונטי נקרא לפעמים Union/Find, ולפעמים סתם Disjoint Sets Data Structure. מסתבר שמבנה נתונים כזה קל מאוד לממש, עם התחכמות או שתיים שהופכות אותו ליעיל מאוד. גם את זה אציג בהמשך באופן פורמלי, כולל קוד.</p>
<p>אם כן, זה היה האלגוריתם של קרוסקל, אבל יש אלגוריתם נוסף שאני רוצה להציג - <strong>האלגוריתם של פרים</strong>, שפועל בצורה דומה אבל לא זהה. גם הוא בכל רגע נתון מסיר "קיר חוקי" אחד, אבל האופן שבו הוא בוחר קיר חוקי הוא שונה. בעוד שקרוסקל בוחר בכל פעם קיר כלשהו מתוך כל המבוך, פרים מתחיל מתא נתון כלשהו (נאמר, הכניסה למבוך) ובכל שלב מפריד את הקירות לשני סוגים - אלו שמפרידים בין שני תאים שכבר ניתן להגיע אליהם מהתא ההתחלתי - התאים ה"ישיגים" - ואלו שמפרידים בין תא ישיג ובין תא שכרגע עדיין אינו ישיג. פרים בוחר בכל שלב באקראי קיר אחד מבין אלו שמפרידים בין התאים הישיגים והתאים הלא ישיגים. חשבו על מעין "מעטפת" של קירות לא ישיגים שהולכת וגדלה עם הזמן ובכל פעם פרים מבקיע בה עוד ועוד חורים.</p>
<p>בפוסטים הבאים נדבר על המתמטיקה והפורמליזם שמאחורי כל זה. לבינתיים, הדרך הטובה ביותר "להרגיש" את האלגוריתמים היא לראות אותם רצים, אז הנה דוגמאות אינטראקטיביות: הזינו את גודל המבוך המבוקש (או הזיזו את המחוון ימינה כדי להגדיל ושמאלה כדי להקטין - תלוי אם הדפדפן שלכם כבר תומך בדבר כזה או לא), בחרו את האלגוריתם, ותנו לו לרוץ! (על פניו נראה שקרוסקל רץ לאט יותר, אבל זו אשליה אופטית - האנימציה לא מתארת ריצה "בזמן אמת" של האלגוריתמים אלא בדיעבד, ובאנימציה של קרוסקל אני מצייר גם בחירה של קיר, גם הסרה שלו וגם הפיכה של קיר שלא הוסר לשחור, בעוד שבאנימציה של פרים אני מצייר כרגע רק הסרות של קירות. למעשה, במימוש הנוכחי שלי האלגוריתם של פרים איטי משמעותית יותר מאשר האלגוריתם של קרוסקל ואסביר זאת בהמשך).</p>
<p><span><br />
<input type="range" min="2" max="20" id="maze_size" dir="ltr"><br />
        <select id="alg_type"><br />
            <option value="kruskal">קרוסקל</option><br />
            <option value="prim">פרים</option><br />
        </select><br />
        <input type="button" value="ייצר!" onclick="Game.animate_generation()" /><br />
</span><br />
        <br /><br />
        <canvas id="canvas" width="600" height="600"><br />
        </canvas></p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('expanded');
        }
        
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>