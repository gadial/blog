<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מספרי עבגד - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <a href="/" class="site-title">לא מדויק</a>
            <div class="nav-links">
                <a href="/">דף הבית</a>
                <a href="/random.html">פוסט אקראי</a>
                <a href="/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/2013/08/19/student_and_computer_12-13-14/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">פרוייקט &#34;התלמיד והמחשב&#34;, בעיות 12-13-14</span>
            </a>
            

            
            <a href="/2013/08/26/student_and_computer_15/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">פרוייקט &#34;התלמיד והמחשב&#34;, בעיה 15</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>מספרי עבגד</h1>
            <div class="post-meta">
                <span class="date">2013-08-21</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/משחקים וחידות מתמטיות.html">משחקים וחידות מתמטיות</a>
                    
                    <a href="/categories/תכנות.html">תכנות</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/גימטריה.html">גימטריה</a>
                    
                    <a href="/tags/המחשב לעזרת המתמטיקה.html">המחשב לעזרת המתמטיקה</a>
                    
                    <a href="/tags/ליצנות מתמטית.html">ליצנות מתמטית</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <p><a href="http://www.gadial.net/2013/05/27/student_and_computer_1/">פרוייקט "התלמיד והמחשב"</a> בעיצומו, ואני רוצה בפוסט הזה לדבר גם כן על תכנות, אבל על בעיה לא קשורה שאינה מופיעה בספר, אלא צצה לה בדיון ב<a href="https://www.facebook.com/avgadyavor/posts/378757425584167">דף הפייסבוק של עבגד יבאור</a>. הבעיה היא כזו: קחו את המספר האהוב עליכם, נאמר 42, וכתבו אותו בעברית: "ארבעים ושתיים". עכשיו, לזוג המילים "ארבעים ושתיים" יש ערך גימטרי, מהו? באופן די מדהים, 1089. מה מדהים פה? טוב, 42 הוא המספר ממדריך הטרמפיסט לגלקסיה, ואילו 1089 הוא המספר שמתקבל אם לוקחים מספר תלת ספרתי שאינו פלינדרום, הופכים את ספרותיו, מחסרים את הקטן מהגדול, הופכים את סדר הספרות של התוצאה ומחברים. למשל, אם ניקח את 281, נהפוך את הספרות ונקבל 182, נחסר ונקבל 099, נהפוך את הספרות ונקבל 990 ואז נחבר ונקבל 1089 (רואים מה עשיתי שם עם האפס?). שמעו, אני נדהם בדיוק כמוכם, סתם זרקתי את 42 כי זה ממדריך הטרמפיסט ולא ידעתי איזה ערך גימטרי נקבל. מדהים, פשוט מדהים!</p>
<p>אז כן, כפי שאתם בוודאי מבינים, אין שום חשיבות מיוחדת למספר שמתקבל מהמספר <span class="math">\(n\)</span> על ידי זה שכותבים את <span class="math">\(n\)</span>  בעברית ואז לוקחים את הערך הגימטרי של התוצאה, מלבד העובדה שהתהליך הזה משעשע אותנו. צאו מנקודת הנחה שזה משעשע אותנו, ועכשיו בואו ננסה להבין קצת את הפונקציה <span class="math">\(f(n)\)</span>  שמקבלת מספר <span class="math">\(n\)</span> ומחזירה את הערך הגימטרי של שם המספר בעברית (אז למשל, <span class="math">\(f(42)=1089\)</span>).</p>
<p>הפונקציה הזו היא די כאוטית, כמובן, ולכן דווקא מעניין לשאול עליה שאלות. עבגד שאל ראשית כל האם קיימת נקודת שבת לפונקציה, כלומר מספר <span class="math">\(n\)</span>  כך ש-<span class="math">\(f(n)=n\)</span>, כלומר מספר שבצורה כלשהי "מתאר את עצמו" (קצת מזכיר את <a href="http://www.gadial.net/2013/03/28/tupper-formula/">נוסחת טאפר</a>). למספר שמקיים את התכונה הזו נקרא "מספר עבגד". פרט לכך עבגד הצביע על כך שאם מפעילים את הפונקציה שוב ושוב על מספר מסוים, ואז על הפלט שלו, ואז על הפלט שלו וכן הלאה מקבלים שרשרת שיכולה או להימשך לנצח (כל הזמן נגיע למספרים חדשים) או שניכנס ללולאה על ידי כך שנפגע במספר ש"כבר ראינו קודם". השאלה הייתה אם ניתן לגלות מי נכנס ללולאה, מי ממש נמצא על הלולאה (את ההבדל בין שני אלו אסביר בפירוט בהמשך) והאם יש מספר שהשרשרת שמתחילה ממנו ממשיכה עד אינסוף. כל השאלות הללו הן רלוונטיות עבור שלל פונקציות <span class="math">\(f\)</span>  דומות, לאו דווקא זו של הגימטריה, ובקריפטוגרפיה יש לשאלות כאלו חשיבות גדולה כשהן נשאלות על <a href="http://www.gadial.net/2007/11/24/hash_functions/">פונקציות תמצות</a>. אבל לא ארחיב על זה יותר מדי בפוסט הנוכחי.</p>
<p>הפוסט הנוכחי הוא בראש ובראשונה פוסט תכנותי; מה שאני רוצה לשכנע אתכם הוא שאם בעיה מטופשת כמו זו מלהיבה אתכם, אתם יכולים חיש קל לכתוב סקריפט שיאפשר לכם לשחק איתה מכל כיוון אפשרי. אני כתבתי את הסקריפט שלי ברובי כי זו השפה האהובה עלי, אבל זה כמובן לא מחייב אף אחד. כמו כן, הפוסט הזה הוא בבירור ובמוצהר שטותי, אבל יש בו גם גרעין של רצינות; הרעיונות המתמטיים שאציג כאן הם כן נכונים ושימושיים, כך שהפוסט הזה הוא לא השתטות נטו.</p>
<p>לב העבודה הטכנית שנדרשת כאן היא לעשות שני דברים: בהינתן מילה בעברית, לחשב את הערך הגימטרי שלה; ובהינתן מספר טבעי, לכתוב אותו בעברית. אולי המכשול הראשון שהיה עומד בפני בעבר הוא יכולת ההתמודדות הלא מרשימה של רובי עם עברית, בפרט עברית שמשולבת בתוך קובץ קוד המקור שלה עצמו; אך לא עוד. החל מגרסה 1.9 שלה (שהיא הגרסה הנפוצה כיום), רובי תומכת בדבר הנפלא שנקרא "יוניקוד" ולא אכנס אל משמעותו כרגע אלא רק אעיר שזה מאפשר לנו לכתוב עברית בחופשיות בתור מחרוזות בתוך הקוד של רובי. רק צריך בתחילת הקובץ להוסיף הערה שתבהיר לרובי שאנחנו משתמשים ביוניקוד:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="c1"># encoding: UTF-8</span>
</code></pre></div>


</div>

<p>עכשיו אפשר לכתוב את הקוד של הפונקציה שמקבלת מחרוזת ומחזירה את הערך הגימטרי שלה (סכום הערכים הגימטריים של האותיות העבריות שבתוך המחרוזת). עשיתי את זה בשיטה המקובלת ברובי - הרחבתי את המחלקה של מחרוזת כדי שתכיל מתודה חדשה. לא באמת חייבים להבין את הרעיון הזה כדי להבין את הקוד:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">String</span>
<span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">gematric_value</span>
<span class="w">    </span><span class="nb">self</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span><span class="o">|</span><span class="n">a</span><span class="o">|</span><span class="w"> </span><span class="no">LETTER_VALUES</span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mi">0</span><span class="p">}</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="mi">0</span><span class="p">){</span><span class="o">|</span><span class="n">sum</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">}</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>


</div>

<p>זו פונקציה פשוטה מאוד לבקיאים ברובי - לוקחים את המחרוזת, מפצלים אותה לאותיות, כל אות מחליפים בערך הגימטרי שלה, ואז סוכמים. רק דבר אחד חסר - הגדרה של LETTER_VALUES. מה זה? ובכן, זה מה שנקרא ברובי Hash ובעברית אני מעדיף לקרוא לו <strong>מילון</strong>: אפשר לחשוב על זה בתור רשימה עם אינדקסים, כאשר במקרה שלנו האינדקסים הם אותיות בעברית, והערך שנמצא ב-LETTER_VALUES עבור כל אות הוא הערך הגימטרי שלה. ומאיפה המילון הזה הגיע? אני כתבתי אותו:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="no">LETTER_VALUES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s2">&quot;א&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ב&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ג&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ד&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ה&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ו&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ז&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ח&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ט&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;י&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;כ&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ך&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ל&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;מ&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ם&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;נ&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ן&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ס&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ע&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;פ&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ף&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;צ&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ץ&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ק&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ר&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ש&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;ת&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">400</span>
<span class="p">}</span>
</code></pre></div>


</div>

<p>כאן זה יוצא טיפה לא קריא בגלל העברית, אבל זה עובד מצוין. לכתוב דבר כזה נראה אולי מעיק, אבל זה עניין של חצי דקה בערך, ועושים את זה רק פעם אחת.</p>
<p>אז החלק של הגימטריה ממש קל. עכשיו מי שרוצה להתנסות ידנית ולחפש מספרים כאלו בעצמו יכול, ואפשר גם להשתמש במחשבון הגימטריה הפרימיטיבי שיש לי <a href="http://gadial.net/stuff/gematria/gematria.html">כאן</a>. אבל אני רוצה שהכל יהיה אוטומטי ולכן אני צריך לממש גם את השלב הבא - להפוך מספר למחרוזת בעברית שמתארת את המספר. וכאן אני בשתי בעיות: ראשית, אני לא יודע עברית (ואכן, תיקנו אותי בכמה וכמה טעויות מביכות עד שהקוד התייצב על מה שהוא כרגע) ושנית, המרת מספר לעברית היא לא הדבר הכי "נקי" בעולם כי יש כל מני דברים שצריך להתחשב בהם. למשל, 13 איננו "עשר ושלוש"; הוא "שלוש עשרה". למרבה המזל, בעברית <strong>אין</strong> יותר מדי יוצאים מן הכלל שכאלו, מה שמאפשר כתיבה יחסית נקיה ופשוטה.</p>
<p>אז מה עושים? לוקחים את המספר ומפרקים אותו לחלקים: למשל, את 1503 נפרק ל-1000 ו-500 ו-0 ו-3. כל אחד מהחלקים נמיר לשם שלו, באמצעות עוד מילון; לסיום, נחבר את החלקים ונוסיף "ו" לפני האחרון שבהם. היוצא מן הכלל היחיד הוא מספרים כדוגמת 1911 שבהם ה-11 שבסוף צריך להיות מומר ל-"אחד עשרה" ולא ל"עשר ואחד" - אני מטפל במקרה הזה במפורש. הצרה הזו חוזרת על עצמה גם באלפים (11000 הוא לא "עשרת אלפים ואלף" אלא "אחד עשרה אלף") אבל לא טרחתי לטפל בזה וגם לא טרחתי בכלל לכתוב שמות מספרים עבור יותר מ-10000; הרעיון היה קודם לכתוב משהו שעובד עד 10000 ואז לראות אם בכלל יש צורך במשהו מעבר לכך. לא היה, אבל שימו לב שזה אומר שהקוד שלי כרגע הוא לא <strong>מלא</strong>. נדרשת עוד עבודה כדי שהוא באמת יעבוד עבור כל מספר אפשרי.</p>
<p>ראשית, המילון - שוב, עבודה של דקה בערך והוא היה כתוב:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="no">HEBREW_NUMBER_NAMES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;אחת&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שתיים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שלוש&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;ארבע&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;חמש&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">6</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שש&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שבע&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שמונה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">9</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;תשע&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">10</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;עשר&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">11</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;אחת עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">12</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שתים עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">13</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שלוש עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">14</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;ארבע עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">15</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;חמש עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">16</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שש עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">17</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שבע עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">18</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שמונה עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">19</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;תשע עשרה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">20</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;עשרים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">30</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שלושים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">40</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;ארבעים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">50</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;חמישים&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="mi">60</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שישים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">70</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שבעים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">80</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שמונים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">90</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;תשעים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">100</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;מאה&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">200</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;מאתיים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">300</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שלוש מאות&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">400</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;ארבע מאות&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">500</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;חמש מאות&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">600</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שש מאות&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">700</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שבע מאות&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">800</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שמונה מאות&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">900</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;תשע מאות&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">1000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;אלף&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">2000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;אלפיים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">3000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שלושת אלפים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">4000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;ארבעת אלפים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">5000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;חמשת אלפים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">6000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;ששת אלפים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">7000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שבעת אלפים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">8000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;שמונת אלפים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">9000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;תשעת אלפים&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="mi">10000</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s2">&quot;עשרת אלפים&quot;</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>


</div>

<p>וכעת לפונקציה עצמה, שהיא הרחבה של המחלקה של מספרים שלמים:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Integer</span>
<span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">to_hebrew_name</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="no">HEBREW_NUMBER_NAMES</span><span class="o">[</span><span class="nb">self</span><span class="o">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="no">HEBREW_NUMBER_NAMES</span><span class="o">[</span><span class="nb">self</span><span class="o">]</span>
<span class="w">    </span><span class="n">name_parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<span class="w">    </span><span class="n">digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reverse</span><span class="o">.</span><span class="n">collect_with_index</span><span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">to_i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="o">**</span><span class="n">i</span><span class="p">}</span><span class="o">.</span><span class="n">reverse</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">digits</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">digits</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">digits</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">digits</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span>
<span class="w">      </span><span class="n">digits</span><span class="o">.</span><span class="n">pop</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">digit_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">digits</span><span class="o">.</span><span class="n">reject</span><span class="p">{</span><span class="o">|</span><span class="n">d</span><span class="o">|</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">}</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span><span class="o">|</span><span class="n">d</span><span class="o">|</span><span class="w"> </span><span class="n">d</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="p">}</span>
<span class="w">    </span><span class="n">digit_names</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ו&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">digit_names</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span>
<span class="w">    </span><span class="nb">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">digit_names</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">name</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>


</div>

<p>כאן שורות 6-9 מטפלות ביוצא מן הכלל של 11 ודומיו, ושורה 11 משתילה "ו" לפני המספר האחרון. פרט לכך אני מקווה שכל הקוד ברור.</p>
<p>יש לי רמאות קטנה בקוד - אני משתמש בפונקציה בשם collect_with_index שממש מתבקש שתהיה חלק מהספריה הסטנדרטית של רובי, אבל היא לא (ב-rails, שהוא תשתית לאתרי אינטרנט שמבוססת על רובי, דווקא יש כזו). אז מימשתי אותה בעצמי:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Array</span>
<span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">collect_with_index</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<span class="w">    </span><span class="nb">self</span><span class="o">.</span><span class="n">each_index</span><span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="k">yield</span><span class="p">(</span><span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)}</span>
<span class="w">    </span><span class="n">result</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>


</div>

<p>נהדר. מה עושים עכשיו? עכשיו מגיע השלב ה"מחקרי". פיתחתי את הכלים, עכשיו אפשר לנסות ולקפוץ לתוך הנתונים. דבר ראשון, במתח, בחיל וברעדה כותבים את הקוד שמחפש מספרי עבגד ומדפיס אותם:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">8000</span><span class="p">)</span><span class="o">.</span><span class="n">each</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="o">|</span><span class="n">n</span><span class="o">|</span>
<span class="w">     </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">n</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">#{</span><span class="n">n</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">#{</span><span class="n">n</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="o">.</span><span class="n">gematric_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="o">.</span><span class="n">gematric_value</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>


</div>

<p>מריצים, ו... כלום.</p>
<p>אוף.</p>
<p>אז מה עכשיו? קודם כל, בואו ננסה לקבל רושם כללי לגבי מה המספרים שבכלל עשויים להתקבל כפלט של <span class="math">\(f\)</span> עבור קלטים שהם עד 10,000:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="nb">puts</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span><span class="o">|</span><span class="n">n</span><span class="o">|</span><span class="w"> </span><span class="n">n</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="o">.</span><span class="n">gematric_value</span><span class="p">}</span><span class="o">.</span><span class="n">max</span>
</code></pre></div>


</div>

<p>הקוד הזה מחזיר 4144, וזה מעניין - זה אומר שכל מספר גדול מ-4144 עד 10,000 בהכרח החזיר פלט שקטן יותר מעצמו. למה זה מעניין? כי זה מעלה לי את הניחוש לפיו <strong>כל מספר</strong> גדול מ-4144 יחזיר פלט קטן מעצמו. למעשה, חקירה טיפה יותר מדוקדקת מראה ש-3999 ("שלושת אלפים תשע מאות תשעים ותשע") הוא המספר הגדול ביותר עד 10,000 שמחזיר מספר גדול מעצמו (4010). ההשערה הלא מוכחת שלי היא שזה המספר הגדול ביותר שמחזיר מספר שאינו קטן ממנו. בכלל. זו לא השערה מוכחת והיא כמובן תלויה בשאלה מה סגנון הכתיבה שאנחנו הולכים לפיו, אבל זה נראה לי סביר מאוד. למה? ובכן, קל לקבל הערכה גסה של כמה שווה כל ספרה, בגימטריה: "שלושת אלפים" הוא 1197. אז גם אם נניח שכל ספרה במספר, כשכותבים אותה בעברית מחזירה ערך גימטרי של 1500, אז בעוד שמספר בן 4 ספרות יוכל להביא אותנו אל ערך גימטרי של 6,000, מספר בן 5 ספרות יוכל להביא אותנו רק אל 7,500 שהוא כמובן קטן ממנו. ומספר בן 8 ספרות - רק אל 9,000, וכן הלאה וכן הלאה. בלשון מתמטית, המספרים גדלים <strong>אקספוננציאלית</strong> כשמגדילים את מספר הספרות שלהם, אבל הערך הגימטרי של הכתיב שלהם בעברית גדל <strong>לינארית</strong>, עם קבוע גדול יחסית (חסום על ידי ה-1,500 הזה, אבל בעצם גם על ידי מספרים קטנים יותר). בגלל שהקבוע הזה גדול יחסית בכלל יש לנו "מרחב משחק" בהתחלה.</p>
<p>זה אומר שמבחינה מתמטית הבעיה היא טריוויאלית לגמרי. יש לנו קבוצה קטנה ופשוטה יחסית של מספרים שרק בהם יכול לקרות משהו מעניין ואפשר להתעלם מכל היתר. זה גם עונה לשאלה השניה של עבגד מייד - לא יכולה להיות שרשרת אינסופית של מספרים. למה?  בגלל שכל מספר גדול מ-3999 יחזיר מספר שקטן ממנו, ולכן על ידי מספיק הפעלות של הפונקציה נגיע אל מתחת ל-4010 וכל הפעלה של הפונקציה תשאיר אותנו מתחת ל-4010 (או שווה ל-4010). עכשיו, אם מפעילים פונקציה שקבוצת הפלטים האפשרית שלה היא סופית אינסוף פעמים, מתישהו נחזור על אותו ערך פעמיים ("עקרון שובך היונים"), ואז אנחנו במעגל. סוף הסיפור. מכיוון שלא מצאנו אף מספר עבגד עד 3999, גם לא נמצא כזה בהמשך. בעסה.</p>
<p>למה זו לא הוכחה פורמלית? לא בגלל ידע שחסר לי במתמטיקה, אלא בגלל ידע שחסר לי בעברית - אני לא יודע איך כותבים מספרים ממש גדולים, ואין לי שיטת כתיבה פורמלית מול העיניים שמתאימה לכל מספר אפשרי. אולי יש משהו שאני לא מודע לו שמפיל אותי. זה לא סביר, אבל אני לא שולל את האפשרות הזו מייד (כמובן ששימוש במספר כמו "מיליארד" לא משנה הרבה - הערך הגימטרי שלו נמוך למדי).</p>
<p>אז מה עושים הלאה? עבגד ביקש למצוא את המעגלים שהפונקציה יוצרת. מעגל כזה, נזכיר, הוא סדרה של מספרים (שחוזרת על עצמה בסופו של דבר) שכל מספר בה מתקבל מקודמו על ידי הפעלת הפונקציה. מה שקורה עבור כל מספר הוא שאנחנו מפעילים את הפונקציה עליו שוב ושוב עד אשר לבסוף אנחנו פוגעים במספר שנמצא על מעגל, ואז אנחנו מתקדמים במעגל עד שאנחנו חוזרים אל המספר הראשון מתוך המעגל שפגענו בו (כך שאם נצייר את המסלול שעשינו הוא נראה כמו מעין "לאסו"). לכן הדרך הפשוטה למצוא מעגלים היא לבחור מספר, להפעיל את הפונקציה עליו שוב ושוב עד שאנחנו מגיעים למספר שכבר ראינו בעבר. אם זה מספר שנמצא על המסלול הנוכחי, אנחנו במעגל ונוסיף אותו לרשימת המעגלים שלנו; אם זה מספר שנמצא במסלול שמצאנו בעבר, אז התחברנו למעגל קיים. בכל מקרה נעבור כעת למספר אחר ונתחיל להפעיל עליו את הפונקציה. אחרי שסיימנו יש לנו רשימה של "לאסו"-אים; כדי לקבל מהם מעגלים "טהורים" אני פשוט חוזר על התהליך שוב, אבל מתחיל מהאיבר האחרון בכל לאסו, שמובטח לי שהוא אכן על המעגל עצמו (למה?). הקוד שעושה את זה אצלי הוא קצת מכוער כי בעיקר רציתי לגרום לו לרוץ מהר (מה שנקרא quick and dirty בעגה תכנותית), אבל הוא עובד לא רע:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_cycles</span>
<span class="w">  </span><span class="n">nums</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">5000</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span>
<span class="w">  </span><span class="n">cycles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">nums</span><span class="o">.</span><span class="n">empty?</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nums</span><span class="o">.</span><span class="n">shift</span>
<span class="w">    </span><span class="n">cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">n</span><span class="o">]</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="kp">true</span>
<span class="w">      </span><span class="n">next_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cycle</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="o">.</span><span class="n">gematric_value</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">nums</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">next_n</span><span class="p">)</span>
<span class="w">    </span><span class="n">cycles</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">cycle</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">cycle</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">next_n</span><span class="p">)</span>
<span class="w">    </span><span class="k">break</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">      </span><span class="n">cycle</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">next_n</span>
<span class="w">      </span><span class="n">nums</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">next_n</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">new_cycles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">cycles</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="n">new_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">c</span><span class="o">.</span><span class="n">last</span><span class="o">]</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="n">new_c</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="o">.</span><span class="n">gematric_value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">new_c</span><span class="o">.</span><span class="n">first</span>
<span class="w">      </span><span class="n">new_c</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">new_c</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="o">.</span><span class="n">gematric_value</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="n">new_cycles</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">new_c</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">new_cycles</span>
<span class="k">end</span>
</code></pre></div>


</div>

<p>זה החזיר חמישה מעגלים:<br />
[2706, 1596, 2332]<br />
[2370, 1682]<br />
[813, 2065, 1185, 957, 2003]<br />
[2450, 1305, 1548, 1636]<br />
[1786, 1982, 2540, 1295]</p>
<p>בפרט מעניין המעגל של 1682 ו-2370: זה אומר ששני המספרים הללו נותנים כל אחד את חברו כאשר לוקחים את הערך הגימטרי של שמם. אפשר לומר שהם "ידידותיים-גימטרית" ("מספרים ידידותיים" הוא שם מטופש אבל סטנדרטי למספרים שכל אחד מהם הוא סכום המחלקים ממש של השני). זה הכי קרוב למספר עבגד שאפשר בלי שיהיה ממש מספר עבגד.</p>
<p>אז מה, שנתייאש? חלילה. אם לא הצלחנו למצוא מספר עבגד בצורה ישרה, נתחיל לרמות ולשנות את חוקי המשחק! למשל, אבינעם יגור מצא ש-"אלף מאה חמש ושש" הוא 1111 בגימטריה. זו לא צורת כתיבה חוקית; אז מה, למה שזה יהיה פחות מגניב? למה הדיקטטורה הזו של צורת הכתיבה החוקית של מילים בעברית? עבגד גם הציע לקרוא בשם "מספרי אבגד" למספרים ששווים לגימטריה של צורת כתיבה לא תקנית של עצמם. התחושה שלי, שתכף אסביר אותה, הייתה שכל צורת כתיבה שבה מערבים <strong>שני</strong> מספרים תיתן לנו שלל תוצאות אפשריות, ואכן לא התבדיתי. כך מצאתי חיש קל את "המספר שאם מוסיפים לו מאה מקבלים אלפיים ושש מאות" (הניסוח המסורבל הוא מכוון לצורך השעשוע) וגם המון זוגות אחרים שעבורם זה עובד (מה עובד? הערך הגימטרי של המשפט הזה הוא 2500, וזה גם בדיוק המספר שאם מוסיפים לו 100 מקבלים 2600...). אפשר כמובן גם דברים פשוטים יותר, למשל "ארבע מאות ועוד אלף שבע מאות וחמישים" שיוצא גם בגימטרית וגם חשבונית 2150. הנה למשל הקוד ששימש אותי במציאת הזוג האחרון:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_for_pair</span>
<span class="w">  </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2100</span>
<span class="w">  </span><span class="n">nums</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="n">max</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span><span class="o">|</span><span class="n">n</span><span class="o">|</span><span class="w"> </span><span class="n">n</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="o">.</span><span class="n">gematric_value</span><span class="p">}</span>
<span class="w">  </span><span class="n">nums</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="kp">nil</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nums</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="n">max</span><span class="p">)</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">do</span>
<span class="w">      </span><span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nums</span><span class="o">[</span><span class="n">x</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nums</span><span class="o">[</span><span class="n">y</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">86</span><span class="p">)</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>


</div>

<p>אשאיר לכם להבין מה בדיוק עשיתי בו. למה הייתי כל כך בטוח שאמצא המון תוצאות? ובכן, זה די דומה למה שקורה ב<a href="http://www.gadial.net/2012/05/14/bible_jump_1/">דילוגי אותיות בתורה</a>. נניח שיש לי ביטוי מהצורה "המספר שאם מוסיפים לו X מקבלים Y". הביטוי הזה מערב שני מספרים X,Y שאפשר לבחור בחופשיות מתוך טווח גדול יחסית - נאמר, עד 4000. עכשיו, לצורך האינטואיציה נוח לחשוב שהערך הגימטרי של הביטוי הזה נקבע אקראית (בפועל הוא לא נקבע אקראית אלא נלקח מתחום קטן יותר וזה בעיקר עוזר לי) להיות משהו בין, נאמר, 1 ו-8000? עכשיו, מבין 8000 הערכים האפשריים הללו, עבור כל X,Y יש בדיוק ערך אחד שאנחנו רוצים לפגוע בו - הערך שהוא המספר שהביטוי "המספר שאם מוסיפים לו X מקבלים Y" מתאר. ההסתברות שלנו להצליח? 1 ל-8000. אם אנחנו עושים 4000 ניסויים כאלו, יש סיכוי לא רע שנצליח באחד מהם, בערך. אבל אנחנו עושים בערך 4000 <strong>בריבוע</strong> ניסויים כאלו, ולכן המון הצלחות זה עניין כמעט בטוח. כך גם בצופן התנ"כי - עושים שם בסופו של דבר מספר ריבועי של ניסויים.</p>
<p>ייתכן שכל זה עדיין לא מפיס את דעתכם. אל דאגה! הלל גרשוני הגיע לדיון והסביר שהדרך התקנית, התנ"כית, לכתוב מספרים היא בכלל כן לשים "ו" לפני כל מספר פרט לראשון. למשל, "מאה ועשרים ואחת". זה מוביל לפונקציה הבאה:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="k">def</span><span class="w"> </span><span class="nf">to_hebrew_name_bible_style</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="no">HEBREW_NUMBER_NAMES</span><span class="o">[</span><span class="nb">self</span><span class="o">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="no">HEBREW_NUMBER_NAMES</span><span class="o">[</span><span class="nb">self</span><span class="o">]</span>
<span class="w">    </span><span class="n">name_parts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<span class="w">    </span><span class="n">digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">self</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reverse</span><span class="o">.</span><span class="n">collect_with_index</span><span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">to_i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="o">**</span><span class="n">i</span><span class="p">}</span><span class="o">.</span><span class="n">reverse</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">digits</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">digits</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">digits</span><span class="o">[-</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">digits</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span>
<span class="w">      </span><span class="n">digits</span><span class="o">.</span><span class="n">pop</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">    </span><span class="n">digit_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">digits</span><span class="o">.</span><span class="n">reject</span><span class="p">{</span><span class="o">|</span><span class="n">d</span><span class="o">|</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">}</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span><span class="o">|</span><span class="n">d</span><span class="o">|</span><span class="w"> </span><span class="n">d</span><span class="o">.</span><span class="n">to_hebrew_name</span><span class="p">}</span>
<span class="w">    </span><span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="n">digit_names</span><span class="o">.</span><span class="n">length</span><span class="p">)</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span><span class="w"> </span><span class="n">digit_names</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ו&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">digit_names</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">}</span>
<span class="w">    </span><span class="nb">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">digit_names</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nb">name</span>
<span class="w">  </span><span class="k">end</span>
</code></pre></div>


</div>

<p>קיוויתי שכשנריץ אותה נמצא תוצאה אחת, אולי שתיים. שומו שמיים! מצאנו לא פחות מאשר חמש תוצאות! 1046, 1134, 1702, 1910, 2499! שמעו חברים, אמנם אמרתי שהכל משחק ואין לייחס לו משמעות, ואמנם כתבתי פה פוסטים ארוכים על למה הצופן התנ"כי זה הבל ו<a href="http://www.gadial.net/2007/11/30/gematria_is_evil/">למה גימטריה זה הבל</a>, אבל לא עוד. היום הפכתי לאדם מאמין.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>