<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>הקסם שבריבועי קסם - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://gadial.net/2013/03/05/magic_squares/">
    <meta property="og:title" content="הקסם שבריבועי קסם">
    <meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב">
    <meta property="og:site_name" content="לא מדויק">
    
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://gadial.net/2013/03/05/magic_squares/">
    <meta name="twitter:title" content="הקסם שבריבועי קסם">
    <meta name="twitter:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב">
    
    
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Hamburger menu button */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.8em;
            color: white;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .menu-toggle:hover {
            opacity: 0.8;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .top-nav .nav-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .top-nav .site-title {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0;
                padding: 10px 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            /* Hide nav links by default on mobile */
            .top-nav .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                margin-top: 10px;
            }
            
            /* Show when expanded */
            .top-nav .nav-links.expanded {
                display: flex;
            }
            
            .top-nav .nav-links > a {
                text-align: center;
                padding: 12px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box {
                width: 100%;
                flex-direction: column;
                margin-top: 10px;
                padding-top: 10px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box input {
                width: 100%;
                margin-bottom: 5px;
                min-width: 0;
            }
            
            .top-nav .search-box button {
                width: 100%;
            }
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        /* Force KaTeX content to wrap by overriding its internal structure */
        .katex-html {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .base {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .mord,
        .katex .mbin,
        .katex .mrel,
        .katex .mopen,
        .katex .mclose,
        .katex .mpunct,
        .katex .minner {
            display: inline !important;
            white-space: normal !important;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
            
            /* Hide post navigation on mobile */
            .post-navigation {
                display: none;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <div class="site-title">
                <a href="/" style="color: white; text-decoration: none;">לא מדויק</a>
                <button class="menu-toggle" onclick="toggleMobileMenu()" aria-label="תפריט">
                    ☰
                </button>
            </div>
            <div class="nav-links" id="navLinks">
                <a href="/">דף הבית</a>
                <a href="/random.html">פוסט אקראי</a>
                <a href="/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/2013/02/26/godel_completeness_proof_2/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">משפט השלמות של גדל, ההוכחה (חלק ב&#39;)</span>
            </a>
            

            
            <a href="/2013/03/21/fol_completeness_corollaries/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">לוגיקה מסדר ראשון - כמה תוצאות של משפט השלמות</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>הקסם שבריבועי קסם</h1>
            <div class="post-meta">
                <span class="date">2013-03-05</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/משחקים וחידות מתמטיות.html">משחקים וחידות מתמטיות</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/ריבוע קסם.html">ריבוע קסם</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <p>בואו נתחיל עם צפיה <a href="http://vimeo.com/60852161">בקסם המרהיב</a> שבסרטון בלינק הבא:</p>
<p><a href="http://vimeo.com/60852161">http://vimeo.com/60852161</a></p>
<p>למי שלא יכול או לא רוצה לראות וידאו (למרות שכדאי, מכיוון שנתעמק בפרטיו אחר כך), מה שקורה פה הוא הדבר הבא: לקוסם יש חבילה של קלפים (לא קלפי משחק) עם מספרים שונים ומשונים עליהם - לא רק מספרים בין 2 ל-13 כמו בחפיסת קלפי משחק רגילים אלא גם מספרים כמו 42. הוא נותן למשתתף חלק מהקלפים, מבקש ממנו לפרוש אותם כשפניהם כלפי מטה ולבחור אחד מהם באופן שבו הקוסם והצופים רואים את גבו של הקלף שנבחר אבל לא מה מספרו. לאחר מכן הקוסם לוקח את יתר הקלפים ובונה מחלקם ארבע ערימות של ארבעה קלפים כל אחד. ואז מתברר שמספרי הקלפים בכל אחת מהערימות מסתכמים למספר 42, ולאחר שהקוסם פורס את הערימות ויוצר מהקלפים ריבוע של <span class="math">\(4\times4\)</span> מסתבר שגם כל שורה וכל עמודה וכל אלכסון מסתכמים גם הם ל-42 - במילים אחרות, הקוסם בנה <strong>ריבוע קסם</strong> מסדר <span class="math">\(4\times4\)</span> עבור המספר 42. כמובן, מספר הקלף שהמשתתף בחר הוא 42. לאחר מכן הקוסם מראה שעל גבם של חלק מהקלפים שמרכיבים את ריבוע הקסם כתוב (בשלבים) "אתה הולך לבחור 42". תענוג לצפיה.</p>
<p>התהיה הראשונה היא למה מבין כל הקלפים המשתתף בחר דווקא בזה שמספרו 42 (שהוא, כידוע, כוכב "המדריך לטרמפיסט בגלקסיה" של דגלאס אדמאס). על השאלה הזו לא אוכל לענות בפוסט, אבל אני מקווה שאוכל להסביר איך הקסם התבצע. אני עצמי ידעתי רק איך לבנות ריבוע קסם מסדר <span class="math">\(4\times4\)</span> שמסתכם למספר נתון (וזו המטרה ה"מתמטית" של הפוסט); הקרדיט על ניתוח האופן שבו הקסם מתבצע שייך לגלעד דיאמנט מהבלוג המצוין "<a href="http://sharp-thinking.com/">חשיבה חדה</a>", ואת הדיון המעניין של קהילת הבלוג על הקסם אפשר לראות <a href="https://www.facebook.com/groups/sharp.thinking/permalink/500279046694912/">בקבוצה של הבלוג</a> בפייסבוק.</p>
<p>מן הסתם אני עומד לגלות איך הקסם מתבצע, אז לאלו מכם שלא אוהבים להבין איך קסמים מתבצעים אני ממליץ להיזהר בהמשך קריאת הפוסט, כי אני <strong>אחרב לכם את הקסם לחלוטין</strong>. אבל זה יהיה רק בסוף הפוסט, עם כותרת מתאימה; אתחיל עם העניין המתמטי ה"כללי" - איך בכלל בונים ריבוע קסם <span class="math">\(4\times4\)</span>?</p>
<p><strong>על ריבועי קסם באופן כללי</strong></p>
<p>באופן כללי, ריבוע קסם הוא ריבוע של <span class="math">\(n\times n\)</span> משבצות שבתוכו כתובים מספרים (לעתים קרובות המספרים <span class="math">\(1,2,3,\dots,n^{2}\)</span> אבל לא חובה) כך שכל שורה וכל עמודה מסתכמת לאותו מספר, ואם עוד דברים (כמו האלכסונים) מסתכמים לאותו מספר על אחת כמה וכמה טוב. הנה דוגמה לריבוע קסם <span class="math">\(3\times3\)</span>, שעד סוף הפוסט כולנו נבין איך לבנות:</p>
<p><strong><span class="math">\(\left[\begin{array}{ccc}2 & 7 & 6\\9 & 5 & 1\\4 & 3 & 8\end{array}\right]\)</span></strong></p>
<p>והנה ריבוע הקסם של הקוסם בסרט:</p>
<p><span class="math">\(\left[\begin{array}{cccc}8 & 11 & 22 & 1\\21 & 2 & 7 & 12\\3 & 24 & 9 & 6\\10 & 5 & 4 & 23\end{array}\right]\)</span></p>
<p>עזבו את השאלה איך הקוסם בכלל ידע שהמשתתף הולך לבחור 42. נניח שבאים אליכם ואומרים לכם שאתם צריכים לבנות ריבוע שבו כל שורה, כל עמודה, כל אלכסון וכל רבע מסתכמים ל-42 - איך בכלל תעשו את זה? ואם המספר לא היה 42 אלא, נאמר, 53, האם עדיין אפשר היה לעשות את זה? אפשר לחשוב על זה בתור חידה: הפסיקו לרגע את קריאת הפוסט, הסתכלו על הריבוע של הקוסם שלמעלה ונסו לחשוב איך אפשר להסיק ממנו שיטה כללית לבניית ריבוע בעל אותן תכונות מרהיבות עבור כל סכום שהוא מספר דו ספרתי, ובעצם עבור כל מספר שהוא גדול או שווה ל-10.</p>
<p>ובכן, משהו שקופץ מהר מאוד לעין הוא שרוב המספרים בריבוע שלעיל הם קטנים יחסית, אבל יש כמה מספרים גדולים. עד כמה גדולים? עשרים ומשהו. בחינה יותר קפדנית מראה שיש בדיוק ארבעה מספרים שהם מהגודל הזה, ושמספריהם הם רצופים: 21,22,23,24. כעת אני שם לב לעוד משהו שעבורי בולט מאוד פשוט כי כבר נתקלתי בדברים דומים בעבר, אבל אולי למי שעוד אין לו נסיון לא יהיה בולט מספיק: שארבעת המספרים הללו היו פזורים בתוך הריבוע באופן שמתאר <strong>פרמוטציה</strong>. למה אני מתכוון? לכך שכל מספר שכזה היה היחיד מבין הארבעה הן בשורה שלו והן בעמודה שלו. איך זה קשור לפרמוטציות?</p>
<p>ובכן, פרמוטציה של המספרים מ-<span class="math">\(1\)</span> ועד <span class="math">\(n\)</span> היא פשוט ערבוב כלשהו של המספרים הללו. למשל, פרמוטציה לדוגמה של המספרים מ-1 עד 4 היא <span class="math">\(3,1,2,4\)</span>. תיאור מילולי של הפרמוטציה הזו יהיה "האיבר הראשון בפרמוטציה הוא 3, השני הוא 1; השלישי הוא 2; הרביעי הוא 4".</p>
<p>פרמוטציות אפשר לתאר באמצעות <strong>מטריצות</strong>, שבהקשר שלנו הן בסך הכל שם אחר לטבלאות עם מספרים בתוכן. הנה מטריצה שמתארת את הפרמוטציה שכרגע הזכרתי:</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 0 & 1 & 0\\1 & 0 & 0 & 0\\0 & 1 & 0 & 0\\0 & 0 & 0 & 1\end{array}\right]\)</span></p>
<p>מה קורה פה? עברו על המטריצה הזו שורה שורה ובדקו מהו מספר ה<strong>עמודה</strong> שבה יש 1. בשורה הראשונה זוהי עמודה 3; בשניה זוהי 1; בשלישית זוהי 2; ברביעית זוהי 4. הנה הפרמוטציה!</p>
<p>המטריצה הזו היא יותר מאשר "סתם" דרך כתיבה משונה למשהו שכתבתי באופן פשוט יותר: אם <a href="http://www.gadial.net/2011/10/06/matrix_product/">כופלים</a> אותה בוקטור <span class="math">\(\left(1,2,3,4\right)\)</span> מקבלים:</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 0 & 1 & 0\\1 & 0 & 0 & 0\\0 & 1 & 0 & 0\\0 & 0 & 0 & 1\end{array}\right]\left[\begin{array}{c}1\\2\\3\\4\end{array}\right]=\left[\begin{array}{c}3\\1\\2\\4\end{array}\right]\)</span></p>
<p>כלומר, מבחינה אלגברית, המטריצה הזו מתארת את הטרנספורמציה הלינארית שמבצעת את הפרמוטציה בפועל. אין צורך להבין את זה כדי להבין את המשך הפוסט, אבל זה קישור שלא רציתי לוותר עליו.</p>
<p>עכשיו, איך כל זה קשור לריבוע של הקוסם שלנו? פשוט מאוד: המיקומים של מספרי ה"עשרים ומשהו" הם בדיוק המיקומים של ה-1-ים במטריצה שלעיל. אפשר לכתוב זאת כך:</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 0 & 22 & 0\\21 & 0 & 0 & 0\\0 & 24 & 0 & 0\\0 & 0 & 0 & 23\end{array}\right]\)</span></p>
<p>אחרי שמבינים את זה, קל יותר לנחש מה ההמשך. אם הקוסם לקח רביעיה אחת של מספרים, 21,22,23,24 ופיזר אותה בתוך משבצות בריבוע שמהוות פרמוטציה, אולי הוא עשה את זה עם עוד רביעיות? אז כדאי לחפש מספרים בריבוע שערכיהם סמוכים. המספר הגדול ביותר בריבוע מלבד אלו של העשרים ומשהו הוא <span class="math">\(12\)</span>, אז אפשר לנחש שהרביעיה הבאה היא <span class="math">\(9,10,11,12\)</span>, ואכן, הם מפוזרים במקומות הבאים בריבוע:</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 11 & 0 & 0\\0 & 0 & 0 & 12\\0 & 0 & 9 & 0\\10 & 0 & 0 & 0\end{array}\right]\)</span></p>
<p>עכשיו כבר ברור שיהיו עוד שתי רביעיות, אחת של <span class="math">\(5,6,7,8\)</span> ואחת של <span class="math">\(1,2,3,4\)</span>. בסופו של דבר נקבל "פירוק" של הריבוע לסכום של ארבעה ריבועים:</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 0 & 22 & 0\\21 & 0 & 0 & 0\\0 & 24 & 0 & 0\\0 & 0 & 0 & 23\end{array}\right]+\left[\begin{array}{cccc}0 & 11 & 0 & 0\\0 & 0 & 0 & 12\\0 & 0 & 9 & 0\\10 & 0 & 0 & 0\end{array}\right]+\left[\begin{array}{cccc}8 & 0 & 0 & 0\\0 & 0 & 7 & 0\\0 & 0 & 0 & 6\\0 & 5 & 0 & 0\end{array}\right]+\left[\begin{array}{cccc}0 & 0 & 0 & 1\\0 & 2 & 0 & 0\\3 & 0 & 0 & 0\\0 & 0 & 4 & 0\end{array}\right]\)</span></p>
<p>למה כדאי להסתכל על הריבוע של בתור הפירוק הזה? מהטעם הפשוט שאם ניקח את אחד מהריבועים, ונוסיף או נחסיר <strong>רק למספרים שבו</strong> מספר קבוע כלשהו, אז בבירור סכום כל העמודות והשורות בריבוע הקסם ישתנה בדיוק במספר הקבוע הזה. במילים אחרות, אם אחליף את הריבוע</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 0 & 22 & 0\\21 & 0 & 0 & 0\\0 & 24 & 0 & 0\\0 & 0 & 0 & 23\end{array}\right]\)</span></p>
<p>בריבוע שבו החסרתי 20 מכל מספר, כלומר</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 0 & 2 & 0\\1 & 0 & 0 & 0\\0 & 4 & 0 & 0\\0 & 0 & 0 & 3\end{array}\right]\)</span></p>
<p>אקבל שסכום כל שורה ועמודה ואלכסון ורבע בריבוע הקסם החדש הוא 22.</p>
<p>כעת, לכל אחד מארבעת הריבועים בפירוק, המספרים בתוך כל ריבוע צריכים להיות שונים (כרגע זו עדיין תחושה בלבד; אסביר בקרוב למה זה הכרחי) אבל אין בעיה שאותו מספר יופיע ביותר מריבוע אחד. לכן, אם אני רוצה לקבל את הריבוע הפשוט ביותר שמציית לחוקיות של הריבוע של הקוסם, אני פשוט אחליף את המספרים בכל אחד מארבעת הריבועים בפירוק במספרים 1 עד 4 - כמובן, לפי סדר הגדלים שמופיע בכל ריבוע. התוצאה היא הפירוק הבא:</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 0 & 2 & 0\\1 & 0 & 0 & 0\\0 & 4 & 0 & 0\\0 & 0 & 0 & 3\end{array}\right]+\left[\begin{array}{cccc}0 & 3 & 0 & 0\\0 & 0 & 0 & 4\\0 & 0 & 1 & 0\\2 & 0 & 0 & 0\end{array}\right]+\left[\begin{array}{cccc}4 & 0 & 0 & 0\\0 & 0 & 3 & 0\\0 & 0 & 0 & 2\\0 & 1 & 0 & 0\end{array}\right]+\left[\begin{array}{cccc}0 & 0 & 0 & 1\\0 & 2 & 0 & 0\\3 & 0 & 0 & 0\\0 & 0 & 4 & 0\end{array}\right]\)</span></p>
<p>והסכום של כל אלו נותן לי את הריבוע:</p>
<p><span class="math">\(\left[\begin{array}{cccc}4 & 3 & 2 & 1\\1 & 2 & 3 & 4\\3 & 4 & 1 & 2\\2 & 1 & 4 & 3\end{array}\right]\)</span></p>
<p>קל לראות שהריבוע הזה הוא פתרון שאפשר לתת במקרה שבו צריך למצוא ריבוע קסם שמסתכם ל-10: זהו סכום השורות, העמודות, האלכסונים, הרבעים ועוד כהנה וכהנה דברים (הפינות, למשל). אם כן, כבר ברורה שיטה שבה אפשר לייצר ריבוע קסם למספר <strong>כלשהו</strong> שגדול או שווה ל-10; רק צריך לזכור את הריבוע שכתבתי זה עתה ואת הפירוק שלו לסכום של ארבע פרמוטציות, ואז אפשר לבחור פרמוטציה מבין הארבע ולהוסיף לכל איבריה מספר כלשהו. אם אבחר פרמוטציה ואוסיף לה, נאמר, 7, אקבל ריבוע קסם שבו השורות-עמודות-אלכסונים-רבעים מסתכמים כולם ל-17. נסו זאת! כמובן שאפשר להשיג את אותו האפקט גם בדרך אחרת: להוסיף 4 לאחת הפרמוטציות ולהוסיף 3 לאחרת.</p>
<p>בואו נעבור עכשיו להבין <strong>למה</strong> זה עובד, וחשוב מכך - לאילו מושגים כלליים במתמטיקה זה מתקשר. לצורך כך, הנה דרך נוחה יותר להתבונן על הריבוע הבסיסי כשרואים בעיניים את הפירוק שלו לארבע פרמוטציות:</p>
<p><strong><a href="/img/2013/03/magic_square.png"><img class="alignnone size-medium wp-image-2374" alt="magic_square" src="/img/2013/03/magic_square.png" width="300" height="300" /></a></strong></p>
<p>כאן צבעתי כל רביעייה בצבע שונה, ועכשיו אפשר לראות בעיניים את התכונות של הריבוע:</p>
<ol>
    <li>לכל משבצת יש צבע מבין 4 צבעים אפשריים ויש בתוכה מספר בין 1 ל-4.</li>
    <li>בכל שורה ובכל עמודה כל המספרים שונים.</li>
    <li>בכל שורה ובכל עמודה כל הצבעים שונים.</li>
    <li>כל שילוב אפשרי של צבע ומספר מופיע בדיוק פעם אחת.</li>
</ol>
<p>תכונת ה"בכל שורה ובכל עמודה כל המספרים שונים" כנראה מוכרת לרובכם: במשחק <strong>סודוקו</strong> אלו שתיים משלוש הדרישות על לוח סודוקו חוקי (השלישית היא דרישה על תת-ריבועים שלא רלוונטית כאן). עם זאת, המושג הזה של ריבוע בגודל <span class="math">\(n\times n\)</span> של מספרים מתוך קבוצה בת <span class="math">\(n\)</span> איברים כך שבכל שורה ובכל עמודה מספר שונה של מספרים הוא עתיק בהרבה משגעון הסודוקו; במתמטיקה קוראים לריבוע שכזה <strong>ריבוע לטיני</strong> והחוקר הידוע ביותר של ריבועים לטיניים (אם כי היו גם לפניו) היה המתמטיקאי לאונרד אוילר בן המאה ה-18.</p>
<p>הנה דוגמה פשוטה לאופן שבו אפשר לבנות ריבוע לטיני, נאמר מסדר <span class="math">\(3\times3\)</span> עם המספרים <span class="math">\(1,2,3\)</span>: השורה הראשונה תהיה <span class="math">\(1,2,3\)</span>. השורה השניה תהיה <span class="math">\(2,3,1\)</span> שהיא מה שמתקבל כאשר "מזיזים שמאלה" את אברי הסדרה <span class="math">\(1,2,3\)</span> ואת המספר השמאלי ביותר בה מעבירים לצד הימני ביותר. להזזה כזו קוראים "הזזה ציקלית" (ציקלי מלשון מעגלי; חשבו ש-<span class="math">\(1,2,3\)</span> היו מסודרים במעגל ואז היינו מזיזים את כולם שמאלה). השורה השלישית תהיה הזזה ציקלית של השורה השניה, כלומר <span class="math">\(3,1,2\)</span>. נקבל:</p>
<p><span class="math">\(\left[\begin{array}{ccc}1 & 2 & 3\\2 & 3 & 1\\3 & 1 & 2\end{array}\right]\)</span></p>
<p>נסו להוכיח לעצמכם ששיטת הבניה שלי אכן עובדת תמיד. זה לא קשה.</p>
<p>בבירור כל ריבוע לטיני הוא גם ריבוע קסם, במובן זה שסכום כל השורות וכל העמודות בו הוא זהה, ושווה לסכום קבוצת המספרים שמופיעים בריבוע. למשל, בריבוע שבניתי הסכום יהיה <span class="math">\(1+2+3=6\)</span>. מדוע זה עובד? ובכן, בכל שורה ובכל עמודה בריבוע הלטיני כל האיברים שונים זה מזה ולכן הם בדיוק כל <span class="math">\(n\)</span> המספרים שבכלל יכולים להופיע בריבוע הלטיני ולכן סכום כל שורה וכל עמודה שווה לסכומם.</p>
<p>נניח שאני רוצה שסכום השורות והעמודות בריבוע שבניתי למעלה לא יהיה 6 אלא מספר אחר, נאמר 77, מה אעשה? ובכן, פתרון אחד הוא להחליף כל מופע של 1 ב-72:</p>
<p><span class="math">\(\left[\begin{array}{ccc}72 & 2 & 3\\2 & 3 & 72\\3 & 72 & 2\end{array}\right]\)</span></p>
<p>שכנעו את עצמכם שזה אכן יעבוד באופן כללי. מכיוון שזה כל כך קל, ריבוע קסם שבו רק סכומי השורות והעמודות הם זהים הוא "לא מעניין" וכדאי לדרוש עוד אילוצים. אפשר לדרוש, למשל, שגם סכומי האלכסונים יהיו שווים לסכומי השורות והעמודות, ונדבר על כך אחר כך; אבל לבינתיים אני רוצה לדרוש פשוט שכל אברי הריבוע יהיו שונים זה מזה. ברור שזה מחסל את שיטת הבניה הנוכחית שלי שבה מתחילים מריבוע שאותם שלוש מספרים מופיעים בו שלוש פעמים שונות וכדי לשנות את ערך הסכום שלו פשוט בוחרים אחד מהמספרים הללו ומגדילים אותו בערך קבוע. כדי להתמודד עם האילוץ החדש הזה אצטרך קצת יותר מאשר "סתם" ריבוע לטיני.</p>
<p>בואו נחזור שניה אל הריבוע של הקוסם. אם נסתכל רק על הצבעים בו, נראה שגם מהבחינה הזו מדובר בריבוע לטיני; אמנם, אלו צבעים ולא מספרים, אבל מה ההבדל? אם נרצה, נוכל להתאים מספר לכל צבע. הדבר החשוב הוא שבכל שורה ובכל עמודה מופיעים כל צבע בדיוק פעם אחת. לכן הריבוע של הקוסם הוא בעצם <strong>שני</strong> ריבועים לטיניים ש"מונחים אחד על השני". תכונה 4 אומרת לנו מה הקשר ביניהם: כל זוג של מספר וצבע מופיע בדיוק פעם אחת. זו לא תכונה טריוויאלית; אם אקח את הריבוע הלטיני</p>
<p><span class="math">\(\left[\begin{array}{ccc}1 & 2 & 3\\2 & 3 & 1\\3 & 1 & 2\end{array}\right]\)</span></p>
<p>ובמקום להשתמש במספרים אתאר אותו בצבעים, אקבל שצבע אחד מופיע רק עם 1, צבע אחר רק עם 2 וכן הלאה. מכאן שאנחנו צריכים לקחת שני ריבועים לטיניים <strong>שונים</strong> שאיכשהו מתנהגים יפה אחד עם השני כדי לקבל ריבוע שדומה לזה של הקוסם. לזוג ריבועים כזה קוראים <strong>ריבועים לטיניים אורתוגונליים</strong>. עכשיו אני יכול גם להסביר למה בכלל קוראים לריבועים הללו "ריבועים לטיניים"; במקור אוילר לא השתמש במספרים וצבעים כדי לתאר את תוכן הריבועים, אלא באותיות יווניות ולטיניות (יווניות בריבוע אחד, לטיניות בריבוע אחר, כדי להימנע מבלבול). לזוג ריבועים אורתוגונליים קראו גם ריבוע יווני-לטיני (הוא נכתב על ידי כך שבמקום שני ריבועים שונים, בכל משבצת בריבוע יהיה הזוג של האות היוונית והאות הלטינית שמתאימות לאותה משבצת). עם הזמן שיטת הסימון של אוילר נשכחה וגם ה"יווני" נשכח ונותר הלטיני.</p>
<p>ההיסטוריה של ריבועים לטיניים מעניינת למדי. קל להראות שאין זוג ריבועים לטיניים אורתוגונליים מסדר <span class="math">\(2\times2\)</span> ואפשר בקלות רבה למצוא זוג מסדר <span class="math">\(3\times3\)</span> (תכף נראה איך); במאה ה-18 נתגלו גם זוגות עבור <span class="math">\(4\times4\)</span>, ואז בא לאונרד אוילר ומצא בניות של זוגות ריבועים לטיניים אורתוגונליים עבור <strong>כל</strong> גודל <span class="math">\(n\times n\)</span> כאשר <span class="math">\(n\)</span> הוא אי זוגי או מתחלק ב-4. זו הייתה קפיצת דרך מרהיבה, אבל היא עדיין הותירה פתוחה את השאלה מה קורה כאשר <span class="math">\(n\)</span> הוא מספר זוגי אשר משאיר שארית 2 בחלוקה ב-4. המספרים הראשונים מסוג זה הם 2 ו-6: אוילר ידע שאין פתרון עבור 2 ולא עלה בידו למצוא פתרון עבור 6 (אבל גם לא הוכחה שאין פתרון כזה), והוא העלה את ההשערה שבאופן כללי אין פתרון עבור <span class="math">\(n\)</span> שמשאיר שארית 2 בחלוקה ב-4.</p>
<p>רק בשנת 1901 הוכח שאוילר צדק בכך שחשב שאין פתרון עבור 6, אבל 1959 הוכח כי עבור כל <span class="math">\(n\ne2,6\)</span> אכן <strong>קיים</strong> פתרון! לי אין מושג איך בונים את הפתרונות הללו, אבל אולי אקדיש לכך פוסטים בעתיד אם הבניה פשוטה דיו להצגה כאן.</p>
<p>טוב, אז איך זוג ריבועים לטיניים אורתוגונליים עוזרים לנו כאן? בואו נמשיך לחשוב על זוג כזה בתור ריבוע אחד, עם מספרים וצבעים, כאשר המספרים הם בין 1 ל-<span class="math">\(n\)</span>. עכשיו אני רוצה להפוך את הריבוע הזה לריבוע קסם "קלאסי", כזה שבו המספרים הם <span class="math">\(1,2,\dots,n^{2}\)</span> וסכום כל השורות והעמודות זהה. מה עושים? ראשית כל שמים לב לאבחנה הבאה: אם ניקח את כל המשבצות שצבועות בצבע מסויים ונוסיף לכולן את אותו המספר <span class="math">\(a\)</span>, סכום השורות והעמודות לא ישתנה. למה? כי בכל שורה מופיעה בדיוק משבצת <strong>אחת</strong> עם הצבע הזה, ולכן לסכום של כל שורה יתווסף <strong>בדיוק </strong><span class="math">\(a\)</span> ולא יותר מכך, וכך גם עם העמודות.</p>
<p>על כן, דרך הפעולה שלי היא כזו: אני אבחר צבע ואותיר את המספרים <span class="math">\(1,2,\dots,n\)</span> שלו ללא שינוי. אחר כך אני אבחר צבע אחר ואוסיף לכל מספר בו <span class="math">\(n\)</span> וכך אקבל את המספרים <span class="math">\(n+1,n+2,\dots,2n\)</span>. אחר כך אלך אל הצבע הבא ואוסיף למספרים שלו <span class="math">\(3n\)</span> וכן הלאה.</p>
<p>ה"בעיה" בתעלול הזה היא שכדי לבנות ריבוע קסם קודם כל צריך למצוא זוג ריבועים לטיניים אורתוגונליים, וזה יכול להיות קשה למדי (ועבור <span class="math">\(n=6\)</span> זה פשוט בלתי אפשרי, אבל בהחלט <strong>קיימים</strong> ריבועי קסם מגודל <span class="math">\(6\times6\)</span>; יש עוד דרכים לבנות ריבועי קסם שאינן משתמשות בריבועים לטיניים אורתוגונליים). עם זאת, אמרתי שעבור <span class="math">\(n=3\)</span> כולנו נדע לעשות את זה בסוף הפוסט, אז בואו נעשה את זה - כפי שאמרתי, עם ניסוי וטעיה.</p>
<p>נתחיל עם ריבוע לטיני בודד מסדר <span class="math">\(3\times3\)</span> מתבקש לבחור בתור השורה הראשונה את 1,2,3. בשביל השורה השניה אני יכול לבחור או את 2,3,1 או את 3,1,2; הראשון מביניהם נחמד יותר (הוא פשוט "הזזה ציקלית" של 1,2,3) ולכן נבחר אותו, ועכשיו השורה האחרונה נקבעת בצורה יחידה (פשוט תסתכלו בכל עמודה ותראו מה המספר שטרם הופיע. נקבל:</p>
<p><span class="math">\(\left[\begin{array}{ccc}1 & 2 & 3\\2 & 3 & 1\\3 & 1 & 2\end{array}\right]\)</span></p>
<p>עכשיו בואו נבנה ריבוע לטיני נוסף ונקווה שהוא יצא אורתוגונלי לריבוע שבנינו זה עתה. אשתמש, באופן הולם למדי, באותיות הלטיניות <span class="math">\(a,b,c\)</span> כדי לתאר את איבריו. השורה הראשונה תהיה אם כן <span class="math">\(a,b,c\)</span>. מה תהיה השורה השניה? אפשר <span class="math">\(b,c,a\)</span> אבל אז זה יהיה אותו הדבר כמו הריבוע שכבר בנינו ואין סיכוי שהם יהיו אורתוגונליים (כי אז, למשל, <span class="math">\(a\)</span> ו-1 תמיד יופיעו יחד). אז בואו נבחר את האפשרות האחרת: <span class="math">\(c,a,b\)</span>. נקבל:</p>
<p><span class="math">\(\left[\begin{array}{ccc}a & b & c\\c & a & b\\b & c & a\end{array}\right]\)</span></p>
<p>ועכשיו כשנשלב את שני הריבועים שבנינו יחד נקבל:</p>
<p><span class="math">\(\left[\begin{array}{ccc}\left(1,a\right) & \left(2,b\right) & \left(3,c\right)\\\left(2,c\right) & \left(3,a\right) & \left(1,b\right)\\\left(3,b\right) & \left(1,c\right) & \left(2,a\right)\end{array}\right]\)</span></p>
<p>כלומר, לשמחתנו הרבה אכן קיבלנו זוג ריבועים אורתוגונליים! כאן ממש נדחפנו לפתרון הזה - לא היה לנו שום חופש בחירה.</p>
<p>עכשיו, איך נבנה ריבוע קסם מהדבר הזה? ובכן, את המספרים שהם שכנים של <span class="math">\(a\)</span> נותיר כמות שהם; את המספרים שהם שכנים של <span class="math">\(b\)</span> נגדיל ב-3, ואת המספרים שהם שכנים של <span class="math">\(c\)</span> נגדיל ב-6. נקבל:</p>
<p><span class="math">\(\left[\begin{array}{ccc}1 & 5 & 9\\8 & 3 & 4\\6 & 7 & 2\end{array}\right]\)</span></p>
<p>קיבלנו ריבוע של המספרים מ-1 עד 9 כאשר כל שורה וכל עמודה מסתכמת ל-15, <strong>אך לא האלכסונים</strong>. מה עשיתי לא נכון? אם תסתכלו על האלכסונים בריבוע האורתוגונלי שלמעלה, תראו שהם לא "נחמדים" - באחד מהם מופיע 3 בכל המשבצות, ובשני מופיע <span class="math">\(a\)</span> בכל המשבצות. במקרה של האלכסון <span class="math">\(\left(3,c\right),\left(3,a\right),\left(3,b\right)\)</span> זה אומר שהסכום שלו יהיה 9 (הסכום של שלושת ה-3-ים) ועוד הערכים שאני נותן ל-<span class="math">\(a,b,c\)</span> שהם במקרה שלנו <span class="math">\(0,3,6\)</span>, כלומר הסכום הכולל יהיה 18 - לא מוצלח.</p>
<p>אז בואו נכתוב את הריבוע האורתוגונלי כמו שאוילר התכוון - עם אותיות לטיניות ויווניות ובלי מספרים כלל:</p>
<p><span class="math">\(\left[\begin{array}{ccc}\left(\alpha,a\right) & \left(\beta,b\right) & \left(\gamma,c\right)\\\left(\beta,c\right) & \left(\gamma,a\right) & \left(\alpha,b\right)\\\left(\gamma,b\right) & \left(\alpha,c\right) & \left(\beta,a\right)\end{array}\right]\)</span></p>
<p>וכעת, כדי לקבל ריבוע קסם מהיצור הזה אנחנו צריכים לבחור ערכים מספריים לכל אות יוונית ולכל אות לטינית, ואז לכל משבצת בריבוע לחבר את המספרים שבחרו לאות היוונית והלטינית שמופיעות במשבצת. אנחנו יודעים שאוטומטית, הסכום של כל שורה ושל כל עמודה יהיה שווה ל-<span class="math">\(\left(a+b+c\right)+\left(\alpha+\beta+\gamma\right)\)</span> ולכן כל שנותר לנו לדאוג לו הוא האלכסונים. הסכום של אחד האלכסונים הוא <span class="math">\(3\gamma+\left(a+b+c\right)\)</span> והסכום של האלכסון השני הוא <span class="math">\(3a+\left(\alpha+\beta+\gamma\right)\)</span>. מה עוד מגביל אותנו? אם אנחנו רוצים שכל המספרים יהיו שונים זה מזה ושכולם יהיו בטווח מ-1 עד 9, אנחנו חייבים לבחור עבור <span class="math">\(a,b,c\)</span> את הערכים 1,2,3 (לא בהכרח בהתאמה) ועבור <span class="math">\(\alpha,\beta,\gamma\)</span> את הערכים <span class="math">\(0,3,6\)</span> (לא בהכרח בהתאמה). כמובן, אפשר היה להגיד שדווקא האותיות הלטיניות צריכות לקבל 0,3,6 והיווניות 1,2,3 אבל זה לא היה משנה כלום.</p>
<p>אם האותיות היווניות קיבלו 0,3,6 אז <span class="math">\(\alpha+\beta+\gamma=9\)</span> ולכן כדי שיתקיים <span class="math">\(\left(\alpha+\beta+\gamma\right)=15\)</span><span class="math">\(3a+\)</span> בהכרח חייב להתקיים <span class="math">\(a=2\)</span>. בדומה, אם האותיות הלטיניות קיבלו את 1,2,3 אז <span class="math">\(\left(a+b+c\right)=9\)</span> אז <span class="math">\(3\gamma+\left(a+b+c\right)=15\)</span> גורר ש-<span class="math">\(\gamma=3\)</span>. את שאר המספרים אפשר לבחור בחופשיות (תחת המגבלות שכבר מצאנו). בואו נבחר <span class="math">\(\alpha=0,\beta=6,b=1,c=3\)</span> ונקבל את הריבוע הבא:</p>
<p><span class="math">\(\left[\begin{array}{ccc}2 & 7 & 6\\9 & 5 & 1\\4 & 3 & 8\end{array}\right]\)</span></p>
<p>וקיבלנו בדיוק את מה שרצינו - ריבוע קסם מסדר <span class="math">\(3\times3\)</span> עם המספרים מ-1 עד 9 שבו כל השורות, העמודות והאלכסונים מסתכמים ל-15. כפי שאפשר לראות, בסופו של דבר לא נדרש הרבה יותר מהגיון בריא בסיסי כדי למצוא את הריבוע הזה, וגם ילדים יכולים לעשות זאת (וכנראה עם הרבה פחות קשקושים מסביב ממני).</p>
<p>איך מוצאים את הריבועים האורתוגונליים מסדר <span class="math">\(4\times4\)</span> שהם הבסיס לקסם שבו פתחתי את הפוסט? טוב... ובכן... זו שאלה טובה. קסם?</p>
<p><strong>איך הקסם עבד?</strong></p>
<p>עכשיו, אחרי שהבנו לעומק את הרעיון המתמטי שמאחורי ריבועי קסם, בואו נדבר על איך הקוסם ביצע את הקסם בפועל, ואיך כל אחד מאיתנו יכול (תיאורטית) לעשות את אותו הדבר. נתחיל עם ציון המובן מאליו - התכונה העיקרית שנדרשת מקוסם טוב היא היכולת לבצע את הקסם במהירות ותוך הסחת דעת הצופה מהמתרחש, והקוסם בסרטון עושה זאת היטב - בצפיה ראשונה קיבלתי את הרושם השגוי לחלוטין שהוא מערבב את חפיסת הקלפים שלו (מה שהיה מקלקל את כל הקסם) והוא מבצע את השלבים מהר מספיק כדי שאי אפשר יהיה אפילו לנסות להבין מה מתרחש. רק שבימינו אפשר לעצור סרטוני וידאו ולהחזיר אותם אחורה כרצוננו וזה מקל מאוד על פענוח התעלול.</p>
<p>הנחה בסיסית שלי היא שהקוסם יודע בדיוק מה מספר הקלף שהמשתתף בחר למרות שאנחנו לא רואים את הקלף הזה בשום שלב. קרוב לודאי שצדם האחורי של הקלפים שמהם המשתתף יכל לבחור מסומן בדרך כלשהי - מספיק סימון זעיר שאינו בולט לעין אבל הקוסם יודע להבחין בו. זה תעלול קוסמים נפוץ מאוד ובוודאי שאינו העיקר כאן. אז ברגע שבו המשתתף בחר קלף, הקוסם ידע בודאות מהו. עדיין, איך ייתכן שהקוסם קיבל ריבוע קסם יפה כל כך מיתר הקלפים?</p>
<p>את התעלול הקוסם מתחיל כשהחבילה מונחת לידו, כשהיא כבר מסודרת באופן שנוח לקוסם. <strong>אף אחד לא מערבב אותה בשום שלב</strong>, וזה כמובן קריטי לחלוטין. בתחילת הקסם הקוסם מסיר מראש החבילה מספר קלפים עד שהוא מגיע לקלף 8 (כפי שכבר ראינו, 8 הוא מספר קטן מכדי להופיע בתור סכום של ריבוע קסם). אפשר להניח בשקט שהקלפים מעל 8 הם קלפים ספציפיים שהחבילה מהונדסת כדי שהתעלול יעבוד עבורם. אליו מספרים יש שם? 26 (פעמיים), 42, 22 (פעמיים), 34, 30, 50. כולם מספרים שאפשר לבנות ריבוע קסם עבורם (עבור 22 ו-30 הסיטואציה טיפה בעייתית כי בריבוע הקסם שיתקבל יהיו מספרים שמופיעים יותר מפעם אחת - אני משער שלקוסם אין בעיה עם זה).</p>
<p>אם נקפוץ קדימה לשלב שבו הקוסם מתחיל ליצור את ערימות הקלפים שירכיבו את ריבוע הקסם (1:22) נראה שהוא בונה ארבע ערימות באופן הדרגתי: בהתחלה מניח 8,7,9,10 (בסדר הזה), אחר כך מניח 11,1,6,3, אחר כך 2,12,4,5, ואז... הויסה, רגע. בואו ניזכר בפירוק לארבע פרמוטציות של ריבוע הקסם של הקוסם:</p>
<p><span class="math">\(\left[\begin{array}{cccc}0 & 0 & 22 & 0\\21 & 0 & 0 & 0\\0 & 24 & 0 & 0\\0 & 0 & 0 & 23\end{array}\right]+\left[\begin{array}{cccc}0 & 11 & 0 & 0\\0 & 0 & 0 & 12\\0 & 0 & 9 & 0\\10 & 0 & 0 & 0\end{array}\right]+\left[\begin{array}{cccc}8 & 0 & 0 & 0\\0 & 0 & 7 & 0\\0 & 0 & 0 & 6\\0 & 5 & 0 & 0\end{array}\right]+\left[\begin{array}{cccc}0 & 0 & 0 & 1\\0 & 2 & 0 & 0\\3 & 0 & 0 & 0\\0 & 0 & 4 & 0\end{array}\right]\)</span></p>
<p>ברור לגמרי שהקלפים הונדסו כך שבכל שלב של החילוק יונח קלף אחד בדיוק עבור כל רבע. למשל, הקלפים שהונחו ראשונים בכל שלב היו 8,11,2, שנמצאים ברבע השמאלי-עליון של הפרמוטציות - מלבד זו השמאלית ביותר שטרם הופיעה. אם עבור הפרמוטציה השמאלית ביותר היינו בוחרים את המספרים 1,2,3,4 היינו מקבלים שסכום כל שורה-טור-אלכסון-רבע הוא 22, המספר הראשון שהיה עשוי להיבחר על ידי המשתתף; כך שאפשר להניח בשקט ש-12 הקלפים שחולקו בשלב הזה הם חלק קבוע מסידור החפיסה שאינו תלוי בבחירה של המשתתף.</p>
<p>מה כן משתנה? ארבעת הקלפים הבאים, שהם כמובן 21,22,23,24. מרגע שהם הונחו, כל שנותר לקוסם לעשות הוא לסדר את ריבוע הקסם בצורה נכונה (זה כמובן דורש שינון כלשהו) והופה! ריבוע הקסם התקבל. צריך גם להסביר איך קרה שעל גב הקלפים כתוב שהמשתתף הולך לבחור 42. ובכן, מה שכתוב על רוב הקלפים הוא חסר חשיבות כי הוא אינו תלוי במספר; הדבר היחיד שחשוב הוא הקלף האחרון, בפינה הימנית-תחתונה, שעליו כתוב "42". הקלף הזה הוא הקלף שמספרו 23, כלומר לא אחד מ-12 הקלפים ה"גנריים" אלא קלף שמתאים לפרמוטציה השמאלית ביותר, שנקבעת ספציפית על פי המספר שהמשתתף בחר.</p>
<p>אם כן, החבילה של הקוסם כוללת 12 קלפים גנריים, עוד 4 קלפים "ספציפיים לבחירה" מתחתיהם, ומתחת לאלו כל יתר הקלפים שלהם הקוסם לא נזקק לצורך המשך התעלול. השאלה היחידה שנותרה היא איך יצא שמתחת ל-12 הקלפים הגנריים יש <strong>בדיוק</strong> את ארבעת הקלפים שמתאימים לבחירה של המשתתף? הרי הקוסם לא יכל לחזות אותה מראש! התשובה היא פשוטה: הקוסם <strong>מניח אותם שם מול העיניים שלנו</strong>, בלי בושה ובלי למצמץ, ואנחנו כמובן לא שמים לב. בסרטון אפשר לראות את זה החל מ-1:06: הקוסם בוחר מראש החפיסה את 12 הקלפים הגנריים, <strong>שם אותם בצד</strong>, עובר על יתר הקלפים עד שהוא מגיע אל הקלף הראשון מבין 4 הקלפים ה"ספציפיים", מניח אותם בראש החבילה שהוא סרק ושם עליהם את 12 הקלפים הגנריים שהיו בצד. וכל זה - פעולות מאוד מדויקות שהן הדבר הקריטי ביותר פה - נעשה בנונשלנטיות גמורה שגורמת לנו להרגיש שזה הדבר הכי טבעי בעולם.</p>
<p>אם כן, כעת גם אתם יודעים איך למצוא ריבועי קסם באופן כללי ובפרט איך לבצע את הקסם הספציפי שראינו. למרות שאני יכול להבין את אלו שהידע הזה מוציא להם את כל ההנאה מהקסם, אני דווקא חושב שבמקרה הספציפי הזה, הוא מהנה הרבה יותר כאשר ברור איך הוא מתבצע.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('expanded');
        }
        
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>