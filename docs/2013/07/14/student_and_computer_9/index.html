<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>פרוייקט &#34;התלמיד והמחשב&#34;, בעיה 9 - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <a href="/" class="site-title">לא מדויק</a>
            <div class="nav-links">
                <a href="/">דף הבית</a>
                <a href="/random.html">פוסט אקראי</a>
                <a href="/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/2013/07/04/student_and_computer_8/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">פרוייקט &#34;התלמיד והמחשב&#34;, בעיה 8</span>
            </a>
            

            
            <a href="/2013/07/17/student_and_computer_10/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">פרוייקט &#34;התלמיד והמחשב&#34;, בעיה 10</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>פרוייקט &#34;התלמיד והמחשב&#34;, בעיה 9</h1>
            <div class="post-meta">
                <span class="date">2013-07-14</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/תכנות.html">תכנות</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/פרוייקט &#34;התלמיד והמחשב&#34;.html">פרוייקט &#34;התלמיד והמחשב&#34;</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <p>בעיה 9 בספר היא בעיית המיון. או ליתר דיוק, בספר מתעסקים במיון רשימות באורך המרשים של 2 ו-3 מספרים, באמצעות שרשרת של if-ים; אני כמובן לא מוכן לעשות את זה ותחת זאת אציג מיון של מערך כללי. מיון, כזכור, פירושו לקחת מערך של איברים עם סדר כלשהו עליהם (כלומר, אפשר להשוות כל שני איברים) ולסדר אותו מהקטן לגדול. יש לי כבר פוסטים על מיונים שמתחילים <a href="http://www.gadial.net/2012/07/10/all_sorts_of_slow_sorts/">כאן</a>; לכן לא אחזור על הכל. שיטות המיון שבחרתי להשתמש בהן הן כאלו שנותנות לי אפשרות להציג דברים שאני רוצה להציג מתוך השפות, לא יותר מכך.</p>
<p>נתחיל עם רובי. ברובי, כמובן, אפשר למיין מערכים בפקודה אחת (sort) ולכן אני מתחיל את הקוד בשורת הערה שמראה איך אפשר לפתור את ה"תרגיל" בשורה אחת. אבל זו לא הפואנטה; הפעם אני רוצה להסביר איך נראות לולאות "קונבנציונליות" ברובי ולכן אני בוחר לממש שיטת מיון פשוטה במיוחד: מיון הכנסה. בשיטה הזו אני שולף איברים באופן סדרתי מהמערך שאני רוצה למיין, ודוחף אותם לרשימה חדשה, כאשר כדי לדעת איפה לשים כל איבר ברשימה החדשה אני עובר עליה עד שאני מגיע לאיבר הראשון ברשימה החדשה שהאיבר שלי גדול ממנו, ומכניס אותו שם (או בסוף הרשימה). שימו לב שאני משמיד את הרשימה הישנה תוך כדי כך.</p>
<p>הנה הקוד:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="c1"># puts &quot;After sorting the list #{ARGV.join(&quot;, &quot;)} we get #{ARGV.collect{|x| x.to_i}.sort.join(&quot;, &quot;)}&quot;</span>
<span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">ARGV</span><span class="o">.</span><span class="n">collect</span><span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">to_i</span><span class="p">}</span>
<span class="n">sorted_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[]</span>
<span class="k">while</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="n">empty?</span>
<span class="w">  </span><span class="n">current_element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="n">pop</span>
<span class="w">  </span><span class="n">current_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="n">current_index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sorted_list</span><span class="o">.</span><span class="n">length</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">sorted_list</span><span class="o">[</span><span class="n">current_index</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current_element</span>
<span class="w">    </span><span class="n">current_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">sorted_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">current_index</span><span class="p">,</span><span class="w"> </span><span class="n">current_element</span><span class="p">)</span>
<span class="k">end</span>
<span class="nb">puts</span><span class="w"> </span><span class="s2">&quot;After sorting the list </span><span class="si">#{</span><span class="no">ARGV</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span><span class="si">}</span><span class="s2"> we get </span><span class="si">#{</span><span class="n">sorted_list</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>


</div>

<p>מה קורה פה? בשורה 2 אנחנו ממירים את הרשימה לרשימה של מספרים. בשורה 3 אנחנו מגדירים רשימה חדשה, ריקה, שתכיל את התוצאה הממוינת. בשורה 4 אנחנו כותבים while ולאחר מכן תנאי - זוהי תמיד ההתחלה של לולאת while. לאחר ה-while מופיע בלוק שמסתיים ב-end שבשורה 11, והרעיון ב-while הוא שכל עוד התנאי שנכתב בו מתקיים, כאשר הבלוק מגיע לסופו הוא ישוב להתחלה. ייתכן שהתנאי לא יתקיים אפילו בפעם הראשונה שבה אנחנו מגיעים ללולאה ואז הבלוק שלה פשוט לא יופעל.</p>
<p>התנאי במקרה שלנו הוא שהרשימה שקלטנו היא ריקה. אפשר לבדוק שהיא ריקה על ידי בדיקה שאורכה הוא 0, אבל לצורכי קריאות רובי מספקת לנו פונקציה שעושה את זה בשבילנו - הפונקציה ?empty. שימו לב - סימן השאלה הוא חלק מהשם של הפונקציה, ואם לא נכתוב אותו, הפונקציה לא תפעל. זו אחת מהמוזריות של רובי שאני מחבב והרבה אנשים שונאים לפיה אפשר להשתמש בסימני שאלה וקריאה בסוף שמות של פונקציות (המוסכמה היא שסימני שאלה משמשים לציין פונקציות שמבצעות בדיקה ומחזירות ערך בוליאני ואילו סימני קריאה משמשים לציון פונקציה עם פעולה "הרסנית", אבל אין חוקים קשיחים שמגבילים מתי אפשר ומתי אי אפשר להשתמש בהם).</p>
<p>בשורה 5 אנחנו מוציאים איבר מסוף הרשימה ומכניסים אותו למשתנה current_element. השם pop מגיע מהשמות הרגילים לפעולה על מבנה הנתונים <strong>מחסנית</strong> (יש גם פקודת push תואמת). בשורה 6 אנחנו מתחילים את הנסיון למצוא לאן ברשימה החדשה לדחוף את current_element; ברירת המחדל שלנו היא התא שבאינדקס 0. כעת, בשורה 7 אנחנו מתחילים לולאת while חדשה <strong>בתוך</strong> הלולאה הקיימת (קוראים לזה "קינון" לולאות), שמגדילה את האינדקס שלנו כל עוד הוא אינו מצביע אל מעבר לסוף הרשימה הנוכחית וכל עוד האיבר שהוא מצביע עליו גדול מהאיבר שאנחנו רוצים לדחוף לרשימה. לבסוף, כשאנחנו סגורים על האינדקס שלנו, בשורה 10 אנחנו דוחפים את האיבר החדש לרשימה עם הפקודה insert שמקבלת שני פרמטרים: הראשון אומר איפה לדחוף את האיבר החדש, והשני הוא האיבר עצמו. ייתכן שאתם תוהים מה יקרה אם בתור המקום לדחוף אליו את האיבר החדש אני אתן מספר גדול הרבה יותר מאורך הרשימה. למשל, מה קורה אם אני דוחף איבר חדש למקום 10 ברשימה שיש בה רק 4 איברים? התשובה היא שבמקום 10 ברשימה (שמתאים לאיבר ה-11 בה; זכרו שהאינדוקס מתחיל מ-0) יידחף האיבר החדש, ובמקומות החל מ-4 ועד 9 יידחף nil, שמציין תא ריק (בשפות אחרות הייתה עלולה להתרחש שגיאה תחת זאת).</p>
<p>ובכן, זה מימוש סטנדרטי של אלגוריתם סטנדרטי ולא יעיל במיוחד, אבל צריך להראות איך משתמשים ברובי ב-while מתישהו. בואו נעבור לדבר על הסקל, שהיא משמעותית הרבה יותר כיפית כאן. בפרט, הפתרון שאני רוצה להראות הוא אחד מהדברים הראשונים שנהוג להראות לאנשים כשמנסים להמיר את דתם להסקל - מימוש של <strong>מיון מהיר</strong>.</p>
<p>מיון מהיר כשמו כן הוא - אלגוריתם מיון עם ביצועים מאוד טובים בפועל, ורעיון שהוא די פשוט להבנה - ובהסקל, גם למימוש. הרעיון הוא כזה: בהינתן רשימה, בואו ניקח את האיבר הראשון שלה ונקרא לו "איבר ציר" ועכשיו ניצור שתי תת-רשימות: אחת של  כל האיברים שקטנים מאיבר הציר, והשניה של כל האיברים שגדולים מאיבר הציר. נמיין כל אחת מהרשימות בנפרד, ואז נרכיב את שתיהן חזרה לרשימה אחת, כשבין האיברים של רשימת "האיברים הקטנים" והאיברים של רשימת "האיברים הגדולים" אנחנו דוחפים את איבר הציר עצמו.</p>
<p>אבל רגע, איך זה פותר את הבעיה? צריך עדיין למיין את שתי הרשימות הקטנות יותר! ובכן, פשוט נפעיל גם עליהן את מיון מהיר! כלומר, יש לנו כאן פונקציה ש<strong>מפעילה את עצמה</strong>. להפעלה עצמית כזו קוראים <strong>רקורסיה</strong> והיא מושג חשוב מאין כמותו בתכנות. הרעיון שמאחורי הרקורסיה כאן הוא שההפעלה העצמית הזו לא אמורה להימשך לנצח - בכל פעם אלגוריתם המיון מופעל על רשימות קטנות יותר ויותר, עד שבסוף הוא יקבל רשימה ריקה ואז אין מה למיין - פשוט מחזירים אותה כמות שהיא.</p>
<p>הנה איך כל זה נראה בהסקל:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="kr">import</span><span class="w"> </span><span class="nn">System.Environment</span>

<span class="nf">toIntArray</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Int</span><span class="p">]</span>
<span class="nf">toIntArray</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">[</span><span class="n">read</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">array</span><span class="p">]</span>

<span class="nf">quickSort</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Ord</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="nf">quickSort</span><span class="w"> </span><span class="kt">[]</span><span class="w">        </span><span class="ow">=</span><span class="w"> </span><span class="kt">[]</span>
<span class="nf">quickSort</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="kt">:</span><span class="n">xs</span><span class="p">)</span><span class="w">    </span><span class="ow">=</span><span class="w"> </span><span class="n">quickSort</span><span class="w"> </span><span class="n">smaller</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">quickSort</span><span class="w"> </span><span class="n">larger</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">smaller</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>
<span class="w">    </span><span class="n">larger</span><span class="w">  </span><span class="ow">=</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>

<span class="nf">main</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">args</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">getArgs</span>
<span class="w">  </span><span class="n">putStrLn</span><span class="w"> </span><span class="p">(</span><span class="n">show</span><span class="p">(</span><span class="n">quickSort</span><span class="p">(</span><span class="n">toIntArray</span><span class="w"> </span><span class="n">args</span><span class="p">)))</span>
</code></pre></div>


</div>

<p>המיון עצמו הוא בשורות 6-11. ראשית, אני מגדיר את quickSort באופן גנרי, שיוכל לפעול על כל רשימה של איברים מטיפוס שניתן להשוות אותו (אגב, ברובי לא שמים לב לכך אבל גם שם זה מתקיים). זו המשמעות של ה-" &lt;= Ord a"  שכתוב בהגדרת הפונקציה. בשורה 7 אני מגדיר שעל רשימה ריקה, quickSort יחזיר רשימה ריקה. בשורה 8 מגיע האקשן: אני מפרק את הרשימה לאיבר ראשון x ולכל יתר האיקסים, xs (נסו לקרוא את זה בקול!) ואז משרשר את המיון המהיר של smaller עם הרשימה שהאיבר היחיד שלה הוא איבר הציר x, עם המיון המהיר של larger. אבל מי הם smaller, larger? הם מוגדרים אחרי ה-where, באמצעות list comprehensions שראינו כבר בפוסט הקודם, כשכאן יש גם <strong>התניה</strong>, שמופיעה בצד ימין אחרי הפסיק.</p>
<p>מה שכל כך נחמד במימוש הזה הוא הקריאות שלו - הקוד כתוב בערך כמו שנראה תיאור מתמטי פורמלי של "מה האלגוריתם עושה". שימו לב - לא <strong>איך</strong> האלגוריתם עושה את זה, אלא מה הרעיון הכללי של האלגוריתם. במקרה הנוכחי זה כבר מספיק. בשפות אחרות, המימוש של מיון מהיר הוא עדיין פשוט יחסית, אבל קריא וברור הרבה פחות.</p>
<p>הדילמה עכשיו היא מה להראות בג'אווהסקריפט. כבר הראיתי מימוש של אלגוריתם נאיבי ברובי כדי להסביר איך לולאות עובדות, וכבר הראיתי מימוש מגניב של אלגוריתם מגניב בהסקל. בג'אווהסקריפט החלטתי להשתמש בפונקציית המיון שמובנית בשפה, אבל באופן לא טריוויאלי, כדי שנבין עד כמה חזקה הגישה של שפה מודרנית למושג המיון. הרעיון היא שבהינתן מערך של איברים, אין הכרח למיין אותו מהקטן לגדול על פי איזה סדר "טבעי" שקיים בין האיברים; תחת זאת, פונקציית המיון יכולה לקבל כקלט <strong>פונקציה</strong> שתפקידה הוא להשוות בין שני איברים ולהחליט מי מהם קטן ומי מהם גדול יותר. מקובל שהפונקציה הזו תקבל שלושה ערכים ותחזיר מספר שלם, שהוא קטן מאפס אם הערך הראשון "קטן" מהשני, אפס אם הם "זהים" (כלומר, פונקצית המיון שלנו לא רוצה לתעדף אף אחד על פני השני) וגדול מאפס אם הערך הראשון "גדול" מהשני. זה מאפשר לנו למיין דברים בצורות שונות ומשונות על פי מה שנוח לנו בזה הרגע.</p>
<p>מה קורה מאחורי הקלעים? מופעל אלגוריתם מיון רגיל לחלוטין שמבוסס על השוואות, כדוגמת מיון מהיר, אבל בכל פעם שבה צריך לבצע השוואה, קוראים לפונקציית ההשוואה שסופקה על ידי המשתמש. כמובן שגם ברובי ובהסקל אפשר לעשות דברים כאלו ועוד נראה זאת בהמשך.</p>
<p>מה שאני עושה בקוד הג'אווהסקריפט הנוכחי הוא לקבל מספרים טבעיים ולמיין אותם על פי הנורמה ה-2-אדית שלהם. מה זו למען השם נורמה 2-אדית? יש לי <a href="http://www.gadial.net/2010/01/12/padic_numbers_analytic_constructions/">פוסט בנושא</a>, אבל זה לא ממש חשוב כרגע מאיפה ההגדרה המוזרה הזו מגיעה - אני לוקח אותה בכוונה בגלל שהיא מוזרה. ההגדרה אומרת כך: הנורמה ה-2-אדית של מספר טבעי היא אחד חלקי החזקה הגבוהה ביותר של 2 שמחלקת את המספר. למשל, עבור 14, החזקה הגבוהה ביותר של 2 שמחלקת את 14 היא 2 עצמה (2 בחזקת 1) ולכן הנורמה שלו תהיה חצי; אבל עבור 28, החזקה הגבוהה ביותר של 2 שמחלקת את 28 היא 4 (2 בחזקת 2) ולכן הנורמה שלו תהיה רבע, וכן הלאה (שימו לב: אני מחלק בשתיים בחזקת משהו; אני לא מחלק רק ב"משהו").</p>
<p>הנה הקוד:</p>
<div class="code-block">

<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Targil 9<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="p">&gt;</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">norm_2_adic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">){</span>
<span class="w">        </span><span class="nx">a</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="w">        </span><span class="nx">norm</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">norm</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">    </span><span class="nx">sort_by_2_adic_norm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">nums</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;nums&quot;</span><span class="p">).</span><span class="nx">value</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">nums</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">norm_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">norm_2_adic</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">norm_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">norm_2_adic</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">b</span><span class="p">));</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">norm_a</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">norm_b</span><span class="p">){</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">norm_a</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">norm_b</span><span class="p">){</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;sorted&quot;</span><span class="p">).</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">nums</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  List = <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;textbox&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;nums&quot;</span> <span class="na">value </span><span class="o">=</span> <span class="s">&quot;0&quot;</span> <span class="na">onkeyup </span><span class="o">=</span> <span class="s">&quot;sort_by_2_adic_norm()&quot;</span><span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">br</span> <span class="p">/&gt;</span>
  Sorted = <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;textbox&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;sorted&quot;</span> <span class="na">value </span><span class="o">=</span> <span class="s">&quot;0&quot;</span><span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>


</div>

<p>שימו לב לשיקוץ אחד שאני עושה כאן - אני מגדיר את הפונקציה ש-sort מקבלת <strong>בתוך</strong> הקריאה ל-sort. זה לא הכרחי - יכלתי להגדיר את הפונקציה הזו גם בחוץ, אבל אז הייתי צריך לתת לה שם, וזה לעתים קרובות סתם מסורבל. כאן הפונקציה היא <strong>אנונימית</strong> - מקבלים אותה ואפשר להשתמש בה, אבל כשאני כותב אותה אני לא צריך לטרוח לתת לה שם במיוחד. בשפות כמו רובי קל מאוד לכתוב פונקציות כאלו בצורה קומפקטית ומנגנון הבלוקים הופך את העסק לאלגנטי יחסית ועוד נראה זאת בהמשך; בג'אווהסקריפט, לטעמי, זה נראה פשוט איום ונורא. אבל עושים את זה כל הזמן. גם אני.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>