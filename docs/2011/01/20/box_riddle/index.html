<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>חידת קופסאות - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <meta name="description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://gadial.net/2011/01/20/box_riddle/">
    <meta property="og:title" content="חידת קופסאות">
    <meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב">
    <meta property="og:site_name" content="לא מדויק">
    

<meta property="og:image" content="http://gadial.net/img/main/default-card.png" />


        
    <!-- Twitter -->
    

<meta name="twitter:card" content="summary">


    <meta name="twitter:url" content="https://gadial.net/2011/01/20/box_riddle/">
    <meta name="twitter:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב">
    <meta name="twitter:site" content="@" />
    <meta property="twitter:title" content="חידת קופסאות">
    

<meta property="twitter:image" content="http://gadial.net/img/main/default-card.png" />


    
    <!-- RSS Feed -->
    <link rel="alternate" type="application/rss+xml" title="לא מדויק - RSS Feed" href="/feed.xml">
       
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <link rel="stylesheet" href="/css/main.css">

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Hamburger menu button */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.8em;
            color: white;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .menu-toggle:hover {
            opacity: 0.8;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .top-nav .nav-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .top-nav .site-title {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0;
                padding: 10px 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            /* Hide nav links by default on mobile */
            .top-nav .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                margin-top: 10px;
            }
            
            /* Show when expanded */
            .top-nav .nav-links.expanded {
                display: flex;
            }
            
            .top-nav .nav-links > a {
                text-align: center;
                padding: 12px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box {
                width: 100%;
                flex-direction: column;
                margin-top: 10px;
                padding-top: 10px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box input {
                width: 100%;
                margin-bottom: 5px;
                min-width: 0;
            }
            
            .top-nav .search-box button {
                width: 100%;
            }
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <div class="site-title">
                <a href="/" style="color: white; text-decoration: none;">לא מדויק</a>
                <button class="menu-toggle" onclick="toggleMobileMenu()" aria-label="תפריט">
                    ☰
                </button>
            </div>
            <div class="nav-links" id="navLinks">
                <a href="/">דף הבית</a>
                <a href="/random.html">פוסט אקראי</a>
                <a href="/post_list.html">כל הפוסטים</a>
                <a href="/categories/">קטגוריות</a>
                <a href="/lecture_notes.html">סיכומי הרצאות</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/2011/01/18/what_are_boolean_circuits/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">מעגלים בוליאניים - מה זה בכלל?</span>
            </a>
            

            
            <a href="/2011/01/23/branching_programs_and_barrington_theorem/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">תוכניות מתפצלות ומשפט ברינגטון</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>חידת קופסאות</h1>
            <div class="post-meta">
                <span class="date">2011-01-20</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/משחקים וחידות מתמטיות.html">משחקים וחידות מתמטיות</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/חידות.html">חידות</a>
                    
                    <a href="/tags/פשטות היא תחכום.html">פשטות היא תחכום</a>
                    
                    <a href="/tags/תמורות.html">תמורות</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <p>נתקלתי היום בחידה מקסימה ביותר - כנראה אחת מהחידות שהכי נהניתי מלפתור - ואני רוצה לשתף בה את הבלוג. הרעיון פשוט יחסית: יש חדר עם 100 קופסאות, ובכל קופסה יש פתק עם מספר מ-1 עד 100, כך שכל מספר מופיע בדיוק פעם אחת באחת מהקופסאות (במילים אחרות, יש לנו <strong>תמורה</strong> על המספרים מ-1 עד 100). לחדר נכנסת אליס, מביטה בפתקים שבכל הקופסאות, ואם מתחשק לה - מחליפה בין שני פתקים. רק החלפה אחת - לא מותר לה לעשות יותר מכך. יוצאת מהחדר, ונכנס בוב. עם היכנסו של בוב לחדר נותנים לו מספר בין 1 ל-100 ותובעים ממנו שימצא את הקופסה שבה המספר נמצא. המלכוד: מותר לו לפתוח רק 50 קופסאות (אבל מותר לו לעשות את זה באופן סדרתי, כשהוא מחליט מה הקופסה הבאה שהוא רוצה לפתוח על פי מה שהוא ראה עד כה).</p>
<p>מן הסתם שורש העניין נעוץ באיזו שיטת פעולה שעליה אליס ובוב הסכימו מראש - השיטה שעל פיה אליס החליטה אם ואיך להחליף את הפתקים היא משהו שהיא הסכימה עליו מראש עם בוב. עם זאת, מרגע שהמשחק התחיל אין ביניהם שום תקשורת - אליס לא יכולה לומר לבוב מה נמצא באיזו קופסה, ובוב בוודאי לא יכול להגיד לאליס איזה מספר יבקשו ממנו למצוא כי הוא עוד לא יודע את זה בזמן שאליס נכנסת לחדר (ולמעשה, חבר השופטים יכול לראות איזו החלפה אליס ביצעה ולבחור בכוונה מספר "גרוע" אם מתחשק לו).</p>
<p>אם כן, השאלה היא - מה תהיה שיטת הפעולה של אליס ובוב בעניין?</p>
<p>קחו זמן לחשוב על זה. אני ממליץ מאוד לקחת הרבה זמן - זו חידה יפה וחבל לקלקל אותה מראש על ידי קריאת הפתרון. היא פתירה, תסמכו עלי. בינתיים, בידור:</p>
<p><strong><img class="alignnone" title="Tree" src="http://imgs.xkcd.com/comics/tree.png" alt="" width="562" height="408" /><br />
</strong></p>
<p>טוב, אז מה הפתרון? כרגיל בעניינים הללו, לתת את הפתרון מייד זו "לא חוכמה" במובן זה שהפתרון לא משקף את כל המחשבה והכיוונים הכושלים שבהם ניסיתי לפתור את החידה, וההבנה ההולכת ומשתפרת לאט של מה שהולך שם. להציג את הפתרון וחסל זה מין קסם שכזה, אבל אין ממש מנוס ממנו. רק אגיד שהרעיון הראשון שלי לפתרון היה אחר לגמרי - חשבתי שאולי אליס תבחר את אחד מהמספרים ותשים אותו בקופסה הראשונה, ובוב ראשית כל יפתח את הקופסה הראשונה, יקרא את המספר ויסיק ממנו מידע על הרכב שאר הקופסאות. האתגר פה, כמובן, הוא שהמידע צריך לעזור באופן "גלובלי" - לכל שאלה שעשוים לשאול את בוב. ובכן, הכיוון הזה הוא מבוי סתום - אם משחקים עם זה קצת (בעיקר עבור מקרים פשוטים כמו 4 קופסאות) מתחוור מהר מאוד שאי אפשר לספק מספיק מידע לבוב רק עם הפתק הבודד הזה. לכן ויתרתי בהדרגה על הרעיון שאליס תעביר לבוב מידע כלשהו, או שבוב יצליח להבין פחות-או-יותר איך התמורה שהוא תוקף נראית. במקום זה התחלתי לחשוב על הדרכים שבהן בוב יוכל לגלות את המספר "על עיוור". אולי יש לו שיטת חיפוש כלשהי שמצליחה בדרך כלל לא רע, ואליס תוכל לעזור עם ההחלפה הבודדת שלה ולהבטיח שהשיטה תעבוד תמיד לא רע? זה גם בדיוק מה שקורה בסופו של דבר.</p>
<p>שיטת חיפוש אחת שבוב יכול לנקוט בה הוא פשוט לפתוח קופסאות באופן אקראי. טוב, זה לא יוביל לכלום מן הסתם. הוא גם יכול לפתוח קופסאות באופן סדרתי - 1,2,3 וכן הלאה. גם זה, די בבירור, לא יוביל לכלום. השיטה הבאה בתור נראתה לי טבעית ביותר, אם כי אולי לא תסכימו איתי. הרעיון הוא לטייל בתוך המעגלים הזרים שמרכיבים את התמורה. מה זה אומר בפועל? פשוט מאוד. נניח שאומרים לבוב לחפש את המספר 2. הוא יפתח את קופסה מס' 2. אם 2 שם, יופי. אחרת יש שם מספר אחר, נניח 33. כעת בוב יפתח את קופסה 33. אם 2 שם, יופי. אחרת יש שם מספר אחר - נניח, 13. אז בוב יפתח את קופסה 13... הבנתם את העיקרון.</p>
<p>נוצר לנו מסלול שאפשר לתאר בערך כך: <span class="math">\(2\to33\to13\to\dots\)</span>. מתי מסלול כזה יכול להסתיים? רק כשבוב מגיע למספר של קופסה שכבר הופיע בעבר. אני טוען שהמספר הזה <strong>חייב</strong> להיות 2. למה? ובכן, נניח שזה מספר אחר, נניח 33. אז זה אומר שבוב פתח קופסה שבה היה כתוב המספר 33 - אבל הוא כבר עשה את זה קודם, בהתחלה, כשפתח את קופסה מספר 2! ומכיוון ש-33 לא מופיע פעמיים בקופסאות, לא ייתכן שבוב נתקל בו שוב לפני שנתקל ב-2. לכן בוב מגיע בסופו של דבר ל-2, אבל השאלה היא - כמה מהר?</p>
<p>לרוע המזל, ייתכן שהוא מגיע לשם לאט מאוד - ייתכן שהוא עובר על פני כל שאר הקופסאות עד שהוא מגיע ל-2. אלא שכאן אליס נחלצת לעזרתו. אליס פותחת את כל הקופסאות ולכן יודעת בדיוק מהם כל המעגלים שמרכיבים את התמורה. אם יש מעגל ארוך - שאורכו גדול מ-50 - אז אליס תבצע החלפה כדי לפצל אותו ל-2. אחרת, אליס לא תעשה כלום. בכל מקרה אחרי שאליס מסיימת כל המעגלים שמרכיבים את התמורה הם מגודל לכל היותר 50, ולכן טיול כמו שבוב מבצע בהם יסתיים תוך 50 בדיקות לכל היותר, וחסל. אם כן, מה שבוב עושה הוא פשוט: אם אמרו לו לחפש את המספר ה-<span class="math">\(k\)</span>, הוא פשוט פותח את הקופסה ה-<span class="math">\(k\)</span>-ית ומשם הוא ממשיך על פי המספר שהוא מצא בתוך הקופסה שפתח. המעגל יסתיים בדיוק כשבוב ימצא את המספר המבוקש.</p>
<p>נשאר רק להסביר איך אליס מבצעת את הפיצול, אבל זה פשוט. נניח שיש לנו מעגל <span class="math">\(1\to2\to3\to\dots\to n\to n+1\to\dots\to2n\to1\)</span> (המספרים מסודרים בסדר עולה לצורך פשטות). אז אורך המעגל הוא <span class="math">\(2n\)</span> ואנו רוצים לפצל אותו ל-2 מעגלים שונים מאורך <span class="math">\(n\)</span> כל אחד. כרגע הסיטואציה היא כזו שבקופסה מס' <span class="math">\(2n\)</span> יש את הפתק <span class="math">\(1\)</span>, ובקופסה מס' <span class="math">\(n\)</span> יש את הפתק <span class="math">\(n+1\)</span>. אליס פשוט תחליף את שני הפתקים הללו. התוצאה? המעגל <span class="math">\(1\to2\to3\to\dots\to n\to1\)</span> (כי בקופסה <span class="math">\(n\)</span> נמצא כעת המספר 1) והמעגל <span class="math">\(n+1\to\dots\to2n\to n+1\)</span> (כי בקופסה מס' <span class="math">\(2n\)</span> נמצא כעת הפתק <span class="math">\(n+1\)</span>). באופן הזה אליס מסוגלת לפצל כל מעגל גדול לשני מעגלים קטנים יחסית, וזה כבר באמת סוף הפתרון.</p>
<p>לטעמי זו חידה נהדרת - יש בה את מרכיב התעלומה, של איך ניתן לבצע משהו שהתחושה הראשונית היא שהוא בלתי אפשרי בכלל, ויש בו את הפתרון האלגנטי והקצר, שנראה ממש כמו קסם. אני מקווה שגם אתם נהנתם.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('expanded');
        }
        
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>