<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>משפט המטריצה-עץ של קירכהוף - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/new_blog/favicon.ico">
    
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <a href="/new_blog/" class="site-title">לא מדויק</a>
            <div class="nav-links">
                <a href="/new_blog/">דף הבית</a>
                <a href="/new_blog/random.html">פוסט אקראי</a>
                <a href="/new_blog/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/new_blog/2011/09/12/euclidean_algorithm_and_rings/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">האלגוריתם האוקלידי וחוגים אוקלידיים</span>
            </a>
            

            
            <a href="/new_blog/2011/09/21/linear_algebra_overview/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">אז מה זו אלגברה לינארית?</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>משפט המטריצה-עץ של קירכהוף</h1>
            <div class="post-meta">
                <span class="date">2011-09-13</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/אלגברה לינארית.html">אלגברה לינארית</a>
                    
                    <a href="/categories/תורת הגרפים.html">תורת הגרפים</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/אלגברה לינארית.html">אלגברה לינארית</a>
                    
                    <a href="/tags/גם טכני זה כיף!.html">גם טכני זה כיף!</a>
                    
                    <a href="/tags/הוכחות יפות.html">הוכחות יפות</a>
                    
                    <a href="/tags/משפט קירכהוף.html">משפט קירכהוף</a>
                    
                    <a href="/tags/תורת הגרפים האלגברית.html">תורת הגרפים האלגברית</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <p>אני רוצה לדבר הפעם על מה שלטעמי הוא משפט יפהפה ביותר, גם בשל מה שהוא אומר וגם בשל ההוכחה שלו, שלטעמי מייצגת את כל מה שטוב במתמטיקה - גם דורשת הבנה טכנית לא טריוויאלית, וגם מכילה תובנה עמוקה שמאפשרת לראות מדוע המשפט נכון. העולם מסכים איתי, וההוכחה הזו מככבת בספר "Proofs from THE BOOK"; אני מקווה שכל מי שיתאמץ יצליח להבין אותה וליהנות כמוני ממנה.</p>
<p>המשפט מכונה בשם Matrix-tree theorem, או משפט קירכהוף (קירכהוף לא בדיוק הוכיח אותו אבל במאמר שלו המשפט מופיע באופן מובלע). כדי להגיע ישר לעניין ללא הקדמה ארוכה לא אציג מחדש את מושגי הבסיס שבהם עוסק המשפט; כדי להבין את הניסוח (וההוכחה) של המשפט יהיה צורך להכיר את מושגי הבסיס של גרף, עץ, מטריצה ודטרמיננטה. כולם מושגים פשוטים ומרכזיים במתמטיקה ואני ממליץ לקוראים שטרם שמעו עליהם ללכת ולקרוא ספרים בסיסיים בקומבינטוריקה ובאלגברה לינארית כי הם מפספסים עולמות נפלאים שלמים.</p>
<p>ראשית אציג גרסה של המשפט שעוסקת בגרפים לא מכוונים כי ההוכחה שלו פשוטה מעט יותר; לאחר מכן אסביר כיצד ניתן להוכיח את המשפט גם לגרפים מכוונים (באותה הצורה אבל עם תיקונים קלים). המשפט בא לענות על השאלה הקומבינטורית הבאה: בהינתן גרף סופי <span class="math">\(G=\left(V,E\right)\)</span>, כמה עצים פורשים יש לו? כזכור, עץ פורש של <span class="math">\(G\)</span> הוא תת-קבוצה של הקשתות שמהווה עץ (כלומר, כשמורידים מ-<span class="math">\(G\)</span> את כל הקשתות שאינן בתת-הקבוצה נשארים עם גרף קשיר וחסר מעגלים). עובדה אחת שאתם אולי לא זוכרים והיא רלוונטית כאן היא שבגרף עם <span class="math">\(n=\left|V\right|\)</span> צמתים, כל עץ הוא בעל בדיוק <span class="math">\(n-1\)</span> קשתות (נסו להוכיח זאת לעצמכם!)</p>
<p>משפט קירכהוף אומר שבהינתן <span class="math">\(G\)</span> כזה, מספר העצים הפורשים שלו הוא בדיוק הדטרמיננטה של מטריצה פשוטה מסויימת שמוגדרת באמצעות <span class="math">\(G\)</span>. זה נשמע מאוד מאוד מפתיע ממבט ראשון - מה לדטרמיננטים ולספירת עצים פורשים? ובכן, אני מודה שגם אחרי שאני מכיר את הוכחת המשפט ומבין בדיוק למה הוא עובד, זה עדיין מפתיע אותי.</p>
<p>בואו נכניס מטריצות לתמונה. יש כמה וכמה מטריצות שאפשר להתאים לכל גרף <span class="math">\(G\)</span>, ואחת מהן היא <strong>מטריצת הלפלסיאן</strong> <span class="math">\(L_{G}\)</span> (ובקיצור אכתוב סתם <span class="math">\(L\)</span>). ההגדרה של <span class="math">\(L\)</span> אולי תיראה קצת מוזרה במבט ראשון אבל היא שימושית; למשל, עבור משפט קירכהוף.</p>
<p>ראשית, מכיוון שמטריצות מאונדקסות בדרך כלל עם מספרים טבעיים, הבה ונאנדקס גם את הגרף עם מספרים כאלו: <span class="math">\(V=\left\{ v_{1},\dots,v_{n}\right\} \)</span> ו-<span class="math">\(E=\left\{ e_{1},\dots,e_{m}\right\} \)</span>. בדרך כלל כשאתייחס לצומת זה יהיה עם אינדקס <span class="math">\(i\)</span> או <span class="math">\(j\)</span>, ולקשת עם אינדקס <span class="math">\(k\)</span>.</p>
<p>כעת אנו מוכנים להגדיר את <span class="math">\(L\)</span>: ראשית, <span class="math">\(L_{ii}=d\left(v_{i}\right)\)</span>, כלומר הכניסה ה-<span class="math">\(i\)</span> על האלכסון של <span class="math">\(L\)</span> היא פשוט הדרגה של <span class="math">\(v_{i}\)</span> - מספר הקשתות שמחוברות ל-<span class="math">\(v_{i}\)</span>. כעת, לכל <span class="math">\(i\ne j\)</span> נגדיר את <span class="math">\(L_{ij}\)</span> להיות מינוס מספר הקשתות בין <span class="math">\(v_{i}\)</span>ל-<span class="math">\(v_{j}\)</span> (בדרך כלל יש רק קשת אחת בין כל שני צמתים בגרף, אבל כאן אנחנו מרשים יותר; כמובן שככל שיש יותר קשתות יהיו יותר עצים פורשים). אם נסמן את המספר הזה בסימון שהמצאתי כרגע, <span class="math">\(d\left(v_{i},v_{j}\right)\)</span> ונסכים ש-<span class="math">\(d\left(v_{i},v_{i}\right)\)</span> הוא פשוט דרגת <span class="math">\(v_{i}\)</span> (במקום מספר הקשתות מ-<span class="math">\(v_{i}\)</span> לעצמו), הרי שאפשר לכתוב את הלפלסיאן כך: <span class="math">\(L_{ij}=d\left(v_{i},v_{j}\right)\)</span>.</p>
<p>בשלב הזה צריך להראות דוגמה כדי להבין מה קורה פה. אני אנקוט בגישה שונה - <strong>אתם</strong> תציירו לעצמכם דוגמה, כי זה הרבה יותר אפקטיבי מלקרוא דוגמה שמישהו אחר כתב (וכי אני עצלן), ואני אשב בצד ואחכה שתסיימו.</p>
<p>הגדרת הלפלסיאן עבור גרפים מכוונים כמעט זהה, בשני שינויים קלים: ראשית, <span class="math">\(L_{ii}\)</span> הוא <strong>דרגת הכניסה</strong> של <span class="math">\(v_{i}\)</span> - מספר הקשתות שנכנסות אליו - ולא הדרגה הכוללת; שנית, <span class="math">\(L_{ij}\)</span> הוא מינוס מספר הקשתות מ-<span class="math">\(v_{i}\)</span> <strong>אל</strong> <span class="math">\(v_{j}\)</span> (כלומר, קשתות מ-<span class="math">\(v_{j}\)</span> אל <span class="math">\(v_{i}\)</span> לא נספרות ב-<span class="math">\(L_{ij}\)</span>, אם כי הן כן ייספרו ב-<span class="math">\(L_{ji}\)</span>). לא קשה לראות שההגדרה הזו מכלילה את ההגדרה לגרפים לא מכוונים אם נוקטים בתעלול הרגיל של לייצג גרף לא מכוון על ידי גרף מכוון שבו לכל זוג צמתים שיש ביניהם קשת בגרף הלא מכוון, היא מוחלפת בקשת לכל אחד משני הכיוונים בגרף המכוון.</p>
<p>כעת, יהא <span class="math">\(r\)</span> אינדקס של צומת כלשהו בגרף, ונסמן ב-<span class="math">\(L^{\left(r\right)}\)</span> את <strong>מטריצת המינור</strong> ה-<span class="math">\(r\)</span>-ית של <span class="math">\(L\)</span> - המטריצה שמתקבלת מ-<span class="math">\(L\)</span> על ידי מחיקת השורה והעמודה ה-<span class="math">\(r\)</span>-יות. אז הנה משפט קירכהוף, בגרסה שנכונה הן לגרפים מכוונים והן לגרפים לא מכוונים:</p>
<p>מספר העצים הפורשים של הגרף <span class="math">\(G\)</span> שהשורש שלהם הוא <span class="math">\(v_{r}\)</span> הוא <span class="math">\(\det L^{\left(r\right)}\)</span>.</p>
<p>(בגרף לא מכוון אין ממש משמעות ל"שורש" ולכן כדי למצוא את מספר העצים הפורשים אפשר לבחור <span class="math">\(r\)</span> שרירותי; בגרף מכוון שורש הוא הצומת היחיד בעץ שקיים מסלול ממנו אל שאר הצמתים בגרף).</p>
<p>שימו לב שעניין המינור הכרחי: לא קשה לראות ש-<span class="math">\(\det L=0\)</span> תמיד כי סכום כל עמודה במטריצה הוא 0 ולכן שורות המטריצה תלויות לינארית. כמובן ש-<span class="math">\(L\)</span> מעניינת גם לכשעצמה - למשל, יש חשיבות גדולה לערך העצמי הבא החיובי הקטן ביותר שלה; אבל לא אכנס לכל זה כרגע.</p>
<p>איך מוכיחים את המשפט? אפשר לנסות לחשב ישירות את הדטרמיננטה על פי ההגדרה ולהבין מה הולך שם. זו הוכחה לגיטימית ולא מעט ספרים נוקטים בה. אני מעדיף להשתמש בגישה אחרת ששולפת עוד כמה שפנים מהכובע ובסוף מאפשרת להבין בדיוק מה קורה פה - גישה שמשתמשת בנוסחת קושי-בינה.</p>
<p>את קושי-בינה לא רואים בדרך כלל בקורס בסיסי באלגברה לינארית וקצת חבל. יש לה גם הוכחה קומבינטורית יפהפיה משל עצמה (גם היא ב-Proofs from THE BOOK) שלא אציג כרגע. בבסיסה, הנוסחה היא הכללה של נוסחה בסיסית שכן רואים באלגברה לינארית: אם <span class="math">\(A,B\)</span> הן מטריצות ריבועיות, אז <span class="math">\(\det\left(A\cdot B\right)=\det A\cdot\det B\)</span>.</p>
<p>העניין הוא בכך שמטריצות ריבועיות עשויות להתקבל גם כמכפלה של מטריצות לא ריבועיות: אם <span class="math">\(A\)</span> היא מטריצה <span class="math">\(n\times m\)</span> ו-<span class="math">\(B\)</span> היא מטריצה <span class="math">\(m\times n\)</span> אז מכפלתם <span class="math">\(AB\)</span> היא מטריצה <span class="math">\(n\times n\)</span>, ולכן אפשר לדבר על הדטרמיננטה שלה. מצד שני, <span class="math">\(A,B\)</span> אינן ריבועיות ולכן אין משמעות לדטרמינטטה שלהן. האם בכל זאת אפשר לעשות משהו?</p>
<p>אם <span class="math">\(m&amp;lt;n\)</span> אין על מה לדבר, אבל רק כי אז מובן מאליו ש-<span class="math">\(\det AB=0\)</span>. למה מובן מאליו? ובכן, זה תרגיל טוב באלגברה לינארית: אם <span class="math">\(m&amp;lt;n\)</span> אז דרגת <span class="math">\(A,B\)</span> היא לכל היותר <span class="math">\(m\)</span> כל אחד; ולכן דרגת המכפלה <span class="math">\(AB\)</span> גם היא לכל היותר <span class="math">\(m\)</span>, ולכן <span class="math">\(AB\)</span> היא מטריצה מדרגה לא מלאה ובהכרח הדטרמיננטה שלה היא 0.</p>
<p>מצד שני, אם <span class="math">\(m&amp;gt;n\)</span>, נוסחת קושי בינה נכנסת לפעולה. במילים מה שהולך כאן הוא הדבר הבא: <span class="math">\(A\)</span> היא מטריצה מלבנית, אבל היא מכילה הרבה תת-מטריצות ריבועיות <span class="math">\(n\times n\)</span>, שמתקבלות מבחירת תת-קבוצה של <span class="math">\(n\)</span> מתוך <span class="math">\(m\)</span> העמודות שלה. באותו האופן גם <span class="math">\(B\)</span> מכילה הרבה תת-מטריצות ריבועיות <span class="math">\(n\times n\)</span> שמתקבלות מבחירת תת-קבוצה של <span class="math">\(n\)</span> מתוך <span class="math">\(m\)</span> השורות שלה. אם נסמן ב-<span class="math">\(\sigma\)</span> בחירה מסויימת של <span class="math">\(n\)</span> מתוך <span class="math">\(m\)</span> אינדקסים, אז נוסחת קושי-בינה היא פשוט <span class="math">\(\det\left(AB\right)=\sum_{\sigma}\left(\det A_{\sigma}\cdot\det B_{\sigma}\right)\)</span>. כלומר: לכל בחירה אפשרית של <span class="math">\(n\)</span> מתוך <span class="math">\(m\)</span> אינדקסים <span class="math">\(\sigma\)</span> ניקח מתוך <span class="math">\(A\)</span> ו-<span class="math">\(B\)</span> את תת המטריצות המתאימות (שימו לב שזו <strong>אותה בחירת אינדקסים</strong> לשתי המטריצות! זה מה שחשוב פה), נחשב את מכפלת הדטרמיננטות שלהן, ונסכום את הכל (אם <span class="math">\(m&amp;lt;n\)</span> אז אפשר להסכים על כך שהסכום ריק ולכן שווה 0, ובכך לקבל נוסחה שתקפה לכל מקרה אפשרי).</p>
<p>איך נוסחת קושי-בינה מסייעת לנו כאן? ובכן, את הלפלסיאן קל למדי לכתוב כמכפלה של מטריצות. בואו נדבר לבינתיים על המקרה של גרף לא מכוון שהוא פשוט קצת יותר, ונגדיר מטריצה <span class="math">\(A\)</span> - "מטריצת החילה" (Incidence matrix) של הגרף. זו תהיה מטריצה <span class="math">\(n\times m\)</span> שבה כל שורה מייצגת צומת בגרף וכל עמודה מייצגת קשת בגרף, כך שלכל קשת <span class="math">\(e_{k}=\left(v_{i},v_{j}\right)\)</span> עם <span class="math">\(i&amp;lt;j\)</span> נקבע ש-<span class="math">\(A_{ik}=1,A_{jk}=-1\)</span> וכל כניסה אחרת במטריצה היא 0. במילים אחרות, כל עמודה במטריצה הזו מכילה בדיוק 1 בודד ו-<span class="math">\(-1\)</span> בודד, בשני הצמתים שמתאימים לקשת של אותה עמודה.</p>
<p>כעת זה תרגיל נחמד לבדוק שאכן <span class="math">\(L=A\cdot A^{T}\)</span> (כאן <span class="math">\(A^{T}\)</span> מייצג את השחלוף של <span class="math">\(A\)</span>: <span class="math">\(A_{ij}^{T}=A_{ji}\)</span>). ומהו <span class="math">\(L^{\left(r\right)}\)</span>? לא קשה לראות שהוא <span class="math">\(NN^{T}\)</span> כאשר <span class="math">\(N\)</span> מתקבלת מ-<span class="math">\(A\)</span> על ידי מחיקת השורה ה-<span class="math">\(r\)</span>. שימו לב שאנחנו לא מוחקים מ-<span class="math">\(A\)</span> עמודות; הקשתות שהיו מחוברות ל-<span class="math">\(v_{r}\)</span> עדיין מיוצגות ב-<span class="math">\(N\)</span>, אבל באופן "חלקי" - העמודה שלהן מכילה רק 1 או רק <span class="math">\(-1\)</span>. זו אולי הנקודה הקריטית ביותר בהמשך ההוכחה.</p>
<p>עכשיו, על פי קושי-בינה, <span class="math">\(\det\left(L^{\left(r\right)}\right)=\sum_{\sigma}\det N_{\sigma}\det N_{\sigma}^{T}=\sum_{\sigma}\det\left(N_{\sigma}\right)^{2}\)</span>. הצטמצמנו להבנה של מהו <span class="math">\(\det\left(N_{\sigma}\right)\)</span> לכל בחירה מתאימה של עמודות. שימו לב של-<span class="math">\(N\)</span> יש <span class="math">\(n-1\)</span> שורות (כי בגרף המקורי היו <span class="math">\(n\)</span> צמתים והסרנו את השורה של הצומת <span class="math">\(v_{r}\)</span> מהמטריצה <span class="math">\(A\)</span> כדי לקבל את <span class="math">\(N\)</span>), ולכן כל <span class="math">\(\sigma\)</span> היא בחירה של <span class="math">\(n-1\)</span> עמודות, כלומר של <span class="math">\(n-1\)</span> קשתות מהגרף המקורי. והנה לב ההוכחה, התובנה המרכזית בה, מה שהופך את הכל לברור לדעתי: אותה בחירה <span class="math">\(\sigma\)</span> של <span class="math">\(n-1\)</span> עמודות היא <strong>בדיקה שלנו האם מועמד כלשהו לתפקיד עץ פורש הוא אכן עץ פורש</strong>. הדטרמיננטה <span class="math">\(\det N_{\sigma}\)</span> תהיה בדיוק אבן הבוחן: אם <span class="math">\(\sigma\)</span> אכן מהווה בחירה של <span class="math">\(n-1\)</span> קשתות שיוצרות עץ פורש, נקבל ש-<span class="math">\(\det N_{\sigma}=\pm1\)</span>; ואחרת נקבל <span class="math">\(\det N_{\sigma}=0\)</span>. זה בבירור מסיים את ההוכחה שכן אז נקבל ש-<span class="math">\(\sum_{\sigma}\det\left(N_{\sigma}\right)^{2}\)</span> הוא בדיוק מספר ה-<span class="math">\(\sigma\)</span>-ות שעבורן קיבלנו עץ פורש, כלומר מספר העצים הפורשים של הגרף.</p>
<p>אתם עוד איתי? אם כן, הבנתם את ההוכחה; נותר לגהץ את הפרטים.</p>
<p>נתחיל במקרה שבו <span class="math">\(\sigma\)</span> לא מגדירה עץ פורש בגרף <span class="math">\(G\)</span>. אנחנו רוצים להראות ש-<span class="math">\(\det N_{\sigma}=0\)</span> במקרה הזה, ונעשה זאת על ידי כך שנוכיח שבמטריצה <span class="math">\(N_{\sigma}\)</span> יש קבוצה של שורות שסכומן אפס. תוצאה בסיסית על עצים היא שאם גרף לא מכוון עם <span class="math">\(n\)</span> צמתים ו-<span class="math">\(n-1\)</span> קשתות הוא גם קשיר, אז הוא עץ; לכן אם <span class="math">\(\sigma\)</span> אינה משרה עץ בהכרח יש שני רכיבי קשירות. <span class="math">\(v_{r}\)</span> נמצא באחד מהם; בואו נסתכל דווקא על השני - וליתר דיוק, על השורות במטריצה <span class="math">\(N_{\sigma}\)</span> שמתאימות לצמתים של אותו רכיב קשירות שני. אני טוען שסכום כל השורות הללו הוא 0. מדוע? ובכן, נעבור עמודה עמודה: כל עמודה מתאימה לקשת שמחברת שני צמתים. אם שניהם אינם ברכיב הקשירות ממילא, אז בשורות שמתאימות לרכיב הקשירות כל הכניסות בעמודה הזו יהיו 0. אם שניהם ברכיב הקשירות, אז תהיה שורה שבה יופיע 1, ושורה שבה יופיע <span class="math">\(-1\)</span>, ובשאר השורות 0 - ושוב, הסכום הוא 0. ואם אחד מהצמתים ברכיב הקשירות והשני לא? ובכן, זה בלתי אפשרי כי זה נוגד את ההגדרה של רכיב קשירות: אם צומת נמצא ברכיב קשירות מסויים, כך גם כל שכניו.</p>
<p>הטיעון הטכני ביותר יהיה ההוכחה ש-<span class="math">\(\det N_{\sigma}=\pm1\)</span> כאשר <span class="math">\(\sigma\)</span> כן מתאימה לעץ פורש, אבל אחר כך סיימנו את ההוכחה כולה. הרעיון הוא שבמקרה הזה, אפשר לסדר מחדש את שורות ועמודות <span class="math">\(N_{\sigma}\)</span> כך שתתקבל מטריצה משולשית תחתונה (מטריצה שבה כל הכניסות מעל לאלכסון הראשי הן 0), ואת הדטרמיננטה של מטריצה משולשית קל לחשב - זו בסך הכל מכפלת האיברים שעל האלכסון. מכיוון שסידור מחדש של שורות או עמודות משנה רק את הסימן של הדטרמיננטה, זה יסיים את ההוכחה. את המטריצה המסודרת-מחדש אסמן ב-<span class="math">\(M\)</span>.</p>
<p>אמרנו ש-<span class="math">\(\sigma\)</span> מהווה עץ. מה שנעשה הוא להתחיל לפרק את העץ לגורמים. ראשית, בואו נזכור ש<strong>עלה</strong> בעץ הוא צומת מדרגה 1, כלומר שמחובר בדיוק לצומת אחר אחד. עוד משפט חשוב על עצים הוא שבעץ יש לפחות שני עלים; לא אוכיח אותו כרגע.</p>
<p>הבה ונסמן ב-<span class="math">\(u_{1}\)</span> עלה שכזה<strong> </strong>שהוא <strong>שונה </strong>מ-<strong><span class="math">\(v_{r}\)</span> </strong>(תמיד יש כזה; אפילו אם <span class="math">\(v_{r}\)</span> הוא עלה, יש עוד עלה שאפשר לבחור) וב-<span class="math">\(e_{1}\)</span> את הקשת בעץ שמחוברת אליו. השורה הראשונה במטריצה-המסודרת-מחדש שלנו תהיה זו של <span class="math">\(u_{1}\)</span>, והעמודה הראשונה תהיה זו של <span class="math">\(e_{1}\)</span>. מכיוון ש-<span class="math">\(u_{1}\)</span> מחובר <strong>רק</strong> ל-<span class="math">\(e_{1}\)</span> בעץ, הכניסה <span class="math">\(M_{11}\)</span> תהיה שווה ל-1 או ל-<span class="math">\(-1\)</span>(לא משנה לנו איזה מהם), וכמו כן <span class="math">\(M_{1j}=0\)</span> לכל <span class="math">\(j&amp;gt;1\)</span> (ובכלל לא משנה איך אני הולך לסדר את יתר העמודות), שכן כל העמודות הללו מתאימות לקשתות ש-<span class="math">\(u_{1}\)</span> לא מחובר אליהן.</p>
<p>כעת נסיר את <span class="math">\(u_{1}\)</span> מהעץ שלנו (ויחד איתו את <span class="math">\(e_{1}\)</span>), ושוב נקבל עץ, ולכן שוב יש בו צומת מדרגה 1 שאינו <span class="math">\(v_{r}\)</span>. זה יהיה <span class="math">\(u_{2}\)</span> והקשת שמתאימה לו תהיה <span class="math">\(e_{2}\)</span>. זה אומר ש-<span class="math">\(M_{22}\)</span> הוא שוה <span class="math">\(\pm1\)</span>; ואנו יודעים בודאות שעבור הקשתות שטרם טיפלנו בהן, <span class="math">\(u_{2}\)</span> אינו מחובר לאף אחת מהן ולכן <span class="math">\(M_{2j}=0\)</span> לכל <span class="math">\(j&amp;gt;2\)</span> (אולי הוא היה מחובר ל-<span class="math">\(e_{1}\)</span>, אבל זה אומר רק שאולי <span class="math">\(M_{12}\ne0\)</span> וזה לא מפריע לנו כי כניסה זו היא <strong>מתחת</strong> לאלכסון הראשי). העיקרון ברור - נמשיך לבנות כך סדרה <span class="math">\(u_{1},u_{2},\dots,u_{n-1}\)</span> של צמתים ו-<span class="math">\(e_{1},e_{2},\dots,e_{n-1}\)</span> של קשתות. הצומת היחיד שלא נגענו בו הוא <span class="math">\(v_{r}\)</span> עצמו, שהשורה שמתאימה לו בכלל לא מופיעה ב-<span class="math">\(N\)</span> כך שהוא לא רלוונטי לבניה שעשינו. קיבלנו מטריצה משולשת תחתונה שעל האלכסון יש לה רק <span class="math">\(\pm1\)</span> וזה מסיים את ההוכחה.</p>
<p>אני מאוד מקווה שנהניתם מההוכחה הזו כפי שאני נהניתי ממנה.</p>
<p>בואו נעבור עכשיו לדבר על מה צריך להשתנות בהוכחה אם נרצה להוכיח את המשפט לגרפים מכוונים. כבר אמרתי שצריך לשנות את הגדרת מטריצת הלפלסיאן עצמה קצת: <span class="math">\(L_{ii}\)</span> הוא דרגת הכניסה של כל צומת ו-<span class="math">\(L_{ij}\)</span> הוא מינוס מספר הקשתות מ-<span class="math">\(v_{i}\)</span> <strong>אל</strong> <span class="math">\(v_{j}\)</span>. זו לא מטריצה סימטרית ולכן גם לא בהכרח ניתן לכתוב אותה בתור <span class="math">\(A\cdot A^{T}\)</span>; אבל אפשר לעשות משהו טוב כמעט באותה מידה.</p>
<p>הבה ונגדיר שוב מטריצה <span class="math">\(A\)</span> מסדר <span class="math">\(n\times m\)</span> (כלומר - שורה לכל צומת ועמודה לכל קשת, כמקודם) באופן הבא: לכל קשת <span class="math">\(e_{k}=v_{i}\to v_{j}\)</span> (כלומר, מהצומת <span class="math">\(v_{i}\)</span> אל הצומת <span class="math">\(v_{j}\)</span>) יתקיים <span class="math">\(A_{ik}=1,A_{jk}=-1\)</span> ושאר הכניסות יהיו אפס; במילים אחרות, זו בדיוק אותה מטריצה <span class="math">\(A\)</span> כמו קודם רק שעכשיו אנחנו קובעים איזו כניסה תהיה חיובית ואיזו כניסה תהיה שלילית על פי כיוון הקשת <span class="math">\(e_{k}\)</span>.</p>
<p>בנוסף, נגדיר מטריצה <span class="math">\(B\)</span> מסדר <span class="math">\(n\times m\)</span> באופן הבא: לכל קשת <span class="math">\(e_{k}=v_{i}\to v_{j}\)</span> יתקיים <span class="math">\(B_{ik}=0,B_{jk}=-1\)</span> ושאר הכניסות יהיו אפס. כלומר, <span class="math">\(B\)</span> זהה ל-<span class="math">\(A\)</span> פרט לכך שבכל עמודה יש רק <span class="math">\(-1\)</span> עבור הצומת שאליו הקשת נכנסת; לא מופיע 1 עבור הצומת שממנו הקשת יוצאת.</p>
<p>עכשיו לא קשה לראות ש-<span class="math">\(L=A\cdot B^{T}\)</span> וש-<span class="math">\(L^{\left(r\right)}\)</span> הוא <span class="math">\(N_{A}N_{B}^{T}\)</span> כאשר <span class="math">\(N_{A},N_{B}\)</span> מתקבלים מ-<span class="math">\(A,B\)</span> בהתאמה על ידי מחיקת השורה ה-<span class="math">\(r\)</span>. אז קושי-בינה מניבה פה <span class="math">\(\det\left(L^{\left(r\right)}\right)=\sum_{\sigma}\det\left(N_{A\sigma}\right)\det\left(N_{B\sigma}\right)\)</span>. עכשיו צריך להבין מה קורה פה.</p>
<p>היינו רוצים לומר שאם <span class="math">\(\sigma\)</span> לא מגדיר עץ, אז נקבל ש-<span class="math">\(\det\left(N_{A\sigma}\right)=0\)</span> בדיוק כמו קודם ואז גם המכפלה תתאפס. לרוע המזל, "<span class="math">\(\sigma\)</span> לא מגדיר עץ" הוא מקרה הרבה יותר מסובך כאשר הגרף שלנו מכוון, כי הקריטריון של "גרף עם <span class="math">\(n-1\)</span> קשתות שהוא קשיר הוא עץ" פשוט לא נכון. בעץ מכוון, צריך שיהיה צומת (השורש) שקיים מסלול ממנו לכל הצמתים האחרים, ומספיקה קשת אחת בכיוון הלא נכון כדי לקלקל את זה. לכן בואו נתחיל קודם כל דווקא מדיבור על המקרה שבו <span class="math">\(\sigma\)</span> כן מגדיר עץ. מה נשתנה הפעם?</p>
<p>ובכן, הפעם צריכים להיות קצת יותר זהירים בגלל ש-<span class="math">\(\det\left(N_{A\sigma}\right)\det\left(N_{B\sigma}\right)\)</span> הוא לא ריבוע. מה שאנחנו רוצים לטעון הוא שמתקיים <span class="math">\(\det\left(N_{A\sigma}\right)=\det\left(N_{B\sigma}\right)\)</span> וששניהם שווים או 1 או <span class="math">\(-1\)</span>. אפשר להשתמש בשיטת הסידור-מחדש של מטריצה כמו קודם; רק צריך להיות זהירים ולסדר את <span class="math">\(N_{A\sigma}\)</span> ואת <span class="math">\(N_{B\sigma}\)</span> באותו האופן בדיוק כדי שהשינוי בסימן, אם היה כזה, יהיה זהה אצל שניהם.</p>
<p>אחרי הסידור מחדש של המטריצה, מה שמתקבל מ-<span class="math">\(N_{A\sigma}\)</span> ומ-<span class="math">\(N_{B\sigma}\)</span> היא כמקודם מטריצה משולשית תחתונה, אבל מה נמצא על האלכסון? כאן האופן שבו ביצענו את הסדר הופך להיות קריטי: להזכירכם, בשיטה שלנו בשלב ה-<span class="math">\(i\)</span> קבענו את השורה ה-<span class="math">\(i\)</span> להיות צומת <span class="math">\(u_{i}\)</span> שבשלב הזה היה עלה, ואת העמודה להיות קשת <span class="math">\(e_{i}\)</span> שהיא הקשת ש<strong>נכנסת</strong> אל <span class="math">\(u_{i}\)</span>. כלומר, הן על פי ההגדרה של <span class="math">\(A\)</span> והן על פי ההגדרה של <span class="math">\(B\)</span>, הכניסה המתאימה תהיה <span class="math">\(-1\)</span>. זה מבטיח שהדטרמיננטה תהיה מכפלה של <span class="math">\(-1\)</span>-ים ושלא ישתרבב פנימה איזה 0 שיאפס את כולה (מה שהיה עלול לקרות עם <span class="math">\(B\)</span>, שבו יש אפסים שלא היו בהוכחה עבור גרפים לא מכוונים).</p>
<p>עכשיו נחזור למקרה שבו <span class="math">\(\sigma\)</span> הוא לא עץ. מי שיושיע אותנו כאן הוא שאנחנו משתמשים גם ב-<span class="math">\(N_{A\sigma}\)</span> וגם ב-<span class="math">\(N_{B\sigma}\)</span>: הדטרמיננטה של אחד מהם תתאפס, ולא משנה מה. התעלול פשוט: אם <span class="math">\(\sigma\)</span> הוא כזה שאפילו גרף התשתית של העץ שלנו (מה שמקבלים כשמוחקים את כיווני הקשתות) איננו עץ אז <span class="math">\(\det\left(N_{A\sigma}\right)=0\)</span> מאותו שיקול כמו במקרה הלא מכוון (סכום שורות שהוא אפס, מה שמובטח על ידי ה-1 וה-<span class="math">\(-1\)</span> שיש בכל עמודה שם - וזה משהו שאין ב-<span class="math">\(B\)</span>), ואילו אם גרף התשתית הוא כן עץ, אז נסדר מחדש את <span class="math">\(N_{B\sigma}\)</span> על פי אותה שיטה שבה השתמשנו עד כה במקרים שבהם <span class="math">\(\sigma\)</span> הגדיר עץ. נקבל מטריצה משולשית תחתונה כמו תמיד, רק שהפעם אחד מהאיברים על האלכסון יהיה 0. מדוע? כי אם <span class="math">\(\sigma\)</span> איננו עץ למרות שגרף התשתית הוא כן עץ, זה אומר שיש קשת אחת שמכוונת בכיוון "הלא נכון", ואז הכניסה על האלכסון שמתאימה לקשת הזו ולצומת שמחוברת אליה תהיה 0 (כי הקשת <strong>יוצאת</strong> מהצומת במקום להיכנס אליו).</p>
<p>אם כן, המקרה המכוון הוא מעט יותר מסובך מהמקרה הלא מכוון אבל גם בו יש תובנות יפות לגבי <strong>למה</strong> זה עובד - ושוב, אני מקווה שנהניתם.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/new_blog/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>