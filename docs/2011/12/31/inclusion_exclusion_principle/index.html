<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>עקרון ההכלה וההפרדה, ואז הכללה והפחדה | לא מדויק</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="עקרון ההכלה וההפרדה, ואז הכללה והפחדה" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<link rel="canonical" href="http://gadial.net/2011/12/31/inclusion_exclusion_principle/" />
<meta property="og:url" content="http://gadial.net/2011/12/31/inclusion_exclusion_principle/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-12-31T13:45:26+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="twitter:title" content="עקרון ההכלה וההפרדה, ואז הכללה והפחדה" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"url":"http://gadial.net/2011/12/31/inclusion_exclusion_principle/","@type":"BlogPosting","description":"לא מדויק - בלוג על מתמטיקה ומדעי המחשב","headline":"עקרון ההכלה וההפרדה, ואז הכללה והפחדה","dateModified":"2011-12-31T13:45:26+00:00","datePublished":"2011-12-31T13:45:26+00:00","image":"http://gadial.net/assets/img/main/default-card.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2011/12/31/inclusion_exclusion_principle/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/lecture_notes">סיכומי הרצאות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">דף אקראי</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2011/12/24/simultaneous_diagonalization/">&laquo; להטיל לכסון סימולטני בתת-מרחב שמור, בערך</a>
    
    
      <a class="next" href="/2012/01/07/mobius_inversion_formula/">נוסחת ההיפוך של מביוס &raquo;</a>
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">עקרון ההכלה וההפרדה, ואז הכללה והפחדה</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2011-12-31T13:45:26+00:00" itemprop="datePublished">Dec 31, 2011
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>אני רוצה לדבר הפעם על מושג חשוב בקומבינטוריקה ובחיים בכלל - <strong>עקרון ההכלה וההפרדה</strong>. הדובדבן שבקצפת יהיה להראות איך הוא קשור למשפט בתורת המספרים - <strong>נוסחת ההיפוך של מביוס</strong>, אבל עוד חזון למועד, בפוסט הבא. קודם כל נבין מהו עקרון ההכלה וההפרדה ואיך עושים איתו דברים מעניינים, ואז נבין מה הוא אומר <strong>באמת</strong>, כלומר נציג גרסה מוכללת שלו. יהיה אקשן.</p>
<h2><strong>מהו עקרון ההכלה וההפרדה</strong></h2>
<p>קומבינטוריקה אנומרטיבית היא התחום המתמטי שעוסק, פחות או יותר, בבעיה הבאה: “הנה לך קבוצה סופית, כמה איברים יש בה?”, כאשר לרוב הקבוצה הזו תלויה באיזה פרמטר <span>\( n \)</span> ואנו רוצים את התשובה כפונקציה של <span>\( n \)</span>. הנה כמה דוגמאות לבעיות שבכולן נטפל בקרוב: קבוצת המספרים הטבעיים בין <span>\( 1 \)</span> ל-<span>\( n \)</span> שאינם מתחלקים ב-2, 3 או 5; קבוצת המספרים בין 1 ל-<span>\( n \)</span> שזרים ל-<span>\( n \)</span> (כלומר, אין להם מחלקים טבעיים משותפים הגדולים מ-1), וקבוצת הפרות הסדר על <span>\( n \)</span> איברים - בלשון ציורית, מספר הדרכים שבהן יכול דוור מבולבל (אם אנחנו שונאים את ניומן מסיינפלד) או מזכירה מבולבלת (אם אנחנו שונאים נשים) לחלק <span>\( n \)</span> מכתבים ל-<span>\( n \)</span> האנשים שאמורים לקבל אותם באופן כזה שאף מכתב לא יגיע ליעדו (למשל, אם האנשים הם 1,2,3 אז אפשרות אחת היא שהמכתב של 3 יגיע ל-1, שהמכתב של 2 יגיע ל-3, ושהמכתב של 1 יגיע ל-2).</p>

<p>בואו נתחיל מגרסה עוד יותר פשוטה של הבעיה הראשונה: כמה מספרים בין 1 ל-100 <strong>כן</strong> מתחלקים ב-2 או ב-3? ובכן, בדיוק 50 מספרים מתחלקים ב-2 - כל הזוגיים. כמו כן, 33 מתחלקים ב-3; כל המספרים שהם כפולות של 3 עד 99, ו-100 לא עוזר לנו כי אינו מתחלק ב-3. קצת מחשבה מראה לנו את הנוסחה הכללית: מספרים מ-<span>\( 1 \)</span> ועד <span>\( n \)</span> שמתחלקים ב-<span>\( k \)</span> יש בדיוק, אבל בדיוק, <span>\( \left\lfloor \frac{n}{k}\right\rfloor  \)</span>, כשהקווים מייצגים ערך שלם תחתון: אם התקבלה תוצאה שברית, מעגלים למטה למספר השלם הקרוב.</p>

<p>אם כן, הפיתוי גדול לומר שיש <span>\( 50+33=83 \)</span> מספרים בין 1 ו-100 שמתחלקים ב-2 או ב-3. אבל ספירה מהירה תראה שזה לא נכון. בעצם, עזבו אתכם ממספרים בין 1 ל-100 שקשה לספור; אם ננסה באותה שיטה לספור מספרים בין 1 ל-10 נקבל <span>\( 8 \)</span> מספרים, אבל בבירור יש רק 7: <span>\( \left\{ 2,3,4,6,8,9,10\right\}  \)</span>. איפה הטעות שלנו? במספר המעצבן 6, שמתחלק בו זמנית גם ב-2 וגם ב-3. ספרנו אותו פעמיים: פעם אחת כחבר בקבוצה <span>\( \left\{ 2,4,6,8,10\right\}  \)</span> של מספרים שמתחלקים ב-2, ופעם אחת בקבוצה <span>\( \left\{ 3,6,9\right\}  \)</span> של מספרים שמתחלקים ב-3. את הספירה הכפולה הזו צריך לתקן - פשוט נחסיר 1 מהתוצאה.</p>

<p>עבור מספרים בין 1 ל-100 הרעיון דומה; יש 83 מספרים פחות כמות המספרים בין 1 ל-100 שמתחלקים גם ב-2 וגם ב-3. למזלנו קל לדעת מיהם - אלו בדיוק המספרים שמתחלקים 6, כלומר <span>\( \left\lfloor \frac{100}{6}\right\rfloor =16 \)</span>. קיבלנו שיש <span>\( 50+33-16=67 \)</span> מספרים בין 1 ל-100 שמתחלקים או ב-2, או ב-3, או בשניהם.</p>

<p>את הרעיון הכללי אפשר לנסח כך: אם <span>\( A,B \)</span> הן קבוצות, אז <span>\( \left|A\cup B\right|=\left|A\right|+\left|B\right|-\left|A\cap B\right| \)</span> - גודל הקבוצה <span>\( A\cup B \)</span> שמכילה את כל האיברים של <span>\( A,B \)</span> הוא כסכום גדלי הקבוצות <span>\( A,B \)</span> פחות הגודל של הקבוצה <span>\( A\cap B \)</span> של איברים ששייכים הן ל-<span>\( A \)</span> והן ל-<span>\( B \)</span>. השלב הבא הוא לנסח את המשפט עבור שלוש קבוצות, <span>\( A,B,C \)</span>. הניחוש הראשוני הוא לומר ש-</p>

<p><span>\( \left|A\cup B\cup C\right|=\left(\left|A\right|+\left|B\right|+\left|C\right|\right)-\left(\left|A\cap B\right|+\left|A\cap C\right|+\left|B\cap C\right|\right) \)</span></p>

<p>וזה כמעט נכון, אבל לא נכון עד הסוף, כי אם יש איבר שנמצא הן ב-<span>\( A \)</span>, הן ב-<span>\( B \)</span> והן ב-<span>\( C \)</span> הוא אמנם נספר שלוש פעמים ב-<span>\( \left|A\right|+\left|B\right|+\left|C\right| \)</span> אבל לאחר מכן הוא גם מוחסר שלוש פעמים ב-<span>\( -\left(\left|A\cap B\right|+\left|A\cap C\right|+\left|B\cap C\right|\right) \)</span> ובסופו של דבר יוצא שהוא לא נספר כלל. לכן צריך לתקן את הנוסחה על ידי הוספת <span>\( \left|A\cap B\cap C\right| \)</span>.</p>

<p>מכאן כבר אפשר לנחש את המקרה הכללי: אם יש לנו קבוצות <span>\( A_{1},\dots,A_{k} \)</span> ואנו רוצים לדעת מה הגודל של <span>\( \bigcup_{i=1}^{k}A_{i} \)</span>, קודם כל נסכום את הגדלים של כל הקבוצות, אחר כך נחסיר את הגודל של כל החיתוכים של שתי קבוצות, נחבר את הגודל של חיתוכים של שלוש, נחסיר את הגודל של חיתוכים של ארבע… אני אומר את זה מילולית כי לכתוב את זה בנוסחה - ובכן, איך נאמר זאת בעדינות - זה כואב. הנה הנוסחה:</p>

<p><span>\( \left|\bigcup_{i=1}^{n}A_{i}\right|=\sum_{i=1}^{n}\left|A_{i}\right|-\sum_{1\le i&lt;j\le n}\left|A_{i}\cap A_{j}\right|+\dots+\left(-1\right)^{n+1}\left|\bigcap_{i=1}^{n}A_{i}\right| \)</span></p>

<p>לקצרנים שבינינו, אפשר גם עם סכום כפול:</p>

<p><span>\( \left|\bigcup_{i=1}^{n}A_{i}\right|=\sum_{t=1}^{n}\sum_{1\le i_{1}&lt;i_{2}&lt;\dots&lt;i_{t}\le n}\left(-1\right)^{t+1}\left|\bigcap_{j=1}^{t}A_{i_{j}}\right| \)</span></p>

<p>לא נעים כל כך, אבל העיקרון עצמו ברור למדי. עם זאת, צריך גם להוכיח שהוא עובד. הרעיון הוא להסתכל על איבר כלשהו <span>\( x\in\bigcup_{i=1}^{n}A_{i} \)</span> ולשאול את עצמנו - מה הוא תורם לאגף ימין, ומה הוא תורם לאגף שמאל? לאגף שמאל הוא תורם בדיוק 1; אגף ימין קצת יותר מסובך. נניח ש-<span>\( x \)</span> נמצא בדיוק ב-<span>\( k \)</span> קבוצות, אז לכל <span>\( t&gt;k \)</span>, פשוט לא ייתכן ש-<span>\( x\in\bigcap_{j=1}^{t}A_{i_{j}} \)</span> כי אנחנו חותכים פה יותר קבוצות מאשר יש קבוצות שמכילות את <span>\( x \)</span> ולכן הוא לא בחיתוך. לכן מה שרלוונטי מראש הוא רק <span>\( t\le k \)</span>, וגם אז - רק חיתוכים <span>\( \bigcap_{j=1}^{t}A_{i_{j}} \)</span> שבהם <strong>כל</strong> הקבוצות כוללות את <span>\( x \)</span>, כלומר כל הקבוצות נלקחות מתוך <span>\( k \)</span> הקבוצות שכוללות את <span>\( x \)</span> מלכתחילה. המספר שלהן הוא מה שמסמנים כ-<span>\( {k \choose t} \)</span>: מספר האפשרויות לבחור <span>\( t \)</span> מתוך <span>\( k \)</span>. זה אומר ש-<span>\( x \)</span> תורם לסכום באגף ימין בדיוק את תת-הסכום הבא:</p>

<p><span>\( \sum_{t=1}^{k}{k \choose t}\left(-1\right)^{t+1} \)</span></p>

<p>כדי לחשב את הסכום הזה משתמשים בנוסחת <a href="http://www.gadial.net/2010/06/22/newton_binom/">הבינום של ניוטון</a>, שקל לראות ממנה שמתקיים <span>\( 0=\left(1-1\right)^{k}=\sum_{t=0}^{k}{k \choose t}\left(-1\right)^{t} \)</span>. לכן אנו מקבלים:</p>

<p><span>\( \sum_{t=1}^{k}{k \choose t}\left(-1\right)^{t}=\sum_{t=0}^{k}{k \choose t}\left(-1\right)^{t+1}+1=1-\sum_{t=0}^{k}{k \choose t}\left(-1\right)^{t}=1 \)</span></p>

<p>כפי שרצינו.</p>
<h2><strong>ואיך עושים איתו דברים מעניינים</strong></h2>
<p>סיימנו את ההוכחה ואפשר לעבור לאקשן - פתרון של דברים אמיתיים. נתחיל עם המספרים בין 1 ל-<span>\( n \)</span> שאינם מתחלקים ב-<span>\( 2 \)</span> או <span>\( 3 \)</span> או <span>\( 5 \)</span>: כאן הקבוצות הן של המספרים ש<strong>כן</strong> מתחלקים ב-2, ו<strong>כן</strong> מתחלקים ב-3, ו<strong>כן</strong> מתחלקים ב-5, ואנחנו רוצים לחסר את זה מהקבוצה של כלל המספרים, שהיא מגודל <span>\( n \)</span>. לכן נקבל:</p>

<p><span>\( n-\left(\left\lfloor \frac{n}{2}\right\rfloor +\left\lfloor \frac{n}{3}\right\rfloor +\left\lfloor \frac{n}{5}\right\rfloor \right)+\left(\left\lfloor \frac{n}{6}\right\rfloor +\left\lfloor \frac{n}{10}\right\rfloor +\left\lfloor \frac{n}{15}\right\rfloor \right)-\left\lfloor \frac{n}{30}\right\rfloor  \)</span></p>

<p>חייבים להודות שהנוסחה הזו לא נראית הכי מלהיבה בעולם; אבל חשבו לרגע על הדרך הנאיבית לחשב את המספר הזה - לעבור על כל המספרים מ-<span>\( 1 \)</span> עד <span>\( n \)</span> ולכל אחד לבדוק אם הוא מתחלק ב-2 או 3 או 5. אם <span>\( n \)</span> קטן זה לא נורא, אבל מה אם <span>\( n=10^{100} \)</span>? במקרה הזה האלגוריתם שלנו לעולם לא יסתיים, ואילו בעזרת הנוסחה שלנו צריך יהיה לבצע 7 פעולות חילוק ולחבר/לחסר את התוצאות וזהו, כלומר החישוב יסתיים בחלקיקי שניה גם אם <span>\( n \)</span> מפלצתי בגודלו. זו המחשה ראשונה לכוח שבהכלה והפרדה.</p>

<p>בואו נעבור לדוגמה השניה: עבור טבעי <span>\( n \)</span>, <span>\( \varphi\left(n\right) \)</span> (“פונקצית אוילר”) מסמן את מספרם של המספרים הטבעיים בין 1 ל-<span>\( n \)</span> שזרים ל-<span>\( n \)</span>, כלומר שהמספר היחיד שמחלק את שניהם הוא <span>\( 1 \)</span> עצמו. למשל, עבור <span>\( 6 \)</span>, המספרים היחידים שקטנים ממנו וזרים לו הם 1 ו-5 ולכן <span>\( \varphi\left(6\right)=2 \)</span>; עבור <span>\( 8 \)</span> אלו הם <span>\( 1,3,5,7 \)</span> ולכן <span>\( \varphi\left(8\right)=4 \)</span>, וכן הלאה. אם תסתכלו בגרף של הפונקציה הזו תראו שהיא מתנהגת בצורה די מטורללת - כל הזמן קופצת בין ערכים קטנים לגדולים. נקודות השיא הן בראשוניים (מספרים שמתחלקים רק ב-1 ובעצמם): לכל מספר ראשוני <span>\( p \)</span> מתקיים <span>\( \varphi\left(p\right)=p-1 \)</span> ולכן הערכים הגדולים ביותר של <span>\( \varphi \)</span> יתקבלו על הראשוניים, שהם עצמם מפוזרים בצורה שנראית כמעט אקראית.</p>

<p>ועם זאת, יש נוסחה ל-<span>\( \varphi\left(n\right) \)</span>, שמתבססת על כך שאנו יודעים בדיוק מהם הראשוניים שמחלקים את <span>\( n \)</span>. יש לנוסחה הזו מספר הוכחות והאהובה עלי עושה שימוש במשפט חשוב למדי מאלגברה - “משפט השאריות הסיני”. לא נדבר על זה בכלל הפעם, ובמקום זאת נראה איך גישת ההכלה וההפרדה מחסלת גם היא את הבעיה בקלות.</p>

<p>האבחנה האלגברית שבבסיס העניין היא שאם <span>\( n \)</span> ו-<span>\( m \)</span> לא זרים, אז קיים ראשוני <span>\( p \)</span> כלשהו שמחלק את שניהם. נניח שהמחלקים הראשוניים השונים של <span>\( n \)</span> הם בדיוק <span>\( p_{1},\dots,p_{k} \)</span>, אז הקבוצה <span>\( A_{i} \)</span> שלנו הפעם תהיה “קבוצת כל המספרים הטבעיים הקטנים או שווים ל-<span>\( n \)</span> שמתחלקים ב-<span>\( p_{i} \)</span>”. את הגודל המדויק של הקבוצה הזו אנחנו יודעים - הוא בדיוק <span>\( \frac{n}{p_{i}} \)</span>, מהנימוקים שנתתי קודם. וכמות המספרים שמתחלקים בשני ראשוניים <span>\( p_{i},p_{j} \)</span> היא <span>\( \frac{n}{p_{i}p_{j}} \)</span> וכן הלאה. אז הכלה והפרדה נותנת את הדבר הבא:</p>

<p><span>\( \varphi\left(n\right)=n-\sum_{i}\frac{n}{p_{i}}+\sum_{i,j}\frac{n}{p_{i}p_{j}}-\dots+\left(-1\right)^{k}\frac{n}{p_{1}\cdots p_{k}} \)</span></p>

<p>על פניו, לא ברור מה הנוסחה הזו עזרה לנו, אבל שימו לב לכך ש-<span>\( n \)</span> הוא גורם בכל אחד מהמחוברים, כך שניתן להוציא אותו החוצה ולהיוותר עם סכום מהצורה <span>\( \left(1-\sum\frac{1}{p_{i}}+\sum\frac{1}{p_{i}p_{j}}-\dots+\left(-1\right)^{k}\frac{1}{p_{1}\cdots p_{k}}\right) \)</span>. מה שטוב בסכום הזה, שעדיין נראה מפלצתי, הוא שאפשר לכתוב אותו בצורה הרבה יותר פשוטה ומסודרת כמכפלה: <span>\( \prod_{i=1}^{k}\left(1-\frac{1}{p_{i}}\right) \)</span>. כדי לראות את זה, שימו לב שאם פותחים את המכפלה הזו, מקבלים סכום של איברים כך שכל איבר הוא בעצמו מכפלה, שכל איבר בה הוא או <span>\( 1 \)</span> או <span>\( -\frac{1}{p_{i}} \)</span> (הדרך הפשוטה ביותר לראות זאת - נסו לעשות זאת עם שני ראשוניים בלבד).</p>

<p>אם כן, קיבלנו את הנוסחה <span>\( \varphi\left(n\right)=n\prod_{p|n}\left(1-\frac{1}{p}\right) \)</span> (<span>\( p|n \)</span> פירושו “מכפלה שנלקחת על כל הראשוניים <span>\( p \)</span> שמחלקים את <span>\( n \)</span>”) שהיא קלה ביותר לחישוב, אם יודעים מיהם ה-<span>\( p \)</span>-ים המתאימים (ולדעת מי הם - זו כבר בעיה לא פשוטה כלל).</p>

<p>בואו נעבור עכשיו להפרות סדר, שגם בהן הכלה והפרדה נותנת נוסחה סגורה, אבל מרשימה אפילו יותר מאשר במקרה הקודם שכן היא לא תכלול שום מכפלה ושום סכום, בזכות תעלול מחדו”א שנשתמש בו. הפרת סדר היא בבסיסה תמורה - סידור בשורה של המספרים מ-<span>\( 1 \)</span> עד <span>\( n \)</span>. יש באופן כללי <span>\( n!=1\cdot2\cdots n \)</span> תמורות; מהן אנחנו רוצים לחסר את מספר התמורות שבהן יש לפחות אינדקס אחד <span>\( i \)</span> כך שהמספר במקום ה-<span>\( i \)</span> הוא <span>\( i \)</span> עצמו (למשל, <span>\( 4132 \)</span> היא תמורה כזו עם האינדקס <span>\( i=3 \)</span>).</p>

<p>למרבה המזל, את החישובים כאן קל מאוד לבצע. מספר התמורות שבהן <span>\( k \)</span> איברים ספציפיים נמצאים במקום הנכון שלהם הוא כמספר האפשרויות לסדר את כל יתר <span>\( n-k \)</span> האיברים בסדר שרירותי כלשהו, כלומר <span>\( \left(n-k\right)! \)</span>. שימו לב לכך שאני <strong>מרשה</strong> לאיברים נוספים פרט ל-<span>\( k \)</span> האיברים הספציפיים להיות במקום הנכון שלהם; אני פשוט לא דורש זאת במפורש. לכן <span>\( \left(n-k\right)! \)</span> אינו מספר התמורות שבהן <strong>בדיוק</strong> <span>\( k \)</span> איברים נמצאים במקום הנכון שלהם; צריך להיזהר לא לחשוב כך בטעות.</p>

<p>עקרון ההכלה וההפרדה מניב לנו עכשיו את הנוסחה הבאה ל-<span>\( D\left(n\right) \)</span>, מספר הפרות הסדר של <span>\( n \)</span> איברים:</p>

<p><span>\( D\left(n\right)=n!-{n \choose 1}\left(n-1\right)!+{n \choose 2}\left(n-2\right)!-\dots+\left(-1\right)^{n}{n \choose n}\left(n-n\right)! \)</span>. כדי להבין מה פשר המקדם <span>\( {n \choose k} \)</span> שמופיע שם בואו נחשוב שניה איך אמורה להיראות הנוסחה: היא אמורה להתחיל עם <span>\( n! \)</span>, ואז אמורים לחסר ממנה, לכל מקום בין 1 ל-<span>\( n \)</span>, את מספר התמורות שבהן מקום זה מקובע. לכל מקום נקבל אותו מספר - <span>\( \left(n-1\right)! \)</span>, ויש <span>\( {n \choose 1} \)</span> מקומות כאלו, ומכאן הכפל. בדומה, <span>\( {n \choose 2} \)</span> מתאים למספר האפשרויות לבחור זוג מקומות לקבע, וכן הלאה.</p>

<p>בואו נכתוב שוב את הנוסחה שקיבלתי, בצורה יותר קומפקטית: <span>\( D\left(n\right)=\sum_{k=0}^{n}\left(-1\right)^{k}{n \choose k}\left(n-k\right)! \)</span>. האם יש דרך לפשט אותה עוד יותר? ובכן, <span>\( {n \choose k}=\frac{n!}{k!\left(n-k\right)!} \)</span> כך שאפשר לעשות כאן צמצום קטן ולקבל <span>\( D\left(n\right)=\sum_{k=0}^{n}\left(-1\right)^{k}\frac{n!}{k!}=n!\left(\sum_{k=0}^{n}\frac{\left(-1\right)^{k}}{k!}\right) \)</span>. הקומבינטוריקה מביאה אותנו עד כאן ותו לא, אבל עכשיו החדו”א יכול להיכנס לפעולה.</p>

<p>כל מי שמכיר חדו”א ובוהה בנוסחה <span>\( \sum_{k=0}^{n}\frac{\left(-1\right)^{k}}{k!} \)</span> כנראה ירגיש משהו מצלצל לו - זה נראה כמו פונקציית ה<a href="http://www.gadial.net/2010/03/27/exponent/">אקספוננט</a> <span>\( e^{x}=\sum_{k=0}^{\infty}\frac{x^{k}}{k!} \)</span>, רק שכאן הטור סופי ולא אינסופי. במילים אחרות, <span>\( \sum_{k=0}^{n}\frac{\left(-1\right)^{k}}{k!}=e^{-1}-\sum_{k=n+1}^{\infty}\frac{\left(-1\right)^{k}}{k!} \)</span>. אז קיבלנו שהסכום הוא “כמעט” <span>\( \frac{1}{e} \)</span>, רק שיש גם שארית מעצבנת <span>\( \sum_{k=n+1}^{\infty}\frac{\left(-1\right)^{k}}{k!} \)</span> שצריך להבין מה בדיוק, או לפחות בערך, הגודל שלה. במקרה הספציפי שלנו זה קל במיוחד כי הטור הוא מה שנקרא “טור לייבניץ” - טור מהצורה <span>\( \sum\left(-1\right)^{n}a_{n} \)</span> כש-<span>\( a_{n} \)</span> שואפת מונוטונית לאפס, וידוע שסכום של טור שכזה, בערכו המוחלט, הוא קטן או שווה לגודל האיבר הראשון בו. כלומר, <span>\( \left|\sum_{k=n+1}^{\infty}\frac{\left(-1\right)^{k}}{k!}\right|\le\left|\frac{\left(-1\right)^{n+1}}{\left(n+1\right)!}\right|=\frac{1}{\left(n+1\right)!} \)</span>.</p>

<p>אם כן, קיבלנו את הנוסחה <span>\( D\left(n\right)=n!\cdot\left(e^{-1}+\xi\left(n\right)\right)=\frac{n!}{e}+n!\xi\left(n\right) \)</span>, כשכתבתי את השגיאה ב-<span>\( \xi \)</span> בדיוק כדי שתיראה מכוערת ונרצה להיפטר ממנה. מה אנחנו יודעים עליה? ש-<span>\( \left|n!\xi\left(n\right)\right|\le\frac{n!}{\left(n+1\right)!}=\frac{1}{n} \)</span>. במילים אחרות, עבור <span>\( n\ge3 \)</span>, השגיאה קטנה מחצי. זה מאפשר לנו לטעון את הטענה הנועזת הבאה: <span>\( D\left(n\right)=\left[\frac{n!}{e}\right] \)</span>, כאשר הסוגריים המרובעים פירושם “ערך שלם” - המספר השלם הקרוב ביותר ל-<span>\( \frac{n!}{e} \)</span>. זה עובד מכיוון שלכל מספר ממשי, הערך השלם שלו הוא במרחק לכל היותר <span>\( \frac{1}{2} \)</span> ממנו, בעוד שכל מספר שלם אחר הוא מרחק של לפחות <span>\( \frac{1}{2} \)</span> ממנו, ולכן אם כל ה”תיקון” שנדרש כדי לעבור מ-<span>\( \frac{n!}{e} \)</span> ל-<span>\( D\left(n\right) \)</span> הוא פחות מחצי, הערך השלם יביא אותנו ל-<span>\( D\left(n\right) \)</span> בודאות. את זה ש-<span>\( D\left(n\right)=\left[\frac{n!}{e}\right] \)</span> גם עבור <span>\( n=1,2 \)</span> אפשר לבדוק בצורה ישירה, והנה קיבלנו נוסחה סגורה ופשוטה ל-<span>\( D\left(n\right) \)</span>. אפשר גם להסיק מסקנה הסתברותית - ככל ש-<span>\( n \)</span> שואף לאינסוף, כך ההסתברות לקבלת הפרת סדר כשמגרילים תמורה באקראי שואפת ל-<span>\( \frac{1}{e} \)</span>; הנה לנו דוגמה נאה למקום שבו <span>\( e \)</span> צץ באופן טבעי לגמרי בבעיה קומבינטורית שבכלל לא מזכירה אותו.</p>
<h2><strong>הכללה והפחדה</strong></h2>
<p>כל דבר טוב שהמתמטיקאים מצליחים לעשות הם חייבים להרוס על ידי הכללה שלו ככל שרק ניתן, וגם לעקרון ההכלה וההפרדה נעשה עכשיו משהו דומה. זה יעזור לנו בפוסט שבו נדבר על נוסחת ההיפוך של מביוס (שהיא עצמה הכללה מסוג מסויים - עוד יותר כללי - של עקרון ההכלה וההפרדה) וגם יתן לנו תירוץ לראות את כל עניין ההכלה וההפרדה בתור מקרה פרטי של משהו מאלגברה לינארית. למרות שכולם מוזמנים לקרוא את החלק הזה של הפוסט אני מזהיר מראש שלא ארחם בו על הקוראים ואתם עשויים לאבד אותי (אני בעצמי הלכתי לאיבוד כשקראתי את זה).</p>

<p>אם כן, תהא <span>\( X \)</span> קבוצה כלשהי בת <span>\( n \)</span> איברים (אפשר לחשוב עליה כעל קבוצה של “תכונות” אם זה עוזר לנו). ניקח מרחב וקטורי <span>\( V \)</span> של כל הפונקציות <span>\( f:\mbox{P}\left(X\right)\to\mathbb{R} \)</span>, כאשר <span>\( \mbox{P}\left(X\right) \)</span> פירושו קבוצת החזקה של <span>\( X \)</span> - אוסף כל תת-הקבוצות של <span>\( X \)</span>. במילים אחרות, כל פונקציה <span>\( f \)</span> כזו מגדירה ערך כלשהו שמתאים לתת-קבוצה של <span>\( X \)</span>. קל לראות ש-<span>\( V \)</span> הוא באמת מרחב וקטורי מעל <span>\( \mathbb{R} \)</span> (למעשה, <span>\( \mathbb{R} \)</span> לא ממש חשוב כאן וכל שדה אחר היה עובד באותה מידה). כעת נגדיר טרנספורמציה לינארית <span>\( T:V\to V \)</span> באופן הבא:</p>

<p><span>\( \left(Tf\right)\left(A\right)=\sum_{B\supseteq A}f\left(B\right) \)</span></p>

<p>כלומר, בהינתן <span>\( f \)</span>, הפונקציה החדשה ש-<span>\( Tf \)</span> מגדירה היא כזו שערכה על כל תת-קבוצה <span>\( A\subseteq X \)</span> הוא סכום ערכי <span>\( f \)</span> על כל ה-<span>\( B \)</span> שמכילות את <span>\( A \)</span>. חשבו על זה כך: <span>\( f\left(A\right) \)</span> אומרת כמה איברים ביקום שלנו מקיימים <strong>בדיוק</strong> את התכונות שבקבוצה <span>\( A \)</span> ושום דבר אחר; <span>\( Tf\left(A\right) \)</span> אומר כמה איברים ביקום שלנו מקיימים <strong>לפחות</strong> את התכונות שב-<span>\( A \)</span>, ואולי עוד דברים. בדרך כלל את <span>\( f \)</span> קשה לחשב ואילו את <span>\( Tf \)</span> קל, ולכן מה שאנחנו רוצים לעשות הוא “להפוך” את <span>\( T \)</span>; לקבל איכשהו מ-<span>\( Tf \)</span> את <span>\( f \)</span> עצמה. לצורך כך צריך שהטרנספורמציה הלינארית שלנו תהיה הפיכה, ועקרון ההכלה וההפרדה אומר שזה בדיוק מה שקורה, וגם נותן לנו את הנוסחה המדוייקת של <span>\( T^{-1} \)</span>:</p>

<p><span>\( \left(T^{-1}f\right)\left(A\right)=\sum_{B\supseteq A}\left(-1\right)^{\left|B-A\right|}f\left(B\right) \)</span></p>

<p>תכף נראה איך זה מתקשר לדברים שראינו עד כה, אבל לפני כן בואו נוכיח. מה שאנחנו בעצם רוצים להראות הוא שאם נגדיר טרנספורמציה לינארית <span>\( S:V\to V \)</span> על ידי <span>\( \left(Sf\right)\left(A\right)=\sum_{B\supseteq A}\left(-1\right)^{\left|B-A\right|}f\left(B\right) \)</span> אז יתקיים ש-<span>\( ST=TS=I \)</span>. עכשיו, כמו שבדרך כלל קורה באלגברה לינארית, כל מה שצריך לעשות הוא להציב והכל כבר מסתדר מעצמו. הבה ונראה מהו <span>\( \left(TSf\right) \)</span>:</p>

<p><span>\( \left(TSf\right)\left(A\right)=T\left(\sum_{B\supseteq A}\left(-1\right)^{\left|B-A\right|}f\left(B\right)\right)=\sum_{B\supseteq A}\left(-1\right)^{\left|B-A\right|}Tf\left(B\right) \)</span></p>

<p><span>\( =\sum_{B\supseteq A}\left(-1\right)^{\left|B-A\right|}\left(\sum_{C\supseteq B}f\left(C\right)\right) \)</span></p>

<p>כעת ננקוט בתעלול הטכני הסטנדרטי של שינוי סדר הסכימה. הסכום שלמעלה שווה ממש לסכום הבא:</p>

<p><span>\( \sum_{C\supseteq A}\left(\sum_{A\subseteq B\subseteq C}\left(-1\right)^{\left|B-A\right|}\right)f\left(C\right) \)</span></p>

<p>האינדקס בסכום האמצעי הוא <span>\( B \)</span>. אז למה <span>\( \left|B-A\right| \)</span> יכול להיות שווה? ברור שערכיו נעים בין 0 ובין <span>\( m=\left|C-A\right| \)</span>. כמה קבוצות <span>\( B \)</span> מקיימות ש-<span>\( \left|B-A\right|=i \)</span> עבור <span>\( 0\le i\le m \)</span>? ובכן, בדיוק כמספר האיברים לבחור <span>\( i \)</span> מתוך <span>\( m \)</span> האיברים של <span>\( C \)</span> שאינם ב-<span>\( A \)</span>, כלומר <span>\( {m \choose i} \)</span>. לכן את הסכום האמצעי אפשר לכתוב גם כ-<span>\( \sum_{i=0}^{m}\left(-1\right)^{i}{m \choose i}=\left(1-1\right)^{m} \)</span> (כאן השתמשתי בבינום של ניוטון), ולכן אם <span>\( m&gt;0 \)</span> אז הסכום האמצעי שווה לאפס, ואם <span>\( m=0 \)</span> אז הסכום האמצעי שווה ל-1 (אני משתמש כאן בקונוונציה לפיה <span>\( 0^{0}=1 \)</span>, אבל מי שלא מאמין לי יכול לבדוק ולהיווכח בכך ש-<span>\( \sum_{A\subseteq B\subseteq C}\left(-1\right)^{\left|B-A\right|} \)</span> אכן שווה 1 כאשר <span>\( A=C \)</span>, מה שמצדיק את השימוש בקונוונציה <span>\( 0^{0}=1 \)</span> כאן).</p>

<p>לסיכום, קיבלנו ש-<span>\( \left(TSf\right)\left(A\right)=f\left(A\right) \)</span>, וזאת לכל <span>\( A \)</span>, ולכן <span>\( TS=I \)</span> כנדרש. זה מסיים את הוכחת עקרון ההכלה וההפרדה הכללי ביותר שאני מכיר, אבל - מה בעצם עשינו כאן, לעזאזל?</p>

<p>התחלתי את הפוסט עם הנוסחה <span>\( \left|\bigcup_{i=1}^{n}A_{i}\right|=\sum_{i=1}^{n}\left|A_{i}\right|-\sum_{1\le i&lt;j\le n}\left|A_{i}\cap A_{j}\right|+\dots+\left(-1\right)^{n+1}\left|\bigcap_{i=1}^{n}A_{i}\right| \)</span>. כאן חשבנו על <span>\( A_{i} \)</span> בתור “קבוצת כל האיברים שמקיימים את התכונה ה-<span>\( i \)</span> לפחות” (לא בדיוק!), ולכן על <span>\( A_{i}\cap A_{j} \)</span> בתור כל האיברים שמקיימים לפחות את התכונות <span>\( i,j \)</span> וכן הלאה. בלשון הקבוצות של המשפט שלמעלה, <span>\( S=\left\{ 1,2,\dots,n\right\}  \)</span> ו-<span>\( f\left(A\right)=\left|\bigcap_{i\in A}A_{i}\right| \)</span> (כן, יש לי כאן שימוש כפול מוזר ב-<span>\( A \)</span> וב-<span>\( A_{i} \)</span> במשמעויות שונות לגמרי. אל תגידו לי שזה מה שיחסל אתכם עכשיו).</p>

<p>הנוסחה שלעיל מתארת את <span>\( \bigcup_{i=1}^{n}A_{i} \)</span>, שהוא מספר האיברים שמקיימים לפחות אחת מהתכונות, אבל בדרך כלל התעניינו דווקא במספר האיברים שלא מקיימים <strong>אף אחת </strong>מהתכונות, מה שגרם לנו לחסר את הגודל של <span>\( \bigcup_{i=1}^{n}A_{i} \)</span> ממספר האיברים הכולל ב”עולם” שלנו, שזו דרך אחרת להגיד “מספר האיברים שמקיימים לפחות אפס תכונות” (מעין “חיתוך ריק” שלא ממש ברור איך לכתוב אותו).</p>

<p>בואו נחדד את העניין, אם כן. נגדיר פונקציה<span>\( f_{=}\left(A\right) \)</span> ששווה למספר האיברים שמקיימים <strong>בדיוק</strong> את התכונות שב-<span>\( A \)</span>. אנחנו מעוניינים לרוב למצוא את <span>\( f_{=}\left(\emptyset\right) \)</span>, אבל לפעמים גם עבור קבוצות מחוכמות יותר. כעת, נגדיר גם <span>\( f_{\ge}\left(A\right) \)</span> בתור מספר האיברים שמקיימים <strong>לפחות</strong> את התכונות ב-<span>\( A \)</span>, כלומר בדיוק <span>\( f_{\ge}\left(A\right)=\left|\bigcap_{i\in A}A_{i}\right| \)</span>. כעת קל לראות שמתקיים הקשר</p>

<p><span>\( f_{\ge}\left(A\right)=\sum_{B\supseteq A}f_{=}\left(B\right) \)</span> (הסבירו לעצמכם למה!) כלומר <span>\( f_{\ge}=Tf_{=} \)</span>, ולכן <span>\( f_{=}=T^{-1}f_{\ge} \)</span>, כלומר</p>

<p><span>\( f_{=}\left(A\right)=\sum_{B\supseteq A}\left(-1\right)^{\left|B-A\right|}f_{\ge}\left(B\right) \)</span></p>

<p>ובפרט עבור <span>\( A=\emptyset \)</span> נקבל</p>

<p><span>\( f_{=}\left(\emptyset\right)=\sum_{A}\left(-1\right)^{\left|A\right|}f_{\ge}\left(A\right) \)</span></p>

<p>וזוהי בדיוק נוסחת ההכלה וההפרדה המוכרת והאהובה שלנו, רק בניסוח יותר קומפקטי ויותר קל להבנה (כן! יותר קל! אחרי שבוהים בה הרבה, כנראה…).</p>

<p>אם כן, ראינו שעקרון ההכלה וההפרדה ניתן להצגה בתור מעין “היפוך” - מתחילים מפונקציה א’ שמוגדרת באמצעות סכום על ערכים של פונקציה ב’, “הופכים” ומקבלים את פונקציה ב’ מוצגת בתור סכום משוקלל מסויים על ערכים של פונקציה א’. זה, על רגל אחת, גם התוכן של נוסחת ההיפוך של מביוס; מיהי, מהי ואיך היא מתקשרת למה שראינו פה - בפעם הבאה.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2011/12/24/simultaneous_diagonalization/">&laquo; להטיל לכסון סימולטני בתת-מרחב שמור, בערך</a>
    
    
      <a class="next" href="/2012/01/07/mobius_inversion_formula/">נוסחת ההיפוך של מביוס &raquo;</a>
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2011/12/31/inclusion_exclusion_principle/';
      this.page.identifier = 'http://gadial.net/2011/12/31/inclusion_exclusion_principle/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2011/12/31/inclusion_exclusion_principle/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script>

<!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
