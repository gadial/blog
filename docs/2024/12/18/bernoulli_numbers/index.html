<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>מספרי ברנולי | לא מדויק</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="מספרי ברנולי" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<link rel="canonical" href="http://gadial.net/2024/12/18/bernoulli_numbers/" />
<meta property="og:url" content="http://gadial.net/2024/12/18/bernoulli_numbers/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-18T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="twitter:title" content="מספרי ברנולי" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2024/12/18/bernoulli_numbers/"},"url":"http://gadial.net/2024/12/18/bernoulli_numbers/","@type":"BlogPosting","description":"לא מדויק - בלוג על מתמטיקה ומדעי המחשב","headline":"מספרי ברנולי","dateModified":"2024-12-18T00:00:00+00:00","datePublished":"2024-12-18T00:00:00+00:00","image":"http://gadial.net/assets/img/main/default-card.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/post_list">רשימת הפוסטים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">פוסטים אקראיים</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/lecture_notes">סיכומי הרצאות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2024/12/14/computing_determinants_bareiss_algorithm/">&laquo; איך מחשבים דטרמיננטה עם אלגוריתם בריס?</a>
    
    
      <a class="next" href="/2025/01/31/normal_distribution_1/">מה הקטע עם התפלגות נורמלית? (חלק א': שלוש היסטוגרמות למלכי ההתפלגות במרומם, ועקומה אחת למשול בם ולקשרם) &raquo;</a>
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">מספרי ברנולי</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2024-12-18T00:00:00+00:00" itemprop="datePublished">Dec 18, 2024
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2>בואו נסכום סכומים</h2>

<p>אחד מהדברים הבאמת נחמדים שלמדתי במתמטיקה בתיכון היה הנוסחה לסכום של סדרה חשבונית, שבמקרה הפשוט ביותר שלה הוא הסכום הבא:</p>

<p><span>\( 1+2+3+\ldots+n=\frac{n\left(n+1\right)}{2} \)</span></p>

<p>סביב הסכום הזה יש את הצ’יזבט האהוב על המתמטיקאי קרל פרידריך גאוס, שלכאורה גילה אותו בתור ילד קטן שהמורה בבית הספר נתן לו וליתר התלמידים לסכום את המספרים מ-1 עד 100 כדי להעסיק אותם בזמן שהוא נח. גאוס הילד היה נאמן לסלוגן על כך שמתמטיקאים הם עצלנים: במקום לחבר את הכל במפורש, הוא שם לב לכך ש-1 ועוד 100 שווה 101, וגם 2 ועוד 99 שווה 101 וכן הלאה, כך שיש לו 50 זוגות מספרים שהסכום של כולם הוא 101 ורק צריך לחשב את הכפל הקל 50 כפול 101 ואת זה אפילו אני יודע לעשות בראש ולקבל 5050. הנוסחה שכתבתי למעלה היא אותו דבר: יש לנו <span>\( \frac{n}{2} \)</span> זוגות שהסכום של כולם הוא <span>\( n+1 \)</span>, אז אנחנו פשוט כופלים (אם <span>\( n \)</span> אי זוגי יש איבר בודד באמצע שאי אפשר למצוא לו בן זוג, אבל הנוסחה עדיין עובדת כי היא סופרת אותו בתור “חצי זוג” - נסו בעצמכם לבדוק על מספרים קטנים!)</p>

<p>מה שלא שמעתי עליו בבית הספר, וקצת חבל, הוא שיש לנו נוסחה דומה גם עבור הסכום של <strong>הריבועים</strong> של הטבעיים:</p>

<p><span>\( 1^{2}+2^{2}+3^{2}+4^{2}+\ldots+n^{2}=\frac{n\left(n+1\right)\left(2n+1\right)}{6} \)</span></p>

<p>הנוסחה הזו פחות פשוטה מהקודמת, אבל היא עדיין די פשוטה ומערבת רק מכפלה של שלושה מספרים. זה מעלה את השאלה אם גם כשאני מחבר חזקות גבוהות יותר של הטבעיים, אני עדיין אקבל נוסחה פשוטה יחסית. מה למשל קורה עם <span>\( 1^{3}+2^{3}+3^{3}+\ldots \)</span>? התשובה היא שאכן, יש נוסחה פשוטה יחסית למקרה הזה ובעצם לכל מקרה של <span>\( 1^{m}+2^{m}+3^{m}+\ldots+n^{m} \)</span>, אם כי “פשוטה” זה כמובן עניין יחסי כי ככל ש-<span>\( m \)</span> גדול יותר הנוסחה תהיה מסובכת יותר. אבל מה שאפשר לומר שהופך את העניין לפשוט הוא שני דברים:</p>

<ul> <li>הנוסחה היא תמיד <strong>פולינום</strong> ממעלה <span>\( m+1 \)</span>.</li>


<li>אפשר לכתוב את הנוסחה באופן כללי, לכל <span>\( m \)</span> שהוא, בעזרת משהו שנקרא <strong>מספרי ברנולי.</strong></li>

</ul>

<p>קודם כל - מה זה “פולינום”? יהיה קל להסביר את זה אם ניקח את הנוסחה <span>\( \frac{n\left(n+1\right)}{2} \)</span> ונפתח את הסוגריים. נקבל, על פי כללי החשבון הרגילים, <span>\( \frac{1}{2}n^{2}+\frac{1}{2}n \)</span>. באופן דומה אם נפתח את <span>\( \frac{n\left(n+1\right)\left(2n+1\right)}{6} \)</span> נקבל <span>\( \frac{1}{3}n^{3}+\frac{1}{2}n^{2}+\frac{1}{6}n \)</span>. ביטוי כזה נקרא <strong>פולינום</strong>: זה ביטוי שכולל <strong>משתנה</strong>, במקרה שלנו <span>\( n \)</span>, שהרעיון בו הוא שהוא לא מייצג מספר קונקרטי (אבל אפשר <strong>להציב</strong> בו מספרים קונקרטיים ולראות מה קורה) ואנחנו מסתכלים גם על חזקות שלו, כמו למשל <span>\( n^{2} \)</span> או <span>\( n^{3} \)</span>, ועל מכפלות של כל אלו במספרים, ועל סכומים של כל זה. בביטוי כמו <span>\( \frac{1}{3}n^{3}+\frac{1}{2}n^{2}+\frac{1}{6}n \)</span> אני אומר שה-<span>\( \frac{1}{3} \)</span> שבו מוכפל <span>\( n^{3} \)</span> הוא <strong>המקדם</strong> של <span>\( n^{3} \)</span> (ולכן <span>\( \frac{1}{6} \)</span> הוא המקדם של <span>\( n \)</span> וכדומה). באופן כללי יכול להופיע בפולינום גם מספר שלא מוכפל ב-<span>\( n \)</span> ואז הוא נקרא <strong>המקדם החופשי</strong> אבל אפשר לחשוב עליו כאילו הוא מוכפל ב-<span>\( n^{0} \)</span> (<a href="https://gadial.net/2018/01/01/zero_power_equals_one/">הנה פוסט</a> על למה דברים בחזקת 0 נחשבים 1) אם כי בהקשר שלנו מקדם חופשי כזה פשוט לא הולך להופיע. בנוסף, <strong>המעלה</strong> של פולינום היא החזקה הגבוהה ביותר שמופיעה בו, כלומר לדוגמא, המעלה של <span>\( \frac{1}{3}n^{3}+\frac{1}{2}n^{2}+\frac{1}{6}n \)</span> היא 3.</p>

<p>פולינומים הם באמת ובתמים פונקציות פשוטות מאוד. אם מציבים ערך בפולינום, החישוב רק דורש לחשב חזקות של הערך, לכפול אותן במקדמים, ולחבר. אם אני מצליח לתרגם את החיבור של המספרים <span>\( 1^{10}+2^{10}+3^{10}+\ldots+1000^{10} \)</span> לחישוב של הצבה של 1000 בפולינום ממעלה 11, המרתי את הבעיה של חישוב 1000 חזקות עשיריות של מספרים וחיבור של כולן, לבעיה של חישוב 11 חזקות שונות של אותו מספר (וכשהמספר הזה הוא 1,000 זה לא בדיוק החלק הקשה פה) ואז כפל של 11 החזקות הללו במקדמים וחיבור שלהן - משמעותית פחות עבודה. זה הוביל את יעקב ברנולי, שגילה את הנוסחה הכללית (ולא אכנס כאן לדיון ההיסטורי של מי בדיוק גילה מה ובאיזה נוסח למרות שיש דיון כזה) לכתוב בהתלהבות ביומן שלו שבעזרת הנוסחה לקחה לו פחות מרבע שעה כדי לחשב את סכום החזקות העשיריות של המספרים עד 1000 ולקבל שיצא <span>\( 91,409,924,241,424,243,424,241,924,242,500 \)</span>. גם ברנולי היה נאמן לסלוגן “מתמטיקאים הם עצלנים”, בדרך המאוד מוזרה שבה העצלנות הזו מתבטאת בפועל.</p>

<p>בהמשך אני אראה איך מגיעים לנוסחה ומוכיחים אותה, אבל מכיוון שזה ידרוש מתמטיקה טיפה לא טריוויאלית בואו נתחיל קודם מתיאור של הנוסחה עצמה. בשביל לתאר אותה צריך להגדיר את מספרי ברנולי, ובשבילם צריך קצת קונבנציות מתמטיות.</p>

<p>ראשית, יש את הסימון המוסכם לסכימה. למשל, במקום לכתוב <span>\( 1^{m}+2^{m}+3^{m}+\ldots+n^{m} \)</span> אני כותב <span>\( \sum_{k=1}^{n}k^{m} \)</span>. כאן הסימן <span>\( \Sigma \)</span> אומר שיש לי תיאור של סכום, ה-<span>\( k^{m} \)</span> שליד ה-<span>\( \Sigma \)</span> הוא “האיבר הכללי” של הסכום - כלומר, הצורה שיש לכל איבר בסכום. ה-<span>\( k=1 \)</span> למטה גם אומר שמשתנה הסכימה הוא <span>\( k \)</span>, מה שאומר שבביטוי <span>\( k^{m} \)</span> אני מציב ערכים ב-<span>\( k \)</span> אבל משאיר את <span>\( m \)</span> כמות שהוא, וגם שהערך של <span>\( k \)</span> הזה מתחיל מ-1. ה-<span>\( n \)</span> למעלה אומר שהערך הגדול ביותר ש-<span>\( k \)</span> מגיע אליו הוא <span>\( n \)</span>, והקונבנציה הלא כתובה היא שמגדילים בכל פעם את הערך של <span>\( k \)</span> ב-1. לכן <span>\( \sum_{k=1}^{n}k^{m}=1^{m}+2^{m}+3^{m}+\ldots+n^{m} \)</span>. למרות שסימון הסכימה הזה נראה קצת מרתיע בהתחלה הוא הרבה יותר קומפקטי וברור אחרי שמתרגלים אליו.</p>

<p>שנית, אנחנו הולכים לראות מספרים מהצורה <span>\( {a \choose b} \)</span>. הסימון הזה, שנקרא <strong>מקדם הבינום</strong> (אסביר בהמשך למה) מוגדר באופן הבא. ראשית, מגדירים <strong>עצרת</strong> של מספר טבעי, שמסומנת בתור המספר עם סימן קריאה אחריו: <span>\( a!=1\cdot2\cdot3\cdots a \)</span>, כלומר מכפלת כל המספרים הטבעיים מ-1 עד <span>\( a \)</span> (למשל <span>\( 4!=1\cdot2\cdot3\cdot4=24 \)</span>) ובנוסף ההגדרה המפורשת <span>\( 0!=1 \)</span>. שנית, <span>\( {a \choose b}=\frac{a!}{b!\left(a-b!\right)} \)</span> והביטוי הזה מוגדר כאשר <span>\( 0\le b\le a \)</span>. יש הגיון מאחורי הביטוי הזה, לא סתם החלטנו להמציא אותו: <span>\( {a \choose b} \)</span> סופר את מספר הדרכים שבהן אפשר לבחור <span>\( b \)</span> איברים מתוך <span>\( a \)</span> איברים, במקרה שבו אין חשיבות לסדר שבו הבחירה הזו מתבצעת. (אני מתאר את זה <a href="https://gadial.net/2010/06/20/combinatorics_intro/">כאן</a>).</p>

<p>לבסוף, בנוסחה שאני הולך להציג יופיעו <strong>מספרי ברנולי</strong> שמסומנים ב-<span>\( B_{0},B_{1},B_{2},\ldots \)</span> והם יהיו המושג המרכזי בפוסט.</p>

<p>אני אגלה כבר עכשיו שמספרי ברנולי הראשונים הם <span>\( B_{0}=1,B_{1}=-\frac{1}{2},B_{2}=\frac{1}{6},B_{3}=0 \)</span> ואת ההגדרה הכללית שלהם אביא עוד מעט, אבל קודם אני רוצה להראות איך הם נותנים לנו את הנוסחה לסכום החזקות. אלא שכאן יש סיבוך קטן. אמרתי ש-<span>\( B_{1}=-\frac{1}{2} \)</span>, אבל יש גם כאלו שמעדיפים להגדיר <span>\( B_{1}=\frac{1}{2} \)</span>. שתי הקונבנציות סבירות, אבל אני בפוסט הזה הולך להשתמש בקונבנציה ש-<span>\( B_{1}=-\frac{1}{2} \)</span> וזה טיפה משפיע על הנוסחה: במקום להסתכל על <span>\( \sum_{k=1}^{n}k^{m} \)</span> אני מסתכל על <span>\( \sum_{k=1}^{n-1}k^{m} \)</span>, כלומר על הסכום <span>\( 1^{m}+2^{m}+\ldots+\left(n-1\right)^{m} \)</span>. את הסכום הזה אני אסמן ב-<span>\( S_{m}\left(n\right) \)</span>. כמובן שזה לא שינוי גדול במיוחד; אם ניקח את הנוסחה <span>\( \frac{n\left(n+1\right)}{2} \)</span> שראינו קודם ונחליף את <span>\( n \)</span> ב-<span>\( n-1 \)</span> נקבל <span>\( S_{1}\left(n\right)=\frac{n\left(n-1\right)}{2}=\frac{1}{2}n^{2}-\frac{1}{2}n \)</span>. באופן דומה אם ניקח את <span>\( \frac{n\left(n+1\right)\left(2n+1\right)}{6} \)</span> ונחליף את <span>\( n \)</span> ב-<span>\( n-1 \)</span> נקבל <span>\( S_{2}\left(n\right)=\frac{n\left(n-1\right)\left(2n-1\right)}{6}=\frac{1}{3}n^{3}-\frac{1}{2}n^{2}+\frac{1}{6}n \)</span>.</p>

<p>עכשיו אפשר להציג את הנוסחה הכללית</p>

<ul> <li><span>\( S_{m}\left(n\right)=\frac{1}{m+1}\sum_{k=0}^{m}{m+1 \choose k}B_{k}n^{m+1-k} \)</span></li>

</ul>

<p>בואו נראה איך היא נותנת את הסכומים שכבר ראינו. ראשית, עבור <span>\( 1+2+3+\ldots+n-1 \)</span>, זה הסכום <span>\( \sum_{k=1}^{n-1}k^{1} \)</span>, כלומר <span>\( m=1 \)</span>. לכן כשמשתמשים בנוסחה הכללית שראינו, מקבלים</p>

<p><span>\( S_{1}\left(n\right)=\frac{1}{2}\left[{2 \choose 0}B_{0}n^{2}+{2 \choose 1}B_{1}n^{1}\right]=\frac{1}{2}\left[n^{2}+2\cdot\left(-\frac{1}{2}\right)n\right]=\frac{1}{2}n^{2}-\frac{1}{2}n \)</span></p>

<p>ובאופן דומה:</p>

<p><span>\( S_{2}\left(n\right)=\frac{1}{3}\left[{3 \choose 0}B_{0}n^{3}+{3 \choose 1}B_{1}n^{2}+{3 \choose 2}B_{2}n\right]=\frac{1}{3}\left[n^{3}-\frac{3}{2}n^{2}+\frac{3}{6}n\right]=\frac{1}{3}n^{3}-\frac{1}{2}n^{2}+\frac{1}{6}n \)</span></p>

<p>לי הנוסחה הכללית נראית טיפה מפחידה, אבל כשאני מקליד את המקרים המפורשים החוקיות “מרגישה” לי הרבה יותר פשוטה - בעצם אין בנוסחאות הללו כמעט שום דבר מסובך, חוץ ממספרי ברנולי עצמם - הם ה”לב” של הסיבוך כאן. אז איך מגדירים אותם? ולמה זה עובד? אני פשוט אציג את ההגדרה כאן, ובהמשך נגיע אל ההוכחה שגם תסביר לנו מאיפה ההגדרה בעצם צצה.</p>

<p>ההגדרה היא <strong>רקורסיבית</strong>: אני מניח שכבר הגדרתי את כל המספרים <span>\( B_{0},B_{1},B_{2},\ldots,B_{k-1} \)</span> ומגדיר באמצעותם את <span>\( B_{k} \)</span>, בצורה הבאה:</p>

<p><span>\( B_{k}=-\frac{1}{k+1}\sum_{i=0}^{k-1}{k+1 \choose i}B_{i} \)</span></p>

<p>עם מקרה הבסיס <span>\( B_{0}=1 \)</span>. גם פה, הרבה יותר קל “להרגיש” את ההגדרה כשכותבים כמה מקרים ידנית:</p>

<p><span>\( B_{1}=-\frac{1}{2}{2 \choose 0}B_{0}=-\frac{1}{2} \)</span></p>

<p><span>\( B_{2}=-\frac{1}{3}\left[{3 \choose 0}B_{0}+{3 \choose 1}B_{1}\right]=-\frac{1}{3}\left[1-\frac{3}{2}\right]=-\frac{1}{3}\left(-\frac{1}{2}\right)=\frac{1}{6} \)</span></p>

<p>ואם ממשיכים בחישובים, מקבלים את הסדרה הבאה:</p>

<p><span>\( 1,-\frac{1}{2},\frac{1}{6},0,-\frac{1}{30},0,\frac{1}{42},0,-\frac{1}{30},0,\frac{5}{66},0,-\frac{691}{2730},\ldots \)</span></p>

<p>בדרך כלל ה-<span>\( -\frac{691}{2730} \)</span> הוא זה שבו מרימים ידיים בייאוש ושואלים “אתם צוחקים עלינו?!”. עד לשם, אפשר לראות ניצוצות של חוקיות סבירה - כל המספרים במקומות האי זוגיים למעט <span>\( B_{1} \)</span> הם 0; המספרים האחרים מחליפים סימן בין מינוס לפלוס; במכנה מופיעים מספרים סבירים יחסית כולל 42 יקיר המין האנושי; אבל אז מגיע <span>\( -\frac{691}{2730} \)</span> שכולל מונה ומכנה שאין לאף אחד שמץ של מושג מה הם רוצים מחיינו, והורס כל תקווה לאיזו נוסחה פשוטה יחסית, יותר מנוסחת הנסיגה שיש לנו (יש גם נוסחאות סגורות שכוללות סכימה ואני לא חושב שאפשר לומר שהן פשוטות יותר).</p>

<p>אוקיי, אז זה מה שעושים עם זה, בואו נוכיח שזה עובד.</p>

<h2>בואו נביים בינומים</h2>

<p>לפני שאני מגיע להוכחה האמיתית, שמשתמשת בכלי אלגנטי ויפה אבל לא טריוויאלי להבנה, הנה גישה קצת יותר בסיסית לנושא שכל אחד יכול להבין. בינתיים אני לא אנסה להוכיח את הנוסחה שראינו למעלה אלא משהו צנוע יותר - להוכיח ש-<span>\( S_{m}\left(n\right) \)</span> הוא פולינום ממעלה <span>\( m+1 \)</span> ולהראות איך למצוא אותו. בשביל זה אני קודם כל הולך להשתמש במשהו שנקרא <strong>הבינום של ניוטון</strong> (יש לי עליו <a href="https://gadial.net/2010/06/22/newton_binom/">פוסט</a>) שאומר באופן כללי:</p>

<p><span>\( \left(a+b\right)^{n}=\sum_{i=0}^{n}{n \choose i}a^{i}b^{n-i} \)</span></p>

<p>אם במקום <span>\( b \)</span> יש לי 1 זה נהיה משמעותית פשוט יותר:</p>

<p><span>\( \left(a+1\right)^{n}=\sum_{i=0}^{n}{n \choose i}a^{i}=1+{n \choose 1}a+{n \choose 2}a^{2}+\ldots+{n \choose n-1}a^{n-1}+a^{n} \)</span></p>

<p>עכשיו נשתמש בזה עבור <span>\( a=k \)</span> ו-<span>\( n=m+1 \)</span> ונקבל את הדבר הבא:</p>

<p><span>\( \left(k+1\right)^{m+1}-k^{m+1}=1+{m+1 \choose 1}k+{m+1 \choose 2}k^{2}+\ldots+{m+1 \choose m}k^{m} \)</span></p>

<p>מה שנחמד בביטוי <span>\( \left(k+1\right)^{m+1}-k^{m+1} \)</span> הוא שהוא יוצר לנו <strong>טור טלסקופי</strong>, כלומר טור שבו כל האיברים מבטלים זה את זה חוץ מהראשון והאחרון. כדי לראות את זה, בואו נחבר את כל הביטויים הללו עבור <span>\( k=0,1,2,\ldots,n-1 \)</span>:</p>

<p><span>\( \left[n^{m+1}-\left(n-1\right)^{m+1}\right]+\left[\left(n-1\right)^{m+1}-\left(n-2\right)^{m+1}\right]+\ldots+\left[2^{m+1}-1^{m+1}\right]+\left[1^{m+1}-0^{m+1}\right]=n^{m+1} \)</span></p>

<p>אז אם אנחנו מחברים את אגף <strong>שמאל</strong> של הביטוי</p>

<p><span>\( \left(k+1\right)^{m+1}-k^{m+1}=1+{m+1 \choose 1}k+{m+1 \choose 2}k^{2}+\ldots+{m+1 \choose m}k^{m} \)</span></p>

<p>לכל <span>\( k=0,1,2,\ldots,n-1 \)</span> אנחנו מקבלים <span>\( n^{m+1} \)</span>. מה קורה כשאנחנו מחברים את אגף <strong>ימין</strong>? אפשר להסתכל על כל מחובר לבד. המחובר <span>\( 1 \)</span> יחובר לעצמו <span>\( n \)</span> פעמים ויהפוך ל-<span>\( n \)</span>; המחובר <span>\( {m+1 \choose 1}k \)</span> הופך לטור <span>\( {m+1 \choose 1}\left(1+2+\ldots+n-1\right)={m+1 \choose 1}S_{1}\left(n\right) \)</span>. המחובר <span>\( {m+1 \choose 2}k^{2} \)</span> הופך לטור <span>\( {m+1 \choose 2}S_{2}\left(n\right) \)</span> וכן הלאה. אז אנחנו מקבלים:</p>

<p><span>\( n^{m+1}=n+{m+1 \choose 1}S_{1}\left(n\right)+{m+1 \choose 2}S_{2}\left(n\right)+\ldots+{m+1 \choose m}S_{m}\left(n\right) \)</span></p>

<p>וזו נוסחה די מרהיבה כי היא מקשרת את כל הנוסחאות לסכומים עד לחזקה ה-<span>\( m \)</span>-ית. אפשר לבודד את <span>\( S_{m}\left(n\right) \)</span> ולקבל</p>

<p><span>\( S_{m}\left(n\right)=\frac{1}{m+1}\left[n^{m+1}-{m+1 \choose m-1}S_{m-1}\left(n\right)-\ldots-{m+1 \choose 1}S_{1}\left(n\right)-n\right] \)</span></p>

<p>אם אנחנו כבר יודעים, אינדוקטיבית, שכל <span>\( S_{k}\left(n\right) \)</span> כזה הוא ממעלה לכל היותר <span>\( k+1 \)</span> המסקנה היא שהביטוי באגף ימין הוא פולינום ממעלה <span>\( m+1 \)</span> (בגלל ה-<span>\( n^{m+1} \)</span> שמופיע שם והעובדה שכל ה-<span>\( S_{k}\left(n\right) \)</span>-ים הם ממעלה קטנה יותר). הנוסחה הזו גם פותחת פתח לבניה רקורסיבית של ה-<span>\( B_{m} \)</span>-ים ויש ספרים שנוקטים בגישה הזו (למשל Concrete Mathematics של קנות’ ושות’) אבל זה טכני לא כיף. אני רוצה טכני כיף.</p>

<h2>בואו טכני כיף</h2>

<p>הכלי הטכני שאני משתמש בו נקרא <strong>פונקציות יוצרות</strong>. הרעיון בפונקציות יוצרות הוא זה: אם יש לנו סדרה, אפשר “לשתול” את האיברים שלה בתור מקדמים של טור חזקות, ואז לבצע מניפולציות על הפונקציה שטור החזקות הזה מתאר והמניפולציות הללו יתורגמו למניפולציות בסדרות ש”שתלנו”.</p>

<p>זה לא נושא קל לעיכול (<a href="https://gadial.net/2011/08/07/generating_functions_hardcore_1/">יש לי פוסט</a> עליו) אבל חלק מהקושי בו, לטעמי, הוא שקשה להבין אותו בלי לראות דוגמאות קונקרטיות לשימושים שלו - וכאלו שבאמת מפשטים דברים. עכשיו יש לנו הזדמנות לראות דבר כזה.</p>

<p>הנה מבוא קצרצר לפונקציות יוצרות: בהינתן סדרת מספרים <span>\( a_{0},a_{1},a_{2},\ldots \)</span> <strong>הפונקציה היוצרת</strong> שלה היא הטור <span>\( \sum_{n=0}^{\infty}a_{n}x^{n} \)</span>. צריך להבהיר כבר עכשיו נקודה קריטית - הטור הזה הוא <strong>אובייקט פורמלי</strong>, כמו פולינום. הוא לא פונקציה. לא מציבים ב-<span>\( x \)</span> ערכים (<strong>אפשר</strong> להציב ב-<span>\( x \)</span> ערכים כחלק מניתוח מתקדם יותר של מה שהפונקציה היוצרת מייצגת, אבל לא <strong>חייבים</strong> לעשות את זה). המשמעות של זה היא שאפשר לכתוב משהו כמו <span>\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)</span> וזה יהיה שוויון תקין, שלא תלוי בסייגים כמו לומר ש-<span>\( \left|x\right|&lt;1 \)</span> או משהו.</p>

<p>איך זה עובד? האובייקט הבסיסי הוא כאמור הטור עצמו. על האובייקט הזה מגדירים פעולות חיבור וכפל שהופכות אותו לחוג:</p>

<ul> <li><span>\( \sum_{n=0}^{\infty}a_{n}x^{n}+\sum_{n=0}^{\infty}b_{n}x^{n}=\sum_{n=0}^{\infty}c_{n}x^{n} \)</span> עם <span>\( c_{n}=a_{n}+b_{n} \)</span></li>


<li><span>\( \left(\sum_{n=0}^{\infty}a_{n}x^{n}\right)\left(\sum_{n=0}^{\infty}b_{n}x^{n}\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)</span> עם <span>\( c_{n}=\sum_{k=0}^{n}a_{n-k}b_{k} \)</span></li>

</ul>

<p>הדוגמא הקלאסית לכפל היא <span>\( \left(1+x+x^{2}+\ldots\right)\left(1-x\right)=1 \)</span> (נסו לבצע את החישוב בעצמכם!) שהיא זו שמצדיקה את הכתיב <span>\( 1+x+x^{2}+\ldots=\left(1-x\right)^{-1} \)</span> או, בכתיב הנפוץ יותר, <span>\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)</span>. אני בכוונה לא נכנס יותר מדי לפרטים כי כאמור, יש לי פוסט על זה.</p>

<p>דבר אחד שאין בפוסט וכן נשתמש בו כאן הוא <strong>פונקציות יוצרות אקספוננציאליות</strong>. הפונקציה היוצרת האקספוננציאלית של <span>\( \left\{ a_{n}\right\} _{n=0}^{\infty} \)</span> היא <span>\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!} \)</span>. זה עדיין ביטוי פורמלי וההגדרות למעלה עדיין תקפות לגביו, אבל בואו נראה מה קורה לפעולות החיבור והכפל. עבור חיבור עדיין נקבל <span>\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!}+\sum_{n=0}^{\infty}b_{n}\frac{x^{n}}{n!}=\sum_{n=0}^{\infty}c_{n}\frac{x^{n}}{n!} \)</span> עם <span>\( c_{n}=a_{n}+b_{n} \)</span>, כלומר פעולת החיבור של פונקציות יוצרות של שתי סדרות מניבה את הפונקציה היוצרת של סדרת הסכומים. כפל, לעומת זאת, הוא קצת יותר טריקי.</p>

<p>מה שאנחנו רוצים לעשות הוא, בהינתן הסדרות <span>\( a_{n},b_{n} \)</span>, להבין מה הסדרה <span>\( c_{n} \)</span> שעבורה תתקיים המשוואה</p>

<p><span>\( \left(\sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!}\right)\left(\sum_{n=0}^{\infty}b_{n}\frac{x^{n}}{n!}\right)=\sum_{n=0}^{\infty}c_{n}\frac{x^{n}}{n!} \)</span></p>

<p>כדי להבין למה זה טריקי, בואו נראה מה קורה עבור <span>\( x^{2} \)</span>: אנחנו רוצים שהמכפלה תיתן את המקדם <span>\( \frac{c_{2}}{2!} \)</span>. עכשיו, אם מסתכלים על <span>\( \left(a_{0}+a_{1}x+\frac{a_{2}}{2!}x^{2}\right)\left(b_{0}+b_{1}x+\frac{b_{2}}{2!}x^{2}\right) \)</span> ופותחים סוגריים ומקבצים לפי החזקה של <span>\( x \)</span>, מקבלים</p>

<p><span>\( \left(\frac{a_{2}}{2}b_{0}+a_{1}b_{1}+a_{0}\frac{b_{2}}{2}\right)x^{2} \)</span></p>

<p>אנחנו רוצים להוציא החוצה את ה-<span>\( \frac{1}{2!} \)</span> ולכן נקבל</p>

<p><span>\( \left(a_{2}b_{0}+2a_{1}b_{1}+a_{0}b_{2}\right)\frac{x^{2}}{2!} \)</span></p>

<p>מה קורה באופן כללי? המקדם של <span>\( x^{n} \)</span> יהיה <span>\( \sum_{k=0}^{n}\frac{a_{k}}{k!}\frac{b_{n-k}}{\left(n-k\right)!} \)</span>. עכשיו, זכרו את הבינום של ניוטון: <span>\( {n \choose k}=\frac{n!}{k!\left(n-k\right)!} \)</span>. לכן, אם נכפול ונחלק את הסכום ב-<span>\( n! \)</span>, נקבל</p>

<p><span>\( \sum_{k=0}^{n}\frac{a_{k}}{k!}\frac{b_{n-k}}{\left(n-k\right)!}=\frac{1}{n!}\sum_{k=0}^{n}{n \choose k}a_{k}b_{n-k} \)</span></p>

<p>כלומר, את נוסחת הכפל צריך לתקן באופן הבא:</p>

<ul> <li><span>\( \left(\sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!}\right)\left(\sum_{n=0}^{\infty}b_{n}\frac{x^{n}}{n!}\right)=\sum_{n=0}^{\infty}c_{n}\frac{x^{n}}{n!} \)</span> עם <span>\( c_{n}=\sum_{k=0}^{n}{n \choose k}a_{n-k}b_{k} \)</span></li>

</ul>

<p>עכשיו אפשר לדבר על הפונקציה היוצרת האקספוננציאלית הבסיסית שלנו: זו שמתאימה לסדרה <span>\( a_{n}=1 \)</span>, כלומר לטור <span>\( \sum_{n=0}^{\infty}\frac{x^{n}}{n!} \)</span>. את הפונקציה הזו אני אסמן בסימון המקוצר המסתורי <span>\( e^{x} \)</span>. כמובן, ייתכן שחלקכם מכירים את הסימון הזה והוא לא נראה להם מסתורי, אבל זה <strong>מסוכן מאוד</strong> לחשוב ככה כי למשל אם אני אכתוב עכשיו <span>\( e^{2x} \)</span> אתם תגידו “כמובן, זה הטור <span>\( \sum_{n=0}^{\infty}2^{n}\frac{x^{n}}{n!} \)</span>” וזה יהיה נכון בכל מה שנוגע לפונקציה שנקראת “אקספוננט” שאנחנו פוגשים בחדו”א, אבל כאן אנחנו בעולם קצת שונה, של טורי חזקות פורמליים, והביטוי <span>\( e^{2x} \)</span> הוא פשוט <strong>לא מוגדר</strong>. מה שמתבקש הוא להגדיר אותו בתור <span>\( e^{x}\cdot e^{x} \)</span>, כי כפל כן הגדרנו, אבל צריך לוודא שזה עובד.</p>

<p>מכיוון ש-<span>\( e^{x} \)</span> התאים לסדרה <span>\( a_{n}=1 \)</span>, אז <span>\( e^{x}\cdot e^{x} \)</span> מתאים לסדרה <span>\( c_{n}=\sum_{k=0}^{n}{n \choose k} \)</span>. למרבה השמחה, אנחנו יודעים ש-<span>\( \sum_{k=0}^{n}{n \choose k}=2^{n} \)</span> (הוכחה קומבינטורית: <span>\( {n \choose k} \)</span> הוא מספר הדרכים לבחור <span>\( k \)</span> איברים מתוך <span>\( n \)</span>, ואילו <span>\( 2^{n} \)</span> הוא מספר הדרכים לבחור תת-קבוצה כלשהי מתוך <span>\( n \)</span>) ולכן באמת מקבלים ש-<span>\( e^{x}\cdot e^{x} \)</span> מיוצג על ידי הטור <span>\( \sum_{n=0}^{\infty}2^{n}\frac{x^{n}}{n!} \)</span> מה ש”מצדיק” את הסימון <span>\( e^{2x}=e^{x}\cdot e^{x} \)</span>. בגישה קצת פחות פורמלית הייתי אומר “מכיוון ש-<span>\( e^{x} \)</span> שלי הוגדרה עם אותו טור כמו אקספוננט אז כל תוצאה שיש לנו על אקספוננט עובדת כאן עם הבונוס שלא צריך להתחשב בשיקולי התכנסות” אבל אני לא אעשה את זה.</p>

<p>עכשיו, אם יש לנו את <span>\( e^{2x} \)</span>, מה עם <span>\( e^{kx} \)</span> עבור <span>\( k \)</span> טבעי כללי? ההגדרה המתבקשת היא <span>\( e^{kx}=\sum_{n=0}^{\infty}k^{n}\frac{x^{n}}{n!} \)</span>. הייתי רוצה להראות שזו באמת החזקה ה-<span>\( k \)</span>-ית של <span>\( e^{x} \)</span>, ואת זה אני יכול להוכיח באינדוקציה. נניח שבאמת מתקיים <span>\( e^{kx}=\sum_{n=0}^{\infty}k^{n}\frac{x^{n}}{n!} \)</span> ונוכיח ש-<span>\( e^{x}\cdot e^{kx}=\sum_{n=0}^{\infty}\left(k+1\right)^{n}\frac{x^{n}}{n!} \)</span>.</p>

<p>לצורך ההוכחה שוב נתבסס על הגדרת הכפל עבור האיבר הכללי - הפעם הוא יוצא <span>\( c_{n}=\sum_{i=0}^{n}{n \choose i}k^{i} \)</span>. על <span>\( {n \choose i}k^{i} \)</span> אפשר לחשוב קומבינטורית בתור בחירה של <span>\( i \)</span> מתוך <span>\( n \)</span> איברים, ואז צביעה של כל איבר בצבע מתוך קבוצה בת <span>\( k \)</span> צבעים, כך שאפשר לבחור את אותו צבע יותר מפעם אחת. עכשיו, אם אני סופר את מספר הדרכים לבחור <strong>תת-קבוצה</strong> של <span>\( n \)</span> האיברים ולצבוע את אבריה ב-<span>\( k \)</span> צבעים, אפשר להתחכם טיפה - ל-<span>\( k \)</span> הצבעים נוסיף “צבע שקוף”, ואז פשוט נצבע את כל <span>\( n \)</span> האיברים ב-<span>\( k+1 \)</span> הצבעים, ומי שצבוע בצבע שקוף ייחשב כאילו לא לקחנו אותו לתת הקבוצה. כך קיבלנו שמספר הדרכים הכולל הוא <span>\( \left(k+1\right)^{n} \)</span>, כלומר <span>\( c_{n}=\left(k+1\right)^{n} \)</span>, כמו שרצינו להראות.</p>

<p>למה אני בכלל טורח כל כך להתעסק בחזקות של <span>\( e^{x} \)</span>? מן הסתם אני חותר למשהו. בואו נחזור אל המטרה שלנו - אנחנו רוצים למצוא נוסחה עבור <span>\( S_{m}\left(n\right) \)</span>, לכל <span>\( m \)</span>. קודם ראינו שאולי קשה להבין את <span>\( S_{m}\left(n\right) \)</span> עבור <span>\( m \)</span> <strong>בודד</strong> אבל אם מסתכלים על ה-<span>\( S_{m} \)</span>-ים הללו <strong>כמכלול</strong>, כולם ביחד, יש ביניהם קשרים. פונקציות יוצרות הן בדיוק דרך לנצל את הקשרים הללו, אז די מתבקש לקחת את <span>\( S_{m} \)</span> ולשתול אותם בתוך פונקציה יוצרת. עכשיו, בפונקציה יוצרת מה ששותלים הוא <strong>סדרות מספרים</strong>, אבל <span>\( S_{m} \)</span> היא לא סדרה של מספרים, היא סדרה של פונקציות - אז נבחר <span>\( n \)</span> קונקרטי, נקבל עבורו סדרה קונקרטית של מספרים, <span>\( \left\{ S_{m}\left(n\right)\right\} _{m=0}^{\infty} \)</span>. נשתול אותה בתוך פונקציה יוצרת אקספוננציאלית ונראה מה נקבל:</p>

<p><span>\( \sum_{m=0}^{\infty}S_{m}\left(n\right)\frac{x^{m}}{m!}=\sum_{m=0}^{\infty}\left(\sum_{k=0}^{n-1}k^{m}\right)\frac{x^{m}}{m!} \)</span></p>

<p>עכשיו שימו לב מה קורה כאן: יש לנו פונקציה יוצרת אקספוננציאלית שהאיבר הכללי שלה הוא <strong>סכום סופי</strong> של איברים. זה מתאים לסיטואציה <span>\( c_{n}=a_{n}+b_{n} \)</span> שראינו קודם, רק לא עם שני איברים אלא עם <span>\( n \)</span> איברים, אבל באינדוקציה אפשר להראות שכל איבר כללי שהוא סכום של מספר סופי כלשהו של איברים מתפרק לסכום של פונקציות יוצרות, ולכן נקבל</p>

<p><span>\( \sum_{m=0}^{\infty}S_{m}\left(n\right)\frac{x^{m}}{m!}=\sum_{m=0}^{\infty}\left(\sum_{k=0}^{n-1}k^{m}\right)\frac{x^{m}}{m!}=\sum_{k=0}^{n-1}\left[\sum_{m=0}^{\infty}k^{m}\frac{x^{m}}{m!}\right] \)</span></p>

<p>הפלא ופלא, כל הפונקציות היוצרות שבסכום מתאימות בדיוק לחזקות של <span>\( e \)</span> שראינו קודם, אז קיבלנו את התוצאה</p>

<p><span>\( \sum_{m=0}^{\infty}S_{m}\left(n\right)\frac{x^{m}}{m!}=e^{0x}+e^{x}+e^{2x}+e^{3x}+\ldots+e^{\left(n-1\right)x} \)</span></p>

<p>עכשיו אפשר סוף סוף לראות את הכוח של פונקציות יוצרות: את הביטוי <span>\( e^{0x}+e^{x}+e^{2x}+e^{3x}+\ldots+e^{\left(n-1\right)x} \)</span> אפשר לראות בתור <strong>טור הנדסי</strong>. כזכור, אם יש לנו טור הנדסי <span>\( 1+q+q^{2}+q^{3}+\ldots+q^{n-1} \)</span> אנחנו יודעים לחשב את הסכום שלו על ידי הטריק הבא: נכפול ונחלק ב-<span>\( \left(q-1\right) \)</span> ואז נקבל במונה טור טלסקופי שכל מה שיישאר ממנו הוא <span>\( q^{n}-1 \)</span>, בזמן שבמכנה יהיה לנו <span>\( q-1 \)</span>, כלומר קיבלנו <span>\( 1+q+q^{2}+q^{3}+\ldots+q^{n-1}=\frac{q^{n}-1}{q-1} \)</span>. אם נציב <span>\( q=e^{x} \)</span>, זה נותן לנו את הביטוי <span>\( \frac{e^{nx}-1}{e^{x}-1} \)</span> (חדי העין ישימו לב שטיפה רימיתי פה - אני אחזור לזה בהמשך).</p>

<p>עכשיו, בואו נכפול ונחלק את הביטוי הזה ב-<span>\( x \)</span> ונקבל <span>\( \frac{e^{nx}-1}{e^{x}-1}=\frac{e^{nx}-1}{x}\frac{x}{e^{x}-1} \)</span>. אני עוד מעט אקדיש חלק שלם כדי להסביר למה <span>\( \frac{x}{e^{x}-1}=\sum_{k=0}^{\infty}B_{k}\frac{x^{k}}{k!} \)</span>, כלומר <span>\( \frac{x}{e^{x}-1} \)</span> הוא הפונקציה היוצרת האקספוננציאלית של מספרי ברנולי. לגבי <span>\( \frac{e^{nx}-1}{x} \)</span>, קל יותר לטפל בו: <span>\( e^{nx}=1+nx+\frac{n^{2}x^{2}}{2}+\ldots \)</span> ולכן <span>\( \frac{e^{nx}-1}{x}=n+\frac{n^{2}x}{2}+\ldots=\sum_{k=0}^{\infty}\frac{n^{k+1}}{k+1}\cdot\frac{x^{k}}{k!} \)</span></p>

<p>נסכם לרגע בזהירות את מה שראינו:</p>

<p><span>\( \sum_{m=0}^{\infty}S_{m}\left(n\right)\frac{x^{m}}{m!}=\left(\sum_{k=0}^{\infty}\frac{n^{k+1}}{k+1}\frac{x^{k}}{k!}\right)\left(\sum_{k=0}^{\infty}B_{k}\frac{x^{k}}{k!}\right) \)</span></p>

<p>כלומר, כשעוברים מרמת הפונקציות היוצרות האקספוננציאליות לרמת האיבר הבודד, וזוכרים איך כפל של פונקציות יוצרות אקספוננציאליות עובד כשעוברים לרמת האיבר הבודד, מקבלים:</p>

<p><span>\( S_{m}\left(n\right)=\sum_{k=0}^{m}{m \choose k}B_{k}\frac{n^{\left(m-k\right)+1}}{\left(m-k\right)+1} \)</span></p>

<p>את הגורם שבפנים אפשר לפשט עם עוד תעלול אלגברי/קומבינטורי קטן:</p>

<p><span>\( {m \choose k}\frac{1}{m-k+1}=\frac{m!}{k!\left(m-k\right)!}\cdot\frac{1}{m-k+1}=\frac{m!}{k!\left(m-k+1\right)!}=\frac{1}{m+1}\frac{\left(m+1\right)!}{k!\left(m-k+1\right)!}=\frac{1}{m+1}{m+1 \choose k} \)</span></p>

<p>וקיבלנו את הנוסחה שמציגים בכל מקום:</p>

<p><span>\( S_{m}\left(n\right)=\frac{1}{m+1}\sum_{k=0}^{m}{m+1 \choose k}n^{m+1-k}B_{k} \)</span></p>

<p>וזה היה… ממש טכני? ובכן, כן ולא. אני יודע שזה די מרתיע אבל בסופו של דבר כשמבינים את הרעיון של פונקציות יוצרות כל מה שעשינו פה הוא מאוד סטנדרטי. זה לא אומר שהיה כיף גדול לעשות את זה, אבל בהתחשב בתוצאה הדי כללית שמקבלים פה זה ממש נחמד - בפרט שזו תוצאה שמטפלת בכל אינסוף ה-<span>\( S_{m}\left(n\right) \)</span>-ים בו זמנית.</p>

<p>אבל עדיין לא סיימתי כי נשאר לי להסביר מאיפה מספרי ברנולי הגיעו.</p>

<h2>בואו למסע אל מקורות הברנולי</h2>

<p>אני טענתי, ללא הוכחה, ש-<span>\( \frac{x}{e^{x}-1}=\sum_{k=0}^{\infty}B_{k}\frac{x^{k}}{k!} \)</span>. כלומר אני <strong>מגדיר</strong> את מספרי ברנולי בתור הסדרה ש-<span>\( \frac{x}{e^{x}-1} \)</span> היא הפונקציה היוצרת האקספוננציאלית שלה. יש כאן שתי שאלות</p>

<ul> <li>למה אני יודע בכלל ש-<span>\( \frac{x}{e^{x}-1} \)</span> ניתן לתיאור על ידי טור חזקות כזה?</li>


<li>איך אני יודע שאלו מספרי ברנולי? כלומר, איך אני מראה שמתקיימת הנוסחה הרקורסיבית <span>\( B_{n}=-\frac{1}{n+1}\sum_{k=0}^{n-1}{n+1 \choose k}B_{k} \)</span> שהצגתי קודם?</li>

</ul>

<p>נתחיל מהשאלה הראשונה, למה <span>\( \frac{x}{e^{x}-1} \)</span> ניתן לתיאור על ידי טור חזקות פורמלי. אם לא היינו עובדים במסגרת פורמלית אלא בחדו”א, הסיפור היה הולך ככה: היינו שמים לב שכשמציבים <span>\( x=0 \)</span> אז <span>\( e^{x}=1 \)</span> ולכן <span>\( e^{x}-1=0 \)</span> ולכן המכנה של <span>\( \frac{x}{e^{x}-1} \)</span> יכול להתאפס ומדובר בקטסטרופה. אבל מצד שני, גם <strong>המונה</strong> מתאפס כש-<span>\( x=0 \)</span> ולכן אפשר להשתמש בלהטוט החדו”אי שנקרא כלל לופיטל ולקבל <span>\( \lim_{x\to0}\frac{x}{e^{x}-1}=\lim_{x\to0}\frac{1}{e^{x}}=1 \)</span>. כלומר, אפשר “לתקן” את הפונקציה <span>\( \frac{x}{e^{x}-1} \)</span> כך שב-<span>\( x=0 \)</span> היא תוגדר להיות 1 ולקבל פונקציה נחמדה שאפשר לפתח לטור והכל טוב ויפה.</p>

<p>אני לא הולך לעשות את זה כאן. כאמור, אני דוגל בגישה הפורמלית. בגישה הזו כל מה שיש בעולם הוא טורי חזקות פורמליים ולכן הביטוי <span>\( \frac{x}{e^{x}-1} \)</span> הוא בסך הכל <strong>סימון מקוצר</strong> לטור חזקות פורמלי כלשהו. איזה? על פניו, הטור <span>\( x\left(e^{x}-1\right)^{-1} \)</span> כאשר <span>\( \left(e^{x}-1\right)^{-1} \)</span> הוא טור החזקות ההופכי של <span>\( e^{x}-1 \)</span>, דהיינו הטור שכשכופלים אותו ב-<span>\( e^{x}-1 \)</span> מקבלים <span>\( 1 \)</span>. אבל, לצערנו, <strong>אין טור חזקות כזה</strong>. בשביל שטור חזקות יהיה “הפיך” במובן שציינתי, המקדם החופשי שלו צריך להיות הפיך - ובמקרה שלנו, המקדם החופשי של <span>\( e^{x}-1 \)</span> הוא 0 שאינו הפיך.</p>

<p>אבל לא הכל אבוד, אני לא באמת צריך הופכיים פה. מה שאני רוצה להגיד בביטוי <span>\( \frac{x}{e^{x}-1}=f\left(x\right) \)</span> הוא שמתקיים השוויון <span>\( x=f\left(x\right)\left(e^{x}-1\right) \)</span>. אז אני אבדוק אם אני מסוגל <strong>להגדיר</strong> את <span>\( f\left(x\right) \)</span> כדי שהשוויון הזה יתקיים; אם אני מסוגל, אז אפשר יהיה להשתמש בסימון המקוצר <span>\( \frac{x}{e^{x}-1} \)</span> כמו קודם.</p>

<p>בואו נתחיל מלכתוב את <span>\( f\left(x\right) \)</span> בתור טור חזקות אקספוננציאלי כללי: <span>\( f\left(x\right)=\sum_{k=0}^{\infty}b_{k}\frac{x^{k}}{k!} \)</span>. כרגע אני <strong>לא יודע</strong> שה-<span>\( b_{k} \)</span>-ים הללו הם מספרי ברנולי, או אפילו שאני יכול לבחור להם ערכים בצורה כזו שתצדיק את השוויון <span>\( \frac{x}{e^{x}-1}=f\left(x\right) \)</span>, אבל אני כן יכול לקחת טור חזקות אקספוננציאלי כללי כלשהו, לתת למקדמים שלו את הסימון <span>\( b_{k} \)</span>, לכפול אותו ב-<span>\( e^{x}-1 \)</span> ולראות מה קורה. נוסחת הכפל הרגילה של טורי חזקות אקספוננציאליים תקפה גם כאן:</p>

<p><span>\( c_{n}=\sum_{k=0}^{n}{n \choose k}a_{n-k}b_{k} \)</span></p>

<p>אצלנו <span>\( a_{0}=0 \)</span> ואילו <span>\( a_{k}=1 \)</span> לכל <span>\( k&gt;0 \)</span> (כי החסרת 1 מ-<span>\( e^{x} \)</span> הורידה 1 מהאיבר במקום 0; אם למשל היינו רוצים להוריד 3 מהאיבר במקום 2 היינו צריכים לחסר <span>\( 3x^{2} \)</span>). בנוסחה <span>\( c_{n}=\sum_{k=0}^{n}{n \choose k}a_{n-k}b_{k} \)</span> אני מקבל את <span>\( a_{0} \)</span> כאשר <span>\( k=n \)</span> ולכן המקרה הזה אף פעם לא יופיע, ואני מקבל:</p>

<p><span>\( c_{n}=\sum_{k=0}^{n-1}{n \choose k}b_{k} \)</span></p>

<p>כלומר, עבור <span>\( c_{0} \)</span> אני מקבל סכום “ריק” ולכן <span>\( c_{0}=0 \)</span> תמיד, אין לי שליטה על זה (זו בדיוק הסיבה שבגללה <span>\( e^{x}-1 \)</span> לא הפיך). זו לא באמת בעיה, כי אנחנו רוצים לקבל את התוצאה <span>\( x \)</span>, כלומר התוצאה שמתאימה למקרה שבו <span>\( c_{1}=1 \)</span> ואילו <span>\( c_{n}=0 \)</span> לכל <span>\( n\ne1 \)</span>. אז מה באמת קורה עבור <span>\( c_{1} \)</span>?</p>

<p><span>\( c_{1}={1 \choose 0}b_{0}=b_{0} \)</span></p>

<p>זה מאלץ אותנו להגדיר <span>\( b_{0}=1 \)</span>, אבל יופי - אם אנחנו מגדירים את <span>\( b_{0}=1 \)</span> אנחנו באמת מקבלים את הערך המבוקש של <span>\( c_{1} \)</span>. מה עם היתר?</p>

<p>עבור <span>\( c_{2} \)</span> צריך להתקיים <span>\( c_{2}=0 \)</span>, ואנחנו יודעים ש-</p>

<p><span>\( c_{2}={2 \choose 0}b_{0}+{2 \choose 1}b_{1} \)</span></p>

<p>כלומר:</p>

<p><span>\( 0=b_{0}+2b_{1} \)</span></p>

<p>כלומר:</p>

<p><span>\( b_{1}=-\frac{1}{2}b_{0}=-\frac{1}{2} \)</span></p>

<p>בינתיים זה מתקדם כמו שרצינו! באמת הגדרנו ש-<span>\( b_{1}=-\frac{1}{2} \)</span> בהגדרה שלנו למספרי ברנולי! אז יופי, בואו נעבור למקרה הכללי. נניח שכבר הגדרנו את <span>\( b_{0},b_{1},\ldots,b_{n-1} \)</span> בצורה כזו שבה כל המקדמים עד <span>\( c_{n} \)</span> קיבלו את הערך הנכון, ונטפל ב-<span>\( c_{n+1}=0 \)</span>. על פי נוסחת המכפלה, אנחנו יודעים ש-</p>

<p><span>\( c_{n+1}=\sum_{k=0}^{n}{n+1 \choose k}b_{k} \)</span></p>

<p>נציב <span>\( c_{n+1}=0 \)</span> וכמו כן נפריד את <span>\( b_{n} \)</span> מכל היתר:</p>

<p><span>\( 0={n+1 \choose n}b_{n}+\sum_{k=0}^{n-1}{n+1 \choose k}b_{k} \)</span></p>

<p>עכשיו, <span>\( {n+1 \choose n}=n+1 \)</span> ולכן אחרי העברת אגפים וחלוקה:</p>

<p><span>\( b_{n}=-\frac{1}{n+1}\sum_{k=0}^{n-1}{n+1 \choose k}b_{k} \)</span></p>

<p>וזו בדיוק, אבל בדיוק, הנוסחה עבור מספרי ברנולי:</p>

<p><span>\( B_{n}=-\frac{1}{n+1}\sum_{k=0}^{n-1}{n+1 \choose k}B_{k} \)</span></p>

<p>מה שמשיג את שתי המטרות שלנו: הראנו שבאמת קיימת פונקציה <span>\( f\left(x\right) \)</span> כך ש-<span>\( f\left(x\right)\left(e^{x}-1\right)=x \)</span> למרות ש-<span>\( e^{x}-1 \)</span> לא הפיכה, והראינו שהמקדמים של הפונקציה היוצרת האקספוננציאלית שלה הם מספרי ברנולי <span>\( B_{k} \)</span>, ולכן אפשר לכתוב</p>

<p><span>\( \frac{x}{e^{x}-1}=\sum_{k=0}^{\infty}B_{k}\frac{x^{k}}{k!} \)</span></p>

<p>כפי שרצינו.</p>

<p>האם סיימנו? כמעט. אני עדיין רוצה להסביר את הפורמליות שמאחורי יתר נפנופי הידיים שביצעתי. בואו ניזכר מה בדיוק קרה שם:</p>

<ul> <li>הגעתי איכשהו אל הפונקציה היוצרת <span>\( e^{0x}+\ldots+e^{\left(n-1\right)x} \)</span></li>


<li>טענתי ש-<span>\( e^{0x}+\ldots+e^{\left(n-1\right)x}=\frac{e^{nx}-1}{e^{x}-1} \)</span></li>


<li>טענתי ש-<span>\( \frac{e^{nx}-1}{e^{x}-1}=\frac{e^{nx}-1}{x}\frac{x}{e^{x}-1} \)</span></li>

</ul>

<p>אלו טענות “מפוקפקות” כי הן מחלקות בדברים שאין להם הופכי (גם <span>\( e^{x}-1 \)</span> וגם <span>\( x \)</span>). אז בואו ננסח אותן מחדש בצורה פורמלית יותר אם כי אינטואיטיבית פחות.</p>

<p>כבר ראיתי שיש פונקציה <span>\( f\left(x\right)=\frac{x}{e^{x}-1} \)</span>, כלומר פורמלית זה טור חזקות שמקיים <span>\( \left(e^{x}-1\right)f\left(x\right)=x \)</span>.</p>

<p>בנוסף, ראיתי שיש <span>\( g\left(x\right)=\frac{e^{nx}-1}{x} \)</span>, כלומר פורמלית זה טור חזקות שמקיים <span>\( xg\left(x\right)=e^{nx}-1 \)</span>.</p>

<p>בנוסף, במקום להשתמש בנוסחת הטור ההנדסי אפשר לתאר את הסיטואציה בעזרת כפל בלבד, כלומר להישאר ברמת הטור הטלסקופי: <span>\( \left(e^{x}-1\right)\left(e^{0x}+\ldots+e^{\left(n-1\right)x}\right)=e^{nx}-1 \)</span>.</p>

<p>עכשיו אני יכול לעשות שרשרת של הצבות:</p>

<p><span>\( \left(e^{x}-1\right)\left(e^{0x}+\ldots+e^{\left(n-1\right)x}\right)=e^{nx}-1=xg\left(x\right)=\left(e^{x}-1\right)f\left(x\right)g\left(x\right) \)</span></p>

<p>וכאן מגיע להטוט אחד אחרון: באופן כללי, בכל חוג שהוא <strong>תחום שלמות</strong> (כלומר, אין בו מחלקי אפס - איברים שונים מאפס שכשכופלים אותם מקבלים אפס) אפשר תמיד <strong>לצמצם</strong>: אם יש לי <span>\( ab=ac \)</span> עבור <span>\( a\ne0 \)</span> אז נובע מכך <span>\( b=c \)</span> אפילו אם <span>\( a \)</span> לא הפיך, פשוט כי אני מסתכל על <span>\( a\left(b-c\right)=0 \)</span> ובגלל שאני בתחום שלמות ו-<span>\( a\ne0 \)</span> אז <span>\( b-c=0 \)</span> כלומר <span>\( b=c \)</span>. זה בדיוק מה שאני אשתמש בו למעלה כדי להיפטר מה-<span>\( e^{x}-1 \)</span> המשותף, ולקבל את השוויון הפורמלי לחלוטין:</p>

<p><span>\( e^{0x}+\ldots+e^{\left(n-1\right)x}=f\left(x\right)g\left(x\right) \)</span></p>

<p>מה שמסיים את ההוכחה.</p>

<p>הסיפור של מספרי ברנולי לא נגמר כאן - יש עוד כל מני דברים מעניינים להראות עליהם, אבל עם סיום התוצאה הבסיסית הזו הגענו אל נקודה טובה לעצור בה לבינתיים.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2024/12/14/computing_determinants_bareiss_algorithm/">&laquo; איך מחשבים דטרמיננטה עם אלגוריתם בריס?</a>
    
    
      <a class="next" href="/2025/01/31/normal_distribution_1/">מה הקטע עם התפלגות נורמלית? (חלק א': שלוש היסטוגרמות למלכי ההתפלגות במרומם, ועקומה אחת למשול בם ולקשרם) &raquo;</a>
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2024/12/18/bernoulli_numbers/';
      this.page.identifier = 'http://gadial.net/2024/12/18/bernoulli_numbers/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2024/12/18/bernoulli_numbers/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script>

<!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
