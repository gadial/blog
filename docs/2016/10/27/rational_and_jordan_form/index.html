<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>צורת ז&#39;ורדן והצורה הרציונלית - התיאוריה - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://gadial.net/2016/10/27/rational_and_jordan_form/">
    <meta property="og:title" content="צורת ז&#39;ורדן והצורה הרציונלית - התיאוריה">
    <meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב">
    <meta property="og:site_name" content="לא מדויק">
    
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://gadial.net/2016/10/27/rational_and_jordan_form/">
    <meta name="twitter:title" content="צורת ז&#39;ורדן והצורה הרציונלית - התיאוריה">
    <meta name="twitter:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב">
    
    
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Hamburger menu button */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.8em;
            color: white;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .menu-toggle:hover {
            opacity: 0.8;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .top-nav .nav-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .top-nav .site-title {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0;
                padding: 10px 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            /* Hide nav links by default on mobile */
            .top-nav .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                margin-top: 10px;
            }
            
            /* Show when expanded */
            .top-nav .nav-links.expanded {
                display: flex;
            }
            
            .top-nav .nav-links > a {
                text-align: center;
                padding: 12px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box {
                width: 100%;
                flex-direction: column;
                margin-top: 10px;
                padding-top: 10px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box input {
                width: 100%;
                margin-bottom: 5px;
                min-width: 0;
            }
            
            .top-nav .search-box button {
                width: 100%;
            }
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        /* Force KaTeX content to wrap by overriding its internal structure */
        .katex-html {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .base {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .mord,
        .katex .mbin,
        .katex .mrel,
        .katex .mopen,
        .katex .mclose,
        .katex .mpunct,
        .katex .minner {
            display: inline !important;
            white-space: normal !important;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
            
            /* Hide post navigation on mobile */
            .post-navigation {
                display: none;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <div class="site-title">
                <a href="/" style="color: white; text-decoration: none;">לא מדויק</a>
                <button class="menu-toggle" onclick="toggleMobileMenu()" aria-label="תפריט">
                    ☰
                </button>
            </div>
            <div class="nav-links" id="navLinks">
                <a href="/">דף הבית</a>
                <a href="/random.html">פוסט אקראי</a>
                <a href="/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/2016/10/13/inverse_of_998001/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">על מספרים שאינם ניתנים למציאה בפיתוח העשרוני של 1/998001 ושברים דומים</span>
            </a>
            

            
            <a href="/2016/11/05/perfect_numbers_and_mersenne_primes/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">מספרים מושלמים וראשוניי מרסן</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>צורת ז&#39;ורדן והצורה הרציונלית - התיאוריה</h1>
            <div class="post-meta">
                <span class="date">2016-10-27</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/אלגברה לינארית.html">אלגברה לינארית</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/הצורה הרציונלית.html">הצורה הרציונלית</a>
                    
                    <a href="/tags/משפט הפירוק הפרימרי.html">משפט הפירוק הפרימרי</a>
                    
                    <a href="/tags/משפט הפירוק הציקלי.html">משפט הפירוק הציקלי</a>
                    
                    <a href="/tags/צורת ז&#39;ורדן.html">צורת ז&#39;ורדן</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <p><strong>הקדמה מרגשת</strong></p>
<p>הפוסט הזה מיועד לסגור את שרשרת הפוסטים שלי על אלגברה לינארית שעוסקים בנושא של צורות קנוניות - וככזה, כמובן שלא יהיה ניתן להבין ממנו כמעט כלום בלי לקרוא את הפוסטים הקודמים או בלי להכיר אלגברה לינארית. בכל זאת, בואו נתחיל עם מבוא ידידותי שמזכיר לנו מה בעצם אנחנו עושים כאן ולמה. אני עדיין מניח שאתם מכירים אלגברה לינארית ברמת המה-זו-מטריצה ומה-זו-טרנספורמציה-לינארית.</p>
<p>הרעיון הבסיסי הוא שיש לנו מרחב וקטורי <span class="math">\(V\)</span> סוף-ממדי שמוגדרת מעליו טרנספורמציה לינארית <span class="math">\(T:V\to V\)</span> ("מעליו", כלומר מהמרחב לעצמו; כל הנושא של צורות קנוניות לא מתעסק בטרנספורמציות בין שני מרחבים שונים) ואנחנו מחפשים ל-<span class="math">\(V\)</span> בסיס שבו המטריצה שמייצגת את <span class="math">\(T\)</span> היא שני דברים: <strong>פשוטה</strong> ו<strong>קנונית</strong>. ל"פשוטה" אין הגדרה פורמלית כל כך - בפוסט הזה נראה שתי גישות שונות לעניין הזה - אבל "קנונית" זה משהו יותר ברור: זה אומר <strong>קיום ויחידות</strong>. מרגע שהחלטנו על סוג מסויים של צורה קנונית (למשל, צורת ז'ורדן), לכל טרנספורמציה <span class="math">\(T\)</span> תהיה <strong>קיימת</strong> מטריצה מייצגת ששייכת לצורה הזו, והמטריצה המייצגת הזו תהיה <strong>יחידה</strong> - לא יהיה לנו חופש בחירה בין כמה מטריצות מייצגות שונות.</p>
<p>הדבר דומה לפירוק היחיד למכפלת ראשוניים שיש למספרים טבעיים: אפשר לכתוב את 30 בתור כל מני מכפלות, למשל <span class="math">\(30=1\cdot30\)</span> או <span class="math">\(30=2\cdot15\)</span> או <span class="math">\(30=15\cdot2\)</span> וכדומה, אבל יש רק דרך אחת לכתוב אותו בתור מכפלה של מספרים שכולם ראשוניים (בפרט, 1 לא משתתף במכפלה כי הוא לא נחשב ראשוני) והראשוניים ממויינים לפי גודלם. כלומר, המכפלה היא <span class="math">\(30=2\cdot3\cdot5\)</span>. לכל מספר טבעי חיובי קיימת הצגה כזו (עבור 1 אומרים שזו "המכפלה הריקה").</p>
<p>אני מדבר כאן על טרנספורמציות לינאריות, אבל מכיוון שבאלגברה לינארית סוף-ממדית יש קשר הדוק בין טרנספורמציות לינאריות ומטריצות, אפשר לנסח את כל הדיון גם עבור מטריצות. אם <span class="math">\(A,B\)</span> מייצגות את הטרנספורמציה <span class="math">\(T\)</span> בבסיסים שונים אז פירוש הדבר הוא שקיימת מטריצה הפיכה <span class="math">\(P\)</span> כך ש-<span class="math">\(A=P^{-1}BP\)</span> (<span class="math">\(P\)</span> היא מטריצת מעבר בין הבסיסים; הרעיון הוא שבהינתן וקטור בבסיס של <span class="math">\(A\)</span>, <span class="math">\(P\)</span> מעבירה את הוקטור לבסיס של <span class="math">\(B\)</span>, ואז מפעילים את <span class="math">\(B\)</span>, ואז חוזרים עם <span class="math">\(P^{-1}\)</span> לבסיס של <span class="math">\(A\)</span>). על מטריצות <span class="math">\(A,B\)</span> כאלו שקיימת <span class="math">\(P\)</span> הפיכה כך ש-<span class="math">\(A=P^{-1}BP\)</span> אומרים שהן <strong>דומות</strong>. דמיון מטריצות כזה הוא <strong>יחס שקילות</strong> ולכן אפשר לדבר על נציגים קנוניים למחלקות השקילות, וחזרנו שוב לאותו סיפור. מכאן ואילך אני הולך לדבר על מטריצות ועל טרנספורמציות בצורה חופשית לחלוטין, לפי מה שנוח לי באותה שניה.</p>
<p>הדוגמה הבסיסית ביותר לצורה קנונית שרואים באלגברה לינארית היא <strong>מטריצה אלכסונית</strong>. הבעיה כאן היא שלא כל מטריצה דומה למטריצה אלכסונית - אנחנו מצמצמים מראש את הדיון ל<strong>מטריצות לכסינות</strong>. מה שברור מייד הוא שאם טרנספורמציה מיוצגת על ידי מטריצה אלכסונית, אז מה שנמצא על האלכסון של המטריצה ההיא הם <strong>הערכים העצמיים</strong> של הטרנספורמציה. כלומר, כל הסקלרים <span class="math">\(\lambda\)</span> כך שקיים וקטור <span class="math">\(v\ne0\)</span> עבורו <span class="math">\(Tv=\lambda v\)</span>. האבחנה הזו היא גם מה שהנחה את האופן שבו בודקים אם מטריצה היא לכסינה - מוצאים את הערכים העצמיים שלה, שהם השורשים של פולינום מסויים שנקרא <strong>הפולינום האופייני</strong> של המטריצה, ואז בודקים אם יש "מספיק" וקטורים עצמיים עבור הערכים העצמיים הללו - אם אנחנו מוצאים בסיס למרחב כולו שמורכב מוקטורים עצמיים. אם יש, גמרנו. אם אין, אפשר לשכוח מכך שהמטריצה תהיה דומה למטריצה אלכסונית.</p>
<p>ה"פתרון" לבעיה של "אין מספיק וקטורים עצמיים" הוא צורת ז'ורדן. צורת ז'ורדן היא מטריצה "כמעט-אלכסונית" - הערכים העצמיים עדיין יושבים על האלכסון הראשי, אבל באלכסון שמעליו יכולים להופיע פה ושם 1-ים. אם להיות יותר מדויקים, צורת ז'ורדן היא מטריצה <strong>בלוקים</strong>, כשכל בלוק הוא תת-מטריצה בעצמו שאנחנו "שותלים" על האלכסון הראשי. בלוק ז'ורדן שכזה בנוי ממטריצה סקלרית (כלומר, כזו שיש על האלכסון הראשי שלה ערך קבוע יחיד) ו-1-ים בכל האלכסון שמעל האלכסון הראשי. משהו כזה:</p>
<p><span class="math">\(\left(\begin{array}{ccc}\lambda & 1 & 0\\0 & \lambda & 1\\0 & 0 & \lambda\end{array}\right)\)</span></p>
<p>זו דוגמה לבלוק ז'ורדן מגודל 3. על מטריצה אלכסונית אפשר לחשוב כאילו היא מורכבת כולה מבלוקי ז'ורדן מגודל 1, כך שצורת ז'ורדן מכלילה את הלכסון הרגיל. אם כן, האם הגענו אל המנוחה ואל הנחלה? כמעט. בשביל שלמטריצה כלשהי תהיה צורת ז'ורדן, צריך שכל הערכים העצמיים שלה <strong>יהיו בשדה שמעליו עובדים</strong>. מה זה אומר? קחו את הפולינום <span class="math">\(x^{2}+1\)</span> בתור דוגמה. השורשים של הפולינום הזה הם מספרים מדומים: <span class="math">\(i\)</span> ו-<span class="math">\(-i\)</span>. הם שייכים לשדה <span class="math">\(\mathbb{C}\)</span> אבל לא לשדה <span class="math">\(\mathbb{R}\)</span>. זה אומר שאם יש מטריצה שהפולינום האופייני שלה הוא <span class="math">\(x^{2}+1\)</span>, היא תהיה לכסינה מעל <span class="math">\(\mathbb{C}\)</span> אבל לא מעל <span class="math">\(\mathbb{R}\)</span>. למה? כי ה-<span class="math">\(P\)</span> המלכסנת תהיה חייבת להיות עם מקדמים שהם לא ממשיים (או באופן שקול, הבסיס שבו הטרנספורמציה הרלוונטית תיוצג על ידי מטריצה אלכסונית יהיה עם וקטורים שהכניסות שלהם לא כולן ממשיות).</p>
<p>זה מביא אותנו אל <strong>הצורה הרציונלית</strong> שחומקת גם מהבעיה הזו. כל מטריצה דומה למטריצה בצורה הרציונלית. בלי תלות בשאלות כמו לכסינה/לא לכסינה. בלי תלות בשאלות כמו האם כל השורשים בשדה או לא. תמיד. המחיר שאנחנו משלמים? זו לא צורה עד כדי כך פשוטה; היא בוודאי פחות אינפורמטיבית מאשר צורת ז'ורדן.</p>
<p>בואו נטפל קודם כל בצורה הרציונלית, ואז בצורת ז'ורדן.</p>
<p><strong>הצורה הרציונלית</strong></p>
<p>מטריצה בצורה הרציונלית היא גם כן מטריצת בלוקים, כאשר כל בלוק הוא <strong>מטריצה מלווה</strong> של פולינום מסויים. מה זו מטריצה מלווה? בהינתן פולינום מתוקן <span class="math">\(x^{d}+a_{d-1}x^{d-1}+\dots+a_{1}x+a_{0}\)</span>, המטריצה המלווה שלו היא המטריצה</p>
<p><span class="math">\(\left(\begin{array}{ccccc}0 & 0 & 0 & \cdots & -a_{0}\\1 & 0 & 0 & \cdots & -a_{1}\\0 & 1 & 0 & \cdots & -a_{2}\\\vdots & \vdots & \vdots & \ddots & \vdots\\0 & 0 & 0 & \cdots & -a_{d-1}\end{array}\right)\)</span></p>
<p>כלומר, מטריצה שכולה אפסים למעט האלכסון <strong>מתחת</strong> לאלכסון הראשי שכולו 1-ים, ולמעט הטור האחרון במטריצה שכולל את המקדמים של הפולינום, עם סימן מינוס עליהם. זה... זה לא נראה נחמד במיוחד, אני יודע. בטח נראה פחות נחמד מצורת ז'ורדן. עדיין, אני מקווה שנתיידד קצת עם היצור המוזר הזה בקרוב, אחרי שנבין מאיפה הצורה ה"מוזרה" שלו מגיעה.</p>
<p>מכיוון שכל בלוק שהוא מטריצה מלווה של פולינום נקבע באופן יחיד על פי הפולינום הזה, מה שמאפיין את הצורה הרציונלית הוא סדרת הפולינומים שמכתיבה את סדרת הבלוקים. כלומר, יש לנו סדרת פולינומים <span class="math">\(p_{1},p_{2},\dots,p_{k}\)</span> שמגדירה באופן יחיד את מטריצת הבלוקים הרלוונטית. הדרישה שלנו מהצורה הרציונלית היא שבסדרת הפולינומים הזו, כל פולינום יחלק את קודמו. כלומר, <span class="math">\(p_{i+1}\)</span> מחלק את <span class="math">\(p_{i}\)</span> לכל <span class="math">\(1\le i<k\)</span>.</p>
<p>אחדד את זה על ידי כך שאצטט במפורש את המשפט הרלוונטי: לכל מטריצה ריבועית <span class="math">\(A\)</span>, מעל כל שדה, קיימת מטריצה יחידה <span class="math">\(B\)</span> כך ש-<span class="math">\(B=P^{-1}AP\)</span> עבור <span class="math">\(P\)</span> הפיכה כלשהי, ו-<span class="math">\(B\)</span> היא בצורה רציונלית, דהיינו היא מטריצת בלוקים שבה הבלוקים הם מטריצות מלווות של סדרת פולינומים <span class="math">\(p_{1},p_{2},\dots,p_{k}\)</span> שבה כל פולינום מחלק את קודמו:</p>
<p><span class="math">\(B=\left(\begin{array}{cccc}B_{1}\\ & B_{2}\\ & & \ddots\\ & & & B_{k}\end{array}\right)\)</span></p>
<p>כך ש-<span class="math">\(B_{i}\)</span> היא המטריצה המלווה של הפולינום <span class="math">\(p_{i}\)</span>.</p>
<p>אני רוצה לחדד עוד קצת את המשמעות של ה<strong>יחידה</strong> הזה: זה אומר שאם קיימת מטריצה <span class="math">\(C\)</span> כך ש-<span class="math">\(C=Q^{-1}AQ\)</span> עבור <span class="math">\(Q\)</span> הפיכה כלשהי, ו-<span class="math">\(C\)</span> היא בצורה רציונלית עם סדרת הפולינומים <span class="math">\(q_{1},\dots,q_{t}\)</span> אז <span class="math">\(t=k\)</span> ו-<span class="math">\(q_{i}=p_{i}\)</span> לכל <span class="math">\(1\le i\le k\)</span>.</p>
<p>יפה. עכשיו כשאנחנו מבינים מה זה אומר, בואו נבין איך מגיעים לזה. ראשית כל נבין מה הקטע הזה עם מטריצות בלוקים. הצורה הרציונלית זו מטריצת בלוקים. גם צורת ז'ורדן זו מטריצת בלוקים. בלוקים בלוקים בלוקים. למה זה? ובכן, זו תוצאה ישירה של כך שאנחנו מחלקים את המרחב הוקטור <span class="math">\(V\)</span> שלנו לתתי-מרחבים <strong>אינווריאנטיים</strong> ביחס לטרנספורמציה <span class="math">\(T\)</span> שאנחנו מוצאים לה את הצורה הקנונית. תת-מרחב <span class="math">\(W\subseteq V\)</span> הוא אינוריאנטי ביחס ל-<span class="math">\(T\)</span> אם <span class="math">\(T\left(W\right)\subseteq W\)</span>. כלומר, אם מפעילים את <span class="math">\(T\)</span> על משהו ב-<span class="math">\(W\)</span> מקבלים משהו ב-<span class="math">\(W\)</span>. עכשיו, אם <span class="math">\(V=W_{1}\oplus W_{2}\oplus\dots\oplus W_{k}\)</span> כאשר כל ה-<span class="math">\(W\)</span>-ים הם אינוריאנטיים ביחס ל-<span class="math">\(T\)</span>, אז אפשר לקחת בסיס לכל אחד מה-<span class="math">\(W\)</span>-ים בנפרד ואז איחוד כל הבסיסים הללו יהיה בסיס ל-<span class="math">\(V\)</span> (כאן חשוב שהסכום יהיה סכום ישר אחרת לאו דווקא נקבל בסיס). בבסיס הזה המטריצה המייצגת של <span class="math">\(T\)</span> תהיה מטריצת בלוקים כאשר כל בלוק מתאים לאחד מתתי-המרחבים <span class="math">\(W\)</span>. למה? כי בואו נזכור מה זו מטריצה מייצגת: אם הבסיס שלנו הוא <span class="math">\(B=\left\{ b_{1},\dots,b_{n}\right\} \)</span> אז העמודה ה-<span class="math">\(i\)</span> בה היא וקטור הקואורדינטות של <span class="math">\(T\left(b_{i}\right)\)</span> על פי הבסיס <span class="math">\(B\)</span>. כעת, אצלנו כל איבר בסיס <span class="math">\(b_{i}\)</span> שכזה שייך לאחד מה-<span class="math">\(W\)</span>-ים, ולכן הקואורדינטות היחידות שאולי לא יהיו 0 ב-<span class="math">\(T\left(b_{i}\right)\)</span> יהיו שייכות לאברי הבסיס של אותו <span class="math">\(W\)</span>. למשל, אם <span class="math">\(W\)</span> הראשון נפרש על ידי <span class="math">\(b_{1},b_{2},b_{3},b_{4}\)</span>, אז <span class="math">\(T\left(b_{1}\right)\)</span> יתן לנו עמודה שהיא כולה אפסים חוץ אולי מ-4 הכניסות הראשונות, וכך גם <span class="math">\(T\left(b_{2}\right),T\left(b_{3}\right),T\left(b_{4}\right)\)</span>. קיבלנו שבארבע העמודות הראשונות הכל יהיה אפסים חוץ אולי מהבלוק מגודל 4 שיושב על האלכסון הראשי. וכך זה נמשך.</p>
<p>אם כן, זה הרעיון הן בצורה הרציונלית והן בצורת ז'ורדן - מחלקים איכשהו את <span class="math">\(V\)</span> לתתי-מרחבים אינוריאנטיים, שכאשר <strong>מצמצמים</strong> את <span class="math">\(T\)</span> אליהם, המטריצה המייצגת שלה יוצאת פשוטה יחסית - בלוק ז'ורדן במקרה של צורת ז'ורדן, ומטריצה מלווה במקרה של הצורה הרציונלית. ההבדל בין שתי הצורות הוא באופן שבו מחלקים את המרחב. בסדרת הפוסטים שלי על אלגברה לינארית הראיתי שני משפטים שמפרקים את <span class="math">\(V\)</span> לסכום ישר של תתי-מרחבים אינוריאנטיים "מעניינים": <a href="http://www.gadial.net/2012/01/09/primary_decomposition_theorem/">משפט הפירוק הפרימרי </a>ו<a href="http://www.gadial.net/2016/09/29/cyclic_decomposition_theorem/">משפט הפירוק הציקלי</a>. הצורה הרציונלית היא מה שמתקבל כמעט מייד ממשפט הפירוק הציקלי; כפי שתכף נראה, הצורה הרציונלית היא פשוט דרך אחרת לנסח את משפט הפירוק הציקלי. צורת ז'ורדן מתקבלת מהפירוק הפרימרי, כשאחריו מטפלים בכל תת-מרחב לחוד ומפעילים על אותו תת מרחב את משפט הפירוק הציקלי, אבל עבור טרנספורמציה לינארית אחרת. כלומר, זה שילוב לא לגמרי טריוויאלי של משפטי הפירוק הפרימרי והציקלי, ולכן זה נחמד במיוחד.</p>
<p>נתחיל עם הצורה הרציונלית. מה שצריך לזכור הוא מה הולך במשפט הפירוק הציקלי. אני לא אניח שאתם הולכים לקרוא את הפוסט המפלצתי בנושא, אז בואו נזכיר את זה בקצרה: המשפט אומר שבהינתן <span class="math">\(V\)</span> ובהינתן טרנספורמציה לינארית <span class="math">\(T\)</span> קיים למרחב פירוק <span class="math">\(V=W_{1}\oplus\dots\oplus W_{k}\)</span> שבו כל ה-<span class="math">\(W\)</span>-ים הם מרחבים <span class="math">\(T\)</span>-ציקליים. מה זה מרחב <span class="math">\(T\)</span>-ציקלי? מרחב שמורכב בדיוק מכל הוקטורים שמתקבלים מוקטור מסויים <span class="math">\(w\)</span> ("היוצר") על ידי הפעלות חוזרות ונשנות של <span class="math">\(T\)</span>. כתבתי את זה במקור בתור <span class="math">\(Z\left(w;T\right)\triangleq\text{span}\left\{ T^{0}\left(w\right),T^{1}\left(w\right),T^{2}\left(w\right),\dots\right\} \)</span> ומהר מאוד התברר שהמרחב הזה שווה בדיוק לקבוצה <span class="math">\(\left\{ fw\ |\ f\in\mathbb{F}\left[x\right]\right\} \)</span> כאשר <span class="math">\(fw\)</span> זה סימון מקוצר ל<span class="math">\(f\left(T\right)\left(w\right)\)</span>, כלומר ללקיחת פולינום כלשהו <span class="math">\(f\)</span>, הצבת <span class="math">\(T\)</span> בתוך הפולינום וקבלת טרנספורמציה לינארית, ואז הפעלה שלה על <span class="math">\(w\)</span>.</p>
<p>מה שנחמד במרחבים הללו הוא שהבסיס שלהם הוא פשוט במיוחד ביחס ל-<span class="math">\(T\)</span>: הוא בסך הכל מהצורה <span class="math">\(\left\{ T^{0}\left(w\right),T^{1}\left(w\right),\dots,T^{n-1}\left(w\right)\right\} \)</span>. מהו <span class="math">\(n\)</span>? ובכן, בואו נזכור שקיימים פולינומים שמתאפסים כאשר מציבים בהם את <span class="math">\(T\)</span>, ולפולינום המתוקן מהמעלה החיובית הקטנה ביותר שמאפס את <span class="math">\(T\)</span> קוראים <strong>הפולינום המינימלי</strong> של <span class="math">\(T\)</span>. אם נסמן אותו ב-<span class="math">\(m_{T}\)</span>, אז אנחנו יודעים ש-<span class="math">\(m_{T}w=0\)</span>. זה מראה שקיים פולינום <strong>כלשהו</strong> שמאפס את <span class="math">\(w\)</span>, אבל ייתכן שיש כאלו שקטנים אפילו יותר מ-<span class="math">\(m_{T}\)</span>. את הפולינום המתוקן המינימלי <strong>מביניהם</strong> אסמן ב-<span class="math">\(p\)</span> ואקרא לו <strong>המאפס</strong> של <span class="math">\(w\)</span>. כעת, <span class="math">\(n\)</span> היא בסך הכל הדרגה של <span class="math">\(p\)</span>. בואו נכתוב את <span class="math">\(p\)</span> באופן מפורש:</p>
<p><span class="math">\(p\left(x\right)=x^{n}+a_{n-1}x^{n-1}+\dots+a_{1}x+a_{0}\)</span></p>
<p>כאן המקדם של <span class="math">\(x^{n}\)</span> הוא 1 כי אמרנו ש-<span class="math">\(p\)</span> הוא פולינום מתוקן. על שאר המקדמים אני לא מניח כלום. כעת, אם נציב בפולינום הזה את <span class="math">\(T\)</span> ונפעיל את כל זה על <span class="math">\(w\)</span>, נקבל:</p>
<p><span class="math">\(\left(T^{n}+a_{n-1}T^{n-1}+\dots+a_{1}T+a_{0}\right)w=0\)</span></p>
<p>ואחרי העברת אגפים נקבל</p>
<p><span class="math">\(T^{n}w=-a_{n-1}T^{n-1}w-\dots-a_{1}Tw-a_{0}w\)</span></p>
<p>זה מסביר למה לא "צריך" את הוקטור <span class="math">\(T^{n}w\)</span> או חזקות נוספות של <span class="math">\(T\)</span> בבסיס עבור <span class="math">\(W\)</span>: אנחנו מתחילים לקבל צירופים לינאריים של וקטורים שכבר יש לנו. אבל המשוואה שלמעלה מעניינת לא רק בגלל זה; אתם כבר רואים איך מקבלים מפה את המבנה המוזר של המטריצה המלווה?</p>
<p>בואו נסמן את הבסיס <span class="math">\(\left\{ T^{0}\left(w\right),T^{1}\left(w\right),\dots,T^{n-1}\left(w\right)\right\} \)</span> בתור <span class="math">\(\mathcal{B}=\left\{ b_{0},b_{1},\dots,b_{n-1}\right\} \)</span>. כלומר, <span class="math">\(b_{i}=T^{i}\left(w\right)\)</span>. כדי לדעת איך נראית המטריצה המייצגת של <span class="math">\(T\)</span> בבסיס <span class="math">\(\mathcal{B}\)</span> אנחנו צריכים להפעיל את <span class="math">\(T\)</span> על כל איבר בסיס ולראות את וקטור הקואורדינטות המתקבל. עבור רובם זה קל: <span class="math">\(T\left(b_{0}\right)=T\left(T^{0}\left(w\right)\right)=T^{1}\left(w\right)=b_{1}\)</span>, ובאופן דומה <span class="math">\(T\left(b_{1}\right)=b_{2}\)</span> וכן הלאה. זה אומר שוקטור העמודה שמתאים לעמודה של <span class="math">\(b_{i}\)</span> יכיל 1 בודד, בשורה ה-<span class="math">\(i+1\)</span> - כלומר, בדיוק מתחת לאלכסון הראשי. כל זה נכון עד לעמודה האחרונה, כלומר עד ל-<span class="math">\(T\left(b_{n}\right)\)</span>. כאן אנחנו משתמשים במשוואה שכתבתי למעלה ומקבלים</p>
<p><span class="math">\(T\left(b_{n}\right)=-a_{n-1}b_{n-1}-\dots-a_{1}b_{1}-a_{0}b_{0}\)</span></p>
<p>וזה נותן לנו בדיוק את העמודה הימנית ביותר של המטריצה המלווה של <span class="math">\(p\)</span>. קיבלנו, אם כן, שהמטריצה המייצגת של <span class="math">\(T\)</span> (כאשר <span class="math">\(T\)</span> מצומצמת ל-<span class="math">\(W\)</span>) בבסיס <span class="math">\(\mathcal{B}\)</span> היא בדיוק המטריצה המלווה של <span class="math">\(p\)</span>, כאשר <span class="math">\(p\)</span> הוא המאפס של <span class="math">\(w\)</span>, שהוא היוצר של <span class="math">\(W\)</span>.</p>
<p>החתיכה האחרונה בפאזל הזה הוא הדבר הנוסף שמשפט הפירוק הציקלי נותן לנו: הוא אומר שאם <span class="math">\(V=W_{1}\oplus\dots\oplus W_{k}\)</span> כאשר <span class="math">\(W_{i}=Z\left(w_{i};T\right)\)</span> , ואם נסמן את המאפס של <span class="math">\(w_{i}\)</span> ב-<span class="math">\(p_{i}\)</span>, אז המאפסים הללו מקיימים את יחס החלוקה שבו כל מאפס מחלק את קודמו: <span class="math">\(p_{i+1}\)</span> מחלק את <span class="math">\(p_{i}\)</span>, והוא אומר שסדרת הפולינומים הללו היא <strong>יחידה</strong>. שימו לב: הוא לא אומר "יש פירוק יחיד לתת-מרחבים ציקליים" כי זה לא נכון; כל מה שהוא אומר הוא שסדרת המאפסים שלהם, עם תנאי החלוקה הזה, היא יחידה. זה בדיוק מה שהיה חסר לנו. סדרת הפולינומים <span class="math">\(p_{1},\dots,p_{k}\)</span> הזו מגדירה לנו את הצורה הרציונלית בצורה מלאה. הצורה הרציונלית הרי לא תלויה ב-<span class="math">\(w\)</span>-ים או אפילו ב-<span class="math">\(W\)</span>-ים; מה שקובע את המטריצה בסופו של דבר הוא רק סדרת הפולינומים (וכן, יכולים להיות בסיסים שונים שבכולם <span class="math">\(T\)</span> מיוצגת על ידי אותה מטריצה שהיא בצורה רציונלית, אין עם זה בעיה).</p>
<p>הפולינומים <span class="math">\(p_{1},\dots,p_{k}\)</span> הללו נקראים <strong>הגורמים האינוריאנטיים</strong> של <span class="math">\(T\)</span>. כעת, משראינו שהם תמיד קיימים, נשאלת השאלה הפשוטה - בהינתן מטריצה <span class="math">\(A\)</span>, איך מוצאים את הגורמים האינוריאנטיים שלה? למשפט הפירוק הציקלי אין הוכחה קונסטרוקטיבית במיוחד - שלב מרכזי שם הוא "ניקח וקטור שממקסם כך וכך ונעשה איתו ניסים ונפלאות" בלי ממש להסביר איך מוצאים את הוקטור הזה. האם יש אלגוריתם פשוט יחסית למציאת הגורמים האינוריאנטיים? באופן מפתיע (עבורי) יש כזה, והוא מאוד דומה לדירוג מטריצות. רק שבמקום לדרג את <span class="math">\(A\)</span> מדרגים את המטריצה <span class="math">\(xI-A\)</span> (שהיא מטריצה שחיה מעל החוג <span class="math">\(\mathbb{F}\left[x\right]\)</span> ולא מעל השדה <span class="math">\(\mathbb{F}\)</span>), ופעולות הדירוג שלנו הן:</p>
<ol>
    <li>החלפת שתי שורות או עמודות.</li>
    <li>הוספה לשורה אחת של שורה אחת שמוכפלת בסקלר מתוך <span class="math">\(\mathbb{F}\left[x\right]\)</span> (דהיינו, מוכפלת בפולינום כלשהו מעל <span class="math">\(\mathbb{F}\)</span>), ואותו הדבר עם עמודות.</li>
    <li>הכפלה של שורה או עמודה אחת ב<strong>איבר הפיך</strong> מתוך <span class="math">\(\mathbb{F}\left[x\right]\)</span>, כלומר באיבר של <span class="math">\(\mathbb{F}\)</span>.</li>
</ol>
<p>אלמלא התנאי המעט שונה ב-3 והעובדה שאפשר לפעול גם על עמודות, זה היה בדיוק דירוג מטריצות כמו שרואים כשרק מתחילים להתעסק עם אלגברה לינארית. אבל מה היעד שלו? בדירוג מטריצות "רגיל" היעד הוא להגיע למטריצה שבה כל הכניסות הן 0 למעט כניסות שהן 1 ש"אי אפשר לוותר עליהן", ובמקרה שבו <span class="math">\(A\)</span> הפיכה נקבל שיש 1-ים בדיוק על האלכסון הראשי. במקרה שלנו מובטח שנוכל לאפס את כל מה שאינו על האלכסון הראשי, אבל על האלכסון הראשי עשויים להישאר פולינומים, ועל ידי החלפות מתאימות אפשר להביא את המטריצה לצורה הבאה:</p>
<p><span class="math">\(\left(\begin{array}{ccccccc}1\\ & \ddots\\ & & 1\\ & & & a_{1}\left(x\right)\\ & & & & a_{2}\left(x\right)\\ & & & & & \ddots\\ & & & & & & a_{k}\left(x\right)\end{array}\right)\)</span></p>
<p>כאשר הפולינומים <span class="math">\(a\left(x\right)\)</span> על האלכסון מקיימים את יחסי החלוקה שלנו (כל אחד מחלק את קודמו). הצורה הזו נקראת <strong>הצורה הנורמלית של סמית</strong> (לפעמים מגדירים הפוך, שכל פולינום מחלק את הבא אחריו, אבל מה זה משנה). להוכיח שכל זה באמת עובד? זה עניין לפוסט נפרד.</p>
<p>והנה הערה מעניינת לסיום, שתהיה מעניינת עוד יותר עוד רגע, כשנגיע לצורת ז'ורדן: הגורמים האינוריאנטים הם לא סתם פולינומים אקראיים. הם קשורים בקשר הדוק מאוד לפולינומים המינימלי והאופייני של <span class="math">\(T\)</span>. ליתר דיוק: <span class="math">\(p_{1}\)</span> (הגורם האינוריאנטי הראשון, הגדול ביותר, זה שמתחלק על ידי היתר) הוא בדיוק הפולינום המינימלי, ואילו המכפלה <span class="math">\(p_{1}\cdots p_{k}\)</span> היא בדיוק הפולינום האופייני של <span class="math">\(T\)</span>. למה? ובכן, זה לא טריוויאלי. את זה ש-<span class="math">\(p_{1}\)</span> הוא הפולינום המינימלי של <span class="math">\(T\)</span> הראיתי במובלע בהוכחת שלב ה"יחידות" של משפט הפירוק הציקלי; הרעיון הוא שאם <span class="math">\(V\)</span> הוא סכום ישר של מרחבים ציקליים, והמאפסים של <strong>כל</strong> המרחבים הציקליים הללו מחלקים את <span class="math">\(p_{1}\)</span>, אז הפעלת <span class="math">\(p_{1}\)</span> על איבר כלשהו של המרחב מאפסת את כל הרכיבים שלו ולכן מאפסת אותו. לכן הפולינום המינימלי מחלק את המאפס <span class="math">\(p_{1}\)</span>. מצד שני, המאפסים תמיד מחלקים את הפולינום המינימלי.</p>
<p>דרך פשוטה לראות שמכפלת כל הגורמים האינוריאנטיים היא הפולינום האופייני היא לזכור שהפולינום האופייני הוא הדטרמיננטה, מעל <span class="math">\(\mathbb{F}\left[x\right]\)</span>, של המטריצה <span class="math">\(xI-A\)</span>, ולזכור שדטרמיננטה <strong>לא משתנה</strong> על ידי פעולות אלמנטריות, פרט לכך שכפל בסקלר כלשהו של שורה כופל גם את הדטרמיננטה בסקלר הזה (זאת להבדיל מהוספה של כפולה בסקלר של שורה לשורה אחרת, ש<strong>אינה</strong> משנה את הדטרמיננטה). אצלנו, התנאי לכפל בסקלר הוא שהסקלר יהיה שייך ל-<span class="math">\(\mathbb{F}\)</span>, כלומר הפיך; כלומר, הפולינום שהוא הדטרמיננטה שנקבל בסופו של דבר יהיה זהה לפולינום האופייני עד כדי כפל באיבר של <span class="math">\(\mathbb{F}\)</span>; אבל הפולינום האופייני הוא מתוקן, וגם הדטרמיננטה של צורת סמית היא פולינום מתוקן (מכפלה של פולינומים מתוקנים) כך שהם יהיו שווים.</p>
<p>עכשיו אפשר לעבור אל צורת ז'ורדן סוף סוף.</p>
<p><strong>צורת ז'ורדן</strong></p>
<p>הנה דרך ציורית לחשוב על ההבדל בין הצורה הרציונלית וצורת ז'ורדן של <span class="math">\(T\)</span>: בצורה הרציונלית, אנחנו לוקחים את הפולינום המינימלי של <span class="math">\(T\)</span> ומתחילים לקחת סדרת מחלקים שלו - <strong>הגורמים האינוריאנטיים</strong> שלו. בצורת ז'ורדן, אנחנו לוקחים את אותו פולינום מינימלי ו<strong>מפרקים אותו לגורמים אי פריקים</strong> - זה נקרא "<strong>המחלקים האלמנטריים</strong>" שלו. חלוקה כזו לגורמים אי-פריקים היא מה שמשפט הפירוק הפרימרי עושה; הרעיון בצורת ז'ורדן הוא לקחת את התוצאה של משפט הפירוק הפרימרי ולהראות שבמקרה שבו הפולינום התפרק לגורמים לינאריים, אפשר לתת ניתוח יפה של כל גורם כזה בנפרד.</p>
<p>בואו ניזכר מה אומר משפט הפירוק הפרימרי. ניקח את הפולינום המינימלי <span class="math">\(m_{T}\)</span> של <span class="math">\(T\)</span>, ונפרק אותו לגורמים אי-פריקים (כלומר, למכפלה של פולינומים שהם בעצמם לא מכפלות של פולינומים ששניהם ממעלה גדולה מ-0). נסמן את זה <span class="math">\(m_{T}=p_{1}^{r_{1}}\cdots p_{k}^{r_{k}}\)</span>. אז אפשר לפרק את <span class="math">\(V\)</span> לסכום ישר של תתי-מרחבים <span class="math">\(T\)</span>-אינוריאנטיים <span class="math">\(V=W_{1}\oplus\dots\oplus W_{k}\)</span> שמוגדרים כך: <span class="math">\(W_{i}=\ker\left(p_{i}^{r_{i}}\left(T\right)\right)\)</span>.</p>
<p>הדיון הזה הוא קצת באוויר מבחינתנו אז בואו נרד לקרקע ונדבר על מה קורה במקרה שמתאים לצורת ז'ורדן, כלומר שבו <span class="math">\(m_{T}\)</span> מתפרק לגורמים לינאריים: במקרה הזה אפשר לכתוב <span class="math">\(m_{T}=\left(x-\lambda_{1}\right)^{r_{1}}\cdots\left(x-\lambda_{k}\right)^{r_{k}}\)</span> כאשר <span class="math">\(\lambda_{1},\dots,\lambda_{k}\)</span> הם השורשים של הפולינום המינימלי. במקרה הזה, המרחב <span class="math">\(W_{i}\)</span> הוא בדיוק <span class="math">\(\ker\left(\left(T-\lambda_{i}I\right)^{r_{i}}\right)\)</span>. מה שנותר לנו להבין, אם כן, הוא איך נראית המטריצה המייצגת של <span class="math">\(T\)</span> כשהיא מצומצמת לתת-מרחב מהצורה <span class="math">\(W=\ker\left(\left(T-\lambda I\right)^{r}\right)\)</span>. מה שנראה הוא שהמטריצה הזו תהיה מטריצת בלוקים, שכולם בלוקי ז'ורדן שמתאימים לערך העצמי <span class="math">\(\lambda\)</span>. כלומר, יש לנו עכשיו הרבה פחות עבודה - במקום להבין את <span class="math">\(T\)</span> באופן כללי, מספיק להבין אותה על תת-מרחב שבו היא תהיה פשוטה יחסית. מכאן ואילך אני אמשיך לדבר על <span class="math">\(T\)</span>, אבל מה שאני אתכוון אליו בתכל'ס יהיה <span class="math">\(T|_{W}\)</span>, כלומר <span class="math">\(T\)</span> שמצומצמת לתת-המרחב <span class="math">\(W\)</span>.</p>
<p>הפאנץ' המרכזי כאן הוא שעל תת-המרחב <span class="math">\(W\)</span>, <span class="math">\(T\)</span> היא סכום של שתי טרנספורמציות לינאריות פשוטות במיוחד: אחת שהיא <strong>סקלרית</strong> ואחת שהיא <strong>נילפוטנטית</strong>. אני יכול לכתוב <span class="math">\(T=D+N\)</span> כאשר <span class="math">\(D\)</span> היא הטרנספורמציה <span class="math">\(D=\lambda I\)</span> שפשוט כופלת הכל ב-<span class="math">\(\lambda\)</span> (<span class="math">\(D\left(v\right)=\lambda v\)</span>) והמטריצה המייצגת שלה <strong>בכל בסיס</strong> היא בסך הכל המטריצה הסקלרית שכולה אפסים למעט האלכסון הראשי שכולו <span class="math">\(\lambda\)</span>. נשאר להבין את <span class="math">\(N\)</span> ולמצוא בסיס שבו המטריצה המייצגת שלה תהיה נחמדה.</p>
<p>אני, כאמור, טוען ש-<span class="math">\(N\)</span> היא נילפוטנטית. מה זו טרנספורמציה נילפוטנטית? כזו שאם מעלים אותה בחזקה מספיק פעמים, מקבלים את טרנספורמציית האפס. הנה דוגמה למטריצה נילפוטנטית:</p>
<p><span class="math">\(\left(\begin{array}{ccccc}0 & 1 & 0 & 0 & 0\\0 & 0 & 1 & 0 & 0\\0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 1\\0 & 0 & 0 & 0 & 0\end{array}\right)\)</span></p>
<p>תעלו אותה בחזקה מספיק פעמים ותקבלו את מטריצת האפס. כעת, לא בחרתי את המטריצה הזו באקראי - בחרתי מטריצה שבה יש 1-ים רק במקום אחד: על האלכסון שמעל האלכסון הראשי. בדיוק כמו שקורה בצורת ז'ורדן. למעשה, המטריצה הזו היא-היא צורת ז'ורדן של טרנספורמציה כלשהי שכל הערכים העצמיים שלה הם 0.</p>
<p>מכיוון שהגדרתי <span class="math">\(D=\lambda I\)</span> הרי שאם אני מגדיר <span class="math">\(N=T-\lambda I\)</span> אני מקבל בדיוק ש-<span class="math">\(T=D+N\)</span> כפי שכתבתי למעלה. את <span class="math">\(T-\lambda I\)</span> אנחנו מכירים: המרחב <span class="math">\(W\)</span> <strong>הוגדר</strong> בתור הגרעין של <span class="math">\(\left(T-\lambda I\right)^{r}\)</span>, דהיינו כל אברי <span class="math">\(W\)</span> שייכים לגרעין של <span class="math">\(N^{r}\)</span>, דהיינו <span class="math">\(N^{r}\)</span> היא טרנספורמציית האפס על <strong>כל</strong> המרחב <span class="math">\(W\)</span>, ולכן <span class="math">\(N\)</span> נילפונטנטית כפי שהבטחתי.</p>
<p>אבל למה זה מעניין?</p>
<p>זה מעניין כי עכשיו אני הולך להשתמש <strong>במשפט הפירוק הציקלי</strong> על המרחב <span class="math">\(W\)</span> והטרנספורמציה <span class="math">\(N\)</span>. במילים אחרות, אני הולך למצוא את <strong>הצורה הרציונלית</strong> של <span class="math">\(N\)</span> על <span class="math">\(W\)</span>, ומכיוון ש-<span class="math">\(N\)</span> נילפוטנטית הצורה הרציונלית הזו תהיה פשוטה במיוחד. המשמעות של נילפוטנטיות היא שהפולינום המינימלי של <span class="math">\(N\)</span> הוא פשוט במיוחד: הוא חייב לחלק את <span class="math">\(x^{r}\)</span> (כי <span class="math">\(N\)</span> מאפסת את הפולינום <span class="math">\(x^{r}\)</span>) ולכן הוא בעצמו מהצורה <span class="math">\(x^{t}\)</span> עבור <span class="math">\(t\)</span> כלשהו. מכיוון שכל הגורמים האינוריאנטיים של <span class="math">\(N\)</span> מחלקים את הפולינום המינימלי, נובע שכל הגורמים האינוריאנטיים של <span class="math">\(N\)</span> הם מהצורה <span class="math">\(x^{t}\)</span> עבור <span class="math">\(t\)</span> כלשהו.</p>
<p>ולמה זה כל כך טוב? כי תחשבו שניה מהי המטריצה המלווה של הפולינום <span class="math">\(x^{t}\)</span>: כל העמודה האחרונה, שבדרך כלל מלאה מקדמים מכוערים עם מינוסים מכוערים, תהיה פשוט אפסים! זאת מכיוון שכל המקדמים של <span class="math">\(x^{t}\)</span> למעט המקדם המוביל (שלא מופיע במטריצה המלווה) הם אפס. זה אומר שהמטריצה המלווה תהיה מהצורה הבאה:</p>
<p><span class="math">\(\left(\begin{array}{ccccc}0 & 0 & 0 & \cdots & 0\\1 & 0 & 0 & \cdots & 0\\0 & 1 & 0 & \cdots & 0\\\vdots & \vdots & \vdots & \ddots & \vdots\\0 & 0 & 0 & \cdots & 0\end{array}\right)\)</span></p>
<p>זה כמעט בלוק ז'ורדן - רק עם 1-ים מתחת לאלכסון במקום מעל לאלכסון. זה לא קורה בגלל שהבסיס שאנחנו עובדים איתו שונה, אלא רק שה<strong>סדר</strong> של האיברים בבסיס צריך להיות הפוך. אם אנחנו מגדירים בסיס <span class="math">\(\mathcal{B}=\left\{ b_{0},b_{1},\dots,b_{n-1}\right\} \)</span> על ידי <span class="math">\(b_{i}=N^{i}u\)</span> עבור <span class="math">\(u\)</span> שהוא הוקטור הציקלי שלנו, אז המטריצה המייצגת של <span class="math">\(N\)</span> בבסיס הזה תהיה מה שלמעלה. אבל אם נהפוך את הסדר של האיברים בבסיס, כלומר נגדיר <span class="math">\(b_{i}=N^{\left(n-1\right)-i}u\)</span>, אז יתקיים <span class="math">\(N\left(b_{i}\right)=b_{i-1}\)</span> לכל <span class="math">\(1\le i<n\)</span>, ואילו עבור <span class="math">\(b_{0}\)</span> יתקיים <span class="math">\(N\left(b_{0}\right)=N\left(N^{n-1}\right)u=N^{n}u=0\)</span>. לכן המטריצה המייצגת בבסיס ההפוך הזה תהיה</p>
<p><span class="math">\(\left(\begin{array}{ccccc}0 & 1 & 0 & \cdots & 0\\0 & 0 & 1 & \cdots & 0\\0 & 0 & 0 & \cdots & 0\\\vdots & \vdots & \vdots & \ddots & \vdots\\0 & 0 & 0 & \cdots & 1\\0 & 0 & 0 & \cdots & 0\end{array}\right)\)</span></p>
<p>וזה בדיוק בלוק ז'ורדן.</p>
<p>נסכם: התחלנו עם <span class="math">\(T\)</span>. אמרנו שנמצא מטריצה מייצגת עבור <span class="math">\(T\)</span> שבה לכל ערך עצמי <span class="math">\(\lambda\)</span> של <span class="math">\(T\)</span> יהיה לנו בלוק אחד במטריצה שהוא המטריצה המייצגת של <span class="math">\(T\)</span> המצומצמת למרחב <span class="math">\(W=\ker\left(\left(T-\lambda I\right)^{r}\right)\)</span> - זה משפט הפירוק הפרימרי. ב-<span class="math">\(W\)</span> אמרנו שנפרק את <span class="math">\(T\)</span> לסכום <span class="math">\(T=D+N\)</span> כאשר <span class="math">\(D\)</span> סקלרית ואילו <span class="math">\(N\)</span> נילפוטנטית, ואז השתמשנו במשפט הפירוק הציקלי כדי להראות שהמטריצה המייצגת של <span class="math">\(N\)</span> היא מטריצת בלוקים שבה כל בלוק הוא בלוק ז'ורדן שמתאים לערך העצמי 0, כלומר עם 0 על האלכסון הראשי. המטריצה המייצגת של <span class="math">\(T\)</span> על <span class="math">\(W\)</span>, אם כן, היא סכום של שתי מטריצות שאחת מהן היא <span class="math">\(\left(\begin{array}{cccc}\lambda\\ & \lambda\\ & & \ddots\\ & & & \lambda\end{array}\right)\)</span> והשניה היא 0 בכל מקום חוץ אולי מכמה 1-ים באלכסון שמעל האלכסון הראשי.</p>
<p>הראינו קיום, אבל מה עם יחידות? ובכן, הפירוק הפרימרי הוא בוודאי יחיד, כי קיים רק פירוק אחד לגורמים אי פריקים של הפולינום המינימלי (זה מתקשר לדוגמה שנתתי בתחילת הפוסט, של פירוק יחיד לאי פריקים במספרים הטבעיים; עם פולינומים זה אותו סיפור בדיוק). לכל בלוק שנותן הפירוק הפרימרי היחידות שלו נובעת מהיחידות של הצורה הרציונלית. זה מסיים גם את זה.</p>
<p>נשאלת כמובן גם השאלה איך מוצאים את צורת ז'ורדן בפועל. אנחנו רואים שיש פה שני שלבים: ראשית צריך לפרק את הפולינום המינימלי לגורמים בשביל לקבל את הפירוק הפרימרי. שנית, צריך למצוא את בלוקי ז'ורדן שמתאימים לכל ערך עצמי, וזה בעצם שקול למציאת הצורה הרציונלית של <span class="math">\(N\)</span> עבור כל מרחב של הפירוק הפרימרי. אפשר לעשות את זה עם צורת סמית כמו שתיארתי כאן, אבל כבר קל יותר פשוט למצוא את הוקטורים הציקליים באופן מפורש. זה בדיוק מה שתיארתי <a href="http://www.gadial.net/2016/08/30/jordan_form_basics/">בפוסט על התכל'ס של מציאת צורת ז'ורדן</a>.</p>
<p>עכשיו אפשר גם לדבר על שלוש תכונות של הבלוקים בצורת ז'ורדן שהזכרתי בפוסט ההוא, ולראות למה הן נכונות. אזכיר אותן:</p>
<ul>
    <li>לכל ערך עצמי <span class="math">\(\lambda\)</span>, הריבוי האלגברי של <span class="math">\(\lambda\)</span> (הדרגה של <span class="math">\(\left(x-\lambda\right)\)</span> בפולינום האופייני) שווה ל<strong>סכום גדלי</strong> בלוקי ז'ורדן המתאימים ל-<span class="math">\(\lambda\)</span>.</li>
    <li>לכל ערך עצמי <span class="math">\(\lambda\)</span>, הריבוי הגאומטרי של <span class="math">\(\lambda\)</span> שווה ל<strong>מספר</strong> בלוקי ז'ורדן המתאימים ל-<span class="math">\(\lambda\)</span>.</li>
    <li>לכל ערך עצמי <span class="math">\(\lambda\)</span>, הריבוי של <span class="math">\(\lambda\)</span> <strong>בפולינום המינימלי</strong> שווה לגודל בלוק הז'ורדן הגדול ביותר המתאים ל-<span class="math">\(\lambda\)</span>.</li>
</ul>
<p>התכונה הראשונה קלה למדי: אם <span class="math">\(J\)</span> היא מטריצה בצורת ז'ורדן, טריוויאלי לחשב את הפולינום האופייני שלה - מכיוון ש-<span class="math">\(xI-J\)</span> היא מטריצה משולשית עליונה, הדטרמיננטה שלה היא מכפלת אברי האלכסון. לכן הריבוי האלגברי של <span class="math">\(\lambda\)</span> זהה למספר הפעמים ש-<span class="math">\(\lambda\)</span> מופיע על האלכסון של <span class="math">\(J\)</span>, שהוא סכום הגדלים של הבלוקים שבהם <span class="math">\(\lambda\)</span> מופיע. את זה יכולנו לדעת גם בלי להבין מאיפה צורת ז'ורדן מגיעה בכלל.</p>
<p>התכונה השלישית נובעת ממה שאמרנו על הגורמים האינוריאנטיים בצורה הרציונלית: הגורם האינוריאנטי הגדול ביותר שווה לפולינום המינימלי. התכונה השניה טיפה יותר מסובכת: הריבוי הגאומטרי של <span class="math">\(\lambda\)</span> הוא בדיוק <span class="math">\(\dim\ker N\)</span>. לכן השאלה היא מה הגרעין של <span class="math">\(N\)</span> ב-<span class="math">\(W\)</span>. בואו ניזכר מה הוא הבסיס של <span class="math">\(W\)</span> שאנחנו מוצאים בסוף - הוא איחוד של בסיסים לתתי-המרחבים הציקליים שפירקנו את <span class="math">\(W\)</span> אליהם, ובכל תת-מרחב כזה אברי הבסיס הם הפעלות של <span class="math">\(N\)</span> על וקטור ציקלי כלשהו. האיבר האחרון בכל אחד מהבסיסים הללו הוא וקטור שכאשר נפעיל עליו את <span class="math">\(N\)</span> נקבל 0, ולכן הוא שייך ל-<span class="math">\(\ker N\)</span>; שאר הוקטורים בבסיס הם בדיוק כאלו שהפעלה של <span class="math">\(N\)</span> עליהם לא מחזירה 0 (אלא את האיבר הבא בבסיס) ולכן הם לא שייכים ל-<span class="math">\(\ker N\)</span>. כך אנחנו מקבלים שכל וקטור ציקלי תורם בדיוק וקטור בלתי תלוי אחד ל-<span class="math">\(\ker N\)</span>, ולכן המימד של <span class="math">\(\ker N\)</span> שווה למספר בלוקי הז'ורדן (כי כל בלוק ז'ורדן נובע מוקטור ציקלי אחד).</p>
<p><strong>דברי סיכום ופרידה</strong></p>
<p>היה הרבה מלל בפוסט הזה, אבל מבחינה מתמטית לא היה כאן שום דבר מסובך, רק הסברים טריוויאליים למדי. הסיבה לכך היא שאת כל העבודה כבר עשינו קודם, עם משפט הפירוק הפרימרי ומשפט הפירוק הציקלי, שההוכחות של שניהם היו טכניות יחסית וכללו רעיונות לא טריוויאליים. אחרי שהשגנו את המשפטים הללו, הכל היה פשוט: הצורה הרציונלית נבעה מיידית ממשפט הפירוק הציקלי, וצורת ז'ורדן נבעה ממשפט הפירוק הפרימרי שאחרי השתמשנו בצורה קצת חכמה במשפט הפירוק הציקלי כדי "לפרק עוד קצת" את מה שקיבלנו ממשפט הפירוק הפרימרי.</p>
<p>אני חושב שהיישומים הללו של המשפטים הם אלגנטיים מאוד. אחרי שמבינים "מאיפה זה מגיע", הן הצורה הרציונלית והן צורת ז'ורדן נראות לי - עד כמה שאפשר לומר את זה על מושג מתמטי, כמובן - יפות. זה מאפיין כללי של אלגברה לינארית, לדעתי; זה תחום שיש בו כמה משפטים ספציפיים שהם טכניים מאוד בהוכחתם, אבל מסביב להם רוב התורה שנבנית היא מאוד פשוטה ואינטואיטיבית והכל בה "פשוט מסתדר מעצמו". אני מקווה שהצלחתי להעביר את התחושה הזו בפוסט הזה.</p>
<p>ועוד דבר אחד לפרידה: הפוסט הזה פחות או יותר סוגר את אחד מהכיוונים בסדרת הפוסטים שלי על אלגברה לינארית (זה שעוסק בצורות קנוניות; מן הסתם יש כיוונים נוספים), אבל אני לא רוצה לתת אשליה שזה סוף הסיפור. כפי שרמזתי בפוסטים קודמים בנושא, את כל מה שעשינו כאן אפשר לראות בתור מקרה פרטי של משפט כללי יותר שעוסק ב<strong>מודולים</strong>, שהם בתורם הכללה של מרחבים וקטוריים. אני מקווה להציג בפוסט יום אחד גם את נקודת המבט הזו, אבל לבינתיים בואו נסתפק בלדעת שהיא קיימת.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('expanded');
        }
        
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>