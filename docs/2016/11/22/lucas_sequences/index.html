<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>סדרות לוקאס ומבחני ראשוניות - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/blog/favicon.ico">
    
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Hamburger menu button */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.8em;
            color: white;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .menu-toggle:hover {
            opacity: 0.8;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .top-nav .nav-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .top-nav .site-title {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0;
                padding: 10px 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            /* Hide nav links by default on mobile */
            .top-nav .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                margin-top: 10px;
            }
            
            /* Show when expanded */
            .top-nav .nav-links.expanded {
                display: flex;
            }
            
            .top-nav .nav-links > a {
                text-align: center;
                padding: 12px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box {
                width: 100%;
                flex-direction: column;
                margin-top: 10px;
                padding-top: 10px;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }
            
            .top-nav .search-box input {
                width: 100%;
                margin-bottom: 5px;
                min-width: 0;
            }
            
            .top-nav .search-box button {
                width: 100%;
            }
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        /* Force KaTeX content to wrap by overriding its internal structure */
        .katex-html {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .base {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .mord,
        .katex .mbin,
        .katex .mrel,
        .katex .mopen,
        .katex .mclose,
        .katex .mpunct,
        .katex .minner {
            display: inline !important;
            white-space: normal !important;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
            
            /* Hide post navigation on mobile */
            .post-navigation {
                display: none;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <div class="site-title">
                <a href="/blog/" style="color: white; text-decoration: none;">לא מדויק</a>
                <button class="menu-toggle" onclick="toggleMobileMenu()" aria-label="תפריט">
                    ☰
                </button>
            </div>
            <div class="nav-links" id="navLinks">
                <a href="/blog/">דף הבית</a>
                <a href="/blog/random.html">פוסט אקראי</a>
                <a href="/blog/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/blog/2016/11/05/perfect_numbers_and_mersenne_primes/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">מספרים מושלמים וראשוניי מרסן</span>
            </a>
            

            
            <a href="/blog/2016/11/30/csb_theorem_hilbert_hotel_style/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">משפט קנטור-שרדר-ברנשטיין - ועכשיו בגרסת המלון של הילברט!</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>סדרות לוקאס ומבחני ראשוניות</h1>
            <div class="post-meta">
                <span class="date">2016-11-22</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/תורת המספרים.html">תורת המספרים</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/אלגוריתם לוקאס-להמר.html">אלגוריתם לוקאס-להמר</a>
                    
                    <a href="/tags/מספרים ראשוניים.html">מספרים ראשוניים</a>
                    
                    <a href="/tags/סדרות לוקאס.html">סדרות לוקאס</a>
                    
                    <a href="/tags/ראשוני מרסן.html">ראשוני מרסן</a>
                    
                    <a href="/tags/שאריות ריבועיות.html">שאריות ריבועיות</a>
                    
                    <a href="/tags/שדות סופיים.html">שדות סופיים</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <p>בפוסט הקודם התעסקתי בראשוניי מרסן והקשר הקרוב שלהם למספרים מושלמים. זה עשה לי חשק לדבר על עוד סיבה שבגללה ראשוניי מרסן הם מעניינים, אולי הסיבה הבולטת ביותר למי שלא מתעסקים במתמטיקה ונתקלים מדי פעם בכותרות בעיתונים: יש מבחן לבדיקת ראשוניות של מספרי מרסן שהוא <strong>יעיל בצורה יוצאת דופן</strong> ובזכותו הצלחנו לגלות מספרים ראשוניים שהם גדולים משמעותית ממה שכל שיטה אחרת מניבה לנו. בכל פעם בחמישים ומשהו השנים האחרונות שבה זעקו הכותרות על "התגלה הראשוני הגדול ביותר אי פעם!" זה היה ראשוני מרסן, שהתגלה באמצעות מבחן הראשוניות הזה, שנקרא <strong>מבחן לוקאס-להמר</strong> (כנראה שיש לכתוב "לוקה" כי כך מבטאים את השם, אבל "לוקאס" הוא הכתיב הפופולרי בעברית עבור המתמטיקאי הספציפי הזה). המבחן פשוט בצורה קיצונית, ולכן אציג אותו כמעט מייד; שארית הפוסט תעסוק בשאלה למה המבחן עובד, אבל תלך הרבה יותר רחוק מכך, אל תוצאות ורעיונות כלליים ומגניבים עוד יותר. המחיר יהיה פוסט טכני מאוד, כפי שלרוב קורה כשמתחילים לנבור בתוצאות כמו זו, אבל כל מי שיש לו ידע בסיסי כלשהו באלגברה מופשטת או תורת המספרים כנראה יוכל להבין את הרוב (אני אצטט פה ושם תוצאות בלי להוכיח, אבל גם הן לא משהו עמוק במיוחד).</p>
<p>המבחן מתבסס על סדרת מספרים שנקראת <strong>סדרת לוקאס-להמר</strong> ומתחילה כך: <span class="math">\(4,14,194,37634,1416317954\)</span>. הנוסחה שלה פשוטה מאוד: <span class="math">\(a_{0}=4\)</span> ו-<span class="math">\(a_{n+1}=a_{n}^{2}-2\)</span>. כלומר, כל איבר מתקבל על ידי העלאה בריבוע של קודמו וחיסור 2. כעת, למבחן: אם <span class="math">\(p\)</span> הוא מספר ראשוני אז מספר מרסן <span class="math">\(M_{p}=2^{p}-1\)</span> הוא ראשוני אם ורק אם <span class="math">\(a_{p-2}\)</span> מתחלק ב-<span class="math">\(M_{p}\)</span>. לכן רק צריך לחשב את <span class="math">\(a_{p-2}\)</span> ולבדוק. בפועל החישוב הזה לא טריוויאלי לגמרי - מהר מאוד האיברים של לוקאס-להמר הופכים לענקיים בגודלם, אבל מצד שני לא צריך לזכור את כל האיבר אלא רק את השארית שלו בחלוקה ב-<span class="math">\(M_{p}\)</span> ויש עוד תעלולים שלא אכנס אליהם כאן. השורה התחתונה היא שזה אלגוריתם יעיל מאוד.</p>
<p>אתם עשויים לשאול למה אני דורש ש-<span class="math">\(p\)</span> יהיה ראשוני דווקא. הסיבה לכך פשוטה: אם <span class="math">\(n\)</span> הוא מספר פריק, אז אין סיכוי ש-<span class="math">\(2^{n}-1\)</span> יהיה ראשוני. כי נניח ש-<span class="math">\(n=ab\)</span> אז <span class="math">\(2^{ab}-1=\left(2^{a}\right)^{b}-1\)</span> וכשניקח את המשוואה הזו מודולו <span class="math">\(2^{a}-1\)</span>, נקבל <span class="math">\(2^{a}\equiv1\)</span> ולכן נקבל <span class="math">\(1^{b}-1\equiv0\)</span>, כלומר <span class="math">\(2^{a}-1\)</span> מחלק את <span class="math">\(2^{n}-1\)</span> (וכך גם <span class="math">\(2^{b}-1\)</span> ולכן עבור <span class="math">\(n\)</span> לא ראשוני נמצא מחלק לא טריוויאלי של <span class="math">\(2^{n}-1\)</span>). לא הבנתם מה עשיתי פה? זו הייתה בדיקה כדי לראות אם אתם מכירים את מושגי היסוד שיהיו הכרחיים בהמשך הפוסט. לכל הפחות יהיה צורך להכיר <a href="http://www.gadial.net/2013/05/13/modular_arithmetic/">חשבון מודולרי</a>.</p>
<p>האלגוריתם הזה נראה כמו קסם. מאיפה בכלל צצה הסדרה הזו של לוקאס-להמר? איך ייתכן שתנאי כל כך פשוט כמו חלוקה מספיק בשביל לבדוק ראשוניות? איך בכלל מתחילים להוכיח משהו כזה? ובכן, האלגוריתם הזה הוא מקרה פרט של מבחן כללי יותר שמשתמש בקשר המעניין שיש בין ראשוניים ובין סדרות שמקיימות נוסחאות נסיגה מסויימות - סדרות שנקראות <strong>סדרות לוקאס</strong>. לוקאס-להמר הוא מה שמתקבל מהמבחן הזה כשהראשוניים הם מהצורה המאוד פשוטה של מספרי מרסן, וסדרת הלוקאס שבה משתמשים נבחרת בקפידה כדי להתאים למקרה הזה. ננסה להבין את הסיטואציה הכללית ואז נקטוף בסוף את לוקאס-להמר בתור מקרה פרטי.</p>
<p>הסיפור מתחיל ונגמר בסדרות לוקאס המדוברות. אלו סדרות של מספרים שלמים, שאסמן ב-<span class="math">\(u_{0},u_{1},u_{2},\dots\)</span> שמקיימות את נוסחת הנסיגה <span class="math">\(u_{n}=au_{n-1}-bu_{n-2}\)</span> כאשר <span class="math">\(a,b\)</span> הם פרמטרים שלמים. הסדרה הידועה ביותר שהיא סדרת לוקאס היא סדרת <strong>מספרי פיבונאצ'י</strong> שמוגדרת על ידי <span class="math">\(F_{0}=0,F_{1}=1\)</span> ו-<span class="math">\(F_{n}=F_{n-1}+F_{n-2}\)</span>, כלומר זו סדרת לוקאס עם פרמטרים <span class="math">\(a=1,b=-1\)</span> ותנאי התחלה <span class="math">\(F_{0}=0\)</span> ו-<span class="math">\(F_{1}=1\)</span>. יש עוד סדרות מספרים שמקיימות נוסחת נסיגה מסוג זה - למשל, מספרי מרסן בעצמם:</p>
<p><span class="math">\(M_{n}=2^{n}-1=3\left(2^{n-1}-1\right)-2\left(2^{n-2}-1\right)=3M_{n-1}-2M_{n-2}\)</span></p>
<p>כלומר כאן <span class="math">\(a=3,b=2\)</span> ותנאי ההתחלה הם <span class="math">\(M_{0}=0,M_{1}=1\)</span>.</p>
<p>אם כי, כפי שנראה בהמשך, הסיבה לקיום מבחן הראשוניות המוצלח למספרי מרסן לא קשורה ישירות לכך שהם בעצמם מהווים סדרת לוקאס.</p>
<p>לא ממש הגבלתי את תנאי ההתחלה האפשריים עבור סדרות לוקאס, אבל מסתבר שהסדרות המעניינות ביותר מתקבלות עבור שני סטים אפשריים של ערכי התחלה. ראשית, ערכי ההתחלה <span class="math">\(u_{0}=0,u_{1}=1\)</span> שנתנו לנו את פיבונאצ'י ואת מרסן, ושנית - תנאי ההתחלה <span class="math">\(u_{0}=2\)</span> ו-<span class="math">\(u_{1}=a\)</span> (כאשר <span class="math">\(a\)</span> הוא הפרמטר שמגדיר את נוסחת הנסיגה: <span class="math">\(u_{n}=au_{n-1}-bu_{n-2}\)</span>). בינתיים אדבר על סדרות שמתקבלות מתנאי ההתחלה הראשון. נתחיל בלראות משהו מגניב שקורה ספציפית בפיבונאצ'י, ואז נכליל אותו.</p>
<p>הדבר המגניב הוא זה: אם <span class="math">\(n\)</span> הוא מספר ראשוני, אז <span class="math">\(n\)</span> חייב לחלק את מספר פיבונאצ'י במקום שהוא "כמעט <span class="math">\(n\)</span>". מה זאת אומרת "כמעט"? או שזה יהיה המספר במקום ה-<span class="math">\(n\)</span>, או שזה יהיה המספר במקום ה-<span class="math">\(n+1\)</span> או שזה יהיה המספר במקום ה-<span class="math">\(n-1\)</span>. זה תלוי בתכונה כלשהי של <span class="math">\(n\)</span>. במפורש:</p>
<ul>
    <li>אם <span class="math">\(n\)</span> מתחלק ב-<span class="math">\(5\)</span> אז <span class="math">\(n\)</span> מחלק את <span class="math">\(F_{n}\)</span>.</li>
    <li>אם <span class="math">\(n\)</span> מחזיר שארית 1 או 4 בחלוקה ב-5 אז <span class="math">\(n\)</span> מחלק את <span class="math">\(F_{n-1}\)</span>.</li>
    <li>אם <span class="math">\(n\)</span> מחזיר שארית 2 או 3 בחלוקה ב-5 אז <span class="math">\(n\)</span> מחלק את <span class="math">\(F_{n+1}\)</span>.</li>
</ul>
<p>בואו נראה דוגמאות. נכתוב את האיברים הראשונים של פיבונאצ'י: <span class="math">\(0,1,1,2,3,5,8,13,21,34,55\)</span>. עכשיו בואו נעבור על ראשוניים: 2 מחזיר שארית 2 בחלוקה ב-<span class="math">\(5\)</span> ואכן מחלק את <span class="math">\(F_{3}=2\)</span>. 3 אכן מחלק את <span class="math">\(F_{4}=3\)</span>. 5 אכן מחלק את <span class="math">\(F_{5}=5\)</span>. 7 אכן מחלק את <span class="math">\(F_{8}=21\)</span>. 11 אכן מחלק את <span class="math">\(F_{10}=55\)</span>, וזה נמשך ונמשך ונמשך. זו תוצאה ממש נחמדה! האם היא מספיקה כדי <strong>להוכיח</strong> שמספר הוא ראשוני? ובכן, לא: אפשר להראות, למשל, ש-323 מחלק את <span class="math">\(F_{324}\)</span> אבל הוא לא ראשוני כי <span class="math">\(323=17\cdot19\)</span>. לכן למספר שמקיים את הקריטריון הזה קוראים <strong>פסאודוראשוני פיבונאצ'י</strong>. לא כדאי לזלזל במבחנים שבודקים אם מספר הוא פסאודוראשוני: זו דרך מאוד טובה לסנן מספרים פריקים לפני שזורקים עליהם אלגוריתם שיודע להוכיח ראשוניות והוא כנראה כבד יחסית. מבחן פסואודוראשוניות אחד כנראה לא יהיה מספיק, אבל אם משלבים כמה מקבלים סינון אפקטיבי מאוד.</p>
<p>עכשיו בואו נוריד חלק מהמיסטיקה סביב הניסוח של המשפט הזה. ה"כמעט במקום ה-<span class="math">\(n\)</span>" הוא מעצבן כי הוא מייצר חלוקה למקרים שנראית שרירותית מאוד, אבל בפועל היא לא שרירותית בכלל: היא תלויה בשאלה האם <span class="math">\(n\)</span> הוא <strong>שארית ריבועית</strong> מודולו <span class="math">\(5\)</span>. יש לי <a href="http://www.gadial.net/2009/06/26/sums_of_squares_and_quadratic_reciprocity/">פוסט בנושא</a> אבל הנה תזכורת: מספר <span class="math">\(a\)</span> הוא שארית ריבועית מודולו <span class="math">\(n\)</span> אם הוא ריבוע ב-<span class="math">\(\mathbb{Z}_{n}^{*}\)</span>, כלומר אם למשוואה <span class="math">\(x^{2}=n\)</span> קיים פתרון ב-<span class="math">\(\mathbb{Z}_{n}^{*}\)</span>. ספציפית עבור <span class="math">\(z=5\)</span> קל לראות שעבור 1 ו-4 יש פתרונות (1 ו-2, כמובן) אבל עבור 2 ו-3 אין פתרונות (כי 3 בריבוע מודולו 5 נותן 4 ואילו 4 בריבוע נותן 1 - אלו השורשים הנוספים שיש ל-1 ו-4, כי בשדה כמו <span class="math">\(\mathbb{Z}_{5}\)</span> אם למספר יש שורש יש לו בדיוק שני שורשים). שימו לב שההגדרה שלי דיברה על <span class="math">\(\mathbb{Z}_{n}^{*}\)</span>, כלומר על אוסף כל המספרים <strong>שזרים</strong> ל-5; לכן המקרה של <span class="math">\(n\)</span> מתחלק ב-5 הוא מיוחד.</p>
<p>כעת, יש סימון מקובל לתיאור האם מספר הוא שארית ריבועית או לא, שהתגלה כשימושי במיוחד והוא שימושי גם כאן: אם <span class="math">\(p\)</span> ראשוני ו-<span class="math">\(n\)</span> הוא מספר כלשהו, אז <span class="math">\(\left(\frac{n}{p}\right)=1\)</span> אם <span class="math">\(n\)</span> הוא שארית ריבועית מודולו <span class="math">\(p\)</span>, <span class="math">\(\left(\frac{n}{p}\right)=-1\)</span> אם <span class="math">\(n\)</span> הוא לא שארית ריבועית אבל זר ל-<span class="math">\(p\)</span>, ואילו <span class="math">\(\left(\frac{n}{p}\right)=0\)</span> אם <span class="math">\(n\)</span> לא זר ל-<span class="math">\(p\)</span>. לסימן הזה קוראים <strong>סימן לז'נדר</strong> (ובמקרה שבו ה"מכנה" הוא לא ראשוני, קוראים לו <strong>סימן יעקובי</strong>). צריך כמובן לומר במפורש שהסימן הזה <strong>לא מתאר שבר</strong>. קו השבר בין <span class="math">\(n\)</span> ל-<span class="math">\(p\)</span> הוא סתם סימון, ומההקשר מבינים שלא מדובר על שבר. עכשיו אפשר לנסח את המשפט בצורה קצת יותר קומפקטית: אם <span class="math">\(n\)</span> הוא ראשוני, אז <span class="math">\(n\)</span> מחלק את <span class="math">\(F_{n-\left(\frac{n}{5}\right)}\)</span>. הנה, הסימון כבר מתחיל לעבוד לטובתנו.</p>
<p>עד עכשיו נראה היה שתיארתי תכונה מעניינת <strong>של סדרת פיבונאצ'י</strong>. אבל בפועל מדובר על תכונה מעניינת של סדרות לוקאס באופן כללי - ליתר דיוק, אלו עם תנאי ההתחלה 0,1. הנה המשפט הכללי: תהא <span class="math">\(U_{k}\)</span> סדרת לוקאס עם תנאי התחלה <span class="math">\(0,1\)</span> ונוסחת נסיגה <span class="math">\(U_{k}=aU_{k-1}-bU_{k-2}\)</span>. נסמן <span class="math">\(\Delta=a^{2}-4b\)</span>. אם <span class="math">\(p\)</span> הוא מספר ראשוני שזר ל-<span class="math">\(2b\Delta\)</span> אז <span class="math">\(p\)</span> מחלק את <span class="math">\(U_{p-\left(\frac{\Delta}{p}\right)}\)</span>.</p>
<p>מה קורה אצל פיבונאצ'י? במקרה הזה <span class="math">\(a=1,b=-1\)</span> ולכן <span class="math">\(\Delta=1^{2}+4=5\)</span> - מכאן הגיע ה-5 הזה. כעת, <span class="math">\(2b\Delta=10\)</span> ולכן כל ראשוני פרט ל-<span class="math">\(2,5\)</span> זר ל-<span class="math">\(2b\Delta\)</span> (ועבורם המשפט עובד בכל מקרה כאן). לכן המסקנה היא ש-<span class="math">\(p\)</span> מחלק את <span class="math">\(U_{p-\left(\frac{5}{p}\right)}\)</span>. זה נראה <strong>כמעט</strong> כמו המשפט על פיבונאצ'י רק ששמשהו התהפך כאן: כתוב <span class="math">\(\left(\frac{5}{p}\right)\)</span> במקום <span class="math">\(\left(\frac{p}{5}\right)\)</span>. הסיבה לכך שאפשר לבצע את ההיפוך הזה היא משפט נפלא שנקרא <strong>משפט ההדדיות הריבועית</strong> שאומר שאם <span class="math">\(p,q\)</span> הם ראשוניים אז <span class="math">\(\left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=\left(-1\right)^{\left(\frac{p-1}{2}\right)\left(\frac{q-1}{2}\right)}\)</span>, ובמילים: אם <span class="math">\(p\)</span> או <span class="math">\(q\)</span> שקולים ל-1 מודולו 4 אז <span class="math">\(\left(\frac{p}{q}\right)=\left(\frac{q}{p}\right)\)</span>, ואם שניהם שקולים ל-3 מודולו 4 אז <span class="math">\(\left(\frac{p}{q}\right)=-\left(\frac{q}{p}\right)\)</span>. מכיוון ש-<span class="math">\(5\)</span> שקול ל-1 מודולו 4 אנחנו במקרה הראשון ולכן ניתן "להפוך" כפי שהפכנו.</p>
<p>עכשיו לשאלה המעניינת - למה המשפט הכללי נכון? כאן מגיעים הניסים והנפלאות. הרעיון הבסיסי יהיה לחשוב על אברי הסדרה <span class="math">\(U_{k}\)</span> לא בתור "סתם" מספרים שלמים, אלא בתור יצורים שחיים בתוך מרחב גדול יותר - <strong>השדה הסופי</strong> <span class="math">\(\mathbb{F}_{p^{2}}\)</span>. תכף אסביר בדיוק על מה מדובר, אבל לפני כן אני רוצה להתלהב מהרעיון הכללי כאן. זו תופעה מאוד נפוצה במתמטיקה בכלל, ובתורת המספרים בפרט: יש לנו אובייקט שאנחנו מסוגלים להבין אינטואיטיבית, אבל פתאום צצות תכונות יפהפיות שלו שאין לנו מושג איך להסביר באמצעות התיאור הרגיל שלנו של האובייקט. רק כשאנחנו מתחילים לחשוב על האובייקט בתור משהו שחי בעולם גדול יותר, ומסובך יותר, ואולי גם נוגד אינטואיציה הרבה יותר, פתאום התכונות מתחילות לצוץ כמעט מאליהן. זה מתרחש בגלל שהאובייקט שלנו מקיים יחסי גומלין עם האובייקטים של העולם הגדול והמסובך יותר, גם אם מבחינתנו זה שקוף לחלוטין כל עוד אנחנו נשארים בחיק החמים של האינטואיציה שלנו, שמסתירה מפנינו את העולם הגדול יותר. כמה פעמים שמעתם מישהו אומר ש"הוא לא מבין למה מספרים מרוכבים הם מספרים בכלל"? זו דוגמת האבטיפוס: יש שלל תכונות שהדרך הנכונה להבין מדוע המספרים הממשיים/השלמים מקיימים אותן שצצות רק כשחושבים על המספרים הללו בתור יצורים שחיים בשדה המספרים המרוכבים. למרוכבים לא אכפת אם אתם מקבלים אותם או לא; הם קיימים, והם מרתקים, וגם אם אנחנו מנסים לאטום את החלון ולא לראות אותם, מדי פעם קרני שמש חודרות מבעד למעטה שלנו ונופלות על אותו חלק קטן מהמספרים המרוכבים שאנחנו מוכנים ברוב טובנו להכיר בקיומו.</p>
<p>טוב, מספיק עם הפילוסופיה; היא דרושה כדי להכין אתכם לזבנג שאני הולך לתת עוד שניה למי שלא רגיל לנושאים הללו. כאמור, אני רוצה לחשוב על ה-<span class="math">\(U_{k}\)</span>-ים בתור איברים בשדה סופי עם <span class="math">\(p^{2}\)</span> איברים. <a href="http://www.gadial.net/2011/07/11/fields_and_how_can_they_be_finite/">יש לי כאן הסברים</a> על מהם שדות כאלו אז לא אכנס למלוא הפרטים כרגע. השאלה המעניינת מבחינתנו היא איך אנחנו רוצים <strong>לייצג</strong> את אברי השדה הסופי הזה. השיטה המקובלת לבנייה של שדה סופי בן <span class="math">\(p^{2}\)</span> איברים היא זו: מתחילים מהשדה <span class="math">\(\mathbb{Z}_{p}=\left\{ 0,1,\dots,p-1\right\} \)</span>, ולוקחים פולינום <span class="math">\(f\left(x\right)\)</span> ממעלה שניה מעליו שהוא <strong>אי פריק</strong>, כלומר שאין לו שורש ב-<span class="math">\(\mathbb{Z}_{p}\)</span>. ועכשיו מסתכלים על <strong>חוג המנה</strong> שמתקבל כשמחלקים את חוג הפולינומים מעל <span class="math">\(\mathbb{Z}_{p}\)</span> באידאל שנוצר מהפולינום <span class="math">\(f\left(x\right)\)</span>. מה זה אומר בתכל'ס? שמסתכלים על קבוצת הפולינומים מהצורה <span class="math">\(sx+t\)</span> עם פעולות חיבור וכפל "מודולו <span class="math">\(f\left(x\right)\)</span>" - כלומר, אחרי שמחברים או כופלים מחלקים ב-<span class="math">\(f\left(x\right)\)</span> ולוקחים את השארית (בפועל על חיבור זה לא משפיע, רק על כפל).</p>
<p>עכשיו מגיע החלק המוזר למראה. כזכור, אנחנו מסתכלים על הסדרה <span class="math">\(U_{k}\)</span> שמוגדרת על ידי הפרמטרים <span class="math">\(a,b\)</span>. זה אומר שמתקיים <span class="math">\(U_{k+2}=aU_{k+1}-bU_{k}\)</span>. בואו נשחק לרגע משחק: במקום <span class="math">\(U_{k+i}\)</span> נכתוב <span class="math">\(x^{i}\)</span>. כלומר, <span class="math">\(x^{2}=ax^{1}-bx^{0}\)</span> או בקיצור <span class="math">\(x^{2}=ax-b\)</span>. נעביר אגפים ונקבל <span class="math">\(x^{2}-ax+b=0\)</span>. בואו נקרא לפולינום שבצד שמאל <span class="math">\(f\left(x\right)\)</span>, כלומר <span class="math">\(f\left(x\right)=x^{2}-ax+b\)</span>. הפולינום הזה מאפשר לנו להגדיר את הסדרה <span class="math">\(U_{k}\)</span> בתור <strong>סדרה של פולינומים</strong> באופן הבא, שייראה לכם מאוד מוזר במבט ראשון ולכן אני מבטיח שהוא מאוד שימושי:</p>
<p><span class="math">\(U_{k}\triangleq\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}\left(\text{mod }f\left(x\right)\right)\)</span></p>
<p>מה טוב בהגדרה המוזרה הזו? שזו <strong>לא הגדרה רקורסיבית</strong>. מצד שני, קל לראות שהיא מגדירה את הסדרה <span class="math">\(U_{k}\)</span> שתיארתי קודם. בפרט, זו נראית כמו סדרה של פולינומים, אבל בפועל נקבל סדרה של מספרים שלמים. כדי לראות את זה, בואו קודם כל נציב <span class="math">\(k=0\)</span> ונקבל</p>
<p><span class="math">\(U_{0}=\frac{x^{0}-\left(a-x\right)^{0}}{x-\left(a-x\right)}=\frac{1-1}{x-\left(a-x\right)}=0\)</span></p>
<p>וכעת נציב <span class="math">\(k=1\)</span> ונקבל</p>
<p><span class="math">\(U_{1}=\frac{x^{1}-\left(a-x\right)^{1}}{x-\left(a-x\right)}=\frac{x-\left(a-x\right)}{x-\left(a-x\right)}=1\)</span></p>
<p>אז קיבלנו את הערכים ההתחלתיים שציפינו להם. כעת, למה <span class="math">\(U_{k}\)</span> מקיים את נוסחת הנסיגה? בשביל זה צריך להבין מה המשמעות של חישובים מודולו <span class="math">\(f\left(x\right)\)</span>. זה אומר שאנחנו יכולים להחליף כל מופע של <span class="math">\(x^{2}-ax+b\)</span> באפס, או באופן שקול, להחליף כל מופע של <span class="math">\(x^{2}\)</span> ב-<span class="math">\(ax-b\)</span> וההפך. אז בואו נעשה חישובים עם הנשק החדש הזה שלנו:</p>
<p><span class="math">\(x^{2}=ax-b\)</span></p>
<p><span class="math">\(\left(a-x\right)^{2}=a^{2}-2ax+x^{2}=a^{2}-2ax+\left(ax-b\right)=a^{2}-ax-b=a\left(a-x\right)-b\)</span></p>
<p>ולכן:</p>
<p><span class="math">\(x^{k+2}=x^{k}\left(ax-b\right)=ax^{k+1}-bx^{k}\)</span></p>
<p><span class="math">\(\left(a-x\right)^{k+2}=\left(a-x\right)^{k}\left(a-x\right)^{2}=a\left(a-x\right)^{k+1}-b\left(a-x\right)^{k}\)</span></p>
<p>ומכאן:</p>
<p><span class="math">\(U_{k+2}=\frac{x^{k+2}-\left(a-x\right)^{k+2}}{x-\left(a-x\right)}=a\frac{x^{k+1}-\left(a-x\right)^{k+1}}{x-\left(a-x\right)}-b\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}=aU_{k+1}-bU_{k}\)</span></p>
<p>כלומר, ה-<span class="math">\(U_{k}\)</span> היא עדיין הסדרה המוכרת והאהובה עלינו, רק כתובה בצורה מוזרה עם פולינומים שבסוף בכלל לא באים לידי ביטוי כי כל האיקסים מצטמצמים. אבל הפולינומים הללו הם בדיוק ה"עולם רחב יותר" שאני מדבר עליו.</p>
<p>בואו נחזור לרגע לדבר על העולם ונראה במפורש איך מתנהגות פעולות החיבור והכפל בו. זכרו: הן מתנהגות כמו חיבור וכפל פולינומים רגיל, בתוספת היכולת שלנו להשתמש במשוואה <span class="math">\(x^{2}=ax-b\)</span>. לכן נקבל:</p>
<p><span class="math">\(\left(s_{1}x+t_{1}\right)+\left(s_{2}x+t_{2}\right)=\left(s_{1}+s_{2}\right)x+\left(t_{1}+t_{2}\right)\)</span></p>
<p><span class="math">\(\left(s_{1}x+t_{1}\right)\cdot\left(s_{2}x+t_{2}\right)=s_{1}s_{2}x^{2}+\left(s_{1}t_{2}+s_{2}t_{1}\right)x+t_{1}t_{2}=\)</span></p>
<p><span class="math">\(\left(s_{1}t_{2}+s_{2}t_{1}+as_{1}s_{2}\right)x+\left(t_{1}t_{2}-bs_{1}s_{2}\right)\)</span></p>
<p>זה ייצוג מפורש של פעולות החשבון, גם עבור מי שלא מבין את הדיבורים הגבוהים על חלוקה באידאלים של חוגי פולינומים. עכשיו אפשר לעבור לאקשן של הוכחת המשפט. המשפט, כזכור, אומר שאם <span class="math">\(p\)</span> הוא מספר ראשוני שזר ל-<span class="math">\(2b\Delta\)</span> אז <span class="math">\(p\)</span> מחלק את <span class="math">\(U_{p-\left(\frac{\Delta}{p}\right)}\)</span>, כאשר <span class="math">\(\Delta=a^{2}-4b\)</span>.</p>
<p>הגיע הזמן להבין מאיפה הגיע <span class="math">\(\Delta\)</span> הזה. אולי אתם זוכרים מהתיכון שזה סימון של <strong>דיסקרימיננטה</strong>, שזה "המשהו שמתחת לשורש" בפתרון משוואה ריבועית. זה לא מקרי. ההפרדה למקרים שלנו עוסקת בדיוק בשאלה האם הפולינום <span class="math">\(x^{2}-ax+b\)</span> הוא אי-פריק (ואז חלוקה בו נותנת שדה) או שהוא פריק (ואז עדיין אפשר להגדיר את פעולות החשבון כמו למעלה אבל נקבל משהו שאינו שדה). לשם כך משתמשים בנוסחת השורשים, שנכונה גם מעל שדות סופיים: שורשי הפולינום הזה הם <span class="math">\(\frac{a\pm\sqrt{a^{2}-4b}}{2}=\frac{a\pm\sqrt{\Delta}}{2}\)</span> ולכן יש לפולינום הזה שורש אם ורק אם ל-<span class="math">\(\Delta\)</span> יש שורש, כלומר אם ורק אם <span class="math">\(\left(\frac{\Delta}{p}\right)=1\)</span> (בלתי אפשרי שיתקיים ש-<span class="math">\(\Delta\)</span> היא 0 ב-<span class="math">\(\mathbb{Z}_{p}\)</span> כי המשמעות של כך היא ש-<span class="math">\(\Delta\)</span> לא זרה ל-<span class="math">\(p\)</span>, בניגוד להנחה שלנו).</p>
<p>אם <span class="math">\(\left(\frac{\Delta}{p}\right)=-1\)</span>, כלומר <span class="math">\(\Delta\)</span> איננו ריבוע, קיבלנו שאוסף הפולינומים שלנו מודולו <span class="math">\(f\left(x\right)\)</span> הוא שדה. עכשיו מגיע השלב שבו אנחנו מגלים שמשתלם לנו לחשוב לא רק על מספרים שלמים אלא גם על עולם רחב יותר מזה - אפשר להשתמש בידע שיש לנו בתורת השדות. ספציפית, הידע הזה מלמד אותנו במקרה הזה שבתוך השדה שלנו, <span class="math">\(x^{p}=a-x\)</span> ואילו <span class="math">\(\left(a-x\right)^{p}=x\)</span>. למה? ובכן, ראשית נשים לב לכך שבתוך השדה שבנינו, <span class="math">\(x\)</span> הוא שורש של הפולינום <span class="math">\(f\left(t\right)=t^{2}-at+b\)</span> (אני כותב אותו בכוונה עם <span class="math">\(t\)</span> הפעם כדי לא ליצור בלבול - ה-<span class="math">\(x\)</span> הוא איבר של ממש בשדה, בעוד שסימון המשתנה שאיתו אנחנו בוחרים לתאר פולינום הוא לגמרי בשליטתנו). כמו כן, אפשר לראות שגם <span class="math">\(a-x\)</span> הוא שורש של הפולינום הזה, על ידי הצבה ישירה:</p>
<p><span class="math">\(\left(a-x\right)^{2}-a\left(a-x\right)+b=a^{2}-2ax+x^{2}-a^{2}+ax+b=-ax+ax-b+b=0\)</span></p>
<p>עכשיו, תוצאה בסיסית בתורת השדות היא שבהינתן שדה סופי <span class="math">\(\mathbb{F}_{p^{k}}\)</span>, הפונקציה <span class="math">\(a\mapsto a^{p}\)</span> היא <strong>אוטומורפיזם</strong> של השדה, שזוכה לשם המיוחד <strong>אוטומורפיזם פרובניוס</strong>. ידוע גם שהפונקציה הזו היא הזהות בדיוק על שדה הבסיס <span class="math">\(\mathbb{F}_{p}=\mathbb{Z}_{p}\)</span>, ואנחנו יודעים בדיוק מה עושה אוטומורפיזם של שדה <span class="math">\(E\)</span> שהוא הזהות בדיוק על שדה הבסיס <span class="math">\(F\)</span>, כשנותנים לו שורשים של פולינומים שהמקדמים שלהם כולם מתוך <span class="math">\(F\)</span>: הוא חייב לבצע <strong>פרמוטציה</strong> של השורשים הללו. כלומר, חופש הבחירה של האוטומורפיזם לאן הוא רוצה לשלוח את השורשים מוגבל לשורשים אחרים של אותו הפולינום. האבחנה הזו היא הבסיס לתורת גלואה, אבל לא אכנס לכך כרגע. השורה התחתונה היא שלמי שיש נסיון בתורת השדות ברור כמעט מייד שיתקיימו שני השוויונות שכתבתי למעלה. וזה אומר את הדבר הבא:</p>
<p><span class="math">\(U_{p+1}=\frac{x^{p+1}-\left(a-x\right)^{p+1}}{x-\left(a-x\right)}=\frac{x\left(a-x\right)-\left(a-x\right)x}{x-\left(a-x\right)}=0\)</span></p>
<p>כלומר, <span class="math">\(U_{p+1}\)</span> מתחלק ב-<span class="math">\(p\)</span>, בדיוק כפי שרצינו.</p>
<p>המקרה השני, <span class="math">\(\left(\frac{\Delta}{p}\right)=1\)</span>, הוא קצת שונה אבל בצורה שהופכת אותו לפשוט יותר. במקרה הזה אוסף הפולינומים שלנו לא מהווה שדה אלא "סתם" חוג - אז איזה חוג זה? בעזרת <a href="http://www.gadial.net/2012/09/12/chinese_remainder_theorem/">משפט השאריות הסיני</a> בגרסה מוכללת שלו אפשר להראות שאם מחלקים חוג <span class="math">\(R\)</span> במכפלה של אידאלים <span class="math">\(IJ\)</span> אז מקבלים את המכפלה של חלוקת החוג בכל אידאל בנפרד, כלומר <span class="math">\(R/IJ\cong R/I\times R/J\)</span>. במקרה שלנו אנחנו מחלקים באידאל שנוצר על ידי פולינום; אם הפולינום מתפרק, אפשר לכתוב את האידאל שהוא יוצר בתור מכפלת האידאלים של המרכיבים של הפירוק. כל אחד מהם הוא פולינום ממעלה 1 ולכן החוג שמתקבל מחלוקה בהם איזומורפי לחוג המקורי. כל להטוטי האלגברה הללו מובילים למסקנה הפשוטה: במקרה השני החוג שלנו הוא <span class="math">\(\mathbb{Z}_{p}\times\mathbb{Z}_{p}\)</span>. החוג הזה נחמד מאוד כי קל לראות שכאשר מעלים איבר <strong>כלשהו</strong> בו בחזקת <span class="math">\(p\)</span> מקבלים חזרה את האיבר המקורי. לכן במקרה הזה <span class="math">\(x^{p}=x\)</span> ו-<span class="math">\(\left(a-x\right)^{p}=a-x\)</span> ולכן אחרי צמצום (צריך לנמק למה אפשר לצמצם את האיברים הללו - נסו!) מקבלים <span class="math">\(x^{p-1}=\left(a-x\right)^{p-1}=1\)</span> ואנחנו מקבלים:</p>
<p><span class="math">\(U_{p-1}=\frac{x^{p-1}-\left(a-x\right)^{p-1}}{x-\left(a-x\right)}=\frac{1-1}{x-\left(a-x\right)}=0\)</span></p>
<p>כלומר <span class="math">\(U_{p-1}\)</span> מתחלק ב-<span class="math">\(p\)</span>, כפי שרצינו.</p>
<p>סיימנו את ההוכחה של משפט מאוד נחמד שנותן לנו מבחן של פסאודוראשוניות, אבל בואו נתאפס לרגע - התחלנו את הפוסט הזה עם אלגוריתם לוקאס-להמר ואנחנו עדיין ממש לא שם. על פניו כל מה שעשינו כרגע בכלל לא היה קשור. בפועל אנחנו כבר מאוד קרובים אל לוקאס-להמר, אבל לפני כן אני צריך להציג מבחן כללי יותר שיכול להוכיח ראשוניות - נקרא לו "מבחן ה-<span class="math">\(n+1\)</span>". לוקאס-להמר יתקבל בתור מקרה פרטי נחמד במיוחד שלו.</p>
<p>המבחן אומר את הדבר הבא: בואו ניקח <span class="math">\(f\left(x\right)=x^{2}-ax+b\)</span> כמו קודם ונסמן <span class="math">\(\Delta=a^{2}-4b\)</span> כמו קודם, וניקח מספר <span class="math">\(n\)</span> חיובי כלשהו שהוא זר ל-<span class="math">\(2b\)</span> ומקיים <span class="math">\(\left(\frac{\Delta}{n}\right)=-1\)</span>. ראשית כל נבדוק האם <span class="math">\(U_{n+1}\)</span> מתחלק ב-<span class="math">\(n\)</span>, כמו קודם: אם <span class="math">\(n\)</span> ראשוני זה חייב להתקיים. אבל זה לא מספיק כדי להוכיח שהוא ראשוני. אבל אפשר לחזק את זה: בואו ניקח מחלק <strong>כלשהו</strong> של <span class="math">\(n+1\)</span> ונסמן אותו ב-<span class="math">\(F\)</span>. נניח שאנחנו מכירים את הפירוק לגורמים ראשוניים של <span class="math">\(F\)</span>. לכל גורם ראשוני <span class="math">\(q\)</span> של <span class="math">\(F\)</span>, נבדוק אם <span class="math">\(U_{\frac{n+1}{q}}\)</span> זר ל-<span class="math">\(n\)</span>. אם כן, זה מוכיח שלכל <span class="math">\(p\)</span> ראשוני שמחלק את <span class="math">\(n\)</span> מתקיים <span class="math">\(p\equiv\left(\frac{\Delta}{p}\right)\)</span> מודולו <span class="math">\(F\)</span>.</p>
<p>רגע, מה? המסקנה של המשפט ממש לא ברורה. את מי זה מעניין? ובכן עבור ערכים קטנים של <span class="math">\(F\)</span> זה לא כל כך מעניין. אבל נניח ש-<span class="math">\(n\)</span> לא ראשוני ולקחנו <span class="math">\(F>\sqrt{n}+1\)</span>, אז בהכרח <strong>כל</strong> הגורמים הראשוניים של <span class="math">\(n\)</span> יהיו קטנים מ-<span class="math">\(F\)</span>, ולכן מודולו <span class="math">\(F\)</span> יהיו שווים לעצמם. מה שאומר שהמשוואה <span class="math">\(p\equiv\left(\frac{\Delta}{p}\right)\)</span> לא תוכל להתקיים בכלל. מכאן שאם מצאנו <span class="math">\(F>\sqrt{n}+1\)</span> שמקיים את הבדיקה שלעיל (<span class="math">\(U_{\frac{n+1}{q}}\)</span> זר ל-<span class="math">\(n\)</span> לכל <span class="math">\(q\)</span> ראשוני שמחלק את <span class="math">\(F\)</span>), זה מוכיח ש-<span class="math">\(n\)</span> ראשוני.</p>
<p>למה זה נכון? ובכן, ראשית בואו נסמן ב-<span class="math">\(r_{f}\left(n\right)\)</span> את האינדקס של המספר הראשון בסדרה <span class="math">\(U_{k}\)</span> שמתחלק ב-<span class="math">\(n\)</span>. קוראים לזה <strong>דרגת ההופעה</strong> של <span class="math">\(n\)</span>. אפשר להוכיח עם קצת עבודה טכנית שאדלג עליה שדרגת ההופעה של <span class="math">\(n\)</span> מחלקת כל מופע אחר של <span class="math">\(n\)</span>: דהיינו, <span class="math">\(U_{k}\)</span> כלשהו מתחלק ב-<span class="math">\(n\)</span> אם ורק אם <span class="math">\(k\)</span> מתחלק ב-<span class="math">\(r_{f}\left(n\right)\)</span>. ניקח עכשיו מספר ראשוני <span class="math">\(p\)</span> שמחלק את <span class="math">\(n\)</span>: המשפט שראינו קודם אמר שאם <span class="math">\(p\)</span> ראשוני אז הוא מחלק את <span class="math">\(U_{p-\left(\frac{\Delta}{p}\right)}\)</span>. כלומר, קיבלנו ש-<span class="math">\(r_{f}\left(p\right)\)</span> מחלק את <span class="math">\(p-\left(\frac{\Delta}{p}\right)\)</span>, ובניסוח שקול: <span class="math">\(p\equiv\left(\frac{\Delta}{p}\right)\)</span> מודולו <span class="math">\(r_{f}\left(p\right)\)</span> מתקיים תמיד. זו המשוואה שרצינו להגיע אליה, אבל לא מודולו <span class="math">\(r_{f}\left(p\right)\)</span> אלא מודולו מחלק <span class="math">\(F\)</span> של <span class="math">\(n+1\)</span> שמקיים כך-וכך. לצורך כך יספיק לנו להוכיח ש-<span class="math">\(F\)</span> שמקיים כך-וכך מחלק את <span class="math">\(r_{f}\left(p\right)\)</span> (כי אם <span class="math">\(F\)</span> מחלק את <span class="math">\(r_{f}\left(p\right)\)</span> הוא מחלק גם כל דבר שמתחלק על ידי <span class="math">\(r_{f}\left(p\right)\)</span>).</p>
<p>בואו נזכור מה הכך-וכך ש-<span class="math">\(F\)</span> מקיים. ראשית, <span class="math">\(U_{n+1}\)</span> מתחלק ב-<span class="math">\(n\)</span> ולכן בפרט מתחלק ב-<span class="math">\(p\)</span>, ואנחנו יודעים ש-<span class="math">\(F\)</span> מחלק את <span class="math">\(n+1\)</span>. אם היינו יכולים לטעון משהו כמו <span class="math">\(r_{f}\left(p\right)=n+1\)</span> היינו מסיימים כאן. אבל זה לא בהכרח נכון. אנחנו יודעים שבגלל ש-<span class="math">\(p\)</span> מחלק את <span class="math">\(U_{n+1}\)</span> אז <span class="math">\(r_{f}\left(p\right)\)</span> <strong>מחלק</strong> את <span class="math">\(n+1\)</span>, אבל הוא לא חייב להיות שווה לו. אני חושב שהכי ברור להציג את הסיטואציה הזו באופן הבא: אפשר לכתוב את הפירוק לגורמים של <span class="math">\(n+1\)</span>: <span class="math">\(n+1=q_{1}^{k_{1}}\cdots q_{t}^{k_{t}}\)</span>. כעת, המשמעות של "<span class="math">\(r_{f}\left(p\right)\)</span> מחלק את <span class="math">\(n+1\)</span>" הוא שיש ל-<span class="math">\(r_{f}\left(p\right)\)</span> <strong>את אותו פירוק לגורמים אבל עם חזקות שהן אולי נמוכות יותר</strong>. במילים אחרות, אפשר להגיע מ-<span class="math">\(n+1\)</span> אל <span class="math">\(r_{f}\left(p\right)\)</span> על ידי סדרה של צעדים, שבכל אחד מהם אנחנו לוקחים גורם ראשוני <span class="math">\(q\)</span> של <span class="math">\(n+1\)</span> ומחלקים את המספר שיש לנו ביד כרגע בגורם הזה. והנה הפאנץ': כל עוד הגורם <span class="math">\(q\)</span> הזה <strong>איננו</strong> גורם של <span class="math">\(F\)</span>, אז <span class="math">\(F\)</span> ימשיך לחלק את התוצאה שלנו (כי אנחנו לא מקטינים את החלק של <span class="math">\(F\)</span> בתוך <span class="math">\(n+1\)</span>).</p>
<p>כאן נכנס לתמונה התנאי הנוסף שאנחנו בודקים: אם עבור גורם <span class="math">\(q\)</span> של <span class="math">\(F\)</span> מתקיים ש-<span class="math">\(U_{\frac{n+1}{q}}\)</span> זר ל-<span class="math">\(n\)</span>, אז בפרט הוא לא מתחלק על ידי אף גורם של <span class="math">\(n\)</span>, כלומר <span class="math">\(p\)</span> לא מחלק את <span class="math">\(U_{\frac{n+1}{q}}\)</span>. זה <strong>מבטיח</strong> שלא ייתכן ש-<span class="math">\(r_{f}\left(p\right)\)</span> יחלק את <span class="math">\(\frac{n+1}{q}\)</span> כי אמרנו שאם אינדקס ההופעה של <span class="math">\(p\)</span> מחלק אינדקס אחר, אז <span class="math">\(p\)</span> מופיע גם באינדקס הזה (דהיינו, <span class="math">\(p\)</span> מחלק את <span class="math">\(U\)</span> עבור האינדקס הזה). המסקנה היא שבמעבר מ-<span class="math">\(n+1\)</span> אל <span class="math">\(r_{f}\left(p\right)\)</span> אנחנו לא מחלקים אף פעם ב-<span class="math">\(q\)</span>, עבור אף <span class="math">\(q\)</span> שהוא מחלק של <span class="math">\(F\)</span>. לכן התוצאה שנקבל בסוף, שהיא <span class="math">\(r_{f}\left(p\right)\)</span>, מתחלקת ב-<span class="math">\(F\)</span> וסיימנו את ההוכחה הזו.</p>
<p>יפה, עוד עצירה לצורך השבת הנשימה והתמקדות מה שכבר עשינו ומה שנשאר לעשות. מה שעשינו היה להוכיח מבחן הוכחת ראשוניות כללי, שנקרא "מבחן ה-<span class="math">\(n+1\)</span>". אני אומר "מבחן <strong>הוכחת</strong> ראשוניות" כי המבחן הזה לא יודע להוכיח שמספר הוא <strong>לא</strong> ראשוני; הוא רק יודע להוכיח, עבור חלק מהמספרים הראשוניים, שהם אכן כאלו. למבחן הזה יש חיסרון בולט - צריך להכיר את הפירוק לגורמים של <span class="math">\(n+1\)</span>, ובאופן כללי בעיית הפירוק לגורמים היא קשה משמעותית יותר מבעיית בדיקת הראשוניות. עדיין, זה שמדובר על בעיה קשה לא אומר שלפעמים לא קל לפרק מספרים לגורמים. נניח שיש לכם מספר <span class="math">\(n\)</span> שממש קריטי עבורכם להוכיח שהוא ראשוני והאלגוריתמים הרגילים רצים ורצים עליו ולא מסיימים - אין שום סיבה לא לתת למבחן ה-<span class="math">\(n+1\)</span> הזדמנות, אולי במזל יוצא שאת <span class="math">\(n+1\)</span> דווקא קל לפרק לגורמים במקרה הזה ואז אפשר יהיה להשתמש במבחן. כל כלי נוסף שמאפשר לנו להוכיח ראשוניות הוא דבר טוב.</p>
<p>אבל פרט להצדקות הכלליות הללו, המבחן מן הסתם מעניין במיוחד במקרה שבו <span class="math">\(n+1\)</span> הוא מספר פשוט במיוחד, ואין סיטואציה פשוטה יותר מאשר זו שבה <span class="math">\(n\)</span> הוא מספר מרסן, כלומר <span class="math">\(n=2^{k}-1\)</span>. במקרה הזה, <span class="math">\(n+1\)</span> הוא פשוט חזקה של 2. לא רק שאנחנו יודעים לפרק אותה עד הסוף, יש לנו גם גורם יחיד, וגורם שהוא בסיסי מאוד. זה לגמרי מזמין נסיון להוכיח שבמקרה הספציפי הזה, אפשר לעשות יותר מסתם להוכיח ראשוניות בחלק מהמקרים - אנחנו הרי רוצים מבחן שעונה תשובה ודאית של כן/לא.</p>
<p>בשביל לבצע את הצעד האחרון, אנחנו צריכים וריאציה על מבחן ה-<span class="math">\(n+1\)</span> שהיא <strong>טיפ-טיפה</strong> יותר מתאימה לנו. בשביל לעשות את זה, אנחנו מכניסים לתמונה סוג חדש של סדרת לוקאס שהזכרתי בחטף בתחילת הפוסט: סדרה <span class="math">\(V_{k}\)</span> שגם היא מוגדרת בעזרת נוסחת נסיגה <span class="math">\(V_{k+2}=aV_{k+1}-bV_{k}\)</span>, אבל תנאי ההתחלה שלה שונים: <span class="math">\(V_{0}=2,V_{1}=a\)</span>. גם לסדרה הזו יש ייצוג נחמד בתור פולינומים: <span class="math">\(V_{k}\triangleq x^{k}+\left(a-x\right)^{k}\)</span>. אם תזכרו ש-<span class="math">\(U_{k}\triangleq\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}\)</span> בוודאי תראו מייד שמתקיים <span class="math">\(U_{k}V_{k}=U_{2k}\)</span> (זה נובע מהתכונה הנחמדה <span class="math">\(\left(a+b\right)\left(a-b\right)=a^{2}-b^{2}\)</span>), כך ששתי הסדרות הללו מקיימות ביניהם קשרים ברורים למדי.</p>
<p>בואו ננסח את מבחן ה-<span class="math">\(n+1\)</span> בוריאציה שמערבת את ה-<span class="math">\(V_{k}\)</span>-ים הללו: אם <span class="math">\(n\)</span> זר ל-<span class="math">\(2b\)</span> ו-<span class="math">\(\left(\frac{\Delta}{n}\right)=-1\)</span>, ניקח מחלק <strong>זוגי </strong><span class="math">\(F\)</span> של <span class="math">\(n+1\)</span> ונבדוק את שני התנאים הבאים:</p>
<ul>
    <li><span class="math">\(V_{F/2}\)</span> מתחלק ב-<span class="math">\(n\)</span>.</li>
    <li><span class="math">\(V_{F/2q}\)</span> זר ל-<span class="math">\(n\)</span> עבור כל <span class="math">\(q\)</span> <strong>אי זוגי</strong> שמחלק את <span class="math">\(F\)</span>.</li>
</ul>
<p>אז במקרה הזה קורה מה שקרה קודם - כל <span class="math">\(p\)</span> שמחלק את <span class="math">\(n\)</span> מקיים <span class="math">\(p\equiv\left(\frac{\Delta}{p}\right)\)</span> מודולו <span class="math">\(F\)</span>.</p>
<p>הניסוח הזה <strong>מושלם</strong> עבור מספרי מרסן בגלל שהתנאי השני בכלל לא יכול לבוא לידי ביטוי: אם <span class="math">\(F\)</span> מחלק את <span class="math">\(n+1\)</span>, שהוא חזקה של 2, אז גם <span class="math">\(F\)</span> הוא בסך הכל חזקה של 2 ולכן אין לו גורמים אי זוגיים. בואו נסביר בזריזות למה הגרסה הזו של מבחן ה-<span class="math">\(n+1\)</span> נכונה ואז נגיע סוף סוף להוכחת לוקאס-להמר.</p>
<p>מן הסתם אין לי כוונה להוכיח את מבחן ה-<span class="math">\(n+1\)</span> החדש הזה מאפס - אני מבצע פה רדוקציה למבחן הקודם, עם ה-<span class="math">\(U_{k}\)</span>-ים. ראשית, אני צריך להראות ש-<span class="math">\(U_{n+1}\)</span> מתחלק ב-<span class="math">\(n\)</span>. אם <span class="math">\(F\)</span> מחלק את <span class="math">\(n+1\)</span> יהיה מספיק להוכיח ש-<span class="math">\(U_{F}\)</span> מתחלק ב-<span class="math">\(n\)</span> (כי אפשר להראות שאם <span class="math">\(k\)</span> מחלק את <span class="math">\(t\)</span> אז <span class="math">\(U_{k}\)</span> מחלק את <span class="math">\(U_{t}\)</span>). מכיוון ש-<span class="math">\(U_{F}=U_{F/2}V_{F/2}\)</span> ומכיוון שאנחנו מניחים ש-<span class="math">\(V_{F/2}\)</span> מתחלק ב-<span class="math">\(n\)</span>, יש לנו את התנאי הזה.</p>
<p>התנאי השני של מבחן ה-<span class="math">\(n+1\)</span> המקורי הוא ש-<span class="math">\(U_{\frac{n+1}{q}}\)</span> זר ל-<span class="math">\(n\)</span> עבור כל מחלק ראשוני <span class="math">\(q\)</span> של <span class="math">\(F\)</span>. בשביל זה מספיק להראות ש-<span class="math">\(U_{\frac{F}{2q}}\)</span> זר ל-<span class="math">\(n\)</span> (כי <span class="math">\(U_{\frac{F}{2q}}\)</span> מחלק את <span class="math">\(U_{\frac{n+1}{q}}\)</span>), ובשביל זה מספיק להראות ש-<span class="math">\(U_{F/2}\)</span> זר ל-<span class="math">\(n\)</span>. שימו לב שאנחנו כבר יודעים ש-<span class="math">\(V_{F/2}\)</span> לא רק שהוא לא זר ל-<span class="math">\(n\)</span> אלא שהוא ממש מתחלק בו, כלומר <strong>כל</strong> מחלק של <span class="math">\(n\)</span> מחלק את <span class="math">\(V_{F/2}\)</span>. לכן כדי לסיים את זה מספיק להוכיח שלכל <span class="math">\(k\)</span>, אין ל-<span class="math">\(U_{k},V_{k}\)</span> בו זמנית מחלקים משותפים שהם גם מחלקים של <span class="math">\(n\)</span>. ליתר דיוק, נראה שכל מחלק משותף כזה חייב לחלק את <span class="math">\(2b\)</span>, ונשתמש בהנחה שלנו ש-<span class="math">\(2b\)</span> זר ל-<span class="math">\(n\)</span>.</p>
<p>הנימוק עכשיו חוזר להגדרה הבסיסית של <span class="math">\(U_{k},V_{k}\)</span>. נניח ש-<span class="math">\(p\)</span> הוא מחלק ראשוני של <span class="math">\(n\)</span> שמחלק בו זמנית את <span class="math">\(U_{k}\)</span> ואת <span class="math">\(V_{k}\)</span>. אז יש לנו את שתי המשוואות הבאות מודולו <span class="math">\(p\)</span> (ומודולו <span class="math">\(f\left(x\right)\)</span> אבל מי זוכר את זה): <span class="math">\(\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}=0\)</span> ו-<span class="math">\(x^{k}+\left(a-x\right)^{k}=0\)</span>. מהראשונה נקבל את <span class="math">\(x^{k}-\left(a-x\right)^{k}=0\)</span> ואחרי שנחבר את שתיהן נקבל <span class="math">\(2x^{k}=0\)</span>. אפשר לצמצם פה ב-2 כי הוא זר ל-<span class="math">\(p\)</span>, ולכן נקבל <span class="math">\(x^{k}=0\)</span>. איך זה קשור ל-<span class="math">\(b\)</span>? ובכן, <span class="math">\(b=x\left(a-x\right)\)</span> מודולו <span class="math">\(f\left(x\right)\)</span> (כי <span class="math">\(f\left(x\right)\)</span> הוא הפולינום <span class="math">\(x^{2}-ax+b\)</span>) ולכן <span class="math">\(b^{k}=x^{k}\left(a-x\right)^{k}=0\)</span> מודולו <span class="math">\(f\left(x\right)\)</span> ו-<span class="math">\(p\)</span>. בפרט, <span class="math">\(p\)</span> מחלק את <span class="math">\(b^{k}\)</span> ולכן הוא מחלק את <span class="math">\(b\)</span> וסיימנו.</p>
<p>אנחנו ממש בסיום. הראינו וריאציה למבחן ה-<span class="math">\(n+1\)</span> שמשתמשת בסדרת ה-<span class="math">\(V\)</span>-ים במקום בסדרת ה-<span class="math">\(U\)</span>-ים. עכשיו נבחן מה קורה כשאנחנו משתמשים במבחן הזה ספציפית על מספרי מרסן. במקרה הזה, <span class="math">\(n=M_{p}=2^{p}-1\)</span> עבור <span class="math">\(p\)</span> ראשוני כלשהו. כמו כן, אנחנו צריכים להחליט על <span class="math">\(f\left(x\right)\)</span> קונקרטי שנבנה את המבחן סביבו - מה שיוצא טוב במקרה הזה הוא <span class="math">\(f\left(x\right)=x^{2}-4x+1\)</span>, דהיינו <span class="math">\(a=4,b=1\)</span>, ולכן <span class="math">\(\Delta=a^{2}-4b=12\)</span>. האם <span class="math">\(n\)</span> זר ל-<span class="math">\(2\Delta=24\)</span>? הוא בוודאי לא זוגי, אבל אולי הוא מתחלק ב-3? ובכן, לא: 2 בחזקת מספר אי זוגי שקול תמיד ל-2 מודולו 3 ולכן חזקה של 2 פחות 1 שקולה ל-1 מודולו 3. זה מראה ש-<span class="math">\(n\)</span> זר ל-<span class="math">\(\Delta\)</span>. עדיין צריך להשתכנע ש-<span class="math">\(\left(\frac{\Delta}{n}\right)=-1\)</span> כדי שאפשר יהיה להשתמש במבחן. חישוב של סימן יעקובי שכזה הוא עניין סטנדרטי למדי שלא אוכיח את פרטיו פה: הרעיון הוא ש-<span class="math">\(\left(\frac{\Delta}{n}\right)=\left(\frac{24}{n}\right)=\left(\frac{2}{n}\right)\left(\frac{4}{n}\right)\left(\frac{3}{n}\right)=\left(\frac{2}{n}\right)\left(\frac{3}{n}\right)\)</span> ועכשיו אפשר לטפל בנפרד במוכפלים. ידוע ש-<span class="math">\(\left(\frac{2}{n}\right)=1\)</span> אם <span class="math">\(n\)</span> שקול ל-7 מודולו <span class="math">\(8\)</span> (וזה יהיה המקרה פה כי <span class="math">\(n+1\)</span> הוא חזקה גבוהה של 2 ולכן מתחלק ב-8). עבור <span class="math">\(\left(\frac{3}{n}\right)\)</span> צריך להשתמש במשפט ההדדיות: <span class="math">\(\left(\frac{3}{n}\right)=-\left(\frac{n}{3}\right)\)</span> (המינוס נובע מכך שגם ה-3 שב"מונה" וגם ה-<span class="math">\(n\)</span> שב"מכנה" הם שניהם 3 מודולו 4). כעת, אפשר להחליף את <span class="math">\(n\)</span> שב"מונה" במספר ששקול לו מודולו 3, שהוא כאמור 2, ואנחנו יודעים ש-2 איננו שארית ריבועית מודולו 3, ולכן נקבל פה <span class="math">\(-\left(\frac{n}{3}\right)=-\left(-1\right)=1\)</span> בסופו של דבר.</p>
<p>עכשיו נותר לבחור מחלק זוגי <span class="math">\(F\)</span> של <span class="math">\(n+1\)</span> כדי להפעיל עליו את המבחן. משתלם לבחור כאן את <span class="math">\(2^{p-1}\)</span>. עם הבחירה הזו, התנאי הראשון של המבחן שיש לבדוק הוא ש-<span class="math">\(V_{2^{p-2}}\)</span> מתחלק ב-<span class="math">\(M_{p}\)</span>. והתנאי השני? הוא נעלם, כי הוא מערב מחלקים אי זוגיים של <span class="math">\(F\)</span> ואין כאלו.</p>
<p>נותרנו, אם כן, עם השאלה איך אפשר לחשב את <span class="math">\(V_{2^{p-2}}\)</span>. כאן סוף סוף נכנסת לתמונה <strong>סדרת לוקאס-להמר</strong> מתחילת הפוסט. זו שהוגדרה באמצעות הכלל <span class="math">\(a_{0}=4\)</span> ו-<span class="math">\(a_{n+1}=a_{n}^{2}-2\)</span>. זו פשוט <span class="math">\(V_{k}\)</span> עם הפולינום המגדיר <span class="math">\(x^{2}-4x+1\)</span> בתחפושת, כשאנחנו מתקדמים ב"קפיצות" וכל פעם מכפילים את האינדקס שלנו. קל לראות את זה מההגדרה ה"פולינומית" של <span class="math">\(V_{k}\)</span>:</p>
<p><span class="math">\(V_{2k}=x^{2k}+\left(4-x\right)^{2k}=\left(x^{k}+\left(4-x\right)^{k}\right)^{2}-2x^{k}\left(4-x\right)^{k}\equiv V_{k}^{2}-2\)</span></p>
<p>כאשר המעבר האחרון הוא מודולו <span class="math">\(f\left(x\right)=x^{2}-4x+1\)</span> (מה שחוקי לעשות כי כל הסדרה מוגדרת מודולו הפולינום הזה מלכתחילה).</p>
<p>גם את תנאי ההתחלה קל להבין כעת: אמרנו ש-<span class="math">\(V_{0}=2\)</span> ו-<span class="math">\(V_{1}=a\)</span>, ובמקרה שלנו <span class="math">\(V_{1}=4\)</span>. כלומר, הסדרה <span class="math">\(a_{n}\)</span> <strong>באמת</strong> מוגדרת בתור <span class="math">\(a_{0}=V_{1}\)</span> ובאופן כללי, <span class="math">\(a_{n}=V_{2^{n}}\)</span>. לכן <span class="math">\(a_{p-2}\)</span> הוא בדיוק <span class="math">\(V_{2^{p-2}}\)</span> שלנו, כמבוקש.</p>
<p>האם סיימנו? לא! עדיין לא! זאת מכיוון שראינו רק כיוון אחד: מבחן ה-<span class="math">\(n+1\)</span> מוכיח רק ש<strong>אם</strong> <span class="math">\(n\)</span> עובר אותו, אז <span class="math">\(n\)</span> ראשוני. אבל זה עדיין לא מוכיח שאם <span class="math">\(n\)</span> ראשוני אז בהכרח הוא יעבור את המבחן. במילים אחרות, אנחנו עדיין צריכים להראות שאם <span class="math">\(M_{p}\)</span> ראשוני אז <span class="math">\(a_{p-2}\)</span> יתחלק על ידו. זה דומה באופי שלו למבחן הפיבונאצ'י מתחילת הפוסט, וגם ההוכחה די דומה.</p>
<p>נניח אם כן ש-<span class="math">\(n\)</span> הוא אכן ראשוני. כבר ראינו קודם ש-<span class="math">\(\left(\frac{\Delta}{n}\right)=-1\)</span> במקרה הנוכחי, ולכן כשמסתכלים על חוג הפולינומים מודולו <span class="math">\(n\)</span> ו-<span class="math">\(f\left(x\right)\)</span> מקבלים שדה סופי עם <span class="math">\(n^{2}\)</span> איברים (זה דומה למה שהלך בהוכחה של פיבונאצ'י). בשדה כזה, כפי שראינו קודם, מתקיים <span class="math">\(x^{n}=4-x\)</span>. עכשיו נבצע להטוט אלגברי שמטרתו לחשב את <span class="math">\(\left(x-1\right)^{n+1}\)</span> בשתי דרכים שונות. החישובים שלנו יתבצעו כולם בתוך השדה, כלומר אני אעשה הכל מודולו <span class="math">\(n\)</span> ומודולו <span class="math">\(f\left(x\right)\)</span> (דהיינו תוך שימוש בשוויון <span class="math">\(x^{2}=4x-1\)</span>) בלי להזכיר זאת אפילו. כעת:</p>
<p><span class="math">\(\left(x-1\right)^{2}=x^{2}-2x+1=2x\)</span></p>
<p>ולכן:</p>
<p><span class="math">\(\left(x-1\right)^{n+1}=\left(2x\right)^{\frac{n+1}{2}}=2\cdot2^{\frac{n-1}{2}}x^{\frac{n+1}{2}}\)</span></p>
<p>אני רוצה לנטרל את ה-<span class="math">\(2^{\frac{n-1}{2}}\)</span> הזה שבאמצע ולטעון שהוא שווה ל-1 (מודולו <span class="math">\(n\)</span>); זו עוד תוצאה סטנדרטית על שאריות ריבועיות שלא אוכיח כרגע (לכל מספר <span class="math">\(a\)</span> וראשוני <span class="math">\(p\)</span> מתקיים ש-<span class="math">\(\left(\frac{a}{p}\right)=a^{\frac{p-1}{2}}\)</span> מודולו <span class="math">\(p\)</span>). קיבלנו, אם כן, את השוויון</p>
<p><span class="math">\(\left(x-1\right)^{n+1}=2x^{\frac{n+1}{2}}\)</span></p>
<p>עכשיו לחישוב בדרך השניה. אני הולך להתבסס על כך ש-<span class="math">\(\left(a+b\right)^{n}=a^{n}+b^{n}\)</span> מודולו <span class="math">\(n\)</span> (זה נכון רק כש-<span class="math">\(n\)</span> ראשוני, כמו במקרה שלנו) ולכן <span class="math">\(\left(x-1\right)^{n}=x^{n}+\left(-1\right)^{n}=x^{n}-1\)</span> (המעבר האחרון נכון רק כש-<span class="math">\(n\)</span> אי זוגי, כמו במקרה שלנו) ועל מה שהזכרתי לפני רגע, ש-<span class="math">\(x^{n}=4-x\)</span>:</p>
<p><span class="math">\(\left(x-1\right)^{n+1}=\left(x-1\right)\left(x-1\right)^{n}=\left(x-1\right)\left(x^{n}-1\right)=\left(x-1\right)\left(3-x\right)=4x-x^{2}-3=-2\)</span></p>
<p>ולכן קיבלנו:</p>
<p><span class="math">\(2x^{\frac{n+1}{2}}=-2\)</span></p>
<p>כלומר:</p>
<p><span class="math">\(x^{\frac{n+1}{2}}=-1\)</span>.</p>
<p>בואו ניזכר עכשיו מה זה <span class="math">\(n\)</span>: זה <span class="math">\(n=2^{p}-1\)</span>, כלומר <span class="math">\(\frac{n+1}{2}=2^{p-1}\)</span>. לכן קיבלנו <span class="math">\(x^{2^{p-1}}=-1\)</span>. את כל העסק הזה אפשר להעלות בחזקת <span class="math">\(n\)</span> כדי להפוך את ה-<span class="math">\(x\)</span> ל-<span class="math">\(4-x\)</span>; אגף ימין לא ישתנה כי <span class="math">\(n\)</span> אי-זוגי. נקבל <span class="math">\(\left(4-x\right)^{2^{p-1}}=-1\)</span>. מכיוון ש-<span class="math">\(U_{2^{p-1}}\)</span> הוא הפרש שני אלו חלקי משהו מודולו <span class="math">\(n\)</span>, נקבל שהוא מתחלק ב-<span class="math">\(n\)</span>. עכשיו, <span class="math">\(U_{2^{p-1}}=U_{2^{p-2}}V_{2^{p-2}}\)</span>; מכיוון ש-<span class="math">\(n\)</span> ראשוני, אם הוא מחלק את המכפלה שלהם הוא חייב לחלק אחד מהם. אם הוא מחלק את <span class="math">\(V_{2^{p-2}}\)</span>, סיימנו; זה בדיוק מה שרצינו להראות. נשאר רק להשתכנע שהוא לא מחלק את <span class="math">\(U_{2^{p-2}}\)</span>. אם הוא כן, אז נקבל את השוויון <span class="math">\(x^{2^{p-2}}=\left(4-x\right)^{2^{p-2}}\)</span>, ועל כן:</p>
<p><span class="math">\(-1=x^{2^{p-1}}=x^{2^{p-2}}\cdot x^{2^{p-2}}=x^{2^{p-2}}\left(4-x\right)^{2^{p-2}}=\left(x\left(4-x\right)\right)^{2^{p-2}}=1^{2^{p-2}}=1\)</span></p>
<p>וזו סתירה, כי גם מודולו <span class="math">\(f\left(x\right)\)</span> ומודולו <span class="math">\(n\)</span>, עדיין <span class="math">\(1\ne-1\)</span>, מה שמסיים את ההוכחה.</p>
<p>סוף דבר - התחלנו עם מבחן פשוט בצורה קיצונית ויעיל בצורה קיצונית. גילינו שההוכחה לא פשוטה בצורה קיצונית, אבל גם אין בה שום דבר מתוחכם במיוחד, ובדרך ראינו כל מני מבחנים למציאת פסואדוראשוניים והוכחת ראשוניות. עבורי מי שהיה נחמד פה במיוחד הוא לראות איך דברים כמו שדות סופיים, אוטומורפיזם פרובניוס ושאריות ריבועיות צצים כמעט מאליהם כשמתעסקים בנושאים הללו; כשרק לומדים אותם המושגים הללו נראים די מנותקים ולא כמו כלי העבודה המאוד בסיסי שהם.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('expanded');
        }
        
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/blog/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>