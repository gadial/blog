<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://gadial.net/feed.xml" rel="self" type="application/atom+xml" /><link href="http://gadial.net/" rel="alternate" type="text/html" /><updated>2025-10-03T09:46:07+00:00</updated><id>http://gadial.net/feed.xml</id><title type="html">לא מדויק</title><subtitle>בלוג על מתמטיקה ומדעי המחשב</subtitle><entry><title type="html">עוגה עוגה עוגה (נתהפכה כל היום עד אשר נמצא מקום)</title><link href="http://gadial.net/2025/10/03/cake_cutting_riddle/" rel="alternate" type="text/html" title="עוגה עוגה עוגה (נתהפכה כל היום עד אשר נמצא מקום)" /><published>2025-10-03T00:00:00+00:00</published><updated>2025-10-03T00:00:00+00:00</updated><id>http://gadial.net/2025/10/03/cake_cutting_riddle</id><content type="html" xml:base="http://gadial.net/2025/10/03/cake_cutting_riddle/">&lt;p&gt;בפוסט הזה אני רוצה לדבר על חידה שנראית תמימה למדי ממבט ראשוןת אבל למעשה היא ערמומית מאוד ובצורה הטובה ביותר - כנראה יש לה יותר סיכוי להפיל בפח דווקא את פותרי החידות המשופשפים יותר, שכבר פיתחו אינטואיציה לא רעה שיש סיכוי טוב שתבגוד בהם בצורה אכזרית עם החידה הזו (או לפחות, זה מה שקרה &lt;strong&gt;לי&lt;/strong&gt;).&lt;/p&gt;

&lt;p&gt;החידה הולכת ככה: יש לנו עוגה, כלומר מעגל מושלם, ואנחנו חותכים ממנה פלחים &lt;strong&gt;והופכים&lt;/strong&gt; כל פלח שחתכנו. זו עוגה עם ציפוי שוקולד למעלה, אבל למטה אין לה כלום. והשאלות שנשאלות הן:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;אחרי כמה זמן כל הציפוי יהיה שוב למעלה כמו שהיה בהתחלה?&lt;/li&gt;


&lt;li&gt;אחרי כמה זמן כל הציפוי יהיה למטה, כלומר הכל התהפך?&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;בואו נסביר את הפרטים המדויקים. מה שאנחנו עושים הוא זה: קודם כל אנחנו חותכים את העוגה בחתך שמגיע מהשפה שלה עד למרכז (“רדיוס”). אחר כך אנחנו יוצרים חתך נוסף, שיוצר זווית &lt;span&gt;\( \theta \)&lt;/span&gt; עם החתך הקודם. עכשיו יש לנו פלח עוגה - כל מה שנמצא בין שני החתכים שחתכנו. אנחנו מוציאים את הפלח הזה בזהירות מהעוגה, הופכים אותו, ואז מכניסים אותו שוב בזהירות לתוך העוגה. ואז אנחנו זזים בזווית &lt;span&gt;\( \theta \)&lt;/span&gt; שוב, חותכים שוב, והופכים את הפלח החדש שקיבלנו (שאחד הגבולות שלו הוא גבול של הפלח הקודם) וכן הלאה וכן הלאה.&lt;/p&gt;

&lt;p&gt;הנה איור שמתאר את המהומה הזו עבור &lt;span&gt;\( \theta=\frac{\pi}{2} \)&lt;/span&gt; (“90 מעלות”):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/cake_cutting_1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;בכל פעם שאני הופך פלח עוגה, אני קורא לזה “צעד”. אז אנחנו רואים שבמקרה הזה, אחרי ארבעה צעדים כל הציפוי יהיה למטה, ואחרי שמונה צעדים כל הציפוי יהיה למעלה. זו התשובה לחידה במקרה הזה. אבל המקרה הזה בבירור פשוט למדי - עבור זוויות אחרות די ברור שיהיו סיטואציות מסובכות יותר כמו זו שבה הפלח שחתכנו כרגע הוא חתיכה שכבר חתכנו בעבר , אז לכאורה כשננסה להפוך אותו הוא יתפרק לשניים והכל יימרח בכל מקום… אז בואו נניח שאנחנו יודעים להפוך פלחים-עם-חתכים בצורה מושלמת, כאילו הם הצליחו להידבק אחד לשני מחדש. עכשיו אפשר לשאול את השאלה עבור זווית קונקרטית לגמרי, למשל &lt;span&gt;\( \theta=e^{-10} \)&lt;/span&gt; כאשר &lt;span&gt;\( e=2.718\ldots \)&lt;/span&gt; הוא בסיס הלוגריתם הטבעי המוכר. כאן אני מודד זוויות עם &lt;a href=&quot;https://gadial.net/2021/08/18/trigonometry_intro_6/&quot;&gt;רדיאנים&lt;/a&gt;, כלומר בכל צעד אני עובר &lt;span&gt;\( \frac{\theta}{2\pi}=\frac{1}{2\pi e^{10}} \)&lt;/span&gt; מעגל.&lt;/p&gt;

&lt;p&gt;אוקיי, אז מה התשובה? בואו נצא להפסקה. אני &lt;strong&gt;ממליץ מאוד בחום&lt;/strong&gt; לא לקרוא את ההמשך לפני שניסיתם לפתור את החידה בעצמכם. בלי זה, זה פשוט לא יהיה כיף. אני לא אומר שהחידה בהכרח תצליח לעבוד עליכם; בהחלט ייתכן שתצליחו להגיע לפתרון עצמאית, אבל אז זה רק עוד יותר כיף, לא? בינתיים הנה צילום מסך ממשחק הניינטיז שבו נתקלתי בחידה הזו לראשונה:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/cake_cutting_2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אוקיי, כולנו חשבנו על החידה? אפשר להמשיך ולהתחיל לספיילר חופשי? יופי. ראשית - לא, אין שום משחק ניינטיז (ועכשיו קצת עצוב לי שאין), זו תמונה מג’ונרטת מן הסתם. שנית, מה שהאינטואיציה שלי הולכת אליו מייד בהקשר של החידה הזו הוא טיעון שמבוסס על &lt;strong&gt;אי רציונליות&lt;/strong&gt; שבא להוכיח שהציפוי אף פעם לא יחזור כולו למעלה או יגיע כולו למטה. העניין הוא כזה - אם אני מטייל לי מסביב לעוגה בצעדים שכל אחד מהם עובר בדיוק &lt;span&gt;\( \omega \)&lt;/span&gt;-מעגל כש-&lt;span&gt;\( \omega \)&lt;/span&gt; הוא מספר אי רציונלי אז כשאני מסיים סיבוב סביב העוגה אני לא אחזור בדיוק למקום שממנו התחלתי. גם לא בפעם השניה. או השלישית. או כל פעם אפשרית. כי אם &lt;strong&gt;מתישהו&lt;/strong&gt; חזרתי לנקודת ההתחלה, נאמר אחרי &lt;span&gt;\( k \)&lt;/span&gt; צעדים ו-&lt;span&gt;\( t \)&lt;/span&gt; הקפות של המעגל, אז צריך להתקיים &lt;span&gt;\( k\omega=t \)&lt;/span&gt; כלומר &lt;span&gt;\( \omega=\frac{t}{k} \)&lt;/span&gt; מה שמראה שהוא רציונלי. זה מה שיקרה, למשל, אם &lt;span&gt;\( \theta=\frac{4\pi}{3} \)&lt;/span&gt;, כלומר אם בכל פעם אנחנו עוברים 240 מעלות מהמעגל, שזה &lt;span&gt;\( \frac{2}{3} \)&lt;/span&gt; ממנו: נצטרך &lt;span&gt;\( k=3 \)&lt;/span&gt; צעדים כדי להגיע לנקודת ההתחלה בסיום הקפה מספר &lt;span&gt;\( t=2 \)&lt;/span&gt; של המעגל.&lt;/p&gt;

&lt;p&gt;האם במקרה שלנו &lt;span&gt;\( \omega \)&lt;/span&gt; הוא אי רציונלי? לכאורה כן, הרי השתמשנו ב-&lt;span&gt;\( e^{-10} \)&lt;/span&gt; המאוד לא רציונלי בהגדרה שלו. אבל &lt;span&gt;\( \omega \)&lt;/span&gt; (החלק היחסי של המעגל שאנחנו עוברים בכל פעם) הוא &lt;span&gt;\( \omega=\frac{\theta}{2\pi}=\frac{1}{2\pi e^{10}} \)&lt;/span&gt; ולכן מעורבת כאן השאלה האם &lt;span&gt;\( \pi e^{10} \)&lt;/span&gt; זה גם כן מספר אי רציונלי וזו… שאלה פתוחה, ככל שידוע לי.&lt;/p&gt;

&lt;p&gt;העניין הוא שכל זה לא חשוב. כל מערך השיקולים הזה בכלל לא רלוונטי. החידה הרבה יותר פשוטה מזה ולא מצריכה שום מתמטיקה מתוחכמת. סתם סיבכתי את עצמי עם שיקולים לא רלוונטים כי אלוהים אדירים כמה שהתרגלתי כבר לשלוף את טיעון האי רציונליות הזה מהשרוול בכל פעם מחדש.&lt;/p&gt;

&lt;p&gt;אז מה העניין? העניין הוא שלא חשוב בכלל אם אנחנו חוזרים לנקודת ההתחלה או לא, הדבר היחיד שחשוב הוא האם אנחנו חותכים את העוגה כל פעם במקום שטרם נחתך, או שיש רק מספר &lt;strong&gt;סופי&lt;/strong&gt; של חתכים שהולכים להיות בעוגה ולא משנה כמה פעמים נחזור על התהליך? התשובה היא שיהיה מספר סופי של חתכים, ואפילו די קטן. ואיך זה ייתכן, אם אנחנו עושים סיבובים מסביב לעוגה ולא חוזרים אף פעם לנקודה שממנו התחלנו? אה, פשוט מאוד: כי &lt;strong&gt;החתכים זזים&lt;/strong&gt; כשאנחנו הופכים את העוגה. זה לב העניין פה, ומה שקל לפספס כשמנסים לפתור את החידה בצורה נאיבית.&lt;/p&gt;

&lt;p&gt;אם יש לנו פלח עוגה שכבר יש בו חתך, ואנחנו מרימים את כולו והופכים אותו, החתך לא יישאר במקום שבו הוא היה קודם - הוא יעבור לצד השני, כאילו הפעלנו עליו שיקוף במראה שנמצאת בדיוק באמצע הפלח. הנה הדגמה של איך זה נראה, כשהזווית שבה אנו זזים בכל פעם היא 270 מעלות:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/cake_cutting_3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;הפלח הראשון שנוצר הוא של שלושת-רבעי עוגה, והחתכים שהם הגבולות שלו הם הרדיוס האופקי שמגיע מימין (זה החיתוך הראשון) והרדיוס האנכי שעולה למעלה. הפלח השני עדיין משתמש ברדיוס האנכי שעולה למעלה, אבל החתך הנוסף שלו הוא הרדיוס האופקי שמגיע משמאל (ומצוייר בקו מקווקוו באיור). אני מסמן בירוק את החתך שהוא הרדיוס האופקי שמגיע מימין. הוא נמצא &lt;strong&gt;בתוך&lt;/strong&gt; פלח העוגה השני שאנחנו הופכים, ואחרי ההיפוך הוא ישנה מקום ויהפוך להיות רדיוס אנכי שיורד למטה. התזוזה הזו של החתכים היא תשבטיח שמהר מאוד נחתוך רק בתוך חתכים שכבר חתכנו קודם.&lt;/p&gt;

&lt;p&gt;עכשיו בואו נדבר פחות באוויר ונראה את המתמטיקה הקונקרטית שמעורבת, ואיך אפשר למצוא אחרי כמה זמן הכל יחזור למעלה. בואו נתחזק קבוצה &lt;span&gt;\( A \)&lt;/span&gt; שכוללת את כל הזוויות שבהם יש חתכים בעוגה. בהתחלה הקבוצה הזו ריקה, &lt;span&gt;\( A=\emptyset \)&lt;/span&gt;. החתך הראשון קובע את נקודת הייחוס שעל פיה אנחנו מודדים את הזווית של שאר החתכים, אז אחריו &lt;span&gt;\( A=\left\{ 0\right\}  \)&lt;/span&gt;. החתך הבא יהיה בזווית של &lt;span&gt;\( \theta \)&lt;/span&gt; ביחס אליו, אז &lt;span&gt;\( A=\left\{ 0,\theta\right\}  \)&lt;/span&gt;, ועכשיו אנחנו מתקדמים כל פעם ב-&lt;span&gt;\( \theta \)&lt;/span&gt;, כך שהקבוצה שלנו היא לכאורה &lt;span&gt;\( A=\left\{ 0,\theta,2\theta,3\theta,\ldots\right\}  \)&lt;/span&gt;. אבל &lt;strong&gt;זה לא נמשך עד אינסוף ככה&lt;/strong&gt;. מרגע שבו נשלים את הסיבוב הראשון סביב העוגה הסיפור יתחיל להסתבך, אז אנחנו צריכים להבין מתי בדיוק זה קורה.&lt;/p&gt;

&lt;p&gt;בואו נסמן ב-&lt;span&gt;\( k \)&lt;/span&gt; את מספר החתך הראשון שבו אנחנו אחרי סיבוב שלם סביב העוגה. כלומר, &lt;span&gt;\( k\theta\ge2\pi \)&lt;/span&gt; אבל &lt;span&gt;\( \left(k-1\right)\theta&amp;lt;2\pi \)&lt;/span&gt;. יש במתמטית דרך פשוטה להגדיר את &lt;span&gt;\( k \)&lt;/span&gt;: &lt;span&gt;\( k=\left\lceil \frac{2\pi}{\theta}\right\rceil  \)&lt;/span&gt; (הסוגריים הללו מציינים &lt;strong&gt;ערך שלם עליון&lt;/strong&gt;: אנחנו מעגלים למספר השלם הקרוב ביותר שגדול מ-&lt;span&gt;\( \frac{2\pi}{\theta} \)&lt;/span&gt;). עכשיו, תהיה חשיבות גדולה לשאלה כמה החתך ה-&lt;span&gt;\( k \)&lt;/span&gt; חורג “מעבר” לסיבוב שלם - מה ההפרש בין נקודת החיתוך הזו ונקודת הייחוס שלנו שסימנתי ב-&lt;span&gt;\( 0 \)&lt;/span&gt;. אז אני אסמן את ההפרש הזה ב-&lt;span&gt;\( \delta \)&lt;/span&gt;: &lt;span&gt;\( \delta=k\theta-2\pi \)&lt;/span&gt;. זהו, אלו כל הסימונים שנזדקק להם. כל הפתרון עכשיו יהיה במונחים של &lt;span&gt;\( k,\delta \)&lt;/span&gt;. עכשיו, המקרה שבו &lt;span&gt;\( \delta=0 \)&lt;/span&gt; הוא פשוט &lt;strong&gt;מדי&lt;/strong&gt; - כבר ראינו אותו למעלה. תוך סיבוב אחד כל העוגה הפוכה ותוך סיבוב אחד נוסף היא חוזרת לעצמה. אז נעזוב את המקרה הזה ונניח ש-&lt;span&gt;\( \delta&amp;gt;0 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;רגע &lt;strong&gt;לפני&lt;/strong&gt; החיתוך הגורלי הזה, קבוצת החיתוכים שלנו היא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A=\left\{ 0,\theta,2\theta,\ldots,\left(k-1\right)\theta\right\}  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;רגע אחריו קורים שני דברים. ראשית, אני מוסיף חיתוך ב-&lt;span&gt;\( \delta \)&lt;/span&gt; (כלומר, החיתוך הוא ב-&lt;span&gt;\( \theta k \)&lt;/span&gt; אבל מכיוון שעברנו את קו הגבול של &lt;span&gt;\( 2\pi \)&lt;/span&gt; אנחנו עושים את כל החשבון מודולו &lt;span&gt;\( 2\pi \)&lt;/span&gt;). שנית, עכשיו החתך 0 “כלוא” בין החתך ב-&lt;span&gt;\( \left(k-1\right)\theta \)&lt;/span&gt; ו-&lt;span&gt;\( \delta \)&lt;/span&gt; ולכן כשהופכים את הפלח שבו הוא נמצא, הוא הולך &lt;strong&gt;להשתנות&lt;/strong&gt;. הוא כבר לא יהיה 0. הוא יהיה… אה… אוקיי, זה חישוב מעצבן, מה? יודעים מה, בואו נשנה טיפה את דרך ההצגה של הסיפור כדי שיהיה לי קל יותר לבצע את החישוב הזה.&lt;/p&gt;

&lt;p&gt;בואו נדמיין לרגע סיטואציה פשוטה יותר: יש לי פלח ששתי נקודות הקצה שלו הן 0 ו-&lt;span&gt;\( \theta \)&lt;/span&gt; ובתוכו כלוא חתך אחר שנמצא ב-&lt;span&gt;\( x \)&lt;/span&gt;. לאן הוא עובר כשהופכים את הפלח? קודם המרחק שלו מהחתך 0 היה &lt;span&gt;\( x \)&lt;/span&gt;; אחרי ההיפוך, החתך 0 נמצא במקום &lt;span&gt;\( \theta \)&lt;/span&gt;; היפוך שומר על מרחקים, אז החתך הכלוא עדיין במרחק &lt;span&gt;\( x \)&lt;/span&gt; מהחתך 0-לשעבר, כלומר הוא חייב להיות ב-&lt;span&gt;\( \theta-x \)&lt;/span&gt; (כי &lt;span&gt;\( \theta+x \)&lt;/span&gt; בכלל לא במסגרת הפלח הזה). זה היה חישוב פשוט! אבל לחשב לאן עובר מי שכלוא בין &lt;span&gt;\( \left(k-1\right)\theta \)&lt;/span&gt; ו-&lt;span&gt;\( \delta \)&lt;/span&gt; זה כאב ראש כשזוכרים שצריך לעבוד מודולו, ושכל הזמן הקואורדינטות של הפלח הנוכחי ישתנו. אז במקום זה בואו נחשוב על הסיטואציה ככה: אני תמיד חותך את החתך הנוכחי שלי ב-0; ואחרי כל חתך והיפוך פלח אני &lt;strong&gt;מסובב את העוגה&lt;/strong&gt; ב-&lt;span&gt;\( \theta \)&lt;/span&gt;, בצורה כזו שמוסיפה &lt;span&gt;\( \theta \)&lt;/span&gt; לכל זווית.&lt;/p&gt;

&lt;p&gt;בגישה הזו, האלגוריתם שלוקח את &lt;span&gt;\( A \)&lt;/span&gt; ומרחיב אותה על ידי הוספת החתך החדש, תוך תיקון חתכים ש”מתהפכים” עובד כך:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;נאתחל &lt;span&gt;\( A=\emptyset \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;נחזור שוב ושוב על הפעולה הבאה:&lt;/li&gt;
&lt;ol&gt;


&lt;li&gt;נאתחל &lt;span&gt;\( A^{\prime}=\left\{ 0\right\}  \)&lt;/span&gt; (אלו יהיו החתכים החדשים, אחרי הצעד שאנחנו עושים, ובפרט יהיה ב-&lt;span&gt;\( A^{\prime} \)&lt;/span&gt; את החתך שעשינו ב-0)&lt;/li&gt;


&lt;li&gt;לכל &lt;span&gt;\( x\in A \)&lt;/span&gt; נעשה:&lt;/li&gt;
&lt;ol&gt;


&lt;li&gt;אם &lt;span&gt;\( 0&amp;lt;x&amp;lt;\theta \)&lt;/span&gt; אז &lt;span&gt;\( x\leftarrow\theta-x \)&lt;/span&gt; (כלומר, אני מציב את הערך החדש בתוך &lt;span&gt;\( x \)&lt;/span&gt;; זה ההיפוך של חתך &quot;כלוא&quot;).&lt;/li&gt;


&lt;li&gt;נוסיף את &lt;span&gt;\( \left(x+\theta\right)\text{ mod }2\pi \)&lt;/span&gt; אל &lt;span&gt;\( A^{\prime} \)&lt;/span&gt; (זה הסיבוב שמבצעים אחרי החיתוך וההיפוך).&lt;/li&gt;
&lt;/ol&gt;

&lt;li&gt;אם &lt;span&gt;\( A^{\prime}=A \)&lt;/span&gt;, נעצור. אחרת &lt;span&gt;\( A\leftarrow A^{\prime} \)&lt;/span&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;/ol&gt;

&lt;p&gt;עם איזה &lt;span&gt;\( A \)&lt;/span&gt; נסיים בסופו של דבר? מכיוון שכל הזמן אנחנו מוסיפים את 0, יהיה ב-&lt;span&gt;\( A \)&lt;/span&gt; כל הזמן את 0, ואת כל ההזזות של &lt;span&gt;\( 0 \)&lt;/span&gt; עד שעוברים את &lt;span&gt;\( 2\pi \)&lt;/span&gt;, כלומר &lt;span&gt;\( \left\{ 0,\theta,2\theta,\ldots,\left(k-1\right)\theta\right\}  \)&lt;/span&gt; שראינו קודם. בנוסף לכך, כשניקח את &lt;span&gt;\( \left(k-1\right)\theta \)&lt;/span&gt; ונוסיף לו &lt;span&gt;\( \theta \)&lt;/span&gt; נקבל &lt;span&gt;\( \delta \)&lt;/span&gt;. עכשיו, שימו לב! ה-&lt;span&gt;\( \delta \)&lt;/span&gt; הזה כלוא בדיוק בפלח שהולכים להפוך כי &lt;span&gt;\( 0&amp;lt;\delta&amp;lt;\theta \)&lt;/span&gt;. לכן ההיפוך הולך להפוך אותו ל-&lt;span&gt;\( \theta-\delta \)&lt;/span&gt; ומייד אחר כך הסיבוב יביא אותו אל &lt;span&gt;\( 2\theta-\delta \)&lt;/span&gt;. עכשיו הוא כבר חמק מהפלח שהופכים, ולכן לא יתהפך שוב אלא ימשיך להסתובב עוד ועוד. נקבל את &lt;span&gt;\( 3\theta-\delta \)&lt;/span&gt; ואת &lt;span&gt;\( 4\theta-\delta \)&lt;/span&gt; וכן הלאה וכן הלאה עד שנגיע שוב להשלמה של סיבוב, וזה יהיה ב-&lt;span&gt;\( \left(k-1\right)\theta-\delta \)&lt;/span&gt;. מייד אחר כך נגיע אל &lt;span&gt;\( k\theta-\delta=2\pi \)&lt;/span&gt;, כלומר חזרה אל 0. בינגו! איכשהו &lt;strong&gt;כן&lt;/strong&gt; חזרנו אל נקודת המוצא שלנו, אפילו אם &lt;span&gt;\( \theta \)&lt;/span&gt; הוא אי רציונלי, אחרי בדיוק שתי הקפות סביב המעגל. איך זה קרה? אז כאמור, זה לא באמת קרה כי שיניתי את נקודת המבט שלי - עכשיו אני בכל פעם מסובב את העוגה כך שהחתך שאני עושה הוא ב-0. זה אומר שאולי אני חותך כל פעם בזווית שונה, אבל בגלל האופן שבו החתכים זזים החיתוכים שלי הם רק בתוך חתכים קיימים.&lt;/p&gt;

&lt;p&gt;אז בגישה הנוכחית שלנו לזוויות, קבוצת כל החתכים הולכת להיות&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A=\left\{ 0,\theta,2\theta,\ldots,\left(k-1\right)\theta,\delta,2\theta-\delta,\ldots,\left(k-1\right)\theta-\delta\right\}  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בקבוצה הזו יש בסך הכל &lt;span&gt;\( 2k-1 \)&lt;/span&gt; חתכים, והם מגדירים &lt;span&gt;\( 2k-1 \)&lt;/span&gt; פלחים שאפשר לכתוב במפורש:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[0,\delta\right],\left[\delta,\theta\right],\left[\theta,2\theta-\delta\right],\left[2\theta-\delta,2\theta\right],\ldots,\left[\left(k-2\right)\theta,\left(k-1\right)\theta-\delta\right],\left[\left(k-1\right)\theta-\delta,\left(k-1\right)\theta\right],\left[\left(k-1\right)\theta,0\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;יש כאן שני סוגים של פלחים: כאלו שהאורך שלהם הוא &lt;span&gt;\( \delta \)&lt;/span&gt;, וכאלו שהאורך שלהם הוא &lt;span&gt;\( \theta-\delta \)&lt;/span&gt;. הפלחים מהסוג הראשון הם&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[0,\delta\right],\left[\theta,2\theta-\delta\right],\left[2\theta,3\theta-\delta\right],\ldots,\left[\left(k-1\right)\theta,0\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכאן יש &lt;span&gt;\( k \)&lt;/span&gt; פלחים סך הכל, והפלחים מהסוג השני הם&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[\delta,\theta\right],\left[2\theta-\delta,2\theta\right],\ldots,\left[\left(k-1\right)\theta-\delta,\left(k-1\right)\theta\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכאן יש &lt;span&gt;\( k-1 \)&lt;/span&gt; פלחים.&lt;/p&gt;

&lt;p&gt;על מצב העוגה בכל רגע נתון אפשר לחשוב בתור סימון, לכל פלח, האם הוא הפוך באותו רגע או לא (“וקטור בינארי מאורך &lt;span&gt;\( 2k-1 \)&lt;/span&gt;). עכשיו מגיע הפאנץ’: בכל פעם שבה אנחנו מבצעים חתך והופכים את העוגה, אנחנו הופכים פלח בגודל &lt;span&gt;\( \theta \)&lt;/span&gt; שמורכב משני תת-פלחים, אחד מגודל &lt;span&gt;\( \delta \)&lt;/span&gt; והשני מגודל &lt;span&gt;\( \theta-\delta \)&lt;/span&gt;. אחרי שביצענו &lt;span&gt;\( k \)&lt;/span&gt; צעדים הפכנו את כל ה-&lt;span&gt;\( \delta \)&lt;/span&gt;-פלחים, ואחרי שנבצע עוד &lt;span&gt;\( k \)&lt;/span&gt; צעדים נהפוך את כולם בחזרה וכן הלאה; אבל עבור ה-&lt;span&gt;\( \theta-\delta \)&lt;/span&gt;-פלחים, זה יקרה כל &lt;span&gt;\( k-1 \)&lt;/span&gt; צעדים, לא כל &lt;span&gt;\( k \)&lt;/span&gt; צעדים. כלומר, כדי שכל הפלחים בעוגה יתהפכו בחזרה, אנחנו צריכים שמספר הצעדים הכולל שלנו &lt;span&gt;\( T \)&lt;/span&gt; יהיה &lt;strong&gt;כפולה זוגית&lt;/strong&gt; גם של &lt;span&gt;\( k \)&lt;/span&gt; וגם של &lt;span&gt;\( k-1 \)&lt;/span&gt;. כפולה, כדי שהוא יעבור על כל הפלחים מאותו סוג אותו מספר פעמים; זוגית כי אחרי שעוברים מספר זוגי של פעמים על פלח מחזירים אותו למצב המקורי שלו.&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( k,k-1 \)&lt;/span&gt; הם מספרים &lt;strong&gt;זרים&lt;/strong&gt; - אין להם מחלק משותף גדול מ-1. זה אומר שהמספר הקטן ביותר שמתחלק על ידי שניהם (מה שנקרא ה-lcm שלהם) הוא המכפלה שלהם, &lt;span&gt;\( k\left(k-1\right) \)&lt;/span&gt;. המכפלה הזו היא מספר זוגי, אבל היא לא &lt;strong&gt;כפולה זוגית&lt;/strong&gt; שלהם, כלומר זה לא מספר שמתקבל על ידי כך שמכפילים אותם במספר &lt;strong&gt;זוגי&lt;/strong&gt;. למשל, אם &lt;span&gt;\( k \)&lt;/span&gt; אי זוגי אז &lt;span&gt;\( k\left(k-1\right) \)&lt;/span&gt; מתקבל מ-&lt;span&gt;\( k-1 \)&lt;/span&gt; על ידי כפל שלו ב-&lt;span&gt;\( k \)&lt;/span&gt; שאיננו מספר זוגי. אז אם נבצע &lt;span&gt;\( k\left(k-1\right) \)&lt;/span&gt; צעדים, נראה שכל הפלחים בעוגה מסוג אחד הם למעלה, וכל הפלחים מהסוג השני הם למטה. הכפולה &lt;strong&gt;הזוגית&lt;/strong&gt; הקטנה ביותר היא &lt;span&gt;\( 2k\left(k-1\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אם נחזור למספר הקונקרטי שהתחלתי איתו, &lt;span&gt;\( \theta=e^{-10} \)&lt;/span&gt;, החישוב עכשיו הוא מאוד פשוט: מחשבים את &lt;span&gt;\( k=\left\lceil \frac{2\pi}{\theta}\right\rceil  \)&lt;/span&gt; ואז את &lt;span&gt;\( 2k\left(k-1\right) \)&lt;/span&gt;. מקבלים &lt;span&gt;\( k=138397 \)&lt;/span&gt; ו-&lt;span&gt;\( 2k\left(k-1\right)=38307182424 \)&lt;/span&gt;. אלו לא מספרים שיש להם משמעות מעניינת, אבל אם פתרתן את החידה קודם וקיבלתן תוצאה מספרית, אפשר להשוות אותה למה שאני קיבלתי.&lt;/p&gt;

&lt;p&gt;אוקיי, זה טיפל בשאלה מתי כל הציפוי חוזר &lt;strong&gt;למעלה&lt;/strong&gt;. מה עם הגעה של כל הציפוי &lt;strong&gt;למטה&lt;/strong&gt;? גם פה האינטואיציה הולמת בי - האינטואיציה הראשונית היא שזה צריך להיות בדיוק באמצע הדרך, כלומר לקחת את התוצאה שקיבלתי ולחלק ב-2. האינטואיציה הזו &lt;strong&gt;נכונה&lt;/strong&gt; בדוגמא שראינו למעלה עם &lt;span&gt;\( \theta=\frac{\pi}{2} \)&lt;/span&gt;, אבל כמו שאמרתי, הדוגמא הזו הייתה פשוטה &lt;strong&gt;מדי&lt;/strong&gt;; בחרתי בכוונה מקרה שבו &lt;span&gt;\( \delta=0 \)&lt;/span&gt;. כאשר &lt;span&gt;\( \delta&amp;gt;0 \)&lt;/span&gt; כבר ראינו שאמצע הדרך, &lt;span&gt;\( k\left(k-1\right) \)&lt;/span&gt;, לא הולך לעבוד כי חצי מהעוגה יהיה הפוך וחצי לא. אז מה כן יעבוד? אנחנו צריכים מספר שהוא כפולה &lt;strong&gt;אי זוגית&lt;/strong&gt; של &lt;span&gt;\( k,\left(k-1\right) \)&lt;/span&gt;, אבל זה פשוט &lt;strong&gt;בלתי אפשרי&lt;/strong&gt;. כל כפולה של &lt;span&gt;\( k,\left(k-1\right) \)&lt;/span&gt; תתחלק על ידי הכפולה המשותפת הקטנה ביותר &lt;span&gt;\( k\left(k-1\right) \)&lt;/span&gt; והיא תמיד מספר זוגי; מצד שני, אחד מבין &lt;span&gt;\( k,\left(k-1\right) \)&lt;/span&gt; הוא אי זוגי ולכן כשנכפול אותו במספר אי זוגי נקבל מספר אי זוגי. אז פשוט &lt;strong&gt;לא קיימת&lt;/strong&gt; כפולה אי זוגית משותפת של &lt;span&gt;\( k,\left(k-1\right) \)&lt;/span&gt; והציפוי אף פעם לא יהיה כולו למטה.&lt;/p&gt;

&lt;p&gt;מרהיב בעיני איך התחלתי עם מחשבה על שיקולי אי רציונליות וסיימתי עם שיקולי זוגיות מהסוג הפשוט ביותר. ככה חידות מתמטיות מוצלחות עובדות.&lt;/p&gt;</content><author><name></name></author><category term="חידה מתמטית" /><summary type="html">בפוסט הזה אני רוצה לדבר על חידה שנראית תמימה למדי ממבט ראשוןת אבל למעשה היא ערמומית מאוד ובצורה הטובה ביותר - כנראה יש לה יותר סיכוי להפיל בפח דווקא את פותרי החידות המשופשפים יותר, שכבר פיתחו אינטואיציה לא רעה שיש סיכוי טוב שתבגוד בהם בצורה אכזרית עם החידה הזו (או לפחות, זה מה שקרה לי).</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">פירוק SVD והפירוק הפולארי של מטריצות</title><link href="http://gadial.net/2025/10/01/singular_value_and_polar_decompositions/" rel="alternate" type="text/html" title="פירוק SVD והפירוק הפולארי של מטריצות" /><published>2025-10-01T00:00:00+00:00</published><updated>2025-10-01T00:00:00+00:00</updated><id>http://gadial.net/2025/10/01/singular_value_and_polar_decompositions</id><content type="html" xml:base="http://gadial.net/2025/10/01/singular_value_and_polar_decompositions/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;בפוסט הזה אני רוצה לדבר על פירוק SVD, שהוא תוצאה מרהיבה באלגברה לינארית שבמובן מאוד מסויים מכלילה תוצאה מרהיבה אחרת של האלגברה הלינארית שעליה כתבתי &lt;a href=&quot;https://gadial.net/2025/09/06/unitary_diagonalization/&quot;&gt;ממש לא מזמן&lt;/a&gt;: לכסון אוניטרי. אמרנו שמטריצה &lt;span&gt;\( A \)&lt;/span&gt; ניתנת ללכסון אוניטרי אם אפשר לכתוב &lt;span&gt;\( A=UDU^{*} \)&lt;/span&gt; כאשר &lt;span&gt;\( U \)&lt;/span&gt; היא &lt;strong&gt;מטריצה אוניטרית&lt;/strong&gt; ואילו &lt;span&gt;\( D \)&lt;/span&gt; היא &lt;strong&gt;מטריצה אלכסונית&lt;/strong&gt;. המשפט שהוכחנו אמר ש:&lt;/p&gt;

&lt;ul&gt; 
&lt;li&gt;מעל &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt;, &lt;span&gt;\( A \)&lt;/span&gt; היא לכסינה אוניטרית אם ורק אם &lt;span&gt;\( A=A^{*} \)&lt;/span&gt; (&quot;A צמודה לעצמה&quot;).&lt;/li&gt;


&lt;li&gt;מעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt;, &lt;span&gt;\( A \)&lt;/span&gt; היא לכסינה אוניטרית אם ורק אם &lt;span&gt;\( A^{*}A=AA^{*} \)&lt;/span&gt; (&quot;A נורמלית&quot;).&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;אפשר לחשוב על לכסון אוניטרי גם בצורה שונה: מטריצה אוניטרית &lt;span&gt;\( U \)&lt;/span&gt; מסדר &lt;span&gt;\( n\times n \)&lt;/span&gt; מעל &lt;span&gt;\( \mathbb{F} \)&lt;/span&gt; היא בעצם אוסף &lt;span&gt;\( \left\{ u_{1},\ldots,u_{n}\right\}  \)&lt;/span&gt; של &lt;strong&gt;וקטורים&lt;/strong&gt; ב-&lt;span&gt;\( \mathbb{F}^{n} \)&lt;/span&gt;: כל &lt;strong&gt;עמודה&lt;/strong&gt; שלה היא וקטור שכזה. דרישת האוניטריות שקולה לכך שהוקטורים הללו יהיו &lt;strong&gt;בסיס אורתונורמלי&lt;/strong&gt;, כלומר וקטורים בלתי תלויים המקיימים &lt;span&gt;\( \left\langle u_{i},u_{j}\right\rangle =\delta_{ij} \)&lt;/span&gt; כאשר המכפלה הפנימית היא המכפלה הסטנדרטית מעל &lt;span&gt;\( \mathbb{F} \)&lt;/span&gt;. כדי לראות שזה עובד פשוט נסתכל על השוויון &lt;span&gt;\( U^{*}U=I \)&lt;/span&gt; שמגדיר אוניטריות: באופן כללי, כאשר כופלים שתי מטריצות &lt;span&gt;\( A,B \)&lt;/span&gt; אז הכניסה ה-&lt;span&gt;\( ij \)&lt;/span&gt; במכפלה שווה ל&lt;strong&gt;שורה&lt;/strong&gt; ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( A \)&lt;/span&gt; שמוכפלת סקלרית ב&lt;strong&gt;עמודה&lt;/strong&gt; ה-&lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( B \)&lt;/span&gt;; במכפלה &lt;span&gt;\( U^{*}U \)&lt;/span&gt;, השורה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( U^{*} \)&lt;/span&gt; היא בעצם העמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( U \)&lt;/span&gt;, אחרי שביצענו לאבריה הצמדה. המכפלה הפנימית הסטנדרטית מעל &lt;span&gt;\( \mathbb{F} \)&lt;/span&gt; היא בדיוק “בצעו הצמדה לאחד הוקטורים ואז כפלו אותם סקלרית”, מה שנותן לנו את המעבר החלק מלשון מטריצות ללשון וקטורים. בנוסף, העמודות של &lt;span&gt;\( U \)&lt;/span&gt; הן בלתי תלויות לינארית כי &lt;span&gt;\( U \)&lt;/span&gt; היא מטריצה הפיכה - כל זה חומר סטנדרטי של אלגברה לינארית שאני לא אוכיח שוב.&lt;/p&gt;

&lt;p&gt;את השוויון &lt;span&gt;\( A=UDU^{*} \)&lt;/span&gt; אפשר להבין גם כן בלשון וקטורית. בואו נסמן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( D=\left(\begin{array}{cccc} \lambda_{1}\\  &amp;amp; \lambda_{2}\\  &amp;amp;  &amp;amp; \ddots\\  &amp;amp;  &amp;amp;  &amp;amp; \lambda_{n} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר &lt;span&gt;\( D \)&lt;/span&gt; היא מטריצה אלכסונית עם הערכים &lt;span&gt;\( \lambda_{1},\ldots,\lambda_{n} \)&lt;/span&gt;. עכשיו, ניקח את &lt;span&gt;\( A=UDU^{*} \)&lt;/span&gt;, נכפול מימין ב-&lt;span&gt;\( U \)&lt;/span&gt; ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( AU=UD \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה קורה פה? אמרתי שהכניסה ה-&lt;span&gt;\( ij \)&lt;/span&gt; של &lt;span&gt;\( AU \)&lt;/span&gt; היא מכפלת השורה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( A \)&lt;/span&gt; בעמודה ה-&lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( U \)&lt;/span&gt;; אם נסתכל על כל &lt;strong&gt;העמודה&lt;/strong&gt; ה-&lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( AU \)&lt;/span&gt; (כלומר, על הכניסות &lt;span&gt;\( 1j,2j,\ldots,nj \)&lt;/span&gt;) אז יוצא שהעמודה הזו שווה למכפלה של &lt;span&gt;\( A \)&lt;/span&gt; בוקטור העמודה ה-&lt;span&gt;\( j \)&lt;/span&gt;-י של &lt;span&gt;\( U \)&lt;/span&gt;. סימנו את הוקטור הזה כזכור ב-&lt;span&gt;\( u_{j} \)&lt;/span&gt; אז אפשר לסכם שהעמודה ה-&lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( AU \)&lt;/span&gt; היא פשוט &lt;span&gt;\( Au_{j} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, מה זו &lt;span&gt;\( UD \)&lt;/span&gt;? הכניסה ה-&lt;span&gt;\( ij \)&lt;/span&gt; של &lt;span&gt;\( UD \)&lt;/span&gt; שווה למכפלת השורה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( U \)&lt;/span&gt; בעמודה ה-&lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( D \)&lt;/span&gt;. בעמודה ה-&lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( D \)&lt;/span&gt; יש רק איבר אחד שאולי שונה מאפס: &lt;span&gt;\( \lambda_{j} \)&lt;/span&gt;, שנמצא בשורה ה-&lt;span&gt;\( j \)&lt;/span&gt; של העמודה. אז מכל השורה ה-&lt;span&gt;\( i \)&lt;/span&gt;-ית של &lt;span&gt;\( U \)&lt;/span&gt;, הולך להישאר רק האיבר במקום &lt;span&gt;\( ij \)&lt;/span&gt;, והוא יוכפל ב-&lt;span&gt;\( \lambda_{j} \)&lt;/span&gt;. במילים אחרות: העמודות של &lt;span&gt;\( UD \)&lt;/span&gt; הן בדיוק העמודות של &lt;span&gt;\( U \)&lt;/span&gt;, רק שבנוסף העמודה ה-&lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( U \)&lt;/span&gt; מוכפלת ב-&lt;span&gt;\( \lambda_{j} \)&lt;/span&gt;, כלומר היא שווה ל-&lt;span&gt;\( \lambda_{j}u_{j} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;השוויון &lt;span&gt;\( AU=UD \)&lt;/span&gt; אומר לנו, אם כן, ש-&lt;span&gt;\( Au_{j}=\lambda_{j}u_{j} \)&lt;/span&gt;, כלומר ש-&lt;span&gt;\( u_{j} \)&lt;/span&gt; הוא &lt;strong&gt;וקטור עצמי&lt;/strong&gt; של &lt;span&gt;\( A \)&lt;/span&gt; עם ערך עצמי &lt;span&gt;\( \lambda_{j} \)&lt;/span&gt;. זה מוביל לניסוח שקול של מה זה לכסון אוניטרי: שיהיה לנו בסיס &lt;strong&gt;אורתונורמלי&lt;/strong&gt; למרחב שמורכב כולו מוקטורים עצמיים של &lt;span&gt;\( A \)&lt;/span&gt;. לבסוף, אם לוקחים טרנספורמציה לינארית כללית &lt;span&gt;\( T:V\to V \)&lt;/span&gt; עבור מרחב סוף-ממדי &lt;span&gt;\( V \)&lt;/span&gt; מעל &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt; או &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; אז אפשר לקחת בסיס אורתונורמלי למרחב הזה (תהליך גרם-שמידט מבטיח שקיים כזה), ולהשתמש בבסיס הזה כדי לעבור לדבר על &lt;span&gt;\( \mathbb{F}^{n} \)&lt;/span&gt; ולקבל את כל המושגים שדיברנו עליהם כאן גם בהקשר של טרנספורמציות כלליות. מכיוון שאני מניח שהטריק הזה מוכר, בפוסט הזה אני לא ממש אדבר עליו - לכאורה נדבר רק על המקרה הקונקרטי של &lt;span&gt;\( \mathbb{F}^{n} \)&lt;/span&gt; ושל מטריצות, אבל ברקע הדברים צריך לזכור שזה פשוט התכל’ס הטכני של תוצאה שתקפה לכל מרחב מכפלה פנימית סוף-ממדי.&lt;/p&gt;

&lt;p&gt;עכשיו אפשר לעבור לדבר סוף סוף על מה פירוק SVD אומר. עד כה נראה שסתם ניסחתי מחדש בצורה מסורבלת דברים שכל מי שקורא פוסט כזה כבר אמור להכיר, אבל לא ניסחתי את זה ככה סתם: נצטרך את הכל כדי להבין את האופן הספציפי שבו SVD מכליל את מה שראינו.&lt;/p&gt;

&lt;h2&gt;מה זה פירוק SVD?&lt;/h2&gt;

&lt;p&gt;לכסון אוניטרי זה משהו שקיים לחלק מהמטריצות הריבועיות. לעומתו, פירוק SVD (ראשי תיבות של Singular Value Decomposition, “פירוק ערכים סינגולריים” ואוטוטו נראה מהם הערכים הללו) זה משהו שקיים &lt;strong&gt;לכל&lt;/strong&gt; מטריצה &lt;span&gt;\( A\in M_{n,m}\left(\mathbb{F}\right) \)&lt;/span&gt; מעל &lt;span&gt;\( \mathbb{F} \)&lt;/span&gt; שהוא הממשיים או המרוכבים (בדרך כלל לא אטרח לכתוב אותו), גם אם &lt;span&gt;\( A \)&lt;/span&gt; היא בכלל לא ריבועית. זה הפירוק הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A=U\Sigma V^{*} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( U\in M_{n,n} \)&lt;/span&gt; ו-&lt;span&gt;\( V\in M_{m,m} \)&lt;/span&gt; הן מטריצות אוניטריות ואילו &lt;span&gt;\( \Sigma\in M_{n,m} \)&lt;/span&gt; (כלומר, מטריצה לא בהכרח ריבועית, מאותו סדר כמו &lt;span&gt;\( A \)&lt;/span&gt;) היא “אלכסונית” במובן זה שהערכים היחידים שלה שעשויים להיות שונים מאפס הם הערכים מהצורה &lt;span&gt;\( \Sigma_{ii} \)&lt;/span&gt; (עבור &lt;span&gt;\( 1\le i\le\min\left\{ n,m\right\}  \)&lt;/span&gt;). יותר מזה: אם נסמן את הערכים על האלכסון הזה ב-&lt;span&gt;\( \sigma_{1},\sigma_{2},\ldots,\sigma_{k} \)&lt;/span&gt; אז &lt;strong&gt;כולם&lt;/strong&gt; מספרים ממשיים, ומתקיים &lt;span&gt;\( \sigma_{1}\ge\sigma_{2}\ge\ldots\ge\sigma_{k}\ge0 \)&lt;/span&gt;. כלומר, בניגוד ללכסון אוניטרי שבו היה “חופש בחירה” עבור &lt;span&gt;\( D \)&lt;/span&gt; איך הערכים העצמיים יהיו מסודרים בה, כאן יש הצגה קנונית יחידה של המטריצה &lt;span&gt;\( \Sigma \)&lt;/span&gt; (אבל לא של &lt;span&gt;\( U,V \)&lt;/span&gt;). ויותר מכך: ערכי ה-&lt;span&gt;\( \sigma \)&lt;/span&gt; ששונים מאפס הם בדיוק הערכים &lt;span&gt;\( \sigma_{1},\ldots,\sigma_{r} \)&lt;/span&gt;, כאשר &lt;span&gt;\( r \)&lt;/span&gt; היא &lt;strong&gt;הדרגה&lt;/strong&gt; של המטריצה &lt;span&gt;\( A \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;הערכים &lt;span&gt;\( \sigma_{1},\sigma_{2},\ldots,\sigma_{k} \)&lt;/span&gt; הללו נקראים &lt;strong&gt;הערכים הסינגולריים&lt;/strong&gt; של &lt;span&gt;\( A \)&lt;/span&gt;. קל להגיד מה הם: אם נסתכל על &lt;span&gt;\( AA^{*} \)&lt;/span&gt; נקבל את מה שקראתי לו &lt;a href=&quot;https://gadial.net/2025/09/21/positive_semidefinite_matrices/&quot;&gt;בפוסט הקודם&lt;/a&gt; &lt;strong&gt;מטריצה חיובית&lt;/strong&gt; (Positive Definite) והערכים העצמיים של המטריצות הללו הם ממשיים אי-שליליים ולכן אפשר להוציא להם שורש ריבועי ולקבל ממשיים אי-שליליים; הערכים הסינגולריים הם בדיוק השורשים הללו.&lt;/p&gt;

&lt;p&gt;בואו ננסה להבין את SVD ברמת הוקטורים. אני אסמן את העמודות של &lt;span&gt;\( U \)&lt;/span&gt; ב-&lt;span&gt;\( \left\{ u_{1},\ldots,u_{n}\right\}  \)&lt;/span&gt;ושל &lt;span&gt;\( V \)&lt;/span&gt; ב-&lt;span&gt;\( \left\{ v_{1},\ldots,v_{m}\right\}  \)&lt;/span&gt;, אז מכיוון שאלו מטריצות אוניטריות, שני אלו הם בסיסים אורתונורמליים (למרחבים שהם אולי שונים; הראשון ל-&lt;span&gt;\( \mathbb{F}^{n} \)&lt;/span&gt; והשני ל-&lt;span&gt;\( \mathbb{F}^{m} \)&lt;/span&gt;). עכשיו, נכפול את &lt;span&gt;\( A=U\Sigma V^{*} \)&lt;/span&gt; ב-&lt;span&gt;\( V \)&lt;/span&gt; מימין ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( AV=U\Sigma \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכמו שהסברתי במבוא, זה אומר שמתקיים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Av_{j}=\sigma_{j}u_{j} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה מאוד מזכיר וקטורים עצמיים, חוץ מהקטע של ה”עצמי”. מכפלה ב-&lt;span&gt;\( A \)&lt;/span&gt; מעבירה את &lt;span&gt;\( v_{j} \)&lt;/span&gt; אל מכפלה של &lt;span&gt;\( u_{j} \)&lt;/span&gt; ב-&lt;span&gt;\( \sigma_{j} \)&lt;/span&gt;, כלומר אנחנו עוברים מהקבוצה &lt;span&gt;\( \left\{ v_{1},\ldots,v_{m}\right\}  \)&lt;/span&gt; אל &lt;span&gt;\( \left\{ u_{1},\ldots,u_{n}\right\}  \)&lt;/span&gt;. זה ה”מחיר” שאנחנו משלמים: מצד אחד הפירוק קיים לכל מטריצה, מצד שני אין לנו בסיס אחד לאותו מרחב ש-&lt;span&gt;\( A \)&lt;/span&gt; מעבירה אותו לעצמו; יש לנו שני בסיסים למרחבים שונים ש-&lt;span&gt;\( A \)&lt;/span&gt; מעבירה אותנו מאחד מהם לשני, אבל עדיין בצורה פשוטה יחסית: היא לא מעבירה איבר בסיס ל&lt;strong&gt;צירוף לינארי&lt;/strong&gt; של שני וקטורים או יותר, אלא רק למכפלה בסקלר של וקטור אחד.&lt;/p&gt;

&lt;h2&gt;מקבלים פירוק שהוא כמעט, אבל לא בדיוק, שונה לגמרי מ-SVD&lt;/h2&gt;

&lt;p&gt;ההוכחה שפירוק SVD תמיד קיים היא לא מסובכת במיוחד, אבל אני הולך בכוונה לסבך אותה טיפה כי אם מתחילים ממשפט יותר כללי, אפשר לקבל ממנו גם את פירוק SVD אבל גם את הפירוק הפולארי של מטריצות שהזכרתי בפוסט הקודם: שכל מטריצה &lt;span&gt;\( A \)&lt;/span&gt; ניתן לכתוב בתור &lt;span&gt;\( A=PU \)&lt;/span&gt; כך ש-&lt;span&gt;\( P \)&lt;/span&gt; היא מטריצה חיובית ו-&lt;span&gt;\( U \)&lt;/span&gt; היא מטריצה אוניטרית. למעשה, גם כאן זה עובד אפילו למטריצות לא ריבועיות: אם &lt;span&gt;\( A\in M_{n,m} \)&lt;/span&gt; כך ש-&lt;span&gt;\( n\le m \)&lt;/span&gt; (מספר השורות לא גדול ממספר העמודות) אז קיימת &lt;span&gt;\( P\in M_{n,n} \)&lt;/span&gt; חיובית מאותה דרגה כמו &lt;span&gt;\( A \)&lt;/span&gt;, ו-&lt;span&gt;\( U\in M_{n,m} \)&lt;/span&gt; כך ש-&lt;span&gt;\( A=PU \)&lt;/span&gt;, ו-&lt;span&gt;\( U \)&lt;/span&gt; היא “אוניטרית” במובן הבא: &lt;span&gt;\( UU^{*}=I_{n\times n} \)&lt;/span&gt;. כלומר, &lt;strong&gt;השורות&lt;/strong&gt; של &lt;span&gt;\( U \)&lt;/span&gt; הן אורתונורמליות.&lt;/p&gt;

&lt;p&gt;נראה קשור אל SVD? לא? לי זה בכלל לא נראה קשור ממבט ראשון אבל תוך שניה הכל יתבהר, ולמעשה כבר הזכרתי את טיעון המפתח המרכזי: זה לא משנה איזו מטריצה היא &lt;span&gt;\( A \)&lt;/span&gt; - הפיכה, לא הפיכה, ריבועית, לא ריבועית - אני &lt;strong&gt;תמיד&lt;/strong&gt; מקבל ש-&lt;span&gt;\( AA^{*} \)&lt;/span&gt; היא מטריצה חיובית, ולכן אפשר לקחת את הערכים העצמיים שלה ולהוציא להם שורש ולקבל את הערכים הסינגולריים. זה האופן שבו מטריצות חיוביות נדחפות לתוך ההוכחה, ואם יש לנו מטריצות חיוביות ומטריצות כמו-אוניטריות, כבר יש לנו את הפירוק הפולארי.&lt;/p&gt;

&lt;p&gt;אוקיי, אז מה עושים? עכשיו נעבוד מסודר ומדוקדק. התחלנו עם &lt;span&gt;\( A\in M_{n,m} \)&lt;/span&gt; שמקיימת &lt;span&gt;\( n\le m \)&lt;/span&gt;. ביצענו את הכפל &lt;span&gt;\( AA^{*} \)&lt;/span&gt; וקיבלנו מטריצה &lt;span&gt;\( n\times n \)&lt;/span&gt; שהיא חיובית, ולכן עם ערכים עצמיים &lt;span&gt;\( \lambda_{1}\ge\lambda_{2}\ge\ldots\ge\lambda_{n}\ge0 \)&lt;/span&gt;. הערכים העצמיים לאו דווקא שונים זה מזה, אבל שימו לב שכל &lt;span&gt;\( n \)&lt;/span&gt; הערכים העצמיים &lt;strong&gt;קיימים&lt;/strong&gt;, וזה כי &lt;span&gt;\( AA^{*} \)&lt;/span&gt; היא בפרט מטריצה צמודה לעצמה ולכן לכסינה. מכיוון שכל ערך עצמי הוא ממשי אי שלילי אני יכול להגדיר &lt;span&gt;\( \sigma_{i}=\sqrt{\lambda_{i}} \)&lt;/span&gt; ולקבל סדרה חדשה של מספרים ממשיים אי שליליים &lt;span&gt;\( \sigma_{1}\ge\sigma_{2}\ge\ldots\ge\sigma_{n}\ge0 \)&lt;/span&gt;. המספרים הללו הם מה שנקרא &lt;strong&gt;הערכים הסינגולריים&lt;/strong&gt; של &lt;span&gt;\( A \)&lt;/span&gt;. לפעמים קוראים “ערכים סינגולריים” רק לאותם &lt;span&gt;\( \sigma_{i} \)&lt;/span&gt;-ים שגדולים ממש מאפס; אני לא אעשה את ההפרדה הזו כרגע, אבל אני כן אכניס סימון חדש לתמונה: &lt;span&gt;\( r \)&lt;/span&gt; יהיה המספר של הערכים הסינגולריים שגדולים מאפס, כלומר &lt;span&gt;\( \sigma_{1}\ge\ldots\ge\sigma_{r}&amp;gt;0 \)&lt;/span&gt; ו-&lt;span&gt;\( \sigma_{r+1}=\ldots=\sigma_{n}=0 \)&lt;/span&gt;. בהמשך נראה ש-&lt;span&gt;\( r=\text{rank}A \)&lt;/span&gt;, אבל ההוכחה לא מיידית אז נחכה עם זה קצת.&lt;/p&gt;

&lt;p&gt;עכשיו אנחנו יכולים לבנות מטריצה אלכסונית &lt;span&gt;\( n\times n \)&lt;/span&gt; עם הערכים הסינגולריים על האלכסון:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Lambda=\left(\begin{array}{cccc} \sigma_{1}\\  &amp;amp; \sigma_{2}\\  &amp;amp;  &amp;amp; \ddots\\  &amp;amp;  &amp;amp;  &amp;amp; \sigma_{n} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( AA^{*} \)&lt;/span&gt; לא סתם לכסינה אלא לכסינה &lt;strong&gt;אוניטרית&lt;/strong&gt;, כלומר יש לנו בסיס של וקטורים עצמיים אורתונורמליים &lt;span&gt;\( x_{1},\ldots,x_{n} \)&lt;/span&gt; שאפשר לסדר יפה בתור עמודות ולקבל מטריצה אוניטרית &lt;span&gt;\( X\in M_{n,n} \)&lt;/span&gt;. אני רוצה למצוא פירוק של &lt;span&gt;\( A \)&lt;/span&gt; שהוא מהצורה &lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt;, אבל מהי &lt;span&gt;\( Y \)&lt;/span&gt; הזו? ראשית, &lt;span&gt;\( X\Lambda\in M_{n,n} \)&lt;/span&gt; ולכן צריך שיתקיים &lt;span&gt;\( Y\in M_{n,m} \)&lt;/span&gt; כדי שכפל המטריצות יהיה מוגדר ונקבל ממנו מטריצה מאותם ממדים כמו &lt;span&gt;\( A \)&lt;/span&gt;. אבל חוץ מזה, מה אנחנו יודעים עליה? אם &lt;span&gt;\( \Lambda \)&lt;/span&gt; היא &lt;strong&gt;הפיכה&lt;/strong&gt; אז הסיטואציה פשוטה: &lt;span&gt;\( Y=\Lambda^{-1}X^{*}A \)&lt;/span&gt;, אבל זה עובד רק אם &lt;span&gt;\( \Lambda \)&lt;/span&gt; הפיכה, כלומר אם כל הערכים העצמיים גדולים מאפס (כלומר אם &lt;span&gt;\( r=n \)&lt;/span&gt;). אחרת? המצב קצת מסובך יותר אבל עדיין אפשר לבנות &lt;span&gt;\( Y \)&lt;/span&gt; מתאימה. בשביל לעשות את זה, אני קודם אניח ש-&lt;span&gt;\( \Lambda \)&lt;/span&gt; כן הפיכה ואראה מה אני יכול להגיד על המבנה של &lt;span&gt;\( Y \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;יהיה לי קצת יותר נוח לבנות את &lt;span&gt;\( Y^{*} \)&lt;/span&gt; ולקבל ממנו את &lt;span&gt;\( Y \)&lt;/span&gt;, אז נתחיל עם לחשב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Y^{*}=\left(\Lambda^{-1}X^{*}A\right)^{*}=A^{*}X\Lambda^{-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשאני משתמש כאן בכך ש-&lt;span&gt;\( \Lambda^{-1} \)&lt;/span&gt; היא מטריצה ממשית אלכסונית ולכן &lt;span&gt;\( \left(\Lambda^{-1}\right)^{*}=\Lambda^{-1} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, באופן כללי כשיש לנו מכפלת מטריצות &lt;span&gt;\( AB \)&lt;/span&gt; אפשר לחשוב על העמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; של המכפלה בתור &lt;span&gt;\( Ab_{i} \)&lt;/span&gt;, כלומר המכפלה של כל &lt;span&gt;\( A \)&lt;/span&gt; בעמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( B \)&lt;/span&gt;. זה אומר שהעמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( A^{*}X \)&lt;/span&gt; היא פשוט &lt;span&gt;\( A^{*}x_{i} \)&lt;/span&gt;. עכשיו, עוד דרך לחשוב על העמודות של המכפלה &lt;span&gt;\( AB \)&lt;/span&gt; היא שהעמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; במכפלה היא &lt;strong&gt;צירוף לינארי&lt;/strong&gt; של העמודות של &lt;span&gt;\( A \)&lt;/span&gt; עם המקדמים שנמצאים בעמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( B \)&lt;/span&gt;. כך שאם &lt;span&gt;\( B \)&lt;/span&gt; היא אלכסונית עם הערך &lt;span&gt;\( b_{ii} \)&lt;/span&gt; על האלכסון, אז העמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( AB \)&lt;/span&gt; תכיל את העמודה ה-&lt;span&gt;\( i \)&lt;/span&gt;של &lt;span&gt;\( A \)&lt;/span&gt; כשהיא מוכפלת ב-&lt;span&gt;\( \lambda_{ii} \)&lt;/span&gt; ותו לא. במקרה שלנו זה אומר שהעמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( A^{*}X\Lambda^{-1} \)&lt;/span&gt; תהיה &lt;span&gt;\( \sigma_{i}^{-1}A^{*}x_{i} \)&lt;/span&gt;. לכן, במטריצה &lt;span&gt;\( Y \)&lt;/span&gt; שאנחנו בונים, &lt;strong&gt;השורה&lt;/strong&gt; ה-&lt;span&gt;\( i \)&lt;/span&gt; תהיה הוקטור &lt;span&gt;\( y_{i}=\left(\sigma_{i}^{-1}A^{*}x_{i}\right)^{*}=\sigma_{i}^{-1}x_{i}^{*}A \)&lt;/span&gt;. כל זה נכון במקרה שבו &lt;span&gt;\( \Lambda \)&lt;/span&gt; הפיכה, אבל גם אם לא - אנחנו יכולים להשתמש בו כדי &lt;strong&gt;להגדיר&lt;/strong&gt; את השורות של &lt;span&gt;\( Y \)&lt;/span&gt;, כל עוד &lt;span&gt;\( \sigma_{i}\ne0 \)&lt;/span&gt;, כלומר עבור הערכים הסינגולריים שסימנתי ב-&lt;span&gt;\( \sigma_{1},\ldots,\sigma_{r} \)&lt;/span&gt;.קיבלנו את השורות &lt;span&gt;\( y_{1},\ldots,y_{r} \)&lt;/span&gt;, כלומר &lt;span&gt;\( r \)&lt;/span&gt; השורות הראשונות במטריצה &lt;span&gt;\( Y \)&lt;/span&gt; שאמורה לכלול סך הכל &lt;span&gt;\( n \)&lt;/span&gt; שורות שכל אחד מהן היא באורך &lt;span&gt;\( m \)&lt;/span&gt; (כי היא מסדר &lt;span&gt;\( n\times m \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;ה-&lt;span&gt;\( y_{i} \)&lt;/span&gt;-ים הללו מקיימים תכונה מהותית אחת - גם הם אורתונורמליים. כדי לראות את זה, בואו נכפול אותם פנימית. אם &lt;span&gt;\( x,y \)&lt;/span&gt; הם שני וקטורים ב-&lt;span&gt;\( \mathbb{F}^{n} \)&lt;/span&gt;, המכפלה הפנימית הסטנדרטית שלהם היא &lt;span&gt;\( \left\langle x,y\right\rangle =y^{*}x \)&lt;/span&gt;, אבל זה נכון לוקטורי &lt;strong&gt;עמודה. &lt;/strong&gt;אם יש לנו וקטורי שורה, להסתכל על &lt;span&gt;\( xy^{*} \)&lt;/span&gt; ישיג את אותו אפקט (מצמיד את אברי &lt;span&gt;\( y \)&lt;/span&gt; ומסדר את הממדים כך שכפל שני הוקטורים יניב סקלר). לכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left\langle y_{i},y_{j}\right\rangle =\left(\sigma_{i}^{-1}x_{i}^{*}A\right)\left(\sigma_{j}^{-1}x_{j}^{*}A\right)^{*}=\left(\sigma_{i}\sigma_{j}\right)^{-1}x_{i}^{*}AA^{*}x_{j} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, כזכור &lt;span&gt;\( x_{j} \)&lt;/span&gt; הוא וקטור עצמי של &lt;span&gt;\( AA^{*} \)&lt;/span&gt; עם ערך עצמי &lt;span&gt;\( \lambda_{j}=\sigma_{j}^{2} \)&lt;/span&gt; כך שקיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(\sigma_{i}\sigma_{j}\right)^{-1}x_{i}^{*}AA^{*}x_{j}=\left(\sigma_{i}\sigma_{j}\right)^{-1}\sigma_{j}^{2}x_{i}^{*}x_{j}=\frac{\sigma_{j}}{\sigma_{i}}\left\langle x_{j},x_{i}\right\rangle =\frac{\sigma_{j}}{\sigma_{i}}\delta_{ij}=\delta_{ij} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המעבר האחרון נובע מכך שאם &lt;span&gt;\( i\ne j \)&lt;/span&gt; אז &lt;span&gt;\( \frac{\sigma_{j}}{\sigma_{i}}\delta_{ij}=0 \)&lt;/span&gt; ואילו אם &lt;span&gt;\( \delta_{ij}=1 \)&lt;/span&gt; אז ברכיב &lt;span&gt;\( \frac{\sigma_{j}}{\sigma_{i}} \)&lt;/span&gt; יש לנו את אותו איבר ולכן הוא מתבטל.&lt;/p&gt;

&lt;p&gt;עכשיו, אם יש לנו קבוצה &lt;span&gt;\( \left\{ y_{1},\ldots,y_{r}\right\}  \)&lt;/span&gt; של וקטורים אורתונורמליים בלתי תלויים במרחב &lt;span&gt;\( \mathbb{F}_{m} \)&lt;/span&gt;, כאשר &lt;span&gt;\( r\le n\le m \)&lt;/span&gt;, אז אפשר &lt;strong&gt;להרחיב&lt;/strong&gt; אותה לקבוצה &lt;span&gt;\( \left\{ y_{1},\ldots,y_{r},y_{r+1},\ldots,y_{n}\right\}  \)&lt;/span&gt; של וקטורים אורתונורמליים בלתי תלויים בשיטות הסטנדרטיות של השלמה לבסיס וביצוע גרם-שמידט (רק שכאן אנחנו לא צריכים להגיע ל-&lt;span&gt;\( m \)&lt;/span&gt; וקטורים אלא יכולים להסתפק ב-&lt;span&gt;\( n \)&lt;/span&gt; כאלו). שימו לב שההרחבה הזו לא נקבעת בצורה יחידה, אז זו כבר הנקודה השניה שבה משהו לא נקבע באופן יחיד: גם &lt;span&gt;\( X \)&lt;/span&gt; לא נקבעה באופן יחיד, ועכשיו אנחנו רואים שאם לא כל הערכים הסינגולריים שונים מאפס אז גם &lt;span&gt;\( Y \)&lt;/span&gt; לא נקבעת באופן יחיד בהינתן &lt;span&gt;\( X \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;קיבלנו מטריצה &lt;span&gt;\( Y \)&lt;/span&gt;, אבל צריך להראות ש-&lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt;, או באופן שקול ש-&lt;span&gt;\( X^{*}A=\Lambda Y \)&lt;/span&gt;. אפשר להראות ששתי המטריצות הללו שוות, שורה-שורה. עבור &lt;span&gt;\( r \)&lt;/span&gt; השורות הראשונות, השורות של &lt;span&gt;\( Y \)&lt;/span&gt; הן מהצורה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( y_{i}=\sigma_{i}^{-1}x_{i}^{*}A \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן השורות של &lt;span&gt;\( \Lambda Y \)&lt;/span&gt; הן מהצורה &lt;span&gt;\( x_{i}^{*}A \)&lt;/span&gt;, וזו בדיוק הצורה של שורה של &lt;span&gt;\( X^{*}A \)&lt;/span&gt; (שני אלו מאותם שיקולים על איך נראות העמודות של מכפלה שהזכרתי קודם, רק כשמפעילים אותם על שורות בתיקונים המתאימים).&lt;/p&gt;

&lt;p&gt;עבור שורה &lt;span&gt;\( y_{k} \)&lt;/span&gt; שהיא מעבר ל-&lt;span&gt;\( r \)&lt;/span&gt; הראשונות, הסקלר המתאים ב-&lt;span&gt;\( \Lambda \)&lt;/span&gt; שבו כופלים את השורה ה-&lt;span&gt;\( k \)&lt;/span&gt; הוא &lt;span&gt;\( \sigma_{k}=0 \)&lt;/span&gt;, ולכן מקבלים ב&lt;span&gt;\( \Lambda Y \)&lt;/span&gt;- את שורת האפס. מצד שני, השורה המתאימה בצד שמאל היא &lt;span&gt;\( x_{k}^{*}A \)&lt;/span&gt;. אל מה היא שווה? ובכן, מכיוון שהערך הסינגולרי &lt;span&gt;\( \sigma_{k}=0 \)&lt;/span&gt; אז גם &lt;span&gt;\( \lambda_{k}=0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( \left(AA^{*}\right)x_{k}=\lambda_{k}x_{k}=0 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להשתמש בטריק. נכפול את &lt;span&gt;\( \left(AA^{*}\right)x_{k} \)&lt;/span&gt; משמאל ב-&lt;span&gt;\( x_{k}^{*} \)&lt;/span&gt;. מכיוון ש-&lt;span&gt;\( \left(AA^{*}\right)x_{k} \)&lt;/span&gt; הוא וקטור האפס, אחרי הכפל ב-&lt;span&gt;\( x_{k}^{*} \)&lt;/span&gt; נקבל את סקלר האפס. מצד שני, אפשר להשתמש בפלא של האסוציאטיביות של כפל מטריצות כדי להפוך את המכפלה הזו למכפלה פנימית:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0=x_{k}^{*}\left(AA^{*}\right)x_{k}=\left(x_{k}^{*}A\right)\left(A^{*}x_{k}\right)=\left(A^{*}x_{k}\right)^{*}\left(A^{*}x_{k}\right)=\left\langle A^{*}x_{k},A^{*}x_{k}\right\rangle  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולהשתמש בכך שמכפלה פנימית היא חיובית, כך שמכפלה פנימית של איבר בעצמו יצאה 0, האיבר הוא 0, כלומר &lt;span&gt;\( A^{*}x_{k}=0 \)&lt;/span&gt;, ולכן גם &lt;span&gt;\( 0=\left(A^{*}x_{k}\right)^{*}=x_{k}^{*}A \)&lt;/span&gt;, כמו שרצינו להראות. זה מסיים את ההוכחה.&lt;/p&gt;

&lt;p&gt;בואו נציין שוב במפורש את מה שמצאנו: &lt;strong&gt;לכל&lt;/strong&gt; מטריצה &lt;span&gt;\( A \)&lt;/span&gt;, תהא אשר תהא (חוץ מההנחה שמספר השורות בה לא גדול ממספר העמודות) קיים פירוק &lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt; כך ש-&lt;span&gt;\( \Lambda \)&lt;/span&gt; היא המטריצה האלכסונית של הערכים הסינגולריים של &lt;span&gt;\( A \)&lt;/span&gt;, &lt;span&gt;\( X \)&lt;/span&gt; היא מטריצה אוניטרית, ואילו &lt;span&gt;\( Y \)&lt;/span&gt; היא מטריצה בעלת שורות אורתונורמליות.&lt;/p&gt;

&lt;p&gt;נקודה אחת שעוד לא ראינו היא ש-&lt;span&gt;\( \Lambda \)&lt;/span&gt; נקבעת בצורה &lt;strong&gt;יחידה&lt;/strong&gt;, במובן הבא: אם &lt;span&gt;\( \Lambda \)&lt;/span&gt; היא מטריצה אלכסונית &lt;strong&gt;כלשהי&lt;/strong&gt; מסדר &lt;span&gt;\( n\times n \)&lt;/span&gt; שהכניסות על האלכסון שלה הן &lt;span&gt;\( \tau_{1}\ge\tau_{2}\ge\ldots\ge\tau_{n} \)&lt;/span&gt; ויש פירוק &lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt; עם תכונות האורתונורמליות של &lt;span&gt;\( X,Y \)&lt;/span&gt; שציינתי קודם, אז &lt;span&gt;\( \tau_{i}=\sigma_{i} \)&lt;/span&gt;, כלומר &lt;span&gt;\( \Lambda \)&lt;/span&gt; היא המטריצה של הערכים הסינגולריים. אין פירוק אחר שבו באמצע יש מטריצה עם ערכים &lt;strong&gt;ממשיים&lt;/strong&gt; שמסודרים בסדר יורד. כדי לראות את זה, נניח ש-&lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt; ונחשב את &lt;span&gt;\( AA^{*} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( AA^{*}=\left(X\Lambda Y\right)\left(X\Lambda Y\right)^{*}=X\Lambda YY^{*}\Lambda X^{*}=X\Lambda^{2}X^{*} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן השתמשנו בכך ש-&lt;span&gt;\( YY^{*}=I \)&lt;/span&gt; בזכות האורתונורמליות של שורות &lt;span&gt;\( Y \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, מכיוון ש-&lt;span&gt;\( X \)&lt;/span&gt; היא מטריצה אוניטרית, המשוואה &lt;span&gt;\( AA^{*}=X\Lambda^{2}X^{*} \)&lt;/span&gt; אומרת ש-&lt;span&gt;\( \Lambda^{2} \)&lt;/span&gt; היא מה שמתקבל מלכסון אוניטרי של &lt;span&gt;\( AA^{*} \)&lt;/span&gt;, כלומר הכניסות של &lt;span&gt;\( \Lambda^{2} \)&lt;/span&gt; הן הערכים העצמיים של &lt;span&gt;\( AA^{*} \)&lt;/span&gt;: &lt;span&gt;\( \tau_{i}^{2}=\lambda_{i}=\sigma_{i}^{2} \)&lt;/span&gt;, ומכיוון שגם &lt;span&gt;\( \sigma_{i} \)&lt;/span&gt; וגם &lt;span&gt;\( \tau_{i} \)&lt;/span&gt; הם ממשיים אי שליליים, אפשר להוציא שורש ולקבל &lt;span&gt;\( \tau_{i}=\sigma_{i} \)&lt;/span&gt;.&lt;/p&gt;

&lt;h2&gt;מקבלים את הפירוק הפולארי ואת פירוק SVD&lt;/h2&gt;

&lt;p&gt;המטרה של הפוסט היא להראות איך מקבלים את פירוק SVD אבל עם מה שכבר ראינו כל כך קל לקבל את הפירוק הפולארי שיהיה מגוחך להתעלם מזה. אנחנו לוקחים מטריצה &lt;span&gt;\( A \)&lt;/span&gt; כלשהי מסדר &lt;span&gt;\( n\times m \)&lt;/span&gt; כך ש-&lt;span&gt;\( n\le m \)&lt;/span&gt; ועל פי מה שכבר ראינו, מקבלים עבורה פירוק&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו נשתמש בטריק הכי עתיק בספר - נתקע באמצע הביטוי את &lt;span&gt;\( X^{*}X \)&lt;/span&gt; ששווה למטריצת היחידה, ונשתמש באסוציאטיביות. נקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A=\left(X\Lambda X^{*}\right)\left(XY\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;נסמן &lt;span&gt;\( P=X\Lambda X^{*} \)&lt;/span&gt; ו-&lt;span&gt;\( U=XY \)&lt;/span&gt; וקיבלנו פירוק &lt;span&gt;\( A=PU \)&lt;/span&gt;. עכשיו, מה אמרתי על הפירוק הזה קודם? שקיימת &lt;span&gt;\( P\in M_{n,n} \)&lt;/span&gt; חיובית מאותה דרגה כמו &lt;span&gt;\( A \)&lt;/span&gt;, ו-&lt;span&gt;\( U\in M_{n,m} \)&lt;/span&gt; כך ש-&lt;span&gt;\( A=PU \)&lt;/span&gt;, ו-&lt;span&gt;\( U \)&lt;/span&gt; היא “אוניטרית” במובן הבא: &lt;span&gt;\( UU^{*}=I_{m\times m} \)&lt;/span&gt;. כלומר, &lt;strong&gt;השורות&lt;/strong&gt; של &lt;span&gt;\( U \)&lt;/span&gt; הן אורתונורמליות. האם שני אלו נכונים?&lt;/p&gt;

&lt;p&gt;ראשית, הממדים מתאימים: &lt;span&gt;\( X\Lambda X^{*} \)&lt;/span&gt; היא באמת מסדר &lt;span&gt;\( n\times n \)&lt;/span&gt;, ואילו &lt;span&gt;\( XY \)&lt;/span&gt; היא מסדר &lt;span&gt;\( n\times m \)&lt;/span&gt;. שנית,&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( UU^{*}=XYY^{*}X^{*}=XIX^{*}=XX^{*}=I \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שמשאיר רק להבין למה &lt;span&gt;\( P \)&lt;/span&gt; היא חיובית - אבל אנחנו יודעים שמטריצה היא חיובית אם ורק אם הערכים העצמיים שלה הם ממשיים אי שליליים, ו-&lt;span&gt;\( X\Lambda X^{*} \)&lt;/span&gt; הוא לכסון אוניטרי, הערכים העצמיים כבר כתובים במפורש ב-&lt;span&gt;\( \Lambda \)&lt;/span&gt; והם כולם ממשיים אי שליליים. זה מסיים את ההוכחה - אמרתי שזה יהיה פשוט!&lt;/p&gt;

&lt;p&gt;עוד דבר שקל יחסית לראות הוא מתי הפירוק הפולארי הוא &lt;strong&gt;יחיד&lt;/strong&gt;. ראשית, מה זו &lt;span&gt;\( P \)&lt;/span&gt;? אנחנו יודעים ש-&lt;span&gt;\( P^{2}=\left(X\Lambda X^{*}\right)\left(X\Lambda X^{*}\right)=X\Lambda^{2}X^{*} \)&lt;/span&gt;. אבל מי אלו &lt;span&gt;\( X,\Lambda \)&lt;/span&gt;? הן לא מטריצות שבאו משום מקום, הן הגיעו מכך שמצאנו לכסון אוניטרי של &lt;span&gt;\( AA^{*} \)&lt;/span&gt;, ובלכסון האוניטרי הזה &lt;span&gt;\( AA^{*} \)&lt;/span&gt; הייתה דומה למטריצה &lt;span&gt;\( \Lambda^{2} \)&lt;/span&gt; והמטריצה המלכסנת הייתה &lt;span&gt;\( X \)&lt;/span&gt;. במילים אחרות, &lt;span&gt;\( P^{2}=AA^{*} \)&lt;/span&gt; ולכן &lt;span&gt;\( P \)&lt;/span&gt; נקבעת בצורה &lt;strong&gt;יחידה&lt;/strong&gt;, כי בפוסט הקודם ראינו שהשורש החיובי של מטריצה חיובית הוא יחיד.&lt;/p&gt;

&lt;p&gt;האם זה קובע באופן יחיד את &lt;span&gt;\( U \)&lt;/span&gt;? לא בהכרח, אבל אם &lt;span&gt;\( P \)&lt;/span&gt; &lt;strong&gt;הפיכה&lt;/strong&gt; אז כן, כי אז פשוט נקבל &lt;span&gt;\( U=AP^{-1} \)&lt;/span&gt; (בפוסט הקודם אמרתי שזה מאוד אנלוגי למה שקורה עם ההצגה הפולארית של מספרים מרוכבים - שם המספר היחיד שאין לו הצגה יחידה הוא 0, שאינו הפיך).&lt;/p&gt;

&lt;p&gt;עכשיו בואו נעבור אל SVD. מה שקורה כאן הוא ש-&lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt; הוא לא פירוק מתאים, כי בפירוק &lt;span&gt;\( A=U\Sigma V^{*} \)&lt;/span&gt; שאנחנו מחפשים גם &lt;span&gt;\( U \)&lt;/span&gt; וגם &lt;span&gt;\( V \)&lt;/span&gt; הן ריבועיות ואוניטריות ואילו &lt;span&gt;\( \Sigma \)&lt;/span&gt; עלולה להיות לא ריבועית, בזמן שבפירוק &lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt; אמנם &lt;span&gt;\( X \)&lt;/span&gt; הוא ריבועית ואוניטרית, אבל &lt;span&gt;\( Y \)&lt;/span&gt; לא ריבועית (למרות שהיא כן סוג של אוניטרית במובן הזה ש-&lt;span&gt;\( YY^{*}=I \)&lt;/span&gt;) ודווקא &lt;span&gt;\( \Lambda \)&lt;/span&gt; היא ריבועית. אז איך עוברים מפירוק אחד לשני? באופן די ישיר, למען האמת.&lt;/p&gt;

&lt;p&gt;ראשית, &lt;span&gt;\( X\in M_{n,n} \)&lt;/span&gt; היא כבר ריבועית ואוניטרית, אז מה יש לשנות כאן? נגדיר &lt;span&gt;\( U=X \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;שנית, &lt;span&gt;\( \Lambda\in M_{n,n} \)&lt;/span&gt; כבר מכילה את הערכים הסינגולריים על האלכסון. הדבר היחיד שמבדיל בינה ובין &lt;span&gt;\( \Sigma \)&lt;/span&gt; שתיארנו קודם, הוא ש-&lt;span&gt;\( \Sigma \)&lt;/span&gt; יכולה להיות ארוכה יותר - כלומר, עם יותר עמודות. ליתר דיוק, &lt;span&gt;\( \Sigma\in M_{n,m} \)&lt;/span&gt; ובכל החלל הריק הנוסף הזה יש רק אפסים. אז ככה נגדיר אותה; פורמלית, מסמנים &lt;span&gt;\( \Sigma=\left[\Lambda|0\right] \)&lt;/span&gt; או משהו בסגנון כדי לתאר את המטריצה שמתקבלת מ-&lt;span&gt;\( \Lambda \)&lt;/span&gt; על ידי “הדבקה מימין” של מטריצת אפסים מסדר &lt;span&gt;\( n\times\left(m-n\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;האתגר הגדול יותר הוא &lt;span&gt;\( V \)&lt;/span&gt;. אי אפשר להשתמש סתם ב-&lt;span&gt;\( Y \)&lt;/span&gt; כי &lt;span&gt;\( Y \)&lt;/span&gt; היא מסדר &lt;span&gt;\( n\times m \)&lt;/span&gt;. זכרו ש-&lt;span&gt;\( n\le m \)&lt;/span&gt; ולכן ייתכן ש”חסרות לה שורות” כדי להיות ריבועית. אבל כמו שעשינו קודם, אפשר &lt;strong&gt;להרחיב&lt;/strong&gt;. אם נסתכל על איך קיבלנו את &lt;span&gt;\( Y \)&lt;/span&gt; מלכתחילה, הגדרנו שורות מסוימות שלה במפורש באמצעות ביטוי שעירב את &lt;span&gt;\( A \)&lt;/span&gt;, את העמודות של &lt;span&gt;\( X \)&lt;/span&gt; ואת הערכים הסינגולריים, ואז הוספנו עוד שורות שהיו בלתי תלויות ואורתונורמליות לשורות הקודמות, רק שאז עצרנו באופן שרירותי אחרי שהיו לנו &lt;span&gt;\( n \)&lt;/span&gt; שורות, למרות שיכלנו להמשיך (בטכניקות הרגילות של השלמה לבסיס וגרם-שמידט) ולקבל &lt;span&gt;\( m \)&lt;/span&gt; שורות כאלו. אז נשלים את ההרחבה; נסמן את המטריצה של השורות הנוספות שהוספנו ב-&lt;span&gt;\( S \)&lt;/span&gt; ועכשיו נשים לב שמה שאני רוצה שיהיה איפה ש-&lt;span&gt;\( Y \)&lt;/span&gt; נמצאת כרגע הוא לא &lt;span&gt;\( V \)&lt;/span&gt; אלא &lt;span&gt;\( V^{*} \)&lt;/span&gt;, אז נגדיר את &lt;span&gt;\( V \)&lt;/span&gt; בתור הפעלת הצמדה על הכל: &lt;span&gt;\( V=\left[Y^{*}|S^{*}\right] \)&lt;/span&gt;. זו מטריצה מסדר &lt;span&gt;\( m\times m \)&lt;/span&gt;, אבל האם באמת מתקיים &lt;span&gt;\( A=U\Sigma V^{*} \)&lt;/span&gt;? בואו נראה שמתקיים &lt;span&gt;\( U\Sigma V^{*}=X\Lambda Y=A \)&lt;/span&gt; ובכך נסיים את זה.&lt;/p&gt;

&lt;p&gt;ראשית, &lt;span&gt;\( X=U \)&lt;/span&gt; אז המשוואה שצריך להראות היא מהצורה &lt;span&gt;\( U\Sigma V^{*}=U\Lambda Y \)&lt;/span&gt; ועל ידי כפל ב-&lt;span&gt;\( U^{*} \)&lt;/span&gt; של שני האגפים נקבל שצריך להראות &lt;span&gt;\( \Sigma V^{*}=\Lambda Y \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;נסמן את השורות של &lt;span&gt;\( Y \)&lt;/span&gt; ב-&lt;span&gt;\( y_{1},\ldots,y_{r} \)&lt;/span&gt; כמו קודם, ואת השורות החדשות, שנמצאות ב-&lt;span&gt;\( S \)&lt;/span&gt;, ב-&lt;span&gt;\( y_{r+1},\ldots,y_{m} \)&lt;/span&gt;. אפשר לתאר באופן סכמטי את שני כפלי המטריצות בתור&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Sigma V^{*}=\left(\begin{array}{ccccccc} \sigma_{1} &amp;amp;  &amp;amp;  &amp;amp;  &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0\\  &amp;amp; \sigma_{2}\\  &amp;amp;  &amp;amp; \ldots\\  &amp;amp;  &amp;amp;  &amp;amp; \sigma_{n} &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 \end{array}\right)\left(\begin{array}{c} y_{1}\\ y_{2}\\ \vdots\\ y_{m} \end{array}\right)=\left(\begin{array}{c} \sigma_{1}y_{1}\\ \sigma_{2}y_{2}\\ \vdots\\ \sigma_{n}y_{n} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Lambda Y=\left(\begin{array}{cccc} \sigma_{1}\\  &amp;amp; \sigma_{2}\\  &amp;amp;  &amp;amp; \ldots\\  &amp;amp;  &amp;amp;  &amp;amp; \sigma_{n} \end{array}\right)\left(\begin{array}{c} y_{1}\\ y_{2}\\ \vdots\\ y_{n} \end{array}\right)=\left(\begin{array}{c} \sigma_{1}y_{1}\\ \sigma_{2}y_{2}\\ \vdots\\ \sigma_{n}y_{n} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן ה”וקטור” של ה-&lt;span&gt;\( y \)&lt;/span&gt;-ים הוא לא וקטור, הוא מטריצה - מה שמקבלים כשכותבים במקום כל &lt;span&gt;\( y \)&lt;/span&gt; כזה את כל השורה שהוא מייצג (ולכן &lt;span&gt;\( \sigma_{i}y_{i} \)&lt;/span&gt; הוא כפל של כל אברי השורה &lt;span&gt;\( y_{i} \)&lt;/span&gt; בסקלר &lt;span&gt;\( \sigma_{i} \)&lt;/span&gt;). לי אישית הכי קשה לעכל כאן את זה ש-&lt;span&gt;\( \Sigma V^{*} \)&lt;/span&gt; כולל כפל ב”וקטור” של &lt;span&gt;\( y_{1},\ldots,y_{m} \)&lt;/span&gt; אבל התוצאה מגיעה רק עד &lt;span&gt;\( y_{n} \)&lt;/span&gt;; אבל זה ברור אם חושבים על זה רגע כי יש לנו שורה בתוצאה רק לכל שורה של &lt;span&gt;\( \Sigma \)&lt;/span&gt;, לא מעבר לכך. ה-&lt;span&gt;\( y \)&lt;/span&gt;-ים שמעבר ל-&lt;span&gt;\( y_{n} \)&lt;/span&gt; שב-&lt;span&gt;\( V^{*} \)&lt;/span&gt; לא מקבלים הזדמנות לבוא לידי ביטוי כי הם מוכפלים תמיד בחלק של ה-&lt;span&gt;\( 0\cdots0 \)&lt;/span&gt; של &lt;span&gt;\( \Sigma \)&lt;/span&gt;. הסיבה שבגללה הם קיימים היא כדי ש-&lt;span&gt;\( V \)&lt;/span&gt; תהיה מטריצה אוניטרית בעצמה, לא יותר מכך.&lt;/p&gt;

&lt;h2&gt;בואו נכניס את הדרגה לתמונה&lt;/h2&gt;

&lt;p&gt;יש עוד היבט מעניין של SVD שעוזר להבין מה בעצם הוא אומר: אפשר לחשוב עליו בתור פירוק של &lt;span&gt;\( A \)&lt;/span&gt; לצירוף לינארי של מטריצות מדרגה 1, כשמקדמי הצירוף הם בדיוק הערכים הסינגולריים - ולכן בעצם יש לנו פירוק של &lt;span&gt;\( A \)&lt;/span&gt; לרכיבים בסיסיים על פי “סדר חשיבות” (ככל שהערך הסינגולרי גדול יותר, הרכיב “יבוא יותר לידי ביטוי”).&lt;/p&gt;

&lt;p&gt;קודם כל אולי כדאי שאזכיר מה זו דרגה של מטריצה, שאני מסמן ב-&lt;span&gt;\( \text{rank}A \)&lt;/span&gt;. ההגדרה שלי היא שזה המימד של &lt;strong&gt;מרחב העמודות&lt;/strong&gt; של &lt;span&gt;\( A \)&lt;/span&gt; - כלומר, אם &lt;span&gt;\( A\in M_{n,m} \)&lt;/span&gt; אז אני לוקח את &lt;span&gt;\( m \)&lt;/span&gt; העמודות של &lt;span&gt;\( A \)&lt;/span&gt; ולוקח כל צירוף לינארי אפשרי שלהן ובודק מה הגודל של בסיס למרחב הזה. זה הולך להיות מספר בין 0 ל-&lt;span&gt;\( m \)&lt;/span&gt;, כש-0 פירושו שהמטריצה &lt;span&gt;\( A \)&lt;/span&gt; כולה אפסים ואילו &lt;span&gt;\( m \)&lt;/span&gt; פירושו שכל העמודות של &lt;span&gt;\( A \)&lt;/span&gt; הן בלתי תלויות, וזה שקול לכך ש-&lt;span&gt;\( A \)&lt;/span&gt; &lt;strong&gt;הפיכה&lt;/strong&gt;. אם כן, אפשר לחשוב על דרגה של מטריצה בתור כמות “דרגות החופש” שיש בה - כמה אינפורמציה היא מכילה.&lt;/p&gt;

&lt;p&gt;יש עוד אפיונים שקולים לדרגה. ראשית, הדרגה שווה גם למימד של &lt;strong&gt;מרחב השורות&lt;/strong&gt; של המטריצה. זו תוצאה לא טריוויאלית, אבל לא אוכיח אותה כאן; זה גם אומר שהדרגה של מטריצה לא יכולה להיות גדולה מ-&lt;span&gt;\( \min\left\{ n,m\right\}  \)&lt;/span&gt;. עכשיו, כשכופלים את &lt;span&gt;\( A \)&lt;/span&gt; בוקטור &lt;span&gt;\( v \)&lt;/span&gt; כלשהו, אז &lt;span&gt;\( Av \)&lt;/span&gt; הוא וקטור שהוא צירוף לינארי של &lt;strong&gt;עמודות&lt;/strong&gt; &lt;span&gt;\( A \)&lt;/span&gt; - ולכן אם אנחנו כופלים את &lt;span&gt;\( A \)&lt;/span&gt; בכל הוקטורים האפשריים, נקבל בדיוק את מרחב העמודות של המטריצה; ומצד שני נקבל בדיוק את מה שנקרא &lt;strong&gt;התמונה&lt;/strong&gt; של &lt;span&gt;\( A \)&lt;/span&gt; ומסומן &lt;span&gt;\( \text{Im}A\triangleq\left\{ Av\ |\ v\in\mathbb{F}^{m}\right\}  \)&lt;/span&gt;, כך שיוצא ש-&lt;span&gt;\( \text{rank}A=\dim\text{Im}A \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, נסתכל על פירוק ה-SVD של &lt;span&gt;\( A \)&lt;/span&gt;, &lt;span&gt;\( A=U\Sigma V^{*} \)&lt;/span&gt;. מה אנחנו יודעים על הדרגות של המטריצות המעורבות? מכיוון ש-&lt;span&gt;\( U,V \)&lt;/span&gt; הן הפיכות הן מדרגה מקסימלית ביחס לגודל שלהן, ומה שחשוב כאן הוא שכפל במטריצה כזו &lt;strong&gt;לא משנה את הדרגה&lt;/strong&gt; של התוצאה. כלומר, זה שאני כופל את &lt;span&gt;\( \Sigma \)&lt;/span&gt; משמאל ב-&lt;span&gt;\( U \)&lt;/span&gt; ומימין ב-&lt;span&gt;\( V \)&lt;/span&gt; לא ישפיע על הדרגה, והדרגה של &lt;span&gt;\( U\Sigma V^{*} \)&lt;/span&gt; (כלומר של &lt;span&gt;\( A \)&lt;/span&gt;) תהיה זהה לדרגה של &lt;span&gt;\( \Sigma \)&lt;/span&gt;. ומה זו הדרגה הזו? &lt;span&gt;\( \Sigma\in M_{n,m} \)&lt;/span&gt; ואנחנו יודעים ש-&lt;span&gt;\( n\le m \)&lt;/span&gt; אז הדרגה של &lt;span&gt;\( \Sigma \)&lt;/span&gt; היא לכל היותר &lt;span&gt;\( n \)&lt;/span&gt;, אבל היא יכולה להיות קטנה יותר. יש ב-&lt;span&gt;\( \Sigma \)&lt;/span&gt; עמודות שכל אחת מהן כוללת ערך סינגולרי יחיד &lt;span&gt;\( \sigma_{i} \)&lt;/span&gt;, ולכן מספר העמודות השונות מאפס ב-&lt;span&gt;\( \Sigma \)&lt;/span&gt; &lt;strong&gt;זהה&lt;/strong&gt; למספר הערכים הסינגולריים ששונים מאפס. כלומר, &lt;span&gt;\( \text{rank}A=r \)&lt;/span&gt; אם ורק אם הערכים הסינגולריים הגדולים מאפס של &lt;span&gt;\( A \)&lt;/span&gt; הם &lt;span&gt;\( \sigma_{1},\ldots,\sigma_{r} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו בואו נחזור לתחביב שלי “להציג מטריצות כאילו הן וקטורים”. אני אסמן &lt;span&gt;\( U=\left(u_{1}\ u_{2}\ \ldots\ u_{n}\right) \)&lt;/span&gt; כאשר כל &lt;span&gt;\( u_{i} \)&lt;/span&gt; הוא וקטור עמודה; ואסמן &lt;span&gt;\( V=\left(v_{1}\ v_{2}\ \ldots\ v_{m}\right) \)&lt;/span&gt; עם אותו רעיון בדיוק. עכשיו אפשר להציג את &lt;span&gt;\( U\Sigma V^{*} \)&lt;/span&gt; כמו כפל של מטריצה בוקטורים מימין ומשמאל, כמו בתבנית בילינארית:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( U\Sigma V^{*}=\left(u_{1}\ u_{2}\ \ldots\ u_{n}\right)\left(\begin{array}{ccccccc} \sigma_{1} &amp;amp;  &amp;amp;  &amp;amp;  &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0\\  &amp;amp; \sigma_{2}\\  &amp;amp;  &amp;amp; \ldots\\  &amp;amp;  &amp;amp;  &amp;amp; \sigma_{n} &amp;amp; 0 &amp;amp; \cdots &amp;amp; 0 \end{array}\right)\left(\begin{array}{c} v_{1}^{*}\\ v_{2}^{*}\\ \vdots\\ v_{m}^{*} \end{array}\right)=\left(u_{1}\ u_{2}\ \ldots\ u_{n}\right)\left(\begin{array}{c} \sigma_{1}v_{1}^{*}\\ \sigma_{2}v_{2}^{*}\\ \vdots\\ \sigma_{n}v_{n}^{*} \end{array}\right)=\sum_{i=1}^{n}\sigma_{i}u_{i}v_{i}^{*} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כזכור, &lt;span&gt;\( u_{i} \)&lt;/span&gt; הוא וקטור &lt;strong&gt;עמודה&lt;/strong&gt; מסדר &lt;span&gt;\( n\times1 \)&lt;/span&gt; ואילו &lt;span&gt;\( v_{i}^{*} \)&lt;/span&gt; הוא וקטור &lt;strong&gt;שורה&lt;/strong&gt; מסדר &lt;span&gt;\( 1\times m \)&lt;/span&gt;. לכן המכפלה &lt;span&gt;\( u_{i}v_{i}^{*} \)&lt;/span&gt; היא מטריצה מסדר &lt;span&gt;\( n\times m \)&lt;/span&gt;, בדיוק כמו &lt;span&gt;\( A \)&lt;/span&gt; המקורית, אבל מכיוון שהיא מכפלה של שתי מטריצות מדרגה 1 גם היא מדרגה 1 לכל היותר (באופן כללי מכפלה של מטריצות יכולה רק להוריד את הדרגה או להותיר אותה ללא שינוי - אי אפשר ליצור אינפורמציה יש מאין). לכן &lt;span&gt;\( \sum_{i=1}^{n}\sigma_{i}u_{i}v_{i}^{*} \)&lt;/span&gt; הוא בדיוק מה שרצינו - הצגה של &lt;span&gt;\( A \)&lt;/span&gt; בתור צירוף לינארי של מטריצות מדרגה 1. אפשר גם לכתוב &lt;span&gt;\( \sum_{i=1}^{r}\sigma_{i}u_{i}v_{i}^{*} \)&lt;/span&gt; כדי להדגיש שמעניינות אותנו רק המטריצות שמתאימות לערכים הסינגולריים החיוביים.&lt;/p&gt;

&lt;h2&gt;בשביל מה זה טוב...?&lt;/h2&gt;

&lt;p&gt;אוקיי, תפסתם אותי, אני לא באמת יודע בשביל מה זה טוב - יש לכל זה הרבה שימושים בתחומים שאני לא כל כך מכיר אז אני לא אוכל להיכנס לזה בפוסט הזה. אבל אני כן אדבר על שימוש אחד שנתקלתי בו והוא חביב ודי קל להצגה (ההקשר היה חישוב קוונטי, ספציפית בנייה של מעגלים קוונטיים יעילים כדי לייצור אופרטורים אוניטריים כלליים; אבל זה לא באמת חשוב להמשך): בהינתן מטריצה ריבועית &lt;span&gt;\( A\in M_{n,n} \)&lt;/span&gt; ייתכן שהיא לא אוניטרית, אבל אפשר לשאול מי המטריצה האוניטרית “הכי קרובה” אליה. בהקשר שבו נתקלתי בזה, זה היה שימושי בסיטואציות שבהן ביצענו חישוב שהיא &lt;strong&gt;אמור&lt;/strong&gt; להניב מטריצה אוניטרית, אבל בגלל בעיות נומריות נכשל; במקרה כזה סביר להניח שהמטריצה שהייתה אמורה לצאת היא האוניטרית הקרובה ביותר למה שקיבלנו בפועל, אז אם נוכל למצוא אותה נחליף את המטריצה הנוכחית בה.&lt;/p&gt;

&lt;p&gt;הטריק הוא מאוד פשוט: אם נמצא את הפירוק הפולארי &lt;span&gt;\( A=PU \)&lt;/span&gt;, אז &lt;span&gt;\( U \)&lt;/span&gt; היא הקירוב האוניטרי הזה. באופן שקול, אם &lt;span&gt;\( A=U\Sigma V^{*} \)&lt;/span&gt; הוא פירוק SVD של &lt;span&gt;\( A \)&lt;/span&gt; אז המטריצה האוניטרית הקרובה ביותר היא &lt;span&gt;\( UV^{*} \)&lt;/span&gt; (כזכור, התחלנו מ-&lt;span&gt;\( A=X\Lambda Y \)&lt;/span&gt;; במקרה של הפירוק הפולארי הגדרנו &lt;span&gt;\( U=XY \)&lt;/span&gt; ואילו במקרה של SVD הגדרנו &lt;span&gt;\( U=X \)&lt;/span&gt; וכאשר &lt;span&gt;\( A \)&lt;/span&gt; היא ריבועית, ההגדרה של &lt;span&gt;\( V \)&lt;/span&gt; יוצאת פשוט &lt;span&gt;\( V=Y^{*} \)&lt;/span&gt; ולכן &lt;span&gt;\( UV^{*}=XY \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;בואו נוכיח את זה, אבל קודם כל צריך להסביר מה זה בכלל אומר “הכי קרובה”. כדי לדבר על קרבה של מטריצות צריך להכניס לתמונה &lt;strong&gt;מטריקה&lt;/strong&gt;, פונקציה כלשהי שמודדת מרחק; למרבה המזל עבור מטריצות יש אחת פשוטה למדי.&lt;/p&gt;

&lt;p&gt;עבור וקטור &lt;span&gt;\( a=\left(a_{1},\ldots,a_{n}\right) \)&lt;/span&gt;, מכפלה פנימית שלנו בעצמו מחזירה לנו את &lt;strong&gt;הנורמה&lt;/strong&gt; &lt;span&gt;\( \|a\|^{2}=\sum_{i=1}^{n}\left|a_{i}\right|^{2} \)&lt;/span&gt;. יש עוד דרכים להגדיר נורמות על וקטורים, אז נהוג לפעמים לסמן את הנורמה הזו עם “2” כדי לציין את זה שאנחנו מעלים בחזקת 2 את אברי המטריצה (אחרי שלקחנו את הערך המוחלט שלהם) ובסוף מוציאים שורש ריבועי כדי לקבל את הנורמה: &lt;span&gt;\( \|a\|_{2}=\sqrt{\sum_{i=1}^{n}\left|a_{i}\right|^{2}} \)&lt;/span&gt;. עבור מטריצות אפשר להגדיר את אותו הדבר בדיוק: ניקח את הכניסות של המטריצה, לכל אחת נחשב את הריבוע של הערך המוחלט, נחבר את הכל ונוציא שורש ריבועי. לדבר הזה קוראים לפעמים &lt;strong&gt;נורמת פרובניוס&lt;/strong&gt; ולפעמים סתם נורמה-2 ואני סתם אשתמש בסימן הנורמה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \|A\|=\sqrt{\sum_{i,j}\left|A_{ij}\right|^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;יש דרך קצת יותר נקייה לתאר את הנורמה הזו. כזכור, &lt;span&gt;\( AA^{*} \)&lt;/span&gt; שכבר ראינו כמה פעמים היא מטריצה שבה הכניסה ה-&lt;span&gt;\( ij \)&lt;/span&gt; היא מכפלה של השורה ה-&lt;span&gt;\( i \)&lt;/span&gt; בהצמדה של השורה ה-&lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( A \)&lt;/span&gt;. בפרט, אם נסתכל על &lt;strong&gt;האלכסון&lt;/strong&gt; של &lt;span&gt;\( AA^{*} \)&lt;/span&gt;, מה שיש שם הוא את המכפלה של השורה ה-&lt;span&gt;\( i \)&lt;/span&gt; בהצמדה של &lt;strong&gt;עצמה&lt;/strong&gt;, מה שנותן בדיוק את נורמת-2 בריבוע של וקטור השורה הזו. אז אם &lt;strong&gt;נחבר&lt;/strong&gt; את כל אברי האלכסון, נקבל בדיוק את סכום כל הכניסות במטריצה, בערך מוחלט, בריבוע. וכשמדברים על מטריצות, יש שם וסימון פשוטים לסכום אברי האלכסון של המטריצה: “עקבה”, trace. במילים אחרות,&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \|A\|^{2}=\text{tr}\left(AA^{*}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה מקרה פרטי של המכפלה הפנימית הכללית: &lt;span&gt;\( \left\langle A,B\right\rangle =\text{tr}\left(AB^{*}\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;למעבר לשימוש ב-&lt;span&gt;\( \text{tr} \)&lt;/span&gt; יש יתרונות לא זניחים, כי זו פונקציה שאנחנו מכירים יפה אותה ואת המוזרויות שלה. מוזרות שימושית במיוחד נקראת &lt;strong&gt;התכונה הציקלית&lt;/strong&gt; של העקבה. היא אומרת שאם יש לנו מטריצות &lt;span&gt;\( A,B,C,D \)&lt;/span&gt; אז&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{tr}\left(ABCD\right)=\text{tr}\left(DABC\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, הזזנו את &lt;span&gt;\( D \)&lt;/span&gt; “ימינה” באופן ציקלי - כלומר, היא יצאה מימין ונכנסה חזרה משמאל. כמובן, זה יכול לעבוד רק כשהממדים של המטריצות מאפשרים את המכפלות הללו, אבל כשזה עובד זה די מרהיב.&lt;/p&gt;

&lt;p&gt;אוקיי, בואו נחזור לעניין שלנו. אפשר להשתמש בנורמת פרובניוס כדי להגדיר &lt;strong&gt;מרחק&lt;/strong&gt; בין שתי מטריצות על ידי &lt;span&gt;\( \|A-B\| \)&lt;/span&gt;. בהקשר שלנו, השאלה היא זו: נתונה לנו &lt;span&gt;\( A\in M_{n,n} \)&lt;/span&gt; ריבועית ואנחנו רוצים למצוא מטריצה &lt;span&gt;\( U\in M_{n,n} \)&lt;/span&gt; אוניטרית כך ש-&lt;span&gt;\( \|A-U\| \)&lt;/span&gt; יהיה מינימלי (כשהמינימום נלקח על פני כל הערכים האפשריים של &lt;span&gt;\( U\in M_{n,n} \)&lt;/span&gt; האוניטריות).&lt;/p&gt;

&lt;p&gt;בשביל למצוא &lt;span&gt;\( U \)&lt;/span&gt; כזו, בואו נתייחס אל &lt;span&gt;\( \|A-U\| \)&lt;/span&gt; בתור מכפלה פנימית ונשתמש בחוקי החשבון הרגילים של מכפלות פנימיות:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \|A-U\|=\left\langle A-U,A-U\right\rangle =\left\langle A,A\right\rangle -\left\langle A,U\right\rangle -\left\langle U,A\right\rangle +\left\langle U,U\right\rangle  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\|A\|^{2}-\left\langle A,U\right\rangle -\overline{\left\langle A,U\right\rangle }+\|U\|^{2}=\|A\|^{2}-2\text{Re}\left\langle A,U\right\rangle +\|U\|^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( \|A\|^{2} \)&lt;/span&gt; הוא מספר קבוע (כי &lt;span&gt;\( A \)&lt;/span&gt; קבועה) ואילו &lt;span&gt;\( \|U\|^{2}=n \)&lt;/span&gt;, כי &lt;span&gt;\( U \)&lt;/span&gt; אוניטרית ולכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \|U\|^{2}=\left\langle U,U\right\rangle =\text{tr}\left(UU^{*}\right)=\text{tr}\left(I\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז הדבר היחיד שיכול להשתנות בערך של &lt;span&gt;\( \|A-U\| \)&lt;/span&gt; כשאנחנו עוברים על ה-&lt;span&gt;\( U \)&lt;/span&gt; האוניטריות הוא החלק &lt;span&gt;\( -2\text{Re}\left\langle A,U\right\rangle  \)&lt;/span&gt;. אם אנחנו רוצים להקטין את &lt;span&gt;\( \|A-U\| \)&lt;/span&gt; ככל הניתן, אנחנו רוצים למקסם את &lt;span&gt;\( \text{Re}\left\langle A,U\right\rangle  \)&lt;/span&gt; ככל הניתן. עכשיו,&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Re}\left\langle A,U\right\rangle =\text{Re}\text{tr}\left(AU^{*}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להכניס לתמונה את התותח הכבד שלנו: ניקח פירוק SVD של &lt;span&gt;\( A \)&lt;/span&gt;, &lt;span&gt;\( A=V\Sigma W^{*} \)&lt;/span&gt; (אני לא משתמש ב-&lt;span&gt;\( U \)&lt;/span&gt; כמו בדרך כלל כי הוא כבר תפוס). אז קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Re}\text{tr}\left(AU^{*}\right)=\text{Re}\text{tr}\left(V\Sigma W^{*}U^{*}\right)=\text{Re}\text{tr}\left(\Sigma W^{*}U^{*}V\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשהמעבר האחרון הוא התכונה הציקלית הידועה לשמצה. זה טוב לנו, כי עכשיו &lt;span&gt;\( \Sigma \)&lt;/span&gt; היא בהתחלה, והיא מטריצה אלכסונית עם אלכסון של הערכים הסינגולריים &lt;span&gt;\( \left(\sigma_{1},\ldots,\sigma_{n}\right) \)&lt;/span&gt;. כזכור, לכפול משמאל במטריצה אלכסונית מכפיל את &lt;strong&gt;השורות&lt;/strong&gt; של מה שמימין בסקלרים של המטריצה האלכסונית. אז אם נסמן &lt;span&gt;\( T=W^{*}U^{*}V \)&lt;/span&gt; אז נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{tr}\left(\Sigma T\right)=\sum_{i=1}^{n}\sigma_{i}t_{ii} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ומכיוון שהערכים הסינגולריים הם ממשיים, אפשר להכניס את ה-&lt;span&gt;\( \text{Re} \)&lt;/span&gt; פנימה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Re}\text{tr}\left(\Sigma T\right)=\sum_{i=1}^{n}\sigma_{i}\text{Re}\left(t_{ii}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( T \)&lt;/span&gt; היא מכפלה של &lt;strong&gt;שלוש&lt;/strong&gt; מטריצות אוניטריות, ולכן גם היא עצמה אוניטרית. זה בפרט אומר שהעמודות של &lt;span&gt;\( T \)&lt;/span&gt; הן אורתונורמליות, כלומר מנורמה 1. לכן &lt;span&gt;\( \sum_{i=1}^{n}\left|t_{ij}\right|^{2}=1 \)&lt;/span&gt; ובפרט &lt;span&gt;\( \text{Re}\left(t_{ii}\right)\le\left|t_{ii}\right|^{2}\le1 \)&lt;/span&gt;. לכן הסכום &lt;span&gt;\( \sum_{i=1}^{n}\sigma_{i}\text{Re}\left(t_{ii}\right) \)&lt;/span&gt; יקבל את ערכו המקסימלי אם &lt;span&gt;\( \text{Re}\left(t_{ii}\right)=1 \)&lt;/span&gt; לכל &lt;span&gt;\( 1\le i\le n \)&lt;/span&gt;, מה שקורה אם &lt;span&gt;\( T=I \)&lt;/span&gt;, כלומר אם &lt;span&gt;\( W^{*}U^{*}V=I \)&lt;/span&gt; כלומר אם &lt;span&gt;\( U^{*}=WV^{*} \)&lt;/span&gt;, כלומר אם &lt;span&gt;\( U=VW^{*} \)&lt;/span&gt;, וזו בדיוק התוצאה שהבטחתי.&lt;/p&gt;

&lt;p&gt;מה שאני אוהב כאן הוא שבעזרת SVD אנחנו מקבלים הוכחה פשוטה מאוד לטענה הזו, ובעזרת הפירוק הפולארי אנחנו גם יכולים לקבל אינטואיציה: במספרים מרוכבים, אם היינו רוצים את המספר המרוכב מנורמה &lt;span&gt;\( 1 \)&lt;/span&gt; הקרוב ביותר אל &lt;span&gt;\( z \)&lt;/span&gt; היינו מותחים קו ישר מ-&lt;span&gt;\( z \)&lt;/span&gt; אל ראשית הצירים ובודקים איפה הוא חותך את מעגל היחידה- כלומר, היינו מייצגים את &lt;span&gt;\( z \)&lt;/span&gt; בתור &lt;span&gt;\( z=re^{i\theta} \)&lt;/span&gt; ואז פשוט היינו מציבים &lt;span&gt;\( r=1 \)&lt;/span&gt; ונשארים עם &lt;span&gt;\( e^{i\theta} \)&lt;/span&gt;. זה בעצם גם מה שאנחנו עושים כאן, כשאנחנו מוצאים את &lt;span&gt;\( A=PU \)&lt;/span&gt; ואז מחליפים את &lt;span&gt;\( P \)&lt;/span&gt; ב-&lt;span&gt;\( I \)&lt;/span&gt;. אלגברה לינארית זה כיף.&lt;/p&gt;</content><author><name></name></author><category term="פירוק SVD" /><category term="פירוק פולארי" /><category term="מטריצות" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מטריצות חיוביות</title><link href="http://gadial.net/2025/09/21/positive_semidefinite_matrices/" rel="alternate" type="text/html" title="מטריצות חיוביות" /><published>2025-09-21T00:00:00+00:00</published><updated>2025-09-21T00:00:00+00:00</updated><id>http://gadial.net/2025/09/21/positive_semidefinite_matrices</id><content type="html" xml:base="http://gadial.net/2025/09/21/positive_semidefinite_matrices/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;נושא בסיסי באלגברה לינארית שעדיין לא יצא לי לדבר עליו בפוסט הוא &lt;strong&gt;מטריצות חיוביות&lt;/strong&gt; ומטריצות &lt;strong&gt;חיוביות לחלוטין&lt;/strong&gt;. באנגלית מטריצות כאלו נקראות Positive Semidefinite ו-Positive Definite ובעברית מאוד מקובל השם “מטריצה מוגדרת אי-שלילית” ו”מטריצה מוגדרת חיובית” שאני לא אוהב אז אני אדבוק כאן בשמות הקצרים יותר. סיימנו מהר את הדיון הכואב על הטרמינולוגיה ואפשר לעבור לדבר על מה זה בכלל.&lt;/p&gt;

&lt;p&gt;נקודת מוצא טובה לנושא היא המושג של &lt;strong&gt;מכפלה פנימית&lt;/strong&gt;. כזכור, יש לנו מרחב וקטורי &lt;span&gt;\( V \)&lt;/span&gt; מעל שדה &lt;span&gt;\( \mathbb{F} \)&lt;/span&gt; שהוא הממשיים או המרוכבים, ועליו אנחנו מגדירים פונקציה &lt;span&gt;\( \left\langle x,y\right\rangle :V\times V\to\mathbb{F} \)&lt;/span&gt; שמקיימת לכל &lt;span&gt;\( x,y \)&lt;/span&gt;:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( \left\langle x_{1}+x_{2},y\right\rangle =\left\langle x_{1},y\right\rangle +\left\langle x_{2},y\right\rangle  \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left\langle \lambda x,y\right\rangle =\lambda\left\langle x,y\right\rangle  \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left\langle x,y\right\rangle =\overline{\left\langle y,x\right\rangle } \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left\langle x,x\right\rangle \ge0 \)&lt;/span&gt; ושוויון מתקבל רק עבור &lt;span&gt;\( x=0 \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;אחד מהדברים שאוהבים לעשות באלגברה לינארית &lt;strong&gt;בכל מקום אפשרי&lt;/strong&gt; הוא לתרגם את השפה האבסטרקטית יחסית של “מרחבים” ו”טרנספורמציות” עליהם לשפה הקונקרטית בהרבה של &lt;strong&gt;מטריצות&lt;/strong&gt;. הטריק הוא לבחור בסיס למרחב, ואז להסתכל לא על וקטורים אלא על &lt;strong&gt;הקואורדינטות&lt;/strong&gt; שלהם, שהם איברים של &lt;span&gt;\( \mathbb{F}^{n} \)&lt;/span&gt; כש-&lt;span&gt;\( n \)&lt;/span&gt; הוא המימד של המרחב (אנחנו תמיד מניחים שהמרחב הוא ממימד סופי אחרת כל האלגברה הלינארית היא סיפור מסובך בהרבה) ולייצר טרנספורמציות לינאריות עם מטריצות. דיברתי על כל זה &lt;a href=&quot;https://gadial.net/2011/10/27/coordinates_transformations_matrices/&quot;&gt;כאן&lt;/a&gt;, וזו הגישה שאאמץ מכאן ואילך.&lt;/p&gt;

&lt;p&gt;ראשית, כשעוברים לדבר על וקטורים, קל לתאר את מה שנקרא “המכפלה הפנימית הסטנדרטית” שמוגדרת בתור &lt;span&gt;\( \left\langle x,y\right\rangle =\sum_{i=1}^{n}x_{i}\overline{y}_{i} \)&lt;/span&gt;. הרעיון הוא שאם &lt;span&gt;\( x \)&lt;/span&gt; הוא וקטור עמודה, וגם &lt;span&gt;\( y \)&lt;/span&gt; היא וקטור עמודה, אז &lt;span&gt;\( y^{*} \)&lt;/span&gt; (מה שמתקבל מ-&lt;span&gt;\( y \)&lt;/span&gt; על ידי שחלוף והצמדה) היא וקטור &lt;strong&gt;שורה&lt;/strong&gt; ולכן הכפל &lt;span&gt;\( y^{*}x \)&lt;/span&gt; הולך להחזיר לנו סקלר בודד, שעל פי הגדרת כפל מטריצות יקיים בדיוק &lt;span&gt;\( y^{*}x=\left\langle x,y\right\rangle  \)&lt;/span&gt;. אז ייצוג של המכפלה הפנימית הפשוטה ביותר בלשון איברים של &lt;span&gt;\( \mathbb{F}^{n} \)&lt;/span&gt; יש לנו.&lt;/p&gt;

&lt;p&gt;מה עם מכפלות פנימיות מסובכות יותר? מה שמתברר למרבה השמחה הוא שאפשר לחשוב עליהן בתור משהו שהוא &lt;strong&gt;כמעט&lt;/strong&gt; &lt;span&gt;\( y^{*}x \)&lt;/span&gt;, בהבדל שלא כופלים את &lt;span&gt;\( y^{*} \)&lt;/span&gt; ב-&lt;span&gt;\( x \)&lt;/span&gt; אלא בתוצאה של הפעלת &lt;strong&gt;טרנספורמציה לינארית&lt;/strong&gt; על &lt;span&gt;\( x \)&lt;/span&gt;. כלומר לוקחים מטריצה &lt;span&gt;\( A \)&lt;/span&gt; ומסתכלים על הפונקציה &lt;span&gt;\( f\left(x,y\right)=y^{*}Ax \)&lt;/span&gt;. מה זה משיג לנו?&lt;/p&gt;

&lt;p&gt;ובכן, היופי במושג הלא טריוויאלי של כפל מטריצות הוא האופן היפה שבו הוא תופס את תכונת &lt;strong&gt;הלינאריות&lt;/strong&gt; של טרנספורמציות לינאריות. מתקיים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A\left(x_{1}+x_{2}\right)=Ax_{1}+Ax_{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A\left(\lambda x\right)=\lambda Ax \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;משני אלו נקבל מיידית:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( f\left(x_{1}+x_{2},y\right)=y^{*}A\left(x_{1}+x_{2}\right)=y^{*}Ax_{1}+y^{*}Ax_{2}=f\left(x_{1},y\right)+f\left(x_{2},y\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( f\left(\lambda x,y\right)=y^{*}A\left(\lambda x\right)=\lambda y^{*}Ax=\lambda f\left(x,y\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר - עצם השימוש במטריצה &lt;span&gt;\( A \)&lt;/span&gt; - &lt;strong&gt;כל מטריצה&lt;/strong&gt; מסדר &lt;span&gt;\( n\times n \)&lt;/span&gt; - כבר נותן לי את שתי התכונות הראשונות של מכפלה פנימית. אבל מה הדרישות הנוספות שיתנו לי את שתי התכונות הבאות? אלו בדיוק הדרישות שיהפכו את &lt;span&gt;\( A \)&lt;/span&gt; מסתם מטריצה למה שאני קורא לו &lt;strong&gt;מטריצה חיובית לחלוטין&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;ראשית, התכונה &lt;span&gt;\( \left\langle x,y\right\rangle =\overline{\left\langle y,x\right\rangle } \)&lt;/span&gt; (“הרמיטיות”). כשמנסחים את זה בלשון המטריציונית שלנו, זה אומר שצריך להתקיים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( y^{*}Ax=\overline{\left(x^{*}Ay\right)} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מכיוון שקצת קשה לראות איך להכניס את אופרטור ההצמדה פנימה, בואו נעבור לדבר על איברים בודדים. אם פותחים את הגדרות הכפל, &lt;span&gt;\( y^{*}Ax \)&lt;/span&gt; הוא הסקלר הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( y^{*}Ax=\sum_{j=1}^{n}\overline{y_{j}}\left(\sum_{i=1}^{n}A_{ij}x_{i}\right)=\sum_{i,j=1}^{n}A_{ij}x_{i}\overline{y_{j}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;את &lt;strong&gt;זה&lt;/strong&gt; קל להצמיד:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \overline{\sum_{i,j=1}^{n}A_{ij}x_{i}\overline{y_{j}}}=\sum_{i,j=1}^{n}\overline{A_{ij}}\overline{x_{i}}y_{j}=x^{*}A^{*}y \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובאופן דומה, &lt;span&gt;\( \overline{\left(x^{*}Ay\right)}=y^{*}A^{*}x \)&lt;/span&gt;, כך שהשוויון למעלה מתורגם אל &lt;span&gt;\( y^{*}Ax=y^{*}A^{*}x \)&lt;/span&gt;. מכיוון שהוא נכון &lt;strong&gt;לכל&lt;/strong&gt; &lt;span&gt;\( x,y \)&lt;/span&gt; הוא יהיה נכון בפרט עבור וקטורי יחידה, ומכך נקבל בסופו של דבר ש-&lt;span&gt;\( A=A^{*} \)&lt;/span&gt;. כלומר, כדי שתכונת ההרמיטיות תתקיים, אז &lt;span&gt;\( A \)&lt;/span&gt; צריכה להיות, אה, הרמיטית. או כמו שאני בדרך כלל קורא לזה, צמודה לעצמה.&lt;/p&gt;

&lt;p&gt;זה משאיר אותנו עם התכונה האחרונה. אם &lt;span&gt;\( x=0 \)&lt;/span&gt; אז &lt;span&gt;\( x^{*}Ax=0 \)&lt;/span&gt; תמיד, לא משנה מה &lt;span&gt;\( A \)&lt;/span&gt;, כך שהתכונה שמעניינת אותנו היא שיתקיים &lt;span&gt;\( x^{*}Ax&amp;gt;0 \)&lt;/span&gt; לכל &lt;span&gt;\( x\ne0 \)&lt;/span&gt;. למטריצה צמודה לעצמה &lt;span&gt;\( A \)&lt;/span&gt; שמקיימת &lt;strong&gt;גם&lt;/strong&gt; את התכונה הזו קוראים &lt;strong&gt;מטריצה חיובית לחלוטין &lt;/strong&gt;(או “מוגדרת חיובית” או Positive Definite). אם מחלישים את הדרישה ורק דורשים &lt;span&gt;\( x^{*}Ax\ge0 \)&lt;/span&gt; מקבלים את מה שנקרא &lt;strong&gt;מטריצה חיובית&lt;/strong&gt; (או “מוגדרת אי שלילית” או Positve Semidefinite).&lt;/p&gt;

&lt;p&gt;זו המוטיבציה להגדרה וההגדרה עצמה, אבל עכשיו בואו נראה כמה דרכים נוספות להסתכל על זה.&lt;/p&gt;

&lt;h2&gt;אפיונים שקולים של מטריצות חיוביות&lt;/h2&gt;

&lt;p&gt;ראשית, ערכים עצמיים. אנחנו כבר יודעים שאם &lt;span&gt;\( A \)&lt;/span&gt; היא מטריצה צמודה לעצמה, אז הערכים העצמיים שלה הם &lt;strong&gt;ממשיים&lt;/strong&gt; (הראיתי את זה למשל &lt;a href=&quot;https://gadial.net/2025/09/06/unitary_diagonalization/&quot;&gt;כאן&lt;/a&gt;), אבל אם היא חיובית אפשר לומר יותר מזה. נניח ש-&lt;span&gt;\( Ax=\lambda x \)&lt;/span&gt; עבור &lt;span&gt;\( x\ne0 \)&lt;/span&gt;, אז &lt;span&gt;\( x^{*}Ax=x^{*}\lambda x=\lambda\cdot\sum_{i=1}^{n}x_{i}\overline{x_{i}}=\lambda\cdot\sum\left|x_{i}\right|^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, &lt;span&gt;\( x^{*}Ax \)&lt;/span&gt; היא &lt;span&gt;\( \lambda \)&lt;/span&gt; כפול מספר חיובי כלשהו (הוא לא אפס כי &lt;span&gt;\( x\ne0 \)&lt;/span&gt; אז לפחות אחד המחוברים יהיה גדול מאפס). הדרישה &lt;span&gt;\( x^{*}Ax&amp;gt;0 \)&lt;/span&gt; מכתיבה שיתקיים גם &lt;span&gt;\( \lambda&amp;gt;0 \)&lt;/span&gt;, כלומר &lt;strong&gt;הערכים העצמיים של מטריצה חיובית הם חיוביים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;מה שנחמד הוא שגם הכיוון השני נכון - מטריצה צמודה לעצמה שכל הערכים העצמיים שלה הם חיוביים היא חיובית לחלוטין. במבט ראשון לא ברור לי איך להראות דבר כזה - ערכים עצמיים הם הרי דבר חמקמק, לכו תמצאו אותם, וגם כשמוצאים אותם לא בטוח שנמצא מספיק וקטורים עצמיים כדי לעשות עם זה משהו מעניין - אבל אני שוכח בזה שהנחתי שהמטריצה היא &lt;strong&gt;צמודה לעצמה&lt;/strong&gt;. מרגע שמטריצה היא צמודה לעצמה, אז כמו&lt;a href=&quot;https://gadial.net/2025/09/06/unitary_diagonalization/&quot;&gt; שהראיתי ממש לא מזמן&lt;/a&gt;, היא ניתנת ללכסון אוניטרי. ולכסון אוניטרי הוא דבר חזק. זה אומר שאפשר לכתוב את &lt;span&gt;\( A \)&lt;/span&gt; בתור &lt;span&gt;\( A=UDU^{*} \)&lt;/span&gt; כך ש-&lt;span&gt;\( D \)&lt;/span&gt; אלכסונית ולכן כל הערכים העצמיים &lt;span&gt;\( \left\{ \lambda_{1},\ldots,\lambda_{n}\right\}  \)&lt;/span&gt; כתובים בה יפה, ואילו &lt;span&gt;\( U \)&lt;/span&gt; הוא אוניטרית (&lt;span&gt;\( UU^{*}=I \)&lt;/span&gt;) כלומר העמודות שלה הן בסיס אורתונורמלי &lt;span&gt;\( \left\{ v_{1},\ldots,v_{n}\right\}  \)&lt;/span&gt; של וקטורים עצמיים (את כל זה הסברתי בפוסט הקודם). אז מה שאפשר לעשות הוא לקחת וקטור &lt;span&gt;\( x\ne0 \)&lt;/span&gt; &lt;strong&gt;כלשהו&lt;/strong&gt; ולכתוב אותו בתור צירוף לינארי של הוקטורים העצמיים: &lt;span&gt;\( x=\sum_{i=1}^{n}\alpha_{i}v_{i} \)&lt;/span&gt;. לכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Ax=A\left(\sum_{i=1}^{n}\alpha_{i}v_{i}\right)=\sum_{i=1}^{n}\alpha_{i}Av_{i}=\sum_{i=1}^{n}\alpha_{i}\lambda_{i}v_{i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, מה שמעניין אותנו הוא &lt;span&gt;\( x^{*}Ax \)&lt;/span&gt;, וכפי שאמרתי כבר, &lt;span&gt;\( x^{*}Ax=\left\langle Ax,x\right\rangle  \)&lt;/span&gt; כשזו המכפלה הפנימית הסטנדרטית - וכשאני אומר שהעמודות של &lt;span&gt;\( U \)&lt;/span&gt; הן &lt;strong&gt;אורתונורמליות&lt;/strong&gt; הכוונה היא ביחס למכפלה הפנימית הסטנדרטית, כלומר &lt;span&gt;\( \left\langle v_{i},v_{j}\right\rangle =\delta_{ij} \)&lt;/span&gt;. אז בואו נחשב!&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x^{*}Ax=\left\langle Ax,x\right\rangle =\left\langle \sum_{i=1}^{n}\alpha_{i}\lambda_{i}v_{i},\sum_{j=1}^{n}\alpha_{i}v_{i}\right\rangle = \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\sum_{i,j=1}^{n}\left\langle \alpha_{i}\lambda_{i}v_{i},\alpha_{j}v_{j}\right\rangle =\sum_{i,j=1}^{n}\lambda_{i}\alpha_{i}\overline{\alpha_{j}}\left\langle v_{i},v_{j}\right\rangle = \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\sum_{i,j=1}^{n}\lambda_{i}\alpha_{i}\overline{\alpha_{j}}\delta_{ij}=\sum_{i=1}^{n}\lambda_{i}\left|\alpha_{i}\right|^{2}&amp;gt;0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשהמעבר האחרון נובע מכך שקיבלנו סכום שכל המחוברים בו הם מכפלה &lt;span&gt;\( \lambda_{i}\left|\alpha_{i}\right|^{2} \)&lt;/span&gt; של מספרים אי שליליים, &lt;span&gt;\( \lambda_{i}&amp;gt;0 \)&lt;/span&gt; תמיד וקיים &lt;span&gt;\( \alpha_{i} \)&lt;/span&gt; כך ש-&lt;span&gt;\( \left|\alpha_{i}\right|^{2}&amp;gt;0 \)&lt;/span&gt; כי &lt;span&gt;\( x\ne0 \)&lt;/span&gt; (ולכן בצירוף הלינארי שנותן אותו לא כל המקדמים יכולים להיות 0). זה מסיים את ההוכחה! ושימו לב שאנחנו מקבלים באותה צורה משפט שאומר שמטריצה צמודה לעצמה שכל הערכים העצמיים שלה הם אי שליליים היא חיובית (לאו דווקא חיובית לחלוטין) פשוט כי במעבר האחרון נוכל להבטיח רק &lt;span&gt;\( \ge0 \)&lt;/span&gt; ולא &lt;span&gt;\( &amp;gt;0 \)&lt;/span&gt; (כי אמנם עדיין יש &lt;span&gt;\( \left|\alpha_{i}\right|^{2}&amp;gt;0 \)&lt;/span&gt; אבל ייתכן שעבורו &lt;span&gt;\( \lambda_{i}=0 \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;בואו נעבור עכשיו לתכונה אפילו עוד יותר מלהיבה! ראשית, בואו נסתכל על משהו מההוכחה האחרונה - היו לי מכפלות מהצורה &lt;span&gt;\( \alpha_{i}\overline{\alpha_{j}} \)&lt;/span&gt; של מספר מרוכב והצמוד שלו, והן הפכו להיות &lt;span&gt;\( \left|\alpha_{i}\right|^{2} \)&lt;/span&gt; - כלומר מספר ממשי חיובי. זו תכונה מוכרת במספרים מרוכבים, ומה שמלהיב הוא שהיא עובדת גם עם מטריצות. אם ניקח מטריצה &lt;span&gt;\( A \)&lt;/span&gt; &lt;strong&gt;כלשהי&lt;/strong&gt; ונסתכל על &lt;span&gt;\( B=AA^{*} \)&lt;/span&gt;, כלומר &lt;span&gt;\( A \)&lt;/span&gt; כפול הצמוד שלה, נקבל מטריצה &lt;span&gt;\( B \)&lt;/span&gt; שהיא חיובית.&lt;/p&gt;

&lt;p&gt;ההוכחה היא די פשוטה: ראשית, צריך להוכיח ש-&lt;span&gt;\( B \)&lt;/span&gt; צמודה לעצמה אבל הרי &lt;span&gt;\( B^{*}=\left(AA^{*}\right)^{*}=\left(A^{*}\right)^{*}A^{*}=AA^{*}=B \)&lt;/span&gt;, אז את זה יש לנו. שנית, צריך להראות שלכל &lt;span&gt;\( x \)&lt;/span&gt; מתקיים &lt;span&gt;\( x^{*}Bx\ge0 \)&lt;/span&gt;, ומתקיים &lt;span&gt;\( x^{*}Bx=x^{*}AA^{*}x=\left(A^{*}x\right)^{*}A^{*}x=\left\langle A^{*}x,A^{*}x\right\rangle \ge0 \)&lt;/span&gt; כי מכפלה פנימית של איבר בעצמו היא תמיד אי-שלילית. יותר מכך - היא שווה אפס רק עבור אפס, כלומר רק אם &lt;span&gt;\( A^{*}x=0 \)&lt;/span&gt;. עכשיו, בהחלט ייתכן ש-&lt;span&gt;\( A^{*}x=0 \)&lt;/span&gt; אם &lt;span&gt;\( x\ne0 \)&lt;/span&gt;, אבל אנחנו יודעים שדבר כזה קורה אם ורק אם &lt;span&gt;\( A^{*} \)&lt;/span&gt; &lt;strong&gt;סינגולרית&lt;/strong&gt;, כלומר לא הפיכה. אנחנו גם יודעים ש-&lt;span&gt;\( A^{*} \)&lt;/span&gt; הפיכה אם ורק אם &lt;span&gt;\( A \)&lt;/span&gt; הפיכה. במילים אחרות, אם &lt;span&gt;\( A \)&lt;/span&gt; כן הפיכה אז &lt;span&gt;\( AA^{*} \)&lt;/span&gt; היא &lt;strong&gt;חיובית לחלוטין&lt;/strong&gt;, מה שאנלוגי לכך ש-&lt;span&gt;\( \alpha_{i}\overline{\alpha_{j}}&amp;gt;0 \)&lt;/span&gt; אלא אם &lt;span&gt;\( \alpha_{i}=0 \)&lt;/span&gt; כלומר אם &lt;span&gt;\( \alpha_{i} \)&lt;/span&gt; הוא המספר המרוכב הלא-הפיך היחיד שקיים.&lt;/p&gt;

&lt;p&gt;עוד יותר מעניין שגם הכיוון השני נכון: אם &lt;span&gt;\( B \)&lt;/span&gt; היא חיובית, אז אפשר לפרק אותה ל-&lt;span&gt;\( B=AA^{*} \)&lt;/span&gt;. כאן אנחנו צריכים כלי כבד יותר, שלמרבה המזל כבר יש לנו: מכיוון ש-&lt;span&gt;\( B \)&lt;/span&gt; חיובית היא צמודה לעצמה, ולכן ניתנת ללכסון אוניטרי, כלומר &lt;span&gt;\( B=UDU^{*} \)&lt;/span&gt; כאשר &lt;span&gt;\( D \)&lt;/span&gt; אלכסונית ו-&lt;span&gt;\( U \)&lt;/span&gt; אוניטרית. יותר מזה: האלכסון של &lt;span&gt;\( B \)&lt;/span&gt; כולל את הערכים העצמיים של &lt;span&gt;\( B \)&lt;/span&gt;, וכבר ראינו שהם כולם &lt;strong&gt;אי-שליליים&lt;/strong&gt;, אז אפשר להוציא לכולם שורש, וזה מאפשר להוציא שורש ל-&lt;span&gt;\( D \)&lt;/span&gt; בעצמה.&lt;/p&gt;

&lt;p&gt;בואו נראה את זה במפורש: נסמן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( D=\left(\begin{array}{cccc} \lambda_{1}\\  &amp;amp; \lambda_{2}\\  &amp;amp;  &amp;amp; \ddots\\  &amp;amp;  &amp;amp;  &amp;amp; \lambda_{n} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואז נגדיר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sqrt{D}=\left(\begin{array}{cccc} \sqrt{\lambda_{1}}\\  &amp;amp; \sqrt{\lambda_{2}}\\  &amp;amp;  &amp;amp; \ddots\\  &amp;amp;  &amp;amp;  &amp;amp; \sqrt{\lambda_{n}} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;שימו לב: כאן לכתוב &lt;span&gt;\( \sqrt{D} \)&lt;/span&gt; זה סתם סימון, אבל השורשים שמופיעים על האיברים שעל האלכסון הם “אמיתיים”, כלומר הפעלה של פונקציית השורש הרגילה על מספרים ממשיים אי-שליליים. הסימון הזה מוצדק כי כשכופלים שתי מטריצות אלכסוניות, מקבלים מטריצה אלכסונית שהאלכסון שלה הוא מכפלה איבר-איבר של האלכסונים של המטריצות המוכפלות. כלומר &lt;span&gt;\( \sqrt{D}\cdot\sqrt{D}=D \)&lt;/span&gt;. זה מאפשר לנו לכתוב:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B=U\sqrt{D}\sqrt{D}U^{*} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( \sqrt{D} \)&lt;/span&gt; היא מטריצה שכל אבריה ממשיים והיא אלכסונית, כך ש-&lt;span&gt;\( \sqrt{D}=\left(\sqrt{D}\right)^{*} \)&lt;/span&gt;, אז קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B=\left(U\sqrt{D}\right)\left(U\sqrt{D}\right)^{*} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, &lt;span&gt;\( A=U\sqrt{D} \)&lt;/span&gt; היא המטריצה שחיפשנו. עכשיו, אם &lt;span&gt;\( B \)&lt;/span&gt; לא הייתה סתם חיובית אלא חיובית לחלוטין, אז אין לה ערך עצמי 0, ולכן &lt;span&gt;\( \sqrt{D} \)&lt;/span&gt; היא מטריצה הפיכה, וכשמכפילים אותה ב-&lt;span&gt;\( U \)&lt;/span&gt; ההפיכה מקבלים מטריצה הפיכה - כך שהמסקנה היא שבפירוק &lt;span&gt;\( B=AA^{*} \)&lt;/span&gt;, נקבל ש-&lt;span&gt;\( A \)&lt;/span&gt; הפיכה אם ורק אם &lt;span&gt;\( B \)&lt;/span&gt; חיובית לחלוטין.&lt;/p&gt;

&lt;h2&gt;השורש החיובי של מטריצה חיובית&lt;/h2&gt;

&lt;p&gt;דבר אחד שצריך לשים לב אליו עם הפירוק שמצאנו עכשיו הוא שהפירוק הזה &lt;strong&gt;אינו יחיד&lt;/strong&gt;, כי כשעושים לכסון אוניטרי יש הרבה דרכים לבנות את המטריצה &lt;span&gt;\( U \)&lt;/span&gt; - יש לנו את מרחב הוקטורים העצמיים, ואנחנו מוצאים לו בסיס אורתונורמלי ספציפי (ומסדרים אותו כך שהוקטורים העצמיים מתאימים לסדר שבו הערכים העצמיים מופיעים ב-&lt;span&gt;\( D \)&lt;/span&gt;). זה מתאים לאופן שבו אם אנחנו לוקחים מספר ממשי &lt;span&gt;\( x\ge0 \)&lt;/span&gt;, יש הרבה מספרים מרוכבים &lt;span&gt;\( z \)&lt;/span&gt; כך ש-&lt;span&gt;\( z\overline{z}=x \)&lt;/span&gt;. מה שנכון הוא שקיים רק מספר יחיד &lt;span&gt;\( y \)&lt;/span&gt; כך ש-&lt;span&gt;\( y\overline{y}=x \)&lt;/span&gt; אם מגבילים את &lt;span&gt;\( y \)&lt;/span&gt; כך שיהיה ממשי אי-שלילי בעצמו: &lt;span&gt;\( y\ge0 \)&lt;/span&gt;, ובמקרה הזה מכיוון ש-&lt;span&gt;\( y \)&lt;/span&gt; ממשי, &lt;span&gt;\( \overline{y}=y \)&lt;/span&gt; ולכן נקבל &lt;span&gt;\( y^{2}=x \)&lt;/span&gt;. ל-&lt;span&gt;\( y \)&lt;/span&gt; הזה יש סימון: &lt;span&gt;\( \sqrt{x} \)&lt;/span&gt;. במילים אחרות, אמרנו את הדבר הטריוויאלי שכולנו יודעים - למספר ממשי אי שלילי קיים ויחיד שורש אי שלילי.&lt;/p&gt;

&lt;p&gt;העניין הוא שזה נכון גם למטריצות. אם &lt;span&gt;\( B \)&lt;/span&gt; חיובית, אז קיימת מטריצה &lt;span&gt;\( \sqrt{B} \)&lt;/span&gt; &lt;strong&gt;חיובית יחידה&lt;/strong&gt; כך ש-&lt;span&gt;\( \left(\sqrt{B}\right)^{2}=B \)&lt;/span&gt;. בואו נוכיח את זה.&lt;/p&gt;

&lt;p&gt;למצוא את &lt;span&gt;\( \sqrt{B} \)&lt;/span&gt; זה יחסית קל. ראינו קודם שאפשר לקחת לכסון אוניטרי &lt;span&gt;\( B=UDU^{*} \)&lt;/span&gt; ואז להגדיר &lt;span&gt;\( A=U\sqrt{D} \)&lt;/span&gt; ויתקיים &lt;span&gt;\( AA^{*}=B \)&lt;/span&gt;; בצורה הזו מקבלים שלל מטריצות שונות. אבל אפשר גם להגדיר &lt;span&gt;\( A=U\sqrt{D}U^{*} \)&lt;/span&gt;, ומה יקרה אז? נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( AA=\left(U\sqrt{D}U^{*}\right)\left(U\sqrt{D}U^{*}\right)=U\sqrt{D}\left(U^{*}U\right)\sqrt{D}U^{*}= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =U\sqrt{D}\sqrt{D}U^{*}=UDU^{*}=B \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אה-הא! קיבלנו שורש של &lt;span&gt;\( B \)&lt;/span&gt;! יותר מכך, אנחנו יודעים שיש לשורש הזה לכסון אוניטרי, הרי מזה התחלנו: &lt;span&gt;\( U\sqrt{D}U^{*} \)&lt;/span&gt;. מכיוון ש-&lt;span&gt;\( \sqrt{D} \)&lt;/span&gt; היא מטריצה אלכסונית עם מספרים ממשיים אי-שליליים על האלכסון אנחנו יודעים ש-&lt;span&gt;\( A \)&lt;/span&gt; היא צמודה לעצמה (אפשר גם פשוט לחשב את &lt;span&gt;\( A^{*} \)&lt;/span&gt; ולראות מה קורה) ושהיא חיובית. אז החלק של ה”קיום” היה קל. מה עם החלק של ה”יחידות”?&lt;/p&gt;

&lt;p&gt;קודם, כשהגדרנו &lt;span&gt;\( A=U\sqrt{D} \)&lt;/span&gt;, המטריצה &lt;span&gt;\( \sqrt{D} \)&lt;/span&gt; הייתה קבועה אבל היה לנו חופש גדול לבחור את &lt;span&gt;\( U \)&lt;/span&gt; - זה היה בסיס אורתונורמלי כלשהו למרחב הוקטורים העצמיים של &lt;span&gt;\( B \)&lt;/span&gt;, עד כדי הסדר שבו אברי הבסיס מופיעים שכן נקבע על ידי &lt;span&gt;\( D \)&lt;/span&gt;. כאן לכאורה עדיין יש לנו חופש כזה כשמגדירים את &lt;span&gt;\( A=U\sqrt{D}U^{*} \)&lt;/span&gt; אלא שהפעם הכפל הנוסף ב-&lt;span&gt;\( U^{*} \)&lt;/span&gt; “מבטל” את החופש הזה - אנחנו תמיד נקבל את אותה מטריצה. אלא שזה נפנוף ידיים, לא נימוק רציני; ונימוק רציני צריך גם לטפל בשאלה המהותית יותר, האם יש דרכים &lt;strong&gt;אחרות&lt;/strong&gt; לקבל שורש חיובי של &lt;span&gt;\( B \)&lt;/span&gt; שלא חשבנו עליהן. אז הנה הוכחה רצינית יותר, אבל גם מסובכת יותר.&lt;/p&gt;

&lt;p&gt;האבחנה המרהיבה הראשונה היא שקיים פולינום &lt;span&gt;\( p\in\mathbb{R}\left[x\right] \)&lt;/span&gt; כך ש-&lt;span&gt;\( p\left(B\right)=\sqrt{B} \)&lt;/span&gt;. זה… מוזר, במבט ראשון. אנחנו חושבים על &lt;span&gt;\( \sqrt{B} \)&lt;/span&gt; בתור משהו שנמצא “נמוך יותר” מאשר &lt;span&gt;\( B \)&lt;/span&gt; במדד החזקות (הוא חזקת &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt;) בזמן שפולינום לוקח אותנו “גבוה יותר” (למשל, מעלה את &lt;span&gt;\( B \)&lt;/span&gt; בחזקת 2). אבל צריך לזכור שבמטריצות יש גבול כמה אפשר לעלות: &lt;strong&gt;הפולינום האופייני&lt;/strong&gt; של מטריצה תמיד מאפס אותה (זה משפט קיילי המילטון שהראיתי &lt;a href=&quot;https://gadial.net/2011/12/07/minimal_polynomial_and_cayley_hamillton/&quot;&gt;כאן&lt;/a&gt;) ואז אנחנו “מתחילים מהתחלה”. עדיין, בואו נראה את הפלא קורה. ראשית, אני מסמן את הערכים העצמיים השונים של &lt;span&gt;\( B \)&lt;/span&gt; ב-&lt;span&gt;\( \lambda_{1},\ldots,\lambda_{k} \)&lt;/span&gt;. עכשיו, אפשר לבנות פולינום שמקיים &lt;span&gt;\( p\left(\lambda_{i}\right)=\sqrt{\lambda_{i}} \)&lt;/span&gt;, כלומר על המספרים שהם הערכים העצמיים של &lt;span&gt;\( B \)&lt;/span&gt; מחזיר את השורש שלהם (זה לא פולינום שמקודד את פונקציית השורש באופן כללי; רק על הערכים הספציפיים הללו). הדרך הסטנדרטית לעשות את זה היא באמצעות &lt;strong&gt;אינטרפולציית לגראנז&apos;&lt;/strong&gt; שנותנת לנו בניה מפורשת של הפולינום; במקרה הנוכחי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( p\left(x\right)=\sum_{i=1}^{k}\prod_{j\ne i}\frac{x-\lambda_{j}}{\lambda_{i}-\lambda_{j}}\sqrt{\lambda_{i}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בתוך הפולינום הזה אפשר להציב &lt;strong&gt;מטריצות&lt;/strong&gt;, כמו שקורה בקיילי המילטון. אם נציב את &lt;span&gt;\( D \)&lt;/span&gt;, אז מכיוון ש-&lt;span&gt;\( D \)&lt;/span&gt; אלכסונית ומטריצות אלכסוניות סגורות לכפל וחיבור, שמתורגמים לפעולות ישירות על האלכסון, בסך הכל יתקיים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( p\left(D\right)=\left(\begin{array}{cccc} p\left(\lambda_{1}\right)\\  &amp;amp; p\left(\lambda_{2}\right)\\  &amp;amp;  &amp;amp; \ddots\\  &amp;amp;  &amp;amp;  &amp;amp; p\left(\lambda_{n}\right) \end{array}\right)=\left(\begin{array}{cccc} \sqrt{\lambda_{1}}\\  &amp;amp; \sqrt{\lambda_{2}}\\  &amp;amp;  &amp;amp; \ddots\\  &amp;amp;  &amp;amp;  &amp;amp; \sqrt{\lambda_{n}} \end{array}\right)=\sqrt{D} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו, אם נציב את &lt;span&gt;\( UDU^{*} \)&lt;/span&gt; ב-&lt;span&gt;\( p \)&lt;/span&gt; נקבל אפקט דומה: כי באופן כללי, &lt;span&gt;\( UXU^{*}\cdot UYU^{*}=UXYU^{*} \)&lt;/span&gt; ו-&lt;span&gt;\( UXU^{*}+UYU^{*}=U\left(X+Y\right)U^{*} \)&lt;/span&gt;, כלומר אפשר לעשות את החשבון תוך ששוכחים מה-&lt;span&gt;\( U \)&lt;/span&gt;-ים ולהחזיר אותם בסוף. אז&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( p\left(UDU^{*}\right)=Up\left(D\right)U^{*}=U\sqrt{D}U^{*}=\sqrt{B} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;לי אישית קשה להאמין בזה אז הנה דוגמת צעצוע כדי לשכנע את עצמי. ניקח מטריצה חיובית שהערכים העצמיים שלה הם 1,4,9 (כדי שהשורשים ייצאו נחמד), למשל &lt;span&gt;\( B=\left(\begin{array}{ccc} 5 &amp;amp; 4 &amp;amp; 0\\ 4 &amp;amp; 5 &amp;amp; 0\\ 0 &amp;amp; 0 &amp;amp; 4 \end{array}\right) \)&lt;/span&gt; (שימו לב שהיא סימטרית והיא &lt;strong&gt;חייבת&lt;/strong&gt; להיות סימטרית כדי להיות חיובית). עכשיו, אם מחשבים פולינום אינטרפולציה שמקיים &lt;span&gt;\( p\left(1\right)=1,p\left(4\right)=2,p\left(9\right)=3 \)&lt;/span&gt; מקבלים את&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( p\left(x\right)=\frac{-x^{2}+25x+36}{60} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה בפני עצמו מרגיש לי קסם, שפולינום שנראה ככה עובד כל כך יפה (נסו להציב!) אבל זה היופי בפולינומים. עכשיו, חישוב ישיר יראה לנו ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B^{2}=\left(\begin{array}{ccc} 41 &amp;amp; 40 &amp;amp; 0\\ 40 &amp;amp; 41 &amp;amp; 0\\ 0 &amp;amp; 0 &amp;amp; 16 \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 60p\left(B\right)=-B^{2}+25B+36I=\left(\begin{array}{ccc} 120 &amp;amp; 60 &amp;amp; 0\\ 60 &amp;amp; 120 &amp;amp; 0\\ 0 &amp;amp; 0 &amp;amp; 120 \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן: &lt;span&gt;\( A=\left(\begin{array}{ccc} 2 &amp;amp; 1 &amp;amp; 0\\ 1 &amp;amp; 2 &amp;amp; 0\\ 0 &amp;amp; 0 &amp;amp; 2 \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובאמת אם נחשב נקבל &lt;span&gt;\( A^{2}=B \)&lt;/span&gt;. קסם! יותר מזה, שימו לב שעשינו את הקסם הזה בלי להסתמך על אף &lt;span&gt;\( U \)&lt;/span&gt; בדרך; השתמשנו בפולינום האינטרפולציה &lt;span&gt;\( p \)&lt;/span&gt; שדרש רק את הידע על מהם הערכים העצמיים.&lt;/p&gt;

&lt;p&gt;אוקיי, זה היה מלהיב ממש (עבורי) אבל איך זה מקדם אותנו להוכחה שהשורש הוא יחיד? ובכן, בואו נניח שיש &lt;strong&gt;עוד&lt;/strong&gt; שורש, &lt;span&gt;\( C \)&lt;/span&gt;. כלומר, &lt;span&gt;\( A^{2}=C^{2}=B \)&lt;/span&gt;, וגם &lt;span&gt;\( C \)&lt;/span&gt; היא חיובית. אז מתקיים &lt;span&gt;\( A=p\left(B\right)=p\left(C^{2}\right) \)&lt;/span&gt;, וזה אומר ש-&lt;span&gt;\( A,C \)&lt;/span&gt; הן &lt;strong&gt;מתחלפות בכפל&lt;/strong&gt; כי אפשר לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( AC=p\left(C^{2}\right)C=Cp\left(C^{2}\right)=CA \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשההתחלפות באמצע נובעת מכך שכל מטריצה מתחלפת בכפל עם חזקות שלה. למה התחלפות זה מעניין? כי זה בדיוק מה שנדרש כדי ששתי מטריצות לכסינות יהיו &lt;strong&gt;לכסינות סימולטנית&lt;/strong&gt;, מה שהראיתי &lt;a href=&quot;https://gadial.net/2011/12/24/simultaneous_diagonalization/&quot;&gt;כאן&lt;/a&gt;. זה אומר שיש &lt;span&gt;\( P \)&lt;/span&gt; הפיכה ומטריצות אלכסוניות &lt;span&gt;\( D_{1},D_{2} \)&lt;/span&gt; כך ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A=PD_{1}P^{-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C=PD_{2}P^{-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ה”סימולטניות” מתבטאת בכך שזה אותו ה-&lt;span&gt;\( P \)&lt;/span&gt; לשתי המטריצות. אנחנו לא יודעים ש-&lt;span&gt;\( D_{1}=D_{2} \)&lt;/span&gt; אבל יהיה קל להוכיח את זה, כי &lt;span&gt;\( A^{2}=B=C^{2} \)&lt;/span&gt;, כלומר נקבל &lt;span&gt;\( PD_{1}^{2}P^{-1}=PD_{2}^{2}P^{-1} \)&lt;/span&gt; ומכאן ש-&lt;span&gt;\( D_{1}^{2}=D_{2}^{2} \)&lt;/span&gt;. בואו נראה מזה שהמטריצות המקוריות שוות.&lt;/p&gt;

&lt;p&gt;המטריצות המקוריות הן אלכסוניות, אז מספיק להסתכל על מה שקורה לאיבר אחד על האלכסון, נאמר האיבר במקום ה-&lt;span&gt;\( i \)&lt;/span&gt;. אם נסתכל על הכניסה במקום ה-&lt;span&gt;\( i \)&lt;/span&gt; על האלכסון בשתי המטריצות, נראה שם שני ערכים &lt;span&gt;\( \lambda_{1},\lambda_{2} \)&lt;/span&gt;. אם עכשיו נעלה את שתי המטריצות בריבוע, הערכים הללו יהפכו להיות &lt;span&gt;\( \lambda_{1}^{2},\lambda_{2}^{2} \)&lt;/span&gt; והשוויון &lt;span&gt;\( D_{1}^{2}=D_{2}^{2} \)&lt;/span&gt; אומר לנו ש-&lt;span&gt;\( \lambda_{1}^{2}=\lambda_{2}^{2} \)&lt;/span&gt;. עכשיו, אם &lt;span&gt;\( \lambda_{1},\lambda_{2} \)&lt;/span&gt; היו מספרים מרוכבים כלליים, השוויון הזה לא היה אומר שהם זהים (כי למשל ייתכן ש-&lt;span&gt;\( \lambda_{1}=-1,\lambda_{2}=1 \)&lt;/span&gt;) אבל אנחנו יודעים בדיוק מה יש ב-&lt;span&gt;\( D_{1},D_{2} \)&lt;/span&gt;; יש את השורשים של הערכים העצמיים של &lt;span&gt;\( B \)&lt;/span&gt;, כלומר מלכתחילה אלו היו מספרים ממשיים אי-שליליים, &lt;span&gt;\( \lambda_{1},\lambda_{2}\ge0 \)&lt;/span&gt;, לכן גם הריבועים שלהם הם מספרים ממשיים אי שליליים, ולמספרים ממשיים אי-שליליים יש שורש יחיד שהוא ממשי אי-שלילי כך ש-&lt;span&gt;\( \lambda_{1}=\lambda_{2} \)&lt;/span&gt; וסיימנו את ההוכחה.&lt;/p&gt;

&lt;h2&gt;פירוק פולארי&lt;/h2&gt;

&lt;p&gt;עכשיו, אחרי שראינו כמה תוצאות נחמדות שקשורות למטריצות חיוביות ואולי גם קיבלנו אינטואיציה כלשהי למה שהולך פה, אני רוצה לשים אצבע טיפה יותר על הדמיון שיש בין מטריצות ומספרים כאן.&lt;/p&gt;

&lt;p&gt;בואו ניזכר מה אנחנו יודעים על מרוכבים. כל מספר מרוכב &lt;span&gt;\( z\in\mathbb{C} \)&lt;/span&gt; הוא מהצורה &lt;span&gt;\( z=a+bi \)&lt;/span&gt; כאשר &lt;span&gt;\( a,b\in\mathbb{R} \)&lt;/span&gt;. זה נקרא &lt;strong&gt;ההצגה הקרטזית&lt;/strong&gt; של המספר. &lt;strong&gt;הצמדה&lt;/strong&gt; מוגדרת על ידי &lt;span&gt;\( \overline{z}=a-bi \)&lt;/span&gt;, כלומר זו הפעולה שמחליפה את &lt;span&gt;\( i \)&lt;/span&gt; ב-&lt;span&gt;\( -i \)&lt;/span&gt; (ומספר מרוכב &lt;span&gt;\( z \)&lt;/span&gt; הוא ממשי אם ורק אם &lt;span&gt;\( z=\overline{z} \)&lt;/span&gt;), ואפשר “לחלץ” את &lt;span&gt;\( a,b \)&lt;/span&gt; על ידי המשוואות &lt;span&gt;\( a=\frac{z+\overline{z}}{2},b=\frac{z-\overline{z}}{2i} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;בנוסף, לכל מספר מרוכב יש גם &lt;strong&gt;הצגה פולרית&lt;/strong&gt; (“קוטבית”) מהצורה &lt;span&gt;\( z=re^{i\theta} \)&lt;/span&gt;. בזמן שבהצגה קרטזית, &lt;span&gt;\( a,b \)&lt;/span&gt; הם הקואורדינטות של &lt;span&gt;\( z \)&lt;/span&gt; במישור המרוכב, בהצגה הקוטבית &lt;span&gt;\( r \)&lt;/span&gt; מייצג את &lt;strong&gt;המרחק&lt;/strong&gt; של &lt;span&gt;\( z \)&lt;/span&gt; מראשית הצירים ו-&lt;span&gt;\( \theta \)&lt;/span&gt; היא &lt;strong&gt;הזווית&lt;/strong&gt; של הקו מראשית הצירים אל &lt;span&gt;\( z \)&lt;/span&gt;. המספר &lt;span&gt;\( e^{i\theta} \)&lt;/span&gt; הוא מספר מרוכב מערך מוחלט 1, בזמן ש-&lt;span&gt;\( r\ge0 \)&lt;/span&gt; הוא מספר ממשי אי שלילי.&lt;/p&gt;

&lt;p&gt;כל הרעיונות הללו עוברים הישר אל מטריצות, כאשר “מספר מרוכב” מוחלף על ידי “מטריצה”, “מספר ממשי” מוחלף על ידי “מטריצה צמודה לעצמה”, “מספר אי שלילי” מוחלף על ידי “מטריצה חיובית” ו”הצמדה” מוחלף על ידי “הצמדה” (כלומר הפעולה &lt;span&gt;\( \overline{z} \)&lt;/span&gt; מוחלפת על ידי הפעולה &lt;span&gt;\( A^{*} \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;האנלוגיה די ברורה: אם &lt;span&gt;\( A=A^{*} \)&lt;/span&gt;, כלומר &lt;span&gt;\( A \)&lt;/span&gt; צמודה לעצמה, זה כמו &lt;span&gt;\( z=\overline{z} \)&lt;/span&gt; שמראה לנו ש-&lt;span&gt;\( z \)&lt;/span&gt; ממשי (אבל לאו דווקא חיובי). אפשר לייצג כל מטריצה &lt;span&gt;\( M \)&lt;/span&gt; בתור סכום &lt;span&gt;\( M=A+B \)&lt;/span&gt; כך ש-&lt;span&gt;\( A \)&lt;/span&gt; צמודה לעצמה ואילו &lt;span&gt;\( B \)&lt;/span&gt; היא &lt;strong&gt;אנטי&lt;/strong&gt;-צמודה לעצמה, כלומר &lt;span&gt;\( B^{*}=-B \)&lt;/span&gt; (כמו ש-&lt;span&gt;\( \overline{ib}=-ib \)&lt;/span&gt;). אפשר “לחלץ” את &lt;span&gt;\( A,B \)&lt;/span&gt; עם המשוואות &lt;span&gt;\( A=\frac{M+M^{*}}{2} \)&lt;/span&gt; ו-&lt;span&gt;\( B=\frac{M-M^{*}}{2} \)&lt;/span&gt; (קל לראות ש-&lt;span&gt;\( A^{*}=A \)&lt;/span&gt;ו-&lt;span&gt;\( B^{*}=-B \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;מה עם ההצגה הפולרית? ראינו קודם סיטואציה שבה היו לנו מטריצות מהצורה &lt;span&gt;\( B=U\sqrt{D} \)&lt;/span&gt;, כך ש-&lt;span&gt;\( AA^{*}=B \)&lt;/span&gt; עבור מטריצה חיובית &lt;span&gt;\( B \)&lt;/span&gt; מסוימת. זה בהחלט היה אנלוגי אל &lt;span&gt;\( z=re^{i\theta} \)&lt;/span&gt; שמקיים &lt;span&gt;\( z\overline{z}=r^{2} \)&lt;/span&gt;, כלומר איכשהו החלק של הסיבוב המרוכב נעלם. את המקום של &lt;span&gt;\( r\ge0 \)&lt;/span&gt; הממשי החליפה המטריצה &lt;span&gt;\( \sqrt{D} \)&lt;/span&gt; ואילו את הסיבוב &lt;span&gt;\( e^{i\theta} \)&lt;/span&gt; החליפה המטריצה &lt;span&gt;\( U \)&lt;/span&gt;. הדמיון מובהק: &lt;span&gt;\( e^{i\theta} \)&lt;/span&gt; הוא מנורמה 1, ואילו &lt;span&gt;\( U \)&lt;/span&gt; היא אוניטרית, מה שתואם את האינטואיציה של “נורמה 1” כי כפל של &lt;span&gt;\( U \)&lt;/span&gt; באיבר כלשהו משמר את הנורמה שלו כמו שכפל ב-1 משמר את הגודל של מספר ממשי (אפשר לתת לזה משמעות יותר קונקרטית; יש נורמה שמגדירים על מטריצות על ידי &lt;span&gt;\( \|A\|=\max_{x}\frac{\|Ax\|}{\|x\|} \)&lt;/span&gt; ובהגדרה הזו הנורמה של מטריצה אוניטרית היא 1).&lt;/p&gt;

&lt;p&gt;השאלה היא רק - האם זה קורה גם באופן כללי? האם לכל מטריצה &lt;span&gt;\( A \)&lt;/span&gt; יש “פירוק פולרי” &lt;span&gt;\( A=UB \)&lt;/span&gt; כך -&lt;span&gt;\( U \)&lt;/span&gt; אוניטרית ו-&lt;span&gt;\( B \)&lt;/span&gt; מטריצה חיובית? התשובה היא כן, אבל אני אחכה עם ההוכחה של זה לפוסט הבא. עדיין, אי אפשר לסיים בלי לפחות לומר מאיפה &lt;span&gt;\( B \)&lt;/span&gt; הזו מגיעה כי זה רק מחזק את האנלוגיה.&lt;/p&gt;

&lt;p&gt;אם יש לנו מספר ממשי &lt;span&gt;\( z \)&lt;/span&gt; ואנחנו רוצים למצוא את הייצוג שלו בתור &lt;span&gt;\( z=re^{i\theta} \)&lt;/span&gt;, זה קל: &lt;span&gt;\( r=\left|z\right|=\sqrt{a^{2}+b^{2}} \)&lt;/span&gt;, ואז אפשר למצוא את &lt;span&gt;\( e^{i\theta}=\frac{z}{r} \)&lt;/span&gt; (בשביל למצוא את &lt;span&gt;\( \theta \)&lt;/span&gt; עצמה צריך להתאמץ עוד טיפה). עכשיו, &lt;span&gt;\( \left|z\right|=\sqrt{z\cdot\overline{z}} \)&lt;/span&gt;, ואת זה אפשר לקחת ישירות למטריצות: כבר ראינו שבהינתן מטריצה &lt;span&gt;\( A \)&lt;/span&gt; &lt;strong&gt;כלשהי&lt;/strong&gt; מתקיים ש-&lt;span&gt;\( AA^{*} \)&lt;/span&gt; היא חיובית. ואם היא חיובית, אנחנו יודעים שיש לה שורש &lt;strong&gt;יחיד&lt;/strong&gt; שהוא חיובי, כלומר קיימת מטריצה חיובית יחידה &lt;span&gt;\( B \)&lt;/span&gt; כך ש-&lt;span&gt;\( B=\sqrt{AA^{*}} \)&lt;/span&gt;. אבל האם אפשר לקבל עכשיו את &lt;span&gt;\( U \)&lt;/span&gt; פשוט על ידי “חילוק”, &lt;span&gt;\( U=AB^{-1} \)&lt;/span&gt;? ובכן, לא - לא מובטח לנו ש-&lt;span&gt;\( B \)&lt;/span&gt; הפיכה בכלל. במקרה הזה אכן מה שיקרה הוא ש-&lt;span&gt;\( U \)&lt;/span&gt; לא תיקבע באופן יחיד. זה לא מקלקל לנו את האנלוגיה למספרים, כי עבור כל &lt;span&gt;\( r&amp;gt;0 \)&lt;/span&gt; המקרה המקביל הוא מטריצה חיובית לחלוטין, והיא כן הפיכה; המקרה היחיד שתואם מטריצה חיובית שהיא לא חיובית לחלוטין הוא &lt;span&gt;\( z=0 \)&lt;/span&gt; ובמקרה הזה באמת &lt;span&gt;\( e^{i\theta} \)&lt;/span&gt; לא נקבעת באופן יחיד בעצמה.&lt;/p&gt;

&lt;p&gt;יש כמובן עוד הרבה מה לומר על הנושאים הללו אבל נראה לי שאעצור כאן, בפרט כי יש לי את כל מה שאני צריך בשביל הפוסט הבא.&lt;/p&gt;</content><author><name></name></author><category term="מטריצות חיוביות" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">לכסון אוניטרי</title><link href="http://gadial.net/2025/09/06/unitary_diagonalization/" rel="alternate" type="text/html" title="לכסון אוניטרי" /><published>2025-09-06T00:00:00+00:00</published><updated>2025-09-06T00:00:00+00:00</updated><id>http://gadial.net/2025/09/06/unitary_diagonalization</id><content type="html" xml:base="http://gadial.net/2025/09/06/unitary_diagonalization/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;אני רוצה לטפל בפוסט הזה בחוב בן 12 שנים שיש לי בבלוג. בשעתו כתבתי סדרת פוסטים באלגברה לינארית &lt;a href=&quot;https://gadial.net/2013/04/27/adjoint_unitary_hermitian_matrices/&quot;&gt;שהאחרון שבהם&lt;/a&gt; הסתיים בהבטחה שאדבר על &lt;strong&gt;לכסון אוניטרי&lt;/strong&gt; ואז… פשוט לא כתבתי את הפוסט הזה? לא בטוח למה שכחתי, אבל עכשיו זה בהחלט זמן טוב לחזור לזה אז יאללה, בואו נראה את זה. זו תוצאה ממש נחמדה.&lt;/p&gt;

&lt;p&gt;אני &lt;strong&gt;לא&lt;/strong&gt; אזכיר את כל הקונטקסט - בשביל זה יש את סדרת הפוסטים שלי באלגברה לינארית - אבל בכל זאת בואו נתחיל עם תזכורת קטנה שאפשר לדלג מעליה מה אנחנו עושים כאן בכלל.&lt;/p&gt;

&lt;p&gt;ה”עולם” שלנו הוא מרחב וקטורי &lt;span&gt;\( V \)&lt;/span&gt; ממימד סופי, שהוא בנוסף גם &lt;strong&gt;מרחב מכפלה פנימית&lt;/strong&gt; (אני מסמן את המכפלה הפנימית ב-&lt;span&gt;\( \left\langle u,v\right\rangle  \)&lt;/span&gt;). זה אומר שהמרחב הוא מעל הממשיים &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt; או מעל המרוכבים &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; - ובפוסט הזה שני המקרים הללו לא יהיו זהים. בפוסטים הקודמים בסדרה ראינו את המושג של אופרטור&lt;strong&gt; צמוד הרמיטית&lt;/strong&gt;: אם &lt;span&gt;\( T:V\to V \)&lt;/span&gt; היה אופרטור מעל &lt;span&gt;\( V \)&lt;/span&gt;, אז הראינו שקיים ויחיד אופרטור שמסומן &lt;span&gt;\( T^{*}:V\to V \)&lt;/span&gt;, שנקרא “הצמוד ההרמיטי” שלו (לרוב אני אוותר על ה”הרמיטי”) כך שמתקיים &lt;span&gt;\( \left\langle T\left(v\right),u\right\rangle =\left\langle v,T^{*}\left(u\right)\right\rangle  \)&lt;/span&gt; לכל &lt;span&gt;\( v,u\in V \)&lt;/span&gt;. בעזרת המושג הזה אפשר להגדיר עוד שני סוגים נחמדים במיוחד של אופרטורים:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;אופרטור &lt;span&gt;\( T \)&lt;/span&gt; הוא &lt;strong&gt;צמוד לעצמו&lt;/strong&gt; אם &lt;span&gt;\( T=T^{*} \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;אופרטור &lt;span&gt;\( T \)&lt;/span&gt; הוא &lt;strong&gt;אוניטרי&lt;/strong&gt; אם &lt;span&gt;\( T^{-1}=T^{*} \)&lt;/span&gt;.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;לפעמים משתמשים ב”הרמיטי” במקום “צמוד לעצמו”, אבל אני מעדיף את צמוד לעצמו כי “הרמיטי” זה משהו שנהוג לומר רק כשאנחנו מעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; ואם אנחנו מעל &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt; אומרים “סימטרי” ו”צמוד לעצמו” מכסה את שני המקרים בצורה נוחה.&lt;/p&gt;

&lt;p&gt;אני מגדיר הגדרה דומה עבור מטריצות: אם &lt;span&gt;\( A \)&lt;/span&gt; היא מטריצה, אז &lt;span&gt;\( A^{*} \)&lt;/span&gt; מוגדרת להיות המטריצה שמתקבלת משילוב של שתי פעולות, &lt;strong&gt;שחלוף&lt;/strong&gt; של &lt;span&gt;\( A \)&lt;/span&gt; (החלפת השורות בעמודות) ו&lt;strong&gt;הצמדה&lt;/strong&gt; של הכניסות של &lt;span&gt;\( A \)&lt;/span&gt;, במובן הרגיל של הצמדה של מספרים מרוכבים שבו &lt;span&gt;\( \overline{z}=\overline{a+bi}=a-bi \)&lt;/span&gt;. במילים אחרות, &lt;span&gt;\( A_{ij}^{*}=\overline{A_{ji}} \)&lt;/span&gt;. עם ההגדרה הזו, מטריצה &lt;span&gt;\( A \)&lt;/span&gt; הוא הרמיטית אם &lt;span&gt;\( A=A^{*} \)&lt;/span&gt; והיא אוניטרית אם &lt;span&gt;\( A^{-1}=A^{*} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;דיברנו על אופרטורים ומטריצות, בואו נדבר גם על וקטורים. כשיש לי מכפלה פנימית על מרחב, אני יכול להכניס לתמונה מושגים חדשים על וקטורים: &lt;strong&gt;אורך&lt;/strong&gt; ו&lt;strong&gt;זווית&lt;/strong&gt;. השימוש שלי בזווית כאן הוא פשוט: אני אומר ששני וקטורים &lt;span&gt;\( u,v \)&lt;/span&gt; הם &lt;strong&gt;אורתוגונליים&lt;/strong&gt; (“ניצבים” - אינטואיטיבית, הם בזווית של 90 מעלות זה לזה) אם &lt;span&gt;\( \left\langle u,v\right\rangle =0 \)&lt;/span&gt;. אני גם מסמן את &lt;strong&gt;הנורמה&lt;/strong&gt; של וקטור (“האורך” שלו) ב-&lt;span&gt;\( \|v\|=\sqrt{\left\langle v,v\right\rangle } \)&lt;/span&gt;. מה שאוהבים מאוד באלגברה לינארית הם בסיסים &lt;strong&gt;אורתונורמליים&lt;/strong&gt; של &lt;span&gt;\( V \)&lt;/span&gt;: בסיס &lt;span&gt;\( \left\{ b_{1},\ldots,b_{n}\right\}  \)&lt;/span&gt; שהאיברים בו מקיימים &lt;span&gt;\( \left\langle b_{i},b_{j}\right\rangle =\delta_{ij}=\begin{cases} 1 &amp;amp; i=j\\ 0 &amp;amp; i\ne j \end{cases} \)&lt;/span&gt;, כלומר שכל האיברים בו הם מנורמה 1 ואורתוגונליים זה לזה. למה אלו בסיסים קסומים ונהדרים ונפלאים &lt;a href=&quot;https://gadial.net/2012/02/06/inner_products_intro/&quot;&gt;הסברתי בפעם אחרת&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, הנה קשר חמוד בין בסיסים אורתונורמליים ומטריצות אוניטריות. אם &lt;span&gt;\( A \)&lt;/span&gt; היא מטריצה אוניטרית מסדר &lt;span&gt;\( n\times n \)&lt;/span&gt;, כלומר &lt;span&gt;\( A^{*}=A^{-1} \)&lt;/span&gt;, אז בפרט &lt;span&gt;\( A^{*}A=I \)&lt;/span&gt;. בואו נסתכל על &lt;strong&gt;העמודות&lt;/strong&gt; של &lt;span&gt;\( A \)&lt;/span&gt; בתור וקטורים מאורך &lt;span&gt;\( n \)&lt;/span&gt; ונסמן אותם &lt;span&gt;\( v_{1},\ldots,v_{n} \)&lt;/span&gt;. על פי ההגדרה של &lt;a href=&quot;https://gadial.net/2011/10/06/matrix_product/&quot;&gt;כפל מטריצות&lt;/a&gt;, הכניסה ה-&lt;span&gt;\( i,j \)&lt;/span&gt; במכפלה &lt;span&gt;\( A^{*}A \)&lt;/span&gt; היא השורה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( A^{*} \)&lt;/span&gt; שמוכפלת סקלרית בעמודה &lt;span&gt;\( j \)&lt;/span&gt; של &lt;span&gt;\( A \)&lt;/span&gt;. והשורה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( A^{*} \)&lt;/span&gt; היא ההצמדה של העמודה ה-&lt;span&gt;\( i \)&lt;/span&gt; של &lt;span&gt;\( A \)&lt;/span&gt;, כלומר אנחנו מקבלים שהכניסה הזו שווה אל &lt;span&gt;\( \sum_{k=1}^{n}\left[\overline{v_{i}}\right]_{k}\left[v_{j}\right]_{k}=\left\langle v_{j},v_{i}\right\rangle  \)&lt;/span&gt; ומכיוון שהמכפלה נותנת לנו את מטריצת היחידה &lt;span&gt;\( I \)&lt;/span&gt; קיבלנו ש-&lt;span&gt;\( \left\langle v_{j},v_{i}\right\rangle =\delta_{i,j} \)&lt;/span&gt;. במילים אחרות: &lt;strong&gt;העמודות של מטריצה אוניטרית הן בסיס אורתונורמלי &lt;/strong&gt;(גם השורות, מאותו נימוק).&lt;/p&gt;

&lt;p&gt;אוקיי, סיימנו עם התזכורת, בואו ניגש לאקשן!&lt;/p&gt;

&lt;h2&gt;מה זה לכסון אוניטרי?&lt;/h2&gt;

&lt;p&gt;כשמתחילים ללמוד אלגברה לינארית, המושג של &lt;strong&gt;לכסון&lt;/strong&gt; הוא בדרך כלל אחד מהיעדים המרכזיים שמנסים להגיע אליהם. הרעיון הוא זה: אם יש לי מטריצה ריבועית &lt;span&gt;\( A \)&lt;/span&gt; מסדר &lt;span&gt;\( n\times n \)&lt;/span&gt;, אני רוצה למצוא מטריצה &lt;strong&gt;אלכסונית&lt;/strong&gt; &lt;span&gt;\( D \)&lt;/span&gt; ש-&lt;span&gt;\( A \)&lt;/span&gt; דומה לה. “דמיון” פירושו שקיימת מטריצה הפיכה &lt;span&gt;\( P \)&lt;/span&gt; כך ש-&lt;span&gt;\( P^{-1}AP=D \)&lt;/span&gt;. זה לא בא משום מקום; אם &lt;span&gt;\( A \)&lt;/span&gt; מייצגת טרנספורמציה לינארית &lt;span&gt;\( T \)&lt;/span&gt; (במובן שאני מתאר &lt;a href=&quot;https://gadial.net/2011/10/27/coordinates_transformations_matrices/&quot;&gt;כאן&lt;/a&gt;) אז דמיון אומר שגם &lt;span&gt;\( D \)&lt;/span&gt; מייצגת את &lt;span&gt;\( T \)&lt;/span&gt;, פשוט בבסיס אחר, ו-&lt;span&gt;\( P \)&lt;/span&gt; היא המטריצה שיודעת להעביר בין הבסיסים. אבל דמיון מטריצות הוא נחמד גם אם אין איזו טרנספורמציה לינארית ברקע; למשל, אם רוצים לחשב את החזקה של &lt;span&gt;\( A \)&lt;/span&gt; מהר, ואנחנו יודעים ש-&lt;span&gt;\( A \)&lt;/span&gt; דומה ל-&lt;span&gt;\( D \)&lt;/span&gt;, כלומר &lt;span&gt;\( A=PDP^{-1} \)&lt;/span&gt;, אז נשתמש בכך ש-&lt;span&gt;\( A^{n}=\left(PDP^{-1}\right)\cdots\left(PDP^{-1}\right)=PD^{n}P^{-1} \)&lt;/span&gt; (כל ה-&lt;span&gt;\( P \)&lt;/span&gt;-ים שבאמצע מבטלים זה את זה) ובכך שקל להעלות מטריצה אלכסונית בחזקה כלשהי (מעלים את האיברים על האלכסון בחזקה הזו) כדי לחשב מהר את החזקה של &lt;span&gt;\( A \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, אם &lt;span&gt;\( P^{-1}AP=D \)&lt;/span&gt; זה אומר ש-&lt;span&gt;\( AP=PD \)&lt;/span&gt;. מה זה &lt;span&gt;\( AP \)&lt;/span&gt;? אפשר לחשוב על זה בתור מטריצה שהעמודות שלה הן התוצאה של כפל של &lt;span&gt;\( A \)&lt;/span&gt; בעמודות של &lt;span&gt;\( P \)&lt;/span&gt;. ואילו &lt;span&gt;\( PD \)&lt;/span&gt;, כאשר &lt;span&gt;\( D \)&lt;/span&gt; אלכסונית, זו מטריצה שהעמודות שלה הן כפל של העמודות של &lt;span&gt;\( P \)&lt;/span&gt; באיברים על האלכסון של &lt;span&gt;\( D \)&lt;/span&gt; (העמודה הראשונה כפול האיבר הראשון וכן הלאה). במילים אחרות, העמודות של &lt;span&gt;\( P \)&lt;/span&gt; הן וקטורים &lt;span&gt;\( v_{i} \)&lt;/span&gt; שמקיימים &lt;span&gt;\( Av_{i}=\lambda_{i}v_{i} \)&lt;/span&gt;. לוקטורים כאלו קוראים &lt;strong&gt;וקטורים עצמיים&lt;/strong&gt; של &lt;span&gt;\( A \)&lt;/span&gt; ואילו &lt;span&gt;\( \lambda_{i} \)&lt;/span&gt; הם &lt;strong&gt;ערכים עצמיים&lt;/strong&gt; ואני מניח שכולנו מכירים את זה כבר.&lt;/p&gt;

&lt;p&gt;כאשר מלכסנים מטריצה, השיטה הבסיסית היא למצוא מהם הערכים העצמיים, בעזרת זה למצוא מהם הוקטורים העצמיים, ואז לבנות בעזרתם את &lt;span&gt;\( P \)&lt;/span&gt;. לרוע המזל, &lt;strong&gt;זה לא תמיד עובד&lt;/strong&gt;. כדי שנוכל לקבל את &lt;span&gt;\( P \)&lt;/span&gt; אנחנו צריכים שיהיו לנו &lt;span&gt;\( n \)&lt;/span&gt; וקטורים עצמיים בלתי תלויים, במרחב ממימד &lt;span&gt;\( n \)&lt;/span&gt; - כלומר, אנחנו צריכים למצוא &lt;strong&gt;בסיס למרחב&lt;/strong&gt; שיהיה מורכב כולו מוקטורים עצמיים של &lt;span&gt;\( A \)&lt;/span&gt;. לא תמיד יש כאלו, ואין קריטריון פשוט על &lt;span&gt;\( A \)&lt;/span&gt; שאומר לנו מתי זה עובד (“הריבוי הגאומטרי שווה לריבוי האלגברי” זה לא קריטריון פשוט).&lt;/p&gt;

&lt;p&gt;אבל מה קורה עבור מרחבי מכפלה פנימית? כאן יש לנו מבנה נוסף על העולם, אולי זה מפשט את העניינים? ובכן, בערך: אם אנחנו מגדילים את הדרישה שלנו ורוצים לא סתם לכסון אלא לכסון שבו המטריצה המלכסנת היא &lt;strong&gt;אוניטרית&lt;/strong&gt;, כלומר אם אנחנו לא רוצים סתם בסיס של וקטורים עצמיים אלא בסיס &lt;strong&gt;אורתונורמלי&lt;/strong&gt; של וקטורים עצמיים, פתאום אנחנו מקבלים קריטריון מאוד קונקרטי ופשוט של אם ורק אם. זה משפט מרהיב לגמרי, והנה הוא:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( A \)&lt;/span&gt; לכסינה אוניטרית ב-&lt;span&gt;\( \mathbb{R}^{n} \)&lt;/span&gt; אם ורק אם &lt;span&gt;\( A=A^{*} \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( A \)&lt;/span&gt; לכסינה אוניטרית ב-&lt;span&gt;\( \mathbb{C}^{n} \)&lt;/span&gt; אם ורק אם &lt;span&gt;\( A^{*}A=AA^{*} \)&lt;/span&gt;.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;התכונה &lt;span&gt;\( A=A^{*} \)&lt;/span&gt; היא כזכור התכונה של להיות &lt;strong&gt;הרמיטי&lt;/strong&gt;, אבל כשאנחנו מעל &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt; כל פעולת ההצמדה לא עושה כלום, ולכן &lt;span&gt;\( A=A^{*} \)&lt;/span&gt; זו דרך אחרת לכתוב &lt;span&gt;\( A=A^{t} \)&lt;/span&gt; כש-&lt;span&gt;\( t \)&lt;/span&gt; מסמן את פעולת השחלוף של מטריצות, כלומר הדרישה היא ש-&lt;span&gt;\( A \)&lt;/span&gt; תהיה &lt;strong&gt;סימטרית&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;הדרישה &lt;span&gt;\( A^{*}A=AA^{*} \)&lt;/span&gt; קצת פחות ברורה במבט ראשון. עוד רגע נראה מאיפה היא מגיעה, אבל עד כה לא היה לנו שם בשבילה, אז בואו נמציא אחד: נאמר ש-&lt;span&gt;\( A \)&lt;/span&gt; היא &lt;strong&gt;נורמלית&lt;/strong&gt; אם &lt;span&gt;\( A^{*}A=AA^{*} \)&lt;/span&gt;. ניקח את השמות הללו גם עבור טרנספורמציות לינאריות, והנה לנו עוד ניסוח של המשפט:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;אם &lt;span&gt;\( V \)&lt;/span&gt; הוא מרחב מכפלה פנימית מעל &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt; ו-&lt;span&gt;\( T:V\to V \)&lt;/span&gt; אז &lt;span&gt;\( T \)&lt;/span&gt; לכסינה אוניטרית אם ורק אם היא צמודה לעצמה.&lt;/li&gt;


&lt;li&gt;אם &lt;span&gt;\( V \)&lt;/span&gt; הוא מרחב מכפלה פנימית מעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; ו-&lt;span&gt;\( T:V\to V \)&lt;/span&gt; אז &lt;span&gt;\( T \)&lt;/span&gt; לכסינה אוניטרית אם ורק אם היא נורמלית.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;מאיפה התנאים הללו באים? להוכיח שהם &lt;strong&gt;הכרחיים&lt;/strong&gt; זה קל. נניח שקיימת מטריצה אוניטרית &lt;span&gt;\( U \)&lt;/span&gt; (כלומר &lt;span&gt;\( U^{*}=U^{-1} \)&lt;/span&gt; - אני משתמש בזה הרבה עכשיו) כך ש-&lt;span&gt;\( U^{*}AU=D \)&lt;/span&gt; ו-&lt;span&gt;\( D \)&lt;/span&gt; היא מטריצה ריבועית. בואו נפעיל את אופרטור הכוכב על שני אגפי המשוואה - אני אשתמש פה בתכונות המוכרות שלו:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( \left(AB\right)^{*}=B^{*}A^{*} \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left(A^{*}\right)^{*}=A \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;אז על ידי הפעלה שלו על שני האגפים, אני מקבל &lt;span&gt;\( U^{*}A^{*}U=\left(U^{*}AU\right)^{*}=D^{*} \)&lt;/span&gt;. עכשיו, מכיוון ש-&lt;span&gt;\( D \)&lt;/span&gt; אלכסונית, זה אומר ש-&lt;span&gt;\( D^{*} \)&lt;/span&gt; היא כמו &lt;span&gt;\( D \)&lt;/span&gt; רק עם הצמדה של אברי האלכסון. אבל &lt;strong&gt;אם אנחנו מעל הממשיים&lt;/strong&gt;, אז אברי האלכסון הם מספרים ממשיים, ולכן הצמדה שלהם לא משנה אותם ולכן &lt;strong&gt;במקרה הממשי&lt;/strong&gt; מקבלים ש-&lt;span&gt;\( D=D^{*} \)&lt;/span&gt;, כלומר &lt;span&gt;\( U^{*}AU=U^{*}A^{*}U \)&lt;/span&gt;. נכפול משמאל ב-&lt;span&gt;\( U \)&lt;/span&gt; כדי לצמצם את ה-&lt;span&gt;\( U^{*} \)&lt;/span&gt; משם; נכפול מימין ב-&lt;span&gt;\( U^{*} \)&lt;/span&gt;, ונישאר עם &lt;span&gt;\( A=A^{*} \)&lt;/span&gt;, וזה בדיוק מה שרציתי להראות עבור המקרה הממשי.&lt;/p&gt;

&lt;p&gt;עבור המקרה המרוכב בהחלט ייתכן ש-&lt;span&gt;\( D\ne D^{*} \)&lt;/span&gt;, אבל שתיהן הן עדיין מטריצות אלכסונית, ומטריצות אלכסוניות &lt;strong&gt;מתחלפות בכפל&lt;/strong&gt;. נשתמש בזה כדי להראות ש-&lt;span&gt;\( A,A^{*} \)&lt;/span&gt; גם כן מתחלפות בכפל (זה די מתבקש מכך ש-&lt;span&gt;\( A,A^{*} \)&lt;/span&gt; ו-&lt;span&gt;\( D,D^{*} \)&lt;/span&gt; הם שני ייצוגים שונים לאותן טרנספורמציות, אבל בואו נראה את זה ברמת הפיפס הטכני בכל זאת). מהמשוואה &lt;span&gt;\( U^{*}AU=D \)&lt;/span&gt; נקבל &lt;span&gt;\( A=UDU^{*} \)&lt;/span&gt; ובדומה &lt;span&gt;\( A^{*}=UD^{*}U^{*} \)&lt;/span&gt;, וכעת:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A^{*}A=\left(UD^{*}U^{*}\right)\left(UDU^{*}\right)=UD^{*}\left(U^{*}U\right)DU^{*}=UD^{*}DU^{*}= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =UDD^{*}U^{*}=UD\left(U^{*}U\right)D^{*}U^{*}=\left(UDU^{*}\right)\left(UD^{*}U^{*}\right)=AA^{*} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז גם זה היה קל. האתגר שלנו יהיה להראות שהתנאים הללו הם גם &lt;strong&gt;מספיקים&lt;/strong&gt;, כלומר אם הם מתקיימים באמת אפשר למצוא &lt;span&gt;\( U \)&lt;/span&gt; מופלאה שכזו.&lt;/p&gt;

&lt;h2&gt;לכסון אוניטרי של דברים צמודים לעצמם&lt;/h2&gt;

&lt;p&gt;מה שאני רוצה להראות עכשיו הוא שאם &lt;span&gt;\( T:V\to V \)&lt;/span&gt; היא טרנספורמציה צמודה לעצמה, כלומר &lt;span&gt;\( T=T^{*} \)&lt;/span&gt;, אז היא לכסינה אוניטרית. לכאורה אני צריך להסתפק במקרה שבו &lt;span&gt;\( V \)&lt;/span&gt; הוא מרחב מעל &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt;, אבל ההוכחה תעבוד מעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; באותה מידה כי להיות הרמיטי זו תכונה חזקה למדי. פשוט, במקרה של &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; זה &lt;strong&gt;לא מספיק&lt;/strong&gt;, יש עוד טרנספורמציות שאני צריך לטפל בהן.&lt;/p&gt;

&lt;p&gt;ההוכחה היא באינדוקציה על המימד של &lt;span&gt;\( V \)&lt;/span&gt; (בפרט, אם &lt;span&gt;\( V \)&lt;/span&gt; הוא אינסוף ממדי שום דבר מזה לא יעבוד; &lt;a href=&quot;https://gadial.net/2014/02/09/hilbert_spaces/&quot;&gt;אלגברה לינארית מעל מרחב אינסוף ממדי&lt;/a&gt; היא משחק שונה לגמרי). השלב הקריטי שלה הוא להראות של-&lt;span&gt;\( T \)&lt;/span&gt; קיים וקטור עצמי &lt;strong&gt;אחד&lt;/strong&gt;; אחר כך אפשר לפצל את &lt;span&gt;\( V \)&lt;/span&gt; למרחב החד ממדי של “מה שהוקטור העצמי פורש” ולמרחב של “כל מה שניצב למרחב החד ממדי הזה”, לעבוד באינדוקציה על המרחב הניצב הזה ואיכשהו להדביק את הכל בסוף עם סלוטייפ. אז השלב הראשון שלנו הוא להוכיח שיש ל-&lt;span&gt;\( T \)&lt;/span&gt; וקטור עצמי. בשביל זה אנחנו צריכים להזכיר לעצמנו מה עושים, טכנית, כדי למצוא וקטורים עצמיים.&lt;/p&gt;

&lt;p&gt;אני לא אחזור על כל התהליך, אבל הרעיון הוא זה: לוקחים בסיס &lt;span&gt;\( B \)&lt;/span&gt; ל-&lt;span&gt;\( V \)&lt;/span&gt; ובונים את המטריצה &lt;span&gt;\( A=\left[T\right]_{B} \)&lt;/span&gt; שמייצגת את &lt;span&gt;\( T \)&lt;/span&gt; בבסיס &lt;span&gt;\( B \)&lt;/span&gt;. אין ממש חשיבות תיאורטית לשאלה איזה בסיס לוקחים - העיקר שאנחנו משיגים קונקרטיזציה שמעבירה מ-&lt;span&gt;\( T \)&lt;/span&gt; אל אוסף של מספרים בטבלה (“מטריצה”). עכשיו, מגדירים את הפולינום &lt;span&gt;\( p\left(x\right)=\det\left(xI-A\right) \)&lt;/span&gt; שנקרא “הפולינום האופייני” של &lt;span&gt;\( A \)&lt;/span&gt;, מוצאים לו שורש &lt;span&gt;\( \lambda \)&lt;/span&gt;, ואז פותרים את מערכת המשוואות &lt;span&gt;\( \left(\lambda I-A\right)x=0 \)&lt;/span&gt; - הפתרון שנקבל יהיה וקטור עצמי (ומובטח שיהיה פתרון אחד לפחות).&lt;/p&gt;

&lt;p&gt;כל מה שתיארתי הוא טוב ויפה חוץ מעניין אחד: אמרתי ש”מוצאים שורש &lt;span&gt;\( \lambda \)&lt;/span&gt; לפולינום האופייני” - אבל מי מבטיח לנו ש&lt;strong&gt;קיים&lt;/strong&gt; שורש? למשל, אם הפולינום האופייני הוא &lt;span&gt;\( \lambda^{2}+1 \)&lt;/span&gt;, אז &lt;strong&gt;לא קיים לו שורש&lt;/strong&gt;… מעל המספרים הממשיים, זאת אומרת. השורשים שלו הם &lt;span&gt;\( \pm i \)&lt;/span&gt; שהם מספרים מרוכבים. זו בדיוק הסיבה למה למטריצה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A=\left[\begin{array}{cc} 0 &amp;amp; 1\\ -1 &amp;amp; 0 \end{array}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;שמתארת סיבוב ב-90 מעלות, אין וקטורים עצמיים ממשיים.&lt;/p&gt;

&lt;p&gt;העניין הוא שזו בעיה שקיימת רק בממשיים. במרוכבים יש לנו את &lt;strong&gt;המשפט היסודי של האלגברה&lt;/strong&gt; שמבטיח לנו שתמיד קיים שורש לכל פולינום (הוכחתי את זה &lt;a href=&quot;https://gadial.net/2009/10/29/fundemental_theorem_of_algebra_algebraic_proof/&quot;&gt;כאן&lt;/a&gt;). כמובן, המקרה שמעניין אותנו הוא ספציפית זה של הממשיים, ולכן כן נצטרך להתאמץ יותר - עד עכשיו בטיעון שהצגתי בכלל לא השתמשנו בכך ש-&lt;span&gt;\( T \)&lt;/span&gt; צמודה לעצמה, וזה מן הסתם יצטרך לשחק תפקיד, והתפקיד הזה הוא פשוט למדי: אם &lt;span&gt;\( T \)&lt;/span&gt; היא צמודה לעצמה, אז כל הערכים העצמיים שלה הם &lt;strong&gt;ממשיים&lt;/strong&gt;. זו טענה מרחיקת לכת שמעניינת הרבה יותר מאשר רק במסגרת ההוכחה הספציפית שלנו - למשל, בפיזיקה קוונטית משתמשים באופרטורים צמודים לעצמם כדי לתאר &lt;strong&gt;גדלים מדידים&lt;/strong&gt; - המדידה על פי אופרטור מסוים מניבה ערך עצמי שלו, ולכן קריטי שהאופרטור יהיה צמוד לעצמו כי ערכים ממשיים הם הערכים שאנחנו “יודעים למדוד”.&lt;/p&gt;

&lt;p&gt;להוכיח את זה, זה קל. נניח של-&lt;span&gt;\( T \)&lt;/span&gt; יש ערך עצמי &lt;span&gt;\( \lambda \)&lt;/span&gt; עם וקטור עצמי &lt;span&gt;\( v\ne0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( T\left(v\right)=\lambda v \)&lt;/span&gt;, ועכשיו בואו נסתכל על הסקלר &lt;span&gt;\( \lambda\left\langle v,v\right\rangle  \)&lt;/span&gt; ונשתמש בחוקי החשבון של מכפלות פנימיות ובכך ש-&lt;span&gt;\( T \)&lt;/span&gt; צמודה לעצמה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lambda\left\langle v,v\right\rangle =\left\langle \lambda v,v\right\rangle =\left\langle T\left(v\right),v\right\rangle = \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\left\langle v,T\left(v\right)\right\rangle =\left\langle v,\lambda v\right\rangle =\overline{\lambda}\left\langle v,v\right\rangle  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מכיוון ש-&lt;span&gt;\( v\ne0 \)&lt;/span&gt; אז &lt;span&gt;\( \left\langle v,v\right\rangle &amp;gt;0 \)&lt;/span&gt; ואפשר לחלק בו ולקבל &lt;span&gt;\( \lambda=\overline{\lambda} \)&lt;/span&gt; - התכונה הזו שקולה לכך ש-&lt;span&gt;\( \lambda\in\mathbb{R} \)&lt;/span&gt;, אז סיימנו עם זה.&lt;/p&gt;

&lt;p&gt;אם אני כבר בשוונג של הוכחות שהן משחק טכני עם המכפלה הפנימית, בואו גם נוכיח שוקטורים עצמיים שמתאימים לערכים עצמיים שונים של אופרטור צמוד לעצמו הם &lt;strong&gt;אורתוגונליים&lt;/strong&gt;. כלומר נניח ש-&lt;span&gt;\( T\left(v\right)=\lambda v \)&lt;/span&gt; ו-&lt;span&gt;\( T\left(u\right)=\rho u \)&lt;/span&gt; עם &lt;span&gt;\( \lambda\ne\rho \)&lt;/span&gt; ונוכיח ש-&lt;span&gt;\( \left\langle v,u\right\rangle =0 \)&lt;/span&gt;. בשביל לראות את זה, נסתכל הפעם על &lt;span&gt;\( \lambda\left\langle v,u\right\rangle  \)&lt;/span&gt; ונשתמש פחות או יותר באותה סדרת מעברים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lambda\left\langle v,u\right\rangle =\left\langle \lambda v,u\right\rangle =\left\langle T\left(v\right),u\right\rangle = \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\left\langle v,T\left(u\right)\right\rangle =\left\langle v,\rho u\right\rangle =\overline{\rho}\left\langle v,u\right\rangle  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מכיוון שהערכים העצמיים הם ממשיים אז &lt;span&gt;\( \rho=\overline{\rho} \)&lt;/span&gt; ולכן קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lambda\left\langle v,u\right\rangle =\rho\left\langle v,u\right\rangle  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;נעביר אגפים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(\lambda-\rho\right)\left\langle v,u\right\rangle =0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ומכיוון ש-&lt;span&gt;\( \lambda\ne\rho \)&lt;/span&gt; החלק הזה במכפלה שונה מאפס, ולכן בהכרח &lt;span&gt;\( \left\langle v,u\right\rangle =0 \)&lt;/span&gt;, מה שמסיים את החלק הזה של ההוכחה.&lt;/p&gt;

&lt;p&gt;עכשיו נחזור לאתגר שלנו - להוכיח שלכל אופרטור צמוד לעצמו יש וקטור עצמי. יש לנו פה שני רעיונות שהשילוב של שניהם אמור לפתור את הבעיה:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;לכל אופרטור &lt;span&gt;\( T:V\to V \)&lt;/span&gt; כאשר &lt;span&gt;\( V \)&lt;/span&gt; הוא מעל המרוכבים קיים ערך עצמי &lt;span&gt;\( \lambda \)&lt;/span&gt; (מרוכב).&lt;/li&gt;


&lt;li&gt;אם &lt;span&gt;\( T \)&lt;/span&gt; הוא צמוד לעצמו עם ערך עצמי &lt;span&gt;\( \lambda \)&lt;/span&gt;, אז &lt;span&gt;\( \lambda \)&lt;/span&gt; ממשי.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;שני אלו באמת יפתרו את הבעיה, אבל צריך להדביק אותם בסלוטייפ והסלוטייפ יהיה קצת טכני. לב העניין הוא שאני לא יכול סתם כך להשתמש ב-1 כי נקודת המוצא שלי היא &lt;span&gt;\( T:V\to V \)&lt;/span&gt; כך ש-&lt;span&gt;\( V \)&lt;/span&gt; הוא מרחב וקטורי &lt;strong&gt;מעל הממשיים&lt;/strong&gt; &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אז בואו נתקדם בזהירות.&lt;/p&gt;

&lt;p&gt;ראשית, אני אקח בסיס &lt;span&gt;\( B \)&lt;/span&gt; של &lt;span&gt;\( V \)&lt;/span&gt;, אבל לא סתם בסיס - &lt;strong&gt;בסיס אורתונורמלי&lt;/strong&gt;. אני יודע בודאות שקיים כזה בסיס כי תהליך גרם-שמידט (שתיארתי &lt;a href=&quot;https://gadial.net/2012/02/06/inner_products_intro/&quot;&gt;כאן&lt;/a&gt;) מבטיח את הקיום שלו. אבל למה אני צריך בסיס אורתונורמלי? כי עכשיו אני אגדיר מטריצה &lt;span&gt;\( A=\left[T\right]_{B} \)&lt;/span&gt; בדיוק כפי שתיארתי קודם, ואני צריך שגם המטריצה תהיה צמודה לעצמה, כלומר תקיים &lt;span&gt;\( A^{*}=A \)&lt;/span&gt;, ובשביל שזה יעבוד אני צריך שיתקיים &lt;span&gt;\( A^{*}=\left[T^{*}\right]_{B} \)&lt;/span&gt; ובשביל &lt;strong&gt;שזה&lt;/strong&gt; יעבוד הבסיס צריך להיות אורתונורמלי. הראיתי את זה בפוסט &lt;a href=&quot;https://gadial.net/2013/04/27/adjoint_unitary_hermitian_matrices/&quot;&gt;הזה&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( A \)&lt;/span&gt; היא מטריצה שהאיברים שלה לקוחים מתוך השדה שמעליו עובדים - במקרה שלנו, &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt;. אבל שום דבר לא מונע מאיתנו להכניס לתמונה מרחב וקטורי &lt;strong&gt;חדש&lt;/strong&gt;, מעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt;, ולהשתמש בו ב-&lt;span&gt;\( A \)&lt;/span&gt; באותו אופן בדיוק כי היא גם מטריצה מעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt;. אז נסתכל על המרחב &lt;span&gt;\( \mathbb{C}^{n} \)&lt;/span&gt;. מעל המרחב הזה, &lt;span&gt;\( A \)&lt;/span&gt; מגדירה אופרטור לינארי על ידי הפעולה &lt;span&gt;\( A\left(v\right)=Av \)&lt;/span&gt; (כופלים את המטריצה &lt;span&gt;\( n\times n \)&lt;/span&gt; שהיא &lt;span&gt;\( A \)&lt;/span&gt; בוקטור העמודה &lt;span&gt;\( n\times1 \)&lt;/span&gt; שהוא &lt;span&gt;\( v \)&lt;/span&gt;, במובן הסטנדרטי של כפל מטריצה בוקטור). לכן קיים לאופרטור &lt;span&gt;\( A \)&lt;/span&gt; הזה ערך עצמי &lt;span&gt;\( \lambda\in\mathbb{C} \)&lt;/span&gt;. האם זה ערך עצמי &lt;strong&gt;ממשי&lt;/strong&gt;? כן, &lt;strong&gt;בתנאי&lt;/strong&gt; שהאופרטור &lt;span&gt;\( A \)&lt;/span&gt; הוא צמוד לעצמו. שמתם לב לניואנס? אני לא משתמש ישירות בזה ש-&lt;span&gt;\( T \)&lt;/span&gt; צמוד לעצמו, אלא צריך להראות שמכך נובע שהאופרטור &lt;span&gt;\( A \)&lt;/span&gt; שנגזר ממנו בדרך חתחתים של בחירה בבסיס אורתונורמלי, מציאת ייצוג ל-&lt;span&gt;\( T \)&lt;/span&gt; ואז &lt;strong&gt;החלפת שדה הבסיס&lt;/strong&gt; ל-&lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; - אחרי כל זה, האופרטור עדיין צמוד לעצמו. כן, זה לא משהו שקשה להראות, אבל הניואנס, הו, הניואנס.&lt;/p&gt;

&lt;p&gt;בכל מקרה, בבסיס הסטנדרטי של &lt;span&gt;\( \mathbb{C}^{n} \)&lt;/span&gt; (זה שבו וקטורי הבסיס הם הוקטורים עם 1 בכניסה אחת ו-0 ביתר) ועם המכפלה הפנימית הסטנדרטית, המטריצה המייצגת של האופרטור &lt;span&gt;\( A \)&lt;/span&gt; היא בעצמה &lt;span&gt;\( A \)&lt;/span&gt;, ולכן זה שאנחנו כבר יודעים ש-&lt;span&gt;\( A^{*}=A \)&lt;/span&gt; מראה שהאופרטור צמוד לעצמו, ולכן &lt;span&gt;\( \lambda \)&lt;/span&gt; הוא אכן ערך עצמי ממשי. עכשיו ממשיכים כמו קודם - פותרים את מערכת המשוואות &lt;span&gt;\( \left(\lambda I-A\right)x=0 \)&lt;/span&gt;, אבל שימו לב שפותרים אותה &lt;strong&gt;מעל הממשיים&lt;/strong&gt; כדי לקבל פתרון ממשי; הפתרון הזה נותן לנו וקטור &lt;span&gt;\( v\in V \)&lt;/span&gt; כך ש-&lt;span&gt;\( T\left(v\right)=\lambda v \)&lt;/span&gt; וסיימנו (&lt;span&gt;\( v \)&lt;/span&gt; עצמו מתקבל מצירוף לינארי של אברי הבסיס &lt;span&gt;\( B \)&lt;/span&gt; שבחרנו בהתחלה; הפתרון של מערכת המשוואות אומר לנו מה &lt;strong&gt;המקדמים&lt;/strong&gt; של אברי הבסיס הללו בצירוף הלינארי שנותן את &lt;span&gt;\( v \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;סיימנו את השלב הראשון במה שרצינו לעשות - הראינו שלאופרטור צמוד לעצמו יש תמיד וקטור עצמי. עכשיו מגיע שלב האינדוקציה.&lt;/p&gt;

&lt;p&gt;אם כן, יש לנו מרחב מכפלה פנימית &lt;span&gt;\( V \)&lt;/span&gt; ממימד &lt;span&gt;\( n \)&lt;/span&gt; וטרנספורמציה &lt;span&gt;\( T \)&lt;/span&gt; עליו. אנחנו מוצאים וקטור &lt;span&gt;\( v\in V \)&lt;/span&gt; כך ש-&lt;span&gt;\( T\left(v\right)=\lambda v \)&lt;/span&gt;. שימו לב שאנחנו רוצים לבנות בסיס אורתונורמלי ולכן &lt;span&gt;\( v \)&lt;/span&gt; צריך לקיים &lt;span&gt;\( \|v\|=1 \)&lt;/span&gt;, אבל אם הוא לא מקיים את זה פשוט נחליף אותו ב-&lt;span&gt;\( \frac{v}{\|v\|} \)&lt;/span&gt; שהוא גם וקטור עצמי, אז אפשר להניח בלי הגבלת הכלליות ש-&lt;span&gt;\( v \)&lt;/span&gt; הוא מנורמה 1. עכשיו אנחנו מגדירים תת-מרחב &lt;span&gt;\( W=\text{span}\left\{ v\right\}  \)&lt;/span&gt;, ורוצים לפרק את &lt;span&gt;\( V \)&lt;/span&gt; אל &lt;span&gt;\( W \)&lt;/span&gt; ו”מה שנשאר”, כלומר למצוא מרחב אחר, &lt;span&gt;\( W^{\prime} \)&lt;/span&gt; כך ש-&lt;span&gt;\( V=W\oplus W^{\prime} \)&lt;/span&gt;. למצוא סתם &lt;span&gt;\( W^{\prime} \)&lt;/span&gt; אקראי כזה, זה קל: &lt;strong&gt;משלימים לבסיס&lt;/strong&gt; את הבסיס של &lt;span&gt;\( W \)&lt;/span&gt;, ואז אברי הבסיס הנוספים שמצאנו הם בסיס ל-&lt;span&gt;\( W^{\prime} \)&lt;/span&gt;. אבל אנחנו לא רוצים סתם &lt;span&gt;\( W^{\prime} \)&lt;/span&gt; אקראי אלא אחד שיהיה מועיל ככל הניתן. בפרט, אנחנו במרחב מכפלה פנימית אז שווה לנצל את המכפלה הפנימית הזו כדי להבטיח של-&lt;span&gt;\( W^{\prime} \)&lt;/span&gt; יש מבנה נחמד, ולכן ניקח את &lt;span&gt;\( W^{\prime} \)&lt;/span&gt; כך שכל הוקטורים בו &lt;strong&gt;אורתוגונליים&lt;/strong&gt; לאלו של &lt;span&gt;\( W \)&lt;/span&gt;, מה שנקרא &lt;strong&gt;המשלים האורתוגונלי&lt;/strong&gt; &lt;span&gt;\( W^{\perp}=\left\{ v\in V\ |\ \forall w\in W:\left\langle v,w\right\rangle =0\right\}  \)&lt;/span&gt; של &lt;span&gt;\( W \)&lt;/span&gt;. לא קשה להראות שאכן &lt;span&gt;\( V=W\oplus W^{\perp} \)&lt;/span&gt; (הראיתי את זה &lt;a href=&quot;https://gadial.net/2012/03/01/inner_product_spaces_geometry/&quot;&gt;כאן&lt;/a&gt;). השאלה היא - למה במקרה הנוכחי זה טוב לנו?&lt;/p&gt;

&lt;p&gt;כדי שנוכל להמשיך באינדוקציה, אנחנו צריכים להצטמצם אל &lt;span&gt;\( W^{\prime} \)&lt;/span&gt;. בשביל זה צריך שגם &lt;span&gt;\( T \)&lt;/span&gt; עצמה תהיה ניתנת לצמצום אליו, וזה לא תמיד קורה: ייתכן שלהפעיל את &lt;span&gt;\( T \)&lt;/span&gt; על אברים של &lt;span&gt;\( W^{\prime} \)&lt;/span&gt; יוציא אותנו מ-&lt;span&gt;\( W^{\prime} \)&lt;/span&gt;. אבל עבור &lt;span&gt;\( W^{\perp} \)&lt;/span&gt; ובזכות זה ש-&lt;span&gt;\( T \)&lt;/span&gt; היא צמודה לעצמה, זה דווקא כן יהיה אפשרי: פורמלית, לכל &lt;span&gt;\( v\in W^{\perp} \)&lt;/span&gt; יתקיים &lt;span&gt;\( T\left(v\right)\in W^{\perp} \)&lt;/span&gt;, מה שמסומן לפעמים בתור &lt;span&gt;\( T\left(W^{\perp}\right)\subseteq W^{\perp} \)&lt;/span&gt; ומתארים כ”&lt;span&gt;\( W^{\perp} \)&lt;/span&gt; הוא &lt;span&gt;\( T \)&lt;/span&gt;-אינוריאנטי”.&lt;/p&gt;

&lt;p&gt;הנה הרעיון: אנחנו מניחים ש-&lt;span&gt;\( u\in W^{\perp} \)&lt;/span&gt; ורוצים להראות ש-&lt;span&gt;\( T\left(u\right)\in W^{\perp} \)&lt;/span&gt;, כלומר שלכל &lt;span&gt;\( w\in W \)&lt;/span&gt; מתקיים &lt;span&gt;\( \left\langle w,T\left(u\right)\right\rangle =0 \)&lt;/span&gt;, אבל מכיוון ש-&lt;span&gt;\( T \)&lt;/span&gt; צמודה לעצמה, &lt;span&gt;\( \left\langle w,T\left(u\right)\right\rangle =\left\langle T\left(w\right),u\right\rangle  \)&lt;/span&gt;. עכשיו, &lt;span&gt;\( W \)&lt;/span&gt; הוא לא סתם תת-מרחב אקראי, הוא בעצמו נפרש על ידי וקטור עצמי של &lt;span&gt;\( T \)&lt;/span&gt; ולכן הוא בעצמו &lt;span&gt;\( T \)&lt;/span&gt;-אינוריאנטי, כך ש-&lt;span&gt;\( T\left(w\right)\in w \)&lt;/span&gt; ולכן &lt;span&gt;\( \left\langle T\left(w\right),u\right\rangle =0 \)&lt;/span&gt; כי התחלנו מזה ש-&lt;span&gt;\( u\in W^{\perp} \)&lt;/span&gt;. זה מסיים את הנימוק הזה.&lt;/p&gt;

&lt;p&gt;עכשיו, מכיוון ש-&lt;span&gt;\( W^{\perp} \)&lt;/span&gt; הוא &lt;span&gt;\( T \)&lt;/span&gt;-אינוריאנטי, אפשר להסתכל על הפונקציה המצומצמת &lt;span&gt;\( T|_{W^{\perp}}:W^{\perp}\to W^{\perp} \)&lt;/span&gt;. היא בעצמה אופרטור לינארי צמוד לעצמו, והיא מוגדרת על מרחב ממימד קטן משל &lt;span&gt;\( W \)&lt;/span&gt;, אז אפשר להשתמש עליה בהנחת האינדוקציה ומקבלים בסיס אורתונורמלי &lt;span&gt;\( \left\{ u_{1},\ldots,u_{n-1}\right\}  \)&lt;/span&gt; של וקטורים עצמיים של &lt;span&gt;\( T|_{W^{\perp}} \)&lt;/span&gt;, ולכן הם גם וקטורים עצמיים של &lt;span&gt;\( T \)&lt;/span&gt;. עכשיו נוסיף להם את &lt;span&gt;\( v \)&lt;/span&gt; שמצאנו קודם ונקבל בסיס &lt;span&gt;\( \left\{ v,u_{1},\ldots,u_{n-1}\right\}  \)&lt;/span&gt; לכל &lt;span&gt;\( V \)&lt;/span&gt; (כי &lt;span&gt;\( V=W\oplus W^{\perp} \)&lt;/span&gt;) אבל האם זה בסיס &lt;strong&gt;אורתונורמלי&lt;/strong&gt;? בשביל זה צריך ש-&lt;span&gt;\( v \)&lt;/span&gt; יהיה ניצב לכל ה-&lt;span&gt;\( u \)&lt;/span&gt;-ים, אבל… זה בדיוק מה שמובטח לנו מכך שהם איברים של &lt;span&gt;\( W^{\perp} \)&lt;/span&gt; בזמן ש-&lt;span&gt;\( v\in W \)&lt;/span&gt;. זה מסיים את ההוכחה על לכסון אוניטרי של אופרטורים צמודים לעצמם (במקרה הממשי &lt;strong&gt;וגם&lt;/strong&gt; במקרה המרוכב).&lt;/p&gt;

&lt;h2&gt;לכסון אוניטרי של דברים נורמליים&lt;/h2&gt;

&lt;p&gt;מה שנשאר לנו להוכיח הוא את הטענה הבאה:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;אם &lt;span&gt;\( V \)&lt;/span&gt; הוא מרחב מכפלה פנימית מעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; ו-&lt;span&gt;\( T:V\to V \)&lt;/span&gt; היא נורמלית (&lt;span&gt;\( T^{*}T=TT^{*} \)&lt;/span&gt;) אז &lt;span&gt;\( T \)&lt;/span&gt; לכסינה אוניטרית.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;בחלק הקודם שטיפל באופרטורים צמודים לעצמם ראינו שמעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; &lt;strong&gt;תמיד&lt;/strong&gt; יש ל-&lt;span&gt;\( T \)&lt;/span&gt; וקטור עצמי ואז המשכנו באינדוקציה. למה אי אפשר לעשות את זה גם כאן? ובכן &lt;strong&gt;אפשר&lt;/strong&gt; לעשות את זה גם כאן, וזה אפילו יעבוד. בערך. ניתקל במכשול כלשהו אבל הנורמליות תסדר לנו אותו.&lt;/p&gt;

&lt;p&gt;קודם הרעיון היה לקחת וקטור עצמי &lt;span&gt;\( v \)&lt;/span&gt; מנורמה 1 ולבנות את &lt;span&gt;\( W=\text{span}\left\{ v\right\}  \)&lt;/span&gt; ואז להמשיך באינדוקציה על &lt;span&gt;\( W^{\perp} \)&lt;/span&gt;. זה הסתמך על כך ש-&lt;span&gt;\( W^{\perp} \)&lt;/span&gt; היה &lt;span&gt;\( T \)&lt;/span&gt;-אינוריאנטי, כלומר &lt;span&gt;\( T\left(W^{\perp}\right)\subseteq W^{\perp} \)&lt;/span&gt;. לרוע המזל, זה &lt;strong&gt;לא&lt;/strong&gt; מה שקורה באופן כללי, כי ההוכחה של זה דרשה ש-&lt;span&gt;\( T \)&lt;/span&gt; יהיה צמוד לעצמו; מה שקורה באופן כללי הוא שיש לנו את השרשרת, עבור &lt;span&gt;\( u\in W^{\perp} \)&lt;/span&gt; כלשהו וכל &lt;span&gt;\( w\in W \)&lt;/span&gt;, של&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0=\left\langle T\left(w\right),u\right\rangle =\left\langle w,T^{*}\left(u\right)\right\rangle  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, &lt;span&gt;\( T^{*}\left(u\right)\in W^{\perp} \)&lt;/span&gt;: מה שנכון באופן כללי הוא ש-&lt;span&gt;\( W^{\perp} \)&lt;/span&gt; הוא &lt;span&gt;\( T^{*} \)&lt;/span&gt;-אינוריאנטי, פשוט במקרה של אופרטור צמוד לעצמו ניצלנו את זה ש-&lt;span&gt;\( T=T^{*} \)&lt;/span&gt;. אבל אפשר להתחכם! במקום למצוא וקטור עצמי ל-&lt;span&gt;\( T \)&lt;/span&gt;, אני אמצא וקטור עצמי &lt;span&gt;\( v \)&lt;/span&gt; עבור &lt;span&gt;\( T^{*} \)&lt;/span&gt;, אבנה את &lt;span&gt;\( W=\text{span}\left\{ v\right\}  \)&lt;/span&gt;, ואז אקבל ש-&lt;span&gt;\( W^{\perp} \)&lt;/span&gt; הוא &lt;span&gt;\( \left(T^{*}\right)^{*} \)&lt;/span&gt;-אינוריאנטי, כלומר &lt;span&gt;\( T \)&lt;/span&gt;-אינוריאנטי, ולכן אפשר לצמצם את &lt;span&gt;\( T \)&lt;/span&gt; אל &lt;span&gt;\( W^{\perp} \)&lt;/span&gt; ולהפעיל עליו את הנחת האינדוקציה. אבל איך זה עוזר לי, בעצם, אם בסופו של דבר יש לי ביד וקטור עצמי &lt;span&gt;\( v \)&lt;/span&gt; של &lt;span&gt;\( T^{*} \)&lt;/span&gt; ולא של &lt;span&gt;\( T \)&lt;/span&gt;? ובכן, זה הפאנץ’: אם &lt;span&gt;\( T \)&lt;/span&gt; &lt;strong&gt;נורמלית&lt;/strong&gt; אז כל וקטור עצמי של &lt;span&gt;\( T^{*} \)&lt;/span&gt; הוא גם וקטור עצמי של &lt;span&gt;\( T \)&lt;/span&gt;. זו התוצאה האחרונה שאני צריך להוכיח כדי לסיים את הכל.&lt;/p&gt;

&lt;p&gt;יהיו כמה פרטים טכניים, אבל הרעיון הבסיסי הוא פשוט למדי: אם &lt;span&gt;\( v \)&lt;/span&gt; הוא וקטור עצמי של &lt;span&gt;\( T^{*} \)&lt;/span&gt; עם ערך עצמי &lt;span&gt;\( \lambda \)&lt;/span&gt;, זה אומר ש-&lt;span&gt;\( T^{*}v=\lambda v \)&lt;/span&gt;, כלומר ש-&lt;span&gt;\( \left(T^{*}-\lambda I\right)v=0 \)&lt;/span&gt;. בואו נסמן &lt;span&gt;\( U=T^{*}-\lambda I \)&lt;/span&gt;. מכללי ההצמדה של אופרטורים, &lt;span&gt;\( U^{*}=T-\overline{\lambda}I \)&lt;/span&gt;. עכשיו, אם אני אוכיח שבאופן כללי, אם &lt;span&gt;\( U \)&lt;/span&gt; הוא אופטור &lt;strong&gt;נורמלי&lt;/strong&gt; אז לכל &lt;span&gt;\( v\in V \)&lt;/span&gt; מתקיים &lt;span&gt;\( \|U\left(v\right)\|=\|U^{*}\left(v\right)\| \)&lt;/span&gt;, סיימתי. למה? כי&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;אם &lt;span&gt;\( U\left(v\right)=0 \)&lt;/span&gt; כפי שכבר ראינו, אז &lt;span&gt;\( \|U^{*}\left(v\right)\|=\|U\left(v\right)\|=\|0\|=0 \)&lt;/span&gt;, ולכן &lt;span&gt;\( U^{*}\left(v\right)=0 \)&lt;/span&gt; (האיבר היחיד מנורמה 0 הוא 0).&lt;/li&gt;


&lt;li&gt;אם &lt;span&gt;\( U^{*}\left(v\right)=0 \)&lt;/span&gt; אז מכך ש-&lt;span&gt;\( U^{*}=T-\overline{\lambda}I \)&lt;/span&gt; נקבל &lt;span&gt;\( T\left(v\right)=\overline{\lambda}v \)&lt;/span&gt;, כלומר &lt;span&gt;\( v \)&lt;/span&gt; הוא גם וקטור עצמי של &lt;span&gt;\( T \)&lt;/span&gt;, פשוט לא עבור אותו ערך עצמי אלא עבור ההצמדה שלו.&lt;/li&gt;


&lt;li&gt;מכיוון ש-&lt;span&gt;\( T \)&lt;/span&gt; הוא אופרטור נורמלי גם &lt;span&gt;\( U \)&lt;/span&gt; כזה, כמו שחישוב ישיר יראה.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;בואו נראה במפורש את ה”חישוב ישיר” של 3 רק כדי שלא יהיה לנו ספק, למרות שזה די ברור גם ככה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( U^{*}U=\left(T-\overline{\lambda}I\right)\left(T^{*}-\lambda I\right)=TT^{*}-\overline{\lambda}T^{*}-\lambda T+\overline{\lambda}\lambda I \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =T^{*}T-\lambda T-\overline{\lambda}T^{*}+\overline{\lambda}\lambda I=\left(T^{*}-\lambda I\right)\left(T-\overline{\lambda}I\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אני אוהב את הגישה הזו להוכחה, כי ככה רואים בדיוק איפה תכונת ה”נורמליות” באה לידי ביטוי ובזכותה הכל עובד - כל ההוכחות פה סובבות סביב הדואליות בין &lt;span&gt;\( T \)&lt;/span&gt; ו-&lt;span&gt;\( T^{*} \)&lt;/span&gt; וחיפוש אחרי מקום כלשהו שבו “המראה נשברת” במובן זה ששני האופרטורים הללו הם לא סתם שיקוף אחד של השני אלא אותו דבר בדיוק.&lt;/p&gt;

&lt;p&gt;אוקיי, אז בואו נשבור את המראה. צריך להוכיח ש-&lt;span&gt;\( \|U\left(v\right)\|=\|U^{*}\left(v\right)\| \)&lt;/span&gt; לכל &lt;span&gt;\( v\in V \)&lt;/span&gt; ואופרטור נורמלי &lt;span&gt;\( U \)&lt;/span&gt;. אין כאן יותר לכסונים ועניינים, פשוט חישוב ישיר של נורמות:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \|U\left(v\right)\|^{2}=\left\langle U\left(v\right),U\left(v\right)\right\rangle =\left\langle v,U^{*}U\left(v\right)\right\rangle =\left\langle v,UU^{*}\left(v\right)\right\rangle  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\left\langle U^{*}\left(v\right),U^{*}\left(v\right)\right\rangle =\|U^{*}\left(v\right)\|^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ומכיוון שנורמות הן אי-שליליות, אפשר להוציא שורש משני האגפים ולקבל &lt;span&gt;\( \|U\left(v\right)\|=\|U^{*}\left(v\right)\| \)&lt;/span&gt; כפי שרצינו, מה שמסיים את ההוכחה.&lt;/p&gt;

&lt;h2&gt;לאן הולכים מכאן?&lt;/h2&gt;

&lt;p&gt;יש תוצאה מיידית אחת ממה שראינו שאני רוצה להציג כאן לפני שאסיים: &lt;strong&gt;המשפט הספקטרלי&lt;/strong&gt;. הרעיון הוא הוא שאם &lt;span&gt;\( T \)&lt;/span&gt; הוא אופרטור נורמלי מעל &lt;span&gt;\( \mathbb{C} \)&lt;/span&gt; או צמוד לעצמו מעל &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt; עם ערכים עצמיים &lt;span&gt;\( \lambda_{1},\ldots,\lambda_{n} \)&lt;/span&gt;, אז אפשר לכתוב את &lt;span&gt;\( T \)&lt;/span&gt; בתור צירוף לינארי שהמקדמים שלו הם הערכים העצמיים הללו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( T=\lambda_{1}E_{1}+\ldots+\lambda_{n}E_{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר ה-&lt;span&gt;\( E_{1},\ldots,E_{n} \)&lt;/span&gt; הן &lt;strong&gt;ההטלות האורתונוגליות&lt;/strong&gt; על המרחבים העצמיים &lt;span&gt;\( W_{1},\ldots,W_{n} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה זו הטלה אורתוגונלית? ובכן, נכון שדיברנו קודם על מרחב &lt;span&gt;\( V \)&lt;/span&gt; שמתחלק אל &lt;span&gt;\( W\oplus W^{\perp} \)&lt;/span&gt;? זה אומר שכל וקטור &lt;span&gt;\( v \)&lt;/span&gt; אפשר לכתוב בתור &lt;span&gt;\( v=w+u \)&lt;/span&gt; כך ש-&lt;span&gt;\( w\in W,u\in W^{\perp} \)&lt;/span&gt;. הטלה אורתוגונלית על &lt;span&gt;\( W \)&lt;/span&gt; היא האופרטור שלוקח את &lt;span&gt;\( v \)&lt;/span&gt; ומחזיר את &lt;span&gt;\( w \)&lt;/span&gt;, כלומר את הרכיב שלו ששייך ל-&lt;span&gt;\( W \)&lt;/span&gt; בפירוק של &lt;span&gt;\( v \)&lt;/span&gt; ל”משהו מ-&lt;span&gt;\( W \)&lt;/span&gt; ועוד משהו שמאונך ל-&lt;span&gt;\( W \)&lt;/span&gt;”. אנחנו רגילים לזה מחיי היום יום המתמטיים: אם יש לנו את הקואורדינטה &lt;span&gt;\( \left(x,y\right) \)&lt;/span&gt; ואנחנו שולפים ממנה את &lt;span&gt;\( x \)&lt;/span&gt;, ביצענו הטלה אורתוגונלית; עצם השימוש שלנו ב-&lt;span&gt;\( \left(x,y\right) \)&lt;/span&gt; כדי לתאר וקטורים ב-&lt;span&gt;\( \mathbb{R}^{2} \)&lt;/span&gt; מראה כמה טבעי לנו לחשוב כל הזמן במונחים של מרחבים אורתונורמליים (“ציר &lt;span&gt;\( x \)&lt;/span&gt; וציר &lt;span&gt;\( y \)&lt;/span&gt;”).&lt;/p&gt;

&lt;p&gt;בשביל הוכחת המשפט הספקטרלי, אני רוצה קודם כל להראות שכל שני מרחבים עצמיים שונים &lt;span&gt;\( W_{i},W_{j} \)&lt;/span&gt; הם אורתוגונליים זה לזה. אז אני אקח &lt;span&gt;\( v\in W_{i} \)&lt;/span&gt; ו-&lt;span&gt;\( u\in W_{j} \)&lt;/span&gt; כך ש-&lt;span&gt;\( T\left(v\right)=\lambda v \)&lt;/span&gt; ו-&lt;span&gt;\( T\left(u\right)=\rho u \)&lt;/span&gt; ו-&lt;span&gt;\( \lambda\ne\rho \)&lt;/span&gt; וכרגיל אעשה איזה להטוט עם המכפלה הפנימית:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lambda\left\langle v,u\right\rangle =\left\langle \lambda v,u\right\rangle =\left\langle T\left(v\right),u\right\rangle = \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\left\langle v,T^{*}\left(u\right)\right\rangle =\left\langle v,\overline{\rho}u\right\rangle =\rho\left\langle v,u\right\rangle  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן השתמשתי בכך ש-&lt;span&gt;\( T \)&lt;/span&gt; נורמלי ולכן &lt;span&gt;\( u \)&lt;/span&gt; הוא וקטור עצמי של &lt;span&gt;\( T^{*} \)&lt;/span&gt;, פשוט עם הערך העצמי &lt;span&gt;\( \overline{\rho} \)&lt;/span&gt;, כפי שראינו קודם.&lt;/p&gt;

&lt;p&gt;קיבלתי ש-&lt;span&gt;\( \left(\lambda-\rho\right)\left\langle v,u\right\rangle =0 \)&lt;/span&gt; ומכיוון ש-&lt;span&gt;\( \lambda\ne\rho \)&lt;/span&gt; המסקנה היא &lt;span&gt;\( \left\langle v,u\right\rangle =0 \)&lt;/span&gt;, כפי שרציתי. עכשיו, מכך שיש לנו לכסון אוניטרי של &lt;span&gt;\( T \)&lt;/span&gt; אנחנו מקבלים שהמרחבים העצמיים של &lt;span&gt;\( T \)&lt;/span&gt; פורשים את כל &lt;span&gt;\( V \)&lt;/span&gt;, כלומר &lt;span&gt;\( V=W_{1}+\ldots+W_{n} \)&lt;/span&gt;. כדי לראות שזה סכום ישר, אפשר להסתכל על צירוף לינארי &lt;span&gt;\( w_{1}+\ldots+w_{n}=0 \)&lt;/span&gt; כך ש-&lt;span&gt;\( w_{i}\in W_{i} \)&lt;/span&gt;, לכפול אותו ב-&lt;span&gt;\( w_{i} \)&lt;/span&gt; עבור &lt;span&gt;\( 1\le i\le n \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0=\left\langle 0,w_{i}\right\rangle =\left\langle \sum_{k=1}^{n}w_{k},w_{i}\right\rangle =\sum_{k=1}^{n}\left\langle w_{k},w_{i}\right\rangle =\|w_{i}\|^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה כי אנחנו יודעים מהלכסון האוניטרי שוקטורים עצמיים שמתאימים לערכים עצמיים שונים יהיו אורתוגונליים. המסקנה היא ש-&lt;span&gt;\( w_{i}=0 \)&lt;/span&gt; לכל אחד מאברי הסכום, כלומר הצירוף הלינארי היחיד שנותן את 0 הוא 0, וזה שקול לכך ש-&lt;span&gt;\( V=W_{1}\oplus\ldots\oplus W_{n} \)&lt;/span&gt;. זה אומר שכל &lt;span&gt;\( v \)&lt;/span&gt; ניתן להצגה יחידה בתור &lt;span&gt;\( v=w_{1}+\ldots+w_{n} \)&lt;/span&gt; ואם נסמן ב-&lt;span&gt;\( E_{i} \)&lt;/span&gt; את ההטלה האורתוגונלית מ-&lt;span&gt;\( V \)&lt;/span&gt; על &lt;span&gt;\( W_{i} \)&lt;/span&gt;, אז מה שהיא עושה הוא &lt;span&gt;\( E_{i}\left(v\right)=w_{i} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;בפרט, שימו לב ש-&lt;span&gt;\( E_{1}+\ldots+E_{n}=I \)&lt;/span&gt;, כי פשוט תפעילו את אגף שמאל על &lt;span&gt;\( v \)&lt;/span&gt; ותראו מה תקבלו; ובאופן דומה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( T\left(v\right)=T\left(\sum_{i=1}^{n}w_{i}\right)=\sum_{i=1}^{n}T\left(w_{i}\right)=\sum_{i=1}^{n}\lambda_{i}w_{i}=\sum_{i=1}^{n}\lambda_{i}E_{i}\left(v\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שנותן לנו את &lt;span&gt;\( T=\lambda_{1}E_{1}+\ldots+\lambda_{n}E_{n} \)&lt;/span&gt; המובטח.&lt;/p&gt;

&lt;p&gt;הדבר הבא שמעניין לטעמי לדבר עליו אחרי שרואים לכסון אוניטרי הוא ההכללה שלו, למשהו שעובד במרחב מכפלה פנימית סוף ממדי עבור &lt;strong&gt;כל&lt;/strong&gt; מטריצה, כולל מטריצות לא ריבועיות בכלל: פירוק לערכים סינגולריים (Singular Value Decomposition, ובקיצור SVD). כאן הרעיון הוא בגדול להציג מטריצה &lt;span&gt;\( A \)&lt;/span&gt; על ידי &lt;strong&gt;שתי&lt;/strong&gt; מטריצות אוניטריות ומטריצה אלכסונית, &lt;span&gt;\( A=U\Sigma V^{*} \)&lt;/span&gt;, אבל מה המטריצות מייצגות? מה הולך באלכסון של &lt;span&gt;\( \Sigma \)&lt;/span&gt;? מה זה “ערכים סינגולריים”? לזה ראוי להקדיש פוסט משל עצמו, וזה מה שאני מתכנן לעשות בפוסט הבא. אני רק מקווה ש”הפוסט הבא” כאן לא יתגלה גם בתור “נחכה 12 שנים ואז ניזכר לכתוב אותו”.&lt;/p&gt;</content><author><name></name></author><category term="לכסון אוניטרי" /><category term="טרנספורמציה נורמלית" /><category term="מטריצה נורמלית" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">האם נמצאה נוסחה לפתרון משוואה ממעלה חמישית?! (לא)</title><link href="http://gadial.net/2025/06/18/quintic_and_catalan/" rel="alternate" type="text/html" title="האם נמצאה נוסחה לפתרון משוואה ממעלה חמישית?! (לא)" /><published>2025-06-18T00:00:00+00:00</published><updated>2025-06-18T00:00:00+00:00</updated><id>http://gadial.net/2025/06/18/quintic_and_catalan</id><content type="html" xml:base="http://gadial.net/2025/06/18/quintic_and_catalan/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;לפני כמה שבועות נתקלתי בכותרת מפוצצת: “Mathematician solves algebra’s oldest problem using intriguing new number sequences”. חיפוש זריז העלה עוד כותרות מפוצצות דומות: ““The Oldest Algebra Problem Solved”: Australian Mathematician Cracks Ancient Mystery That Baffled Minds for Over 4,000 Years” וגם “200-year-old “algebra wall” shattered with a bold new approach” ואיך אפשר בלי “Researchers Solve “Impossible” Math Problem After 200 Years”. כותרות המשנה היו מפוצצות לא פחות, למשל “A mathematician has developed an algebraic solution to an equation that was long thought to be unsolvable.”.&lt;/p&gt;

&lt;p&gt;במילים פשוטות, מאמר מתמטי (שאפשר לקרוא &lt;a href=&quot;https://www.tandfonline.com/doi/full/10.1080/00029890.2025.2460966\#abstract&quot;&gt;כאן&lt;/a&gt;) עם השם הנאה “A Hyper-Catalan Series Solution to Polynomial Equations, and the Geode” הצליח איכשהו להגיע לכותרות, והוא הגיע לשם על ידי רכיבה על הטענה שהוא עושה את הבלתי אפשרי: נותן &lt;strong&gt;נוסחה לפתרון משוואה ממעלה חמישית&lt;/strong&gt;, דבר שהוכח כבר לפני מאתיים שנה שהוא בלתי אפשרי וגם אני &lt;a href=&quot;https://gadial.net/2018/07/12/insolvability_of_the_quintic/&quot;&gt;כבר תיארתי&lt;/a&gt; אותו בבלוג. אני כבר מורגל בכותרות כאלו ולכן אחרי שהתחלתי לקרוא לא הופתעתי לגלות ש:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;המאמר לא עושה את מה שהכותרות מבטיחות.&lt;/li&gt;


&lt;li&gt;הבעיה שהיא בלתי אפשרית נותרה בלתי אפשרית כי היא בלתי אפשרית במובן מאוד &lt;strong&gt;ספציפי.&lt;/strong&gt;&lt;/li&gt;


&lt;li&gt;יש שיטות אחרות שפותרות את הבעיה הבלתי אפשרית בשיטות אחרות בצורה טובה יותר ממה שהמאמר עושה.&lt;/li&gt;


&lt;li&gt;מה שהמאמר &lt;strong&gt;כן&lt;/strong&gt; עושה הוא בהחלט נחמד ויפה, אבל במובן פורמלי ספציפי שאני לא חושב שמי שכתבו את המאמרים בעיתון מבינים.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;אז בואו נדבר על זה. כרגיל בעניינים כאלו אני רוצה להפריד בין התוכן המתמטי של המאמר העצמו, שהוא &lt;strong&gt;אחלה&lt;/strong&gt;, ובין המילים הגבוהות שבהן עוטפים את התוכן, שהן בולשיט (ואני חושש שחלק מהבולשיט במקרה הנוכחי מגיע ישירות מהחלק הלא מתמטי של המאמר).&lt;/p&gt;

&lt;p&gt;לפני שניכנס לעובי הקורה, הנה התקציר: הרעיון המרכזי של המאמר הוא להציע נוסחה לפתרון משוואות פולינומיות, שמתארת את הפתרון בתור &lt;strong&gt;סכום אינסופי&lt;/strong&gt;. בסכום האינסופי הזה מופיעים מספרים שקשורים למקדמים של המשוואה הפולינומית שאותה פותרים, ולהכללה של &lt;strong&gt;מספרי קטלן&lt;/strong&gt;, &lt;a href=&quot;https://gadial.net/2025/05/31/catalan_numbers/&quot;&gt;שתיארתי לא מזמן בבלוג&lt;/a&gt; בפירוט בדיוק בתור הכנה לפוסט הזה (וכי זה נושא נהדר בפני עצמו שהייתי צריך לקבל דחיפה קטנה כדי לכתוב עליו).&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;האם זה סותר את התוצאה שאין נוסחה לפתרון משוואה ממעלה חמישית? לא, כי התוצאה הזו מדברת על &lt;strong&gt;סוג מסוים&lt;/strong&gt; של נוסחאות: כאלו שבנויות ממספר &lt;strong&gt;סופי&lt;/strong&gt; של פעולות חיבור, חיסור, כפל, חילוק והוצאות שורש. כאן מחליפים את ה&quot;סופי&quot; ב&quot;אינסופי&quot;, ונותנים הצדקה כלשהי לכך שגם הוצאת שורש היא משהו אינסופי במהות שלו. האם אני מסכים עם הנימוק הזה? לא ממש, אבל זה פחות רלוונטי לשאלה אם זה סותר את התוצאה - זה בבירור לא סותר את התוצאה הקיימת ולכן הכותרות המפוצצות שמנגידות את התוצאה לכך שהבעיה &quot;בלתי אפשרית&quot; או שנפרצה &quot;חומה&quot; פשוט לא קשורות למה שקרה כאן.&lt;/li&gt;


&lt;li&gt;האם זה נותן שיטה &lt;strong&gt;יעילה&lt;/strong&gt; לפתרון משוואות ממעלה חמישית ביחס למה שכבר היה ידוע? ובכן, לא. אני אציג בפוסט שיטה סטנדרטית לפתרון משוואות כאלו שנקראת &lt;strong&gt;שיטת ניוטון-רפסון&lt;/strong&gt; שהיא יעילה מאוד (ויפה מאוד), ונשווה בינה לבין מה שהשיטה החדשה נותנת ונגלה למרבה ההפתעה שניוטון-רפסון כנראה טובה יותר. אגב, ניוטון-רפסון הייתה ידועה גם לפני מאתיים שנים, כשאבל וגלואה הוכיחו את התוצאות שלהם על משוואות ממעלה חמישית. חישוב יעיל הוא פשוט לא הסיפור פה (למרות שהמאמר גולש גם לכיוון הזה).&lt;/li&gt;


&lt;li&gt;אבל, וזה אולי הכי חשוב - האם זה יפה? מעניין? לטעמי כן, התוצאה שיש במאמר היא מאוד נחמדה ואני מקווה שההשוואות יעזרו לנו גם להבין קצת יותר טוב למה.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;יופי, אז עכשיו אנחנו מבינים מה אנחנו רוצים להשיג פה, בואו נעשה את זה לאט ובזהירות.&lt;/p&gt;

&lt;h2&gt;מספרי קטלן ומשוואות ממעלה שניה - מבוא&lt;/h2&gt;

&lt;p&gt;החלק הטכני של המאמר מתחיל בדוגמא שמתבססת על האופן שבו אפשר להשתמש במספרי קטלן עבור משוואות ממעלה שניה. אני אציג את זה בערך כפי שזה מוצג במאמר: הם מתחילים מלכתוב את המשוואה הריבועית בצורה הבאה: &lt;span&gt;\( 1-\alpha+t\alpha^{2}=0 \)&lt;/span&gt;. זו בוודאי לא הדרך “הסטנדרטית” שבה כותבים משוואה כזו, שהיא &lt;span&gt;\( ax^{2}+bx+c=0 \)&lt;/span&gt;, אבל אם נניח ש-&lt;span&gt;\( b=-c \)&lt;/span&gt; (זו הנחה שבהמשך יהיה קל להיפטר ממנה), ואז נחלק את כל המשוואה ב-&lt;span&gt;\( c \)&lt;/span&gt; (בהנחה שהוא שונה מאפס) נקבל את המשוואה &lt;span&gt;\( 1-x+\frac{a}{c}x^{2}=0 \)&lt;/span&gt; ולכן אם נסמן &lt;span&gt;\( t=\frac{a}{c} \)&lt;/span&gt; נקבל את הצורה שהמאמר מניח. במקרה הספציפי הזה, אפשר להשתמש בנוסחת השורשים כדי לפתור את המשוואה ולקבל &lt;span&gt;\( \alpha=\frac{1}{2t}\left(1\pm\sqrt{1-4t}\right) \)&lt;/span&gt;. עכשיו המאמר מכניס לתמונה את הבינום המוכלל של ניוטון, שתיארתי בפוסט הקודם. הרעיון בו הוא שאפשר לכתוב באופן כללי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( {r \choose n}=\frac{r\left(r-1\right)\left(r-2\right)\cdots\left(r-n+1\right)}{n!} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנכונות של הבינום לא מובנת מאליה; זו טענה שמוכיחים בעזרת חשבון דיפרנציאלי ואינטגרלי, וכדי שזה יעבוד צריך להתקיים &lt;span&gt;\( \left|x\right|&amp;lt;1 \)&lt;/span&gt;. אחרת… ובכן, למה לא לראות בעצמנו? הנה קוד פייתון פשוט שמחשב בינום מוכלל:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generalized_binomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;נניח שאני רוצה להשתמש בקוד הזה כדי לחשב את, נאמר, &lt;span&gt;\( \sqrt{\frac{1}{4}}=\frac{1}{2} \)&lt;/span&gt;. אז אני אציב &lt;span&gt;\( x=-\frac{3}{4} \)&lt;/span&gt; כדי לקבל &lt;span&gt;\( 1+x=\frac{1}{4} \)&lt;/span&gt;, ו-&lt;span&gt;\( r=\frac{1}{2} \)&lt;/span&gt;, ואקבל:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.75&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;generalized_binomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;כשאני מריץ את הקוד הזה אני מקבל &lt;span&gt;\( 0.5000000000 \)&lt;/span&gt; - יופי של דבר! ומה אם, למשל, אני רוצה לקבל את &lt;span&gt;\( \sqrt{2} \)&lt;/span&gt;? אני אציב &lt;span&gt;\( x=1 \)&lt;/span&gt; ואקבל &lt;span&gt;\( 1.4143562059 \)&lt;/span&gt; שזה לא רע בכלל אחרי בסך הכל 100 איברים שאני מחבר. ואם אני רוצה לחשב את &lt;span&gt;\( \sqrt{4}=2 \)&lt;/span&gt;? אז אני אציב &lt;span&gt;\( x=3 \)&lt;/span&gt; ואקבל… אה… את זה:&lt;/p&gt;

&lt;p&gt;36897381732338865935269100862142478752415744.0000000000&lt;/p&gt;

&lt;p&gt;אוקיי, משהו כאן בבירור הפסיק לעבוד.&lt;/p&gt;

&lt;p&gt;ברוכים הבאים לעולם המופלא של טורי חזקות. לטור חזקות &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt; יש תמיד &lt;strong&gt;רדיוס התכנסות&lt;/strong&gt;. מספר &lt;span&gt;\( R \)&lt;/span&gt; כך שאם &lt;span&gt;\( \left|x\right|&amp;lt;R \)&lt;/span&gt; אז הטור מתכנס, ואם &lt;span&gt;\( \left|x\right|&amp;gt;R \)&lt;/span&gt; אז הטור מתבדר (גדל עוד ועוד עד אינסוף). מה קורה ב-&lt;span&gt;\( \left|x\right|=R \)&lt;/span&gt;? כאן לא מובטח כלום. זה יכול להתכנס ויכול להתבדר, אין חוקים.&lt;/p&gt;

&lt;p&gt;רדיוס ההתכנסות של טור חזקות תלוי במקדמים שלו, יש שתי שיטות מקובלות לחשב אותו: שיטת השורש ושיטת המנה. בשיטת השורש, מגדירים &lt;span&gt;\( R \)&lt;/span&gt; על ידי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{R}=\lim\sup_{n\to\infty}\sqrt[n]{\left|a_{n}\right|} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר אם הגבול בצד ימין יוצא 0 אז &lt;span&gt;\( R=\infty \)&lt;/span&gt; (הטור מתכנס לכל ערך) ואם הוא יוצא אינסוף אז &lt;span&gt;\( R=0 \)&lt;/span&gt; (הטור לא מתכנס בכלל). ייתכן שאתם לא מכירים את &lt;span&gt;\( \lim\sup_{n\to\infty} \)&lt;/span&gt;. הצגתי את המושג &lt;a href=&quot;https://gadial.net/2014/04/08/limsup_and_liminf/&quot;&gt;בפוסט הזה&lt;/a&gt;, אבל הנה תזכורת זריזה:&lt;/p&gt;

&lt;p&gt;באופן כללי, &lt;span&gt;\( \lim\sup_{n\to\infty}x_{n}=\lim_{n\to\infty}\left(\sup_{m\ge n}x_{m}\right) \)&lt;/span&gt; כלומר - הרעיון הוא לעבור מהסדרה המקורית &lt;span&gt;\( \left\{ x_{n}\right\} _{n=1}^{\infty} \)&lt;/span&gt;שיכולה “להשתגע” ולקפץ מעלה-ומטה ומהומות ובעיות, אל סדרה שמתנהגת יותר נחמד: &lt;span&gt;\( \left\{ y_{n}\right\} _{n=1}^{\infty} \)&lt;/span&gt; כך ש-&lt;span&gt;\( y_{n}=\sup\left\{ x_{m}\ |\ m\ge n\right\}  \)&lt;/span&gt;. כאשר &lt;span&gt;\( \sup \)&lt;/span&gt; הוא המושג הרגיל של חסם עליון. הסיבה לשימוש ב-&lt;span&gt;\( \lim\sup \)&lt;/span&gt; היא כדי להבטיח שהגבול תמיד יהיה קיים (למרות שהוא יכול להיות אינסוף), כך שהנוסחה “תמיד עובדת”.&lt;/p&gt;

&lt;p&gt;לפעמים יותר קל לחשב את &lt;span&gt;\( R \)&lt;/span&gt; באופן הבא: &lt;span&gt;\( R=\lim_{n\to\infty}\left|\frac{a_{n}}{a_{n+1}}\right| \)&lt;/span&gt; - זו “שיטת המנה” שהזכרתי, אבל הבעיה בה היא שלא תמיד הגבול קיים. מה שמובטח הוא שאם הגבול קיים, הוא שווה לרדיוס ההתכנסות.&lt;/p&gt;

&lt;p&gt;איך זה מתקשר לדוגמא שראינו? בדוגמא שלנו, &lt;span&gt;\( a_{n}={r \choose n}=\frac{r\left(r-1\right)\left(r-2\right)\cdots\left(r-n+1\right)}{n!} \)&lt;/span&gt;. ההגדרה הזו נראית מתאימה עבור מבחן המנה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{a_{n}}{a_{n+1}}=\frac{\left(n+1\right)!}{n!}\frac{r\left(r-1\right)\left(r-2\right)\cdots\left(r-n+1\right)}{r\left(r-1\right)\left(r-2\right)\cdots\left(r-n\right)}=\frac{n}{r-n}=\frac{1}{\frac{r}{n}-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;החשבון הזה מניח ש-&lt;span&gt;\( r \)&lt;/span&gt; הוא לא מספר טבעי ולכן אין סיכון שיופיע לנו 0 במונה ובמכנה (אם &lt;span&gt;\( r \)&lt;/span&gt; הוא טבעי אז נוסחת הבינום נותנת לנו סכום סופי שמתכנס תמיד) ומכיוון ש-&lt;span&gt;\( \lim_{n\to\infty}\frac{r}{n}=0 \)&lt;/span&gt; אנחנו מקבלים ממנו שרדיוס ההתכנסות הוא תמיד 1, מה שמתאים יפה להתנהגות שראינו, עם הדוגמה של &lt;span&gt;\( \sqrt{\frac{1}{4}} \)&lt;/span&gt; שעבדה יפה (&lt;span&gt;\( x=-\frac{3}{4} \)&lt;/span&gt;), הדוגמא של &lt;span&gt;\( \sqrt{2} \)&lt;/span&gt; שעדיין עבדה למרות שהיא על רדיוס ההתכנסות (&lt;span&gt;\( x=1 \)&lt;/span&gt;) והדוגמא של &lt;span&gt;\( \sqrt{4} \)&lt;/span&gt; שהיא לכאורה חישוב פשוט אבל נכשלה לחלוטין כי זה כבר מעבר לרדיוס ההתכנסות (&lt;span&gt;\( x=3 \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;נחזור אל המאמר. המאמר הגיע אל הנוסחה &lt;span&gt;\( \alpha=\frac{1}{2t}\left(1\pm\sqrt{1-4t}\right) \)&lt;/span&gt; ואז אמר שנשתמש בבינום של ניוטון על הפתרון עם סימן המינוס ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \alpha=\sum_{n=0}^{\infty}\frac{\left(2n\right)!}{n!\left(n+1\right)!}t^{n}=\sum_{n=0}^{\infty}C_{n}t^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( C_{n} \)&lt;/span&gt; הם מספרי קטלן.&lt;/p&gt;

&lt;p&gt;יש כאן, כמובן, דילוג על כמה שלבים של חישוב, אבל למרבה המזל כבר עשיתי את הכל בפירוט בפוסט הקודם שלי, על הפונקציה היוצרת של מספרי קטלן: ראינו שם שהיא &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;, כאשר &lt;span&gt;\( C\left(x\right)=\sum_{n=0}^{\infty}C_{n}x^{n} \)&lt;/span&gt;. ה-&lt;span&gt;\( \frac{\left(2n\right)!}{n!\left(n+1\right)!} \)&lt;/span&gt; שמופיע במאמר זו פשוט דרך מפורשת לכתוב את מספרי קטלן, &lt;span&gt;\( C_{n}=\frac{\left(2n\right)!}{n!\left(n+1\right)!}=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;. המאמר משתמש ב-&lt;span&gt;\( t \)&lt;/span&gt; בתור המשתנה של הסכימה ולא ב-&lt;span&gt;\( x \)&lt;/span&gt;, אבל זה כל ההבדל.&lt;/p&gt;

&lt;p&gt;ועכשיו נשאלת השאלה - אוקיי, אז מה עשינו כאן בעצם? למאמר יש ניסוח טכני מדויק למה שעשינו כאן (שהוא לא מגדיר בשום מקום את משמעותו):&lt;/p&gt;

&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
Applying Newton’s binomial expansion to the minus sign solution reveals the generating series of the Catalan numbers as the formal power series solution:
&lt;/blockquote&gt;

&lt;p&gt;מילות המפתח כאן הן “Formal power series solution”. מה זה טור חזקות פורמלי - הקדשתי את כל הפוסט הקודם כדי להסביר, ואני לא אחזור על הפרטים הטכניים כאן אבל הרעיון המרכזי הוא זה: השוויון &lt;span&gt;\( \frac{1-\sqrt{1-4x}}{2x}=\sum_{n=0}^{\infty}C_{n}x^{n} \)&lt;/span&gt; הוא נכון &lt;strong&gt;בלי להציב ערכים&lt;/strong&gt; ב-&lt;span&gt;\( x \)&lt;/span&gt;. השוויון הזה לא אומר “לכל ערך שנציב ב-&lt;span&gt;\( x \)&lt;/span&gt;, אגף שמאל יהיה שווה לאגף ימין”. זו לא משוואה במובן הזה. השוויון אומר “האובייקט המתמטי שמופיע בצד שמאל הוא בדיוק אותו אובייקט כמו זה שמופיע באגף ימין”, כש”האובייקט” הוא מה שנקרא &lt;strong&gt;טור חזקות פורמלי&lt;/strong&gt;. בטור שכזה האיקסים הם לא משהו שמציבים בו ערכים אלא משהו ש”מחזיק” את המקדמים. נשמע מוזר? כן, לכן הפוסט הקודם שלי מדבר על זה. ברצינות, אם זה מפריע לכם, קראו את הפוסט הקודם.&lt;/p&gt;

&lt;p&gt;אבל אם מבינים את &lt;span&gt;\( \frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt; בתור ביטוי פורמלי נטו, משהו שלא אמורים להציב בו דברים, מה המשמעות של לכתוב &lt;span&gt;\( \alpha=\frac{1-\sqrt{1-4t}}{2t} \)&lt;/span&gt;, כמו שהמאמר עושה? המאמר מתחיל עם המשוואה &lt;span&gt;\( 1-\alpha+t\alpha^{2}=0 \)&lt;/span&gt;. מה זו המשוואה הזו? גם זה ביטוי פורמלי או שהרעיון פה הוא שמציבים ערך בפרמטר &lt;span&gt;\( t \)&lt;/span&gt; ואז מקבלים משוואה שבאמת אפשר לפתור? כלומר, האם &lt;span&gt;\( \alpha \)&lt;/span&gt; כאן מייצג &lt;strong&gt;מספר&lt;/strong&gt; שמאופיין על ידי כך שהוא פותר משוואה פולינומית ואנחנו מחפשים דרך טובה לייצר את המספר הזה, או ש-&lt;span&gt;\( \alpha \)&lt;/span&gt; מייצג כאן מלכתחילה &lt;strong&gt;טור חזקות פורמלי&lt;/strong&gt; ולכן ה”פתרון” של המשוואה &lt;span&gt;\( 1-\alpha+t\alpha^{2}=0 \)&lt;/span&gt; הוא נוסחה מפורשת לסדרת המקדמים של הטור הזה?&lt;/p&gt;

&lt;p&gt;זה העניין; המאמר לא אומר. אז מלכתחילה לא לגמרי ברור מה המאמר עושה. אפשר ללכת אחורה, אל פרק המבוא, כדי לנסות להבין מה המטרה; אבל אני דווקא מעדיף לא לעשות את זה. פרקי מבוא הם לרוב המקומות שבהם מחפפים, כדי לתת לקורא מושג כללי לגבי מה שהולך לבוא בהמשך - ההמשך זה המקום שבו המושגים המדויקים צריכים להגיע. אבל אוקיי, אנחנו עדיין רק רואים דוגמא, אז אפשר לזרום עם זה ולראות לאן זה הולך.&lt;/p&gt;

&lt;p&gt;השאלה המעניינת שעולה כרגע היא - אוקיי, אנחנו מקבלים את זה שהראינו את השוויון הפורמלי &lt;span&gt;\( \alpha=\frac{1-\sqrt{1-4t}}{2t}=\sum_{n=0}^{\infty}C_{n}t^{n} \)&lt;/span&gt;. האם אפשר להשתמש בזה כדי לחשב פתרונות של המשוואה הריבועית &lt;span&gt;\( 1-\alpha+t\alpha^{2}=0 \)&lt;/span&gt; עבור ערכים &lt;strong&gt;קונקרטיים&lt;/strong&gt; של &lt;span&gt;\( t \)&lt;/span&gt;? כלומר, להציב ערך מספרי ב-&lt;span&gt;\( t \)&lt;/span&gt; ואז לחשב את &lt;span&gt;\( \sum_{n=0}^{\infty}C_{n}t^{n} \)&lt;/span&gt; ולקבל את הערך? התשובה היא שבהחלט אפשר! אבל… בכפוף לקטע הזה של “רדיוס התכנסות”, מה שאומר שעבור רוב ערכי &lt;span&gt;\( t \)&lt;/span&gt; זה לא יעבוד.&lt;/p&gt;

&lt;p&gt;מה רדיוס ההתכנסות של הטור? אפשר להשתמש במבחן המנה כמו קודם:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{C_{n}}{C_{n+1}}=\frac{\left(2n\right)!}{n!\left(n+1\right)!}\frac{\left(n+1\right)!\left(n+2\right)!}{\left(2n+2\right)!}=\frac{\left(n+1\right)\left(n+2\right)}{\left(2n+1\right)\left(2n+2\right)}=\frac{n^{2}+2n+2}{4n^{2}+6n+2}\to\frac{1}{4} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, הרדיוס הוא &lt;span&gt;\( R=\frac{1}{4} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;רציתי לבחור &lt;span&gt;\( t \)&lt;/span&gt; קטן מהרדיוס שעדיין נותן עבור &lt;span&gt;\( \alpha \)&lt;/span&gt; ערך “נחמד” שאפשר לחשב ידנית, אז הינדסתי את &lt;span&gt;\( t=\frac{2}{9} \)&lt;/span&gt;. הערך הזה נותן לנו את המשוואה הריבועית &lt;span&gt;\( 2\alpha^{2}-9\alpha+9=0 \)&lt;/span&gt; שהפתרונות שלה הם&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \alpha_{1,2}=\frac{9\pm\sqrt{81-72}}{4}=\frac{9\pm\sqrt{9}}{4}=\frac{9\pm3}{4}=3,1.5 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( 1.5 \)&lt;/span&gt; הוא הפתרון שמתקבל מהמינוס. עכשיו, הנה קוד שיאפשר לנו לחשב מה קורה:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;   
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;כשאני מריץ אותו אני מקבל &lt;span&gt;\( 1.4999999653 \)&lt;/span&gt; שזה יפה מאוד, ואם אני מעלה את &lt;span&gt;\( N \)&lt;/span&gt; אל &lt;span&gt;\( 200 \)&lt;/span&gt; אני מקבל כבר &lt;span&gt;\( 1.5 \)&lt;/span&gt; (זה עדיין לא &lt;strong&gt;בדיוק&lt;/strong&gt; &lt;span&gt;\( 1.5 \)&lt;/span&gt; אלא רק במסגרת 10 ספרות הדיוק שאני מציג). כלומר זה עובד, ועובד יפה! כל עוד &lt;span&gt;\( t&amp;lt;\frac{1}{4} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה קורה אם &lt;span&gt;\( t=\frac{1}{4} \)&lt;/span&gt;? כאן אז אנחנו מקבלים את המשוואה &lt;span&gt;\( \alpha^{2}-4t+4=0 \)&lt;/span&gt; שנפתרת על ידי &lt;span&gt;\( \alpha=2 \)&lt;/span&gt;. אם נחשב את הטור &lt;span&gt;\( \sum_{n=0}^{\infty}\frac{C_{n}}{4^{n}} \)&lt;/span&gt; עם הקוד שלי נקבל עבור &lt;span&gt;\( N=100 \)&lt;/span&gt; את התוצאה &lt;span&gt;\( 1.8873030420 \)&lt;/span&gt; שזה… אה… די קרוב ל-2! בטח אם אני אחבר יותר איברים, כלומר אגדיל את &lt;span&gt;\( N \)&lt;/span&gt;, אני אתקרב עוד יותר ל-2. אם אני מציב &lt;span&gt;\( N=500 \)&lt;/span&gt; אני מקבל &lt;span&gt;\( 1.9495499636 \)&lt;/span&gt;, שזה טוב! זה הולך ומתקרב אל 2! אבל אז…! כשאני מציב &lt;span&gt;\( N=600 \)&lt;/span&gt;! אני פתאום מקבל “nan”. מה זה אומר בכלל? זה אומר שתש כוחו של פייתון. היכולת שלו לעשות חישובים עם המספרים הרלוונטיים נגמרה. במקרה הנוכחי, מה שגומר אותו זה ה-&lt;span&gt;\( \frac{1}{4^{n}} \)&lt;/span&gt; שהופך להיות כל כך קטן ששיטת הייצוג הסטנדרטית של נקודה צפה (דיברתי על זה קצת &lt;a href=&quot;https://gadial.net/2017/08/24/0x5f3759df_part_2/&quot;&gt;כאן&lt;/a&gt;) כבר לא מסוגלת לייצג אותו. זה נשמע כמובן טיפה הזוי - אם זה מספר &lt;strong&gt;כל כך קטן&lt;/strong&gt; למה שהוא בכלל עוד ישפיע על הסכום? כלומר, למה אפילו ב-&lt;span&gt;\( N=500 \)&lt;/span&gt; עדיין לא קיבלנו את התוצאה 2 ברמת דיוק של 10 ספרות? ובכן, כי כמה ש-&lt;span&gt;\( \frac{1}{4^{n}} \)&lt;/span&gt; הוא קטן מתקזז עם כמה ש-&lt;span&gt;\( C_{n} \)&lt;/span&gt; הוא גדול. במילים אחרות, ייצוג כזה באמצעות טור הוא לא ייצוג &lt;strong&gt;יעיל&lt;/strong&gt;, כי הטור מורכב משני גורמים אקספוננציאליים שרבים זה עם זה ומקזזים זה את זה. זה בעצם מה שמבחני המנה והשורש מראים לנו - מה קצב הגידול של המקדמים שהחזקה נאלצת להתמודד איתם. כל עוד החזקה גדולה יותר מקצב הגידול הזה, הטור יתכנס מהר יחסית; אבל כשהם שווים זה יכול להיות עניין כואב ביותר ושום דבר לא מובטח, ואם הם גדולים יותר…&lt;/p&gt;

&lt;p&gt;אם אני מציב למשל &lt;span&gt;\( t=-2 \)&lt;/span&gt; אני מקבל את המשוואה &lt;span&gt;\( 2\alpha^{2}+\alpha-1=0 \)&lt;/span&gt; עם הפתרונות &lt;span&gt;\( \alpha_{1,2}=\frac{-1\pm\sqrt{1+8}}{4}=\frac{-1\pm3}{4}=-1,0.5 \)&lt;/span&gt; אבל אם אציב את זה בקוד שלי, אפילו עבור &lt;span&gt;\( N=10 \)&lt;/span&gt;, אני אקבל בערך &lt;span&gt;\( -2170881 \)&lt;/span&gt; ומשם זה רק נהיה יותר ויותר גרוע. הטור לא עובד במקרים כאלו, תשכחו מזה.&lt;/p&gt;

&lt;p&gt;יש לכאורה עוד בעיה פה - הטור נותן לי רק פתרון אחד, מה עם השני? זה פחות מפריע לי כי תמיד אפשר לפתור משוואות בצורה הבאה: אם &lt;span&gt;\( p\left(x\right) \)&lt;/span&gt; הוא הפולינום שמקודד את המשוואה, מוצאים שורש אחד ספציפי &lt;span&gt;\( p\left(\alpha\right)=0 \)&lt;/span&gt; ואז מחלקים ומקבלים &lt;span&gt;\( q\left(x\right)=\frac{p\left(x\right)}{x-\alpha} \)&lt;/span&gt;. זה עובד, ושורש של &lt;span&gt;\( q\left(x\right) \)&lt;/span&gt; יהיה גם שורש של &lt;span&gt;\( p\left(x\right) \)&lt;/span&gt; ובצורה הזו אפשר למצוא את כל השורשים… אם כי אני בעצם מניח כאן במובלע שאם את &lt;span&gt;\( p\left(x\right) \)&lt;/span&gt; הייתי מסוגל לפתור עם הטור הזה אני אוכל לפתור גם את &lt;span&gt;\( q\left(x\right) \)&lt;/span&gt; באותה צורה, וראינו כבר שזה לא בהכרח נכון - זה מאוד תלוי במקדמים.&lt;/p&gt;

&lt;p&gt;האם זה אומר שיש משוואות שהשיטה פשוט לא מסוגלת לפתור? לא! בהמשך המאמר יש התייחסות לזה. אז בואו נראה את השלב שבו הוא מתחיל לפרמל דברים.&lt;/p&gt;

&lt;h2&gt;מספרי קטלן ומשוואות ממעלה שניה - הגישה הפורמלית של המאמר&lt;/h2&gt;

&lt;p&gt;בחלק 4 שלו, המאמר ממשיך לדבר על המקרה של מספרי קטלן ומשוואות ממעלה שניה, אבל מציג את הלב הטכני של מה שהוא עושה - אם מבינים את זה, אפשר להבין את התוצאה הכללית שלו די בקלות.&lt;/p&gt;

&lt;p&gt;ראשית, המאמר בוחר בעיה קומבינטורית ספציפית שמספרי קטלן פותרים, ומתמקד בה. תיארתי שלל בעיות כאלו &lt;a href=&quot;https://gadial.net/2025/05/31/catalan_numbers/&quot;&gt;בפוסט שלי&lt;/a&gt; על מספרי קטלן, והמאמר בוחר להתבסס על אחת מוכרת במיוחד, זו שדי ייסדה את התחום כשאוילר פתר אותה - שילושים של מצולעים.&lt;/p&gt;

&lt;p&gt;כשמתעסקים בשילושים של מצולעים, צריך איכשהו להבדיל בין שני שילושים שנראים “אותו דבר עד כדי סיבוב”. בפוסט שלי הדרך להשיג את זה הייתה &lt;strong&gt;למספר את הקודקודים&lt;/strong&gt; של המצולע; המאמר משיג את האפקט הזה על ידי סימון אחת הצלעות של המצולע בתור “גג” וכשמציירים את המצולע, היא מצויירת למעלה - זה היה התפקיד של הצלע 1-2 אצלי. לפוליגון עם צלע שהיא גג שכבר עבר חלוקה למשולשים המאמר קורא Triagon ומשתמש בסימון &lt;span&gt;\( | \)&lt;/span&gt; (קו אנכי) כדי לתאר את המקרה המנוון של “מצולע” בן שתי צלעות - משהו שראינו בפוסט שלי שמשתלם לספור. המאמר מסמן ב-&lt;span&gt;\( \mathcal{T}_{n} \)&lt;/span&gt; את אוסף הטריגונים עם &lt;span&gt;\( n \)&lt;/span&gt; &lt;strong&gt;פאות&lt;/strong&gt;; כלומר, מספר המשולשים שיש בתוך הטריגון. זו דרך חכמה לעקוף את ניג’וס ה-&lt;span&gt;\( n+2 \)&lt;/span&gt; שמתלווה לפוליגונים הללו כשסופרים את הקודקודים. עם הסימון הזה, &lt;span&gt;\( \left|\mathcal{T}_{n}\right|=C_{n} \)&lt;/span&gt;. כמובן, זה מניח שאנחנו &lt;strong&gt;מזהים&lt;/strong&gt; טריגונים שהם “אותו הדבר” אפילו אם הצורה שלהם קצת שונה - אני מניח שאנחנו בסדר עם זה.&lt;/p&gt;

&lt;p&gt;עכשיו המאמר מסביר בצורה מפורטת איך אפשר לבנות טריגון חדש משניים קיימים. בגדול, זה ההיפוך של התהליך שתיארתי בפוסט שלי - שם הסרנו את הצלע 1-2 וקיבלנו שני טריגונים, כך שמספר הפאות הכולל שלהם הוא כמספר הפאות בטריגון שהתחלנו ממנו, פחות 1. כשמסמנים את הפונקציה היוצרת של הטריגונים על ידי &lt;span&gt;\( T\left[t\right] \)&lt;/span&gt; כפי שהמאמר עושה, זה מוביל למשוואה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( T=1+tT^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בניות כאלו מוסברות בצורה יותר מקיפה בספר הנהדר Analytic Combinatorics של Flajolet ו-Sedgewick שכרגע זמין במלואו באופן חופשי &lt;a href=&quot;https://algo.inria.fr/flajolet/Publications/book.pdf&quot;&gt;כאן&lt;/a&gt;. הבניה עבור קטלן מוסברת בעמוד 35-36; בגדול, אפשר לחשוב על כל טריגון בתור אחד משני דברים: או הטריגון המנוון &lt;span&gt;\( | \)&lt;/span&gt; וכזה יש בדיוק 1, מגודל 0, ולכן התרומה שלו ל-&lt;span&gt;\( T\left[t\right] \)&lt;/span&gt; היא &lt;span&gt;\( 1\cdot t^{0} \)&lt;/span&gt;; או טריגון שאפשר לתאר בתור משהו שבנוי משלושה טריגונים: שניים מגודל כלשהו ואחד מגודל 1 (המשולש שמסירים כשמוחקים את הצלע 1-2). מכיוון שמכפלה של פונקציות יוצרות מתאימה בדיוק לסיטואציה של בניה של אובייקט קומבינטורי מהאובייקטים שמתוארים על ידי הפונקציות שמכפילים, כך שהגודל של האובייקט הקומבינטורי הזה הוא סכום הגדלים של המוכפלים, מקבלים עבור המקרה הזה את &lt;span&gt;\( T\cdot t\cdot T=tT^{2} \)&lt;/span&gt;. דרך ההתבוננות הזו היא ממש מועילה ולמי שזה מעניין אותה אני ממליץ לקרוא את הספר (רק את החלק הראשון שלו! היתר זה נושאים, אה, שונים) והתייחסתי לזה קצת יותר &lt;a href=&quot;https://gadial.net/2011/08/07/generating_functions_hardcore_1/&quot;&gt;בפוסטים שכתבתי בשעתו&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;בקיצור, קיבלנו את הנוסחה &lt;span&gt;\( T=1+tT^{2} \)&lt;/span&gt; שבפוסט הקודם שלי ראינו כבר שהיא הנוסחה שמקיימים מספרי קטלן ומכאן המאמר מרשה לעצמו לכתוב &lt;span&gt;\( T=\sum_{n=0}^{\infty}C_{n}t^{n} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, אם נעביר את &lt;span&gt;\( T \)&lt;/span&gt; אגף נקבל את המשוואה &lt;span&gt;\( 1-T+tT^{2}=0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( T \)&lt;/span&gt; מקיים משוואה ריבועית מצורה ספציפית: המקדם החופשי הוא 1 והמקדם של החזקה הבאה הוא &lt;span&gt;\( -1 \)&lt;/span&gt;. המאמר אומר שפולינום שמקיים את שתי הדרישות הללו הוא &lt;strong&gt;בצורה גאומטרית&lt;/strong&gt; ושהמשוואה הריבועית &lt;span&gt;\( 1-\alpha+t\alpha^{2} \)&lt;/span&gt; היא &lt;strong&gt;המשוואה הריבועית הגאומטרית הכללית&lt;/strong&gt;. בהתבסס על התוצאה הקומבינטורית שהוא הראה (שהיא, כאמור, סטנדרטית) הוא מסיק את מה שהוא מכנה &lt;strong&gt;משפט &lt;/strong&gt;&lt;strong&gt;1&lt;/strong&gt;: שלמשוואה &lt;span&gt;\( 1-\alpha+t\alpha^{2} \)&lt;/span&gt; יש “formal power series solution” שהוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \alpha=T\left[t\right]=\sum_{n=0}^{\infty}C_{n}t^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אני חייב להודות שאני לא בטוח מה התוכן של המשפט הזה מעבר ל”הפונקציה היוצרת של מספרי קטלן מקיימת את המשוואה הריבועית &lt;span&gt;\( 1-\alpha+t\alpha^{2} \)&lt;/span&gt;” - וזו כאמור טענה סטנדרטית עוד מימי אוילר. המאמר קורא לזה &lt;strong&gt;הנוסחה הגאומטרית הריבועית הרכה&lt;/strong&gt; שזה שם מפוצץ לדבר קיים, אבל מייד אחר כך מגיע תוכן קצת יותר מעניין - הסבר איך אפשר לעבור מהמקרה הזה לפתרון של משוואה ריבועית &lt;strong&gt;כללית&lt;/strong&gt;, לא כזו שהיא בצורה גאומטרית. לזה הוא קורא &lt;strong&gt;משפט &lt;/strong&gt;&lt;strong&gt;2&lt;/strong&gt; ונותן לו את השם הטיפה פחות מפוצץ &lt;strong&gt;הנוסחה הריבועית הרכה&lt;/strong&gt;. זה הולך ככה: נסמן משוואה ריבועית כללית בתור &lt;span&gt;\( c_{0}-c_{1}x+c_{2}x^{2}=0 \)&lt;/span&gt;. עכשיו נבצע החלפת משתנים: נסמן, &lt;span&gt;\( x=\frac{c_{0}}{c_{1}}\alpha \)&lt;/span&gt; נציב במשוואה ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{0}\left(1-\alpha+\frac{c_{0}c_{2}}{c_{1}^{2}}\alpha^{2}\right)=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו נשתמש במשפט הקודם עם &lt;span&gt;\( t=\frac{c_{0}c_{2}}{c_{1}^{2}} \)&lt;/span&gt; ונקבל את הפתרון הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \alpha=\sum_{n=0}^{\infty}C_{n}\frac{c_{0}^{n}c_{2}^{n}}{c_{1}^{2n}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אלא שאנחנו רוצים את &lt;span&gt;\( x \)&lt;/span&gt;, לא את &lt;span&gt;\( \alpha \)&lt;/span&gt;, אז נכפול הכל ב-&lt;span&gt;\( c_{0} \)&lt;/span&gt; ונחלק ב-&lt;span&gt;\( c_{1} \)&lt;/span&gt; ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=\sum_{n=0}^{\infty}C_{n}\frac{c_{0}^{1+n}c_{2}^{n}}{c_{1}^{1+2n}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו כבר נוסחה קונקרטית ומעניינת! רק מה, היא… לא לגמרי עובדת. ראשית, יש לנו חלוקה ב-&lt;span&gt;\( c_{1} \)&lt;/span&gt;, זה אומר שאם &lt;span&gt;\( c_{1}=0 \)&lt;/span&gt; (כמו למשל במשוואה &lt;span&gt;\( x^{2}=2 \)&lt;/span&gt;) השיטה נכשלת. המאמר מתייחס לזה:&lt;/p&gt;

&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
It’s curious that the equation with the easiest solution in radicals is the least accessible with this method. A simple change of variables lets us skirt around the problem.
&lt;/blockquote&gt;

&lt;p&gt;אם &lt;span&gt;\( c_{0}=0 \)&lt;/span&gt; אז המשוואה שלנו היא מהצורה &lt;span&gt;\( c_{2}x^{2}=c_{1}x \)&lt;/span&gt; ולכן יש לה את הפתרון הטריוויאלי &lt;span&gt;\( x=0 \)&lt;/span&gt;; זה מה שהנוסחה משיגה במקרה הזה; בשביל להשיג את הפתרון השני צריך להשתמש בטריק החלוקה שתיארתי קודם. האם זה אומר שהנוסחה שהם מצאו היא “לא כללית”? אני לא חושב שזה כזה בעייתי. אם תסתכלו בפוסט שלי על &lt;a href=&quot;https://gadial.net/2018/07/16/solving_cubic_equations/&quot;&gt;פתרון משוואה ממעלה שלישית&lt;/a&gt;, גם שם משתמשים בטריקים של החלפת משתנים, למשל. כדי להרגיש שיש בעיה עם מקרי הקיצון הללו צריך להיות ממש טהרנים לגבי מה זה אומר שיש “פתרון כללי” למשוואה.&lt;/p&gt;

&lt;p&gt;אבל הבעיה האמיתית, שכבר ראינו קודם, היא שהטור הזה פשוט &lt;strong&gt;לא מתכנס&lt;/strong&gt; עבור חלק מהמספרים. המאמר לא מתייחס לזה שם, ואני מניח שזה בצדק מבחינתו כי לומר “formal power series solution” זה לכאורה לצאת ידי חובה. בהמשך, כאמור, תהיה התייחסות יותר רצינית לזה אז נעזוב את זה לבינתיים.&lt;/p&gt;

&lt;p&gt;יופי, אז הבנו את הסיפור עם משוואה ממעלה שניה. עכשיו, מה קורה באופן כללי? למרבה המזל זה יהיה השלב הקל יחסית להבנה אם עיכלנו את מה שקרה עד כה.&lt;/p&gt;

&lt;h2&gt;מספרי היפר-קטלן ומשוואות ממעלה כלשהי&lt;/h2&gt;

&lt;p&gt;לפני שנראה מה המאמר עושה, בואו נחשוב שניה מה היינו רוצים שיקרה. עבור משוואה ממעלה שניה, מספרי קטלן נתנו לנו את הנוסחה &lt;span&gt;\( T=1+tT^{2} \)&lt;/span&gt;. עבור משוואה ממעלה שלישית, אולי אפשר למצוא בעיה מקבילה עם משוואה מהצורה &lt;span&gt;\( T=1+tT^{2}+tT^{3} \)&lt;/span&gt;? זה לא כזה קשה - רק צריך למצוא אובייקט שנספר על ידי &lt;span&gt;\( T \)&lt;/span&gt;, יש 1 ממנו שהוא מגודל 0, ואפשר לבנות אותו מחיבור של שניים או שלושה אובייקטים, ואז הגודל שלו הוא סכום הגדלים שלהם ועוד 1. להמציא כזה אובייקט זה כנראה לא כל כך קשה (אם תפתחו ב-Analytic Combinatorics את החלק של Context-free specifications and languages תראו דרך כללית לעשות דברים כאלו) אבל יש כאן שתי בעיות. ראשית, לא ברור אם נוכל למצוא נוסחה מפורשת לכמות האיברים שמתאימים לאובייקט, כמו זו שהייתה לנו עבור קטלן; ושנית, המשוואה שלנו יוצאת מאוד מוגבלת - המקדם של &lt;span&gt;\( T^{2} \)&lt;/span&gt; זהה למקדם של &lt;span&gt;\( T^{3} \)&lt;/span&gt;, וללהטוטים שעשינו קודם יש גבול, הם לא יצליחו לטפל גם בזה.&lt;/p&gt;

&lt;p&gt;אז כאן המאמר עושה משהו &lt;strong&gt;יפה&lt;/strong&gt;: במקום לעבוד עם פונקציה יוצרת במשתנה בודד, הוא עובר לעבוד עם פונקציה יוצרת במספר משתנים. בואו נבין איך זה ייראה עבור משוואה ממעלה שלישית, ואז נוכל להגיע כבר למשוואה כללית. עבור מעלה שלישית, המטרה היא למצוא פונקציה יוצרת &lt;span&gt;\( S\left[t_{2},t_{3}\right] \)&lt;/span&gt; כך ש-&lt;span&gt;\( S=1+t_{2}S^{2}+t_{3}S^{3} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה &lt;span&gt;\( S \)&lt;/span&gt; הולכת לספור? ובכן, קודם היה לנו את &lt;span&gt;\( T=\sum_{n=0}^{\infty}\left|\mathcal{T}_{n}\right|t^{n} \)&lt;/span&gt;, כך ש-&lt;span&gt;\( \mathcal{T}_{n} \)&lt;/span&gt; הייתה קבוצה של טריגונים, כלומר פוליגונים עם צלע מובחנת ספציפית שמחולקים &lt;strong&gt;למשולשים&lt;/strong&gt;, וספציפית ב-&lt;span&gt;\( \mathcal{T}_{n} \)&lt;/span&gt; היו הטריגונים שמחולקים ל-&lt;span&gt;\( n \)&lt;/span&gt; משולשים. אבל מה אם נרשה חלוקה גם למשולשים וגם &lt;strong&gt;למרובעים&lt;/strong&gt;? אפשר לסמן ב- &lt;span&gt;\( \mathcal{S}_{\left[m_{2},m_{3}\right]} \)&lt;/span&gt; את מספר הפוליגונים עם צלע מובחנת שמחולקים ל-&lt;span&gt;\( m_{2} \)&lt;/span&gt; משולשים ו-&lt;span&gt;\( m_{3} \)&lt;/span&gt; מרובעים, ו-&lt;span&gt;\( \left[m_{2},m_{3}\right] \)&lt;/span&gt; ייקרא &lt;strong&gt;הטיפוס&lt;/strong&gt; של ה… אה… לא נקרא לזה טריגון (כי tri זה שלוש, ועברנו לדבר על חלוקה פנימית לדברים עם יותר משלוש צלעות) - במאמר קוראים לזה סבדיגון (subdigon). עכשיו נגדיר את מספר ההיפר-קטלן &lt;span&gt;\( C_{\left[m_{2},m_{3}\right]} \)&lt;/span&gt; בתור מספר הסבדיגונים מטיפוס &lt;span&gt;\( \left[m_{2},m_{3}\right] \)&lt;/span&gt; ונגדיר פונקציה יוצרת עם שני משתנים,&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S=S\left[t_{2},t_{3}\right]=\sum_{m_{2},m_{3}\ge0}C_{\left[m_{2},m_{3}\right]}t_{2}^{m_{2}}t_{3}^{m_{3}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן הרעיון הוא שהחזקה של &lt;span&gt;\( t_{2} \)&lt;/span&gt; סופרת כמה &lt;strong&gt;משולשים&lt;/strong&gt; יש בסבדיגון שלנו, והחזקה של &lt;span&gt;\( t_{3} \)&lt;/span&gt; סופרת כמה &lt;strong&gt;מרובעים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;הכתיב הזה טיפה מסורבל, וגם לא לגמרי ברור על מה משתנה הסכימה רץ, אז המאמר מפשט את זה ומסמן &lt;span&gt;\( \mathbf{m}=\left[m_{2},m_{3}\right] \)&lt;/span&gt; וכותב &lt;span&gt;\( \mathbf{m}\ge0 \)&lt;/span&gt; כדי לסמן את זה ש-&lt;span&gt;\( \mathbf{m} \)&lt;/span&gt; רץ על כל הזוגות &lt;span&gt;\( \left[m_{2},m_{3}\right] \)&lt;/span&gt; שבהם &lt;span&gt;\( m_{2}\ge0 \)&lt;/span&gt; וגם &lt;span&gt;\( m_{3}\ge0 \)&lt;/span&gt;. אפשר להשתמש גם בסימון &lt;span&gt;\( \mathbf{t}^{\mathbf{m}}=t_{2}^{m_{2}}t_{3}^{m_{3}} \)&lt;/span&gt; ולקבל מעין “שחזור” של הנוסחה הקודמת:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S=\sum_{\mathbf{m}\ge0}C_{\mathbf{m}}\mathbf{t}^{\mathbf{m}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו יש שתי שאלות:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;איזו נוסחה פולינומית מקיימת &lt;span&gt;\( S \)&lt;/span&gt; הזו? אנחנו רוצים הכללה של &lt;span&gt;\( T=1+tT^{2} \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;איך מחשבים מספרית את &lt;span&gt;\( C_{\mathbf{m}} \)&lt;/span&gt;? אנחנו רוצים חישוב נוח כמו של &lt;span&gt;\( C_{n} \)&lt;/span&gt;.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;למרבה השמחה, בשני המקרים יש לזה תשובה טובה. ראשית, הנוסחה הפולינומית ש-&lt;span&gt;\( S \)&lt;/span&gt; מקיימת. קודם, במקרה של &lt;span&gt;\( T \)&lt;/span&gt;, קיבלנו את &lt;span&gt;\( T=1+tT^{2} \)&lt;/span&gt; באופן הבא: ה-1 היה הטריגון היחיד עם 0 משולשים, שסומן &lt;span&gt;\( | \)&lt;/span&gt;, ואילו &lt;span&gt;\( tT^{2} \)&lt;/span&gt; תיאר בניה של טריגון מתוך שני טריגונים קיימים (זה &lt;span&gt;\( T \)&lt;/span&gt; כפול &lt;span&gt;\( T \)&lt;/span&gt;) ועוד משולש אחד שדוחפים ביניהם (זה &lt;span&gt;\( t \)&lt;/span&gt;). הרעיון הוא שבמשולש שדוחפים ביניהם אחת מהצלעות תהיה הצלע המובחנת של הטריגון שבונים, ואל שתי הצלעות האחרות “מדביקים” את שני הטריגונים שבחרנו. כשאנחנו עובדים עם סבדיגונים את פעולת הבניה הזו &lt;strong&gt;אפשר לעשות גם עם מרובע&lt;/strong&gt;, כלומר לקחת מרובע, לסמן את אחת הצלעות שלו בתור הצלע המובחנת, ולהדביק לו &lt;strong&gt;שלושה&lt;/strong&gt; סבדיגונים. התוצאה של זה תהיה &lt;span&gt;\( t_{3}S^{3} \)&lt;/span&gt;: החזקה השלישית של &lt;span&gt;\( S \)&lt;/span&gt; היא כי אנחנו מדביקים שלושה סבדיגונים; המכפלה ב-&lt;span&gt;\( t_{3} \)&lt;/span&gt; היא כי הוספנו לסבדיגון שאנחנו בונים &lt;strong&gt;מרובע&lt;/strong&gt; שאליו כולם נדבקים, ו-&lt;span&gt;\( t_{3} \)&lt;/span&gt; סופר כמה מרובעים יש.&lt;/p&gt;

&lt;p&gt;הבניה הקודמת, שבה לוקחים &lt;strong&gt;משולש&lt;/strong&gt; ומדביקים לו שני סבדיגונים, עדיין אפשרית גם כן, ונספרת על ידי &lt;span&gt;\( t_{2}S^{2} \)&lt;/span&gt;. ובגלל שאלו שתי בניות שונות שמניבות אובייקטים שונים, סופרים אותן בנפרד (“עקרון החיבור”) ויחד עם מקרה הבסיס, נקבל את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S=1+t_{2}S^{2}+t_{3}S^{3} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו אפשר כמו קודם להסתכל על המשוואה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0=1-\alpha+t_{2}\alpha^{2}+t_{3}\alpha^{3} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולהגיד שיש לה formal power series solution שהוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \alpha=S=S\left[t_{2},t_{3}\right]=\sum_{m_{2},m_{3}\ge0}C_{\left[m_{2},m_{3}\right]}t_{2}^{m_{2}}t_{3}^{m_{3}}=\sum_{\mathbf{m}\ge0}C_{\mathbf{m}}\mathbf{t}^{\mathbf{m}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כדי להשלים את התמונה, מסתכלים על משוואה פולינומית כללית ממעלה 3:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0=c_{0}-c_{1}x+c_{2}x^{2}+c_{3}x^{3} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ומשתמשים באותה החלפה, &lt;span&gt;\( \alpha=\frac{c_{0}}{c_{1}}x \)&lt;/span&gt; והצבות &lt;span&gt;\( t_{k}=\frac{c_{0}^{k-1}c_{k}}{c_{1}^{k}} \)&lt;/span&gt; עבור &lt;span&gt;\( k=2,3 \)&lt;/span&gt; כדי לקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=\sum_{m_{2},m_{3}\ge0}C_{\left[m_{2},m_{3}\right]}\frac{c_{0}^{1+m_{2}+2m_{3}}}{c_{1}^{1+2m_{2}+3m_{3}}}c_{2}^{m_{2}}c_{3}^{m_{3}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ושוב - המאמר מתעלם באלגנטיות כאן מהשאלה האם בכלל הטור מתכנס עבור כזו הצבה של ערכים ב-&lt;span&gt;\( t \)&lt;/span&gt;-ים.&lt;/p&gt;

&lt;p&gt;זהו, זה כל הרעיון - וזו הדרך שבה המאמר מוכיח את התוצאה המרכזית שלו. אלא שהוא לא עושה את זה רק עבור משוואות ממעלה שלישית; הוא עושה את זה לכל מעלה, כי הההכללה של מה שראינו היא פשוטה מאוד: אמרנו שסבדיגון יכול להיות מטיפוס &lt;span&gt;\( \left[m_{2},m_{3}\right] \)&lt;/span&gt;? אנחנו מרשים לו להיות מטיפוס יותר כללי, &lt;span&gt;\( \mathbf{m}=\left[m_{2},m_{3},m_{4},\ldots\right] \)&lt;/span&gt; כאשר המגבלה היחידה היא שכל ה-&lt;span&gt;\( m \)&lt;/span&gt;-ים הם 0 החל ממקום מסוים. &lt;span&gt;\( \mathcal{S}_{\left[m_{2},m_{3},m_{4},\ldots\right]} \)&lt;/span&gt; סופרת את הפוליגונים עם צלע מובחנת שמחולקים ל-&lt;span&gt;\( m_{2} \)&lt;/span&gt; משולשים, &lt;span&gt;\( m_{3} \)&lt;/span&gt; מרובעים, &lt;span&gt;\( m_{4} \)&lt;/span&gt; מחומשים וכן הלאה - באופן כללי, &lt;span&gt;\( m_{k} \)&lt;/span&gt; מצולעים עם &lt;span&gt;\( k+1 \)&lt;/span&gt; צלעות והמספר מסומן ב-&lt;span&gt;\( C_{\left[m_{2},m_{3},\ldots\right]} \)&lt;/span&gt; (ומכיוון שאנחנו סופרים רק צורות סופיות, ברור שלא ייתכן ש-&lt;span&gt;\( \left[m_{2},m_{3},m_{4},\ldots\right] \)&lt;/span&gt; יהיה אינסופי “באמת” אלא חייב להיות 0 החל ממקום מסוים). עכשיו כותבים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S=S\left[t_{2},t_{3}\right]=\sum_{m_{2},m_{3},\ldots\ge0}C_{\left[m_{2},m_{3},\ldots\right]}t_{2}^{m_{2}}t_{3}^{m_{3}}\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה טיפה מוזר - התחלנו מלדבר על פונקציה יוצרת עם משנה אחד, עברנו לשני משתנים ועכשיו יש לנו אינסוף משתנים (אבל בכל מונום יש רק מספר סופי שלהם) אבל זה עובד סבבה. עכשיו, כמו שיצרנו סבדיגון עם חיבור סבדיגונים למשולש ולמרובע אפשר גם למחומשים וכן הלאה, ולכן מקבלים את המשוואה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \alpha=S=S\left[t_{2},t_{3},\ldots\right]=\sum_{m_{2},m_{3},\ldots\ge0}C_{\left[m_{2},m_{3},\ldots\right]}t_{2}^{m_{2}}t_{3}^{m_{3}}\ldots=\sum_{\mathbf{m}\ge0}C_{\mathbf{m}}\mathbf{t}^{\mathbf{m}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה התוכן של &lt;strong&gt;משפט &lt;/strong&gt;&lt;strong&gt;3&lt;/strong&gt; במאמר, והנוסחה הזו נקראת &lt;strong&gt;הנוסחה הגאומטרית הפולינומית הרכה&lt;/strong&gt;. אחר כך נפטרים מה”גאומטרית” עם &lt;strong&gt;משפט &lt;/strong&gt;&lt;strong&gt;4&lt;/strong&gt; שמבצע את הצבת ה-&lt;span&gt;\( c \)&lt;/span&gt;-ים שראינו ומקבל את &lt;strong&gt;הנוסחה הפולינומית הרכה&lt;/strong&gt;,&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=\sum_{m_{2},m_{3},\ldots\ge0}C_{\left[m_{2},m_{3},\ldots\right]}\frac{c_{0}^{1+m_{2}+2m_{3}+\ldots}}{c_{1}^{1+2m_{2}+3m_{3}+\ldots}}c_{2}^{m_{2}}c_{3}^{m_{3}}\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו, זו התוצאה המרכזית של המאמר - זו הנוסחה ש”פותרת” משוואה פולינומית כללית, וזה… די מגניב! יש לנו בהחלט נוסחה בודדת שאיכשהו מציגה פתרונות של &lt;strong&gt;כל&lt;/strong&gt; משוואה פולינומית בתור סכום. אמנם אינסופי; אמנם עם אינסוף אינדקסים; אמנם לא מתכנס רוב הזמן; אבל עדיין, זה יפה ממש.&lt;/p&gt;

&lt;p&gt;בואו ניקח רגע להעריך את זה לפני שנתקדם.&lt;/p&gt;

&lt;p&gt;אוקיי, אז קיבלנו נוסחה, אבל בנוסחה הזו מופיעים המספרים &lt;span&gt;\( C_{\left[m_{2},m_{3},\ldots\right]} \)&lt;/span&gt;, ואם אין לנו דרך נוחה לחשב אותם, אז מה עשינו בזה? למרבה השמחה, יש נוסחה פשוטה עבורם, כמו שיש עבור מספרי קטלן. המאמר לא מוכיח את זה אלא מצטט תוצאה מוכרת אם &lt;span&gt;\( \mathbf{m}=\left[m_{2},m_{3},m_{4},\ldots\right] \)&lt;/span&gt; אז&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C_{\mathbf{m}}=\frac{\left(2m_{2}+3m_{3}+4m_{4}+\ldots\right)!}{\left(1+m_{2}+2m_{3}+3m_{4}+\ldots\right)!m_{2}!m_{3}!m_{4}!\cdots} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו המאמר מנצל את זה כדי להציג עוד דרכים יפות לכתוב את הנוסחה, אבל אני לא מנסה להציג כאן את כל המאמר; בהחלט שווה לקרוא אותו אם זה מעניין אתכם (יש עוד חלק שלם בסוף שאני לא מזכיר בכלל).&lt;/p&gt;

&lt;h2&gt;בואו נלכלך ידיים וננסה להבין - האם זה יעיל?&lt;/h2&gt;

&lt;p&gt;הנוסחה שהמאמר נותן היא יפה. האם היא גם נותנת לנו דרך יעילה לחשב את הפתרונות של משוואות פולינומיות? ובכן, יעיל בהשוואה אל מה?&lt;/p&gt;

&lt;p&gt;ראשית, נניח שיש לנו משוואה ריבועית, &lt;span&gt;\( ax^{2}+bx+c=0 \)&lt;/span&gt;. נוסחת השורשים נותנת לנו את הפתרון &lt;span&gt;\( x_{1,2}=\frac{-b\pm\sqrt{b^{2}-4ac}}{2a} \)&lt;/span&gt;. מה יש לנו כאן? כדי לחשב את הנוסחה צריך&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;להעלות את &lt;span&gt;\( b \)&lt;/span&gt; בריבוע (פעולת כפל)&lt;/li&gt;


&lt;li&gt;לחשב את &lt;span&gt;\( 4ac \)&lt;/span&gt; (שתי פעולות כפל)&lt;/li&gt;


&lt;li&gt;לחשב את &lt;span&gt;\( b^{2}-4ac \)&lt;/span&gt; (פעולת חיסור)&lt;/li&gt;


&lt;li&gt;לחשב את &lt;span&gt;\( \sqrt{b^{2}-4ac} \)&lt;/span&gt; (פעולת הוצאת שורש)&lt;/li&gt;


&lt;li&gt;לחשב את &lt;span&gt;\( \pm\sqrt{b^{2}-4ac}-b \)&lt;/span&gt; (פעולת חיסור)&lt;/li&gt;


&lt;li&gt;לחשב את &lt;span&gt;\( 2a \)&lt;/span&gt; (פעולת כפל)&lt;/li&gt;


&lt;li&gt;לחשב את &lt;span&gt;\( \frac{-b\pm\sqrt{b^{2}-4ac}}{2a} \)&lt;/span&gt; (פעולת חילוק)&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;איך מודדים את הסיבוכיות של כל צעד? ובכן, זה כבר דורש סדרת פוסטים משל עצמה, נכון? בגדול, פעולות חיבור וחיסור עולות פחות מכפל וחילוק, אבל פעולה כמו חישוב של &lt;span&gt;\( 2a \)&lt;/span&gt;? זה טריוויאלי לביצוע במחשב - זו הזזה של ביט אחד הצידה, אפשר לעשות את זה מהר מאוד. לכן אני לא רואה טעם למדוד את הסיבוכיות של כל הסיפור הזה מעבר לאמירה שיש כאן כמה פעולות כפל וחילוק ופעולת &lt;strong&gt;הוצאת שורש&lt;/strong&gt; שהיא בכל מקרה הדבר הכבד פה.&lt;/p&gt;

&lt;p&gt;המאמר, בהקדמה, מדבר בדיוק על זה: הוא מנסה להציג את פעולת הוצאת השורש בתור משהו בעייתי כל כך שהופך את כל החיפוש הזה אחרי נוסחה לפתרון משוואה בעזרת רדיקלים לקצת מטופש. ראשית, אין לנו דרך לחשב שורש במדויק, ממילא נקבל רק קירוב:&lt;/p&gt;

&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
Our modern quadratic formula involves a square root operation, which even in ancient times was known to generally not terminate, yielding only approximate solutions
&lt;/blockquote&gt;

&lt;p&gt;שנית, כל הקטע הזה של נוסחה שיש בה פעולות מקוננות (פעולות שמבוצעות זו בתוך זו; למשל, במשוואה ממעלה שלישית בהחלט יש הוצאת שורש בתוך הוצאת שורש שלישי - אנחנו מקבלים משהו שנראה כמו &lt;span&gt;\( \sqrt[3]{-\frac{27}{2}q+\frac{3}{2}\sqrt{-3D}} \)&lt;/span&gt;) מפריע להם, לעומת סכום “פשוט יותר”:&lt;/p&gt;

&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
After all, if we’re permitted nested unending nth root calculations, why not a simpler ongoing sum that actually solves polynomials beyond degree four
&lt;/blockquote&gt;

&lt;p&gt;אני אישית חושב שהוצאת שורש היא דבר די פשוט. ראשית, מבחינה קונספטואלית: עם איבר כמו &lt;span&gt;\( \sqrt{a} \)&lt;/span&gt; אני יכול לעבוד בקלות, אלגברית: למשל, אני יודע ש-&lt;span&gt;\( \left(3+\sqrt{a}\right)^{2}=9+6\sqrt{a}+a=\left(9+a\right)+6\sqrt{a} \)&lt;/span&gt;. כלומר, אני יודע לבצע אלגברה עם ביטויים שמכילים שורשים ולקבל בחזרה ביטוי שהוא באותה רמת סיבוך - עדיין יש לו רק שורשים מאותה רמה. עם פתרון שנתון בנוסחת ההיפר-קטלן אני לא יודע אם אני יכול לעשות את זה באותה קלות - אבל זה דיון רחב מאוד שאני לא הולך להיכנס אליו וממילא לא תהיה בו הכרעה ברורה ולא צריכה להיות בו הכרעה ברורה כי חלק ממה שנחמד במתמטיקה הוא שיש שלל ייצוגים שונים לאותו דבר, וכל ייצוג מביא איתו נקודת מבט שונה שיכולה להיות שימושית לפעמים.&lt;/p&gt;

&lt;p&gt;אז נתמקד בשאלה פשוטה יותר, מה שעניין את פותרי המשוואות האיטלקיים שמהם כל הטירוף הזה התפתח - מה יותר &lt;strong&gt;יעיל&lt;/strong&gt;? מה מאפשר לי לחשב יותר בנוחות? ובשביל זה, אנחנו רואים שאנחנו צריכים להסביר איך מחשבים שורשים ביעילות, וזה מאפשר לי להציג את אחת משיטות הקירוב המוכרות והפופולריות ביותר, שתהיה רלוונטית גם לחישוב שורשים וגם לפתרון משוואות פולינומיות כלליות: &lt;strong&gt;שיטת ניוטון-רפסון&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;השימושיות של ניוטון-רפסון חורגת מאשר “סתם” מציאת שורשים לפולינומים, ובהקשר של שורשים לפולינומים יש שיטות לשפר את היעילות שלה, אבל זה מצדיק פוסט בפני עצמו (שאין לי). כאן אני אסתפק בלהציג את השיטה בצורה הפשוטה ביותר שלה ונראה אם זה יספיק. הרעיון המרכזי בניוטון-רפסון הוא זה: אם נתונה לנו פונקציה &lt;span&gt;\( f\left(x\right) \)&lt;/span&gt; ואנחנו רוצים למצוא &lt;span&gt;\( a \)&lt;/span&gt; כך ש-&lt;span&gt;\( f\left(a\right)=0 \)&lt;/span&gt;, בואו נגדיר &lt;strong&gt;סדרה&lt;/strong&gt; של קירובים ל-&lt;span&gt;\( a \)&lt;/span&gt; הזו, שהולכת ומשתפרת. נתחיל עם קירוב כלשהו, &lt;span&gt;\( a_{0} \)&lt;/span&gt;, ואז נגדיר סדרה &lt;span&gt;\( a_{n} \)&lt;/span&gt; על ידי הכלל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{n+1}=a_{n}-\frac{f\left(a_{n}\right)}{f^{\prime}\left(a_{n}\right)} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;למה? מאיפה זה מגיע? &lt;a href=&quot;https://gadial.net/2017/08/22/0x5f3759df_part_1/&quot;&gt;בפוסט הזה&lt;/a&gt; שלי אני מנסה (בפרק השלישי) לתת לזה אינטואיציה - לא אכנס לזה עכשיו שוב (אבל בהחלט צריך פוסט ייעודי על הנושא הזה!). במקום זה, בואו נראה איך זה עובד עבור הבעיה הפשוטה של חישוב שורש. במקרה הזה, נניח שאני רוצה לחשב את השורש &lt;span&gt;\( \sqrt{D} \)&lt;/span&gt; עבור מספר ממשי &lt;span&gt;\( D \)&lt;/span&gt; כלשהו. אני אגדיר פונקציה &lt;span&gt;\( f\left(x\right)=x^{2}-D \)&lt;/span&gt;, אז בבירור &lt;span&gt;\( f\left(\sqrt{D}\right)=0 \)&lt;/span&gt; ולכן זו הפונקציה שאני רוצה להשתמש בה. חישוב הנגזרת של פונקציה כזו הוא טריוויאלי: &lt;span&gt;\( f^{\prime}\left(x\right)=2x \)&lt;/span&gt;, ולכן נקבל את הסדרה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{n+1}=a_{n}-\frac{a_{n}^{2}-D}{2a_{n}}=\frac{2a_{n}^{2}-a_{n}^{2}+D}{2a_{n}}=\frac{a_{n}^{2}+D}{2a_{n}}=\frac{1}{2}\left(a_{n}+\frac{D}{a_{n}}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אני מאוד אוהב את התוצאה הזו, כי הנוסחה &lt;span&gt;\( a_{n+1}=\frac{1}{2}\left(a_{n}+\frac{D}{a_{n}}\right) \)&lt;/span&gt; הייתה למעשה קיימת הרבה לפני ניוטון - זו שיטה שתוארה על ידי הרון מאלכסנדריה לפני 2,000 שנים בערך, ויש לה אינטואיציה גאומטרית יפהפיה: אם נסתכל על ריבוע ששטחו &lt;span&gt;\( D \)&lt;/span&gt;, אז אורך צלעו יהיה &lt;span&gt;\( \sqrt{D} \)&lt;/span&gt;. מה שהרון מציע הוא להתחיל עם &lt;strong&gt;מלבן&lt;/strong&gt; שאורך אחת מצלעותיו הוא &lt;span&gt;\( a_{0} \)&lt;/span&gt; ושטחו &lt;span&gt;\( D \)&lt;/span&gt;, ואז אורך צלעו השניה תהיה &lt;span&gt;\( \frac{D}{a_{n}} \)&lt;/span&gt;. אנחנו רוצים שאורכי הצלעות ישתוו, אז אנחנו מחליפים את &lt;span&gt;\( a_{n} \)&lt;/span&gt; בממוצע בין &lt;span&gt;\( a_{n} \)&lt;/span&gt; והצלע השניה, ומקבלים סדרה שהולכת ומשתפרת של מלבנים שהופכים לקרובים יותר ויותר לריבוע.&lt;/p&gt;

&lt;p&gt;כל איטרציה כוללת פעולת חילוק “קשה” אחת: החילוק &lt;span&gt;\( \frac{D}{a_{n}} \)&lt;/span&gt;. בנוסף יש פעולת חיבור ופעולת חילוק “קלה יותר”, חילוק ב-2. זה לא כל כך הרבה!&lt;/p&gt;

&lt;p&gt;הנה קוד שמריץ את זה ומקבל תוצאה שהיא מדויקת בכל ספרות הדיוק שהוא מציג:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;137&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;Newton&apos;s method: sqrt(&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;) = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;הקוד מבצע בסך הכל 10 איטרציות. לא רע! אבל האם אפשר להסתפק בפחות? אם תנסו להריץ, תראו שגם עבור &lt;span&gt;\( N=8 \)&lt;/span&gt; מקבלים את אותה התוצאה, אבל לפני כן לא. אבל… האם באמת היינו צריכים להתחיל מ-&lt;span&gt;\( D \)&lt;/span&gt;? האם אין דרך טובה יותר לנחש ערך התחלתי? ובכן, יש שלל דרכים, הנה אחת פשוטה: נסתכל כמה ביטים נדרשים כדי לייצג את &lt;span&gt;\( D \)&lt;/span&gt; בזיכרון, ניקח רק חצי מהן ואז ניקח מספר שמיוצג על ידי כמות הביטים הזו - הוא יהיה בערך מסדר גודל כמו השורש של &lt;span&gt;\( D \)&lt;/span&gt;. הנה דרך פשוטה לעשות את זה בפייתון:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bit_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;אם נשתמש בדרך הזו, מספר האיטרציות שצריך בשביל רמת הדיוק שלנו יקטן ל-&lt;span&gt;\( N=4 \)&lt;/span&gt;. לא רע בכלל!&lt;/p&gt;

&lt;p&gt;באופן כללי שאלת הקירוב ההתחלתי היעיל היא ממש מעניינת - כבר &lt;a href=&quot;\%20[https://gadial.net/2017/08/22/0x5f3759df_part_1/\%7C\%7C\%D7\%91\%D7\%A4\%D7\%95\%D7\%A1\%D7\%98\%20\%D7\%94\%D7\%96\%D7\%94]&quot;&gt;קישרתי פה אל פוסט&lt;/a&gt; שאני מאוד אוהב שבעצם המהות שלו היא שיטה אחת כזו. מצד שני, אפשר לראות את זה בתור חיסרון של ניוטון-רפסון אל מול גישת “יש לי טור. תחברו איברים בטור. זהו” שלכאורה מציעה נוסחת קטלן. אבל האמנם…? כפי שאנחנו זוכרים, נוסחת קטלן פשוט &lt;strong&gt;לא עובדת&lt;/strong&gt; לכל מני ערכים - מה שיוצא בפועל הוא שגם בה מתחבא היטב קונספט של “לבחור ערך התחלתי מתאים”.&lt;/p&gt;

&lt;p&gt;המאמר נוגע בזה ישירות בחלק 8 שלו, שמסתכל על המקרה של משוואה ממעלה שלישית ומדגים איך אפשר לקבל קירוב לפתרון באמצעות הנוסחה הכללית. הוא מתחיל מהמשוואה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1-\alpha+t_{2}\alpha^{2}+t_{3}\alpha^{3} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ומציג במפורש את הפתרון הכללי שהוא מצא עבורה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \alpha=\sum_{m_{2}\ge0}\sum_{m_{3}\ge0}\frac{\left(2m_{2}+3m_{3}\right)!}{\left(1+m_{2}+2m_{3}\right)!m_{2}!m_{3}!}t_{2}^{m_{2}}t_{3}^{m_{3}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עוד נחזור אל הנוסחה הכללית הזו, אבל לפני כן בואו נזרום עם המאמר. הוא מסתכל על משוואה ספציפית מאוד:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( f\left(x\right)=x^{3}-2x-5=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;שבה ג’ון וואליס השתמש כדי להדגים את שיטת ניוטון-רפסון. עכשיו, כדי לקבל קירוב לפתרון של המשוואה הזו המאמר לא לוקח את הסכום האינסופי, אלא רק את המונומים שלו שהם עד וכולל דרגה 3, מה שיוצא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Q\left(t_{2},t_{3}\right)=1+\left(t_{2}+t_{3}\right)+\left(2t_{2}^{2}+5t_{2}t_{3}+3t_{3}^{2}\right)+\left(5t_{2}^{3}+21t_{2}^{2}t_{3}+28t_{2}t_{3}^{2}+12t_{3}^{3}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו, כדי לפתור משוואה כללית &lt;span&gt;\( c_{0}-c_{1}x+c_{2}x^{2}+c_{3}x^{3}=0 \)&lt;/span&gt;, הנוסחה שהמאמר מצא אומרת לנו לחשב את הביטוי שהם מסמנים ב-&lt;span&gt;\( K\left(c_{0},c_{1},c_{2},c_{3}\right) \)&lt;/span&gt; ומוגדר כך:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( K\left(c_{0},c_{1},c_{2},c_{3}\right)=\frac{c_{0}}{c_{1}}Q\left(\frac{c_{0}c_{2}}{c_{1}^{2}},\frac{c_{0}^{2}c_{3}}{c_{1}^{3}}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;והם מציבים בו את המקדמים של &lt;span&gt;\( f\left(x\right)=x^{3}-2x-5 \)&lt;/span&gt;, כלומר מחשבים את &lt;span&gt;\( K\left(-5,2,0,1\right) \)&lt;/span&gt; ומקבלים… משהו שהוא בערך &lt;span&gt;\( -999.082031 \)&lt;/span&gt;, מה שהם מכנים ``clearly a fail’’. זו ההתייחסות הכי ישירה שראיתי במאמר לכך שבכלל רדיוס ההתכנסות (שבבירור לא מתקיים כאן) הוא רלוונטי.&lt;/p&gt;

&lt;p&gt;אבל הכישלון הזה נותן להם את ההזדמנות להראות איך מתגברים על זה. הם אומרים ש-&lt;span&gt;\( x=2 \)&lt;/span&gt; הוא קירוב ראשון סביר (לא אתווכח עם זה) אז במקום לפתור את הבעיה “איזה ערך צריך להציב ב-&lt;span&gt;\( f \)&lt;/span&gt; כדי לקבל 0” הם מנסים לפתור את הבעיה “כמה צריך לזוז מהערך &lt;span&gt;\( x=2 \)&lt;/span&gt; כדי ש-&lt;span&gt;\( f \)&lt;/span&gt; יקבל 0” ואת זה עושים פורמלית על ידי הגדרת &lt;span&gt;\( g\left(x\right)=f\left(2+x\right)=x^{3}+6x^{2}+10x-1 \)&lt;/span&gt; ואז חישוב של &lt;span&gt;\( K\left(-1,-10,6,1\right)=0.0945345708\ldots \)&lt;/span&gt; וזה יוצא קירוב נכון ב-4 הספרות הראשונות (הערך האמיתי הוא בערך &lt;span&gt;\( 2.0945514815423\ldots \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;אוקיי, מעניין. מה יש לניוטון-רפסון לומר בעניין הזה? הנוסחה של ניוטון-רפסון שמופעלת על &lt;span&gt;\( f\left(x\right)=x^{3}-2x-5 \)&lt;/span&gt; נותנת את הסדרה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{n+1}=a_{n}-\frac{f\left(a_{n}\right)}{f^{\prime}\left(a_{n}\right)}=a_{n}-\frac{a_{n}^{3}-2a_{n}-5}{3a_{n}^{2}-2}=\frac{2a_{n}^{3}+5}{3a_{n}^{2}-2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בואו נרוץ על זה ישירות, החל מהקירוב &lt;span&gt;\( a_{0}=2 \)&lt;/span&gt; שהם הציעו:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;Newton&apos;s method: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ארבע איטרציות מספיקות כאן כדי להגיע לכל ספרות הדיוק שאני מודד. כבר עבור &lt;span&gt;\( N=2 \)&lt;/span&gt; מקבלים את רמת הדיוק שלהם ועוד טיפ טיפה יותר טוב (הספרה הבאה פחות שגויה). זה לא מקרי. ניוטון-רפסון מתכנס &lt;strong&gt;מהר&lt;/strong&gt;, רק צריך קירוב התחלתי שקרוב מספיק לתוצאה.&lt;/p&gt;

&lt;p&gt;עדיין, מאוד מעניין להשוות בין שני הדברים שקיבלנו פה. בניוטון-רפסון קיבלנו את הביטוי &lt;span&gt;\( a_{n+1}=\frac{2a_{n}^{3}+5}{3a_{n}^{2}-2} \)&lt;/span&gt;, שהוא &lt;strong&gt;איטרציה&lt;/strong&gt; של &lt;strong&gt;פונקציה רציונלית&lt;/strong&gt;. פונקציה רציונלית, נזכיר, היא פונקציה שהיא מנה של שני פולינומים, משהו מהצורה &lt;span&gt;\( \frac{p\left(x\right)}{q\left(x\right)} \)&lt;/span&gt;. לעומת זאת, ה-&lt;span&gt;\( Q\left(t_{2},t_{3}\right) \)&lt;/span&gt; שהמאמר השתמש בו הוא &lt;strong&gt;פולינום&lt;/strong&gt; (בשני משתנים). אבל קצת קשה להשוות את שתי הסיטואציות, כי אחרי שמציבים ערכים מספריים ב-&lt;span&gt;\( Q \)&lt;/span&gt; הסיפור נגמר - מקבלים את הקירוב שרצינו - בעוד שב-&lt;span&gt;\( a_{n+1}=\frac{2a_{n}^{3}+5}{3a_{n}^{2}-2} \)&lt;/span&gt; חלק מהחישוב כבר בוצע בזה שהגעתי בכלל לפונקציה רציונלית יפה; מה שנשאר הוא החישובים של האיטרציה, שזה משהו שבכלל לא קיים בשיטה הקודמת. מצד שני, ראינו שהשיטה הקודמת &lt;strong&gt;נכשלת&lt;/strong&gt; ודרשה בעצמה ביצוע של סוג של איטרציה - החלפה של &lt;span&gt;\( x \)&lt;/span&gt; ב-&lt;span&gt;\( x+2 \)&lt;/span&gt;, מה שדורש חישוב משל עצמו. במילים אחרות - השוואה בין השיטות היא עסק רציני יותר ממה שהמאמר באמת מנסה להיכנס אליו, ואני מנחש בזהירות שאם היה לו שיפור משמעותי להציג ביחס לניוטון-רפסון הוא היה מרחיב על העניין הזה, כי זו באמת הייתה תוצאה מהממת.&lt;/p&gt;

&lt;p&gt;אני יכול לעצור כאן, אבל האמת שמתחשק לי לעשות ניסוי משל עצמי, בלי שאני אדע מראש מה הולך לצאת. כמובן, גם זה לא יהיה ניסוי רציני - אני לא באמת מהתחום - אבל אני לא רוצה לעשות את זה בשביל השוואה רצינית אלא בשביל הכיף.&lt;/p&gt;

&lt;p&gt;ראשית, בואו נכתוב קוד שיודע לעשות ניוטון-רפסון לכל משוואה פולינומית שהמקדמים שלה נתונים, במקום שאני אחשב דברים ידנית. משוואה כזו נראית כך:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( f\left(x\right)=c_{n}x^{n}+c_{n-1}x^{n-1}+\ldots+c_{0} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנגזרת של זה קלה מאוד לחישוב:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( f^{\prime}\left(x\right)=nc_{n}x^{n-1}+\left(n-1\right)c_{n-1}x^{n-2}+\ldots+c_{1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( x-\frac{f\left(x\right)}{f^{\prime}\left(x\right)} \)&lt;/span&gt; דורש לכפול את &lt;span&gt;\( x \)&lt;/span&gt; במכנה ולחסר מזה את המונה. גם את זה קל לעשות ידנית, כי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( xf^{\prime}\left(x\right)=nc_{n}x^{n}+\left(n-1\right)c_{n-1}x^{n-1}+\ldots+c_{1}x \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x-\frac{f\left(x\right)}{f^{\prime}\left(x\right)}=\frac{\left(n-1\right)c_{n}x^{n}+\left(n-2\right)c_{n-1}x^{n-1}+\ldots+c_{2}x^{2}-c_{0}}{nc_{n}x^{n-1}+\left(n-1\right)c_{n-1}x^{n-2}+\ldots+c_{1}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנה קוד שעושה את זה:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;newton&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;numerator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;denominator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;f_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numerator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;f_prime_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;denominator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f_prime_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Derivative is zero&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f_prime_x&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;אל מול הקוד הזה אני רוצה להעמיד קוד שמדמה את מה שהמאמר עושה עם מספרי היפר-קטלן: בהינתן פולינום &lt;span&gt;\( f\left(x\right) \)&lt;/span&gt; ממעלה &lt;span&gt;\( k \)&lt;/span&gt; שמנסים למצוא לו שורש, מייצרים את הפולינום מרובה המשתנים &lt;span&gt;\( Q\left(t_{2},t_{3},\ldots,t_{k}\right) \)&lt;/span&gt;. בהינתן קירוב התחלתי &lt;span&gt;\( x_{0} \)&lt;/span&gt; לשורש שאנחנו מנסים למצוא, מחשבים את &lt;span&gt;\( g\left(x\right)=f\left(x+x_{0}\right)=c_{0}-c_{1}x+c_{2}x^{2}+\ldots+c_{k}x^{k} \)&lt;/span&gt; ואז מחשבים את &lt;span&gt;\( \frac{c_{0}}{c_{1}}Q\left(\frac{c_{0}c_{2}}{c_{1}^{2}},\frac{c_{0}^{2}c_{3}}{c_{1}^{3}},\ldots,\frac{c_{0}^{k-1}c_{k}}{c_{1}^{k}}\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;בשביל לחשב את &lt;span&gt;\( Q \)&lt;/span&gt; צריך לדעת לחשב את מספרי היפר-קטלן, &lt;span&gt;\( C_{\mathbf{m}}=\frac{\left(2m_{2}+3m_{3}+4m_{4}+\ldots\right)!}{\left(1+m_{2}+2m_{3}+3m_{4}+\ldots\right)!m_{2}!m_{3}!m_{4}!\cdots} \)&lt;/span&gt;. חישוב של זה הוא קצת כאב ראש בצורה ישירה כי יש לנו המון מספרים עם עצרת, אז נקבל מנה של שני מספרי ענק וזה ייצא לא מדויק. למרבה השמחה, אפשר לרתום &lt;strong&gt;לוגריתמים&lt;/strong&gt; לעזרתנו. כפי שהסברתי &lt;a href=&quot;https://gadial.net/2020/06/08/what_are_logarithms/&quot;&gt;בפוסט שלי&lt;/a&gt; על לוגריתמים, הם הומצאו כדי לעזור לנו לחשב מכפלות ומנות של מספרים גדולים, והם עדיין משמשים טוב לזה. אם אני אפעיל &lt;span&gt;\( \ln \)&lt;/span&gt; על שני האגפים, אני אקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \ln C_{\mathbf{m}}=\ln\left(\left(2m_{2}+3m_{3}+4m_{4}+\ldots\right)!\right)-\ln\left(\left(1+m_{2}+2m_{3}+3m_{4}+\ldots\right)!\right)-\sum_{k=2}\ln\left(m_{k}!\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לוגריתם של עצרת הוא כלי כל כך שימושי בחישובים, שספריות מתמטיות סטנדרטיות לרוב מציעות אותו כפונקציה בסיסית. ליתר דיוק, לוגריתם של מה שנקרא &lt;strong&gt;פונקציית גמא&lt;/strong&gt;, &lt;span&gt;\( \Gamma \)&lt;/span&gt;, שהיא פונקציה שמקיימת &lt;span&gt;\( \Gamma\left(n+1\right)=n! \)&lt;/span&gt;, ובנוסף לכך יש לה שלל תכונות נחמדות שלא ניכנס אליהן כאן. השורה התחתונה היא שהקוד הזה מחשב את &lt;span&gt;\( C_{\mathbf{m}} \)&lt;/span&gt; בצורה מדויקת ויעילה, תוך התבססות על כך שהוא צריך לצאת מספר טבעי ולכן אפשר להסתמך על חישוב שהוא טיפה לא מדויק ואז לעגל:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hyperC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;B&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;log_numerator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;log_denominator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;B&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lgamma&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_numerator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log_denominator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;עם הקוד הזה וספריית האלגברה הסימבולית sympy אפשר לייצר את &lt;span&gt;\( Q \)&lt;/span&gt;. הפרמטרים שלנו הם &lt;span&gt;\( N \)&lt;/span&gt; שהוא הסכום המקסימלי של אברי &lt;span&gt;\( \mathbf{m} \)&lt;/span&gt; (בדוגמה שלהם, &lt;span&gt;\( N=3 \)&lt;/span&gt;) ו-&lt;span&gt;\( k \)&lt;/span&gt; שהוא המימד של &lt;span&gt;\( \mathbf{m} \)&lt;/span&gt;, כלומר כמה משתנים יש שם. ראשית אני מגדיר פונקציה רקורסיבית, partitions, שעוברת על כל הדרכים לחלק את המספר &lt;span&gt;\( N \)&lt;/span&gt; לסכום של &lt;span&gt;\( k \)&lt;/span&gt; מספרים טבעיים:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;partitions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partitions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;עכשיו אפשר להשתמש בה כדי לייצר את הפולינום:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sympy&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Add&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generate_polynomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&apos;t2:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;monomials&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partitions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;coeff&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hyperC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;term&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coeff&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;term&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m_i&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;monomials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;term&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;monomials&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;כל החישובים הללו “לא נחשבים” מבחינתי כשבאים למצוא פתרון למשוואה ספציפית, כי אפשר לעשות אותם באופן חד פעמי מראש - הרי &lt;span&gt;\( Q \)&lt;/span&gt; לא תלוי במשוואה ספציפית, רק במספר המשתנים ובשאלה כמה &lt;span&gt;\( N \)&lt;/span&gt; שלנו יהיה גדול (ככל ש-&lt;span&gt;\( N \)&lt;/span&gt; גדול יותר הקירוב יהיה טוב יותר אבל נצטרך לסכום &lt;span&gt;\( \Theta\left(N^{k}\right) \)&lt;/span&gt; איברים).&lt;/p&gt;

&lt;p&gt;לסיום, אני צריך דרך כלשהי לבצע את שינוי המקדמים &lt;span&gt;\( g\left(x\right)=f\left(x+a\right) \)&lt;/span&gt;. כאן אני יכול להשתמש &lt;strong&gt;בבינום של ניוטון&lt;/strong&gt;, באופן הבא: אם &lt;span&gt;\( f\left(x\right)=\sum_{k=0}^{n}a_{k}x^{k} \)&lt;/span&gt; אז&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( f\left(x+a\right)=\sum_{k=0}^{n}a_{k}\left(x+a\right)^{k}=\sum_{k=0}^{n}a_{k}\sum_{i=0}^{k}{k \choose i}x^{i}a^{k-i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אפשר לשנות את סדר הסכימה כדי לאגד לכל &lt;span&gt;\( x^{i} \)&lt;/span&gt; את כל המקדמים שלו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\sum_{i=0}^{n}\left(\sum_{k=i}^{n}a_{k}{k \choose i}a^{k-i}\right)x^{i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, נגדיר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{i}=\sum_{k=i}^{n}a_{k}{k \choose i}a^{k-i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ונקבל ש-&lt;span&gt;\( g\left(x\right)=f\left(x+a\right)=\sum_{i=0}^{n}b_{i}x^{i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנה קוד שעושה את החישוב הזה:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shift_polynomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;shifted&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;shifted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shifted&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ועכשיו אפשר לכתוב את הקוד שמשתמש בנוסחה של המאמר כדי לפתור משוואה ממעלה כלשהי:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;catalan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shift_polynomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;c0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;c1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&apos;t2:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generate_polynomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;subs_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subs_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;הייתי יכול גם לוותר לגמרי על השימוש ב-sympy אבל אני דווקא אוהב את זה שאפשר להשיג את הפולינום בצורה סימבולית ולשחק איתו.&lt;/p&gt;

&lt;p&gt;ועכשיו, אפשר לעשות בדיקה חפיפניקית כדי לראות מי מצליח יותר - ניוטון או קטלן?&lt;/p&gt;

&lt;p&gt;הנה קוד לדוגמא שעושה בדיקה כזו:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;catalan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;Catalan method result: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newton&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;Newton method result: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;יש כאן בבירור השוואה בין תפוזים ותפוחים - אני משתמש באותו &lt;span&gt;\( N \)&lt;/span&gt; בתור “פרמטר הקירוב” גם עבור ניוטון וגם עבור קטלן, אבל בשיטת ניוטון &lt;span&gt;\( N \)&lt;/span&gt; הוא בסך הכל מספר האיטרציות שמבצעים, ובשיטה של המאמר &lt;span&gt;\( N \)&lt;/span&gt; הוא חסם על גודל סכום האיברים ב-&lt;span&gt;\( \mathbf{m} \)&lt;/span&gt;. כלומר, בעוד שהגדלת &lt;span&gt;\( N \)&lt;/span&gt; ב-1 אצל ניוטון פשוט מוסיפה עוד איטרציה אחת, שרמת הסיבוכיות שלה דומה לקודמותיה, בשיטת קטלן ההגדלה הזו מוסיפה &lt;span&gt;\( \Theta\left(N^{k-1}\right) \)&lt;/span&gt; איברים לסכום. במילים אחרות, השימוש ב-&lt;span&gt;\( N \)&lt;/span&gt; בצורה כזו &lt;strong&gt;עוזר&lt;/strong&gt; לקטלן כי הוא מאפשר לו להגדיל את מספר הצעדים שהוא מבצע הרבה יותר מאשר ניוטון.&lt;/p&gt;

&lt;p&gt;זה לא מפריע לי.&lt;/p&gt;

&lt;p&gt;כשמריצים את הקוד למעלה, עם הפרמטרים &lt;span&gt;\( x_{0}=2 \)&lt;/span&gt; ו-&lt;span&gt;\( N=5 \)&lt;/span&gt;, מקבלים עבור ניוטון את התוצאה &lt;span&gt;\( 2.0945514815 \)&lt;/span&gt; (שהיא מדויקת בכל הספרות) ועבור קטלן את &lt;span&gt;\( 2.0945508795 \)&lt;/span&gt; (שהיא עדיין די מדויקת אבל רק עד ה-55). לרמת הדיוק של ניוטון קטלן הגיע ב-&lt;span&gt;\( N=13 \)&lt;/span&gt;; בשלב הזה ניוטון כבר מקבל &lt;span&gt;\( 2.0945514815423269539 \)&lt;/span&gt; (המאמר נוקב ב-&lt;span&gt;\( 2.0945514815423265915 \)&lt;/span&gt; בתור הקירוב של 19 הספרות הראשונות). בקיצור, על הדוגמא שלהם קטלן לא באמת נותן תחרות לניוטון.&lt;/p&gt;

&lt;p&gt;אם אני מתחיל מקירוב יותר נאיבי, &lt;span&gt;\( x_{0}=0 \)&lt;/span&gt;, אז ניוטון צריך שאבקש &lt;span&gt;\( N=19 \)&lt;/span&gt; כדי לקבל את הקירוב של 10 הספרות שראינו קודם (כמובן, בעולם האמיתי לא צריך להגיד לניוטון כמה איטרציות לעשות; מבקשים ממנו לעצור אחרי שהוא רואה שהפעלת איטרציה קיבעה את 10 הספרות הראשונות) אבל קטלן, כמו שהבטיחו במאמר, נכשל לגמרי ונותן &lt;span&gt;\( -108653171492152000000000 \)&lt;/span&gt;. אם תשאלו אותי, זה יתרון גדול של ניוטון; אפילו אם אגדיר &lt;span&gt;\( x_{0}=-1000000000000 \)&lt;/span&gt;, עבור &lt;span&gt;\( N=100 \)&lt;/span&gt; אקבל את אותו קירוב לפתרון. כשהפונקציה שמנסים לטפל בה היא נחמדה (ופולינום היא פונקציה נחמדה), ניוטון זה כמו מגנט שנדבק בכוח אל הפתרון די מהר. השיטה של המאמר פשוט לא יודעת לעשות את זה - היא תלויה הרבה יותר בכך שנמצא לה קירוב ראשוני מתאים.&lt;/p&gt;

&lt;p&gt;אז הרושם הראשוני שהשיטה במאמר לא יודעת לטפל ב”כל” משוואה אלא רק במשוואות שהפרמטרים שלהן נופלות תחת רדיוס ההתכנסות של הטור הרלוונטי - הרושם הזה &lt;strong&gt;שגוי&lt;/strong&gt;, בהחלט אפשר ליצור אלגוריתם טוב שמטפל בכל משוואה (כמעט… לא התייחסתי למקרה של &lt;span&gt;\( c_{1}=0 \)&lt;/span&gt;) &lt;strong&gt;אבל&lt;/strong&gt; האלגוריתם הזה יהיה &lt;strong&gt;רגיש לתנאי ההתחלה&lt;/strong&gt;, הרבה יותר מאשר ניוטון רגיש. וזה קצת נשמע מוזר כי אם רק מסתכלים על הכותרת של המאמר לא ברור בכלל שיש צורך שיהיו “תנאי התחלה” שכאלו.&lt;/p&gt;

&lt;p&gt;איך אפשר לעשות עוד מבחנים כאלו? ובכן, הכי טוב לייצר פולינום אקראי, אז הנה קוד שעושה את זה ומריץ “מבחן” עליו:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;random_coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;degree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lower_bound&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;upper_bound&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower_bound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;upper_bound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;degree&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_coefficients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.4&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;catalan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;Catalan method result: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;newton&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coeffs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;Newton&apos;s method result: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;במקרה הנוכחי בחרתי פולינום ממעלה 10 וקיבלתי את המקדמים &lt;span&gt;\( [10,-7,-10,-2,-3,-3,-6,-7,7,-8,8] \)&lt;/span&gt;. אחר כך הרצתי ניוטון בצד עם המון איטרציות כדי לדעת מה הערך ה”נכון” שאנחנו מחפשים, וראיתי שהוא קרוב ל-&lt;span&gt;\( 1.4 \)&lt;/span&gt; והזנתי את זה לקטלן. למה &lt;span&gt;\( N=5 \)&lt;/span&gt; ולא משהו גדול יותר? כי בשלב הזה, מכיוון שהפולינום הוא ממעלה גבוהה אז ה-&lt;span&gt;\( k \)&lt;/span&gt; שבחזקה שלו מעלים את &lt;span&gt;\( N \)&lt;/span&gt; הוא די גבוה, ולכן זמן הריצה כבר מורגש - לקוד הזה לקחו יותר מ-15 שניות לרוץ, למרות שניוטון מסיים מייד. אחרי הריצה הזו ניוטון השיג &lt;span&gt;\( 1.4042602427 \)&lt;/span&gt; (זו התוצאה הנכונה, במסגרת ספרות הדיוק) וקטלן השיג &lt;span&gt;\( 1.4042602426 \)&lt;/span&gt;, שזה… יפה מאוד! כמעט אותו דבר! אבל כמובן, זה בזכות קירוב התחלתי טוב; אם אני מתחיל מ-&lt;span&gt;\( x_{0}=2 \)&lt;/span&gt; קטלן &lt;strong&gt;טיפה&lt;/strong&gt; פחות מצליח, ומקבל &lt;span&gt;\( 1.6666226398 \)&lt;/span&gt; לעומת ה-&lt;span&gt;\( 1.4187182359 \)&lt;/span&gt; של ניוטון. עבור ערכים גדולים יותר של &lt;span&gt;\( x_{0} \)&lt;/span&gt; קטלן מחזיר תוצאות פחות מדויקות אבל לא מתחרבש לגמרי אפילו עבור &lt;span&gt;\( x_{0}=100 \)&lt;/span&gt;. זה לא כל כך מפתיע; כשמבצעים את ההזזה &lt;span&gt;\( g\left(x\right)=f\left(x+a\right) \)&lt;/span&gt; זה מנפח מאוד את המקדמים הקטנים ופחות את הגדולים. ואז מציבים ערך מהצורה &lt;span&gt;\( \frac{c_{0}^{i-1}c_{i}}{c_{1}^{i}} \)&lt;/span&gt; בפולינום. מה שקורה הוא ש-&lt;span&gt;\( c_{0}^{i-1} \)&lt;/span&gt;מבטל “בערך” את ה-&lt;span&gt;\( c_{1}^{i-1} \)&lt;/span&gt; שבמכנה ומשאיר &lt;span&gt;\( \frac{c_{i}}{c_{1}} \)&lt;/span&gt;, ואם &lt;span&gt;\( c_{1} \)&lt;/span&gt; גדול מאוד ביחס ל-&lt;span&gt;\( c_{i} \)&lt;/span&gt; נקבל מספר קטן - כלומר, המספרים שנציב יהיו בסיכוי טוב בתוך רדיוס ההתכנסות. לכן דווקא הניחוש ההתחלתי &lt;span&gt;\( x_{0}=0 \)&lt;/span&gt;, למרות שהוא קרוב הרבה יותר לתוצאה האמיתית מאשר &lt;span&gt;\( x_{0}=100 \)&lt;/span&gt;, הולך להוביל לקטסטרופה. העניין הוא שעבור &lt;span&gt;\( x_{0}=100 \)&lt;/span&gt; אמנם לא נקבל קטסטרופה אלא תוצאה שהיא הגיונית, אבל היא לא קירוב טוב במיוחד (מקבלים &lt;span&gt;\( 80.6474783702 \)&lt;/span&gt; עבור &lt;span&gt;\( N=5 \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;אז לסיכום - אם מה שמעניין אותנו הוא &lt;strong&gt;לחשב&lt;/strong&gt; את הפתרונות של משוואה פולינומית, עבור איזו רמת דיוק שנרצה, הרושם שאני מקבל הוא שניוטון-רפסון היא שיטה הרבה יותר יעילה ומתאימה. כמובן, המאמר בשום מקום לא טוען אחרת. לכן אולי הגיע הזמן לדבר על מה שנאמר &lt;strong&gt;מחוץ&lt;/strong&gt; למאמר, ובזה נסיים.&lt;/p&gt;

&lt;h2&gt;בואו נתלונן על הצגה לא נאמנה של המתמטיקה בתקשורת, כי זה כבר מזמן לא קרה&lt;/h2&gt;

&lt;p&gt;בראשית ימי הבלוג חשבתי שאחד מהדברים המרכזיים שאעשה בו הוא להתלונן על כל מני הצגות שגויות של המתמטיקה בתקשורת, כי זה כיף וזה נותן תירוץ לדבר על דברים מתמטיים מגניבים. אחר כך הבנתי שאני יכול לדבר על דברים מתמטיים מגניבים בלי תירוצים ושזה בדרך כלל עדיף להציג דברים מגישה חיובית ולא לפתוח ב”אההה הצילו כל מה שכתוב בעיתון הזה לא נכון”. אז אני כבר כמעט ולא עושה את זה (ובימינו יש רשתות חברתיות שיותר מתאימות לתלונות כאלו) אבל עדיין, בואו ננסה לראות מה היו חלק מהכותרות המפוצצות שגרמו לי לשים לב למאמר מלכתחילה ונבין מה עומד מאחוריהן (ולפני התלונות, שימו לב למובן מאליו - &lt;strong&gt;בלי&lt;/strong&gt; הכותרות המפוצצות לא הייתי קורא את המאמר, שהוא כאמור די מגניב).&lt;/p&gt;

&lt;p&gt;נתחיל מהכותרת הראשונה שבה נתקלתי: Mathematician solves algebra’s oldest problem using intriguing new number sequences. היא מגיעה מהפרסום &lt;a href=&quot;https://www.unsw.edu.au/newsroom/news/2025/05/mathematician-solves-algebras-oldest-problem-using-intriguing-new-number-sequences&quot;&gt;כאן&lt;/a&gt;, שהוא לא כתבה עיתונאית אלא פרסום של האוניברסיטה עצמה. ככזה, הוא יחסית מדויק. עדיין, יש דבר או שניים שמרגיזים אותי.&lt;/p&gt;

&lt;p&gt;למשל, הם כותבים שם ש-&lt;/p&gt;
&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
A general method for solving ‘higher order’ polynomial equations, where x is raised to the power of five or higher, has historically proven elusive.
&lt;/blockquote&gt;

&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
Now, UNSW Honorary Professor Norman Wildberger has revealed a new approach using novel number sequences, outlined in a recent publication with computer scientist Dr. Dean Rubine.
&lt;/blockquote&gt;

&lt;p&gt;מה שמקפיץ אותי הוא ה-novel number sequences - הרי מספרי ההיפר-קטלן הם לא חדשים; המאמר מצטט ספרות יפה שעוסקת בהם עוד מהמאה ה-19. החידוש במאמר הוא להסתכל על הפונקציה היוצרת שלהם ולהגיד - היי, תראו, זה סוג של נותן פתרון של משוואה.&lt;/p&gt;

&lt;p&gt;הדבר שיותר מרגיז אותי מגיע אחרי התיאור של גלואה וההוכחה לאי הפתירות על ידי רדיקלים של משוואות ממעלה חמישית ומעלה:&lt;/p&gt;
&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
Approximate solutions for higher-degree polynomials have since been developed and are widely used in applications but, Prof. Wildberger says, these don’t belong to pure algebra.
&lt;/blockquote&gt;

&lt;p&gt;ראשית, יש פה טעות היסטורית - זה לא שפתרונות מקורבים פותחו &lt;strong&gt;אחר כך&lt;/strong&gt;, הם היו ידועים &lt;strong&gt;קודם&lt;/strong&gt;. המאמר עצמו מזכיר את זה במפורש - הוא מדבר על איך שוואליס (במאה ה-17!) השתמש בשיטת ניוטון כדי למצוא את הפתרון של פולינום מסויים (למעשה, שיטת ניוטון עברה שלל גלגולים לאורך השנים אבל כבר בגרסה הגולמית שלה אצל ניוטון היא שימשה לפתרון משוואות פולינומיות).&lt;/p&gt;

&lt;p&gt;שנית, מה בכלל המשמעות של “pure algebra” כאן? בסופו של דבר, הדרך לקבל פתרון קונקרטי למשוואה בשיטה של המאמר היא להציב מספרים בתור טור אינסופי ולקוות שיתכנס. זה לגמרי פתרון אנליטי. לכן אני משער שב”אלגברה טהורה” הכוונה למה שראינו בפוסט הקודם - לכך שכדי להגדיר שוויון &lt;strong&gt;ברמת הפונקציות היוצרות&lt;/strong&gt; לא צריך בכלל חשבון דיפרנציאלי ואינטגרלי. זו הנקודה שהמאמר אכן מקפיד עליה - לומר שהפתרון הוא “כטור חזקות פורמלי” אבל כבר אמרתי שאני לא מבין איך זה בעצם פתרון - כי בטור חזקות פורמלי מה שמעניין אותנו הוא לקודד &lt;strong&gt;את המקדמים&lt;/strong&gt; של הטור, ואילו כאן הטור לכאורה מקודד מספר שמתקבל &lt;strong&gt;על ידי הצבה&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;עניין אחר שמוזכר שם הוא שהכותב מתאר את עצמו כ”לא מאמין במספרים אי רציונליים” ועל זה אני אומר… אוקיי, עזבו. מילא לא היה מאמין באינסוף, את זה הייתי מבין - אבל די התבססת כאן על טורים אינסופיים, פורמליים או לא.&lt;/p&gt;

&lt;p&gt;הלאה, בואו נעבור למאמר עם הכותרת “The Oldest Algebra Problem Solved”: Australian Mathematician Cracks Ancient Mystery That Baffled Minds for Over 4,000 Years” שאפשר לראות &lt;a href=&quot;https://www.sustainability-times.com/research/the-oldest-algebra-problem-solved-australian-mathematician-cracks-ancient-mystery-that-baffled-minds-for-over-4000-years/&quot;&gt;כאן&lt;/a&gt;. המאמר נפתח בסתם בלבול תמים שגורם לו לחשוב שנוסחת השורשים (הנוסחה לפתרון משוואה ממעלה שניה) היא מה שנותן לנו את הפתרון למשוואות ממעלה שלישית ורביעית (הו לא, כל כך לא). מה שבאמת מרגיז אותי פה הוא שהמאמר כותב ש”בדיקות על משוואה מפורסמת ממעלה שלישית בה השתמש וואליס במאה ה-17 הדגימו את יעילות השיטה” - אבל הם לא אומרים &lt;strong&gt;איך&lt;/strong&gt; וואליס השתמש במשוואה הזו; כזכור, הוא השתמש בה כדי להדגים את שיטת ניוטון - השיטה שמניבה למשוואה הזו פתרונות &lt;strong&gt;טובים יותר&lt;/strong&gt;. יותר מזה, המאמר עובר להתלונן על כך שעד כה היו רק פתרונות &lt;strong&gt;מקורבים&lt;/strong&gt; שלא שייכים לאלגברה “טהורה” אבל השיטה החדשה היא “יותר מדויקת”.&lt;/p&gt;

&lt;p&gt;במילים אחרות, לכותבים אין שמץ של מושג מה בעצם קורה כאן. הם לא מבינים שיש פה טריידאוף: או שאתה אלגברי “טהור” אבל לא תוכל לקבל ערך מספרי לפתרונות, בכלל; או שאתה לא אלגברי טהור, ואתה יכול לקבל ליד פתרונות מקורבים, אבל אז השיטה שלך פחות טובה מהקיימות. לצערי, אני מרגיש שיש למאמר חלק בזה - אין בו הבהרה של ממש מה בעצם &lt;strong&gt;המשמעות&lt;/strong&gt; של זה שהפתרון נתון בעזרת פונקציות יוצרות.&lt;/p&gt;

&lt;p&gt;מה עם “200-year-old “algebra wall” shattered with a bold new approach” שנמצא &lt;a href=&quot;https://newatlas.com/science/algebras-oldest-problem/&quot;&gt;כאן&lt;/a&gt;? יש בו פסקה מעצבנת במיוחד:&lt;/p&gt;

&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;Mathematician Norman Wildberger, an Honorary Professor at Australia&apos;s University of New South Wales, and computer scientist Dean Rubine have thrown out the rulebook and presented a new way to solve polynomial equations that go beyond x to the power of four -- something that has only been resolved with &quot;approximate solutions.&quot; While this won&apos;t mean a whole lot to school students in math class, accuracy in answering higher-order polynomial problems could have huge implications in the fields of science and technology.
&lt;/blockquote&gt;

&lt;p&gt;הפסקה הזו מראה נפילה מוחלטת להטעיה של יחסי הציבור - בזה שהפתרונות הקודמים נפסלים בתור “פתרונות מקורבים” איכשהו נוצר הרושם שהפתרון החדש “מדויק יותר” והרי אנחנו יודעים שהדיוק חשוב כשאנחנו מנסים להנחית חללית על מאדים! אבל שוב - הדיוק של השיטה החדשה &lt;strong&gt;פחות גדול&lt;/strong&gt; מאשר אצל ניוטון. המובן היחיד שבו היא “מדויקת” היא בדיוק המובן שבו אין לנו דרך לקבל את הפתרון בצורה מפורשת.&lt;/p&gt;

&lt;p&gt;וזה נמשך:&lt;/p&gt;

&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
“One of the equations we tested was a famous cubic equation used by Wallis in the 17th century to demonstrate Newton&apos;s method,&quot; Wildberger explained. &quot;Our solution worked beautifully.&quot; 
&lt;/blockquote&gt;

&lt;p&gt;כאן הם ליטרלי מזכירים את ניוטון - ועדיין לא מתייחסים למשמעות של זה. נכון, הפתרון שלהם עובד בצורה יפהפיה ברגע שבוחרים קירוב התחלתי טוב מספיק; אבל השיטה של ניוטון עובדת בצורה עוד יותר יפהפיה. במובן הספציפי הזה, הבעיה כבר הייתה פתורה מאות שנים.&lt;/p&gt;

&lt;p&gt;ולסיום, המאמר מנסה להצדיק את הכותרת שלו:&lt;/p&gt;
&lt;blockquote dir=&quot;ltr&quot; class=&quot;quote-ltr&quot;&gt;
If you&apos;re still with me, this new method solves for equations that can&apos;t generally be resolved using traditional methods, like using root-taking approaches. In this sense, it breaks through a centuries-old mathematical wall. The novel approach removes the limitations presented by the kind of simple finite formula we were taught at school.
&lt;/blockquote&gt;

&lt;p&gt;הבעיה פה היא שאנשים פשוט לא מבינים מהן השיטות המסורתיות, ולמה ביחס אליהן זו בעיה פתורה. אז הם מדמיינים שיש פה חומה שצריך לשבור.&lt;/p&gt;

&lt;p&gt;ומה עם “Researchers Solve “Impossible” Math Problem After 200 Years”? טוב, זה כמעט מועתק מילה במילה מהקומוניקט של האוניברסיטה, אז אין טעם להתעסק גם בו - אבל זה ממחיש את העניין. כל המאמרים הללו נכתבו על ידי אנשים שדי בבירור לא מבינים את הנושא ופשוט מתבססים על מה שהאוניברסיטה סיפרה להם, והאוניברסיטה סיפרה להם את האמת… אבל לא את כל האמת. זה הטריק הכי ישן בספר, כמובן.&lt;/p&gt;

&lt;p&gt;אני רוצה להדגיש את מה שפתחתי איתו: זה מאמר נחמד. מה שהוא עושה, למרות שהוא לא מורכב במיוחד, הוא יפה. אבל כל ההצגה הבומבסטית שיש מאחוריו נראית לי לא קשורה לשום דבר. אם מאמר באמת הצליח לפרוץ דרך שנראתה בלתי אפשרית, הדבר הראשון שהייתי מצפה לראות הוא איך השיטה החדשה פותרת בעיות שמעולם לא נפתרו. וזה… לא קורה.&lt;/p&gt;

&lt;p&gt;אבל היי, סוף סוף הייתה לי מוטיבציה לכתוב על מספרי קטלן בבלוג, אז אני אסיר תודה.&lt;/p&gt;</content><author><name></name></author><category term="מספרי קטלן" /><category term="פונקציות יוצרות" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">פונקציות יוצרות ומספרי קטלן</title><link href="http://gadial.net/2025/06/11/catalan_numbers_and_generating_functions/" rel="alternate" type="text/html" title="פונקציות יוצרות ומספרי קטלן" /><published>2025-06-11T00:00:00+00:00</published><updated>2025-06-11T00:00:00+00:00</updated><id>http://gadial.net/2025/06/11/catalan_numbers_and_generating_functions</id><content type="html" xml:base="http://gadial.net/2025/06/11/catalan_numbers_and_generating_functions/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://gadial.net/2025/05/31/catalan_numbers/&quot;&gt;בפוסט הקודם&lt;/a&gt; שלי כתבתי על מספרי קטלן, סדרת המספרים &lt;span&gt;\( 1,1,2,5,14,42,\ldots \)&lt;/span&gt;. הראיתי נוסחת נסיגה עבורה, &lt;span&gt;\( C_{n+1}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;; הראיתי נוסחה סגורה עבורה, &lt;span&gt;\( C_{n}=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;; והראיתי שלל בעיות ספירה שמספרי קטלן פותרים, משילושים של מצולעים, עבור בעצים בינאריים וכלה במגדלי קפלר. רק דבר אחד לא הראיתי, למרות שהוא מושג מרכזי וחשוב בקומבינטוריקה באופן כללי: את &lt;strong&gt;הפונקציה היוצרת&lt;/strong&gt; של מספרי קטלן. לא עשיתי את זה כי זה היה מעלה פי כמה את רמת הטכניות של הפוסט ומרחיק אותי מהנושא המעניין בו, שהוא מספרי קטלן עצמם; אבל עכשיו אחרי שהתרגלנו אליהם (או דילגנו לגמרי על הפוסט הקודם כי אנחנו רוצים את האקשן שיהיה כאן) אפשר להפנות זרקור אל פונקציות יוצרות בכלל, וזו של מספרי קטלן בפרט.&lt;/p&gt;

&lt;p&gt;כמיטב מסורת הבלוג, &lt;a href=&quot;https://gadial.net/2011/08/07/generating_functions_hardcore_1/&quot;&gt;כבר יש לי פוסט על הנושא הזה&lt;/a&gt;, כולל אזכור של מספרי קטלן, אבל הפעם אני רוצה &lt;strong&gt;לחפור&lt;/strong&gt; ולהציג נושאים שרק נגעתי בהם בעבר ברמת פורמליות הרבה יותר גדולה. זה אומר שהפוסט יהיה טכני יחסית, ויילך ויסתבך ככל שאתקדם, אבל נגיע לפונקציה היוצרת של קטלן יחסית מהר; האתגר יהיה להבין למה הפונקציה היוצרת הזו “חוקית” וכמה אפשר להכליל את זה. אני אגלה מראש כבר עכשיו שהפונקציה היוצרת היא &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;, אבל - מה זה בעצם אומר? ואיך מגיעים לזה? בשביל זה אני אצטרך לדבר קצת על דברים.&lt;/p&gt;

&lt;h2&gt;למה פונקציות יוצרות זה כמו פולינומים, רק פשוט יותר&lt;/h2&gt;

&lt;p&gt;הרעיון בפונקציות יוצרות הוא לקודד סדרות מספרים כמו מספרי קטלן בתור &lt;strong&gt;טורי חזקות פורמליים&lt;/strong&gt;. זה דורש הגדרה של מה זה בכלל טור חזקות פורמלי, ואם לא מכירים אותם המושג הזה קצת מוזר בהתחלה אז אפשר להתחיל עם אובייקטים יותר ידידותיים: &lt;strong&gt;פולינומים&lt;/strong&gt;. התיאור הכללי שלנו של פולינום הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{d}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( d \)&lt;/span&gt; הוא &lt;strong&gt;דרגת&lt;/strong&gt; הפולינום - החזקה הגבוהה ביותר שלו שהמקדם שלה שונה מאפס. עכשיו, על פולינומים אפשר להגדיר פעולות חיבור וכפל, אז בשביל להדגים את זה בואו נציג שני פולינומים מדרגות &lt;span&gt;\( d_{1},d_{2} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{d_{1}}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b\left(x\right)=\sum_{n=0}^{d_{2}}b_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו החיבור מוגדר “איבר-איבר”:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)+b\left(x\right)=\sum_{n=0}^{\max\left\{ d_{1},d_{2}\right\} }\left(a_{n}+b_{n}\right)x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה בסך הכל יפה מאוד חוץ מהאיכסה של ה-&lt;span&gt;\( \max\left\{ d_{1},d_{2}\right\}  \)&lt;/span&gt; למעלה שגם מצריך אותנו לענות על שאלות קשות כמו מה המקדמים של פולינום מעבר לדרגה המקסימלית שלו (אפס. הם אפס).&lt;/p&gt;

&lt;p&gt;מה עם כפל? כאן זה טיפה יותר מסובך אבל לא בצורה חריגה. בואו נתחיל עם דוגמא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a_{1}x+a_{0}\right)\left(b_{1}x+b_{0}\right)=a_{1}b_{1}x^{2}+\left(a_{0}b_{1}+a_{1}b_{0}\right)x^{1}+a_{0}b_{0}x^{0} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כדאי לחשב את הדוגמא הזו ידנית, או אפילו משהו עם איבר אחד נוסף לאחד הפולינומים, כדי לקבל תחושה טובה של “מה הולך פה”. מה שמקבלים הוא שהמקדם של כל חזקה של &lt;span&gt;\( x^{n} \)&lt;/span&gt; הוא &lt;strong&gt;סכום&lt;/strong&gt; של איברים, כשכל איבר הוא &lt;strong&gt;מכפלה&lt;/strong&gt; של מקדם של &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; ומקדם של &lt;span&gt;\( b\left(x\right) \)&lt;/span&gt;, כשהמקדמים נבחרים כך שסכום האינדקסים של שניהם יוצא &lt;span&gt;\( n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;כדי לכתוב נוסחה כללית עבור זה, קודם כל אני אכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)\cdot b\left(x\right)=\sum_{n=0}^{d_{1}+d_{2}}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו אפשר להגיד מהו כל מקדם &lt;span&gt;\( c_{n} \)&lt;/span&gt; שכזה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עד כאן - חומר לא הכי קל טכנית אבל מאוד בסיסי, הרי משתמשים בפולינומים כמעט בכל מקום במתמטיקה אוניברסיטאית. אבל אפשר להצמיד לו שתי נקודות מבט שהן טיפונת פחות נפוצות:&lt;/p&gt;

&lt;p&gt;ראשית, אפשר לחשוב על הפולינומים כאילו הם מקודדים &lt;strong&gt;סדרת מספרים&lt;/strong&gt; - סדרת המקדמים שלהם. בצורה הזו, חיבור פולינומים מתורגם לחיבור נקודתי של שתי סדרות, וכפל פולינומים מתורגם לפעולת &lt;strong&gt;קונבולוציה&lt;/strong&gt; של הסדרות. חיבור נקודתי אנחנו מכירים, אבל קונבולוציה היא פעולה שיכול לקחת זמן עד שפוגשים אותה בשם הזה לראשונה (אני נתקלתי בה בלימודים רק בסמסטר מתקדם יחסית - וכמובן, באותו סמסטר היא הופיעה שוב ושוב בשלל קורסים שונים ובלתי תלויים; עבורי במקום לומר “אפקט באדר-מיינהוף” אפשר לומר “אפקט הקונבולוציה”) אבל הנה, אנחנו רואים שבעצם הכרנו אותה מאז ומעולם, או לפחות מאז שהכרנו כפל פולינומים.&lt;/p&gt;

&lt;p&gt;שנית, שתי הפעולות הללו של חיבור וכפל הופכות את הפולינומים &lt;strong&gt;לחוג&lt;/strong&gt;. אני לא אניח שהמושג הזה מוכר כאן; לסטודנטים יכול לקחת טיפה זמן עד שהם נתקלים בו לראשונה, למרות החשיבות העצומה שלו למתמטיקה, אבל אני מניח שאנחנו כן מכירים &lt;strong&gt;שדות&lt;/strong&gt;, כי כבר באלגברה לינארית מתעסקים איתם. שדות הן קבוצות עם פעולת חיבור וכפל שמתנהגות ממש נחמד - אפילו נחמד &lt;strong&gt;מדי&lt;/strong&gt;. למשל, אפשר לחלק בכל איבר. כשעוברים לדבר על &lt;strong&gt;חוג&lt;/strong&gt; אנחנו משאירים את הדרישות של ההתנהגות הנחמדה מפעולת החיבור, וממשיכים לדרוש את חוק הפילוג (“דיסטריביוטיביות”) אבל מכפל אנחנו דורשים הרבה פחות; שיהיה אסוציאטיבי וזהו בערך. עכשיו, פולינומים דווקא מתנהגים לא רע בכלל - הכפל הוא קומוטטיבי, יש לו יחידה ואי אפשר בטעות לקבל אפס על ידי הכפלה של שני איברים שאינם אפס: זה הופך פולינומים למה שנקרא &lt;strong&gt;תחום שלמות&lt;/strong&gt;, שזה משהו שהאבטיפוס שלו הוא המספרים השלמים. כשהמקדמים של הפולינומים הם מעל שדה &lt;span&gt;\( F \)&lt;/span&gt; אנחנו מסמנים את חוג הפולינומים המתאים ב-&lt;span&gt;\( F\left[x\right] \)&lt;/span&gt;, משתמשים בו לשלל מטרות יפות (למשל, בנייה של שדות שמרחיבים את &lt;span&gt;\( F \)&lt;/span&gt;) וכולם מרוצים.&lt;/p&gt;

&lt;p&gt;אבל אני לא רוצה לדבר על פולינומים. אני רוצה לדבר על טורי חזקות פורמליים.&lt;/p&gt;

&lt;p&gt;מה ההבדל בין פולינומים לטורי חזקות פורמליים? פשוט מאוד. הנה פולינום:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{d}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנה טור חזקות פורמלי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, במקום סכום של &lt;span&gt;\( d+1 \)&lt;/span&gt; איברים, יש לנו סכום של אינסוף איברים. לראות סכום כזה מייד מעלה את השאלה הקשה - &lt;strong&gt;למה זה מתכנס&lt;/strong&gt;? אבל כשמדברים על “טור חזקות פורמלי” ה”פורמלי” אומר בדיוק שהטור קיים גם בלי לעמוד בדרישות התכנסות כלשהן. זו הנקודה שנשמעת הכי חשודה בסיפור אז בואו נעשה את זה לאט.&lt;/p&gt;

&lt;p&gt;בהחלט &lt;strong&gt;יש&lt;/strong&gt; משמעות לשאלות התכנסות כשאני לוקח טור כמו &lt;span&gt;\( \sum_{n=0}^{\infty}\frac{1}{2^{n}} \)&lt;/span&gt; ושואל מה הסכום שלו. כאן יש לנו סדרה &lt;span&gt;\( \left\{ a_{n}\right\} _{n=0}^{\infty} \)&lt;/span&gt;של מספרים ממשיים, &lt;span&gt;\( a_{n}=\frac{1}{2^{n}} \)&lt;/span&gt;. אנחנו יודעים לחבר שני מספרים ממשיים, ובאינדוקציה גם שלושה, ארבעה וכן הלאה - כל מספר &lt;strong&gt;סופי&lt;/strong&gt; שלהם. אבל להתאים מספר קונקרטי לסכום של &lt;strong&gt;אינסוף&lt;/strong&gt; מביניהם - זה כבר דורש טכניקות נוספות, ולא בהכרח תמיד יעבוד. אפשר לכתוב &lt;span&gt;\( \sum_{n=0}^{\infty}\frac{1}{2^{n}}=2 \)&lt;/span&gt; בעזרת השיטה המקובלת לסכימה של טור אינסופי, אבל היא גם תאלץ אותנו לכתוב &lt;span&gt;\( \sum_{n=0}^{\infty}2^{n}=\infty \)&lt;/span&gt;. העניין הוא שבשני המקרים הללו, בין אם הטור מתכנס ובין אם לא, אף אחד לא חושב שיש בעיה עם קיום &lt;strong&gt;הסדרה&lt;/strong&gt;: גם הסדרה &lt;span&gt;\( \left\{ \frac{1}{2^{n}}\right\} _{n=0}^{\infty} \)&lt;/span&gt; וגם הסדרה &lt;span&gt;\( \left\{ 2^{n}\right\} _{n=0}^{\infty} \)&lt;/span&gt; הן אובייקטים שאנחנו לא מערערים על הקיום שלהם, אלא רק תוהים לגבי השאלה האם לאותם אובייקטים אפשר להתאים מספר שיתאר במובן מסויים את הסכום שלהם.&lt;/p&gt;

&lt;p&gt;עם טורי חזקות פורמליים זה אותו דבר. אם הסימון &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt; מעורר בנו אי נוחות כי אנחנו מצפים, כשאנחנו רואים סכום, שהוא יתכנס למשהו, הרי שלראות את &lt;span&gt;\( \left(a_{0},a_{1},a_{2},\ldots\right) \)&lt;/span&gt; לא יעורר בנו את אותו סוג של אי נוחות, אבל שני אלו הם פשוט סימונים שונים לאותו דבר. כמו שהרברט וילף כותב ב-generatingfunctionology שלו: פונקציות יוצרות הן חבל כביסה שעליו אנחנו תולים מספרים לתצוגה.&lt;/p&gt;

&lt;p&gt;אחרי שאנחנו מוכנים לקבל את &lt;strong&gt;הקיום&lt;/strong&gt; של אובייקט כמו &lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;, אפשר לעבור לדבר על מה שעושים איתו - ומה שעושים איתו הוא &lt;strong&gt;אלגברה&lt;/strong&gt;, כלומר פעולות כמו חיבור וכפל. ראינו את ההגדרה עבור פולינומים; איך היא תשתנה עבור טורי חזקות? ובכן, עבור חיבור היא תהפוך מ-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)+b\left(x\right)=\sum_{n=0}^{\max\left\{ d_{1},d_{2}\right\} }\left(a_{n}+b_{n}\right)x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)+b\left(x\right)=\sum_{n=0}^{\infty}\left(a_{n}+b_{n}\right)x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עבור כפל היא תהפוך מ-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)\cdot b\left(x\right)=\sum_{n=0}^{d_{1}+d_{2}}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)\cdot b\left(x\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר בשני המקרים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, ההגדרה הפכה להיות &lt;strong&gt;אלגנטית יותר&lt;/strong&gt; כי לא צריך להסתבך עם הדרגות המעצבנות של הפולינומים. למה זה עובד, למרות שבטור חזקות יש אינסוף איברים? כי גם בהגדרת החיבור וגם בהגדרת הכפל, הערך של כל מקדם הוא סכום &lt;strong&gt;סופי&lt;/strong&gt; של איברים. המקדמים הם לא איברים פורמליים בעצמם; הם מספרים ממשיים (או מרוכבים, או איברים בשדה אחר). אז ביטוי כמו &lt;span&gt;\( a_{n}+b_{n} \)&lt;/span&gt; הוא סכום של שני מספרים ממשיים, וסכום כזה בוודאי קיים; וביטוי כמו &lt;span&gt;\( \sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt; הוא סכום יותר מורכב אבל עדיין כזה שכולל רק מספר &lt;strong&gt;סופי&lt;/strong&gt; של מחוברים. אם היו אינסוף מחוברים, אז היינו בצרות. אבל אנחנו לא בצרות, ובדיוק כמו שעבור הפולינומים קיבלנו חוג שמסומן ב-&lt;span&gt;\( F\left[x\right] \)&lt;/span&gt;, גם עבור טורי חזקות קיבלנו חוג, ואפילו תחום שלמות (ואפילו תחום שלמות עם כל מני תכונות אלגבריות נחמדות שלא אכנס אליהן) שמסומן ב-&lt;span&gt;\( F\left[\left[x\right]\right] \)&lt;/span&gt;.&lt;/p&gt;

&lt;h2&gt;קצת חימום טכני - הטור ההנדסי האינסופי ומספרי פיבונאצ&apos;י&lt;/h2&gt;

&lt;p&gt;בואו נראה שתי דוגמאות פשוטות לעבודה עם פונקציות יוצרות. ראשית, ניקח את הסדרה הממש פשוטה &lt;span&gt;\( a_{n}=1 \)&lt;/span&gt;, כלומר את הפונקציה היוצרת &lt;span&gt;\( 1+x+x^{2}+x^{3}+\ldots \)&lt;/span&gt;. אם נכפול אותה ב-&lt;span&gt;\( \left(1-x\right) \)&lt;/span&gt;, שהוא הפונקציה היוצרת &lt;span&gt;\( \sum_{n=0}^{\infty}b_{n}x^{n} \)&lt;/span&gt; עם&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{n}=\begin{cases} 1 &amp;amp; n=0\\ -1 &amp;amp; n=1\\ 0 &amp;amp; n&amp;gt;1 \end{cases} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x+x^{2}+x^{3}+\ldots\right)\left(1-x\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( c_{0}=a_{0}b_{0}=1 \)&lt;/span&gt; ו-&lt;span&gt;\( c_{1}=a_{0}b_{1}+a_{1}b_{0}=b_{1}+b_{0}=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובאופן כללי, בגלל שכל ה-&lt;span&gt;\( a_{n} \)&lt;/span&gt;-ים הם 1 אז בעצם &lt;span&gt;\( \sum_{k=0}^{n}a_{k}b_{n-k}=\sum_{k=0}^{n}b_{n-k} \)&lt;/span&gt;, ומכיוון שסכום כל ה-&lt;span&gt;\( b \)&lt;/span&gt;-ים החל מ-&lt;span&gt;\( b_{0} \)&lt;/span&gt; ועד למקום כלשהו הוא סכום של 1, מינוס 1 ועוד אפסים, נקבל &lt;span&gt;\( c_{n}=0 \)&lt;/span&gt; לכל &lt;span&gt;\( n&amp;gt;0 \)&lt;/span&gt;. המסקנה היא ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x+x^{2}+x^{3}+\ldots\right)\left(1-x\right)=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, בחוג &lt;span&gt;\( F\left[\left[x\right]\right] \)&lt;/span&gt; האיבר &lt;span&gt;\( 1+x+x^{2}+\ldots \)&lt;/span&gt; הוא &lt;strong&gt;הפיך&lt;/strong&gt; וההופכי שלו הוא &lt;span&gt;\( \left(1-x\right) \)&lt;/span&gt;. כדי לתאר את זה בצורה שקל לנו לעכל, אוהבים לסמן את זה כך:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;קרוב לודאי שאתם מכירים את השוויון הזה בתור נוסחת הסכום של סדרה הנדסית מתכנסת - אבל כאן הוכחנו את הנכונות שלו בלי שיקולי התכנסות! ה”מחיר” הוא שאי אפשר להציב ערכים ב-&lt;span&gt;\( x \)&lt;/span&gt; ולצפות שהשויון יתקיים עבורם; למשל אם נציב &lt;span&gt;\( x=2 \)&lt;/span&gt; נקבל את הסכום הידוע לשמצה &lt;span&gt;\( 1+2+4+8+\ldots=-1 \)&lt;/span&gt; (שנראה מופרך אבל הוא בעצם לא מופרך בכלל, אם אנחנו לא במספרים הממשיים אלא &lt;a href=&quot;https://gadial.net/2014/01/18/sum_of_naturals/&quot;&gt;במקום קסום אחר&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;בואו נעבור לדוגמא קצת יותר מחוכמת: סדרת פיבונאצ’י. הסדרה הזו מוגדרת על ידי הגדרה רקורסיבית: &lt;span&gt;\( F_{0}=1,F_{1}=1 \)&lt;/span&gt; ו-&lt;span&gt;\( F_{n}=F_{n-1}+F_{n-2} \)&lt;/span&gt;. הגדרה רקורסיבית שכזו נותנת לנו דרך פשוטה לגלות מה הפונקציה היוצרת של הסדרה &lt;span&gt;\( F_{0},F_{1},F_{2},\ldots \)&lt;/span&gt;. ראשית כל, נכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)=\sum_{n=0}^{\infty}F_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, היינו רוצים להציב במקום &lt;span&gt;\( F_{n} \)&lt;/span&gt; את &lt;span&gt;\( F_{n}=F_{n-1}+F_{n-2} \)&lt;/span&gt;, אבל אי אפשר לעשות את זה מיידית, כי עבור &lt;span&gt;\( n=0,1 \)&lt;/span&gt; הנוסחה הזו לא מתקיימת. אז נפריד את הסכום לשני האיברים הראשונים וכל היתר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)=\left(1\cdot x^{0}+1\cdot x^{1}\right)+\sum_{n=2}^{\infty}F_{n}x^{n}=\left(1+x\right)+\sum_{n=2}^{\infty}\left(F_{n-1}+F_{n-2}\right)x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\left(1+x\right)+\sum_{n=2}^{\infty}F_{n-1}x^{n}+\sum_{n=2}^{\infty}F_{n-2}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המטרה שלי היא לנסות לגרום לשני הסכומים הללו להיראות כמו הסכום המקורי שהגדיר את הפונקציה היוצרת של פיבונאצ’י. בואו נסתכל על &lt;span&gt;\( \sum_{n=2}^{\infty}F_{n-2}x^{n} \)&lt;/span&gt; קודם - אני יכול לשנות את אינדקס הסכימה. כלל אצבע שקל לזכור הוא - אני יכול &lt;strong&gt;להגדיל&lt;/strong&gt; את האינדקס באיזה ערך שאני רוצה (במקרה הנוכחי, 2) בתנאי שאני &lt;strong&gt;מקטין&lt;/strong&gt; את הערך ההתחלתי באותה כמות. כלומר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{n=2}^{\infty}F_{n-2}x^{n}=\sum_{n=0}^{\infty}F_{n}x^{n+2}=x^{2}\sum_{n=0}^{\infty}F_{n}x^{n}=x^{2}F\left(x\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עבור &lt;span&gt;\( \sum_{n=2}^{\infty}F_{n-1}x^{n} \)&lt;/span&gt; זה יהיה טיפה טריקי יותר כי אם אני אגדיל את אינדקס הסכימה ב-1, אני עדיין לא אקבל את &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; בסכום, כי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{n=2}^{\infty}F_{n-1}x^{n}=\sum_{n=1}^{\infty}F_{n}x^{n+1}=x\sum_{n=1}^{\infty}F_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הסכום פה מתחיל מ-1, לא מ-0. כדי לטפל בזה אני יכול &lt;strong&gt;לחבר ולחסר&lt;/strong&gt; את אותו איבר, שבמקרה הנוכחי הוא &lt;span&gt;\( F_{0}x^{0}=1 \)&lt;/span&gt; (למעשה, בחרתי להתחיל את פיבונאצ’י מ-1 ולא מ-0 כדי להדגים את ההתמודדות עם הקושי הזה). כלומר, אני אכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x\sum_{n=1}^{\infty}F_{n}x^{n}=x\left(\sum_{n=0}^{\infty}F_{n}x^{n}-1\right)=xF\left(x\right)-x \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן מכל זה קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)=\left(1+x\right)+x^{2}F\left(x\right)+xF\left(x\right)-x=\left(x^{2}+x\right)F\left(x\right)+1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להעביר את &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; אגף ולהוציא גורם משותף - אלו פעולות תקינות בכל חוג. נקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)\left(1-x^{2}-x\right)=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שהייתי רוצה לעשות עכשיו הוא &lt;strong&gt;לחלק&lt;/strong&gt; ב-&lt;span&gt;\( 1-x^{2}-x \)&lt;/span&gt;. האם מותר לי? כבר ראיתי שאפשר לחלק ב-&lt;span&gt;\( \left(1-x\right) \)&lt;/span&gt;, אבל מה עם דברים מורכבים יותר? תכף אני אוכיח שכל עוד המקדם החופשי הפיך, תמיד אפשר לחלק, אז התוצאה היא שאני יכול לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)=\frac{1}{1-x^{2}-x} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו הפונקציה היוצרת של מספרי פיבונאצ’י (כשהם מתחילים מ-1 ולא מ-0). בשביל מה זה היה טוב? מה אפשר לעשות איתה שלא יכלנו לעשות בלעדיה? זה סיפור אחר - אפשר למשל לקבל ממנה את הנוסחה הסגורה למספרי פיבונאצ’י, או הערכות אסימפטוטיות על קצב הגידול שלה; כל זה מצריך לקחת את הפונקציה היוצרת ולזרוק עליה כלים סטנדרטיים שיודעים לטפל באנליזה של פונקציות רציונליות. הדגש פה הוא על &lt;strong&gt;סטנדרטיים&lt;/strong&gt; - זו הסיבה שמתמטיקאים אוהבים פונקציות יוצרות, זו דרך קומפקטית לייצר סדרות, שאחר כך אפשר להשתמש עליה בכל המתמטיקה שאנחנו מכירים.&lt;/p&gt;

&lt;p&gt;כדי לסיים את החלק הזה אני צריך להוכיח את מה שטענתי קודם: ש-&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt; הוא הפיך אם ורק אם &lt;span&gt;\( a_{0} \)&lt;/span&gt; הפיך. הרעיון בבסיסו הוא אותו רעיון כמו ההיפוך של &lt;span&gt;\( 1+x+x^{2}+\ldots \)&lt;/span&gt; רק שהפעם במקום לזרוק מהשמיים את ההופכי אני אסביר איך מוצאים אותו.&lt;/p&gt;

&lt;p&gt;אם קיים הופכי, &lt;span&gt;\( b\left(x\right)=\sum_{n=0}^{\infty}b_{n}x^{n} \)&lt;/span&gt;, מה המקדמים שלו &lt;strong&gt;חייבים&lt;/strong&gt; להיות? אנחנו יודעים ש-&lt;span&gt;\( a\left(x\right)b\left(x\right)=1 \)&lt;/span&gt; (כי זו ההגדרה של הופכי), כלומר אם נכתוב &lt;span&gt;\( a\left(x\right)\cdot b\left(x\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt; אז &lt;span&gt;\( c_{0}=1 \)&lt;/span&gt; ו-&lt;span&gt;\( c_{n}=0 \)&lt;/span&gt; לכל &lt;span&gt;\( n&amp;gt;0 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מהשוויון הראשון אנחנו מקבלים &lt;span&gt;\( a_{0}b_{0}=1 \)&lt;/span&gt;. כלומר, אם &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; היה הפיך אז השוויון הזה מראה לנו ש-&lt;span&gt;\( a_{0} \)&lt;/span&gt; הפיך ו-&lt;span&gt;\( b_{0} \)&lt;/span&gt; הוא ההופכי שלו; זה כיוון אחד של ההוכחה. הכיוון המורכב יותר הוא להניח ש-&lt;span&gt;\( a_{0} \)&lt;/span&gt; הפיך ולכן באמת קיים לו הופכי &lt;span&gt;\( b_{0} \)&lt;/span&gt;, וזה נותן לנו את &lt;strong&gt;ההתחלה&lt;/strong&gt; של הבניה של &lt;span&gt;\( b\left(x\right) \)&lt;/span&gt;, אבל צריך להראות שאפשר לבנות גם את יתר המקדמים.&lt;/p&gt;

&lt;p&gt;למרבה המזל, יתר המקדמים מתקבלים מאליהם, בדרך אינדוקטיבית. נניח שכבר ידועים לנו המקדמים &lt;span&gt;\( b_{0},\ldots,b_{n-1} \)&lt;/span&gt; ונבנה את &lt;span&gt;\( b_{n} \)&lt;/span&gt;. מכיוון ש-&lt;span&gt;\( n&amp;gt;0 \)&lt;/span&gt; אז &lt;span&gt;\( c_{n}=0 \)&lt;/span&gt; ולכן השוויון &lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt; שמגדיר את המקדם במכפלה נותן לנו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{0}b_{n}=-\sum_{k=1}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, אמרנו כבר ש-&lt;span&gt;\( a_{0} \)&lt;/span&gt; הפיך, אז אפשר לחלק בו - כלומר, לכפול ב-&lt;span&gt;\( b_{0} \)&lt;/span&gt;, ולקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{n}=-b_{0}\sum_{k=1}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אגף ימין מורכב כולו מפעולת &lt;strong&gt;חוקיות&lt;/strong&gt; בחוג &lt;span&gt;\( F \)&lt;/span&gt; שמעליו אנחנו מגדירים את &lt;span&gt;\( F\left[\left[x\right]\right] \)&lt;/span&gt;, כך שהבניה עובדת וזה מסיים את ההוכחה! לא רק שהוכחנו ש-&lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; הפיך, גם עשינו את זה בדרך קונסטרוקטיבית שמוצאת את ההופכי שלו.&lt;/p&gt;

&lt;h2&gt;הפונקציה היוצרת של מספרי קטלן&lt;/h2&gt;

&lt;p&gt;עד כאן, הכל טוב, אז בואו נתמודד עם האתגר המרכזי שלנו - מציאת הפונקציה היוצרת של מספרי קטלן.&lt;/p&gt;

&lt;p&gt;יש כמה דרכים להגיע אל הפונקציה היוצרת של מספרי קטלן, ואחת הפשוטות שבהן היא להניח שכבר מצאנו את נוסחת הנסיגה שלהם, שראינו בפוסט הקודם: &lt;span&gt;\( C_{n+1}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;, עם תנאי ההתחלה &lt;span&gt;\( C_{0}=1 \)&lt;/span&gt;. הנוסחה הזו גם מזכירה קצת את זו של פיבונאצ’י ולכן הטכניקה שבה השתמשנו עבור פיבונאצ’י נראית מבטיחה כאן - אבל אפילו עוד יותר מכך, הנוסחה הזו מזכירה את איך שמכפלת פולינומים עובדת: &lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt;. רק הקטע הזה עם ה-&lt;span&gt;\( n+1 \)&lt;/span&gt; טיפה שונה. בואו נראה איך זה יסתדר לנו.&lt;/p&gt;

&lt;p&gt;נתחיל עם להגדיר את הפונקציה היוצרת: &lt;span&gt;\( C\left(x\right)=\sum_{n=0}^{\infty}C_{n}x^{n} \)&lt;/span&gt;. עכשיו, בואו נכפיל את &lt;span&gt;\( C\left(x\right) \)&lt;/span&gt; &lt;strong&gt;בעצמה&lt;/strong&gt; כדי לנסות לקבל משהו שנראה כמו הנוסחה למכפלת פולינומים. אני אסמן את ההכפלה של &lt;span&gt;\( C\left(x\right) \)&lt;/span&gt; בעצמה ב-&lt;span&gt;\( C\left(x\right)^{2} \)&lt;/span&gt; - גם זה סימון סטנדרטי לגמרי בחוגים באופן כללי, ואני מקפיד על הפדנטיות הזו רק כי עוד רגע יגיעו דברים לא לגמרי סטנדרטיים.&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C\left(x\right)^{2}=\sum_{n=0}^{\infty}A_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A_{n}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה מה שנובע מהנוסחה למכפלת פולינומים. אבל בנוסף לכך אנחנו מכירים את נוסחת הנסיגה של קטלן, &lt;span&gt;\( C_{n+1}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;, ולכן משילוב של שתיהן אנחנו מקבלים ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A_{n}=C_{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C\left(x\right)^{2}=\sum_{n=0}^{\infty}C_{n+1}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הייתי רוצה להשתמש באותו טריק כמו פיבונאצ’י כדי להמיר את אגף ימין ל-&lt;span&gt;\( C\left(x\right) \)&lt;/span&gt;, אבל יש לי כאן בעיה. קודם, בפיבונאצ’י, הסכימה התחילה ממשהו גדול מ-0, והמקדם בפנים היה בעל אינדקס קטן מ-&lt;span&gt;\( n \)&lt;/span&gt;, ולכן היה קל לתקן את זה - הגדלנו את האינדקס, הקטנו את הערך ההתחלתי. כאן, לעומת זאת, הסכימה מתחילה מ-0, כלומר מהערך הנכון, והאינדקס הוא גדול מ-&lt;span&gt;\( n \)&lt;/span&gt;. אז נעשה משהו טיפה שונה: קודם כל נכפול את שני האגפים ב-&lt;span&gt;\( x \)&lt;/span&gt; (פעולה מותרת בחוג), ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( xC\left(x\right)^{2}=\sum_{n=0}^{\infty}C_{n+1}x^{n+1}=\sum_{n=1}^{\infty}C_{n}x^{n}=\sum_{n=0}^{\infty}C_{n}x^{n}-C_{0}=C\left(x\right)-1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אחרי העברת אגפים נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( xC\left(x\right)^{2}-C\left(x\right)+1=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו… משוואה ריבועית? עכשיו אפשר לנפנף ממש מהר בידיים כמו שחלק מהספרים עושים: להגיד שנוסחת השורשים מלמדת אותנו ש-&lt;span&gt;\( C\left(x\right)=\frac{1\pm\sqrt{1-4x}}{2x} \)&lt;/span&gt; ושהפתרון ה”נכון” מבין השניים הוא זה עם המינוס, כי אם נסתכל על &lt;span&gt;\( \frac{1+\sqrt{1-4x}}{2x} \)&lt;/span&gt; נראה שכש-&lt;span&gt;\( x \)&lt;/span&gt; שואף ל-0 המונה שואף ל-2 ולכן הביטוי שואף לאינסוף למרות שהוא אמור לשאוף ל-&lt;span&gt;\( C_{0}=1 \)&lt;/span&gt; ולעומת זאת עבור &lt;span&gt;\( \frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt; קל לראות שזה עובד עם כלל לופיטל, וסיימנו! גילינו את הנוסחה לפונקציה היוצרת של מספרי קטלן, &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;. זהו, אפשר לסגור את הפוסט.&lt;/p&gt;

&lt;h2&gt;אפשר לסגור את הפוסט, או שלא&lt;/h2&gt;

&lt;p&gt;אוקיי, בואו לא נסגור עדיין את הפוסט.&lt;/p&gt;

&lt;p&gt;חשוב לי להדגיש שכל מה שראינו פה הוא &lt;strong&gt;נכון&lt;/strong&gt;. זה למעשה מה שאוילר עשה במכתב הראשון שבו הוא סיפר לגולדבך על מספרי קטלן. אבל בבירור לא עשיתי את זה ברמת הפורמליות שבה התייחסתי לטורי חזקות פורמליים בכל יתר הפוסט, ומה שעוד יותר גרוע - פתאום ברגע האחרון עירבתי מושגים מאנליזה ודיברתי על להשאיף את &lt;span&gt;\( x \)&lt;/span&gt; לאפס ועל כלל לופיטל… זה בלאגן שלם. לכן אני רוצה להקדיש את החלק הזה של הפוסט, שיהיה יותר מורכב מתמטית ממה שעשינו עד עכשיו, כדי להסביר למה הכל בסדר.&lt;/p&gt;

&lt;p&gt;הרגע האחרון שבו הכל היה באמת בסדר פורמלית היה כשקיבלתי את המשוואה &lt;span&gt;\( xC\left(x\right)^{2}-C\left(x\right)+1=0 \)&lt;/span&gt;. הדבר הבא שעשיתי היה להזכיר את &lt;strong&gt;נוסחת השורשים&lt;/strong&gt;. נוסחת השורשים היא הכלי הסטנדרטי שלנו לפתרון משוואה ריבועית, והיא נכונה בהרבה סיטואציות, לא רק במספרים הממשיים והמרוכבים. בואו נראה את זה: אני נמצא בחוג &lt;span&gt;\( R \)&lt;/span&gt; כלשהו, עם איברים &lt;span&gt;\( a,b,c\in R \)&lt;/span&gt;, ואני מחפש ערך של &lt;span&gt;\( x\in R \)&lt;/span&gt; שמקיים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( ax^{2}+bx+c=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gadial.net/2023/12/16/quadratic_equations/&quot;&gt;יש לי פוסט&lt;/a&gt; שמסביר מה עושים עכשיו, אבל אני אתן פה תיאור טיפה שונה. ראשית, נכפול את שני אגפי המשוואה ב-&lt;span&gt;\( 4a \)&lt;/span&gt; ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 4a^{2}x^{2}+4abx+4ac=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה עדיין מתקיים בכל חוג &lt;span&gt;\( R \)&lt;/span&gt;. עכשיו, נסתכל על הביטוי &lt;span&gt;\( \Delta=b^{2}-4ac \)&lt;/span&gt; (“הדיסקרימיננטה”). גם הביטוי הזה - קיים בכל חוג &lt;span&gt;\( R \)&lt;/span&gt;. נחבר אותו לשני האגפים ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 4a^{2}x^{2}+4abx+b^{2}=\Delta \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אגף שמאל נראה בדיוק כמו משהו בריבוע: &lt;span&gt;\( 4a^{2}x^{2}+4abx+b^{2}=\left(2ax+b\right)^{2} \)&lt;/span&gt;. &lt;strong&gt;גם זה עדיין נכון בכל חוג&lt;/strong&gt;. כלומר, קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(2ax+b\right)^{2}=\Delta \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו מגיע המעבר ה”בעייתי”:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 2ax+b=\pm\sqrt{\Delta} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המעבר הזה בעייתי לא רק בגלל שאנחנו בחוג כללי - אפילו אם היינו עובדים מעל הממשיים, &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt;, הוא עדיין היה בעייתי אם &lt;span&gt;\( \Delta \)&lt;/span&gt; היה שלילי. אז במקום לראות אותו כ”בעייתי” אפשר לחשוב על זה כאילו אנחנו מוסיפים הנחה: אנחנו אומרים - &lt;strong&gt;נניח&lt;/strong&gt; שקיים &lt;span&gt;\( \alpha\in R \)&lt;/span&gt; כך ש-&lt;span&gt;\( \alpha^{2}=\Delta \)&lt;/span&gt;, אז במקרה הזה אפשר לכתוב &lt;span&gt;\( \left(2ax+b\right)^{2}=\alpha^{2} \)&lt;/span&gt;. אבל האם עכשיו אפשר להסיק ש-&lt;span&gt;\( 2ax+b=\pm\alpha \)&lt;/span&gt;? ובכן, לא.&lt;/p&gt;

&lt;p&gt;בואו נראה דוגמא: החוג &lt;span&gt;\( R=\mathbb{Z}_{8}=\left\{ 0,1,\ldots,7\right\}  \)&lt;/span&gt; עם חיבור וכפל מודולו 8. בחוג הזה מתקיים ש-&lt;span&gt;\( 1^{2}=3^{2}=5^{2}=7^{2}=1 \)&lt;/span&gt;, ולכן אם &lt;span&gt;\( x^{2}=y^{2} \)&lt;/span&gt; זה לא אומר ש-&lt;span&gt;\( x=\pm y \)&lt;/span&gt; כי למשל מה אם &lt;span&gt;\( y=1 \)&lt;/span&gt; ואילו &lt;span&gt;\( x=3 \)&lt;/span&gt;?&lt;/p&gt;

&lt;p&gt;אז אילו תנאים צריך לדרוש מהחוג שלנו כדי ש-&lt;span&gt;\( x^{2}=y^{2} \)&lt;/span&gt; יגרור &lt;span&gt;\( x=\pm y \)&lt;/span&gt;? בואו ננסה להוכיח את זה ונראה את התנאים צצים בדרך.&lt;/p&gt;

&lt;p&gt;נתחיל עם &lt;span&gt;\( x^{2}=y^{2} \)&lt;/span&gt;. נעביר את &lt;span&gt;\( y \)&lt;/span&gt; אגף (לא דורש כלום) ונקבל &lt;span&gt;\( x^{2}-y^{2}=0 \)&lt;/span&gt;, שאפשר לכתוב גם בתור &lt;span&gt;\( \left(x-y\right)\left(x+y\right)=0 \)&lt;/span&gt;. הופס, הוספנו דרישה! רואים מה היא? השתמשתי בדיסטריביוטיביות, אבל זה לא העניין כאן אלא זה שאם נפתח את הסוגריים, נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(x-y\right)\left(x+y\right)=x^{2}-yx+xy-y^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, אני הנחתי ש-&lt;span&gt;\( xy=yx \)&lt;/span&gt; וזה קורה באופן כללי רק אם החוג &lt;strong&gt;קומוטטיבי&lt;/strong&gt;. אבל אוקיי, &lt;span&gt;\( R\left[\left[x\right]\right] \)&lt;/span&gt; שלנו הוא קומוטטיבי אם &lt;span&gt;\( R \)&lt;/span&gt; עצמו הוא קומוטטיבי (ואצלנו &lt;span&gt;\( R \)&lt;/span&gt; הוא הממשיים/המרוכבים). אז בינתיים זו דרישה קלילה יחסית (אבל שמראה יפה כמה חוגים לא קומוטטיביים - למשל חוגי מטריצות - הם עולמות משוגעים בפני עצמם).&lt;/p&gt;

&lt;p&gt;עכשיו, קיבלתי &lt;span&gt;\( \left(x-y\right)\left(x+y\right)=0 \)&lt;/span&gt;, כלומר יש לי מכפלה של שני איברים ששווה אפס. האם בכלל ייתכן שמכפלה של שני איברים תיתן אפס למרות ששניהם שונים מאפס? זה לא משהו שיש באינטואיציה המתמטית היומימית שלנו כי זה לא קורה בשלמים והרחבותיהם, אבל זה &lt;strong&gt;כן&lt;/strong&gt; קורה ב-&lt;span&gt;\( \mathbb{Z}_{8} \)&lt;/span&gt; שהבאתי כאן בתור דוגמה, למשל &lt;span&gt;\( 2\cdot4=0 \)&lt;/span&gt;. לכן בתורת החוגים יש מונחים סטנדרטיים לסיפור הזה: אנחנו אומרים ש-&lt;span&gt;\( a,b \)&lt;/span&gt; הם &lt;strong&gt;מחלקי אפס&lt;/strong&gt; אם &lt;span&gt;\( ab=0 \)&lt;/span&gt; למרות ש-&lt;span&gt;\( a,b\ne0 \)&lt;/span&gt;, וקוראים לחוג (קומוטטיבי בד”כ) בלי מחלקי אפס &lt;strong&gt;תחום שלמות&lt;/strong&gt;. בתחומי שלמות, ש-&lt;span&gt;\( \mathbb{Z} \)&lt;/span&gt; הוא מעין אבטיפוס שלהם, אפשר לבצע “צמצום”: אם &lt;span&gt;\( ax=ay \)&lt;/span&gt; אז &lt;span&gt;\( x=y \)&lt;/span&gt; זו הדוגמא הפשוטה, אבל גם &lt;span&gt;\( x^{2}=y^{2} \)&lt;/span&gt; גורר &lt;span&gt;\( x=\pm y \)&lt;/span&gt; הוא דוגמא לצמצום, ואנחנו מקבלים אותו כי אם יש לנו &lt;span&gt;\( \left(x-y\right)\left(x+y\right)=0 \)&lt;/span&gt; בתחום שלמות, או ש-&lt;span&gt;\( x-y=0 \)&lt;/span&gt; או ש-&lt;span&gt;\( x+y=0 \)&lt;/span&gt;, אין אפשרות אחרת.&lt;/p&gt;

&lt;p&gt;למרבה השמחה, &lt;span&gt;\( R\left[\left[x\right]\right] \)&lt;/span&gt; הוא תחום שלמות אם &lt;span&gt;\( R \)&lt;/span&gt; הוא תחום שלמות, כי אם &lt;span&gt;\( a\left(x\right)b\left(x\right)=0 \)&lt;/span&gt; אז בפרט &lt;span&gt;\( a_{0}b_{0}=0 \)&lt;/span&gt; ואם אנחנו מעל תחום שלמות אז בלי הגבלת הכלליות, &lt;span&gt;\( b_{0}=0 \)&lt;/span&gt;. עכשיו, &lt;span&gt;\( a_{0}b_{1}+a_{1}b_{0}=0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( a_{0}b_{1}=0 \)&lt;/span&gt; ונקבל שגם &lt;span&gt;\( b_{1}=0 \)&lt;/span&gt; וכן הלאה באינדוקציה.&lt;/p&gt;

&lt;p&gt;אם כן, חזרה למשוואות ריבועיות: מה שראינו הוא שמעל תחום שלמות, &lt;strong&gt;אם&lt;/strong&gt; קיים &lt;span&gt;\( \alpha \)&lt;/span&gt; כך ש-&lt;span&gt;\( \alpha^{2}=\Delta \)&lt;/span&gt; אז אפשר לומר &lt;span&gt;\( 2ax+b=\pm\alpha \)&lt;/span&gt;. עכשיו אפשר להעביר אגף ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 2ax=-b\pm\alpha \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כדי להתקדם מכאן, אנחנו צריכים שאפשר יהיה לחלק ב-&lt;span&gt;\( 2a \)&lt;/span&gt; וזה כמובן לא נכון בכל חוג, אפילו לא בתחום שלמות, זה הרי לא נכון אפילו ב-&lt;span&gt;\( \mathbb{Z} \)&lt;/span&gt;. אבל אם אפשר לחלק ב-&lt;span&gt;\( 2a \)&lt;/span&gt; - כלומר, אם &lt;span&gt;\( 2a \)&lt;/span&gt; הוא &lt;strong&gt;הפיך&lt;/strong&gt; בחוג שלנו - אז נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=\frac{-b\pm\alpha}{2a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכדי לא לכתוב &lt;span&gt;\( \alpha \)&lt;/span&gt; מעדיפים לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=\frac{-b\pm\sqrt{b^{2}-4ac}}{2a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מתוך הבנה ש-&lt;span&gt;\( \sqrt{b^{2}-4ac} \)&lt;/span&gt; הוא &lt;strong&gt;סימון&lt;/strong&gt; שאומר “איבר בחוג שכשמעלים אותו בריבוע מקבלים &lt;span&gt;\( b^{2}-4ac \)&lt;/span&gt;, בהנחה שקיים כזה”.&lt;/p&gt;

&lt;p&gt;זה האופן שבו צריך לקרוא את המשוואה &lt;span&gt;\( C\left(x\right)=\frac{1\pm\sqrt{1-4x}}{2x} \)&lt;/span&gt; שקיבלנו עבור מספרי קטלן. מה שהיא אומרת, ברמה הפורמלית ביותר, הוא “אם קיים טור חזקות פורמלי &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( a\left(x\right)^{2}=1-4x \)&lt;/span&gt;, אז &lt;span&gt;\( C\left(x\right) \)&lt;/span&gt; הוא או &lt;span&gt;\( \frac{1+a\left(x\right)}{2x} \)&lt;/span&gt; או &lt;span&gt;\( \frac{1-a\left(x\right)}{2x} \)&lt;/span&gt;, אנחנו לא סגורים על איזה משניהם נכון”.&lt;/p&gt;

&lt;p&gt;אבל רגע, לא סיימנו! צריך להצדיק גם את החלוקה ב-&lt;span&gt;\( 2x \)&lt;/span&gt;. להצדיק חלוקה ב-&lt;span&gt;\( 2 \)&lt;/span&gt; זה קל, הרי &lt;span&gt;\( 2 \)&lt;/span&gt; הוא הפיך. אבל לחלק ב-&lt;span&gt;\( 2x \)&lt;/span&gt;? הרי לפני רגע אמרתי שטור חזקות הוא הפיך אם ורק אם האיבר החופשי שלו הוא הפיך, וב-&lt;span&gt;\( 2x \)&lt;/span&gt;, כשאני חושב עליו בתור טור חזקות, האיבר החופשי הוא 0, כלומר לא הפיך. &lt;strong&gt;אופס&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;העניין הוא שכן אפשר סוג של “לחלק” ב-&lt;span&gt;\( x \)&lt;/span&gt;. לפעמים. הנה דוגמא לאיך זה עובד. נניח ש-&lt;span&gt;\( a\left(x\right)=a_{1}x+a_{2}x^{2}+\ldots \)&lt;/span&gt;, כלומר יש לנו טור חזקות שהמקדם החופשי שלו הוא 0. אז אפשר &lt;strong&gt;להוציא החוצה&lt;/strong&gt; את &lt;span&gt;\( x \)&lt;/span&gt; ולקבל &lt;span&gt;\( a\left(x\right)=x\left(a_{1}+a_{2}x+\ldots\right) \)&lt;/span&gt; ואז אפשר לכתוב &lt;span&gt;\( a_{1}+a_{2}x+\ldots=\frac{a\left(x\right)}{x} \)&lt;/span&gt;. כלומר, את הפעולה “חלוקה ב-&lt;span&gt;\( x \)&lt;/span&gt;” אפשר לראות בתור “הזזה שמאלה של כל האיברים בסדרה שמתחילה ב-0” - אם היה לנו את הסדרה &lt;span&gt;\( \left(0,a_{1},a_{2},\ldots\right) \)&lt;/span&gt; אחרי ביצוע הפעולה הזו קיבלנו את הסדרה &lt;span&gt;\( \left(a_{1},a_{2},\ldots\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עוד יותר פורמלית, מה שאנחנו רואים במשוואה &lt;span&gt;\( C\left(x\right)=\frac{1\pm a\left(x\right)}{2x} \)&lt;/span&gt; הוא בעצם את &lt;span&gt;\( 2xC\left(x\right)=1\pm a\left(x\right)^{2} \)&lt;/span&gt;. אם נגלה שיש &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( 1-a\left(x\right)=x\cdot b\left(x\right) \)&lt;/span&gt; כלשהו, אז נוכל לכתוב &lt;span&gt;\( 2xC\left(x\right)=xb\left(x\right) \)&lt;/span&gt; ואז נוכל &lt;strong&gt;לצמצם&lt;/strong&gt; ב-&lt;span&gt;\( x \)&lt;/span&gt;, כי אנחנו בתחום שלמות, ולקבל &lt;span&gt;\( 2C\left(x\right)=b\left(x\right) \)&lt;/span&gt;, כלומר &lt;span&gt;\( C\left(x\right)=\frac{b\left(x\right)}{2} \)&lt;/span&gt;. זה התוכן הפורמלי של הכתיב &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;העניין הזה גם מסביר לנו למה אנחנו בוחרים מינוס ולא פלוס, גם בלי שנזדקק ישירות להסברים אנליטיים: אם קיים &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( a\left(x\right)^{2}=1-4x \)&lt;/span&gt;, אז המקדם החופשי שלו מקיים &lt;span&gt;\( a_{0}^{2}=1 \)&lt;/span&gt; (כי &lt;span&gt;\( 1 \)&lt;/span&gt; הוא המקדם החופשי של המכפלה, &lt;span&gt;\( 1-4x \)&lt;/span&gt;) ובגלל שאנחנו בתחום שלמות, &lt;span&gt;\( a_{0}=\pm1 \)&lt;/span&gt;. כשמשתמשים בסימן &lt;span&gt;\( \sqrt{\cdot} \)&lt;/span&gt; עבור מספרים ממשיים הכוונה היא תמיד ללקיחת השורש החיובי, אז גם כאן נוכל להשתמש במוסכמה שלוקחים את ה-&lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; עם המקדם החופשי &lt;span&gt;\( a_{0}=1 \)&lt;/span&gt;. עכשיו, אם אנחנו רוצים שהביטוי &lt;span&gt;\( \frac{1\pm a\left(x\right)}{2x} \)&lt;/span&gt; יהיה מוגדר היטב, צריך שהמקדם החופשי של &lt;span&gt;\( 1\pm a\left(x\right) \)&lt;/span&gt; יהיה 0, וזה יעבוד עבור חיסור ולא יעבוד עבור חיבור.&lt;/p&gt;

&lt;p&gt;כמובן, עדיין נותרה לנו שאלה אחת: &lt;strong&gt;למה&lt;/strong&gt; אנחנו יודעים ש-&lt;span&gt;\( \sqrt{1-4x} \)&lt;/span&gt; קיים בכלל? אני יכול לכתוב &lt;span&gt;\( a\left(x\right)^{2}=1-4x \)&lt;/span&gt; ולנסות לפתור את המשוואה ולחלץ את המקדמים של &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt;, כמו שעשיתי עבור הופכי. אבל אני יכול גם לחפור יותר עמוק…&lt;/p&gt;

&lt;h2&gt;חופרים יותר עמוק&lt;/h2&gt;

&lt;p&gt;אני מניח שאנחנו מכירים את הבינום של ניוטון, ואם לא - &lt;a href=&quot;https://gadial.net/2010/06/22/newton_binom/&quot;&gt;יש לי על זה פוסט&lt;/a&gt;. זו הנוסחה החביבה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a+b\right)^{n}=\sum_{k=0}^{n}{n \choose k}a^{k}b^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;שנכונה לכל &lt;span&gt;\( n \)&lt;/span&gt; טבעי ו-&lt;span&gt;\( a,b \)&lt;/span&gt; כלשהם, אפילו איברים בחוג &lt;strong&gt;קומוטטיבי&lt;/strong&gt; כללי.&lt;/p&gt;

&lt;p&gt;זו נוסחה שימושית ונהדרת עם הוכחה קומבינטורית מקסימה וכל זה מתואר בפוסט שלי. אני רוצה לדבר הפעם על &lt;strong&gt;ההכללה&lt;/strong&gt; שלה: מה קורה אם אנחנו רוצים ש-&lt;span&gt;\( n \)&lt;/span&gt; לא יהיה מספר טבעי דווקא, אלא מספר ממשי כללי? ובכן, ניוטון דאג גם לזה, ובאמצעות חדו”א אפשר להוכיח את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a+b\right)^{r}=\sum_{k=0}^{\infty}{r \choose k}a^{k}b^{r-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( r\in\mathbb{R} \)&lt;/span&gt; הוא מספר ממשי כללי, והסימון &lt;span&gt;\( {r \choose k} \)&lt;/span&gt; מוגדר בתור&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( {r \choose k}=\frac{r\left(r-1\right)\left(r-2\right)\cdots\left(r-k+1\right)}{k!} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו ממש הכללה ישירה של הבינום הרגיל של ניוטון, שבו &lt;span&gt;\( {n \choose k}=\frac{n!}{k!\left(n-k!\right)}=\frac{n\left(n-1\right)\left(n-2\right)\cdots\left(n-k+1\right)}{k!} \)&lt;/span&gt;. העניין הוא שאם &lt;span&gt;\( n \)&lt;/span&gt; הוא מספר טבעי, ואם &lt;span&gt;\( k&amp;gt;n \)&lt;/span&gt;, אז נקבל &lt;span&gt;\( {n \choose k}=0 \)&lt;/span&gt; כי במכפלה &lt;span&gt;\( \left(n-1\right)\ldots\left(n-k+1\right) \)&lt;/span&gt; יופיע מתישהו &lt;span&gt;\( \left(n-n\right) \)&lt;/span&gt;, כלומר כל המכפלה הזו מוכפלת ב-0 ושווה ל-0 ולכן אנחנו מקבלים ש-&lt;span&gt;\( \left(a+b\right)^{n} \)&lt;/span&gt; הוא לא סכום אינסופי אלא סופי (ליתר דיוק - הוא סכום אינסופי שכל אבריו הם 0 החל ממקום מסויים).&lt;/p&gt;

&lt;p&gt;אם לעומת זאת &lt;span&gt;\( r \)&lt;/span&gt; הוא לא מספר טבעי, אז &lt;span&gt;\( \left(r-r\right) \)&lt;/span&gt; לא יופיע במכפלה ולכן היא אף פעם לא תתאפס. לכן צריך לעבור לסכום אינסופי ולקוות ממש חזק שהוא יתכנס.&lt;/p&gt;

&lt;p&gt;בואו נראה דוגמא. נניח ש- &lt;span&gt;\( a=-4x \)&lt;/span&gt; ו-&lt;span&gt;\( b=1 \)&lt;/span&gt; ו-&lt;span&gt;\( r=\frac{1}{2} \)&lt;/span&gt;, אז נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sqrt{1-4x}=\left(-4x+1\right)^{\frac{1}{2}}=\sum_{k=0}^{\infty}{1/2 \choose k}\left(-4x\right)^{k}=\sum_{k=0}^{\infty}\left(-4\right)^{k}{1/2 \choose k}x^{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנוסחה הזו מאפשר חישוב פשוט של המקדמים של &lt;span&gt;\( x^{k} \)&lt;/span&gt; עבור הערכים הראשונים של &lt;span&gt;\( k \)&lt;/span&gt; (אני מציע לכם לנסות לחשב בעצמכם, גם אני “מרגיש” את הביטוי רק כשאני עושה את זה):&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( \left(-4\right)^{0}{1/2 \choose 0}=1\cdot1=1 \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left(-4\right)^{1}{1/2 \choose 1}=-4\cdot\frac{1}{2}=-2 \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left(-4\right)^{2}{1/2 \choose 2}=16\cdot\frac{1}{2}\cdot\frac{1}{2}\cdot\left(-\frac{1}{2}\right)=-2 \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left(-4\right)^{3}{1/2 \choose 3}=-64\cdot\frac{1}{2\cdot3}\cdot\frac{1}{2}\cdot\left(-\frac{1}{2}\right)\cdot\left(-\frac{3}{2}\right)=-4 \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;מכאן כבר יש לי מספיק אומץ לנסות לכתוב את הביטוי הכללי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(-4\right)^{n}{1/2 \choose n}=\left(-1\right)^{n}2^{n}\cdot2^{n}\cdot\frac{1}{2\cdot3\cdots n}\cdot\frac{1}{2}\cdot\left(-\frac{1}{2}\right)\cdot\left(-\frac{3}{2}\right)\cdots\left(-\frac{2n-3}{2}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =2^{n}\cdot\frac{3\cdot5\cdots\left(2n-3\right)}{2\cdot3\cdots n}=\frac{6\cdot10\cdots\left(4n-6\right)}{2\cdot3\cdots n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שנותן לנו, אם נציב ערכים קונקרטיים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sqrt{1-4x}=1-2x-2x^{2}-4x^{3}-10x^{4}-28x^{5}-84x^{6}-\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה כמובן מזכיר את סדרת מספרי קטלן, &lt;span&gt;\( 1,1,2,5,14,42,\ldots \)&lt;/span&gt;, ולא במקרה: הנוסחה שקיבלנו הייתה &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;, כך שמספרי קטלן מתקבלים מ-&lt;span&gt;\( \sqrt{1-4x} \)&lt;/span&gt; באופן הבא:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;החליפו את ה-1 שבהתחלה ב-0, והסירו את סימני המינוס (זה החלק של &lt;span&gt;\( 1- \)&lt;/span&gt; השורש)&lt;/li&gt;


&lt;li&gt;הזיזו את הסדרה צעד אחד שמאלה כך שה-0 בהתחלה נעלם (זה החלק של החלוקה ב-&lt;span&gt;\( x \)&lt;/span&gt;)&lt;/li&gt;


&lt;li&gt;חלקו את אברי כל הסדרה ב-2 (זו החלוקה ב-2).&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;במילים אחרות - כן! הבינום המוכלל של ניוטון עובד ונותן לנו את מספרי קטלן! ככה &lt;strong&gt;בדיוק&lt;/strong&gt; אוילר גילה את הנוסחה הסגורה למספרי קטלן. לא על ידי תעלול קומבינטורי מרהיב כמו שהראיתי בפוסט הקודם, אלא על ידי “הא, מצאתי את הפונקציה היוצרת, עכשיו בוא ניקח את המתמטיקה הסטנדרטית שלנו ונפעיל אותה על הפונקציה כדי לקבל את סדרת המקדמים”.&lt;/p&gt;

&lt;p&gt;זה השלב שבו כולם מרוצים… חוץ ממני. כל הקטע הזה של הבינום המוכלל של ניוטון? זו התעסקות בטורי חזקות של חדו”א, לא בטורי חזקות פורמליים. זה לא אומר שזה לא תקין - אפשר בהחלט לומר שזו תוצאה שתקפה רק בתחום ההתכנסות של הטור, אבל זה מספיק כדי לקבל את סדרת המקדמים - אבל אני רוצה לראות כמה רחוק אפשר ללכת כשדבקים &lt;strong&gt;רק&lt;/strong&gt; בפורמליות, בלי חדו”א בכלל. עכשיו יש לנו מטרה הרבה יותר ברורה: אנחנו לא רוצים להבין “סתם” איך להתעסק במספרי קטלן פורמלית, אלא איך אפשר להוכיח את &lt;strong&gt;הבינום המוכלל של ניוטון&lt;/strong&gt; פורמלית.&lt;/p&gt;

&lt;h2&gt;הבינום הפורמלי המוכלל של ניוטון&lt;/h2&gt;

&lt;p&gt;נשמור על העניין פשוט ונסתכל על הבינום של ניוטון כשאחד המחוברים הוא 1. כלומר, על הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שיש לנו באגף ימין כאן הוא פונקציה יוצרת - הפונקציה היוצרת של הסדרה &lt;span&gt;\( a_{n}={r \choose n} \)&lt;/span&gt;. באגף שמאל יש לנו ביטוי שאין לו משמעות פורמלית - לא הגדרנו בשום שלב העלאה בחזקה כללית של פולינומים, או של טורי חזקות. אז אני יכול &lt;strong&gt;להגדיר&lt;/strong&gt; את המשמעות של אגף שמאל להיות מה שכתוב באגף ימין; השאלה המעניינת היא האם ההגדרה הזו תסכים עם מה שאנחנו מצפים שיהיה, כלומר אם עבור &lt;span&gt;\( r \)&lt;/span&gt; שהוא &lt;strong&gt;מספר טבעי&lt;/strong&gt; ההגדרה תתלכד עם ההגדרה הרגילה, ואם יישמרו חוקי החשבון הרגילים של חזקות, שהם מה שעומד מאחורי הרחבת הגדרת החזקה מטבעיים למספרים ממשיים באופן כללי. כלומר, האם יתקיים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{r}\cdot\left(1+x\right)^{s}=\left(1+x\right)^{r+s} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ו-&lt;span&gt;\( \left(\left(1+x\right)^{r}\right)^{s}=\left(1+x\right)^{rs} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אבל כבר כאן צצה בעיה: הביטוי &lt;span&gt;\( \left(\left(1+x\right)^{r}\right)^{s} \)&lt;/span&gt; הוא לא מוגדר היטב, כי הרי &lt;span&gt;\( \left(1+x\right)^{r} \)&lt;/span&gt; הוא כבר פונקציה יוצרת עם אינסוף מחוברים, ולא הגדרתי העלאה בחזקה &lt;strong&gt;שלה&lt;/strong&gt;, רק של הביטוי הפשוט &lt;span&gt;\( 1+x \)&lt;/span&gt;. אז אני צריך מראש ללכת על הגדרה כללית יותר. מה בדבר…&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+F\left(x\right)\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}F\left(x\right)^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; היא פונקציה יוצרת כלשהי? ובכן, זה &lt;strong&gt;כמעט&lt;/strong&gt; עובד, אבל בואו ננצל את ההזדמנות כדי להציג גם את הדבר הזה בהקשר טיפה יותר כללי: &lt;strong&gt;הרכבה&lt;/strong&gt; של פונקציות יוצרות.&lt;/p&gt;

&lt;p&gt;אז נניח שיש לנו שתי פונקציות יוצרות&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b\left(x\right)=\sum_{n=0}^{\infty}b_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואנחנו רוצים להגדיר את ההרכבה, &lt;span&gt;\( a\left(b\left(x\right)\right) \)&lt;/span&gt;. אם הפונקציות היוצרות היו פונקציות אמיתיות ולא סתם חבלי כביסה, מה שהיה מתקיים (כשרדיוס ההתכנסות היה מתיר את זה) הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(b\left(x\right)\right)=\sum_{n=0}^{\infty}a_{n}b\left(x\right)^{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הדבר הזה הוא לא ביטוי מפורש. כלומר, זה לא שבהרכבה, המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; יהיה &lt;span&gt;\( a_{n}b\left(x\right)^{n} \)&lt;/span&gt;. מה שקורה הוא שצריך לקחת את הטור האינסופי &lt;span&gt;\( b\left(x\right) \)&lt;/span&gt;, לכפול אותו בעצמו &lt;span&gt;\( n \)&lt;/span&gt; פעמים (את זה אנחנו יודעים לעשות), לכפול את התוצאה במקדם המספרי &lt;span&gt;\( a_{n} \)&lt;/span&gt; ואז להוסיף את זה לטור הכולל שאנחנו בונים. בצורה הזו לאותו &lt;span&gt;\( x^{n} \)&lt;/span&gt; יכולות לתרום חזקות רבות ושונות מהצורה &lt;span&gt;\( b\left(x\right)^{k} \)&lt;/span&gt;. למעשה, קיימת הסכנה שלאותו &lt;span&gt;\( x^{n} \)&lt;/span&gt; יהיו &lt;strong&gt;אינסוף&lt;/strong&gt; חזקות שתורמות מחוברים. זה קורה אם ורק אם &lt;span&gt;\( b_{n}\ne0 \)&lt;/span&gt;. כי למשל, בואו נסתכל על המקרה הפשוט שבו &lt;span&gt;\( b\left(x\right)=1+x \)&lt;/span&gt;, אז מהן החזקות?&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{0}=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{1}=1+x \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{2}=1+2x+x^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{3}=1+3x+3x^{2}+x^{3} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכן הלאה - אנחנו רואים שכל חזקה החל מ-2 תתרום ל-&lt;span&gt;\( x^{1} \)&lt;/span&gt;, למשל. למה? כי מה זה בעצם &lt;span&gt;\( \left(1+x\right)^{3} \)&lt;/span&gt;? זו המכפלה &lt;span&gt;\( \left(1+x\right)\left(1+x\right)\left(1+x\right) \)&lt;/span&gt;. בכל פעם אנחנו בוחרים אחד משני האיברים שבתוך זוג סוגריים ספציפי ומוסיפים אותו למכפלה שלנו. אם בכל פעם היינו חייבים לבחור איבר שהוא לפחות &lt;span&gt;\( x \)&lt;/span&gt;, אז כל זוג סוגריים שמשתתף במכפלה היה מגדיל ב-1 לפחות את החזקה של &lt;span&gt;\( x \)&lt;/span&gt; בתוצאה הסופית. אבל אם 1 נמצא בסוגריים, אז אפשר לבחור אותו ולא להגדיל את החזקה של &lt;span&gt;\( x \)&lt;/span&gt; בתוצאה הסופית. זה היה מבטיח שעבור חזקות מסוימות של &lt;span&gt;\( x \)&lt;/span&gt;, אפשר יהיה תמיד לייצר אותן החל ממקום מסוים - לכן המקדם שלהם יהיה אינסופי, וזה לא מוגדר היטב.&lt;/p&gt;

&lt;p&gt;אפשר לחזור עכשיו אל ההעלאה בחזקה. במקרה הזה, יש לנו את הפונקציה היוצרת&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\left(1+x\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, &lt;span&gt;\( a_{n}={r \choose n} \)&lt;/span&gt;, אז אני יכול להציב בה את &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; לכל &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; שמקיים &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt;. למשל, עבור &lt;span&gt;\( \sqrt{1-4x} \)&lt;/span&gt; הצבתי את &lt;span&gt;\( F\left(x\right)=-4x \)&lt;/span&gt;, שבהחלט מקיימת את זה. ומה עם תכונות החזקה שאנחנו רוצים להוכיח?&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+F\left(x\right)\right)^{r}\cdot\left(1+F\left(x\right)\right)^{s}=\left(1+F\left(x\right)\right)^{r+s} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ו-&lt;span&gt;\( \left(\left(1+F\left(x\right)\right)^{r}\right)^{s}=\left(1+F\left(x\right)\right)^{rs} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כדי שזה יהיה מוגדר היטב, &lt;span&gt;\( \left(1+F\left(x\right)\right)^{r} \)&lt;/span&gt; צריך להיות מהצורה &lt;span&gt;\( 1+G\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( G_{0}=0 \)&lt;/span&gt;. את זה אפשר לראות ממש מההגדרה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+F\left(x\right)\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}F\left(x\right)^{n}=1+\sum_{n=1}^{\infty}{r \choose n}F\left(x\right)^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו נגדיר &lt;span&gt;\( G\left(x\right)=\sum_{n=1}^{\infty}{r \choose n}F\left(x\right)^{n} \)&lt;/span&gt; ונשתמש בכך ש-&lt;span&gt;\( F_{0}=0 \)&lt;/span&gt; בעצמו ולכן כל העלאה בחזקה של &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; כוללת רק חזקות של &lt;span&gt;\( x \)&lt;/span&gt; החל מ-&lt;span&gt;\( x^{1} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו אפשר לעבור לעבודה הטכנית עצמה של להוכיח ש-&lt;span&gt;\( \left(1+x\right)^{r}\cdot\left(1+x\right)^{s}=\left(1+x\right)^{r+s}=\sum_{n=0}^{\infty}{r+s \choose n}x^{n} \)&lt;/span&gt;. יש לנו כאן כפל של שני טורי חזקות, ואנחנו יודעים בדיוק איך זה עובד. נגדיר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}{r \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b\left(x\right)=\sum_{n=0}^{\infty}{s \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{n}={r \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{n}={s \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכעת&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)b\left(x\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k}=\sum_{k=0}^{n}{r \choose k}{s \choose n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שאנחנו &lt;strong&gt;מצפים&lt;/strong&gt; לקבל הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=0}^{n}{r \choose k}{s \choose n-k}={r+s \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם יש לנו את זה - סיימנו את ההוכחה. למרבה המזל, זה שוויון מפורסם מאוד, שאפילו יש לו שם משלו: שוויון צ’ו-ונדרמונדה. עוד יותר למרבה המזל, זה שוויון שקל מאוד להוכיח &lt;strong&gt;קומבינטורית&lt;/strong&gt;, כלומר יש לנו אחלה אינטואיציה למה הוא נכון… אבל רק אם &lt;span&gt;\( s,r \)&lt;/span&gt; הם מספרים טבעיים. במקרה הזה, אפשר לחשוב על כך שיש לנו קבוצה של &lt;span&gt;\( r \)&lt;/span&gt; חתולים ו-&lt;span&gt;\( s \)&lt;/span&gt; כלבים ואנחנו רוצים להרכיב צוות מרגלים שכולל בדיוק &lt;span&gt;\( n \)&lt;/span&gt; חברים - זו בעיה של &lt;strong&gt;בחירה בלי חשיבות לסדר ובלי חזרות&lt;/strong&gt;, ומכיוון שקבוצת המרגלים הפוטנציאליים הכוללת היא מגודל &lt;span&gt;\( r+s \)&lt;/span&gt; יש לנו בסך הכל &lt;span&gt;\( {r+s \choose n} \)&lt;/span&gt; אפשרויות. אבל היה אפשר גם לסרבל את זה טיפה: אם היינו מחליטים לקחת לקבוצה שלנו &lt;strong&gt;בדיוק&lt;/strong&gt; &lt;span&gt;\( k \)&lt;/span&gt; חתולים, אז היו לנו &lt;span&gt;\( {r \choose k} \)&lt;/span&gt; אפשרויות לבחור את החתולים, ואחר כך היינו צריכים לבחור עוד &lt;span&gt;\( n-k \)&lt;/span&gt; כלבים, ולזה יש &lt;span&gt;\( {s \choose n-k} \)&lt;/span&gt; אפשרויות, ולכן מעקרון הכפל יש לנו &lt;span&gt;\( {r \choose k}{s \choose n-k} \)&lt;/span&gt; אפשרויות להרכיב צוות שכולל בדיוק &lt;span&gt;\( k \)&lt;/span&gt; חתולים. את הסיפור הזה יכלנו לעשות לכל &lt;span&gt;\( k \)&lt;/span&gt; בין 0 ל-&lt;span&gt;\( n \)&lt;/span&gt;, ועקרון החיבור אומר שמספר האפשרויות הכולל, אם כך, הוא &lt;span&gt;\( \sum_{k=0}^{n}{r \choose k}{s \choose n-k} \)&lt;/span&gt;. זה מסיים את ההוכחה הקומבינטורית.&lt;/p&gt;

&lt;p&gt;השאלה היא מה עושים עכשיו, כשרוצים להוכיח את השוויון ל-&lt;span&gt;\( r,s \)&lt;/span&gt; שהם מספרים ממשיים כלליים. לא ברור איך הגיון קומבינטורי יעזור לנו כאן, אבל למרבה המזל גם לא צריך אותו - אפשר להסתמך על מה שכבר הוכחנו. בשביל זה בואו נדבר לרגע על &lt;strong&gt;פולינומים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;נניח ש-&lt;span&gt;\( p\left(x\right),q\left(x\right) \)&lt;/span&gt; הם שני פולינומים. אנחנו יודעים שפולינום ממעלה &lt;span&gt;\( d \)&lt;/span&gt; נקבע בצורה יחידה על ידי הערכים שלו ב-&lt;span&gt;\( d+1 \)&lt;/span&gt; נקודות, ולכן פולינום ממעלה &lt;span&gt;\( d \)&lt;/span&gt; שמתאפס ב-&lt;span&gt;\( d+1 \)&lt;/span&gt; נקודות הוא זהותית פולינום האפס. עכשיו, אם אנחנו יודעים ש-&lt;span&gt;\( p\left(n\right)=q\left(n\right) \)&lt;/span&gt; &lt;strong&gt;לכל&lt;/strong&gt; &lt;span&gt;\( n\in\mathbb{N} \)&lt;/span&gt;, אז אנחנו יודעים שהפולינום &lt;span&gt;\( p-q \)&lt;/span&gt; מתאפס על &lt;strong&gt;אינסוף&lt;/strong&gt; נקודות, ובפרט על מספר נקודות שגדול מהדרגה שלו, ולכן הוא זהותית אפס: &lt;span&gt;\( p-q=0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( p=q \)&lt;/span&gt; - &lt;strong&gt;פולינומים שמזדהים על אינסוף נקודות הם זהים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו בואו נסבך את זה ונהפוך את הפולינומים לבעלי שני משתנים: &lt;span&gt;\( p\left(x,y\right),q\left(x,y\right) \)&lt;/span&gt;. כאן צריך להיזהר: אם למשל &lt;span&gt;\( p\left(x,y\right)=x \)&lt;/span&gt; ו-&lt;span&gt;\( q\left(x,y\right)=y \)&lt;/span&gt; אז נקבל ש-&lt;span&gt;\( p\left(n,n\right)=q\left(n,n\right) \)&lt;/span&gt; עבור אינסוף ערכי &lt;span&gt;\( n\in\mathbb{N} \)&lt;/span&gt; אבל זה כמובן לא אומר שהפולינומים הללו זהים. הטיעון צריך להיות קצת יותר עדין. באופן כללי, אם יש שתי קבוצות אינסופיות &lt;span&gt;\( A,B \)&lt;/span&gt; כך ש-&lt;span&gt;\( p\left(a,b\right)=0 \)&lt;/span&gt; לכל &lt;span&gt;\( a\in A,b\in B \)&lt;/span&gt;, אז &lt;span&gt;\( p \)&lt;/span&gt; הוא פולינום האפס (כלומר, הפואנטה היא ש-&lt;span&gt;\( p \)&lt;/span&gt; מתאפס על כל &lt;span&gt;\( A\times B \)&lt;/span&gt;, לא רק על איזו תת-קבוצה נחמדה של &lt;span&gt;\( A\times B \)&lt;/span&gt;). בואו נוכיח את זה: באופן כללי, &lt;span&gt;\( p\left(x,y\right)=\sum_{i,j}a_{ij}x^{i}y^{j} \)&lt;/span&gt;. אפשר לסדר את הסכום הזה לפי חזקות של &lt;span&gt;\( y \)&lt;/span&gt;, כלומר לכתוב &lt;span&gt;\( p\left(x,y\right)=\sum_{j}\left(\sum_{i}a_{ij}x^{i}\right)y^{j} \)&lt;/span&gt;, ולסמן &lt;span&gt;\( p_{j}\left(x\right)=\sum_{i}a_{ij}x^{i} \)&lt;/span&gt;. עכשיו, אם כל ה-&lt;span&gt;\( p_{j}\left(x\right) \)&lt;/span&gt; הללו הם פולינומי האפס, סיימנו; מקבלים ש-&lt;span&gt;\( p\left(x,y\right)=\sum_{j}p_{j}\left(x\right)y^{j}=\sum_{j}0\cdot y=0 \)&lt;/span&gt;. אז בואו נניח בשלילה שעבור &lt;span&gt;\( j \)&lt;/span&gt; כלשהו, &lt;span&gt;\( p_{j}\left(x\right) \)&lt;/span&gt; הוא &lt;strong&gt;לא&lt;/strong&gt; פולינום האפס. בפרט, קיים ערך קונקרטי, &lt;span&gt;\( a\in A \)&lt;/span&gt;, כך ש-&lt;span&gt;\( p_{j}\left(a\right)\ne0 \)&lt;/span&gt; - כי אם לכל &lt;span&gt;\( a\in A \)&lt;/span&gt; היינו מקבלים &lt;span&gt;\( p_{j}\left(x\right)=0 \)&lt;/span&gt; אז היינו מקבלים פולינום שמתאפס על אינסוף ערכים ולכן הוא זהותית 0. אם כן, &lt;span&gt;\( p_{j}\left(a\right)\ne0 \)&lt;/span&gt; ולכן אם נסתכל על הפולינום &lt;span&gt;\( q\left(y\right)=p\left(a,y\right) \)&lt;/span&gt; אנחנו רואים שמצד אחד, &lt;span&gt;\( q\left(y\right)=\sum_{j}p_{j}\left(a\right)y^{j} \)&lt;/span&gt; הוא לא פולינום האפס כי &lt;strong&gt;לכל הפחות&lt;/strong&gt; המקדם של &lt;span&gt;\( y^{j} \)&lt;/span&gt; הוא לא אפס. מצד שני - אנחנו יודעים שלכל אינסוף הערכים &lt;span&gt;\( b\in B \)&lt;/span&gt; מתקיים &lt;span&gt;\( q\left(b\right)=p\left(a,b\right)=0 \)&lt;/span&gt; ולכן זה כן פולינום האפס - סתירה. לב העניין הוא בדיוק בשלב האחרון: ש&lt;strong&gt;לכל&lt;/strong&gt; &lt;span&gt;\( b\in B \)&lt;/span&gt; מקבלים &lt;span&gt;\( p\left(a,b\right)=0 \)&lt;/span&gt;, באופן שלא תלוי בזהות של &lt;span&gt;\( a \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;המסקנה מכל זה היא שאם יש לנו זוג פולינומים בשני משתנים &lt;span&gt;\( p\left(x,y\right),q\left(x,y\right) \)&lt;/span&gt; כך ש&lt;strong&gt;לכל זוג מספרים טבעיים&lt;/strong&gt; &lt;span&gt;\( r,s \)&lt;/span&gt; מתקיים &lt;span&gt;\( p\left(r,s\right)=q\left(r,s\right) \)&lt;/span&gt; אז הפולינום הם זהים, לכל זוג ערכים, כולל ערכים ממשיים (או אפילו מרוכבים). עכשיו נסתכל על הביטוי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=0}^{n}{r \choose k}{s \choose n-k}={r+s \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לב העניין הוא שבאופן כללי, &lt;span&gt;\( {x \choose n}=\frac{x\left(x-1\right)\left(x-2\right)\ldots\left(x-n+1\right)}{n!} \)&lt;/span&gt; הוא פולינום ב-&lt;span&gt;\( x \)&lt;/span&gt;: המונה הוא הרי מכפלה של &lt;span&gt;\( n \)&lt;/span&gt; פולינומים ב-&lt;span&gt;\( x \)&lt;/span&gt;, אז גם הוא פולינום. לכן גם &lt;span&gt;\( \sum_{k=0}^{n}{x \choose k}{y \choose n-k}={x+y \choose n} \)&lt;/span&gt; הוא שוויון של פולינומים - ושוויון שמתקיים לכל הצבה של &lt;span&gt;\( r,s \)&lt;/span&gt; טבעיים ב-&lt;span&gt;\( x,y \)&lt;/span&gt;. זה מוכיח את השוויון לכל &lt;span&gt;\( r,s \)&lt;/span&gt; ממשיים, ולכן מסיים את ההוכחה &lt;strong&gt;הפורמלית&lt;/strong&gt; לכך ש-&lt;span&gt;\( \left(1+x\right)^{r}\cdot\left(1+x\right)^{s}=\left(1+x\right)^{r+s} \)&lt;/span&gt;, וכמסקנה אנחנו מקבלים ש-&lt;span&gt;\( \left(1+F\left(x\right)\right)^{r}\cdot\left(1+F\left(x\right)\right)^{s}=\left(1+F\left(x\right)\right)^{r+s} \)&lt;/span&gt; לכל &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; עם &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;זה מקדם אותנו בצורה משמעותית לתפיסה האינטואיטיבית של &lt;span&gt;\( \left(1+x\right)^{r} \)&lt;/span&gt; בתור פעולת החזקה. כדי לראות את זה, בואו נוותר לרגע על שיטת הסימון שבה אנחנו משתמשים ובמקום זה נכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),r\right)=\sum_{n=0}^{\infty}{r \choose n}F\left(x\right)^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, בינתיים פשוט הגדרנו דרך לבנות פונקציה יוצרת חדשה מתוך &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt;. מה לזה ולפעולת ההעלאה בחזקה? ובכן, ראשית נשים לב לכך שעל פי הגדרה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),1\right)=\sum_{n=0}^{\infty}{1 \choose n}F\left(x\right)^{n}=F\left(x\right)^{0}+F\left(x\right)^{1}=1+F\left(x\right)=\left(1+F\left(x\right)\right)^{1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, &lt;span&gt;\( \Phi\left(1+F\left(x\right),1\right) \)&lt;/span&gt; מתלכד עם מה שאנחנו מכירים בתור &lt;span&gt;\( \left(1+F\left(x\right)\right)^{1} \)&lt;/span&gt;. שימו לב שאת הביטוי &lt;span&gt;\( \left(1+F\left(x\right)\right)^{1} \)&lt;/span&gt; אנחנו מכירים לא בתור “פונקציה יוצרת שהוגדרה מוזר” אלא זו חזקה במשמעות הרגילה שלה בחוגים - כפל של האיבר בעצמו שוב ושוב (פעם אחת, במקרה הזה).&lt;/p&gt;

&lt;p&gt;טוב ויפה, אבל כזכור עבדנו קשה כדי להוכיח את התכונה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),r+s\right)=\Phi\left(1+F\left(x\right),r\right)\Phi\left(1+F\left(x\right),s\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן עכשיו אפשר להראות באינדוקציה שלכל &lt;span&gt;\( n \)&lt;/span&gt; טבעי,&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),n+1\right)=\Phi\left(1+F\left(x\right),n\right)\Phi\left(1+F\left(x\right),1\right)= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\left(1+F\left(x\right)\right)^{n}\left(1+F\left(x\right)\right)^{1}=\left(1+F\left(x\right)\right)^{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר גם כאן - החזקה היא במשמעות המקורית והרגילה שלה בחוג, אז הפונקציה &lt;span&gt;\( \Phi \)&lt;/span&gt; &lt;strong&gt;מתלכדת&lt;/strong&gt; עם המשמעות הרגילה בחוג. כדי להשתכנע שהיא מרחיבה אותה בצורה נכונה, בואו נסתכל למשל על&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),1\right)=\Phi\left(1+F\left(x\right),\frac{1}{2}+\frac{1}{2}\right)=\Phi\left(1+F\left(x\right),\frac{1}{2}\right)^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, &lt;span&gt;\( G\left(x\right)=\Phi\left(1+F\left(x\right),\frac{1}{2}\right) \)&lt;/span&gt; הוא מצד אחד טור חזקות פורמלי מוגדר היטב, שלא נזקקנו לחשבון דיפרנציאלי כדי להגדיר; ומצד שני הוא מקיים &lt;span&gt;\( G\left(x\right)^{2}=1+F\left(x\right) \)&lt;/span&gt; וכמו כן קל לראות ש-&lt;span&gt;\( G_{0}=1 \)&lt;/span&gt; ולכן, בסימון שלנו בתחילת הפוסט, &lt;span&gt;\( G\left(x\right)=\sqrt{1+F\left(x\right)} \)&lt;/span&gt;, וזה תואם את המשמעות האינטואיטיבית שיש לנו למה העלאה בחזקת &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; אמורה להיות.&lt;/p&gt;

&lt;p&gt;זה עובד גם עבור אפס ועבור מספרים שליליים. אפשר לבדוק ישירות על פי ההגדרה ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),0\right)=\sum_{n=0}^{\infty}{0 \choose n}F\left(x\right)^{n}=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שמתאים להעלאה “רגילה” בחזקת 0, ועכשיו עבור שליליים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1=\Phi\left(1+F\left(x\right),0\right)=\Phi\left(1+F\left(x\right),n-n\right)= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\Phi\left(1+F\left(x\right),n\right)\Phi\left(1+F\left(x\right),-n\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר קיבלנו ש-&lt;span&gt;\( \Phi\left(1+F\left(x\right),-n\right)=\frac{1}{\Phi\left(1+F\left(x\right),n\right)} \)&lt;/span&gt;. הצעד האחרון דורש כזכור שהאיבר החופשי של &lt;span&gt;\( \Phi\left(1+F\left(x\right),n\right) \)&lt;/span&gt; לא יהיה 0, ואנחנו כבר יודעים שהוא 1, אז הכל בסדר.&lt;/p&gt;

&lt;p&gt;זה נחמד כי זה מחזיר אותנו לתחילת הפוסט, שבו הוכחנו בדרך די ישירה ש-&lt;span&gt;\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)&lt;/span&gt;. עכשיו זה אמור לנבוע מההגדרה הכללית יותר שלנו. נסמן &lt;span&gt;\( F\left(x\right)=x+x^{2}+\ldots \)&lt;/span&gt; ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),-1\right)=\sum_{n=0}^{\infty}{-1 \choose n}F\left(x\right)^{n}=\frac{1}{0!}F\left(x\right)^{0}+\frac{\left(-1\right)}{1!}F\left(x\right)^{1}+\frac{\left(-1\right)\left(-2\right)}{2!}F\left(x\right)^{2}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;באופן כללי, האיבר ה-&lt;span&gt;\( n \)&lt;/span&gt;-י בסכום יהיה &lt;span&gt;\( \frac{\left(-1\right)\left(-2\right)\cdots\left(-n\right)}{n!}=\frac{\left(-1\right)^{n}n!}{n!}=\left(-1\right)^{n} \)&lt;/span&gt;, כלומר אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1-F\left(x\right)+F\left(x\right)^{2}-F\left(x\right)^{3}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בכמה דרכים &lt;span&gt;\( x^{n} \)&lt;/span&gt;, עבור &lt;span&gt;\( n\ge2 \)&lt;/span&gt;, יכול להתקבל כאן? אם נסתכל על &lt;span&gt;\( F\left(x\right)^{k} \)&lt;/span&gt;, הוא כולל &lt;span&gt;\( k \)&lt;/span&gt; זוגות סוגריים שמכל אחד מהם בוחרים חזקה של &lt;span&gt;\( x \)&lt;/span&gt; כך שהחזקות מסתכמות אל &lt;span&gt;\( n \)&lt;/span&gt; - זה כמו לספור כמה פתרונות יש למשוואה &lt;span&gt;\( a_{1}+\ldots+a_{k}=n \)&lt;/span&gt;. מה שכן, שימו לב שהסוגריים לא כוללים את &lt;span&gt;\( x^{0} \)&lt;/span&gt; אז הפתרונות הם &lt;strong&gt;בטבעיים חיוביים&lt;/strong&gt;. זו בעיה קלה, קומבינטורית: זה כמו לשאול כמה פתרונות בשלמים אי-שליליים יש ל-&lt;span&gt;\( a_{1}+\ldots+a_{k}=n-k \)&lt;/span&gt; וזו בדיוק בחירה בלי חשיבות לסדר ועם חזרות של &lt;span&gt;\( n-k \)&lt;/span&gt; פעמים מתוך &lt;span&gt;\( k \)&lt;/span&gt; איברים - הפתרון הוא &lt;span&gt;\( {\left(n-k\right)+k-1 \choose k-1}={n-1 \choose k-1} \)&lt;/span&gt;. עכשיו, זה נתן לנו את המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; באיבר &lt;span&gt;\( F\left(x\right)^{k} \)&lt;/span&gt;, אבל כדי לקבל את המקדם הכולל של &lt;span&gt;\( x^{n} \)&lt;/span&gt; צריך לחבר את המקדמים שמקבלים לכל &lt;span&gt;\( k \)&lt;/span&gt; וגם לקחת בחשבון את סימן המינוס שיש על איברים שבהם &lt;span&gt;\( k \)&lt;/span&gt; אי זוגי. כלומר נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=1}^{n}\left(-1\right)^{k}{n-1 \choose k-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במקרה הזה קל לטפל בעזרת &lt;strong&gt;הבינום של ניוטון&lt;/strong&gt;. נשנה את משתנה הסכימה באותה דרך שבה עשינו את זה קודם עבור פיבונאצ’י:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=1}^{n}\left(-1\right)^{k}{n-1 \choose k-1}=-\sum_{k=0}^{n-1}\left(-1\right)^{k}{n-1 \choose k}=-\left(1-1\right)^{n-1}=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המקרים החריגים היחידים הם &lt;span&gt;\( n=0,1 \)&lt;/span&gt;. עבור &lt;span&gt;\( n=0 \)&lt;/span&gt; בכלל אי אפשר להשתמש בנוסחה הזו, אבל אם חושבים רגע רואים שהיא אמורה לתת 0 כאן - וזה נכון, כי &lt;span&gt;\( x^{0} \)&lt;/span&gt; בכלל לא מופיע ב-&lt;span&gt;\( -F\left(x\right)+F\left(x\right)^{2}-F\left(x\right)^{3}+\ldots \)&lt;/span&gt;, הוא מופיע רק ב-1 בהתחלה. כמו כן עבור &lt;span&gt;\( n=1 \)&lt;/span&gt; יש לנו סיטואציה חריגה של &lt;span&gt;\( 0^{0} \)&lt;/span&gt; וזו מהסיטואציות שבהן הדבר הנכון לעשות הוא להגדיר &lt;span&gt;\( 0^{0}=1 \)&lt;/span&gt; (&lt;a href=&quot;https://gadial.net/2018/01/01/zero_power_equals_one/&quot;&gt;יש לי פוסט על זה&lt;/a&gt;), ובואו לא נשכח את המינוס הזה שהשתרבב החוצה, כלומר מקבלים &lt;span&gt;\( -1 \)&lt;/span&gt; במקרה הזה, ולכן &lt;span&gt;\( 1-F\left(x\right)+F\left(x\right)^{2}-F\left(x\right)^{3}+\ldots=1-x \)&lt;/span&gt; וזה - הפלא ופלא, זה בדיוק מה שציפינו לקבל, כי אנחנו כבר יודעים ש-&lt;span&gt;\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)&lt;/span&gt; אז כמובן ש-&lt;span&gt;\( \left(1+x+x^{2}+\ldots\right)^{-1}=1-x \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אוקיי, אז אני מקווה שהשתכנענו שהצלחנו להגדיר את &lt;span&gt;\( \left(1+F\left(x\right)\right)^{r} \)&lt;/span&gt; לכל &lt;span&gt;\( r \)&lt;/span&gt; &lt;strong&gt;רציונלי&lt;/strong&gt;. איך נגדיר אותו לכל ממשי? ובכן, כאן אנחנו בבעיה וחייבים לדבר על מושגים מחדו”א פשוט כי &lt;strong&gt;מספר ממשי&lt;/strong&gt; הוא מושג מחדו”א. הייתה לי &lt;a href=&quot;https://gadial.net/2024/08/11/real_numbers_decimal_notation/&quot;&gt;סדרת פוסטים&lt;/a&gt; על זה לא מזמן. בגדול, דרך נוחה לחשוב על מספרים ממשיים הם בתור אובייקטים שלכל אחד מהם, אנחנו יכולים לקחת סדרת רציונליים ששואפת אליו. זה מוביל להגדרה “הרגילה” של חזקה שהיא מספר ממשי כללי: בהינתן &lt;span&gt;\( r \)&lt;/span&gt;, לוקחים סדרה &lt;span&gt;\( q_{n} \)&lt;/span&gt; של רציונליים כך ש-&lt;span&gt;\( q_{n}\to r \)&lt;/span&gt;, ואז מגדירים &lt;span&gt;\( x^{r}=\lim_{n\to\infty}x^{q_{n}} \)&lt;/span&gt; וצריך לשבור את הראש כדי להוכיח שזה מוגדר היטב. אבל איך אפשר לעשות משהו דומה עם טורי חזקות פורמליים? אין לנו מושג של התכנסות על טורי חזקות, נכון? נכון…?&lt;/p&gt;

&lt;h2&gt;החפירה העמוקה ביותר (שנגיע אליה כאן)&lt;/h2&gt;

&lt;p&gt;אז כן, יש לנו מושג של התכנסות על טורי חזקות, הוא לא מסובך במיוחד, והוא כנראה יאפשר את הראייה הצלולה ביותר של מה שעשינו כאן ולאן אפשר להתקדם מפה.&lt;/p&gt;

&lt;p&gt;בגדול, הרעיון הוא שאם יש לנו סדרה &lt;span&gt;\( F^{1}\left(x\right),F^{2}\left(x\right),F^{3}\left(x\right),\ldots \)&lt;/span&gt; ואנחנו רוצים לדעת אם היא מתכנסת לאנשהו, נסתכל על המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; עבור כל הסדרות הללו. אם &lt;strong&gt;החל ממקום מסוים&lt;/strong&gt; המקדם הזה קבוע, ואם זה קורה &lt;strong&gt;לכל&lt;/strong&gt; &lt;span&gt;\( n \)&lt;/span&gt;, אז לסדרה יש גבול שהוא הפונקציה היוצרת שבנויה מהמקדמים הללו. קצת יותר פורמלית: אם לכל &lt;span&gt;\( n \)&lt;/span&gt; קיימים &lt;span&gt;\( a_{n}\in\mathbb{R} \)&lt;/span&gt; ו-&lt;span&gt;\( k_{n} \)&lt;/span&gt; כך שלכל &lt;span&gt;\( i\ge k_{N} \)&lt;/span&gt; מתקיים ש-&lt;span&gt;\( F_{n}^{i}=a_{n} \)&lt;/span&gt; (כאן &lt;span&gt;\( F_{n}^{i} \)&lt;/span&gt; פירושו המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; בטור החזקות &lt;span&gt;\( F^{i}\left(x\right) \)&lt;/span&gt;) אז &lt;span&gt;\( \lim_{i\to\infty}F^{i}\left(x\right)=F\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( F\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אבל אפשר לעשות את זה עוד יותר מסודר. מי שמכירות את הבניה האנליטית של המספרים ה-&lt;span&gt;\( p \)&lt;/span&gt;-אדיים (&lt;a href=&quot;https://gadial.net/2010/01/12/padic_numbers_analytic_constructions/&quot;&gt;הצגתי אותה כאן&lt;/a&gt;) כנראה ירגישו בבית.&lt;/p&gt;

&lt;p&gt;ראשית, לכל טור חזקות פורמלי &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; ששונה מאפס, נגדיר &lt;span&gt;\( \nu\left(F\left(x\right)\right)=\min_{F_{n}\ne0}n \)&lt;/span&gt;, כלומר האינדקס של המקדם הראשון בטור ששונה מאפס. בנוסף נגדיר &lt;span&gt;\( \nu\left(0\right)=\infty \)&lt;/span&gt; כדי שהכל יסתדר יפה. עכשיו אפשר להגדיר &lt;strong&gt;מטריקה&lt;/strong&gt; על חוג טורי החזקות הפורמליים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( d\left(F,G\right)=2^{-\nu\left(F-G\right)} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, ככל שהאינדקס הראשון שבו &lt;span&gt;\( F,G \)&lt;/span&gt; נבדלים זה מזה הוא גבוה יותר, כך ה”מרחק” שלהם יהיה קטן יותר. אם הם נבדלים כבר באינדקס ה-0 המרחק שלהם יהיה 1, ואם הם נבדלים לראשונה באינדקס ה-3 אז המרחק שלהם יהיה &lt;span&gt;\( \frac{1}{8} \)&lt;/span&gt; וכן הלאה.&lt;/p&gt;

&lt;p&gt;מה שקורה כאן הוא שראשית כל, אם &lt;span&gt;\( F=G \)&lt;/span&gt; אז &lt;span&gt;\( F-G=0 \)&lt;/span&gt; ולכן &lt;span&gt;\( d\left(F,G\right)=2^{-\nu\left(F-G\right)}=2^{-\nu\left(0\right)}=2^{-\infty}=0 \)&lt;/span&gt; (מי שמפריע לו השימוש הזה באינסוף - אוקיי, בסדר, פשוט נגדיר &lt;span&gt;\( d\left(F,G\right)=0 \)&lt;/span&gt; כאשר &lt;span&gt;\( F=G \)&lt;/span&gt; וחסל, מרוצים?).&lt;/p&gt;

&lt;p&gt;שנית, &lt;span&gt;\( d\left(F,G\right)=2^{-\nu\left(F-G\right)}=2^{-\nu\left(G-F\right)}=d\left(G,F\right) \)&lt;/span&gt;; זה עובד כי המקדם הראשון ששונה מאפס ב-&lt;span&gt;\( F-G \)&lt;/span&gt; הוא אותו מקדם כמו ב-&lt;span&gt;\( G-F \)&lt;/span&gt;, פשוט עם סימן הפוך.&lt;/p&gt;

&lt;p&gt;לבסוף, אם &lt;span&gt;\( F,G,H \)&lt;/span&gt; הם שלושה טורים, אז ראשית בואו נסמן ב-&lt;span&gt;\( n \)&lt;/span&gt; את האינדקס הראשון שבו &lt;span&gt;\( F,H \)&lt;/span&gt; נבדלים (אם הם זהים התוצאה שאגיע אליה עוד מעט נובעת עוד יותר בקלות), כלומר &lt;span&gt;\( d\left(F,H\right)=2^{-n} \)&lt;/span&gt;. בואו נסמן ב-&lt;span&gt;\( m_{1} \)&lt;/span&gt; את האינדקס הראשון שבו &lt;span&gt;\( F,G \)&lt;/span&gt; נבדלים וב-&lt;span&gt;\( m_{2} \)&lt;/span&gt; את האינדקס הראשון שבו &lt;span&gt;\( G,H \)&lt;/span&gt; נבדלים (ייתכן ש-&lt;span&gt;\( m_{1},m_{2}=\infty \)&lt;/span&gt;). אני טוען ש-&lt;span&gt;\( n\ge\min\left\{ m_{1},m_{2}\right\}  \)&lt;/span&gt;. למה? ובכן, אם &lt;span&gt;\( G \)&lt;/span&gt; נבדל מ-&lt;span&gt;\( F,H \)&lt;/span&gt; בשלב שבו הם עדיין זהים, זה אומר ש-&lt;span&gt;\( m_{1}=m_{2} \)&lt;/span&gt; (כי הוא ייבדל משניהם בו זמנית שהרי הם זהים עדיין בשלב הזה) ומכיוון שזה לפני שהם נבדלים, האינדקס הזה בא לפני &lt;span&gt;\( n \)&lt;/span&gt;, כלומר במקרה הזה &lt;span&gt;\( m_{1},m_{2}&amp;lt;n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, באינדקס ה-&lt;span&gt;\( n \)&lt;/span&gt; מתקיים &lt;span&gt;\( F_{n}\ne H_{n} \)&lt;/span&gt; ולכן &lt;strong&gt;פשוט לא ייתכן&lt;/strong&gt; ש-&lt;span&gt;\( G_{n}=F_{n} \)&lt;/span&gt; וגם &lt;span&gt;\( G_{n}=H_{n} \)&lt;/span&gt;, כי שוויון כזה היה מכריח את &lt;span&gt;\( F_{n}=H_{n} \)&lt;/span&gt;. לכן זה השלב שבו &lt;strong&gt;בודאות&lt;/strong&gt; &lt;span&gt;\( G \)&lt;/span&gt; הולך להיבדל מ-&lt;span&gt;\( F \)&lt;/span&gt; או מ-&lt;span&gt;\( H \)&lt;/span&gt;. אנחנו לא יודעים מי מהם, לכן אנחנו לוקחים את המינימום על &lt;span&gt;\( \left\{ m_{1},m_{2}\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה המסקנה? &lt;span&gt;\( n\ge\min\left\{ m_{1},m_{2}\right\}  \)&lt;/span&gt; גורר ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( d\left(F,H\right)=2^{-n}\le2^{-\min\left\{ m_{1},m_{2}\right\} }=\max\left\{ 2^{-m_{1}},2^{-m_{2}}\right\} =\max\left(d\left(F,G\right),d\left(G,H\right)\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה נותן לנו את &lt;strong&gt;אי שוויון המשולש&lt;/strong&gt;, בגרסה יותר חזקה מהרגיל אפילו: אם אני קטן מהמקסימום של שני מספרים אי שליליים, אני בוודאי קטן יותר מהסכום שלהם (שכולל את המקסימום ועוד איזה מספר)&lt;/p&gt;

&lt;p&gt;אז קיבלנו פונקציה &lt;span&gt;\( d \)&lt;/span&gt; כך ש-&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( d\left(F,G\right)\ge0 \)&lt;/span&gt; ויש שוויון אם ורק אם &lt;span&gt;\( F=G \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( d\left(F,G\right)=d\left(G,F\right) \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( d\left(F,H\right)\le d\left(F,G\right)+d\left(G,H\right) \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;שלוש התכונות הללו הופכות את &lt;span&gt;\( d \)&lt;/span&gt; למה שנקרא &lt;strong&gt;מטריקה&lt;/strong&gt;, שהיא פונקציה שמאפשרת לדבר באופן כללי על גבולות והתכנסות (למעשה, התכונה החזקה יותר של אי-שוויון המשולש נותנת משהו שנקרא &lt;strong&gt;אולטרמטריקה&lt;/strong&gt; אבל נעזוב את זה). עכשיו אפשר לומר משהו כזה: &lt;span&gt;\( \lim_{n\to\infty}F^{n}\left(x\right)=F\left(x\right) \)&lt;/span&gt; אם לכל &lt;span&gt;\( \varepsilon&amp;gt;0 \)&lt;/span&gt; קיים &lt;span&gt;\( N \)&lt;/span&gt; כך שאם &lt;span&gt;\( n&amp;gt;N \)&lt;/span&gt; אז &lt;span&gt;\( d\left(F^{n}\left(x\right),F\left(x\right)\right)&amp;lt;\varepsilon \)&lt;/span&gt;. זו ההגדרה הסטנדרטית לגבול, ואם חושבים עליה קצת בהקשר של ה-&lt;span&gt;\( d \)&lt;/span&gt; הספציפית שלנו רואים שהמשמעות של &lt;span&gt;\( \lim_{n\to\infty}F^{n}\left(x\right)=F\left(x\right) \)&lt;/span&gt; היא בדיוק מה שהזכרתי קודם: כדי שהסדרה &lt;span&gt;\( F^{n}\left(x\right) \)&lt;/span&gt; תתכנס לגבול, צריך שהמקדם של &lt;span&gt;\( x^{k} \)&lt;/span&gt; יתקבע החל ממקום מסוים בסדרה, ואז הוא יהיה המקדם של אותו איבר ב-&lt;span&gt;\( F\left(x\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להסתכל על ביטוי כמו &lt;span&gt;\( \sum_{n=0}^{\infty}F\left(x\right)^{n} \)&lt;/span&gt;. כבר היינו בסיטואציה דומה קודם, וראינו שכדי שחזקה של &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; תתנהג יפה, היה צריך שיתקיים &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt;, אז נניח שזה קורה. עכשיו אפשר לחשוב על &lt;span&gt;\( \sum_{n=0}^{\infty}F\left(x\right)^{n} \)&lt;/span&gt; פשוט כמו טור במובן הרגיל, כזה שמוגדר עם סכומים חלקיים &lt;span&gt;\( \sum_{n=0}^{\infty}F\left(x\right)^{n}=\lim_{n\to\infty}S_{n} \)&lt;/span&gt; כאשר &lt;span&gt;\( S_{n}=\sum_{k=0}^{n}F\left(x\right)^{k} \)&lt;/span&gt;. בכל פעם שבה מוסיפים חזקה חדשה &lt;span&gt;\( F\left(x\right)^{n} \)&lt;/span&gt; לסכום שיש לנו, היא משנה רק את המקדמים של &lt;span&gt;\( x^{n} \)&lt;/span&gt; וחזקות גבוהות יותר - כלומר, החזקות הנמוכות יותר &lt;strong&gt;התקבעו&lt;/strong&gt; ולכן הטור מתכנס.\textbackslash אפשר לעשות משהו אפילו עוד יותר משעשע כדי לחשב את הסכום שלו: הרי כדי לחשב את הסכום של &lt;span&gt;\( \sum_{n=0}^{\infty}q^{n} \)&lt;/span&gt; במספרים ממשיים אנחנו מסתכלים על הסכום החלקי ה-&lt;span&gt;\( n \)&lt;/span&gt;-י שיוצא &lt;span&gt;\( \frac{q^{n+1}-1}{q-1} \)&lt;/span&gt;, נוכל להסתכל על סכום דומה גם עבור &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt;. הרי איך מוכיחים את הנוסחה לסכום החלקי? מסתכלים על המכפלה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+F\left(x\right)+\ldots+F\left(x\right)^{n}\right)\left(F\left(x\right)-1\right)=F\left(x\right)^{n+1}-1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו זהות שאפשר להוכיח בכל חוג קומוטטיבי. עכשיו, אם &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt; אז המקדם החופשי של &lt;span&gt;\( F\left(x\right)-1 \)&lt;/span&gt; שונה מאפס ולכן הוא הפיך, ולכן אפשר לכפול בהופכי ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1+F\left(x\right)+\ldots+F\left(x\right)^{n}=\frac{F\left(x\right)^{n+1}-1}{F\left(x\right)-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו, מהו &lt;span&gt;\( \lim_{n\to\infty}\frac{F\left(x\right)^{n+1}-1}{F\left(x\right)-1} \)&lt;/span&gt;? המכנה נשאר קבוע, ובמונה יש לנו חזקה הולכת וגדלה &lt;span&gt;\( F\left(x\right)^{n+1} \)&lt;/span&gt;. בחזקה הזו, המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; וכל הקודמים לו הוא 0, ולכן… &lt;span&gt;\( \lim_{n\to\infty}F\left(x\right)^{n+1}=0 \)&lt;/span&gt; ומכאן נקבל &lt;span&gt;\( \lim_{n\to\infty}\frac{F\left(x\right)^{n+1}-1}{F\left(x\right)-1}=\frac{0-1}{F\left(x\right)-1}=\frac{1}{1-F\left(x\right)} \)&lt;/span&gt; והנה קיבלנו את התוצאה שממנה התחיל הפוסט - רק שעכשיו הוכחנו אותה &lt;strong&gt;באותה צורה בדיוק&lt;/strong&gt; שבה מוכיחים את הסכום ה”קלאסי”. אותה טרמינולוגיה, אותו עולם מושגים של התכנסות, אותה טכניקה - &lt;strong&gt;ובלי לערב רדיוסי התכנסות בכלל&lt;/strong&gt;. אין זכר למגבלה &lt;span&gt;\( \left|q\right|&amp;lt;1 \)&lt;/span&gt;, פשוט כי בחוג שלנו, עם המטריקה שלנו, העניינים הם למעשה &lt;strong&gt;פשוטים יותר&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו גם קצת יותר ברורה העניין הזה של להציב את &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; בתוך &lt;span&gt;\( G\left(x\right) \)&lt;/span&gt;. אנחנו מקבלים בסוף טור מהצורה &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}F^{n}\left(x\right) \)&lt;/span&gt;, וזה מתכנס אם &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt;. עכשיו אפשר לקחת את זה ולהשתמש בזה עבור טורים מוכרים. למשל, אם ניזכר איך נראה הפיתוח של פונקציית האקספוננט לטור חזקות: &lt;span&gt;\( e^{x}=\sum_{n=0}^{\infty}\frac{1}{n!}x^{n} \)&lt;/span&gt;, אז אפשר להגדיר &lt;span&gt;\( e^{F\left(x\right)}=\sum_{n=0}^{\infty}\frac{1}{n!}F^{n}\left(x\right) \)&lt;/span&gt;, ואפשר להגדיר &lt;span&gt;\( \ln\left(1+F\left(x\right)\right)=\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+1}}{n}F^{n}\left(x\right) \)&lt;/span&gt; ועוד ועוד. אז ביטוי כמו &lt;span&gt;\( \sqrt{1-4x} \)&lt;/span&gt; שמופיע בתוך פונקציה יוצרת? נראה לי שאנחנו כבר יודעים איך להסתדר איתו.&lt;/p&gt;</content><author><name></name></author><category term="מספרי קטלן" /><category term="פונקציות יוצרות" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מספרי קטלן</title><link href="http://gadial.net/2025/05/31/catalan_numbers/" rel="alternate" type="text/html" title="מספרי קטלן" /><published>2025-05-31T00:00:00+00:00</published><updated>2025-05-31T00:00:00+00:00</updated><id>http://gadial.net/2025/05/31/catalan_numbers</id><content type="html" xml:base="http://gadial.net/2025/05/31/catalan_numbers/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;אם אני אלך ברחוב ואשאל באקראי אנשים איזו סדרה מתמטית הם מכירים, אחרי שנקלף את שכבות האלו שיבהלו ויברחו או יתחכמו ויגידו ש-Numb3rs (אף אחד לא יגיד, העולם כבר שכח שהייתה סדרה כזו וגם לי לא יצא לראות אותה) כנראה אקבל שלל תשובות: “סדרת פיבונאצ’י”, “סדרת פיבונאצ’י!”, “פיבונאצ’י”, “הטבעיים” (חכמולוג, לסנן) ו”פיבונאצ’י”. ובכן, סדרת פיבונאצ’י כבודה במקומו מונח, יש עוד סדרות מעניינות בעולם ואני רוצה לדבר בפוסט הזה על אחת אהובה במיוחד - סדרת מספרי קטלן (Catalan, על שם המתמטיקאי הבלגי אז’ן שרל קטלן). זו הסדרה הבאה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1,1,2,5,14,42,132,429,1430,4862,\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שמעניין בה הוא שהיא הפתרון של שלל בעיות קומבינטורית שונות ומשונות. המתמטיקאי ריצ’רד סטנלי (שכתב את הספר הפנטסטי Enumerative Combinatorics) התמחה בלאסוף בעיות שונות ומשונות שמספרי קטלן הם הפתרון שלהן, ובסופו של דבר פרסם ספר עם 214 בעיות כאלו. מן הסתם אני לא אכסה כמעט כלום מזה הפעם; אבל אני רוצה בפוסט הזה שנכיר את התכונות הבסיסיות של המספרים הללו (שאנחנו מבינים די טוב) ונראה שלל בעיות שונות ומשונות ולכאורה לא קשורות שהם פותרים.&lt;/p&gt;

&lt;p&gt;היסטורית, האדם הראשון שיש לנו אינדיקציה שנתקל במספרי קטלן הוא המתמטיקאי המונגולי Minggatu, בספר על חישוב קירובים שכתב בסביבות 1730 שבו מספרי קטלן הופיעו בתוך חלק מהנוסחאות; זה פחות רלוונטי לנו כאן כי זה לא שימוש במספרי קטלן לפתרון בעיה קומבינטורית. מכאן אנחנו קופצים ל-1751, כשלאונרד אוילר (מהמתמטיקאים הפורים בהיסטוריה שנראה שהתעסק פשוט בכל דבר) תיאר אותם במכתב לשותפו המתמטי כריסטיאן גולדבך, בתור הפתרון של בעיה קומבינטורית ספציפית - אז בואו נתחיל מלדבר על הבעיה הזו למרות שהיא אולי לא הכי פשוטה מבין אלו שאפשר לפתוח בהן.&lt;/p&gt;

&lt;h2&gt;שילושים של מצולע&lt;/h2&gt;

&lt;p&gt;במקרה הזה תמונה אחת שווה אלף מילים, ואני מתנצל בפני מי שלא יכולים לראות אותה (ואת כל יתר האיורים שהפוסט הזה יהיה עמוס בהם):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulations.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה רואים פה? אני מצייר משושה משוכלל (כלומר מצולע עם שש צלעות שאורכי כל הצלעות שלו שווים וכל הזוויות שלו שוות) ובתוך המשושה אני מותח קווים בין חלק מהקודקודים, בצורה כזו שאין שני קווים שחוצים אחד את השני, ואני מותח מספיק קווים כדי לחלק את המצולע למשולשים. דבר כזה נקרא “שילוש”. בימינו אנו שילושים הם דבר מאוד מעניין, למשל בגרפיקה תלת ממדית, אבל כבר בימי אוילר זה היה מספיק מעניין כדי לנסות להבין איך נראים השילושים האפשריים השונים של מצולע - ובפרט, כמה כאלו יש. מה שאנחנו רואים בתמונה הוא את כל 14 השילושים האפשריים של משושה משוכלל. חלק מהשילושים נראים דומים אחד לשני - כאילו אפשר לסובב או לשקף אחד ולקבל את האחר. מה שמעניין אותנו כאן הוא לספור אותם בתור שילושים שונים - כלומר, אפשר לחשוב על זה כאילו מספרנו את הקודקודים של המצולע, ואנחנו מסתכלים על רשימה של שלשות שמציינות קודקודים. הנה דוגמא:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulation_numbered.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כאן מספרתי את הקודקודים מ-1 עד 6 בכיוון השעון החל מהקודקוד העליון השמאלי, והמשולשים שלי הם &lt;span&gt;\( \left\{ 1,5,6\right\} ,\left\{ 1,2,5\right\} ,\left\{ 2,4,5\right\} ,\left\{ 2,3,4\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;האם יש דרך מסודרת “לייצר” שילושים? למרבה השמחה, כן - דרך &lt;strong&gt;רקורסיבית&lt;/strong&gt;. כלומר, אם אנחנו כבר יודעים למצוא שילושים למצולעים פשוטים, אנחנו יכולים לנצל את זה כדי למצוא שילושים למצולעים מורכבים יותר. מה המצולעים הפשוטים ביותר? ובכן, כמובן שמשולש הוא די פשוט - אם יש לנו משולש, ה”שילוש” שלו זה בסך הכל הוא עצמו. שימו לב שזה לא צריך להיות משולש משוכלל (“משולש שווה צלעות”) - זה נכון לכל משולש.&lt;/p&gt;

&lt;p&gt;אבל חוץ ממשולש, תכף נראה שישתלם לנו לדבר על מצולע אפילו עוד יותר פשוט - מצולע בן &lt;strong&gt;שני קודקודים&lt;/strong&gt;. מה זה הדבר הזה? זה בסך הכל קו ישר אחד; אפשר להתלונן ולומר שזה לא &lt;strong&gt;באמת&lt;/strong&gt; מצולע, אבל זה לא משנה - כאמור, זה הולך להשתלם לנו לחשוב עליו כמצולע עוד מעט.&lt;/p&gt;

&lt;p&gt;בואו ננסה למצוא שילוש למשושה המשוכלל. אני מתחיל עם השאלה - מה קורה עם הצלע 1-2? אני יודע שבסופו של דבר היא תהיה חלק ממשולש שכל הקודקודים שלו שייכים למצולע המקורי, כלומר משולש ששניים מהקודקודים שלו הם 1 ו-2 ואני חופשי לבחור את הקודקוד הנוסף - כל בחירה שונה תניב בסופו של דבר שילושים שונים. בואו נאמר שבחרתי את 5, אז אני מותח קווים אליו מ-1 ו-2, ומקבל:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulation_initial.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;עכשיו מגיע הצעד הרקורסיבי: קונספטואלית, אפשר לחשוב על זה כאילו אני &lt;strong&gt;מוחק&lt;/strong&gt; את הצלע 1-2 מהמשושה ומקבל:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulation_erase.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה שקיבלתי פה הוא שפירקתי את המשושה המקורי לשני מצולעים שונים: המצולע 1-5-6 והמצולע 2-3-4-5. שני המצולעים חולקים קודקוד משותף אחד, את 5 - הקודקוד שבחרתי. בנוסף, יש להם פחות צלעות: לאחד יש 3 ולשני 4 (שימו לב שמספר הצלעות הכולל שלהם הוא כמספר הצלעות במצולע שהתחלנו ממנו, ועוד 1 - זה בגלל שמחקנו את 1-2 אבל הוספנו את 1-5 ואת 2-5). אם יש להם פחות צלעות, אני יכול רקורסיבית לשלש אותם… רגע, שניה, הרי 2-3-4-5 הוא אמנם מצולע, אבל הוא לא מצולע משוכלל, הוא נראה כמו מין טרפז שכזה. למה שאוכל לשלש אותו?&lt;/p&gt;

&lt;p&gt;בואו נחשוב שניה - מה אנחנו צריכים כדי שנוכל לשלש צורה? ראינו שכל משולש הוא בר-שילוש, אבל מה קורה בצורה מורכבת יותר? במשושה שלנו הייתה לי הנחה סמויה - שאני באמת יכול להעביר קווים מ-1 ו-2 אל 5. לא הייתה לי בעיה לעשות את זה כי משושה משוכלל הוא צורה &lt;strong&gt;קמורה&lt;/strong&gt; - כלומר, צורה שבה כל קו בין שתי נקודות ששייכות לצורה עובר כולו בתוך הצורה. זו ההנחה שאני זקוק לה - כלומר, מה שאני סופר הוא כמה שילושים יש למצולע קמור כלשהו, ויוצא שזה לא באמת תלוי בצורה של המצולע אלא רק במספר הקודקודים שלו.&lt;/p&gt;

&lt;p&gt;בואו נכנס סימון לעניין: נסמן ב-&lt;span&gt;\( T_{n} \)&lt;/span&gt; את מספר השילושים של מצולע קמור עם &lt;span&gt;\( n \)&lt;/span&gt; קודקודים. הספירה שלנו מתחילה מ-2, ואז אמרנו שאני בוחר בצורה שנראית קצת שרירותית להגדיר &lt;span&gt;\( T_{2}=1 \)&lt;/span&gt;. בנוסף &lt;span&gt;\( T_{3}=1 \)&lt;/span&gt; כי למשולש יש שילוש יחיד. ומה קורה עבור &lt;span&gt;\( n \)&lt;/span&gt; גדולים יותר? אני אעשה את הטריק שכבר ראינו: אסתכל על הקודקודים 1,2 במצולע בן &lt;span&gt;\( n \)&lt;/span&gt; הצלעות שלי, ואשאל את עצמי מי הקודקוד הנוסף שמתחבר אליהם. נסמן את הקודקוד הזה ב-&lt;span&gt;\( k \)&lt;/span&gt; (&lt;span&gt;\( 3\le k\le n \)&lt;/span&gt;). אחרי שנחבר את 1,2 אליו ונסיר את הקשת 1-2 נקבל שני מצולעים עם פחות צלעות. כמה צלעות? ובכן, בואו נסתכל על הדוגמא למעלה - שם בחרתי &lt;span&gt;\( k=5 \)&lt;/span&gt;, מה שאמר שהמצולע הראשון שקיבלנו כלל את הקודקודים &lt;span&gt;\( 2,3,4,5 \)&lt;/span&gt; והמצולע השני את &lt;span&gt;\( 5,6,1 \)&lt;/span&gt;. זה מה שקורה באופן כללי - המצולעים שלנו יהיו בעלי קבוצות הקודקודים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left\{ 2,3,\ldots,k\right\} ,\left\{ k,k+1,\ldots,n,1\right\}  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בקבוצה הראשונה יש &lt;span&gt;\( k-1 \)&lt;/span&gt; קודקודים ובשתיהן יחד יש &lt;span&gt;\( n+1 \)&lt;/span&gt; קודקודים (כי &lt;span&gt;\( k \)&lt;/span&gt; מופיע פעמיים) ולכן בקבוצה השניה יש &lt;span&gt;\( \left(n+1\right)-\left(k-1\right) \)&lt;/span&gt; קודקודים. זה אומר שמספר השילושים האפשרי של המצולע הראשון הוא &lt;span&gt;\( T_{k-1} \)&lt;/span&gt; ושל השני הוא &lt;span&gt;\( T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt;. עכשיו נשתמש &lt;strong&gt;בקומבינטוריקה&lt;/strong&gt;: כל שילוש של המצולע המקורי שלנו מתקבל מבחירה של שילוש אחד של המצולע הראשון ושילוש אחד של המצולע השני, ושתי הבחירות הללו הן בלתי תלויות זו בזו (כלומר, &lt;strong&gt;לכל&lt;/strong&gt; שילוש של המצולע הראשון אפשר לבחור &lt;strong&gt;כל&lt;/strong&gt; שילוש של המצולע השני ונקבל שילוש שונה של המצולע המקורי) ולכן מספר האפשרויות הכולל הוא &lt;strong&gt;מכפלה&lt;/strong&gt; של מספר האפשרויות הראשון ומספר האפשרויות השני - זה מה שנקרא בקומבינטוריקה &lt;strong&gt;עקרון הכפל&lt;/strong&gt;. בסך הכל יש &lt;span&gt;\( T_{k-1}\cdot T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt; אפשרויות.&lt;/p&gt;

&lt;p&gt;עכשיו, זה היה מספר האפשרויות אם המשולש שאני בונה עם 1,2 כולל גם את &lt;span&gt;\( k \)&lt;/span&gt;. עבור בחירות שונות של &lt;span&gt;\( k \)&lt;/span&gt; אני אקבל שילושים שונים. האם אותו ניתוח יעבוד בכולן? נראה שכן, אבל כדי לוודא בואו נסתכל על המקרה הקיצוני - נאמר, כשבוחרים את הקודקוד &lt;span&gt;\( k=6 \)&lt;/span&gt;:
&lt;img src=&quot;/assets/img/2025/catalan_triangulation_trivial_case.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;למה זה המקרה הקיצוני? כי אם עכשיו אני מסיר את הצלע 1-2 אני מקבל “מצולע” בעל שני קודקודים, &lt;span&gt;\( \left\{ 1,6\right\}  \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulation_trivial_case_erase.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אבל זו בדיוק הסיבה שבגללה אמרתי קודם שנוח לי לחשוב גם על המקרה הזה בתור מצולע, עם שילוש יחיד. למי שהגישה הזו מפריעה לו אפשר לנסח עוד דרכים לחשוב על זה - למשל, שאנחנו פשוט גוזרים את כל המשולש 1-2-6 מהמצולע ונשארנו רק עם מצולע יחיד להתמודד איתו. זה לא באמת משנה - השורה התחתונה היא שאני מקבל &lt;span&gt;\( T_{k-1}\cdot T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt; אפשרויות תמיד, לכל &lt;span&gt;\( k \)&lt;/span&gt;, כולל מקרי הקיצון של &lt;span&gt;\( k=3 \)&lt;/span&gt; ו-&lt;span&gt;\( k=n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אם כך, אפשר לחשוב על בניית שילוש של מצולע בתור תהליך שבו אנחנו בוחרים &lt;span&gt;\( k \)&lt;/span&gt;, ועבור ה-&lt;span&gt;\( k \)&lt;/span&gt; שבחרנו יש לנו &lt;span&gt;\( T_{k-1}\cdot T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt; אפשרויות לבנות שילוש. כאן זה לא תהליך דו-שלבי אלא סיטואציה של “או זה, או זה, או זה”. במקרה הזה &lt;strong&gt;עקרון החיבור&lt;/strong&gt; בקומבינטוריקה אומר שאנחנו צריכים לחבר את מספר האפשרויות בכל אחד מהמקרים. אצלנו &lt;span&gt;\( 3\le k\le n \)&lt;/span&gt; ולכן בסך הכל קיבלנו את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( T_{n}=\sum_{k=3}^{n}T_{k-1}T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שאני אוהב בנוסחה הזו הוא שברור לנו איך היא התקבלה. הבעיה היא שהיא לא יפה במיוחד - יש קטסטרופה שלמה עם האינדקסים שם. אז המתמטיקאים אומרים - היי, בעצם, סדרת ה-&lt;span&gt;\( T \)&lt;/span&gt;-ים הזו “מבזבזת” את שני האינדקסים הראשונים של, &lt;span&gt;\( T_{0},T_{1} \)&lt;/span&gt; שבכלל לא מוגדרים. בואו נשנה סימון ונתחיל עם סדרה שכן מתחילה מאפס. נסמן ב-&lt;span&gt;\( C \)&lt;/span&gt; את האיברים שלה, כלומר &lt;span&gt;\( C_{0}=T_{2} \)&lt;/span&gt; ו-&lt;span&gt;\( C_{1}=T_{3} \)&lt;/span&gt; וכדומה - באופן כללי, &lt;span&gt;\( C_{n}=T_{n+2} \)&lt;/span&gt;. אז נוסחת הנסיגה תהפוך להיות:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C_{n}=T_{n+2}=\sum_{k=3}^{n+2}T_{k-1}T_{\left(n+3\right)-\left(k-1\right)}=\sum_{k=3}^{n+2}C_{k-3}C_{\left(n+1\right)-\left(k-1\right)}= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\sum_{i=0}^{n-1}C_{i}C_{n+1-\left(i+2\right)}=\sum_{i=0}^{n-1}C_{i}C_{n-1-i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן השתמשתי בשינוי האינדקס &lt;span&gt;\( i=k-3 \)&lt;/span&gt; כדי לפשט עוד יותר, ויש כאלו שכדאי שהנוסחה תהיה עוד יותר פשוטה מעדיפים להציג אותה ככה, עם &lt;span&gt;\( C_{n+1} \)&lt;/span&gt; במקום &lt;span&gt;\( C_{n} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C_{n+1}=\sum_{i=0}^{n}C_{i}C_{n-i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו נוסחת הנסיגה המהותית שמגדירה את מספרי קטלן, והיא מה שאוילר מצא (והסיק ממנה את מה שנקרא &lt;strong&gt;הפונקציה היוצרת&lt;/strong&gt; של הסדרה ובשיטות מפוקפקות של חשבון דיפרנציאלי ואינטגרלי הסיק ממנה את הנוסחה הסגורה של הסדרה, שנראה בהמשך). כשהיא מוצגת כך, אפשר להבין למה מספרי קטלן הם כל כך בסיסיים - הנוסחה בעצם מתארת כל סיטואציה שבה כדי לבנות אובייקט מגודל &lt;span&gt;\( n+1 \)&lt;/span&gt; אנחנו בונים זוג אובייקטים שהגודל שלהם מסתכם אל &lt;span&gt;\( n \)&lt;/span&gt;, וכל זוג כזה מייצר לנו באופן ייחודי אובייקט מגודל &lt;span&gt;\( n+1 \)&lt;/span&gt;. זה טיפה טריקי (לפחות עבורי) לראות את זה ישירות עבור שילוש של מצולעים בגלל שמצולע מ”גודל” &lt;span&gt;\( n+1 \)&lt;/span&gt; במקרה הזה הוא מצולע עם &lt;span&gt;\( n+3 \)&lt;/span&gt; קודקודים ובהתאם, כשאנחנו מפרקים אותו לאובייקט מגודל &lt;span&gt;\( i \)&lt;/span&gt; ומגודל &lt;span&gt;\( n-i \)&lt;/span&gt; יש לנו מצולעים עם &lt;span&gt;\( i+2 \)&lt;/span&gt; קודקודים ו-&lt;span&gt;\( n-i+2 \)&lt;/span&gt; קודקודים ולכן בסך הכל &lt;span&gt;\( n+4 \)&lt;/span&gt; קודקודים שאחד מהם (קודקוד &lt;span&gt;\( i \)&lt;/span&gt;) נספר פעמיים ולכן הם בדיוק &lt;span&gt;\( n+3 \)&lt;/span&gt; הקודקודים של המצולע המקורי. הצלחתן לעקוב? יופי, כי אני לא. בכל פעם שבה אני מנסה לראות את זה ככה אני מסתבך בגלל כל עניין הפלוס 2 הזה; לכן הצגתי את זה קודם עם ה-&lt;span&gt;\( T \)&lt;/span&gt;-ים.&lt;/p&gt;

&lt;p&gt;למרבה המזל יש בעיות קומבינטוריות שנותנות את &lt;span&gt;\( C_{n} \)&lt;/span&gt; בצורה ישירה יותר.&lt;/p&gt;

&lt;h2&gt;מסלולי שריג&lt;/h2&gt;

&lt;p&gt;גם כאן, תמונה אחת עוזרת מאוד להבין מה אני בכלל רוצה. ראשית, תמונה של כל ה-14 אובייקטים מגודל 4 שאני הולך לספור:
&lt;img src=&quot;/assets/img/2025/grid_walks_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אוקיי, אולי זה לא לגמרי ברור. בואו נראה עוד דוגמא קונקרטית:
&lt;img src=&quot;/assets/img/2025/grid_walk_basic.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;יש לנו כאן לוח משבצות, אבל אני מתעניין פחות במשבצות הפעם ויותר בקודקודים שלהן ובקווים שמחברים אותן - לרשת כזו של קודקודים וקווים במרווחים שווים קוראים &lt;strong&gt;שריג&lt;/strong&gt;. עכשיו, אני נותן קואורדינטות לכל נקודות השריג כך ש-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; היא הנקודה השמאלית-תחתונה ו-&lt;span&gt;\( \left(7,7\right) \)&lt;/span&gt; היא הקואורדינטה הימנית-עליונה, ואני מסתכל על &lt;strong&gt;מסלול&lt;/strong&gt; שמתחיל מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; ומסתיים ב-&lt;span&gt;\( \left(7,7\right) \)&lt;/span&gt;. כל צעד במסלול עובר מקודקוד אחד לאחר על הקו שמחבר ביניהם, המסלול הספציפי שלי מתחיל בצעד ימינה, ואז למעלה, ימינה, למעלה… טוב, זה כאב ראש לתאר הכל במפורש, אבל אפשר לתאר בצורה קומפקטית בתור רצף של אותיות: R מסמן צעד ימינה ו-U מסמן צעד למעלה, ואז המסלול שמתואר באיור הוא&lt;/p&gt;

&lt;p&gt;RURURRRUURUUUR&lt;/p&gt;

&lt;p&gt;ספירה מהירה תראה שיש במסלול הזה 14 צעדים - בדיוק 7 צעדי R ו-7 צעדי U, מה שלא כל כך מפתיע כי כדי להגיע מלמטה למעלה צריך 7 צעדים, וכך גם כדי להגיע משמאל לימין. השאלה היא רק מה יהיה הסדר הפנימי בין הצעדים הללו. עכשיו, אפשר להוסיף גם צעדים שמאלה/למטה, אבל הם רק יובילו לכך שהמסלול יהיה ארוך יותר, ואנחנו מתעניינים בשאלה כמה מסלולים קצרים ביותר יש. באופן כללי, לכל &lt;span&gt;\( n \)&lt;/span&gt; טבעי, אנחנו שואלים את השאלה כמה מסלולי שריג יש מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; שאורכם בדיוק &lt;span&gt;\( 2n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מתברר שזו שאלה &lt;strong&gt;קלה&lt;/strong&gt; שאנחנו לא צריכים את מספרי קטלן עבורה, אבל כן צריך להכיר קצת קומבינטוריקה בסיסית מהסוג שתיארתי &lt;a href=&quot;https://gadial.net/2010/06/20/combinatorics_intro/&quot;&gt;בפוסט הזה&lt;/a&gt;: שם דיברתי על כך שמספר האפשרויות לבחור &lt;span&gt;\( k \)&lt;/span&gt; מתוך &lt;span&gt;\( n \)&lt;/span&gt; איברים, כשאין חשיבות לסדר שבו האיברים נבחרים ואי אפשר לבחור איבר פעמיים, הוא בדיוק מה שמסומן בתור &lt;span&gt;\( {n \choose k} \)&lt;/span&gt; (קרי: “&lt;span&gt;\( n \)&lt;/span&gt; בחר &lt;span&gt;\( k \)&lt;/span&gt;”) ושווה ל-&lt;span&gt;\( {n \choose k}=\frac{n!}{k!\left(n-k\right)!} \)&lt;/span&gt;. אני אניח פה שהדבר הזה מוכר.&lt;/p&gt;

&lt;p&gt;עכשיו, אפשר לחשוב על מסלול מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; שכולל בדיוק &lt;span&gt;\( n \)&lt;/span&gt; צעדי U ו-&lt;span&gt;\( n \)&lt;/span&gt; צעדי R בתור משהו שניתן להרכיב כך: ראשית, מבין &lt;span&gt;\( 2n \)&lt;/span&gt; הצעדים במסלול (הצעד הראשון, השני, השלישי וכו’) אנחנו בוחרים בדיוק &lt;span&gt;\( n \)&lt;/span&gt; ומציבים בהם U, ואז בכל השאר מציבים R. זו בחירה &lt;strong&gt;בלי&lt;/strong&gt; חשיבות לסדר, כי זה לא משנה אם קודם החלטתי שבצעד 1 יהיה U ואז החלטתי שבצעד 5 יהיה גם U או אם החלטתי את זה קודם עבור צעד 5 ורק אז עבור צעד 1. זו גם בחירה שבה אי אפשר לבחור איבר פעמיים, כי אני לא יכול להחליט שאני רוצה לדחוף לצעד 5 “פעמיים U”. לכן מספר מסלולי השריג מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; הוא בדיוק &lt;span&gt;\( {2n \choose n} \)&lt;/span&gt;. זה היה קל.&lt;/p&gt;

&lt;p&gt;אז בואו נסבך קצת את הבעיה. אני הולך למתוח &lt;strong&gt;אלכסון&lt;/strong&gt; בלוח שלי, ולחפש רק את המסלולים &lt;strong&gt;שלא מגיעים מעל האלכסון&lt;/strong&gt;, כלומר לא מבקרים באף משבצת מהצורה &lt;span&gt;\( \left(a,b\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( a&amp;lt;b \)&lt;/span&gt;. המסלול שציירתי קודם &lt;strong&gt;כמעט&lt;/strong&gt; מקיים את זה, אבל נכשל ברגע האחרון:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/grid_walk_wrong.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כדי שיהיה קל להבין מה הולך פה, האיור שלי משתמש בויזואליזציה נחמדה שראיתי במקור בויקיפדיה האנגלית: צובעים את כל המשבצות &lt;strong&gt;מתחת&lt;/strong&gt; למסלול בצבע כתום, והקריטריון לכך שהמסלול תקין הוא שהאלכסון (הקו המקווקו) לא עובר בתוך אף משבצת כתומה. כמה מסלולים כאלו יש? האינטואיציה הראשונית שלי היא שחצי ממספר המסלולים הכולל, כלומר &lt;span&gt;\( \frac{1}{2}{2n \choose n} \)&lt;/span&gt;, כי אנחנו לוקחים רק את המסלולים ש&lt;strong&gt;מתחת&lt;/strong&gt; לאלכסון ולכל מסלול כזה יש מסלול סימטרי &lt;strong&gt;מעל&lt;/strong&gt; האלכסון (כזה שבו כל צעד “למעלה” מוחלף בצעד “ימינה” וכל צעד “ימינה” מוחלף בצעד “למעלה”). רק שכמובן שזה לא עובד כי רוב המסלולים הם בכלל כאלו ש&lt;strong&gt;חוצים&lt;/strong&gt; את האלכסון, לא שנשארים רק מעליו או מתחתיו. אז מה עושים?&lt;/p&gt;

&lt;p&gt;אני אתחיל מלמצוא נוסחה רקורסיבית עבור מספר המסלולים, והפלא ופלא נקבל בדיוק את הנוסחה הרקורסיבית שכבר ראינו עבור &lt;span&gt;\( C_{n} \)&lt;/span&gt;. אחרי זה נראה להטוט שאני מאוד אוהב שיאפשר לנו לקבל עבור &lt;span&gt;\( C_{n} \)&lt;/span&gt; את הנוסחה המדויקת &lt;span&gt;\( C_{n}=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;. אם היקום היה מושלם, אז הלהטוט היה פשוט לראות בעיה קומבינטורית שקל באופן ישיר לראות שיש לה &lt;span&gt;\( \frac{1}{n+1}{2n \choose n} \)&lt;/span&gt; פתרונות, אבל את זה אני לא יודע איך עושים אז אעשה משהו קצת יותר מתוסבך, אבל לא הרבה יותר.&lt;/p&gt;

&lt;p&gt;אז איך נראה מסלול שריג “חוקי”, כזה שבשום שלב לא עובר מעל האלכסון? דבר אחד שאנחנו יודעים בודאות הוא שהצעד הראשון חייב להיות R, אחרת המסלול יגיע מעל האלכסון כבר בצעד הראשון שלו. אז בואו נתחיל את זה:
&lt;img src=&quot;/assets/img/2025/grid_walk_example_1.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אחרי הצעד הזה, המסלול לא נוגע באלכסון - הוא מתחתיו. הדבר השני שאנחנו יודעים הוא ש&lt;strong&gt;מתישהו&lt;/strong&gt; המסלול הולך לגעת באלכסון - לכל המאוחר הוא יגיע אליו ממש בסוף, כשיגיע אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt;, אבל הוא בהחלט יכול להגיע לשם עוד קודם ולגעת בו כמה פעמים. מה שאני הולך להסתכל עליו הוא מה שקורה למסלול עד הפעם &lt;strong&gt;הראשונה&lt;/strong&gt; שבה הוא מגיע אל האלכסון. מה שברור הוא שבצעד האחרון, שבו מגיעים אל האלכסון, המסלול הולך &lt;strong&gt;למעלה&lt;/strong&gt; (כי אם הוא היה הולך ימינה ומגיע אל האלכסון, זה אומר שהוא נמצא מעליו, וזה לא חוקי). אז מה קורה למסלול &lt;strong&gt;בין&lt;/strong&gt; ה-R ההתחלתי וה-U האחרון הזה? אפשר לצייר &lt;strong&gt;עוד&lt;/strong&gt; אלכסון, מתחת לאלכסון המרכזי שלנו, לקרוא לו “האלכסון המשני” ולראות שהמסלול שלנו בין הצעד הראשון והאחרון נמצא כולו &lt;strong&gt;מתחת לאלכסון המשני&lt;/strong&gt;. פשוט כי לעלות מעל האלכסון המשני אומר להגיע ולגעת באלכסון הראשי, וזה מה שאמרתי שקורה רק בסוף. במילים אחרות - בין הצעד הראשון והאחרון יש לנו &lt;strong&gt;עוד&lt;/strong&gt; משהו שמתנהג בדיוק כמו מסלול שריג חוקי, פשוט על שריג קטן יותר. בדוגמא שלי צבעתי באדום את הצעדים שמתאימים למסלול הזה והאורך שלו הוא 6 (כלומר, 3 צעדי R ו-3 צעדי U).
&lt;img src=&quot;/assets/img/2025/grid_walk_example_2.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;אחרי&lt;/strong&gt; ההגעה לאלכסון הראשי, יש לנו עוד מסלול שמתנהג כמו מסלול שריג חוקי שלא עובר מעל האלכסון, פשוט על שריג קטן יותר - המשבצות שנותרו. אצלי צבעתי אותו בכחול והאורך שלו הוא גם כן 3:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/grid_walk_example_3.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;זו החוקיות הכללית: כל מסלול חוקי מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; מורכב מ-R בהתחלה (שמביא את המסלול אל &lt;span&gt;\( \left(1,0\right) \)&lt;/span&gt;), ואז מסלול חוקי מאורך &lt;span&gt;\( 2k \)&lt;/span&gt; כלשהו (שמביא את המסלול אל &lt;span&gt;\( \left(k+1,k\right) \)&lt;/span&gt;), ואז U (שמביא את המסלול אל &lt;span&gt;\( \left(k+1,k+1\right) \)&lt;/span&gt;) ואז עוד מסלול חוקי (שמגיע אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt;). מכיוון שהאורך הכולל של המסלולים הוא &lt;span&gt;\( 2n \)&lt;/span&gt; ו”בזבזנו” 2 צעדים על ה-R בהתחלה וה-U בהמשך ובזבזנו עוד &lt;span&gt;\( 2k \)&lt;/span&gt; צעדים על המסלול החוקי הראשון, אז השני יהיה מאורך &lt;span&gt;\( 2n-2-2k=2\left(n-k-1\right) \)&lt;/span&gt;. כדי שהמספרים ייראו נחמד, בואו נדבר על מסלול מאורך &lt;span&gt;\( 2\left(n+1\right) \)&lt;/span&gt;, נמשיך לקרוא לאורך של המסלול הראשון &lt;span&gt;\( 2k \)&lt;/span&gt; ואז האורך של השני יהיה &lt;span&gt;\( 2\left(n-k\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;קל לנחש את הצעד הבא: אני אסמן ב-&lt;span&gt;\( C_{n} \)&lt;/span&gt; את מספר המסלולים מאורך &lt;span&gt;\( 2n \)&lt;/span&gt;, אז קיבלתי ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C_{n+1}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שאנחנו רואים פה בפעולה הוא בדיוק את העיקרון של “שני אובייקטים בלתי תלויים שסכום הגדלים שלהם הוא &lt;span&gt;\( n \)&lt;/span&gt; מצטרפים ליצירת אובייקט חדש מגודל &lt;span&gt;\( n+1 \)&lt;/span&gt;” (כאן ה”גודל” הוא, נאמר, מספר צעדי ה-R). עבורי, כשאני סתם רואה את הנוסחה של קטלן, השאלה שבאה מעצמה היא “למה בעצם איברים שסכום הגדלים שלהם הוא &lt;span&gt;\( n \)&lt;/span&gt; יוצרים משהו מגודל &lt;span&gt;\( n+1 \)&lt;/span&gt;? מאיפה הפלוס אחד הזה בא?” וכאן אנחנו רואים דוגמא לדרך שבה הוא עשוי לבוא - אין לנו &lt;strong&gt;חופש בחירה&lt;/strong&gt; מלא של איך לבנות את האובייקט החדש מתוך הקיימים; אנחנו &lt;strong&gt;חייבים&lt;/strong&gt; לתת צעד ראשון R, מה ש”מבזבז” לנו צעד אחד.&lt;/p&gt;

&lt;p&gt;אגב, מה מקרה הקיצון כאן? מה קורה בעצם כש-&lt;span&gt;\( k=0 \)&lt;/span&gt;? במקרה הזה המסלול הראשון הוא “ריק” ולא כולל צעדים: המסלול הגדול פשוט עושה את ה-R בהתחלה ואז מייד את ה-U שמביא אותו אל האלכסון הראשי - וזה בסדר, אנחנו סופרים את המסלול הריק פעם אחת והנוסחה מסתדרת יפה (“מסלול ריק” זו לא איזו המצאה תלושה; זו בסך הכל סדרה ריקה, דהיינו פונקציה שהתחום שלה ריק, כלומר קבוצה ריקה - אפשר לפרמל את זה עד הסוף, אבל האם זה באמת עוזר לנו להבין את זה יותר טוב?)&lt;/p&gt;

&lt;p&gt;טוב ויפה, אז שוכנענו שמספר מסלולי השריג שלא עולים מעל האלכסון הוא בדיוק מספר קטלן, אבל הבטחתי להראות דרך למצוא נוסחה סגורה עבורם בעזרת מסלולי שריג. בואו נראה את זה קורה. מה שאני הולך לעשות בפועל הוא לספור את המסלולים &lt;strong&gt;הלא חוקיים&lt;/strong&gt;, אלו שכן חוצים את האלכסון. אני אוכיח שהמספר שלהם, עבור השריג מגודל &lt;span&gt;\( n \)&lt;/span&gt;, הוא &lt;span&gt;\( {2n \choose n-1} \)&lt;/span&gt;. עכשיו אפשר לעשות טיפה אלגברה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( {2n \choose n-1}=\frac{\left(2n\right)!}{\left(n-1\right)!\left(n+1\right)!}=\left(2n\right)!\cdot\frac{n}{n!}\cdot\frac{1}{n!\left(n+1\right)}=\frac{\left(2n\right)!}{n!n!}\cdot\frac{n}{n+1}={2n \choose n}\cdot\frac{n}{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מכיוון שמספר המסלולים הכללי הוא &lt;span&gt;\( {2n \choose n} \)&lt;/span&gt;, אני אקבל שמספר המסלולים החוקיים הוא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( {2n \choose n}-{2n \choose n-1}={2n \choose n}-{2n \choose n}\cdot\frac{n}{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( ={2n \choose n}\left(1-\frac{n}{n+1}\right)=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;קיבלנו את הנוסחה הסגורה &lt;span&gt;\( C_{n}=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;. יש כאמור עוד שלל דרכים להסיק אותה (ואוילר עשה את זה אלגברית, בעזרת הפונקציה היוצרת) אבל אני אוהב את הדרך הקומבינטורית שאראה עכשיו כי היא מאוד ציורית.&lt;/p&gt;

&lt;p&gt;האתגר שלנו הוא לספור כמה מסלולים קיימים ש&lt;strong&gt;כן&lt;/strong&gt; עולים מעל האלכסון. בדומה למה שעשיתי קודם, גם עכשיו הרעיון יהיה להסתכל על מסלול כללי כזה ולפרק אותו לחלק שלפני המעבר על החוק, והחלק שאחריו, ואז לעשות איזו מניפולציה. בואו נראה דוגמא:
&lt;img src=&quot;/assets/img/2025/grid_walk_mirror_1.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;הפעם הראשונה שבה המסלול הזה מגיע אל מעל האלכסון המרכזי הוא בקואורדינטה &lt;span&gt;\( \left(4,5\right) \)&lt;/span&gt;. מה שקורה אז הוא שהמסלול נוגע לראשונה באלכסון &lt;strong&gt;המשני&lt;/strong&gt; שנמצא מעל האלכסון הראשי - כלומר האלכסון &lt;span&gt;\( y=x+1 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו מגיע הטריק: אני הולך &lt;strong&gt;לשקף&lt;/strong&gt; את החלק של המסלול עד להגעה אל &lt;span&gt;\( \left(4,5\right) \)&lt;/span&gt;, ולשקף אותו ביחס לאלכסון המשני הזה. זה הולך להיראות ככה:
&lt;img src=&quot;/assets/img/2025/grid_walk_mirror_2.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;המסלול המשוקף עושה בדיוק ההפך ממה שהמסלול הרגיל עושה - בכל פעם שהרגיל עושה U המשוקף עושה R, ולהפך. הבדל נוסף הוא בנקודת ההתחלה: המסלול הרגיל מתחיל בנקודה &lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt;, שהיא צעד R אחד מהנקודה &lt;span&gt;\( \left(-1,0\right) \)&lt;/span&gt; שדרכה עובר האלכסון המשני; המסלול המשוקף מתחיל בנקודה שהיא צעד U אחד מאותה נקודה, כלומר הוא מתחיל מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, אם ניקח את המסלול המשוקף עד שהוא מגיע לנקודה &lt;span&gt;\( \left(4,5\right) \)&lt;/span&gt; ואז נמשיך ללכת במסלול &lt;strong&gt;הרגיל&lt;/strong&gt;, מה שקיבלנו הוא מסלול מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(10,10\right) \)&lt;/span&gt;, והיופי הוא כמובן שזה עובד באופן כללי. כלומר, הטכניקה הזו של “לקחת מסלול שעובר מעל האלכסון הראשי, להעביר אלכסון משני מהנקודה הראשונה שבה זה קורה, לשקף ולחבר עם המשך המסלול” - זו טכניקה שבהינתן מסלול שעובר מעל האלכסון הראשי נותנת לנו מסלול מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt;. לא קשה להוכיח את זה פורמלית: הרי מסלול הוא בסך הכל סדרה של U ו-R, ומה שעושה פעולת השיקוף היא כאמור להפוך כל R אל U וכל U אל R. אם אנחנו עושים את זה עבור מסלול כללי עד הנקודה שבה המסלול הגיע לנקודה מהצורה &lt;span&gt;\( \left(a,a+1\right) \)&lt;/span&gt;, זה אומר שהמסלול כלל &lt;span&gt;\( a \)&lt;/span&gt; צעדי R ו-&lt;span&gt;\( a+1 \)&lt;/span&gt; צעדי U ולכן המסלול המשוקף כולל &lt;span&gt;\( a \)&lt;/span&gt; צעדי U ו-&lt;span&gt;\( a+1 \)&lt;/span&gt; צעדי R - ולכן אם הוא מתחיל מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; הוא יגיע אל &lt;span&gt;\( \left(-1+\left(a+1\right),1+a\right)=\left(a,a+1\right) \)&lt;/span&gt; ומשם אפשר יהיה להמשיך אותו כרגיל.&lt;/p&gt;

&lt;p&gt;העניין הוא שאפשר לעשות גם &lt;strong&gt;את ההפך&lt;/strong&gt;: לקחת מסלול &lt;strong&gt;כלשהו&lt;/strong&gt; מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; ולקבל ממנו מסלול מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; שעובר מעל האלכסון. הרעיון פשוט: ברגע שהמסלול שלנו נוגע באלכסון המשני &lt;span&gt;\( y=x+1 \)&lt;/span&gt;, לבצע עליו את אותה פעולת שיקוף בדיוק. והנה הפאנץ’: &lt;strong&gt;כל&lt;/strong&gt; מסלול מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; חייב מתישהו להגיע אל האלכסון המשני, כי הוא מתחיל את המסלול &lt;strong&gt;מעליו&lt;/strong&gt; אבל מסיים את המסלול &lt;strong&gt;מתחתיו&lt;/strong&gt;. מכאן שבאמת אפשר להפוך ככה כל מסלול מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt;, ובמילים אחרות - ההתאמה בין מסלולים מ-מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; ומסלולים לא חוקיים מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; היא התאמה חח”ׂע ועל - גודל שתי הקבוצות הללו זהה. אבל מסלולים &lt;strong&gt;כלשהם&lt;/strong&gt; מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; שכוללים רק צעדי U ו-R - את זה קל לספור. מסלול כזה חייב להכיל &lt;span&gt;\( n+1 \)&lt;/span&gt; צעדי R ו-&lt;span&gt;\( n-1 \)&lt;/span&gt; צעדי U, ולכן מספר הצעדים הכולל שלו הוא &lt;span&gt;\( \left(n-1\right)+\left(n+1\right)=2n \)&lt;/span&gt; ומתוכם צריך לבחור &lt;span&gt;\( n-1 \)&lt;/span&gt; כדי להציב בהם את ה-U - וזה בדיוק &lt;span&gt;\( {2n \choose n-1} \)&lt;/span&gt;. קיבלנו את התוצאה שחיפשנו.&lt;/p&gt;

&lt;p&gt;למסלולי שריג יש שם: &lt;strong&gt;מסלולי דיק&lt;/strong&gt; (Dyck), והם קשורים בצורה ישירה לסדרות של תווים שנקראות &lt;strong&gt;מילות דיק&lt;/strong&gt;. הרעיון במילת דיק, בהקשר הזה, הוא שזו מילה מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; שמורכבת משני תווים שכל אחד מופיע &lt;span&gt;\( n \)&lt;/span&gt; פעמים - אלו בדיוק ה-U,R אצלנו. הדרישה הנוספת, שתואמת את הדרישה שהמסלול לא יעבור מעל האלכסון, היא שבאף &lt;strong&gt;רישא&lt;/strong&gt; של המילה לא יהיו יותר U מאשר R-ים (רישא היא תת-מילה שמקבלים מכך שמתחילים מהאות הראשונה במילה, מתקדמים הלאה ועוצרים מתישהו). דרך אחרת לתאר מסלולי דיק היא אם מפרשים את U בתור “למטה וימינה” ואת R בתור “למעלה וימינה” ואז מקבלים מסלול מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,0\right) \)&lt;/span&gt; שלא יורד מתחת לציר &lt;span&gt;\( x \)&lt;/span&gt; בשום שלב. הנה ציור סכמטי של איך 14 המסלולים מאורך 4 נראים:
&lt;img src=&quot;/assets/img/2025/dyck_paths_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;דרך נחמדה אחת לחשוב על מילות דיק היא אם מפרשים את R בתור סוגריים שמאליים, כלומר הסימן “)”, ואת U בתור סוגריים ימניים, כלומר “(“. כשכותבים סוגריים, מקובל לפעמים לשים סוגריים בתוך סוגריים (אמנם, לא תמיד אבל זה די נפוץ (למשל פראצ’ט מאוד אהב התחכמויות כאלו (האמת שאני לא בטוח אם פראצ’ט השתמש בסוגריים בתוך סוגריים או בהערות שוליים בתוך הערות שוליים) והוא לא היחיד מסוגו) ולכן כשאני משתמש בזה כאן זה לא כזה חריג). כשכותבים משמאל לימין, כמו למשל במתמטיקה, הכלל הוא שסוגריים שמאליים פותחים קונטקסט חדש וסוגריים ימניים סוגרים את הקונטקסט הפתוח הנוכחי. אם ברישא כלשהי יהיו יותר סוגריים ימניים משמאליים, זה אומר שייסגרו יותר קונטקסטים מאשר נפתחו עד כה, וזה לא הגיוני - ולכן זה “אסור”. ובאמת, כשמנסים לנתח ביטוי שכולל סוגריים הרבה פעמים עושים בדיוק את הפירוק שראינו כאן - הולכים עד הפעם הראשונה שבה מספר הסוגריים הימניים משתווה לשמאליים, ומפרקים ל”מה שבין הסוגר הימני שבהתחלה והסוגר השמאלי שעכשיו, וכל מה שבא אחר כך”.&lt;/p&gt;

&lt;h2&gt;עצים&lt;/h2&gt;

&lt;p&gt;נראה לי שכבר הבנו את הרעיון - אני מציג משהו חדש שמתאים למספרי קטלן, קודם כל אני מראה תמונה של 14 האובייקטים שמתאימים לגודל 4, כלומר למקרה &lt;span&gt;\( C_{4}=14 \)&lt;/span&gt;:
&lt;img src=&quot;/assets/img/2025/binary_trees_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה שאנחנו רואים פה הוא &lt;strong&gt;עצים בינאריים&lt;/strong&gt; עם 4 צמתים. עצים בינאריים כאלו הם מקרה פרטי של &lt;strong&gt;גרף&lt;/strong&gt; - הרעיון בגרף הוא שיש לנו אוסף של נקודות שנקראות “צמתים” וקווים שמחברים אותם, שנקראים “קשתות”. הרעיון הכללי ב”עץ” הוא שזה גרף שבו יש צומת מיוחד - “השורש” - שאפשר להגיע ממנו לכל הצמתים האחרים בגרף. אנחנו אוהבים לצייר עצים כך שהשורש הוא הצומת העליון ביותר וה”כיוון” של העץ הוא כלפי מטה (אבל אם רוצים אפשר גם להגדיר שמותר לעלות למעלה בחזרה, מה שאומר שכל צומת הוא בעצם שורש, וזו לא בעיה). אם אנחנו משתמשים בקונבנציה הזו של “מלמעלה למטה” אז בסיטואציה שבה יש קשת מצומת א’ לצומת ב’ הנמוך יותר, אומרים שא’ הוא &lt;strong&gt;אבא&lt;/strong&gt; של ב’ ושב’ הוא &lt;strong&gt;ילד&lt;/strong&gt; של א’. הרעיון בעץ &lt;strong&gt;בינארי&lt;/strong&gt; הוא שלכל צומת יש לכל היותר שני בנים - ויותר מכך, יש ביניהם &lt;strong&gt;סדר&lt;/strong&gt;. יש בן ימני ובן שמאלי, וזה נשאר כך גם אם אחד מהבנים חסר. כלומר, לכל צומת יש ארבע אפשרויות: או שיש לו שני בנים, או שאין לו בנים, או שיש לו בן ימני או שיש לו בן שמאלי.&lt;/p&gt;

&lt;p&gt;עצים בינאריים הם מושג חשוב ומועיל במדעי המחשב - למשל, נוח לאחסן בהם נתונים בצורה שהופכת חיפושים ליעילים. אבל כאן אנחנו מתעניינים &lt;strong&gt;במספר&lt;/strong&gt; שלהם, וכצפוי התוצאה היא שמספר העצים הבינאריים עם &lt;span&gt;\( n \)&lt;/span&gt; צמתים הוא &lt;span&gt;\( C_{n} \)&lt;/span&gt;. גם פה קל לראות את זה בעזרת בניה רקורסיבית, ועצים הם אולי המקרה הטבעי ביותר שבו בניה כזו צצה; זה ממש נעוץ בהגדרה. אני מגדיר &lt;strong&gt;עץ בינארי&lt;/strong&gt; באופן הבא: עץ ריק (עם 0 צמתים) הוא עץ בינארי, ובהינתן שני עצים בינאריים &lt;span&gt;\( T_{1},T_{2} \)&lt;/span&gt; ניתן לבנות מהם עץ בינארי חדש על ידי הוספת צומת שורש חדש כך שאם יש ל-&lt;span&gt;\( T_{1} \)&lt;/span&gt; שורש, הוא הבן הימני של השורש החדש, ואם יש ל-&lt;span&gt;\( T_{2} \)&lt;/span&gt; שורש הוא הבן השמאלי של השורש החדש.&lt;/p&gt;

&lt;p&gt;עם ההגדרה הזו, מה קיבלנו? שמשני עצים אנחנו מקבלים עץ חדש &lt;strong&gt;על ידי הוספת צומת&lt;/strong&gt;. כלומר, אם קודם סכום הצמתים ב-&lt;span&gt;\( T_{1},T_{2} \)&lt;/span&gt; היה &lt;span&gt;\( n \)&lt;/span&gt;, בעץ החדש יש &lt;span&gt;\( n+1 \)&lt;/span&gt; צמתים. מכאן הנוסחה הרקורסיבית מגיעה מייד - והפעם הבניה הייתה סימטרית, להבדיל ממה שקרה עבור שילושים או מסלולי שריג.&lt;/p&gt;

&lt;p&gt;יופי, זה היה פשוט! בואו נעבור למשהו קצת יותר מוזר:
&lt;img src=&quot;/assets/img/2025/plane_trees_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה אנחנו רואים כאן? גם זה נראה כמו עצים, אבל לא בינאריים - יש צמתים עם יותר משני בנים. אלו גם לא עצים עם 4 צמתים אלא דווקא עם 5 צמתים, אז מה הקטע? עצים כאלו נקראים “עצים סדורים” (או plane trees ועוד כל מני שמות) וההסבר הכי פשוט מה הם הוא פשוט ההגדרה: עץ סדור הוא גרף שכולל צומת מיוחד שנקרא &lt;strong&gt;השורש&lt;/strong&gt; של העץ, ובנוסף יש רשימה &lt;span&gt;\( P_{1},\ldots,P_{n} \)&lt;/span&gt; (אולי ריקה) של עצים סדורים כך שלכל &lt;span&gt;\( i \)&lt;/span&gt; יש קשת מהשורש של העץ אל השורש של &lt;span&gt;\( P_{i} \)&lt;/span&gt;, והסדר בין הבנים של צומת הוא חשוב (כלומר, הרשימות &lt;span&gt;\( P_{1},P_{2} \)&lt;/span&gt; ו-&lt;span&gt;\( P_{2},P_{1} \)&lt;/span&gt; ייתנו עצים שונים אם &lt;span&gt;\( P_{1}\ne P_{2} \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;עבור עצים סדורים מתקיים שמספר העצים הסדורים עם &lt;span&gt;\( n+1 \)&lt;/span&gt; צמתים הוא &lt;span&gt;\( C_{n} \)&lt;/span&gt;, וזה מה שמודגם באיור. במבט ראשון זה קצת מפתיע - עץ סדור זו הגדרה יותר “חופשית” מעצים בינאריים, אז איך ייתכן שיש &lt;strong&gt;יותר&lt;/strong&gt; עצים בינארים מעצים סדורים? הרי בהינתן &lt;span&gt;\( n \)&lt;/span&gt; יש &lt;span&gt;\( C_{n} \)&lt;/span&gt; עצים בינאריים אבל רק &lt;span&gt;\( C_{n-1} \)&lt;/span&gt; עצים סדורים עם &lt;span&gt;\( n \)&lt;/span&gt; צמתים. העניין הוא שבעץ בינארי מקרים של בנים חסרים &lt;strong&gt;עדיין נספרים&lt;/strong&gt;. כמו שאמרתי קודם, אנחנו מבדילים בין המקרה שבו יש לצומת רק בן ימני והמקרה שיש לו רק בן שמאלי - ואת זה אין בעצים סדורים. אם יש רק בן יחיד לצומת, אז זה מקרה אחד שלא הולך להיספר פעמיים.&lt;/p&gt;

&lt;p&gt;טוב ויפה, אז איך מראים שעצים סדורים מקיימים את הנוסחה הרקורסיבית? ובכן… אה… אני לא יודע. עבורי זה מקרה מעניין בדיוק בגלל שעצים סדורים &lt;strong&gt;לא&lt;/strong&gt; נראים ממבט ראשון כמו משהו שקל להתאים לבניה רקורסיבית של שני חלקים. אני מניח שאם מתאמצים קצת אפשר למצוא דרך לקבל את הנוסחה הרקורסיבית גם כאן, אבל אני לא רוצה לעשות את זה כי יש התאמה חד-חד-ערכית ועל יפהפיה בין עצים בינאריים ועצים סדורים. בואו נראה דוגמא לאיך זה עובד, באדיבות הספר של Stanely:
&lt;img src=&quot;/assets/img/2025/trees_bijaction_diragram.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;בצד שמאל יש לנו עץ סדור ובצד ימין יש לנו את העץ הבינארי שמתאים לו, כשבמרכז יש לנו איזה שהוא “ייצוג ביניים” שמסביר איך מקבלים אחד מהשני. איך זה עובד? נתחיל מהעץ הסדור בצד השמאל ונבצע עליו את הפעולות הבאות:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;לכל צומת, נחבר כל בן של הצומת לבן הבא בתור של הצומת בקו מקוווקו.&lt;/li&gt;


&lt;li&gt;לכל צומת, נמחק את כל הקשתות ממנו לבנים שלו חוץ מאשר לבן השמאלי ביותר.&lt;/li&gt;


&lt;li&gt;נמחק את צומת השורש מהגרף.&lt;/li&gt;


&lt;li&gt;נהפוך את הקווים המקווקווים לקווים רגילים.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;במילים אחרות, כל צומת “איבד” את כל הבנים שלו חוץ מאחד, אבל “הרוויח” את אחד האחים שלו (אם יש כזה). הבנים של הצומת שנותקו לא הלכו לאיבוד כי כולם עדיין מחוברים אל הבן שלא נותק, והעץ בינארי כי עכשיו לכל צומת יש לכל היותר שני בנים: הבן השמאלי המקורי שלו (אם היו לו בנים) והאח שמימין לו (אם היה לו כזה).&lt;/p&gt;

&lt;p&gt;למה זו התאמה חח”ע ועל? כי אפשר &lt;strong&gt;להפוך&lt;/strong&gt; אותה, כלומר מכל עץ בינארי לקבל עץ סדור, ובצורה כזו שאם נתחיל מעץ סדור, נהפוך אותו לבינארי ואז חזרה לעץ סדור, אכן נחזור לעץ שהתחלנו ממנו. הנה השיטה:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;נוסיף לגרף צומת חדש שיהיה מחובר לבן שמאלי יחיד - השורש של הגרף המקורי.&lt;/li&gt;


&lt;li&gt;לכל צומת, אם יש לו בן ימני נהפוך את הקו שמחבר אותם למקווקו.&lt;/li&gt;


&lt;li&gt;לכל צומת &lt;span&gt;\( a \)&lt;/span&gt;, אם יש לו בן שמאלי &lt;span&gt;\( b \)&lt;/span&gt;, נלך ימינה על גבי הקווים המקווקווים החל מ-&lt;span&gt;\( b \)&lt;/span&gt; ונהפוך כל צומת שנפגוש בדרך לבן של הצומת &lt;span&gt;\( a \)&lt;/span&gt;, כשהסדר שלהם הוא כמו הסדר שבו פוגשים אותם על המסלול (&lt;span&gt;\( b \)&lt;/span&gt; נותר הבן הכי שמאלי).&lt;/li&gt;


&lt;li&gt;נמחק את הקווים המקווקווים מהגרף.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;קל לראות שזה באמת עובד - ובחיי שזו התאמה מרהיבה.&lt;/p&gt;

&lt;h2&gt;דברים שלא נחתכים&lt;/h2&gt;

&lt;p&gt;בואו נראה עוד תמונה של 14 דברים!
&lt;img src=&quot;/assets/img/2025/nonintersecting_chords_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה שיש לנו כאן הוא קבוצות של 8 נקודות &lt;strong&gt;על מעגל&lt;/strong&gt;. אני לא מצייר את המעגל כי הוא רק מקשה להבין מה קורה פה, אבל מכאן הנקודות מגיעות. חלק מהנקודות מחוברות בקווים שעוברים בתוך המעגל - &lt;strong&gt;מיתרים&lt;/strong&gt;. הפואנטה פה היא שאנחנו מחלקים את הנקודות לזוגות, ובין כל זוג מעבירים מיתר, כך שהמיתרים &lt;strong&gt;לא נחתכים&lt;/strong&gt;. עבור &lt;span&gt;\( n \)&lt;/span&gt; מיתרים שאנחנו מעבירים דרך &lt;span&gt;\( 2n \)&lt;/span&gt; נקודות נקבל &lt;span&gt;\( C_{n} \)&lt;/span&gt; אפשרויות שונות לעשות את זה.&lt;/p&gt;

&lt;p&gt;אם מנסים לפרמל את זה די מהר רואים דרך פשוטה לתאר סיטואציה של “היחתכות” בלי גאומטריה: אם אני אמספר את הנקודות על ידי &lt;span&gt;\( 1,2,\ldots,2n \)&lt;/span&gt;, אז המיתר &lt;span&gt;\( \left(a,b\right) \)&lt;/span&gt; חותך את המיתר &lt;span&gt;\( \left(c,d\right) \)&lt;/span&gt;, כאשר אני מניח בלי הגבלת הכלליות ש-&lt;span&gt;\( a&amp;lt;c \)&lt;/span&gt;, רק אם &lt;span&gt;\( c&amp;lt;b \)&lt;/span&gt; וגם &lt;span&gt;\( d&amp;gt;b \)&lt;/span&gt;. בניסוח שונה, אם אני אתאר את נקודות ההתחלה והסיום של אחד המיתרים עם סוגריים עגולים ושל מיתר אחר עם סוגריים מרובעים, אז הסיטואציה הבאה מובילה לחיתוך: &lt;span&gt;\( )[(] \)&lt;/span&gt;, וזאת להבדיל מ-&lt;span&gt;\( \left(\right)\left[\right] \)&lt;/span&gt; שהיא בסדר (זה &lt;span&gt;\( c&amp;gt;b \)&lt;/span&gt;) או &lt;span&gt;\( \left(\left[\right]\right) \)&lt;/span&gt; שהיא גם בסדר (זה &lt;span&gt;\( d&amp;lt;b \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;כדי להוכיח שזה שקול למשהו שאנחנו כבר מכירים, בואו נעבור לייצוג ביניים שהוא בעיה מעניינת בפני עצמה:
&lt;img src=&quot;/assets/img/2025/nonintersecting_arcs_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כאן אנחנו מציירים &lt;span&gt;\( 2n \)&lt;/span&gt; נקודות &lt;strong&gt;בשורה&lt;/strong&gt; ומחברים אותן בקשתות שלא נחתכות. זה באופן מובהק אותו הדבר בדיוק כמו הנקודות על המעגל, אבל הציור שונה (ולשם שינוי קשה לי לסדר אותו בשתי שורות של שבע פריטים כל אחת, כי כל שורת נקודות כזו היא די ארוכה).&lt;/p&gt;

&lt;p&gt;הרעיון הוא להתאים לכל סידור כזה מילת דיק, שאציג בתור סדרת סוגריים מאוזנת - כלומר, סדרה של אותו מספר של “)”{} ו-“(“ כך שבכל רישא אין יותר “(“ מאשר “)”. הנה איך זה עובד:
&lt;img src=&quot;/assets/img/2025/nonintersecting_arcs_example.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;הרעיון פשוט: לכל נקודה, אם היא &lt;strong&gt;הראשונה&lt;/strong&gt; בזוג שלה, שמים “)”{} ואם היא &lt;strong&gt;השניה&lt;/strong&gt; שמים “(“, כשהולכים משמאל לימין. מכיוון שיש לנו חלוקה של &lt;span&gt;\( 2n \)&lt;/span&gt; הנקודות ל-&lt;span&gt;\( n \)&lt;/span&gt; זוגות יהיו לנו בסך הכל &lt;span&gt;\( n \)&lt;/span&gt; מופעים של כל סוג סוגריים, אבל למה התנאי על הרישא מתקיים? זה די פשוט: בכל פעם שמופיע “(“ זה בגלל שהנקודה שמעליו &lt;strong&gt;היא השניה בזוג&lt;/strong&gt;, כלומר בשלב מוקדם יותר פגשנו את הנקודה הראשונה שהתאימה לה ואז כתבנו “)”. לכן ההתאמה עובדת - אנחנו תמיד מקבלים מילת דיק חוקית.&lt;/p&gt;

&lt;p&gt;כדי להשלים את ההתאמה צריך להסביר את הכיוון השני - איך בונים ממילת דיק התאמה כזו של נקודות לזוגות? גם זה קל: מעל כל אות במילת הדיק מציירים נקודה, ואז עוברים עליהן משמאל לימין. בכל פעם שבה נתקלים ב-“(“, מתחילים ללכת שמאלה שוב עד שמגיעים אל הנקודה הראשונה שטרם חוברה למישהו. היא בודאות תהיה מסומנת ב-“)”{} כי כאמור, בכל פעם שבה אנחנו נתקלים ב-“(“ אנחנו מייד מחברים את הנקודה שלו למישהו. התנאי על הרישות של מילות דיק מבטיח שתמיד נמצא &lt;strong&gt;מישהו&lt;/strong&gt; להתחבר אליו, ומכיוון שאנחנו תמיד מתחברים לנקודה הפנויה הראשונה שאנחנו מגיעים אליה לא יכולים להיווצר חיתוכים.&lt;/p&gt;

&lt;p&gt;כדי לראות את זה, בואו נחשוב שאני הנקודה &lt;span&gt;\( b \)&lt;/span&gt; ואני מתחיל ללכת שמאלה כדי לחפש מישהו להתחבר אליו עד שאני מוצא &lt;span&gt;\( a \)&lt;/span&gt; פנוי. עכשיו, האם ייתכן שיש נקודות &lt;span&gt;\( c,d \)&lt;/span&gt; כך ש-&lt;span&gt;\( a&amp;lt;c&amp;lt;b&amp;lt;d \)&lt;/span&gt;? לא! כי אם &lt;span&gt;\( c \)&lt;/span&gt; מחוברת ל-&lt;span&gt;\( d \)&lt;/span&gt; זה אומר שבזמן ש-&lt;span&gt;\( d \)&lt;/span&gt; חיפש אל מי להתחבר, &lt;span&gt;\( c \)&lt;/span&gt; הייתה &lt;strong&gt;פנויה&lt;/strong&gt;, אבל אם זה היה המצב - למה &lt;span&gt;\( b \)&lt;/span&gt; לא התחברה אליה אלא המשיכה עד &lt;span&gt;\( a \)&lt;/span&gt;? אוקיי, אז &lt;span&gt;\( a&amp;lt;c&amp;lt;b&amp;lt;d \)&lt;/span&gt; הוא בלתי אפשרי. מה בדבר &lt;span&gt;\( c&amp;lt;a&amp;lt;d&amp;lt;b \)&lt;/span&gt;? במקרה הזה, מאותו שיקול, &lt;span&gt;\( d \)&lt;/span&gt; לא הייתה יכולה להיות מחוברת אל &lt;span&gt;\( c \)&lt;/span&gt; כי היא הייתה מתחברת אל &lt;span&gt;\( a \)&lt;/span&gt; לפני כן. זה מסיים את ההוכחה.&lt;/p&gt;

&lt;h2&gt;מגדלי קפלר&lt;/h2&gt;

&lt;p&gt;שמרתי לסוף את הדבר הכי חדש והכי מוזר: מגדלי קפלר.
&lt;img src=&quot;/assets/img/2025/kepler_towers_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה הולך כאן? כרגע זה בעיקר מזכיר לי את הסמל של ערוץ 1 העתיק, אבל חלק מהעניין הוא שבמקרה הזה, המגדלים מגודל 4 הם קטנים מדי מכדי שאפשר יהיה להסביר בצורה טובה את ההגדרה הכללית, אז אלך על דוגמא מורכבת יותר. המגדלים הוצגו במאמר Three Catalan Bijections של דונלד קנות’ שמספר שהם הומצאו בפברואר 2005 (חדשים!) על ידי Xavier Viennot שנתן להם את שמם. למה “קפלר”? קנות’ מסביר שזה בגלל שהדיאגרמה של מגדל קפלר (כמו אלו שרואים למעלה) מזכירה את מודל מערכת השמש של קפלר.
&lt;img src=&quot;/assets/img/2025/kepler_tower_example.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כדי לעזור להבין את הדוגמא הזו אני כבר אספר שאפשר לתאר מגדל קפלר בצורה פשוטה גם בתור רשימה של רשימות של רשימות של מספרים - פשוט! במקרה שלנו, המגדל הוא &lt;span&gt;\( T=\left(W_{1},W_{2},W_{3}\right) \)&lt;/span&gt; כאשר &lt;span&gt;\( W_{1}=\left[\left(1\right),\left(2\right),\left(3\right)\right] \)&lt;/span&gt; ו-&lt;span&gt;\( W_{2}=\left[\left(1,3\right),\left(4\right),\left(1,3\right)\right] \)&lt;/span&gt; ו-&lt;span&gt;\( W_{3}=\left[\left(1,3,5,7\right),\left(1,4,7\right),\left(3,8\right),\left(2,4,7\right),\left(1,7\right)\right] \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, כפי שאפשר לראות מהתמונה, מגדל קפלר מורכב מאוסף של מעגלים. כל מעגל כזה מכונה &lt;strong&gt;טבעת&lt;/strong&gt; (Ring) ואפשר לראות שיש בכל טבעת קשתות שחורות בולטות. הקשתות הללו מכונות &lt;strong&gt;לבנים&lt;/strong&gt; (Bricks) והן מה שאנחנו סופרים: יש בדיוק &lt;span&gt;\( C_{n} \)&lt;/span&gt; מגדלי קפלר עם &lt;span&gt;\( n \)&lt;/span&gt; לבנים.&lt;/p&gt;

&lt;p&gt;עכשיו, אפשר גם לראות שהטבעות מאוגדות בקבוצות, עם רווחים גדולים שמסמנים מתי קבוצה אחת נגמרת והבאה בתור מתחילה. כל קבוצה כזו מכונה &lt;strong&gt;חומה&lt;/strong&gt; (Wall). האינטואיציה הציורית שלנו יכולה להיות זו: חומה היא הדבר הרגיל שאנחנו חושבים עליו - אוסף של לבנים שמונחות בשכבות אחת מעל השניה. במקרה הזה השכבות הן מעגליות, וכל שכבה מכונה “טבעת” ומכילה כמה “לבנים”. קנות’ מציע לנו לחשוב על הלבנים כאילו הן עשויות מלגו, כך שאפשר “להדביק” לבנים זו לזו, כך שכדי שלבנה לא תיפול מספיק שתהיה מתחתיה לבנה במקום כלשהו, אפילו אם מרכז המסה שלה בולט החוצה.&lt;/p&gt;

&lt;p&gt;בואו נעבור לדבר על זה קצת יותר פורמלי. בצורת הרישום &lt;span&gt;\( T=\left(W_{1},W_{2},\ldots,W_{m}\right) \)&lt;/span&gt; כל &lt;span&gt;\( W_{k} \)&lt;/span&gt; כזה הוא חומה, וכל חומה היא מהצורה &lt;span&gt;\( W_{k}=\left(R_{1}^{k},R_{2}^{k},\ldots,R_{t_{k}}^{k}\right) \)&lt;/span&gt;, כלומר כל חומה היא רשימה של טבעות, ובחומות שונות יכולים להיות מספרים שונים של טבעות. המוסכמה היא שאנחנו מתחילים מהמרכז ומתקדמים החוצה - כלומר, החומה הראשונה היא זו שהכי פנימית, והטבעת הראשונה בכל חומה היא זו שהכי פנימית וכן הלאה.&lt;/p&gt;

&lt;p&gt;עכשיו, מה יש בכל טבעת? כאן העניינים מתחילים להסתבך. קונספטואלית, אנחנו מחלקים את המעגל לחלקים, וכל טבעת מכילה לבנים שהן חלק מהחלקים הללו. השאלה &lt;strong&gt;לכמה&lt;/strong&gt; חלקים מחלקים את המעגל תלויה במספר החומה הנוכחי. בחומה הראשונה, כל המעגלים מחולקים ל-2 חלקים. בחומה השניה הם מחולקים ל-4 חלקים; בשלישית ל-8 וכן הלאה עם חזקות של 2. בניסוח פורמלי, &lt;span&gt;\( R_{i}^{k}\subseteq\left[2^{k}\right] \)&lt;/span&gt;, כאשר הסימון &lt;span&gt;\( \left[n\right] \)&lt;/span&gt; הוא סימון סטנדרטי ל-&lt;span&gt;\( \left\{ 1,2,3,\ldots,n\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, החוק שמגדיר את מגדלי קפלר קובע שבכל חומה, הטבעת הראשונה תמיד מכילה בדיוק את כל הלבנים האי-זוגיות, כלומר &lt;span&gt;\( R_{1}^{k}=\left\{ 1,3,5,\ldots,2^{k}-1\right\}  \)&lt;/span&gt;. כל טבעת אחרת יכולה להכיל איזה מספרים שרוצים, אבל יש &lt;strong&gt;שתי מגבלות&lt;/strong&gt;. כדי להבין איך הן נראות באופן ציורי, תעיפו לרגע מבט בציור - אפשר לראות שאני מצייר לבנים לא בתור בדיוק חצי עיגול, רבע עיגול וכו’ אלא &lt;strong&gt;קצת יותר מזה&lt;/strong&gt;, כאילו הוספתי צ’ופצ’יקים בקצוות. זה אומר שאם היו לי שתי לבנים סמוכות באותה טבעת הן היו עולות אחת על השניה &lt;strong&gt;וזה אסור&lt;/strong&gt;. זה גם אומר שאם יש לי בטבעת אחת לבנה במקום &lt;span&gt;\( x \)&lt;/span&gt; ובטבעת שלפניה לבנה במקום &lt;span&gt;\( x+1 \)&lt;/span&gt; או &lt;span&gt;\( x-1 \)&lt;/span&gt;, זה נראה שהן עולות אחת על השניה. אז הנה החוקים:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;אסור שבאותה טבעת יהיו שתי לבנים שעולות זו על זו. כלומר, אם &lt;span&gt;\( x\in R_{i}^{k} \)&lt;/span&gt; אז &lt;span&gt;\( x-1,x+1\notin R_{i}^{k} \)&lt;/span&gt;, כאשר פעולות החשבון הן מודולו &lt;span&gt;\( 2^{k} \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;אם בטבעת שאיננה הראשונה בחומה יש לבנה כלשהי, היא חייבת להישען על לבנה בטבעת שלפניה. כלומר, אם &lt;span&gt;\( x\in R_{i+1}^{k} \)&lt;/span&gt; &lt;span&gt;\( x\in R_{i}^{k} \)&lt;/span&gt; או &lt;span&gt;\( x-1\in R_{i}^{k} \)&lt;/span&gt; או &lt;span&gt;\( x+1\in R_{i}^{k} \)&lt;/span&gt; כששוב, החשבון הוא מודולו &lt;span&gt;\( 2^{k} \)&lt;/span&gt;.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;זהו, זו כל ההגדרה! טיפה מסובך, אבל אין קושי עקרוני לכתוב קוד שבודק אם רשימה של רשימות של רשימות של מספרים הוא מגדל קפלר חוקי, או קוד שיודע לייצר את כל המגדלים עם &lt;span&gt;\( n \)&lt;/span&gt; לבנים (בצורה לא יעילה) וכדומה.&lt;/p&gt;

&lt;p&gt;מה שקנות’ עושה במאמר שלו הוא להראות התאמה חח”ע ועל מפורשת בין מגדלי קפלר עם &lt;span&gt;\( n \)&lt;/span&gt; לבנים ומסלולי דיק מאורך &lt;span&gt;\( 2n \)&lt;/span&gt;, ואני רוצה להציג את זה כאן, אם כי בצורה טיפה שונה ממה שקנות’ עושה. פישוט אחד שהוא לא קריטי אבל בהחלט יעזור לקוד שאני אציג להיות קצת פחות מסורבל הוא לשנות את איך שממספרים לבנים: במקום שהלבנים בקיר ה-&lt;span&gt;\( k \)&lt;/span&gt; יהיו &lt;span&gt;\( \left\{ 1,2,3,\ldots,2^{k}\right\}  \)&lt;/span&gt; אני אסמן אותן ב-&lt;span&gt;\( \left\{ 0,1,2,3,\ldots,2^{k}-1\right\}  \)&lt;/span&gt;. זה נוח, כי כשלוקחים דברים מודולו &lt;span&gt;\( 2^{k} \)&lt;/span&gt; מקבלים מספרים בקבוצה הזו; אם היינו מסתכלים על הקבוצה מ-&lt;span&gt;\( 1 \)&lt;/span&gt; עד &lt;span&gt;\( 2^{k} \)&lt;/span&gt; היינו צריכים טיפה לשנות את איך שעושים מודולו, וזה סתם מסרבל.&lt;/p&gt;

&lt;p&gt;הרעיון המבריק של קנות’ הולך ככה: אנחנו מסתכלים על מסלול דיק מאורך &lt;span&gt;\( 2n \)&lt;/span&gt;. אפשר לחשוב על מסלול כזה בתור סדרה של U ו-D כך ש-U הוא צעד למעלה-ימינה ו-D הוא צעד למטה-ימינה, והמסלול מתחיל בגובה 0, מסיים בגובה 0 ולא יורד מתחת לגובה 0 בשום שלב. הרעיון של קנות’ הוא עכשיו לשים “גבולות” - בגובה 1, בגובה 3, בגובה 7 וכן הלאה - בגובה &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt; לכל &lt;span&gt;\( k\ge0 \)&lt;/span&gt;. כעת, חומה מספר &lt;span&gt;\( k \)&lt;/span&gt; תיבנה על פי בסיס החלק של המסלול שמתחיל עם ההגעה הראשונה לגבול &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt; ומסתיים עם ההגעה הראשונה לגבול &lt;span&gt;\( 2^{k+1}-1 \)&lt;/span&gt;, או מסתיים בסוף המסלול אם לא מגיעים לגובה הזה.&lt;/p&gt;

&lt;p&gt;בואו נראה דוגמא:
&lt;img src=&quot;/assets/img/2025/dyck_split.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה שיש כאן הוא המסלול שמתאים למחרוזת הבאה:&lt;/p&gt;

&lt;p&gt;UUDUDUDDUUUDUDDUUDDDUDUDUUUUUDUUUDDDUDDDUUDUUDDDDD&lt;/p&gt;

&lt;p&gt;צבעתי את המסלול בשלושה צבעים - החלק הראשון בכחול, השני בירוק והשלישי באדום. הרעיון הוא שנשתמש בכל המסלול כדי לבנות מגדל קפלר: החומה הראשונה תיבנה על בסיס החלק הכחול, החומה השניה על בסיס החלק הירוק והשלישית על בסיס החלק האדום. מתי חלק מתחיל? החל מהפעם הראשונה שבה המסלול מגיע לקו הגבול שלו, ומרגע זה והלאה המסלול הקודם נזנח לאנחות. אפשר לראות שבאיור, הצעד הראשון צבוע בשחור - זה בגלל שעדיין לא הגענו אפילו לקו הגבול הראשון ולכן עוד לא התחלנו לבנות את החומות (אבל הצעד הראשון הוא תמיד למעלה ולכן תמיד נתחיל לבנות את החומה הראשונה מייד אחריו).&lt;/p&gt;

&lt;p&gt;הרעיון עכשיו הוא זה: בחומה מס’ &lt;span&gt;\( k \)&lt;/span&gt; יכולות להופיע לבנים שממוספרות ב-&lt;span&gt;\( 0,1,\ldots,2^{k}-1 \)&lt;/span&gt;, כלומר, מספרים שהם החל מ-0 וכלה בגובה של הגבול שהגעה אליו התחילה את המסלול שלנו. כפי שרואים טוב עם המסלול הירוק, המסלול יכול להיות &lt;strong&gt;מעל&lt;/strong&gt; הגבול, וגם &lt;strong&gt;מתחת&lt;/strong&gt; לגבול. בשני המקרים הללו העקרון הוא - אם המסלול ביצע צעד &lt;strong&gt;לכיוון הגבול&lt;/strong&gt;, אז הצעד הזה יתורגם להוספת לבנה לחומה; אחרת הוא לא ישפיע על המגדל שאותו בונים. כך למשל במסלול הירוק, הצעד הראשון הוא &lt;strong&gt;למטה&lt;/strong&gt; והוא מתרחק מהגבול, ולכן הצעד הזה &lt;strong&gt;לא&lt;/strong&gt; יוסיף לבנה למגדל; אבל הצד השני הוא &lt;strong&gt;למעלה&lt;/strong&gt; ומתקרב אל הגבול (ואפילו מגיע אליו) ולכן הוא כן יוסיף לבנה למגדל.&lt;/p&gt;

&lt;p&gt;איזו לבנה הולכים להוסיף? זה תלוי &lt;strong&gt;בגובה&lt;/strong&gt; של המקום שהגענו אליו אחרי הצעד. אם היינו &lt;strong&gt;מתחת&lt;/strong&gt; לגבול וביצענו צעד למעלה, אז נוסיף את הלבנה שהמספר שלה הוא כמו הגובה של המסלול. אם היינו &lt;strong&gt;מעל&lt;/strong&gt; הגבול וביצענו צעד אחד למטה, אז נוסיף את הלבנה שהמספר שלה הוא כמו הגובה של המסלול &lt;strong&gt;מעל הגבול&lt;/strong&gt;, כלומר אם הגבול הוא 3 ואנחנו בגובה 5, אז נוסיף את לבנה 2. ככה זה נראה בדוגמא שלנו:
&lt;img src=&quot;/assets/img/2025/dyck_split_with_nums.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;למשל, ה-0-ים בהתחלה מגיעים מכך שהקו הכחול שוב ושוב &lt;strong&gt;יורד&lt;/strong&gt; אל הגבול. אחר כך הוא חוצה אותו כלפי מטה ואז &lt;strong&gt;עולה&lt;/strong&gt; שוב - ולכן הפעם זה נספר בתור הגעה לגובה 1. או למשל, בחלק של הירוק שבו הוא מתחיל לעלות ולעלות הוא בהתחלה מוסיף את הלבנים 1,2,3 ואז פתאום מפסיק למרות שהעלייה נמשכת - למה? כי הוא חצה את קו הגבול 3, ומרגע שהוא חוצה אותו, לבנים חדשות מתווספות כשהוא &lt;strong&gt;יורד&lt;/strong&gt;, לא כשהוא עולה.&lt;/p&gt;

&lt;p&gt;מה בעצם הרעיון כאן? תסתכלו על המסלול הכחול: אסור לו לרדת מתחת ל-0 (כי כל מסלול דיק מקיים את זה) ו”אסור” לו להגיע אל 3 (כי בפעם הראשונה שבה הוא יגיע אל 3 הוא יהפוך להיות מסלול שונה, המסלול הירוק), כך שכל “מרחב התמרון” שלו הוא פס צר סביב קו הגבול 1: הוא יכול להיות ב-0,1,2 ולכן הלבנים שהוא יכול להוסיף &lt;strong&gt;מתחת&lt;/strong&gt; לגבול הן 0 ו-1 (הגבהים האפשריים שלו מתחת לגבול, עד שמגיעים אליו) והלבנים שהוא יכול להוסיף &lt;strong&gt;מעל&lt;/strong&gt; לגבול הן גם כן 0,1 (הגבהים שלו מעל הגבול הזה). כלומר, “מרחב התמרון” של המסלול הכחול מאפשר לו רק להוסיף לבנים עם המספר 0,1 ואלו &lt;strong&gt;בדיוק&lt;/strong&gt; הלבנים שיכולות להופיע בחומה הראשונה במגדל.&lt;/p&gt;

&lt;p&gt;המסלול השני, הירוק, מקבל מרחב תמרון רחב יותר ויכול להוסיף את הלבנים &lt;span&gt;\( 0,1,2,3 \)&lt;/span&gt; שהן בדיוק מה שיכול להופיע בחומה השניה במגדל, וכן הלאה.&lt;/p&gt;

&lt;p&gt;עכשיו, אפשר לשאול - בשביל מה זה טוב, שיש גם חלק &lt;strong&gt;מעל&lt;/strong&gt; וגם חלק &lt;strong&gt;מתחת&lt;/strong&gt; לקו הגבול, אם הם מייצרים את אותן לבנים בדיוק? ובכן, זה כל היופי פה: זה מאפשר למסלול ליצור לבנים &lt;strong&gt;כשהוא רוצה&lt;/strong&gt;. תראו למשל את הסיום של המסלול האדום - הוא &lt;strong&gt;חייב&lt;/strong&gt; לסיים בכך שהוא יורד עד 0, אבל מרגע שהוא מתחת לקו הגבול, עוד ירידה לא תוסיף לבנים - אז הצורך לרדת עד הסוף לא מכריח את המסלול להוסיף לבנים למגדל שהוא בונה. זה נותן לנו בדיוק את הגמישות שאנחנו צריכים כאן.&lt;/p&gt;

&lt;p&gt;אם כן, טוב ויפה, אבל מה זה בעצם אומר, “להוסיף לבנה”? איך בוחרים לאיזו טבעת להוסיף אותה? ובכן, זה קל: פשוט זורקים אותה ורואים מה קורה.&lt;/p&gt;

&lt;p&gt;בואו ניזכר איך חומה בנויה. ברגע שמתחילים חומה חדשה, כי המסלול הגיע לגובה מתאים חדש ושינה צבע, אוטומטית יוצרים חומה חדשה עם טבעת ראשונה שכוללת את כל המספרים שהטבעת הראשונה חייבת לכלול. כלומר, כשמגיעים לראשונה לגובה &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt; יוצרים חומה חדשה עם הטבעת &lt;span&gt;\( \left\{ 0,2,4,\ldots,2^{k}-2\right\}  \)&lt;/span&gt;. זה עדיין לא החלק של “להוסיף לבנים למגדל”, זה פשוט יוצר לנו את החומה הבסיסית שהמסלול יבנה מעליה.&lt;/p&gt;

&lt;p&gt;עכשיו, אם המסלול רוצה להוסיף את הלבנה &lt;span&gt;\( s \)&lt;/span&gt; למגדל, אנחנו עוברים על הטבעות במגדל מהעליונה ביותר אל התחתונה. לכל טבעת כזו, אם &lt;span&gt;\( s \)&lt;/span&gt; או &lt;span&gt;\( s+1 \)&lt;/span&gt; או &lt;span&gt;\( s-1 \)&lt;/span&gt; (מודולו &lt;span&gt;\( 2^{k} \)&lt;/span&gt;) נמצאות בה - “נתקענו” - אי אפשר להכניס את הלבנה לטבעת הזו (היא תתנגש באחת מהלבנים הללו) וגם אי אפשר לדחוף אותה דרכן אל טבעת נמוכה יותר כי הן חוסמות את הדרך (זו הצורה שבה כדאי לחשוב על זה כי זה נותן אינטואיציה למה הוספת לבנה מתנהגת כפי שהיא מתנהגת; הסיבה &lt;strong&gt;האמיתית&lt;/strong&gt; להתנהגות הזו היא כי ככה הבניה עובדת). אם אף אחת מהלבנים הללו לא נמצאת בטבעת, אפשר לעבור לטבעת הבאה בתור, הנמוכה יותר, ולראות אם גם שם אפשר להתקדם או שנתקעים. בסופו של דבר מוסיף את הלבנה החדשה לטבעת הנמוכה ביותר שמצאנו שאפשר להוסיף את &lt;span&gt;\( s \)&lt;/span&gt; אליה - או, אם לא הייתה כזו, פותחים טבעת חדשה שכוללת רק את &lt;span&gt;\( s \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;זהו, זו כל הבניה! הנה קוד פייתון שעושה את הכל ואני מקווה שברור וחף מבאגים:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# new ring
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
     
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generate_kepler_tower_from_dyck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_border&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;add_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;add_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_wall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;השאלה הראשונה שאנחנו צריכים לשאול את עצמנו היא אם הבניה הזו באמת נותנת מגדל קפלר, אבל ברור שהיא עושה את זה כי כללי הוספת הלבנים שלנו מבטיחים שתמיד יהיה לנו מגדל חוקי - אנחנו מוסיף במפורש את הטבעת הראשונה בכל חומה, וכשאנחנו מוסיפים לבנה אנחנו מקפידים שהיא תיכנס למקום שבו מותר לה להיות, ובטבעת שמתחתיה היא כבר לא יכולה להיכנס כי יש שם לבנה &lt;strong&gt;שעליה היא יכולה להישען&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;שאלה קצת יותר טריקית היא למה מסלול מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; נותן מגדל קפלר עם בדיוק &lt;span&gt;\( n \)&lt;/span&gt; לבנים. בדוגמא שראינו למעלה, המסלול שלי היה מאורך 50, כלומר &lt;span&gt;\( n=25 \)&lt;/span&gt;. אם סופרים את הלבנים שהמסלולים מוסיפים (המספרים שמתחת למסלולים, באיור השני) מגיעים ל-18. איפה הלבנים החסרות? ובכן, בטבעת הראשונה בכל חומה. יש לנו שלוש חומות. בחומה הראשונה הטבעת הראשונה היא &lt;span&gt;\( \left\{ 0\right\}  \)&lt;/span&gt;, בשניה היא &lt;span&gt;\( \left\{ 0,2\right\}  \)&lt;/span&gt; ובשלישית היא &lt;span&gt;\( \left\{ 0,2,4,6\right\}  \)&lt;/span&gt;. בסך הכל קיבלנו את שבע הלבנים החסרות - אבל איך בדיוק אנחנו יודעים שזה לא הסתדר בפוקס?&lt;/p&gt;

&lt;p&gt;בואו נדמיין לרגע שהמסלול שלנו כולו מאותו צבע. במסלול הזה, בכל פעם שאנחנו מבצעים צעד “למעלה”, יהיה אי שם בהמשך צעד “למטה” שיקזז אותו, כי בסוף אנחנו חוזרים אל 0. אני אחדד: אם היה לנו צעד “למעלה” שהעלה אותנו מגובה &lt;span&gt;\( h \)&lt;/span&gt; אל גובה &lt;span&gt;\( h+1 \)&lt;/span&gt;, יהיה צעד “למטה” שיוריד אותנו מגובה &lt;span&gt;\( h+1 \)&lt;/span&gt; אל גובה &lt;span&gt;\( h \)&lt;/span&gt;. עכשיו, אם הצעדים הללו התבצעו &lt;strong&gt;מתחת לגבול&lt;/strong&gt; אז צעד ה”למעלה” הוסיף לבנה וצעד ה”למטה” לא הוסיף; ואם הם התבצעו &lt;strong&gt;מעל לגבול&lt;/strong&gt; אז צעד ה”למטה” הוסיף וצעד ה”למעלה” לא הוסיף. בשני המקרים בדיוק חצי מהצעדים שלנו הוסיפו לבנה.&lt;/p&gt;

&lt;p&gt;אם נסתכל על האיור שבדוגמא, קל להיזכר שיש חריג - הצעד הראשון, שהוא צעד “למעלה” אל הגבול אבל הוא לא מוסיף לבנה, כי בשלב הזה המסלול הכחול עוד לא קיים. זה מתקזז עם העובדה שכשהגענו לגבול, יצרנו חומה חדשה עם טבעת ראשונה &lt;span&gt;\( \left\{ 0\right\}  \)&lt;/span&gt;. זה גם מה שהולך לקרות &lt;strong&gt;באופן כללי&lt;/strong&gt; כשיש לנו מסלול שמשנה צבע: כשהמסלול הירוק הגיע לגובה 7 ושינה את הצבע שלו, מה שקרה הוא שנוצרו אצלו צעדים שקודם &lt;strong&gt;לא הוסיפו&lt;/strong&gt; לבנים אבל עכשיו יתקזזו עם עוד צעדים ש&lt;strong&gt;לא יוסיפו&lt;/strong&gt; לבנים: הצעדים החל מהגבול ומעלה, כלומר &lt;span&gt;\( 3\to4\to5\to6\to7 \)&lt;/span&gt;. ארבעה צעדים שעכשיו כשיתבצעו בכיוון ההפוך גם כן לא יוסיפו לבנים - אבל עכשיו מתקזזים עם העובדה שהמסלול האדום נפתח עם הוספת הטבעת &lt;span&gt;\( \left\{ 0,2,4,6\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;זה קורה גם באופן כללי: אם היה לנו מסלול סביב קו הגבול &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt; והוא הגיע אל &lt;span&gt;\( 2^{k+1}-1 \)&lt;/span&gt; אז “איבדנו” את כל הצעדים &lt;span&gt;\( 2^{k}-1\to2^{k}\to\ldots\to2^{k+1}-1 \)&lt;/span&gt;, כלומר &lt;span&gt;\( 2^{k} \)&lt;/span&gt; צעדים; אבל אז אנחנו יוצרים קיר חדש שבטבעת הראשונה שלו יש את &lt;span&gt;\( \left\{ 0,2,\ldots,2^{k+1}-2\right\}  \)&lt;/span&gt;, כלומר בדיוק &lt;span&gt;\( 2^{k} \)&lt;/span&gt; הלבנים שהיו חסרות לנו.&lt;/p&gt;

&lt;p&gt;זה מוכיח שקיבלנו פונקציה ממסלולי דיק מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; אל מגדלי קפלר מגודל &lt;span&gt;\( n \)&lt;/span&gt;. כדי להראות שהיא חח”ע ועל, צריך להסביר איך להפוך אותה.&lt;/p&gt;

&lt;p&gt;הרעיון הוא די פשוט: בהינתן מגדל קפלר, נבנה את המסלול שיוצר אותו “מהסוף להתחלה”, על ידי כך שנפרק לאט ובזהירות את החומות של המגדל. אם נעקוב אחרי הגובה הנוכחי של המסלול, נוכל לראות שבהינתן הגובה הזה והמצב הנוכחי של המגדל, יש בדיוק אפשרות אחת למצב של המגדל והגובה של המסלול בצעד הקודם שהביאו אותנו לכאן.&lt;/p&gt;

&lt;p&gt;בואו נחזור למסלול שראינו קודם. כשמייצרים ממנו מגדל קפלר, מקבלים את זה:
&lt;img src=&quot;/assets/img/2025/kepler_tower_from_dyck.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אנחנו רוצים להבין איך אפשר לקבל ממנו בחזרה את המסלול הזה:
&lt;img src=&quot;/assets/img/2025/dyck_split.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כאמור - אני ארכיב את המסלול מהסוף להתחלה. בשביל זה צריך לדעת בכל רגע נתון מה קו הגבול הנוכחי, שקובע איזו לבנה מוסיפים למגדל. עבור המסלול האדום קו הגבול הזה הוא ב-7. איך אפשר לדעת את זה רק מהסתכלות על מגדל הקפלר שלנו? אנחנו סופרים כמה &lt;strong&gt;חומות&lt;/strong&gt; יש בו - כאן יש שלוש, מה שאומר שהחומה החיצונית ביותר, זו שאנחנו מתחילים מלפרק אותה, זו שתיתן את המסלול האדום - מורכבת מהלבנים &lt;span&gt;\( \left\{ 0,1,2,\ldots,2^{3}-1\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, אנחנו זוכרים בכל רגע נתון מה הגובה הנוכחי של המסלול שאנחנו משחזרים מהסוף להתחלה, ומה המצב הנוכחי של המגדל (שאמור להיות תואם את המצב של המגדל כשהוא נבנה על ידי המסלול המקורי עד שהוא מגיע בדיוק אל הנקודה בשחזור שבה אנחנו נמצאים). אנחנו מתחילים מגובה 0. אם אני בגובה 0, מה היה הצעד הקודם? זה היה &lt;strong&gt;חייב&lt;/strong&gt; להיות צעד D כי אם זה היה צעד U, והצעד הזה הביא אותי לגובה 0, זה אומר שקודם הייתי בגובה &lt;span&gt;\( -1 \)&lt;/span&gt; וזה בלתי אפשרי. באופן דומה, אם במהלך הבניה של המסלול האדום הייתי איכשהו מטפס עד לגובה 14, הייתי יודע שהצעד הקודם היה חייב להיות U, כי צעד D היה אומר שקודם הייתי בגובה 15 &lt;strong&gt;וזה היה יוצר מסלול חדש&lt;/strong&gt;, עם חומה חדשה - יותר חומות מאשר יש במגדל. אז אלו שני מקרי הקיצון שבהם אנחנו יודעים בדיוק מה חייב לקרות אפילו בלי לבדוק מה הולך עם הלבנים שבתוך המגדל שלנו - ובשני המקרים הללו, הצעדים שעושים הם &lt;strong&gt;לכיוון&lt;/strong&gt; קו הגבול שבאמצע ולכן לא מוסיפים לבנים, ולכן אין לי מה &lt;strong&gt;להסיר&lt;/strong&gt; לבנים מהמגדל שאני מפרק.&lt;/p&gt;

&lt;p&gt;יש עוד אפשרויות. אם אני בגובה &lt;span&gt;\( s \)&lt;/span&gt; שהוא 1 לפחות אבל עדיין מתחת לקו האמצע, יכלתי להגיע לגובה הזו או בפעולת D שלא הייתה מוסיפה לבנה למגדל, או בפעולת U שכן הייתה מוסיפה - והיא הייתה מוסיפה בדיוק את הלבנה &lt;span&gt;\( s \)&lt;/span&gt;, כי זה מה שקורה כשאנחנו מתחת לקו האמצע, אנחנו מוסיפים לבנה ששווה לגובה שהגענו אליו &lt;strong&gt;אחרי&lt;/strong&gt; ביצוע הצעד. אז אנחנו מנסים להסיר מהמגדל שלנו את הלבנה &lt;span&gt;\( s \)&lt;/span&gt;, כלומר בודקים אם היא נמצאת בחומה הנוכחית, במיקום שבו אין לבנים אחרות שיושבות עליה, באחת מהטבעות &lt;strong&gt;מעל&lt;/strong&gt; הטבעת הראשונה (הטבעת הראשונה כזכור נבנית בצורה שונה). אם היא שם, אנחנו מסירים אותה ומסמנים שבוצע צעד U, ואחרת פשוט מסמנים שבוצע צעד D, ומעדכנים את הגובה שלנו בהתאם (אם בוצע צעד U אנחנו &lt;strong&gt;מקטינים&lt;/strong&gt; את הגובה, כי הרי אנחנו רוצים לדעת באיזה גובה היינו &lt;strong&gt;קודם&lt;/strong&gt;). באופן דומה מטפלים גם במקרה שבו אנחנו מעל קו האמצע.&lt;/p&gt;

&lt;p&gt;המקרה הכי בעייתי הוא זה שהוא אנחנו נמצאים &lt;strong&gt;בדיוק&lt;/strong&gt; על קו האמצע. במקרה הזה יש שתי אפשרויות שונות להגעה לשם, ששתיהן מוסיפות לבנה למגדל - או עלייה למעלה שמוסיפה את הלבנה &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt;, או ירידה למטה שמוסיפה את הלבנה 0. אז מנסים לחלץ מהמגדל את שתי הלבנים הללו ורואים איזו מהן הצליחה. ברור ש&lt;strong&gt;רק אחת&lt;/strong&gt; היא אפשרית, כי שתי הלבנים הללו הן שכנות ולכן מתנגשות אחת עם השניה ולא יכולות להיות באותה טבעת, ולכן אם הן נמצאות במגדל, אחת נמצאת גבוה יותר והיא זו שתקבע לנו איזה מהלך אנחנו משחזרים. אבל למה בעצם שאחת משתיהן תהיה במגדל? אי אפשר להנדס מגדלים שבהם זה לא קורה? זה הטיעון הכי עדין כאן: אפשר להראות שאלא אם החומה התרוקנה למעט הטבעת הראשונה, זה לא יכול לקרות כי &lt;strong&gt;בדרך&lt;/strong&gt; אל קו האמצע הזה היינו מרוקנים מהחומה כל לבנה שלא תקועה - חוץ מאשר הלבנים &lt;span&gt;\( 0,2^{k-1} \)&lt;/span&gt; שאפשר להוציא רק כשמגיעים לאמצע, וכל לבנה אחרת שאי אפשר להוציא כי אחת משתי הלבנים הללו חוסמת אותה. זה טיעון קצת מעצבן להוכחה פורמלית אבל הוא עובד; כל מה שנשאר לעשות הוא לדבר על מה שקורה כשמגיעים לאמצע כשהחומה ריקה חוץ מהטבעת הראשונה, וברור מה עושים בשלב הזה - מעיפים את החומה ומתחילים לשחזר את המסלול מהצבע הבא (כלומר, הקודם).&lt;/p&gt;

&lt;p&gt;הנה קוד (חף מבאגים, אני מקווה - היו בו כל כך הרבה בהתחלה!) שעושה את זה:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# we are trying to understand if it&apos;s possible that s was the latest brick added to the tower
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# for this, it&apos;s not enough that it&apos;s IN the tower, the way for it must be clear, meaning no s+1 and no s-1 in the way
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# print(f&quot;Trying to remove brick {s} from wall {wall}, num_segments={num_segments}&quot;)
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;reversed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# skip the first ring, it&apos;s not touched by add_brick()
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# if the ring is empty, remove it
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generate_dyck_from_kepler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deepcopy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# we&apos;re going to remove bricks
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# go over the walls from last to first
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# continue until wall is empty except the first ring
&lt;/span&gt;            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# we&apos;re near the next border. we can&apos;t reach it, otherwise the tower would have had more walls
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# we&apos;re at the bottom, we can&apos;t go down anymore
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# if s_down is in the tower, we made a &quot;down&quot; move, else nothing
&lt;/span&gt;                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# if s_up is in the tower, we made an &quot;up&quot; move, else nothing
&lt;/span&gt;                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# we reached the border either by &quot;down&quot; from above, and then s_down is in the tower, or by &quot;up&quot; from below, and then s_up is in the tower
&lt;/span&gt;                &lt;span class=&quot;c1&quot;&gt;# they can&apos;t both be in the tower since in this case, s_down = 1 and s_up = current_border + 1, which are adjacent (modulo current_border + 1)
&lt;/span&gt;                &lt;span class=&quot;c1&quot;&gt;# print(&quot;height == current_border, so we are at the border, trying to remove bricks&quot;, s_down, s_up)
&lt;/span&gt;                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;This should not happen&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# first step is always U
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;reversed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;זה מסיים את הסיפור מבחינתי, אבל מספרי קטלן לא נגמרים שם - הספר של Stanely עמוס בשלל דוגמאות אחרות (אם כי חייבים להודות שרובן הן פשוט וריאציות עם כל מני מגבלות ופרמטרים על אותה בעיה), אבל שולי הפוסט הזה כבר צרים מלהכילן.&lt;/p&gt;</content><author><name></name></author><category term="מספרי קטלן" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">אז למה 1=…0.999?</title><link href="http://gadial.net/2025/03/15/why_0999_equals_1/" rel="alternate" type="text/html" title="אז למה 1=...0.999?" /><published>2025-03-15T00:00:00+00:00</published><updated>2025-03-15T00:00:00+00:00</updated><id>http://gadial.net/2025/03/15/why_0999_equals_1</id><content type="html" xml:base="http://gadial.net/2025/03/15/why_0999_equals_1/">&lt;h2&gt;פרק א&apos;, ובו אני מנסה להשתמש בשוויון מוזר כדי לשכנע שיש על מה לדבר פה&lt;/h2&gt;

&lt;p&gt;בראשית ימי הבלוג היה לי &lt;a href=&quot;https://gadial.net/2008/06/07/almost_1_is_one/&quot;&gt;פוסט&lt;/a&gt; על הויכוח המפואר סביב השוויון &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt;. באותם ימים עוד ניסיתי לקצר ולכן הפוסט לא עמד בפני עצמו אלא היה תלוי ב&lt;a href=&quot;https://gadial.net/2008/06/17/infinite_series/&quot;&gt;פוסט ההמשך&lt;/a&gt; שלו ואיכשהו יצא שאני לא הכי מרוצה משניהם ולכן בואו נדבר שוב על השוויון המוזר הזה, בתקווה ברמת העמקה גדולה יותר מאשר אז.&lt;/p&gt;

&lt;p&gt;מבחינה מתמטית &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; הוא שוויון פשוט, כמעט טריוויאלי, אבל איכשהו יוצא שכל כמה זמן אני נתקל בעוד דיון סביבו שבו נזרקים לחלל האוויר הרבה טיעונים למה השוויון הזה לא נכון, חלקם יפים מאוד, שאף אחד מהם לא באמת יכול לעבוד כי כולם מפספסים את ההגדרות שבבסיס הדיון - וחלק מהעניין הוא שאלו אכן הגדרות לא טריוויאליות שאין סיבה שאנשים לא מתמטיים לא יכירו (אבל! למה שלאנשים לא מתמטיים תהיה דעה מוצקה על &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt;?).&lt;/p&gt;

&lt;p&gt;אוהבים לומר, למשל, ש-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא “המספר הכי קרוב ל-1 שאינו 1”, או ש-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא “תהליך” אבל לא מספר, וכו’. אלו, כאמור, רעיונות יפים - אולי אפילו יפים &lt;strong&gt;מדי&lt;/strong&gt; כי הם מכניסים למתמטיקה עוד תוכן שלא באמת יש בה. בפועל &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא לא תהליך אלא מספר ממשי תמים, שמיוצג בייצוג עשרוני כמו כל המספרים הממשיים, ופשוט בגלל איזה צ’ופצ’יק מוזר של שיטת הייצוג העשרוני של מספרים יוצא שלחלק מהמספרים (להמון, כפי שעוד נראה) יש שני ייצוגים שונים.&lt;/p&gt;

&lt;p&gt;ובכן, הדרך להסביר מדוע השוויון נכון היא לצלול לנבכי הייצוג העשרו… רגע, רגע, רגע, אני לא בטוח שלהפיל עלינו הגדרות שהן לא לגמרי טריוויאליות זה הדבר הנכון לעשות. בואו קודם נתחיל מההוכחה ה”קלאסית” שאוהבים להראות לטענה הזו.&lt;/p&gt;

&lt;p&gt;הרעיון הוא זה: ראשית נסמן &lt;span&gt;\( x=0.999\ldots \)&lt;/span&gt; ואז נעשה על המשוואה הזו סדרה של מניפולציות די פשוטות, שמוכרות לכל מי שהיה צריך לפתור משוואות בבית הספר:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;span&gt;\( x=0.999\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 10x=9.999\ldots \)&lt;/span&gt; (כפלנו ב-10 את שני האגפים)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 10x-x=9.999\ldots-0.999\ldots \)&lt;/span&gt; (החסרנו &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; משני האגפים)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 9x=9 \)&lt;/span&gt; (חישבנו את תוצאת פעולת החיסור באגפים ימין ושמאל)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( x=1 \)&lt;/span&gt; (חילקנו את שני האגפים ב-9)&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;ההוכחה הזו פחות מעניינת אותי בתור משהו שבאמת ישכנע אנשים ש-&lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; (למרות שאני מניח שיש כאלו שמשתכנעים) ויותר בגלל שלל הסיבות שבעטיין היא &lt;strong&gt;לא&lt;/strong&gt; תשכנע אנשים. ראשית, כל העסק קצת מרגיש כמו רמאות או הוכחה מעגלית כי מתחילים עם &lt;span&gt;\( x \)&lt;/span&gt; שווה משהו ומסיימים עם &lt;span&gt;\( x \)&lt;/span&gt; שווה משהו אחר (לכאורה) ולכן האינטואיציה שלנו זועקת שרימו אותנו איפה שהוא. אבל איפה? הפעולות של לכפול את שני האגפים של משוואה באותו מספר, או לחבר לשני האגפים אותו מספר אכן משמרות את המשוואה לשני הכיוונים בדרך כלל. כלומר, אם &lt;span&gt;\( A,B \)&lt;/span&gt; הם ביטויים כלשהם ו-&lt;span&gt;\( a \)&lt;/span&gt; הוא מספר כלשהו, אז אני יכול לומר ש-&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( A=B \)&lt;/span&gt; אם ורק אם &lt;span&gt;\( A+a=B+a \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;ואם &lt;span&gt;\( a\ne0 \)&lt;/span&gt; אפשר גם לומר ש-&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( A=B \)&lt;/span&gt; אם ורק אם &lt;span&gt;\( aA=aB \)&lt;/span&gt;.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;עבור &lt;span&gt;\( a=0 \)&lt;/span&gt; זה נשבר, כי בהחלט ייתכן ש-&lt;span&gt;\( A\ne B \)&lt;/span&gt; אבל &lt;span&gt;\( aA=aB \)&lt;/span&gt;, למשל &lt;span&gt;\( 3\ne5 \)&lt;/span&gt; אבל &lt;span&gt;\( 0\cdot3=0=0\cdot5 \)&lt;/span&gt;. עם זאת, בהוכחה שהצגתי לא היה שום דבר כזה - כפלנו ב-10 וחילקנו ב-9, כש”לחלק ב-9” בעצם אומר לכפול ב-&lt;span&gt;\( \frac{1}{9} \)&lt;/span&gt;. אז מהבחינה הזו ההוכחה תקינה. המקומות שבהם היא קצת יותר חשודה הן כשאנחנו מניחים איך פעולות החשבון מתנהגות על &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt;, כלומר כשאני עושה&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( 10\cdot0.999\ldots=9.999\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 9.999\ldots-0.999\ldots=9 \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;עכשיו, חשוב לי להדגיש ששני אלו &lt;strong&gt;נכונים&lt;/strong&gt;, והם גם אינטואיטיביים למדי כי אני עושה כאן דברים שמוכרים לכל מי שעושה חשבון עם מספרים בייצוג עשרוני. אבל &lt;strong&gt;למה&lt;/strong&gt; הם נכונים? כדי לראות את זה כן צריך להיכנס אל מה זו ההגדרה של ייצוג עשרוני בכלל. אבל לפני שנדבר על מה זה כן ייצוג עשרוני, בואו נדבר על מה זה לא. דרך נפוצה לנסות לשכנע ש-&lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; היא להסתכל על ההפרש, &lt;span&gt;\( 1-0.999\ldots \)&lt;/span&gt;, ולשאול מה הוא יוצא - איך אפשר לקבל כאן משהו גדול מ-0? ותשובה נפוצה לזה היא שההפרש שווה &lt;span&gt;\( 0.000\ldots1 \)&lt;/span&gt;. כלומר - סדרה אינסופית של אפסים עם 1 בסוף שלה.&lt;/p&gt;

&lt;p&gt;זה רעיון ממש ממש נחמד, ובאופן כללי הקטע הזה של “לאינסוף… ומעבר לו!” הוא בעל מקום של כבוד במתמטיקה מאז ימי קנטור &lt;a href=&quot;https://gadial.net/2011/05/25/ordinals_overview/&quot;&gt;ויש לי פוסט על זה&lt;/a&gt;. רק מה, בהקשר הספציפי שעליו אנחנו מדברים כאן - המספרים הממשיים והייצוגים העשרוניים שלהם - זה פשוט לא רלוונטי. אין מספר ממשי כזה, &lt;span&gt;\( 0.000\ldots1 \)&lt;/span&gt;. הרעיון בייצוג עשרוני הוא שיש לנו אינסוף ספרות אחרי הנקודה בלי שיבואו עוד ספרות “אחרי זה”. אנחנו פשוט לא יודעים מה תהיה המשמעות של מספר כזה.&lt;/p&gt;

&lt;p&gt;כדי שזה לא יישמע כמו סתם איסור שרירותי, צריך לענות על השאלה הבסיסית - מה זה ייצוג עשרוני בכלל?&lt;/p&gt;

&lt;h2&gt;פרק ב&apos;, ובו אני מנסה להשתמש בחזון יוחנן כדי לשכנע שהשיטה העשרונית היא סבבה&lt;/h2&gt;

&lt;p&gt;אחד הקטעים ההזויים בחזון יוחנן בברית החדשה מדבר על משהו שנקרא “החיה” שהיא או מטאפורה מחוכמת לרומא של נירון קיסר או תוצר של דמיון פעיל יותר מדי, ואחד מהדברים שנאמרים שם על “החיה” הוא שמספרה הוא 666. כתוצאה מכך חזרה של שלוש פעמים על הספרה 6 נכנסה לתרבות שלנו בתור ייצוג פופולרי של דברים שטניים - והאמת, אני יכול להבין למה. יש אסתטיקה גדולה מאוד בחזרה הזו על 6 שלוש פעמים, ביחד עם המקור המיסטי של המספר. העניין הוא שאם נפתח את חזון יוחנן כדי לראות מה הלך שם במקור לא נמצא את 666 בשום מקום. חזון יוחנן נכתב במקור ביוונית במאה הראשונה לספירה, עוד לפני שהספרה 6 הייתה קיימת בכלל - ועוד יותר מכך, לפני שהשיטה שמשתמשת בספרה 6 - השיטה ההודית-ערבית - הייתה קיימת בכלל. מה שמופיע בחזון יוחנן הוא המספר &lt;strong&gt;שש מאות שישים ושש&lt;/strong&gt; שנכתב בשיטה היוונית (שדומה לשיטה העברית - אותיות שונות מייצגות מספרים שונים, כולל עשרות ומאות) בתור χξϛ. זה… די מאכזב! כל האסתטיקה היפה של חזרתיות על 6 הלכה לאיבוד, וזה די מרתק להבין שהאסתטיקה הזו פשוט נוצרה במקרה, באופן ממוזל.&lt;/p&gt;

&lt;p&gt;כשאנחנו כותבים 666, לכל אחת מהספרות יש משמעות שונה. ה-6 השמאלית ביותר אומרת “שש מאות”. ה-6 האמצעית אומרת “שישים” וה-6 הימנית אומרת “שש”. בשיטה היוונית χ הוא “שש מאות”, ξ הוא “שישים” ו–ϛ הוא “שש”. כלומר, בשיטה העשרונית קורה איזה שהוא קסם שמאפשר לנו לחסוך בסימונים - אותו סימון בדיוק, 6, מאפשר לנו לתאר שלושה מספרים שונים שבשיטה היוונית נזקקו לשלוש אותיות שונות בשבילם. הקסם הזה נובע מכך שבשיטה העשרונית המשמעות של ספרה נובעת &lt;strong&gt;מהמיקום&lt;/strong&gt; שלה בתוך המספר. זה רעיון יפהפה ומועיל, שאנחנו רגילים אליו עוד מילדות ולכן מפספסים לפעמים את זה שהוא לא טריוויאלי (אבל זה לא רעיון &lt;strong&gt;חדש&lt;/strong&gt;; כבר הבבלים לפני 4,000 שנים השתמשו בשיטת ספירה דומה, אם כי לא עשרונית).&lt;/p&gt;

&lt;p&gt;בואו נעזוב את 666 ונעבור למספר עם ספרות שונות: 42, “ארבעים ושתיים”. כאן 4 היא ספרת &lt;strong&gt;העשרות&lt;/strong&gt; ואילו 2 היא ספרת &lt;strong&gt;האחדות&lt;/strong&gt;. כלומר, מה שאנחנו רואים פה הוא שהספרה הימנית ביותר אומרת כמה אחדות (1) אנחנו לוקחים והספרה השניה אומרת כמה עשרות (10) אנחנו לוקחים. אם נוסיף עוד ספרות מצד שמאל, הם יתאימו למאות (100) ולאלפים (1000) וכן הלאה - למספרים שהם &lt;strong&gt;חזקות של &lt;/strong&gt;&lt;strong&gt;10&lt;/strong&gt;. החשיבות של 10 כאן היא שנותנת לשיטה ה&lt;strong&gt;עשר&lt;/strong&gt;ונית את שמה; בתיאוריה היה אפשר לעשות את אותו דבר גם עם חזקות של 2, או של 16, או של 60, אבל זה היה מרגיש לנו פחות טבעי (כל השיטות הללו קיימות בפועל). אז למשל, מספר כמו 473 מייצג את התרגיל החשבוני “ארבע כפול מאה ועוד שבע כפול עשר ועוד 3 כפול אחד”, כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 473=4\times100+7\times10+3\times1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;או, אם רוצים להדגיש שכופלים בחזקות של 10, אפשר לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 473=4\times10^{2}+7\times10^{1}+3\times10^{0} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://gadial.net/2018/01/01/zero_power_equals_one/&quot;&gt;יש לי פוסט&lt;/a&gt; שמסביר למה דברים בחזקת 0 הם 1, כלומר למה כאן &lt;span&gt;\( 10^{0} \)&lt;/span&gt; מתאר את 1).&lt;/p&gt;

&lt;p&gt;עד כאן אני מקווה שהכל פשוט. מתי הסיפור מסתבך? כשרוצים לתאר ככה גם &lt;strong&gt;שברים&lt;/strong&gt;. כאן פתאום כותבים נקודה (“הנקודה העשרונית”) וכותבים ספרות מצד ימין שלה. למשל, “שמונה וחצי” נכתב כך: &lt;span&gt;\( 8.5 \)&lt;/span&gt;. למה? את ה-8 אני מבין, אבל למה “חצי” נכתב על ידי 5? ובכן, זה אותו עיקרון בדיוק של “כפל בחזקות של 10”, רק שהפעם אנחנו עוברים לכפול בחזקות &lt;strong&gt;שליליות&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;מה זה אומר, חזקה שלילית? למשל, &lt;span&gt;\( 10^{-1}=\frac{1}{10} \)&lt;/span&gt; ו-&lt;span&gt;\( 10^{-3}=\frac{1}{10^{3}}=\frac{1}{1000} \)&lt;/span&gt; וכן הלאה. בצורה הכללית ביותר, &lt;span&gt;\( a^{-n}=\frac{1}{a^{n}} \)&lt;/span&gt;, כלומר חזקה שלילית זה פשוט לחלק את 1 בחזקה הרגילה של אותו המספר. אז ב-&lt;span&gt;\( 8.5 \)&lt;/span&gt; יש לנו את 8 כפול &lt;span&gt;\( 10^{0} \)&lt;/span&gt; ואז את 5 כפול &lt;span&gt;\( 10^{-1} \)&lt;/span&gt;, כלומר &lt;span&gt;\( 5\times10^{-1}=\frac{5}{10}=\frac{1}{2} \)&lt;/span&gt;. במילים אחרות, 5 מימין לנקודה העשרונית מתאר “חצי” כי 5 הוא חצי מ-10. באופן דומה &lt;span&gt;\( 0.25 \)&lt;/span&gt; הוא “רבע” כי &lt;span&gt;\( 25 \)&lt;/span&gt; הוא רבע מ-100; התרגיל המדויק שמבצעים כאן הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0.25=2\times\frac{1}{10}+5\times\frac{1}{100}=\frac{2}{10}+\frac{5}{100}=\frac{20+5}{100}=\frac{25}{100}=\frac{1}{4} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;טוב ויפה, ראינו איך מייצגים את חצי ואת רבע. מה עם מי שביניהם, כלומר שליש? זה מספר פשוט, ויש לו תיאור פשוט בתור שבר: &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt;. איך מתארים אותו בייצוג עשרוני? ובכן, אה… הנה הבשורות הלא נעימות. מייצגים אותו ככה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{3}=0.333\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, הספרה 3 חוזרת על עצמה שוב ושוב עד אינסוף. &lt;strong&gt;אינסוף&lt;/strong&gt;. אנחנו צריכים אינסוף ספרות כדי לייצג משהו פשוט כמו &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt;. לא, נאמר, מספר משוגע כמו &lt;span&gt;\( \pi \)&lt;/span&gt; שאומרים עליו שהוא “אי רציונלי” ו”טרנסנדנטי” ויש פרויקטים שלמים כדי לחשב את הספרות שלו אחרי הנקודה. לא, גם עבור &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt; אנחנו צריכים אינסוף ספרות - אם כי במקרה שלו זה מאוד קל לדעת מהן; הן פשוט הספרה 3 שחוזרת על עצמה שוב ושוב עד אינסוף.&lt;/p&gt;

&lt;p&gt;אני רוצה להוכיח לעצמנו שזה חייב להיות ככה. שאי אפשר להסתפק במספר סופי של ספרות. זו תהיה הוכחה קצרה אז אם היא מבלבלת אפשר פשוט לדלג עליה. הרעיון הוא זה: אם, למשל, היו מספיקות לנו שתי ספרות אחרי הנקודה כדי לייצג את שליש, זה אומר שהיינו מקבלים &lt;span&gt;\( \frac{1}{3}=\frac{x}{100} \)&lt;/span&gt;כש-&lt;span&gt;\( x \)&lt;/span&gt; הוא מספר טבעי כלשהו בין 0 ל-99 (כמו שעבור רבע ראינו ש-&lt;span&gt;\( x=25 \)&lt;/span&gt; עושה את העבודה). עכשיו, אם נכפול את שני האגפים ב-100 נקבל &lt;span&gt;\( x=\frac{100}{3} \)&lt;/span&gt;, אבל זו הבעיה - 100 לא מתחלק ב-3. וגם 1000 לא מתחלק ב-3 אז לא יעזרו לנו לקחת 3 ספרות במקום 2, ובאופן כללי אף מספר מהצורה &lt;span&gt;\( 100\ldots0 \)&lt;/span&gt; לא מתחלק ב-3 (דרך פשוטה לראות את זה: סכום הספרות שלהם הוא 1, שלא מתחלק ב-3). וזה לא רק עניין של 3, זה עניין של רוב המספרים: עבור שבר כללי, &lt;span&gt;\( \frac{a}{b} \)&lt;/span&gt;, אם &lt;span&gt;\( \frac{a}{b}=\frac{x}{10^{n}} \)&lt;/span&gt; אז זה אומר ש-&lt;span&gt;\( x=\frac{10^{n}}{b}a \)&lt;/span&gt;. עכשיו, אם נבחר להציג את השבר בצורה כזו ש-&lt;span&gt;\( a,b \)&lt;/span&gt; הם &lt;strong&gt;זרים&lt;/strong&gt; (אין להם גורם משותף) - מה שנקרא “שבר מצומצם”, אז הדרך היחידה שבה &lt;span&gt;\( x \)&lt;/span&gt; יהיה מספר שלם היא אם &lt;span&gt;\( \frac{10^{n}}{b} \)&lt;/span&gt; הוא שלם, כלומר &lt;span&gt;\( b \)&lt;/span&gt; חייב לחלק את &lt;span&gt;\( 10^{n} \)&lt;/span&gt;. אבל מי בכלל יכול לחלק את &lt;span&gt;\( 10^{n} \)&lt;/span&gt;? מכיוון שהפירוק לראשוניים של 10 הוא &lt;span&gt;\( 10=2\cdot5 \)&lt;/span&gt; אז כדי שמישהו יחלק חזקה של 10 הוא חייב שגם הגורמים הראשוניים שלו יהיו או 2 או 5 או שילוב שלהם. כל גורם ראשוני אחר יהרוס לנו.&lt;/p&gt;

&lt;p&gt;גם אם לא עקבתם אחרי כל זה, המסקנה היא פשוטה: שברים שיש להם ייצוג עשרוני &lt;strong&gt;סופי&lt;/strong&gt; כמו &lt;span&gt;\( \frac{1}{2}=0.5 \)&lt;/span&gt; או &lt;span&gt;\( \frac{1}{4}=0.25 \)&lt;/span&gt; או &lt;span&gt;\( \frac{1}{5}=0.2 \)&lt;/span&gt; או &lt;span&gt;\( \frac{1}{8}=0.125 \)&lt;/span&gt; הם המקרה &lt;strong&gt;הנדיר&lt;/strong&gt;. כל שבר מהצורה &lt;span&gt;\( \frac{1}{n} \)&lt;/span&gt; כש-&lt;span&gt;\( n \)&lt;/span&gt; מתחלק במשהו שהוא לא 2 או 5 יהיה בהכרח אינסופי. כלומר, הקטע הזה של שימוש באינסוף ספרות לא נולד כי בא לנו להריץ קטעים מוזרים עם אינסוף, אלא כי אנחנו &lt;strong&gt;חייבים.&lt;/strong&gt; כי בלי זה אין לנו שיטה עשרונית לייצוג שברים.&lt;/p&gt;

&lt;h2&gt;פרק ג&apos;, ובו אני מנסה להשתמש באכילס כדי לשכנע שכדאי להסתכל על הסכום ולא רק על מה שיש בו&lt;/h2&gt;

&lt;p&gt;אני רוצה שנבין למה &lt;span&gt;\( 0.333\ldots=\frac{1}{3} \)&lt;/span&gt;. זו דוגמא יותר טובה מ-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; כי בניגוד ל-1 שיש לנו ייצוג עשרוני פשוט שלו ואנחנו &lt;strong&gt;לא צריכים&lt;/strong&gt; את &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt;, ל-&lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt; כאמור אין כזה. וכמו כן, אם השתכנענו ש-&lt;span&gt;\( 0.333\ldots=\frac{1}{3} \)&lt;/span&gt; אז בואו פשוט נכפול את שני האגפים ב-3 ונקבל &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; וסיימנו! (זה עדיין לא מספיק טוב, כי צריך להסביר למה &lt;span&gt;\( 0.333\ldots \)&lt;/span&gt; כפול 3 הוא &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;מבחינת הגדרה יבשה, כבר ראינו שייצוג עשרוני הוא סכום של חזקות של 10 כשהן מוכפלות בערכים של הספרות. ההבדל היחיד הוא שעכשיו יש לנו אינסוף ספרות ולכן סכום אינסופי - הסכום הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0.333\ldots=\frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אנחנו לא יודעים מה זה אומר, לחבר אינסוף איברים. חיבור זה משהו שאנחנו מכירים בתור פעולה &lt;strong&gt;בינארית&lt;/strong&gt; שמפעילים על שני מספרים. מכאן אפשר להכליל: חיבור של שלושה מספרים הוא מה שמקבלים כשמחברים את שני המספרים הראשונים, ומחברים את השלישי לתוצאת החיבור של שני הראשונים. וחיבור של ארבעה הוא לחבר את הרביעי לתוצאה של חיבור שלושת הראשונים וכן הלאה וכן הלאה - אבל זה רק אומר לנו איך לחבר &lt;strong&gt;מספר סופי&lt;/strong&gt; כלשהו של איברים, לא אינסוף.&lt;/p&gt;

&lt;p&gt;עם זאת, זו התחלה טובה. אם אנחנו יודעים לחבר מספר סופי כלשהו של איברים, אז כשיש לנו סכום אינסופי נוכל להסתכל מה מקבלים מכך שמחברים רק את האיבר הראשון, רק את שני הראשונים, רק את שלושת הראשונים וכן הלאה - מקבלים &lt;strong&gt;סדרה&lt;/strong&gt; אינסופית, שנקראת “סדרת הסכומים החלקיים” של הסכום האינסופי (סכום חלקי, כי חיברנו רק חלק מהאיברים). עבור &lt;span&gt;\( \frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots \)&lt;/span&gt; נקבל את הסדרה הבאה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{3}{10},\frac{33}{100},\frac{333}{1000},\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו עדיין סדרה אינסופית אבל הסיטואציה הזו פשוטה קצת יותר כי אין לנו עכשיו חיבור של המון איברים. השאלה היא מה עושים עם הסדרה שקיבלנו, והתשובה של המתמטיקאים היא - בודקים אם יש לסדרה הזו &lt;strong&gt;גבול&lt;/strong&gt;, והכוונה היא לא ל”גבול” יומיומי אלא למושג מתמטי ספציפי, טכני ומרכזי מאוד, שדומה למושג האינטואיבי אבל מורכב יותר ממנו.&lt;/p&gt;

&lt;p&gt;בשביל המושג הזה, בואו נסתכל על עוד דוגמא מפורסמת - מה שנקרא &lt;strong&gt;פרדוקס הדיכוטומיה&lt;/strong&gt; מבין הפרדוקסים של זנון. אני אציג גרסה של הפרדוקס שטיפה שונה מאיך שהוא מופיע, נאמר, אצל אריסטו - נניח שהגיבור היווני אכילס ניצב בתחילת מסלול ריצה של קילומטר אחד ומתחיל לרוץ - מתי הוא יגיע לצד השני? על פי זנון יש פה בעיה: לפני שהוא מגיע לצד השני, כלומר אל הנקודה &lt;span&gt;\( 1 \)&lt;/span&gt;, הוא אמור להגיע לחצי מהדרך. אוקיי, יופי, אז הוא הגיע אל הנקודה &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt;, מה עכשיו? לפני שיגיע לצד השני הוא עדיין צריך לעבור חצי מהדרך &lt;strong&gt;שנשארה&lt;/strong&gt;, כלומר להגיע אל הנקודה &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}=\frac{3}{4} \)&lt;/span&gt;. גם זה לוקח לו זמן. אוקיי, יופי, הגיע אל &lt;span&gt;\( \frac{3}{4} \)&lt;/span&gt;. עכשיו כדי להגיע לצד השני הוא צריך לעבור חצי מהדרך שנשארה, כלומר &lt;span&gt;\( \frac{3}{4}+\frac{1}{8}=\frac{7}{8} \)&lt;/span&gt;, וכן הלאה וכן הלאה. כלומר, אם אנחנו מנסים להבין מה המרחק שאכילס חייב לעבור כדי להגיע אל הצד השני אנחנו רואים שזה הסכום &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\frac{1}{16}+\ldots \)&lt;/span&gt; (בניסוח המקורי של הפרדוקס מנסים להפעיל את טיעון ה”חצי” הזה על תחילת המסלול כדי לטעון שאכילס לא יכול להתחיל לרוץ בכלל, אבל אז לא מקבלים סכום אינסופי נחמד כמו פה).&lt;/p&gt;

&lt;p&gt;במקור, פרדוקס הדיכוטומיה ניסה להדגים שתנועה היא &lt;strong&gt;בלתי אפשרית&lt;/strong&gt; על ידי הטרלה של הקונספט, אבל אפשר לנצל אותו בשביל הדבר ההפוך. הרי אנחנו יודעים שאכילס &lt;strong&gt;כן יגיע&lt;/strong&gt; לקצה המסלול, כלומר הוא כן יעבור מרחק של 1, והוא יעשה את זה אפילו אם אני אציג בצורה חכמה את המרחק שהוא צריך לעבור בתור סכום אינסופי &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\frac{1}{16}+\ldots \)&lt;/span&gt;, ולכן האינטואיציה שלי היא שצריך להיות קיים מובן מתמטי שבו &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\frac{1}{16}+\ldots=1 \)&lt;/span&gt;, ובאמת יש למתמטיקאים מובן כזה. בשבילו הם מסתכלים על מה שקראתי לו “סדרת הסכומים החלקיים” של הסכום הזה: ראינו קודם שזו סדרה שמתחילה עם &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; ואחר כך &lt;span&gt;\( \frac{3}{4} \)&lt;/span&gt; ואחר כך &lt;span&gt;\( \frac{7}{8} \)&lt;/span&gt; וכן הלאה. מצליחים לראות את החוקיות? בכל פעם יש במכנה חזקה של 2, ובמונה יש את אותה החזקה פחות 1, כלומר הסכום החלקי ה”כללי” הוא &lt;span&gt;\( \frac{2^{n}-1}{2^{n}} \)&lt;/span&gt;, או בניסוח אחר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{2^{n}-1}{2^{n}}=\frac{2^{n}}{2^{n}}-\frac{1}{2^{n}}=1-\frac{1}{2^{n}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בשלב ה-&lt;span&gt;\( n \)&lt;/span&gt; אכילס &lt;strong&gt;כמעט&lt;/strong&gt; הגיע אל &lt;span&gt;\( 1 \)&lt;/span&gt;, נשאר לו רק מרחק זעום של &lt;span&gt;\( \frac{1}{2^{n}} \)&lt;/span&gt; לעבור, והמרחק הזה רק הולך וקטן עוד ועוד. זה מוביל את המתמטיקאים להגיד ש-1 הוא &lt;strong&gt;הגבול&lt;/strong&gt; של הסדרה &lt;span&gt;\( a_{n}=1-\frac{1}{2^{n}} \)&lt;/span&gt;. ההגדרה הכללית של “גבול” היא לא פשוטה כי היא מנסה (ומצליחה) לכסות כל מני מקרים מטרילים הרבה יותר מהנוכחי, אבל בגרסה פשוטה שלה שמתאימה למקרה הזה, היא אומרת את הדבר הבא: 1 הוא הגבול של הסדרה &lt;span&gt;\( 1-\frac{1}{2^{n}} \)&lt;/span&gt; אם ההפרש שלהן (שהוא &lt;span&gt;\( \frac{1}{2^{n}} \)&lt;/span&gt; כאמור) &lt;strong&gt;שואף לאפס&lt;/strong&gt; כש”שואף לאפס” פה אומר שלא משנה כמה קטן ההפרש צריך להיות, אם נתקדם מספיק בסדרה מתישהו הוא יהפוך לקטן כזה. קצת יותר פורמלית: אם &lt;span&gt;\( \varepsilon&amp;gt;0 \)&lt;/span&gt; הוא מספר ממשי כלשהו, אז קיים בסדרה &lt;span&gt;\( n \)&lt;/span&gt; כך ש-&lt;span&gt;\( a_{n}&amp;lt;\varepsilon \)&lt;/span&gt;, כלומר &lt;span&gt;\( \frac{1}{2^{n}}&amp;lt;\varepsilon \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;איך מוכיחים את זה? חשבון טכני שהוא לא מסובך במיוחד: במשוואה &lt;span&gt;\( \frac{1}{2^{n}}&amp;lt;\varepsilon \)&lt;/span&gt; המשתנה שאנחנו רוצים לבודד הוא &lt;span&gt;\( n \)&lt;/span&gt;, אז קודם כל נכפול את המשוואה ב-&lt;span&gt;\( 2^{n} \)&lt;/span&gt; ונחלק אותה ב-&lt;span&gt;\( \varepsilon \)&lt;/span&gt; ונקבל שצריך להתקיים &lt;span&gt;\( 2^{n}&amp;gt;\frac{1}{\varepsilon} \)&lt;/span&gt;. אחר כך, כדי להוריד את &lt;span&gt;\( n \)&lt;/span&gt; מהמעריך של החזקה, מפעילים &lt;strong&gt;לוגריתם&lt;/strong&gt; על שני האגפים - במקרה הזה, לוגריתם על בסיס 2, מה שאוהבים לסמן בתור &lt;span&gt;\( \lg \)&lt;/span&gt;. הרעיון בלוגריתם כזה הוא שמתקיים &lt;span&gt;\( \lg\left(2^{n}\right)=n \)&lt;/span&gt; - זו ממש ההגדרה - ומצד שני שלוגריתם הוא פונקציה “נחמדה” שאם מפעילים אותה על אי שוויון משמרת אותו, כך שאנחנו מקבלים שצריך להתקיים &lt;span&gt;\( n&amp;gt;\lg\left(\frac{1}{\varepsilon}\right) \)&lt;/span&gt;. כאשר &lt;span&gt;\( \varepsilon \)&lt;/span&gt; הוא קטן מאוד אז &lt;span&gt;\( \frac{1}{\varepsilon} \)&lt;/span&gt; הוא גדול מאוד ולכן &lt;span&gt;\( \lg\left(\frac{1}{\varepsilon}\right) \)&lt;/span&gt; הוא גדול מאוד - אבל עדיין קיים מספר טבעי &lt;span&gt;\( n \)&lt;/span&gt; שגדול מהם, כי לכל מספר ממשי אפשרי יש מספר טבעי שגדול ממנו - זה נקרא &lt;strong&gt;התכונה הארכימדית&lt;/strong&gt; של המספרים הממשיים והיא אחד מהדברים שבזכותם יש לנו מתמטיקה מתפקדת. אז יש לנו נימוקים מתמטיים פורמליים לטענה שנראית כמעט מובנת מאליה - שוואלה, אם אנחנו מגדילים את &lt;span&gt;\( n \)&lt;/span&gt; אז &lt;span&gt;\( \frac{1}{2^{n}} \)&lt;/span&gt; נהיה ממש קטן.&lt;/p&gt;

&lt;p&gt;אז בואו נעשה עצירת ביניים. ראינו שלושה אובייקטים שונים:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;strong&gt;סכום אינסופי&lt;/strong&gt;, &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\frac{1}{16}+\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סדרה אינסופית&lt;/strong&gt; של מספרים שהוסקה איכשהו מהסכום האינסופי ונקראה &lt;strong&gt;סדרת הסכומים החלקיים&lt;/strong&gt; שלו, &lt;span&gt;\( a_{n}=1-\frac{1}{2^{n}} \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;מספר ממשי&lt;/strong&gt; שהוסק איכשהו מהסדרה האינסופית ונקרא &lt;strong&gt;הגבול&lt;/strong&gt; שלה, 1.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;אפשר לחשוב על הסכום האינסופי בתור משהו שמייצג תהליך אינסופי שלעולם לא יסתיים - “מה שעובר לזנון בראש כשהוא מדמיין את אכילס מנסה לעבור מסלול ריצה”. על הגבול, 1, אפשר לחשוב בתור “מה שיקרה עם אכילס בעולם האמיתי”. ההתאמה הזו של גבול עבור הסכום האינסופי הוא הדרך שבה המתמטיקה לוקחת אובייקט שיש מידע שמיוצג בו בצורה &lt;strong&gt;מובלעת&lt;/strong&gt;, וחושפת את המידע הזה בצורה &lt;strong&gt;מפורשת&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;אותו דבר בדיוק קורה עם ייצוג עשרוני של מספרים.&lt;/p&gt;

&lt;h2&gt;פרק ד&apos;, ובו אני מנסה להשתמש במתמטיקה כדי לשכנע שייצוג עשרוני מחזורי הוא שבר&lt;/h2&gt;

&lt;p&gt;אחרי כל הדיבורים שלי, עדיין לא הסברתי - למה &lt;span&gt;\( 0.333\ldots=\frac{1}{3} \)&lt;/span&gt;? כאן יש לנו בעצם ארבעה אובייקטים שונים:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;strong&gt;ייצוג עשרוני&lt;/strong&gt; של מספר שהוא הביטוי &lt;span&gt;\( 0.333\ldots \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סכום אינסופי&lt;/strong&gt; &lt;span&gt;\( \frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots \)&lt;/span&gt; שהסקנו איכשהו מהייצוג העשרוני.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סדרה אינסופית&lt;/strong&gt; &lt;span&gt;\( \frac{}{} \)&lt;/span&gt;&lt;span&gt;\( \frac{3}{10},\frac{33}{100},\frac{333}{1000},\ldots \)&lt;/span&gt; שהסקנו מהסכום האינסופי.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;גבול&lt;/strong&gt; שאני טוען שהוא &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt; אבל לא הוכחתי את זה.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;איך מוכיחים את זה? מה, לחשב &lt;span&gt;\( \frac{1}{3}-\frac{333}{1000} \)&lt;/span&gt;? זה נראה לי קצת כואב. זו אחת מהסיטואציות במתמטיקה שבהן אני חושב ש&lt;strong&gt;אבסטרקציה&lt;/strong&gt; יכולה לעזור לנו. במקום לפתור את המקרה הקונקרטי הזה ולהסתבך עם מספרים שיבלבלו אותי, לפתור מקרה כללי יותר. ראשית, בואו נשים לב שאת הסכום &lt;span&gt;\( \frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots \)&lt;/span&gt; אפשר לכתוב גם בתור &lt;span&gt;\( 3\left(\frac{1}{10^{1}}+\frac{1}{10^{2}}+\frac{1}{10^{3}}+\ldots\right) \)&lt;/span&gt;, כלומר מספיק לי להבין מה קורה בסוגריים. אם אני אסמן &lt;span&gt;\( q=\frac{1}{10} \)&lt;/span&gt;, אז בעצם השאלה היא מהו הסכום &lt;span&gt;\( q+q^{2}+q^{3}+\ldots \)&lt;/span&gt; באופן כללי. לדבר כזה קוראים &lt;strong&gt;טור הנדסי&lt;/strong&gt; אינסופי ולמרבה השמחה יש טריקים מתמטיים נחמדים כדי לחשב אותו. ראשית, מה הסכום החלקי, &lt;span&gt;\( q+q^{2}+\ldots+q^{n} \)&lt;/span&gt;? הטריק פה הוא לכפול את הסכום הזה ב-&lt;span&gt;\( \left(q-1\right) \)&lt;/span&gt; ולראות מה מקבלים. כשאני כופל את כל הסכום החלקי ב-&lt;span&gt;\( q \)&lt;/span&gt; אני מקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( q^{2}+q^{3}+\ldots+q^{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, המעריך של כל ה-&lt;span&gt;\( q \)&lt;/span&gt; בסכום גדל ב-1. עכשיו, כשאני כופל את כל הסכום החלקי ב-&lt;span&gt;\( -1 \)&lt;/span&gt; אני מקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( -q-q^{2}-\ldots-q^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המעריך נשאר אותו דבר, אבל עכשיו יש לנו מינוס במקום פלוס. לכן כשנחבר את הסכום העליון לתחתון, כמעט כל החזקות של &lt;span&gt;\( q \)&lt;/span&gt; ייעלמו; הדברים היחידים שלא מופיעים גם למעלה וגם למטה הם &lt;span&gt;\( q^{n+1} \)&lt;/span&gt; ו-&lt;span&gt;\( -q \)&lt;/span&gt;, אז אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(q+q^{2}+\ldots+q^{n}\right)\left(q-1\right)=\left(q^{n+1}-q\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו נחלק את שני האגפים ב-&lt;span&gt;\( q-1 \)&lt;/span&gt; ונקבל את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( q+q^{2}+\ldots+q^{n}=q\frac{q^{n}-1}{q-1} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה קורה כש-&lt;span&gt;\( n \)&lt;/span&gt; הולך וגדל? כאן יש חשיבות לשאלה מהו &lt;span&gt;\( q \)&lt;/span&gt;. אם למשל &lt;span&gt;\( q=2 \)&lt;/span&gt; אז &lt;span&gt;\( q^{n} \)&lt;/span&gt; גדל וגדל עד אין קץ ונקבל שהסכום החלקי שואף לאינסוף - אין פה גבול במובן שדיברתי עליו קודם. אבל אם &lt;span&gt;\( q&amp;lt;1 \)&lt;/span&gt;, למשל &lt;span&gt;\( q=\frac{1}{10} \)&lt;/span&gt;, אז &lt;span&gt;\( q^{n} \)&lt;/span&gt; הולך &lt;strong&gt;לשאוף לאפס&lt;/strong&gt; באותו מובן שדיברתי עליו קודם, ועם אותה הוכחה (לוגריתמים וכאלה). לכן אפשר להראות שהגבול של הסדרה &lt;span&gt;\( q\frac{q^{n}-1}{q-1} \)&lt;/span&gt; הוא מה שמתקבל כשמחליפים את &lt;span&gt;\( q^{n} \)&lt;/span&gt; ב-0, כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( q\frac{0-1}{q-1}=\frac{q}{1-q} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם נציב &lt;span&gt;\( q=\frac{1}{10} \)&lt;/span&gt;, נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{q}{1-q}=\frac{1}{10}\cdot\frac{1}{1-\frac{1}{10}}=\frac{1}{10}\frac{1}{\frac{9}{10}}=\frac{10}{10\cdot9}=\frac{1}{9} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו אפשר לחזור לטור המקורי: &lt;span&gt;\( \frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots=3\left(\frac{1}{10^{1}}+\frac{1}{10^{2}}+\frac{1}{10^{3}}+\ldots\right)=3\cdot\frac{1}{9}=\frac{1}{3} \)&lt;/span&gt;. זה מסיים לנו את ההוכחה במקרה של שלישי.&lt;/p&gt;

&lt;p&gt;מה עם &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt;? זה אותו דבר בדיוק:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0.999\ldots=9\left(\frac{1}{10^{1}}+\frac{1}{10^{2}}+\frac{1}{10^{3}}+\ldots\right)=9\cdot\frac{1}{9}=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו ההוכחה הפורמלית של השוויון הזה, ואני אחזור לזה עוד רגע, אבל אני לא רוצה שנעצור פה כי מה שעשינו כאן הוא בעצם הרבה יותר כללי מזה.&lt;/p&gt;

&lt;p&gt;אם נפתח מחשבון ונכתוב &lt;span&gt;\( 1\div7 \)&lt;/span&gt; נקבל את המספר הזה או לפחות את ההתחלה שלו: &lt;span&gt;\( 0.142857142857\ldots \)&lt;/span&gt;. איך מגיעים לזה? אני מדגים טכנית בדיוק את החישוב שמוביל לייצוג העשרוני הזה &lt;a href=&quot;https://gadial.net/2021/03/24/how_to_division/&quot;&gt;בפוסט שלי על חילוק&lt;/a&gt;, וכאן אני מתעניין בדיוק בכיוון ההפוך - איך בעצם מהספרות &lt;span&gt;\( 0.142857142857\ldots \)&lt;/span&gt; אני יכול להגיע חזרה אל &lt;span&gt;\( \frac{1}{7} \)&lt;/span&gt;? סתם לכפול ב-&lt;span&gt;\( \frac{1}{9} \)&lt;/span&gt; כמו קודם מן הסתם לא יעזור.&lt;/p&gt;

&lt;p&gt;ראשית, הנקודה הקריטית פה היא ש-&lt;span&gt;\( 0.142857142857\ldots \)&lt;/span&gt; אולי נראה כמו ממבו-ג’מבו מפחיד של ספרות אבל יש בו חוקיות &lt;strong&gt;מחזורית&lt;/strong&gt; פשוטה: יש את הספרות &lt;span&gt;\( 142857 \)&lt;/span&gt; שחוזרות על עצמן שוב, ושוב, ושוב (בפוסט על החילוק אנחנו רואים בדיוק למה אנחנו יודעים את זה בודאות וזו לא סיטואציה של “פתאום בספרה ה-312,438 אחרי הנקודה התבנית נשברת”). זה אומר שאני יכול לכתוב את הייצוג העשרוני הזה בתור&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{142857}{1000000}+\frac{142857}{1000000^{2}}+\frac{142857}{1000000^{3}}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;רגע, מה? איך? אולי כדאי שאסביר את זה יותר אם זה לא ברור. בוא נתחיל מלהסתכל על &lt;span&gt;\( 0.142857 \)&lt;/span&gt;, בלי שלוש נקודות והכל, רק השבר הזה. על פי ההגדרה הפורמלית הוא שווה ל-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{10}+\frac{4}{100}+\frac{2}{1000}+\frac{8}{10000}+\frac{5}{100000}+\frac{7}{1000000} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשרוצים לחבר את כל אלו עושים מכנה משותף. לכן ה-&lt;span&gt;\( 1 \)&lt;/span&gt; מוכפל ב-10000 וה-4 מוכפל ב-1000 וכן הלאה. מה שמקבלים הוא בדיוק את &lt;span&gt;\( \frac{142857}{1000000} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, את &lt;span&gt;\( 0.142857142857 \)&lt;/span&gt; (עדיין בלי שלוש נקודות, רק שתי חזרות על &lt;span&gt;\( 142857 \)&lt;/span&gt;) אפשר לכתוב בתור &lt;span&gt;\( 0.142857+0.000000142857 \)&lt;/span&gt;. ראינו שהמספר השמאלי הוא &lt;span&gt;\( \frac{142857}{1000000} \)&lt;/span&gt;. אם נכפול את המספר הימני &lt;span&gt;\( 0.000000142857 \)&lt;/span&gt; ב-1000000, התוצאה תהיה “הזזה של הספרות” שישה מקומות שמאלה (כי כפל ב-10 הוא הזזה של הספרות צעד אחד שמאלה. אז נקבל שוב את &lt;span&gt;\( 0.142857 \)&lt;/span&gt;, והמסקנה היא ש-&lt;span&gt;\( 10^{6}\cdot0.000000142857=\frac{142857}{10^{6}} \)&lt;/span&gt;, כלומר אם נחלק ב-&lt;span&gt;\( 10^{6} \)&lt;/span&gt; את שני האגפים נקבל &lt;span&gt;\( 0.000000142857=\frac{142857}{\left(10^{6}\right)^{2}} \)&lt;/span&gt; וככה זה נמשיך עוד ועוד. לכן גם &lt;span&gt;\( 0.142857\ldots \)&lt;/span&gt; הוא בבסיסו מספר כפול טור הנדסי - הפעם המספר הוא &lt;span&gt;\( 142857 \)&lt;/span&gt; והטור ההנדסי הוא עם &lt;span&gt;\( q=\frac{1}{10^{6}} \)&lt;/span&gt;. אפשר להציב את &lt;span&gt;\( q \)&lt;/span&gt; בתוך הנוסחה הכללית לסכום שראינו קודם, &lt;span&gt;\( \frac{q}{1-q} \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{10^{6}}\frac{1}{\frac{9999999}{10^{6}}}=\frac{1}{999999} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם נפתח מחשבון ונחשב את &lt;span&gt;\( 999999\div142857 \)&lt;/span&gt; נקבל בדיוק 7, ולכן באמת קיבלנו &lt;span&gt;\( \frac{1}{7}=\frac{142857}{999999} \)&lt;/span&gt;. אותי זה מכה בהלם - איך ייתכן שמספר כל כך מסודר כמו 999999 יתחלק יפה בבלאגן כמו 142857? אבל זה קורה, וזה &lt;strong&gt;חייב לקרות&lt;/strong&gt; עבור כמעט כל מספר שהוא שבר מהצורה &lt;span&gt;\( \frac{1}{d} \)&lt;/span&gt;: מתישהו יהיה מספר מתוסבך שכשמחלקים את &lt;span&gt;\( 9999\ldots9 \)&lt;/span&gt; בו מקבלים בדיוק &lt;span&gt;\( d \)&lt;/span&gt; - או בניסוח אחר - אם נסתכל על כל המספרים מהצורה &lt;span&gt;\( 9,99,999,9999,\ldots \)&lt;/span&gt; מתישהו אחד מהם יתחלק ב-&lt;span&gt;\( d \)&lt;/span&gt; בלי שארית. החריגים היחיד הם המקרים המקרה שבהם &lt;span&gt;\( d \)&lt;/span&gt; מתחלק ב-2 או ב-5; ראינו כבר שאם &lt;span&gt;\( d \)&lt;/span&gt; מתחלק &lt;strong&gt;רק&lt;/strong&gt; ב-2 או ב-5 אז יש לו ייצוג עשרוני &lt;strong&gt;סופי&lt;/strong&gt;, ועוד מעט נראה מה קורה במקרה הכללי.&lt;/p&gt;

&lt;p&gt;בואו נוכיח את הטענה הזו על ה-9-ים וההתחלקות כי ההוכחה ממש חמודה ומאפשרת להציג עוד רעיון מתמטי נחמד (אבל אפשר גם לדלג עליה). ראשית, במקום לכתוב &lt;span&gt;\( 99999 \)&lt;/span&gt; וכו’ יותר נוח לכתוב &lt;span&gt;\( 10^{n}-1 \)&lt;/span&gt;, אז אנחנו מסתכלים על הסדרה של כל המספרים מהצורה &lt;span&gt;\( 10^{n}-1 \)&lt;/span&gt; ורוצים להוכיח שאיבר כלשהו שלה מתחלק ב-&lt;span&gt;\( d \)&lt;/span&gt;. עכשיו, כשמחלקים איבר כזה ב-&lt;span&gt;\( d \)&lt;/span&gt; &lt;strong&gt;עם שארית&lt;/strong&gt; השארית יכולה לצאת כל מספר מ-0 עד &lt;span&gt;\( d-1 \)&lt;/span&gt;, בסך הכל יש &lt;span&gt;\( d \)&lt;/span&gt; אפשרויות. זה אומר שאם אני אסתכל על כל המספרים &lt;span&gt;\( 10^{1}-1,10^{2}-1,\ldots,10^{d+1}-1 \)&lt;/span&gt; יהיו לי &lt;span&gt;\( d+1 \)&lt;/span&gt; מספרים, שכשאני מחלק אותם ב-&lt;span&gt;\( d \)&lt;/span&gt; אני מקבל אחת מבין &lt;span&gt;\( d \)&lt;/span&gt; שאריות אפשריות, ובגלל שיש &lt;span&gt;\( d+1 \)&lt;/span&gt; מספרים בהכרח תהיה שארית שתופיע &lt;strong&gt;פעמיים&lt;/strong&gt; - זה יישום של עקרון כללי שנקרא &lt;strong&gt;עקרון שובך היונים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;נניח שהשארית שמופיעה פעמיים, מופיעה במספרים &lt;span&gt;\( 10^{m}-1 \)&lt;/span&gt; ו-&lt;span&gt;\( 10^{k}-1 \)&lt;/span&gt;, עבור &lt;span&gt;\( m&amp;gt;k \)&lt;/span&gt;. עכשיו בואו נסתכל על המספר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(10^{m}-1\right)-\left(10^{k}-1\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם אני אחלק את המספר &lt;strong&gt;הזה&lt;/strong&gt; ב-&lt;span&gt;\( d \)&lt;/span&gt;, אני אקבל שארית אפס, כי השארית מחלוקת &lt;span&gt;\( \left(10^{m}-1\right) \)&lt;/span&gt; ב-&lt;span&gt;\( d \)&lt;/span&gt; תתקזז עם השארית מחלוקת &lt;span&gt;\( \left(10^{k}-1\right) \)&lt;/span&gt; ב-&lt;span&gt;\( d \)&lt;/span&gt;. בנוסף, אני יכול לכתוב את המספר הזה בצורה נחמדה יותר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(10^{m}-1\right)-\left(10^{k}-1\right)=10^{m}-10^{k}=10^{k}\left(10^{m-k}-1\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, אני מניח ש-&lt;span&gt;\( d \)&lt;/span&gt; לא מתחלק ב-2 או ב-5. במילים אחרות, אין לו &lt;strong&gt;בכלל&lt;/strong&gt; מחלקים משותפים עם &lt;span&gt;\( 10^{k} \)&lt;/span&gt; - על זה אומרים במתמטית ש-&lt;span&gt;\( d \)&lt;/span&gt; ו-&lt;span&gt;\( 10^{k} \)&lt;/span&gt; הם &lt;strong&gt;זרים&lt;/strong&gt;. זה אומר שאם אני יודע ש-&lt;span&gt;\( d \)&lt;/span&gt; מחלק את כל &lt;span&gt;\( 10^{k}\left(10^{m-k}-1\right) \)&lt;/span&gt; אז בהכרח &lt;span&gt;\( d \)&lt;/span&gt; מחלק את &lt;span&gt;\( 10^{m-k}-1 \)&lt;/span&gt;, כי במספר השני במכפלה אין אף גורם שמופיע ב-&lt;span&gt;\( d \)&lt;/span&gt;. זה מסיים את ההוכחה: קיבלנו מספר מהצורה &lt;span&gt;\( 999\ldots9 \)&lt;/span&gt; שמתחלק על ידי &lt;span&gt;\( d \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה קורה במקרה הכי כללי? כשיש לנו &lt;span&gt;\( d \)&lt;/span&gt; שמצד אחד מתחלק או ב-2 או ב-5 ומצד שני לא מתחלק &lt;strong&gt;רק&lt;/strong&gt; בהם? המקרה הקלאסי הוא &lt;span&gt;\( \frac{1}{6} \)&lt;/span&gt;, כי &lt;span&gt;\( 6=2\cdot3 \)&lt;/span&gt;. אם נפתח מחשבון נגלה ש-&lt;span&gt;\( \frac{1}{6}=0.1666\ldots \)&lt;/span&gt;, כלומר יש פה בייצוג העשרוני שילוב של שני חלקים - חלק בהתחלה שלא חוזר על עצמו, וחלק בהמשך שכן חוזר על עצמו. את זה כבר ראינו איך לחשב:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0.1666=0.1+0.0666\ldots=\frac{1}{10}+\frac{1}{10}\cdot\frac{2}{3}=\frac{3+2}{30}=\frac{5}{30}=\frac{1}{6} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו גם הצורה הכללית של ייצוג עשרוני של מספר שהוא שבר: מספר שהספרות שלו אחרי הנקודה הופכת להיות מחזוריות החל משלב מסוים, לאו דווקא מהספרה הראשונה. יש הרבה מספרים שלא מקיים את החוקיות הזו, למשל &lt;span&gt;\( \pi=3.1415\ldots \)&lt;/span&gt; שאי אפשר לייצג בתור שבר (הוא &lt;strong&gt;אי-רציונלי&lt;/strong&gt;) אבל זה סיפור לפעם אחרת.&lt;/p&gt;

&lt;h2&gt;פרק ה&apos; ואחרון, ובו אני מנסה להשתמש במה שראינו כאן כדי לשכנע שזה לא סיפור של צודקים וטועים&lt;/h2&gt;

&lt;p&gt;בואו נסכם את מה שראינו. כפי שאמרתי קודם, כשמדברים על ייצוג עשרוני מדברים בעצם במובלע על ארבעה אובייקטים שונים:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;strong&gt;ייצוג עשרוני&lt;/strong&gt; של מספר.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סכום אינסופי&lt;/strong&gt; שהסקנו איכשהו מהייצוג העשרוני.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סדרה אינסופית&lt;/strong&gt; שהסקנו מהסכום האינסופי.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;גבול&lt;/strong&gt; שהסקנו מהסדרה האינסופית.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;הרעיון בייצוג עשרוני הוא שהגבול שמקבלים בשלב 4 יהיה שווה למספר שאנחנו מעוניינים לייצג עשרונית. אם המספר הזה הוא מספר רציונלי (“שבר”) קל לראות שזה באמת עובד והראיתי את זה למעלה - עבור מספרים אי רציונליים הטיעון עשוי להיות מסובך יותר. בפרט עבור &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; מקבלים די בקלות שהגבול הוא 1, ולכן כותבים &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt;. מזה נובע שגם באופן כללי יותר, בכל פעם שבה מספר מסתיים בסדרה אינסופית של 999, בעצם יש לנו שני ייצוגים שונים לאותו מספר. למשל &lt;span&gt;\( 0.3999\ldots \)&lt;/span&gt; הוא ייצוג שונה של &lt;span&gt;\( 0.4 \)&lt;/span&gt;, וכן הלאה; זה לא שיש משהו מיוחד ספציפית ב-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; עצמו. זו אפילו לא אנומליה שקשורה לכך שאנחנו סופרים בבסיס 10; אם היינו סופרים בבסיס 60, אז ייצוג שמסתיים בסדרה אינסופית של הסימבול עבור 59 היה מקיים את אותה כפילות בדיוק. זה פשוט האופן שבו ייצוגים כאלו של מספרים ממשיים עובדים.&lt;/p&gt;

&lt;p&gt;התחושה שלי היא שרוב אלו שלא מסכימים שהשוויון נכון בעצם מזהים את &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; עם אחד מהאובייקטים משלב 2 או 3, ולא עם האובייקט משלב 4 שהוא היעד של ההגדרה והתוצאה הסופית שלה. במובן הזה הם לא “טועים”; ההפך, הם מתארים &lt;strong&gt;נכון&lt;/strong&gt; חלק מההגדרה, פשוט לא את הכל. הם נעצרים מוקדם מדי. למשל אצל מי שאומרים ש-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא “תהליך” (הם אי שם בשלב 2). שווה להתייחס במיוחד אל מי שאומרים שההפרש בין &lt;span&gt;\( 1 \)&lt;/span&gt; ו-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא &lt;span&gt;\( 0.000\ldots1 \)&lt;/span&gt;: הם בעצם מסתכלים על סדרת ההפרשים &lt;span&gt;\( 0.1,0.01,0.001,\ldots \)&lt;/span&gt; שמופיעה במובלע בשלב 3, ואז מסיקים שה”גבול” שלה הוא &lt;span&gt;\( 0.000\ldots1 \)&lt;/span&gt; במקום סתם 0. זה קורה כי הם לא &lt;strong&gt;מחשבים&lt;/strong&gt; את הגבול (הזוועה עם הלוגריתמים שעשיתי קודם) אלא כי הם עושים איזה להטוט סינטקטי, כלומר כזה שמתייחס ל&lt;strong&gt;צורה&lt;/strong&gt; ולא ל&lt;strong&gt;תוכן&lt;/strong&gt; של המספרים שהם עובדים איתם. אם מסתכלים על &lt;span&gt;\( 0.1,0.01,0.001,\ldots \)&lt;/span&gt; בתור “הסימבול 0 ואז הסימבול נקודה ואז סדרה &lt;strong&gt;סופית&lt;/strong&gt; של הסימבולים 0 ואז הסימבול 1 לסיום” אפשר לחשוב על החוקיות שבה לוקחים את הייצוג הסינטקטי הזה לאינסוף ומחליפים את ה&lt;strong&gt;סופית&lt;/strong&gt; שהופיעה קודם ב&lt;strong&gt;אינסופית&lt;/strong&gt;. עכשיו, שיהיה ברור, זה רעיון &lt;strong&gt;ממש נחמד&lt;/strong&gt; ואפשר לפתח אותו מתמטית ולעשות איתו כל מני דברים - אבל הוא פשוט לא רלוונטי למה שאנחנו עושים כאן, כי זה לא מייצג את האופן שבו במתמטיקה אנחנו מבצעים חישובים במספרים ממשיים.&lt;/p&gt;

&lt;p&gt;לסיום, אני רוצה לחזור להוכחה שהצגתי בהתחלה:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;span&gt;\( x=0.999\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 10x=9.999\ldots \)&lt;/span&gt; (כפלנו ב-10 את שני האגפים)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 10x-x=9.999\ldots-0.999\ldots \)&lt;/span&gt; (החסרנו &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; משני האגפים)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 9x=9 \)&lt;/span&gt; (חישבנו את תוצאת פעולת החיסור באגפים ימין ושמאל)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( x=1 \)&lt;/span&gt; (חילקנו את שני האגפים ב-9)&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;ההוכחה הזו תמיד צצה בדיונים על הנושא וכאמור אני חושב שהיא בהחלט מסוגלת לשכנע חלק מהמתדיינים (בשום פנים ואופן לא את כולם). אפשר אולי לטעון שההוכחה הזו מסתירה את העומק האמיתי של ההגדרות ועם זה אני לא מנסה להתווכח, אבל אני כן רוצה שנראה שזו הוכחה תקינה לגמרי. השלבים ה”מסוכנים” הם 2 ו-3; בואו נבין למה אפשר לעשות אותם.&lt;/p&gt;

&lt;p&gt;בשלב 2 אני אומר שאם כופלים את &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; ב-10 מקבלים &lt;span&gt;\( 9.999\ldots \)&lt;/span&gt;. בואו קודם כל נפתח את ההגדרות של שני המספרים הללו:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( 0.999\ldots=\frac{9}{10}+\frac{9}{100}+\frac{9}{1000}+\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 9.999\ldots=9+\frac{9}{10}+\frac{9}{100}+\frac{9}{1000}+\ldots \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;אם ניקח את הטור העליון ונכפול אותו “איבר-איבר” ב-10, נקבל את הטור השני. לכן מה שאנחנו מתבססים עליו כאן הוא הטענה שאפשר לכפול טורים “איבר-איבר”. ברשותכם, אני אכניס את הסימן &lt;span&gt;\( \Sigma \)&lt;/span&gt; לתיאור סכום כדי לפשט עניינים. פורמלית, המשפט הוא שאם &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n} \)&lt;/span&gt; הוא טור &lt;strong&gt;מתכנס&lt;/strong&gt;, כלומר קיים &lt;span&gt;\( A \)&lt;/span&gt; כך ש-&lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}=A \)&lt;/span&gt; (עם ההגדרה של הגבול של סדרת הסכומים החלקיים שהזכרתי קודם), ואם &lt;span&gt;\( B \)&lt;/span&gt; הוא מספר כלשהו, אז מתקיים &lt;span&gt;\( \sum_{n=0}^{\infty}Ba_{n}=B\left(\sum_{n=0}^{\infty}a_{n}\right)=BA \)&lt;/span&gt;. ההוכחה היא די פשוטה: אם כופלים את הטור ב-&lt;span&gt;\( B \)&lt;/span&gt; יוצא שזה כמו לכפול את סדרת הסכומים החלקיים ב-&lt;span&gt;\( B \)&lt;/span&gt; ואנחנו עוברים לטיעון שאם יש לנו סדרה מתכנסת ואנחנו כופלים אותה ב-&lt;span&gt;\( B \)&lt;/span&gt; אז הגבול שלה מוכפל ב-&lt;span&gt;\( B \)&lt;/span&gt; מה שנובע יחסית בקלות מההגדרה של הגבול (שלא הצגתי כאן במלואה אז אני לא אוכיח פה פורמלית).&lt;/p&gt;

&lt;p&gt;באופן דומה בשלב 3 בעצם יש לנו טיעון על &lt;strong&gt;הפרש&lt;/strong&gt; של שני טורים ששניהם מתכנסים: ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}-\sum_{n=0}^{\infty}b_{n}=\sum_{n=0}^{\infty}\left(a_{n}-b_{n}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;גם פה ההוכחה היא אותו דבר - מעבר מהטורים אל סדרות, ושימוש בכך שהגבול של סדרת הפרשים &lt;span&gt;\( \left(a_{n}-b_{n}\right) \)&lt;/span&gt; שווה להפרש הגבולות של הסדרות &lt;span&gt;\( a_{n},b_{n} \)&lt;/span&gt; בנפרד. אלו טענות פשוטות למדי שנתקלים בהן בלימודי חשבון אינפיניטסימלי בסיסיים - אבל זה העניין, שבשביל לראות את זה פורמלית צריך להגיע ללימודי חשבון אינפיניטסימלי בסיסיים ורוב גדול של האנשים לא יעשו את זה. מצד שני, אני חושד שרוב האנשים שלא למדו חשבון אינפיניטסימלי גם ייטו לקבל אינטואיטיבית את זה שמעברים 2 ו-3 הם נכונים (אלא אם הם ממש רוצים לחפש בכוח בעיות בהוכחה) - פשוט כי חשבון אינפיניטסימלי הוא הזדמנות לראות את הדרכים השונות שבהן תוצאות “אינטואיטיביות” דומות קורסות ומתרסקות ברעש עצום. מכירים את הקטע הזה שאם יש לנו סכום אינסופי שבניגוד למה שראינו בפוסט הזה יש בו גם איברים חיוביים וגם שליליים, אז ייתכן שעל ידי סידור מחדש של האיברים שלו נוכל להגיע לכל מספר אפשרי? &lt;a href=&quot;https://gadial.net/2010/04/10/riemann_series_theorem/&quot;&gt;יש לי פוסט על זה&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;פתחתי בלומר ש-&lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; הוא שוויון פשוט, כמעט טריוויאלי. זה כמובן נכון, אבל עדיין יצא לי פוסט לא קטן עליו. זה בגלל שהשוויון הקטן והמוזר הזה הוא לשמחתי הרבה &lt;strong&gt;מעניין&lt;/strong&gt;. הוא נותן תירוץ לדבר על שלל דברים נחמדים במתמטיקה. קצת חבל לי על כל המקרים שבהם אנשים מתחילים לריב על השוויון ובמקום לנצל את זה כדי לדבר על דברים מגניבים פשוט ממשיכים… לריב. כדי לראות “מי צודק”. אנחנו יכולים להיות טובים יותר מזה, לא סתם לשאוף לשם.&lt;/p&gt;</content><author><name></name></author><category term="מספרים ממשיים" /><summary type="html">פרק א&apos;, ובו אני מנסה להשתמש בשוויון מוזר כדי לשכנע שיש על מה לדבר פה</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מה הקטע עם התפלגות נורמלית? (חלק ד’ ואחרון: משפט הגבול המרכזי)</title><link href="http://gadial.net/2025/02/07/normal_distribution_4/" rel="alternate" type="text/html" title="מה הקטע עם התפלגות נורמלית? (חלק ד&apos; ואחרון: משפט הגבול המרכזי)" /><published>2025-02-07T00:00:00+00:00</published><updated>2025-02-07T00:00:00+00:00</updated><id>http://gadial.net/2025/02/07/normal_distribution_4</id><content type="html" xml:base="http://gadial.net/2025/02/07/normal_distribution_4/">&lt;h2&gt;אז מה משפט הגבול המרכזי אומר?&lt;/h2&gt;

&lt;p&gt;סדרת הפוסטים הזו מנסה להבין למה התפלגות נורמלית נראית כמו שהיא נראית. מן הסתם השאלה הראשונה שצריך לענות עליה בשביל זה היא “מה זו בכלל התפלגות נורמלית?” ולזה יש שתי תשובות: אחת יבשה, של לתת את ההגדרה הפורמלית, וזה מה שעשינו בפוסטים הקודמים; והשניה, המהותית יותר, היא להסביר למה בכלל מתעניינים בהתפלגות הזו - והתשובה היא &lt;strong&gt;משפט הגבול המרכזי&lt;/strong&gt;. תיארתי אותו בנפנופי ידיים קודם, אז עכשיו הגיע הזמן לתת את הניסוח הפורמלי.&lt;/p&gt;

&lt;p&gt;משפט הגבול המרכזי מסתכל על סדרה אינסופית &lt;span&gt;\( X_{1},X_{2},X_{3},\ldots \)&lt;/span&gt; של משתנים מקריים שהם בלתי תלויים ובעלי אותה התפלגות (בדומה לתנאים של &lt;strong&gt;חוק המספרים הגדולים&lt;/strong&gt; שהזכרתי בפוסט הקודם). אנחנו מסמנים ב-&lt;span&gt;\( \mu \)&lt;/span&gt; את התוחלת וב-&lt;span&gt;\( \sigma^{2} \)&lt;/span&gt; את השונות שלהם (בפרט, אנחנו מניחים שהמספרים הללו מוגדרים, סופיים וש-&lt;span&gt;\( \sigma\ne0 \)&lt;/span&gt;). עכשיו, לכל &lt;span&gt;\( n \)&lt;/span&gt; אנחנו מגדירים משתנה מקרי &lt;span&gt;\( Z_{n} \)&lt;/span&gt; שהוא בערך הסכום של ה-&lt;span&gt;\( X_{i} \)&lt;/span&gt;-ים עד האיבר ה-&lt;span&gt;\( n \)&lt;/span&gt;-י, אבל עם שקלול נוסף שאמור לנרמל את הסכום:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Z_{n}=\frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז הסדרה &lt;span&gt;\( Z_{n} \)&lt;/span&gt; שואפת להתפלגות הנורמלית &lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; כאשר &lt;span&gt;\( n \)&lt;/span&gt; שואף לאינסוף. פורמלית, לכל &lt;span&gt;\( -\infty&amp;lt;a&amp;lt;\infty \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}P\left(Z_{n}\le a\right)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{a}e^{-x^{2}/2}dx \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה הניסוח הפורמלי, אבל הוא די שונה ממה שהצגתי עד כה בפוסטים שלי. מה שאני תמיד אמרתי הוא “בואו ניקח משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt; כלשהו. עכשיו בואו נחזור על ההגרלה שלו המון פעמים ונחבר את התוצאות” - כלומר, הסתכלתי על הסכום &lt;span&gt;\( X_{1}+\ldots+X_{n} \)&lt;/span&gt;. מכאן אמרתי “היי תראו עכשיו אם מציירים היסטוגרמה של הסכום אז פתאום יש עקומה של התפלגות נורמלית שמתארת אותה די במדויק”. כדי לקבל את העקומה, חישבתי את &lt;span&gt;\( \text{E}\left[X\right]=\mu \)&lt;/span&gt; ואת &lt;span&gt;\( \text{Var}\left(X\right)=\sigma^{2} \)&lt;/span&gt; ואז בניתי את העקומה &lt;span&gt;\( N\left(n\mu,\sqrt{n}\sigma\right) \)&lt;/span&gt;. בואו נראה שזה באמת אמור לעבוד, על פי משפט הגבול המרכזי.&lt;/p&gt;

&lt;p&gt;ראשית, תזכורת: טענתי בפוסט הקודם שאם &lt;span&gt;\( N\left(\mu,\sigma\right) \)&lt;/span&gt; היא התפלגות נורמלית עם תוחלת &lt;span&gt;\( \mu \)&lt;/span&gt; וסטיית תקן &lt;span&gt;\( \sigma \)&lt;/span&gt; אז &lt;span&gt;\( N\left(0,1\right)=\frac{N\left(\mu,\sigma\right)-\mu}{\sigma} \)&lt;/span&gt;, או בניסוח אחר - &lt;span&gt;\( N\left(\mu,\sigma\right)=\sigma N\left(0,1\right)+\mu \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, אם אני אסמן &lt;span&gt;\( Y_{n}=X_{1}+\ldots+X_{n} \)&lt;/span&gt; אז משפט הגבול המרכזי אומר ש-&lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; היא קירוב טוב של &lt;span&gt;\( Z_{n}=\frac{Y_{n}-n\mu}{\sigma\sqrt{n}} \)&lt;/span&gt;. השוויון הזה מלמד אותי ש-&lt;span&gt;\( Y_{n}=\sigma\sqrt{n}Z_{n}+n\mu \)&lt;/span&gt;, כך שאני מצפה שקירוב טוב אל &lt;span&gt;\( Y_{n} \)&lt;/span&gt; (שהוא המשתנה המקרי שהופיע בהיסטוגרמות שלי) יהיה &lt;span&gt;\( \sigma\sqrt{n}N\left(0,1\right)+n\mu=N\left(n\mu,\sigma\sqrt{n}\right) \)&lt;/span&gt;, וזו העקומה שציירתי בפועל. זה מסביר מאיפה האיורים שלי הגיעו אבל עדיין לא ברור למה משפט הגבול המרכזי נראה כמו שהוא נראה; לי למשל מפריע שהחלוקה היא ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; ולא ב-&lt;span&gt;\( n \)&lt;/span&gt; כמו שעושים בחוק המספרים הגדולים. בהוכחה של משפט הגבול המרכזי אנחנו נראה למה הדברים הללו הם כמות שהם.&lt;/p&gt;

&lt;h2&gt;פונקציות יוצרות מומנטים&lt;/h2&gt;

&lt;p&gt;הכלי הטכני המרכזי שבו משתמשים בהוכחה הוא מושג שטרם הזכרתי בסדרת הפוסטים הזו: &lt;strong&gt;פונקציה יוצרת מומנטים&lt;/strong&gt;. מה זה מומנטים כן הזכרתי, בחטף: עבור משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt;, &lt;strong&gt;המומנטים&lt;/strong&gt; שלו הם הערכים המספריים &lt;span&gt;\( \text{E}\left[X^{n}\right] \)&lt;/span&gt; עבור &lt;span&gt;\( n=1,2,\ldots \)&lt;/span&gt;. עבור &lt;span&gt;\( n=1 \)&lt;/span&gt; המומנט הוא פשוט התוחלת, וראינו שעבור &lt;span&gt;\( n=2 \)&lt;/span&gt; המומנט הוא פשוט השונות ועוד התוחלת בריבוע (כי &lt;span&gt;\( \text{Var}\left(X\right)=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)&lt;/span&gt;), אבל לא דיברתי על המומנטים עבור חזקות גבוהות יותר. הרעיון הוא שסדרת המומנטים של משתנה מקרי היא כמו ה-DNA שלו: מכילה כמות גדולה כל כך של מידע עליו שאפשר להסיק ממנה דברים מאוד לא טריוויאליים, גם אם היא לבדה לא כל הסיפור.&lt;/p&gt;

&lt;p&gt;עוד מושג מאוד מועיל במתמטיקה, &lt;a href=&quot;https://gadial.net/2011/08/07/generating_functions_hardcore_1/&quot;&gt;שכבר הזכרתי&lt;/a&gt; בבלוג כמה פעמים, הוא &lt;strong&gt;פונקציה יוצרת&lt;/strong&gt;. הרעיון בפונקציה יוצרת הוא זה: אם יש לנו סדרה מעניינת של מספרים, &lt;span&gt;\( a_{0},a_{1},a_{2},\ldots \)&lt;/span&gt;, אחד מהקסמים שאנחנו יכולים לעשות הוא “לשתול” את המספרים הללו בתור מקדמים של טור חזקות, &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt; ואז פתאום אנחנו מסוגלים לעשות עם הטור הזה מניפולציות מעניינות שמתורגמות לפעולות לא טריוויאליות על כל סדרת המספרים בבת אחת. זה כלי חזק ומרהיב.&lt;/p&gt;

&lt;p&gt;על הרעיון הבסיסי הזה יש כמה וריאציות מועילות, ואחת מהן היא מה שנקרא &lt;strong&gt;הפונקציה היוצרת האקספוננציאלית&lt;/strong&gt; של סדרת המספרים. כאן הרעיון הוא לשתול את המספרים בתוך הטור &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!} \)&lt;/span&gt; שמזכיר קצת את הטור של פונקציית האקספוננט (עבור הסדרה &lt;span&gt;\( a_{n}=1 \)&lt;/span&gt; מקבלים בדיוק את הטור של &lt;span&gt;\( e^{x} \)&lt;/span&gt;). איכשהו יצא לגמרי במקרה שדיברתי על הפונקציה הזו &lt;a href=&quot;https://gadial.net/2024/12/18/bernoulli_numbers/&quot;&gt;באחד מהפוסטים האחרונים&lt;/a&gt; בבלוג; זה לא יצא ככה בכוונה, פשוט היא כל כך מועילה שהיא מתעקשת לצוץ בשני הקשרים שונים כמעט בו זמנית (אחרי שמעולם לא כתבתי עליה קודם בבלוג לדעתי אבל נעזוב את זה).&lt;/p&gt;

&lt;p&gt;מה שנקרא בתורת ההסתברות &lt;strong&gt;פונקציה יוצרת מומנטים&lt;/strong&gt; הוא בדיוק זה - הפונקציה היוצרת האקספוננציאלית של סדרת המומנטים, אם כי נוח להגדיר אותה בצורה קצת שונה. ראשית, אני אשתמש במשתנה &lt;span&gt;\( t \)&lt;/span&gt; כדי לא לבלבל עם המשתנה המקרי &lt;span&gt;\( X \)&lt;/span&gt; שהוא מרכז הדיון שלנו. עכשיו, עם משתנה מקרי אפשר כזכור להשתגע בשלל צורות, כי בסופו של דבר מדובר במשהו שמחזיר מספרים ממשיים אז אפשר לעשות איתו דברים שאנחנו עושים עם מספרים ממשיים - למשל להסתכל על &lt;span&gt;\( e^{X} \)&lt;/span&gt;, שזה פשוט משתנה מקרי שאומר “תגריל תוצאה כלשהי, תבדוק מה הערך ש-&lt;span&gt;\( X \)&lt;/span&gt; נותן על התוצאה הזו, תעלה את &lt;span&gt;\( e \)&lt;/span&gt; בחזקת הערך הזה”. כדי לעשות את זה מעניין אני יכול גם לדחוף פנימה ערך מספרי &lt;span&gt;\( t \)&lt;/span&gt; כלשהו שאני מתייחס אליו כפרמטר ומכפיל אותו ב-&lt;span&gt;\( X \)&lt;/span&gt;, כלומר אני מסתכל על המשתנה המקרי &lt;span&gt;\( e^{tX} \)&lt;/span&gt;. אם זה משתנה מקרי, אפשר לחשב את התוחלת שלו, והיא תהיה תלויה בפרמטר &lt;span&gt;\( t \)&lt;/span&gt;, כלומר קיבלנו &lt;strong&gt;פונקציה&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M\left(t\right)=\text{E}\left[e^{tX}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו הפונקציה יוצרת המומנטים, ואנחנו ליטרלי יכולים להשתמש בה כדי &lt;strong&gt;ליצור&lt;/strong&gt; את המומנטים על ידי “חילוץ” המקדמים מתוך הטור של &lt;span&gt;\( e^{tX} \)&lt;/span&gt; על ידי גזירה, כמו שקורה בחדו”א עם מה שנקרא &lt;strong&gt;טור טיילור&lt;/strong&gt;. הנה איך שזה עובד:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M^{\prime}\left(t\right)=\left(\text{E}\left[e^{tX}\right]\right)^{\prime}=\text{E}\left[\left(e^{tX}\right)^{\prime}\right]=\text{E}\left[Xe^{tX}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אוקיי, קצת מיהרתי פה. אני מבצע &lt;strong&gt;החלפה&lt;/strong&gt; בין אופרטור התוחלת ואופרטור הגזירה במעבר האמצעי - למה זה מעבר לגיטימי? אם פותחים את ההגדרה של התוחלת במקרה הסופי מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[e^{tX}\right]=\sum_{i=1}^{k}P\left(X=a_{i}\right)e^{ta_{i}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואפשר להשתמש בכך שנגזרת היא לינארית, כלומר &lt;span&gt;\( \left(f+g\right)^{\prime}=f^{\prime}+g^{\prime} \)&lt;/span&gt;, מה שניתן להכללה באינדוקציה לכל סכום סופי, ולכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[\sum_{i=1}^{k}P\left(X=a_{i}\right)e^{ta_{i}}\right]^{\prime}=\sum_{i=1}^{k}P\left(X=a_{i}\right)\left(e^{ta_{i}}\right)^{\prime}=\sum_{i=1}^{k}P\left(X=a_{i}\right)a_{i}e^{ta_{i}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וקיבלנו בדיוק את הביטוי של &lt;span&gt;\( \text{E}\left[Xe^{tX}\right] \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;העניין הוא שמה שעובד עבור סכום &lt;strong&gt;סופי&lt;/strong&gt; לא בהכרח עובד במקרה של סכום אינסופי, או במקרה הרציף שבו התוחלת היא אינטגרל. כלומר, את הקסם הזה אי אפשר לעשות &lt;strong&gt;לכל&lt;/strong&gt; משתנה מקרי אלא רק לכאלו שהם “נחמדים מספיק”, אבל בואו לא ניכנס לתנאים המדויקים הפעם. במקום זה, בואו נראה איך אפשר להשתמש בזה: אם &lt;span&gt;\( M^{\prime}\left(t\right)=\text{E}\left[Xe^{tX}\right] \)&lt;/span&gt; אז &lt;span&gt;\( M^{\prime}\left(0\right)=\text{E}\left[X\right] \)&lt;/span&gt; וקיבלנו את המומנט הראשון.&lt;/p&gt;

&lt;p&gt;עכשיו, אפשר להמשיך לגזור את &lt;span&gt;\( Xe^{tX} \)&lt;/span&gt;. מכיוון שהנגזרת היא על פי &lt;span&gt;\( t \)&lt;/span&gt;, ה-&lt;span&gt;\( X \)&lt;/span&gt; שבו מוכפל &lt;span&gt;\( e^{tX} \)&lt;/span&gt; הוא בסך הכל קבוע, ולכן מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M^{\prime\prime}\left(t\right)=\text{E}\left[X^{2}e^{tX}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M^{\prime\prime}\left(0\right)=\text{E}\left[X^{2}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובאופן כללי נקבל &lt;span&gt;\( M^{\left(i\right)}=\text{E}\left[X^{i}\right] \)&lt;/span&gt;. זה בדיוק מה שקורה גם כשגוזרים את הטור &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!} \)&lt;/span&gt; בדיוק &lt;span&gt;\( i \)&lt;/span&gt; פעמים ומציבים &lt;span&gt;\( x=0 \)&lt;/span&gt;; מקבלים את &lt;span&gt;\( a_{i} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;איך כל זה מתקשר למשפט הגבול המרכזי? עם הטענה הבאה: אם יש לנו סדרה &lt;span&gt;\( Z_{1},Z_{2},\ldots \)&lt;/span&gt; של משתנים מקריים עם פונקציות צפיפות &lt;span&gt;\( F_{Z_{n}} \)&lt;/span&gt; ופונקציות יוצרות הסתברות &lt;span&gt;\( M_{Z_{n}} \)&lt;/span&gt;, ואם &lt;span&gt;\( Z \)&lt;/span&gt; הוא משתנה מקרי עם פונקציית צפיפות &lt;span&gt;\( F_{Z} \)&lt;/span&gt; ופונקציה יוצרת הסתברות &lt;span&gt;\( M_{Z} \)&lt;/span&gt;, אז אם מתקיים &lt;span&gt;\( \lim_{n\to\infty}M_{Z_{n}}\left(t\right)=M_{Z}\left(t\right) \)&lt;/span&gt; עבור כל &lt;span&gt;\( t \)&lt;/span&gt;, אז &lt;span&gt;\( F_{Z_{n}}\left(t\right)\to F_{Z}\left(t\right) \)&lt;/span&gt; עבור כל &lt;span&gt;\( t \)&lt;/span&gt; שעבורו &lt;span&gt;\( F_{Z}\left(t\right) \)&lt;/span&gt; רציפה. במילים אחרות - מספיק לנו להראות שאיפה של סדרת הפונקציות יוצרות המומנטים כדי להראות שאיפה של פונקציות הצפיפות, שהן לכאורה האובייקט המורכב יותר.&lt;/p&gt;

&lt;p&gt;הטענה הזו היא טענה &lt;strong&gt;כבדה&lt;/strong&gt;. כדי להוכיח אותה אני אצטרך כנראה פוסט שלם (או אפילו יותר) ולהיכנס למתמטיקה טכנית יותר מאשר אני רוצה כרגע. המטרה שלי בפוסטים הללו היא לראות איך זה שהתפלגות נורמלית היא מה שהיא גורר את משפט הגבול המרכזי; אז בואו נראה איך טענת העזר הזו מוכיחה לנו את משפט הגבול המרכזי.&lt;/p&gt;

&lt;h2&gt;הוכחת משפט הגבול המרכזי&lt;/h2&gt;

&lt;p&gt;בואו נזכיר שוב מה אנחנו רוצים להוכיח. אנחנו לוקחים סדרה &lt;span&gt;\( X_{1},X_{2},\ldots \)&lt;/span&gt; של משתנים מקריים בלתי תלויים שמתפלגים באותו אופן, עם תוחלת &lt;span&gt;\( \mu \)&lt;/span&gt; וסטיית תקן &lt;span&gt;\( \sigma \)&lt;/span&gt;, מגדירים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Z_{n}=\frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ומקבלים שהסדרה &lt;span&gt;\( Z_{n} \)&lt;/span&gt; שואפת להתפלגות הנורמלית &lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; כאשר &lt;span&gt;\( n \)&lt;/span&gt; שואף לאינסוף. מה שנוכיח הוא את המשפט למקרה שבו &lt;span&gt;\( \mu=0,\sigma=1 \)&lt;/span&gt;, כי אפשר לבצע רדוקציה מהמקרה הכללי למקרה הזה: אם נגדיר &lt;span&gt;\( Y_{i}=\frac{X_{i}-\mu}{\sigma} \)&lt;/span&gt; אז נקבל שהתוחלת של &lt;span&gt;\( Y_{i} \)&lt;/span&gt; היא 0 וסטיית התקן היא 1, ולכן &lt;span&gt;\( \frac{Y_{i}+\ldots+Y_{n}}{\sqrt{n}} \)&lt;/span&gt; שואפת אל &lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt;. עכשיו נציב את &lt;span&gt;\( Y_{i}=\frac{X_{i}-\mu}{\sigma} \)&lt;/span&gt; בביטוי &lt;span&gt;\( \frac{Y_{i}+\ldots+Y_{n}}{\sqrt{n}} \)&lt;/span&gt; ששואף ל-&lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; ונקבל את הביטוי &lt;span&gt;\( \frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)&lt;/span&gt; שגם שואף ל-&lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; כי זה אותו ביטוי.&lt;/p&gt;

&lt;p&gt;אם כן, מעתה והלאה נניח &lt;span&gt;\( \mu=0 \)&lt;/span&gt; ו-&lt;span&gt;\( \sigma=1 \)&lt;/span&gt; ולכן &lt;span&gt;\( Z_{n}=\frac{X_{1}+\ldots+X_{n}}{\sqrt{n}}=\frac{X_{1}}{\sqrt{n}}+\ldots+\frac{X_{n}}{\sqrt{n}} \)&lt;/span&gt;. המטרה שלי היא למצוא את &lt;span&gt;\( M_{Z_{n}}\left(t\right) \)&lt;/span&gt; - הפונקציה יוצרת המומנטים של &lt;span&gt;\( Z_{n} \)&lt;/span&gt;, ולראות לאן היא שואפת (כשאני אראה לאן היא שואפת זה מה ש&lt;strong&gt;יכתיב&lt;/strong&gt; לי את האופן שבו התפלגות נורמלית אמורה להיראות). מכיוון שהצגתי את &lt;span&gt;\( Z_{n} \)&lt;/span&gt; בתור סכום סופי, בואו קודם נראה איך הפונקציה יוצרת המומנטים של כל איבר בסכום נראית.&lt;/p&gt;

&lt;p&gt;ראשית, עבור &lt;span&gt;\( X_{i} \)&lt;/span&gt;, הפונקציה יוצרת המומנטים שלו היא &lt;span&gt;\( M\left(t\right)=\text{E}\left[e^{tX_{i}}\right] \)&lt;/span&gt;. שנית, עבור האיבר המנורמל &lt;span&gt;\( \frac{X_{i}}{\sqrt{n}} \)&lt;/span&gt; הפונקציה יוצרת המומנטים היא &lt;span&gt;\( \text{E}\left[e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\text{E}\left[e^{\frac{t}{\sqrt{n}}X_{i}}\right]=M\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;. ולכן עכשיו נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M_{Z_{n}}\left(t\right)=\text{E}\left[e^{tZ_{n}}\right]=\text{E}\left[e^{t\sum_{i=1}^{n}\frac{X_{i}}{\sqrt{n}}}\right]=\text{E}\left[\prod_{i=1}^{n}e^{t\frac{X_{i}}{\sqrt{n}}}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כי זה הקסם של אקספוננט - סכום במעריך הופך למכפלת אקספוננטים (על פי כללי החזקות: &lt;span&gt;\( e^{a+b}=e^{a}\cdot e^{b} \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;עכשיו, זה &lt;strong&gt;בהחלט לא נכון&lt;/strong&gt; באופן כללי שתוחלת של מכפלה היא מכפלת התוחלות, כלומר &lt;span&gt;\( \text{E}\left[XY\right]\ne\text{E}\left[X\right]\text{E}\left[Y\right] \)&lt;/span&gt; באופן כללי, וזה די ברור - אם זה היה נכון, היינו מקבלים ש-&lt;span&gt;\( \text{E}\left[X^{2}\right]=\text{E}\left[X\right]^{2} \)&lt;/span&gt; וכל מושג סטיית התקן היה נעלם. אבל השוויון &lt;span&gt;\( \text{E}\left[XY\right]=\text{E}\left[X\right]\text{E}\left[Y\right] \)&lt;/span&gt; דווקא &lt;strong&gt;כן נכון&lt;/strong&gt; אם &lt;span&gt;\( X,Y \)&lt;/span&gt; הם משתנים מקריים בלתי תלויים, וזה בדיוק מה שאני מניח כאן - שכל אברי הסדרה &lt;span&gt;\( X_{1},X_{2},\ldots,X_{n} \)&lt;/span&gt; הם בלתי תלויים, ולכן גם המשתנים &lt;span&gt;\( e^{t\frac{X_{i}}{\sqrt{n}}} \)&lt;/span&gt; שנבנים מתוכם. כך שאני מקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[\prod_{i=1}^{n}e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\prod_{i=1}^{n}\text{E}\left[e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\prod_{i=1}^{n}M\left(\frac{t}{\sqrt{n}}\right)=\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז מה שאנחנו רוצים להבין הוא את הגבול &lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt;. זה בעצם המקום הראשון שבו קופץ לעיניים למה “צריך” ש-&lt;span&gt;\( e \)&lt;/span&gt; יופיע בהתפלגות נורמלית. כזכור, אחת מהדרכים השקולות לתאר את &lt;span&gt;\( e^{x} \)&lt;/span&gt; היא באמצעות גבול: &lt;span&gt;\( e^{x}=\lim_{n\to\infty}\left(1+\frac{x}{n}\right)^{n} \)&lt;/span&gt;, אז העובדה שיש לנו בביטוי &lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt; גבול שתלוי ב-&lt;span&gt;\( n \)&lt;/span&gt;, חזקה שהיא &lt;span&gt;\( n \)&lt;/span&gt; ואיבר פנימי שהוא &lt;span&gt;\( \frac{t}{\sqrt{n}} \)&lt;/span&gt; זה… מעורר חשד.&lt;/p&gt;

&lt;p&gt;עכשיו, איך מטפלים בביטוי &lt;span&gt;\( \left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt;? ה-&lt;span&gt;\( n \)&lt;/span&gt; במעריך הוא מעצבן, והדרך הסטנדרטית להיפטר ממנו היא לקחת לוגריתם להכל, כי &lt;span&gt;\( \left(a^{n}\right)=n\log a \)&lt;/span&gt;&lt;span&gt;\( \log \)&lt;/span&gt;. אז בואו נשאל את עצמנו מהו הגבול&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}n\log M\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם הגבול הזה יהיה &lt;span&gt;\( A \)&lt;/span&gt; והלוגריתם שלי הוא על בסיס &lt;span&gt;\( a \)&lt;/span&gt;, אז הגבול של &lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt; יהיה &lt;span&gt;\( a^{A} \)&lt;/span&gt;. איזה בסיס של לוגריתם &lt;strong&gt;כדאי לי&lt;/strong&gt; לבחור? אני לא רוצה שיהיו לי החלטות שרירותיות, אז בואו נתקדם עם ההוכחה ונראה איזה בסיס יצוץ מאליו (ספוילר: &lt;span&gt;\( e \)&lt;/span&gt;. זה תמיד &lt;span&gt;\( e \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;אם כן, הביטוי שאנחנו צריכים להבין עכשיו הוא הפונקציה &lt;span&gt;\( \log M\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;. הכל נהיה פשוט יותר אחרי שיש לנו סימונים, אז נסמן: &lt;span&gt;\( L\left(t\right)=\log M\left(t\right) \)&lt;/span&gt;, ועכשיו אנחנו רוצים להבין את הגבול &lt;span&gt;\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;. איך עושים את זה? אין לי מושג, אבל לגשש בצורה עיוורת אפשר, ואחד מהכלים המועילים שיש לנו בחישוב גבולות הוא &lt;strong&gt;כלל לופיטל&lt;/strong&gt;. הרעיון בו פשוט: אם &lt;span&gt;\( f\left(x\right),g\left(x\right) \)&lt;/span&gt; הן שתי פונקציות כך ש-&lt;span&gt;\( \lim_{x\to\infty}f\left(x\right)=\lim_{x\to\infty}g\left(x\right)=0 \)&lt;/span&gt; אז &lt;span&gt;\( \lim_{x\to\infty}\frac{f\left(x\right)}{g\left(x\right)}=\lim_{x\to\infty}\frac{f^{\prime}\left(x\right)}{g^{\prime}\left(x\right)} \)&lt;/span&gt;. כלומר, בדומה לאינטגרציה בחלקים שבה השתמשתי בפוסט הקודם, גם כאן אפשר לחשב דברים על ידי גזירה של הפונקציות הרלוונטיות עד שיהיו פשוטות מספיק.&lt;/p&gt;

&lt;p&gt;אצלנו הגבול הוא לא של פונקציות אלא של סדרה, אבל כל עוד הפונקציות המעורבות הן רציפות מקבלים אותו דבר. אבל בשביל להשתמש בלופיטל אנחנו צריכים &lt;strong&gt;מנה &lt;/strong&gt;של שתי פונקציות ששואפות לאפס: אצלנו יש &lt;strong&gt;מכפלה&lt;/strong&gt; של שתי פונקציות, &lt;span&gt;\( nL\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;, שאחת מהן (&lt;span&gt;\( n \)&lt;/span&gt;) בכלל שואפת לאינסוף… אה, הטריק פה הוא פשוט מאוד: &lt;span&gt;\( nL\left(\frac{t}{\sqrt{n}}\right)=\frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}} \)&lt;/span&gt;, ועכשיו הפונקציה במכנה היא &lt;span&gt;\( \frac{1}{n} \)&lt;/span&gt; ששואפת לאפס כש-&lt;span&gt;\( n\to\infty \)&lt;/span&gt;. ומה קורה במונה? הרציפות של &lt;span&gt;\( L \)&lt;/span&gt; אומרת ש-&lt;span&gt;\( L\left(\frac{t}{\sqrt{n}}\right)\to L\left(0\right) \)&lt;/span&gt;, אבל מהו &lt;span&gt;\( L\left(0\right) \)&lt;/span&gt;? ומה נקבל אחרי שנגזור?&lt;/p&gt;

&lt;p&gt;ובכן, כזכור &lt;span&gt;\( L\left(t\right)=\log M\left(t\right) \)&lt;/span&gt;. מכיוון ש-&lt;span&gt;\( M\left(t\right)=\text{E}\left[e^{tX_{i}}\right] \)&lt;/span&gt; הרי ש-&lt;span&gt;\( M\left(0\right)=\text{E}\left[e^{0\cdot X_{i}}\right]=\text{E}\left[1\right]=1 \)&lt;/span&gt; כך ש-&lt;span&gt;\( L\left(0\right)=\log1=0 \)&lt;/span&gt;. זה טוב, זה בדיוק מה שאנחנו רוצים. עכשיו, מה עם הנגזרת? יש לנו כאן עסק עם הרכבה של פונקציות: &lt;span&gt;\( \log \)&lt;/span&gt; שמורכבת על &lt;span&gt;\( M \)&lt;/span&gt;. זה מצריך מאיתנו שני דברים: את הכלל של נגזרת של לוגריתם, ואת כלל השרשרת. והכלל לנגזרת של לוגריתם הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(\log_{a}t\right)^{\prime}=\frac{1}{t\ln a} \)&lt;/span&gt;, כאשר &lt;span&gt;\( \ln \)&lt;/span&gt; הוא לוגריתם על בסיס &lt;span&gt;\( e \)&lt;/span&gt;. הביטוי הזה הופך לפשוט יותר אם מלכתחילה הלוגריתם שלנו הוא על בסיס &lt;span&gt;\( e \)&lt;/span&gt;; אז מקבלים &lt;span&gt;\( \left(\log t\right)^{\prime}=\frac{1}{t} \)&lt;/span&gt;. אז יש לנו סיבה טובה לבחור שהלוגריתם שלנו יהיה על בסיס &lt;span&gt;\( e \)&lt;/span&gt;, מה שאומר שאחרי שנצליח לחשב את &lt;span&gt;\( \lim_{n\to\infty}n\log M\left(\frac{t}{\sqrt{n}}\right)=A \)&lt;/span&gt;, נקבל ש-&lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n}=e^{A} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, על פי כלל השרשרת &lt;span&gt;\( \left[f\left(g\left(x\right)\right)\right]^{\prime}=f^{\prime}\left(g\left(x\right)\right)g^{\prime}\left(x\right) \)&lt;/span&gt; אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( L^{\prime}=\left(\log M\right)^{\prime}=\frac{M^{\prime}}{M} \)&lt;/span&gt; (יש לדבר כזה שם - “הנגזרת הלוגריתמית” של &lt;span&gt;\( M \)&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;ראינו כבר ש-&lt;span&gt;\( M\left(0\right)=1 \)&lt;/span&gt;. כמו כן, &lt;span&gt;\( M^{\prime}\left(0\right)=\text{E}\left[X\right]=\mu=0 \)&lt;/span&gt; (זוכרים? ראינו שככה פונקציה יוצרת מומנטים עובדת). אז קיבלנו ש-&lt;span&gt;\( L^{\prime}\left(0\right)=0 \)&lt;/span&gt;, מה שאומר שכלל לופיטל צפוי להיתקל בקשיים כי גם אחרי הגזירה המונה ישאף ל-0. אבל אפשר לגזור שוב! הפעם נשתמש בכלל לגזירה של מנה, &lt;span&gt;\( \left(\frac{f}{g}\right)^{\prime}=\frac{f^{\prime}g-fg^{\prime}}{g^{2}} \)&lt;/span&gt; ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( L^{\prime\prime}=\left(\frac{M^{\prime}}{M}\right)^{\prime}=\frac{M^{\prime\prime}M-\left(M^{\prime}\right)^{2}}{M^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן כשנציב &lt;span&gt;\( 0 \)&lt;/span&gt; ונשתמש בכך ש-&lt;span&gt;\( M\left(0\right)=1,M^{\prime}\left(0\right)=0,M^{\prime\prime}\left(0\right)=\text{E}\left[X^{2}\right]=\sigma^{2}+\mu^{2}=1 \)&lt;/span&gt;, נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( L^{\prime\prime}\left(0\right)=\frac{1-0^{2}}{1}=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה כבר משהו לעבוד איתו! כל מה שנשאר לנו הוא לקחת את הביטוי &lt;span&gt;\( \frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}} \)&lt;/span&gt; ולגזור בו (בנפרד!) את המונה והמכנה פעמיים. זה לא יהיה כזה נורא, נכון? נקודה אחת שצריך לשים לב אליה היא שהגזירה שלנו היא ביחס למשתנה &lt;span&gt;\( n \)&lt;/span&gt;, ואילו דווקא אל &lt;span&gt;\( t \)&lt;/span&gt; אנחנו מתייחסים בתור קבוע, כי הגבול שלנו הוא כש-&lt;span&gt;\( n \)&lt;/span&gt; רץ לאינסוף. זה הופך את הכל לטיפה יותר מסובך.&lt;/p&gt;

&lt;p&gt;כלל הגזירה הבסיסי ביותר הוא &lt;span&gt;\( \left(x^{a}\right)^{\prime}=ax^{a-1} \)&lt;/span&gt;. מכאן נקבל ש-&lt;span&gt;\( \left(n^{-1}\right)^{\prime}=-n^{-2} \)&lt;/span&gt; וש-&lt;span&gt;\( \left(\frac{1}{\sqrt{n}}\right)^{\prime}=\left(n^{-\frac{1}{2}}\right)^{\prime}=-\frac{1}{2}n^{-\frac{3}{2}} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;הנגזרת של &lt;span&gt;\( L\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; על פי כלל השרשרת היא &lt;span&gt;\( \left(\frac{t}{\sqrt{n}}\right)^{\prime}L^{\prime}\left(\frac{t}{\sqrt{n}}\right)=-\frac{t}{2}n^{-\frac{3}{2}}L^{\prime}\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; , ולכן מכלל לופיטל אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}\frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}}=\lim_{n\to\infty}\frac{-\frac{t}{2}n^{-\frac{3}{2}}L^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{-n^{-2}}=\lim_{n\to\infty}\frac{tL^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{2n^{-1/2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המונה עדיין שואף לאפס כש-&lt;span&gt;\( n\to\infty \)&lt;/span&gt; (כי ראינו &lt;span&gt;\( L^{\prime}\left(0\right)=0 \)&lt;/span&gt;) והמכנה, שהוא עכשיו &lt;span&gt;\( -\frac{2}{\sqrt{n}} \)&lt;/span&gt;, גם כן שואף לאפס, אז אפשר להשתמש שוב בכלל לופיטל. הנגזרת של המכנה תהיה &lt;span&gt;\( \left(2n^{-\frac{1}{2}}\right)^{\prime}=-n^{-\frac{3}{2}} \)&lt;/span&gt;. המונה יהיה כמו קודם (אל ה-&lt;span&gt;\( t \)&lt;/span&gt; שמופיע שם אנחנו כאמור מתייחסים בתור קבוע והוא לא משפיע על הגזירה). לכן נקבל מכלל לופיטל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}\frac{tL^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{2n^{-1/2}}=\lim_{n\to\infty}\frac{-\frac{t^{2}}{2}n^{-\frac{3}{2}}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right)}{-n^{-3/2}}=\lim_{n\to\infty}\frac{t^{2}}{2}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הופה! העלמנו לגמרי את מה שהופיע במכנה! ועכשיו, בגלל ש-&lt;span&gt;\( L^{\prime\prime}\left(0\right)=1 \)&lt;/span&gt;, אנחנו מקבלים גבול פשוט במיוחד: &lt;span&gt;\( \lim_{n\to\infty}\frac{t^{2}}{2}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right)=\frac{t^{2}}{2} \)&lt;/span&gt;. זה אומר שמצאנו את מה שהפונקציה יוצרת המומנטים של &lt;span&gt;\( Z_{n} \)&lt;/span&gt; שואפת אליו: &lt;span&gt;\( \lim_{n\to\infty}M_{Z_{n}}\left(t\right)=e^{\frac{t^{2}}{2}} \)&lt;/span&gt;. זה, סוף כל סוף, מסביר מאיפה מגיע &lt;span&gt;\( e^{\frac{t^{2}}{2}} \)&lt;/span&gt; להתפלגות הנורמלית - לפחות מבחינה טכנית - אם כי יש עוד שלב לא טריוויאלי אחד שצריך להתגבר עליו.&lt;/p&gt;

&lt;h2&gt;הפונקציה יוצרת המומנטים של התפלגות נורמלית&lt;/h2&gt;

&lt;p&gt;ההוכחה עדיין לא בדיוק הסתיימה. מה שהראיתי הוא שאם &lt;span&gt;\( Z \)&lt;/span&gt; הוא משתנה מקרי עם פונקציה יוצרת מומנטים &lt;span&gt;\( M_{Z}\left(t\right)=e^{\frac{t^{2}}{2}} \)&lt;/span&gt; אז הפונקציה יוצרת המומנטים של אברי הסדרה &lt;span&gt;\( Z_{n} \)&lt;/span&gt; תתכנס לפונקציה יוצרת המומנטים של &lt;span&gt;\( Z \)&lt;/span&gt;. המסקנה, מטענת העזר שציטטתי בלי הוכחה, היא ש-&lt;span&gt;\( F_{Z_{n}}\left(t\right) \)&lt;/span&gt; מתכנסת אל &lt;span&gt;\( F_{Z}\left(t\right) \)&lt;/span&gt;. אבל מהי פונקציית הצפיפות &lt;span&gt;\( F_{Z}\left(t\right) \)&lt;/span&gt;? זה השלב שבו צריך לקחת את ההתפלגות הנורמלית, לחשב את הפונקציה יוצרת המומנטים שלה ולקבל &lt;span&gt;\( e^{\frac{t^{2}}{2}} \)&lt;/span&gt;. זה חישוב די פשוט בהינתן כל החישובים שכבר עברנו, אבל יש כאן גם שאלה מעניינת - האם אפשר ללכת “בכיוון השני”? להתחיל מהשוויון שצריך להתקיים ולהסיק איך ההתפלגות הנורמלית אמורה להיראות?&lt;/p&gt;

&lt;p&gt;באופן כללי אני יכול לסמן &lt;span&gt;\( F_{Z}\left(z\right)=f\left(z\right) \)&lt;/span&gt; ואז להשתמש בשוויון &lt;span&gt;\( e^{t^{2}/2}=\text{E}\left[e^{tZ}\right] \)&lt;/span&gt; כש-&lt;span&gt;\( \text{E}\left[e^{tZ}\right] \)&lt;/span&gt; הוא מה ש&lt;strong&gt;מגדיר&lt;/strong&gt; את הפונקציה יוצרת המומנטים, ולקבל שאני צריך שיתקיים השוויון&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( e^{t^{2}/2}=\int_{-\infty}^{\infty}e^{tz}f\left(z\right)dz \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הדבר הזה נקרא &lt;strong&gt;משוואה אינטגרלית&lt;/strong&gt;: בדומה למשוואה דיפרנציאלית, זו משוואה שבה הנעלם הוא לא סתם ערך מספרי אלא &lt;strong&gt;פונקציה&lt;/strong&gt;, והמידע שיש לנו על הפונקציה הזו מערב אינטגרל שלה. כמו עם משוואות דיפרנציאליות, פתרון משוואות אינטגרליות זה עניין מסובך והרבה פעמים לומר “אוקיי, בואו ננחש שהפתרון הוא מהצורה כך וכך…” הוא לגיטימי, אבל עבור המשוואה שלעיל דווקא יש שיטת פתרון כללית, פחות או יותר, בעזרת מה שנקרא &lt;strong&gt;התמרת לפלס&lt;/strong&gt;. להיכנס לזה לוקח אותי רחוק מדי ממה שאפשר לדבר עליו במרוכז כאן, אז בואו ננקוט בגישה השניה: נתחיל עם ההגדרה הידועה של &lt;span&gt;\( f\left(z\right) \)&lt;/span&gt; עבור התפלגות נורמלית ונראה שאנחנו מקבלים את השוויון למעלה. החישובים הספציפיים שנצטרך לבצע הם דומים למדי לחישובים שצריך לעשות אם פותרים את המשוואה האינטגרלית.&lt;/p&gt;

&lt;p&gt;אם כן, &lt;span&gt;\( f\left(z\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;, ולכן אנחנו מחשבים את האינטגרל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{tz}e^{-z^{2}/2}dz \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לב העניין הוא מה שהולך בחזקה של &lt;span&gt;\( e \)&lt;/span&gt;. בהתחלה כתוב שם&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( tz-\frac{z^{2}}{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לב הרעיון הטכני (גם פה וגם בגישת המשוואה האינטגרלית) הוא &lt;strong&gt;להשלים לריבוע&lt;/strong&gt; את הביטוי הזה; להכניס את ה-&lt;span&gt;\( z \)&lt;/span&gt;-ים בצורה יפה לסוגריים שאותם מעלים בריבוע, ואולי להוציא החוצה איזה קבוע שקשור ל-&lt;span&gt;\( t \)&lt;/span&gt;. זו בדיוק אותה השלמה לריבוע שאיתה גם פותרים משוואה ריבועית, &lt;a href=&quot;https://gadial.net/2023/12/16/quadratic_equations/&quot;&gt;כמו שהראיתי&lt;/a&gt; פעם בבלוג.&lt;/p&gt;

&lt;p&gt;אז ראשית, בואו נעשה חישובון:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( tz-\frac{z^{2}}{2}=-\frac{1}{2}\left(z^{2}-2tz\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שבתוך הסוגריים כבר די קרוב למשהו ריבועי! רק צריך להוסיף ולחסר &lt;span&gt;\( t^{2} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( -\frac{1}{2}\left(z^{2}-2tz\right)=-\frac{1}{2}\left(z^{2}-2tz+t^{2}-t^{2}\right)=\frac{t^{2}}{2}-\frac{1}{2}\left(z-t\right)^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בום! ה-&lt;span&gt;\( \frac{t^{2}}{2} \)&lt;/span&gt; שקיבלנו יהיה בדיוק אותו &lt;span&gt;\( \frac{t^{2}}{2} \)&lt;/span&gt; ב-&lt;span&gt;\( e^{t^{2}/2} \)&lt;/span&gt; שאנחנו מצפים לקבל בסוף הדרך. בואו נחזור אל האינטגרל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{tz}e^{-z^{2}/2}dz=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{t^{2}/2-\left(z-t\right)^{2}/2}dz \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להוציא את הקבוע החוצה, תוך שימוש בכך ש-&lt;span&gt;\( e^{a-b}=e^{a}e^{-b} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{t^{2}/2-\left(z-t\right)^{2}/2}dz=e^{t^{2}/2}\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\left(z-t\right)^{2}/2}dz \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;את האינטגרל &lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\left(z-t\right)^{2}/2}dz \)&lt;/span&gt; אנחנו כבר יודעים לחשב; שברנו עליו את הראש כשרצינו להוכיח שפונקציית הצפיפות של ההתפלגות הנורמלית מסתכמת ל-1. העובדה שאנחנו צריכים לעבור דרכו היא “חוק שימור הקושי” - גם אם הייתי מנסה ללכת דרך משוואות אינטגרליות הייתי צריך לצלול בים טכני של טענות כלליות על הלהטוטים שאנחנו יכולים לעשות במסגרת חדו”א; למזלי בגישה הנוכחית אני יכול פשוט לומר שכבר עשינו את זה. מה שראינו היה &lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx=1 \)&lt;/span&gt;, וזה בדיוק אותו הדבר כמו אצלנו עד כדי החלפת המשתנה &lt;span&gt;\( x=z-t \)&lt;/span&gt; שלא משפיעה על האינטגרל כי גבולות האינטגרציה הם ממילא מ-&lt;span&gt;\( -\infty \)&lt;/span&gt; עד &lt;span&gt;\( \infty \)&lt;/span&gt; והיעקוביאן של ההחלפה (שהוא במקרה הזה פשוט נגזרת) יוצא 1.&lt;/p&gt;

&lt;h2&gt;ולסיום - אז למה הדברים הם כמו שהם?&lt;/h2&gt;

&lt;p&gt;לסיום סדרת הפוסטים הזו, בואו נחזור אל הפונקציה שאותה רצינו להבין: &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt;, פונקציית הצפיפות של התפלגות נורמלית. בשלב הזה אנחנו כבר יודעים ש-&lt;span&gt;\( \pi \)&lt;/span&gt; כאן כדי להבטיח שהכל יסתכם ל-1, שה-&lt;span&gt;\( \mu \)&lt;/span&gt; וה-&lt;span&gt;\( \sigma \)&lt;/span&gt; מייצגים את התוחלת וסטיית התקן ואפשר לנרמל אותם החוצה ושהאקספוננט מגיע, בגדול, מזה שהפונקציה שמתארת התנהלות של סכום משתנים מקריים בלתי תלויים ומפולגים אחיד נראית כמו&lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt;. וזה בעצם מגיע אל מה שהטריד &lt;strong&gt;אותי&lt;/strong&gt; עם משפט הגבול המרכזי: מה זה ה-&lt;span&gt;\( \frac{1}{\sqrt{n}} \)&lt;/span&gt; הזה? למה כדי לנרמל מחלקים דווקא בו? מה קרה ל-&lt;span&gt;\( \frac{1}{n} \)&lt;/span&gt; הישן והטוב? ולמה לחלק בכלל? בתחילת הפוסט הזכרתי את השימוש שעשיתי במשפט הגבול המרכזי - פשוט חיברתי את ה-&lt;span&gt;\( X_{i} \)&lt;/span&gt;-ים שלי וקירבתי את התוצאה הזו עם עקומה נורמלית; בשביל לעשות את זה לא הספיק לדעת רק את &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; אלא הייתי צריך להכניס גם את &lt;span&gt;\( n \)&lt;/span&gt; למשוואה: כפלתי ב-&lt;span&gt;\( n \)&lt;/span&gt; גם את &lt;span&gt;\( \mu \)&lt;/span&gt; וגם את &lt;span&gt;\( \sigma^{2} \)&lt;/span&gt; (כלומר, בפועל כפלתי את &lt;span&gt;\( \sigma \)&lt;/span&gt; ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; והנה השורש צץ שוב).&lt;/p&gt;

&lt;p&gt;אבל מה היה קורה אם מלכתחילה הייתי מנרמל על ידי חלוקה ב-&lt;span&gt;\( n \)&lt;/span&gt; ולכן מגיע אל חישוב של &lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{n}\right)\right]^{n} \)&lt;/span&gt;? התשובה, כמובן, היא ששום דבר לא היה עובד. כזכור, כדי להתמודד עם הגבול הזה הגדרתי &lt;span&gt;\( L\left(t\right)=\log M\left(t\right) \)&lt;/span&gt; ואז חישבתי את הגבול &lt;span&gt;\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; באמצעות כלל לופיטל. עוד לפני שאומרים לופיטל, כבר ברור שהגבול &lt;span&gt;\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; קיים בכלל רק בזכות זה שיש פה שני כוחות שונים וסותרים שמאזנים אחד את השני. ה-&lt;span&gt;\( n \)&lt;/span&gt; שבו כופלים שואף לאינסוף, בעוד שה-&lt;span&gt;\( L\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; שואף לאפס. בגבולות מהצורה “משהו ששואף לאינסוף כפול משהו ששואף לאפס” פחות או יותר הכל יכול לקרות, והסיכוי שנקבל תוצאה סופית תלוי ביחסים העדינים בין שתי הפונקציות שאותם כופלים. כלל לופיטל הוא בדיוק דרך “לקלף” מעל שתי הפונקציות המעורבות שכבה אחר שכבה של סיבוכיות עד שמגיעים אל הגרעין העדין שלהן שאנחנו יודעים להשוות. ועכשיו חדל פילוסופיה ובואו נדבר תכל’ס. מה היה קורה אם היינו מחלקים ב-&lt;span&gt;\( n \)&lt;/span&gt; ולא ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt;? (אם לא היינו מחלקים &lt;strong&gt;בכלל&lt;/strong&gt; ב-&lt;span&gt;\( n \)&lt;/span&gt; אז היינו מקבלים &lt;span&gt;\( \lim_{n\to\infty}L\left(t\right)=L\left(t\right) \)&lt;/span&gt; וקבוע כפול אינסוף הוא אינסוף).&lt;/p&gt;

&lt;p&gt;בואו נעשה קופי-פייסט מההוכחה שכתבתי קודם ונחליף כל מופע של -&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; ב-&lt;span&gt;\( n \)&lt;/span&gt;, עם ההשלכות המתאימות:&lt;/p&gt;

&lt;p&gt;הנגזרת של &lt;span&gt;\( L\left(\frac{t}{n}\right) \)&lt;/span&gt; על פי כלל השרשרת היא &lt;span&gt;\( \left(\frac{t}{n}\right)^{\prime}L^{\prime}\left(\frac{t}{n}\right)=-tn^{-2}L^{\prime}\left(\frac{t}{n}\right) \)&lt;/span&gt; , ולכן מכלל לופיטל אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}\frac{L\left(\frac{t}{n}\right)}{n^{-1}}=\lim_{n\to\infty}\frac{-tn^{-2}L^{\prime}\left(\frac{t}{n}\right)}{-n^{-2}}=\lim_{n\to\infty}tL^{\prime}\left(\frac{t}{n}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה… טוב? נפטרנו לגמרי מהגורם שבמכנה! אבל ראינו קודם ש-&lt;span&gt;\( L^{\prime}\left(0\right)=0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( \lim_{n\to\infty}tL^{\prime}\left(\frac{t}{n}\right)=0 \)&lt;/span&gt;, וזה ממש לא טוב לנו. זה אומר שעבור המשתנה המקרי &lt;span&gt;\( Z_{n}=\frac{X_{1}+\ldots+X_{n}}{n} \)&lt;/span&gt; מתקיים &lt;span&gt;\( M_{Z}=e^{0}=1 \)&lt;/span&gt;, ובמילים אחרות - קיבלנו משתנה מקרי שכל המומנטים שלו הם 0. או, בניסוח שקצת יותר קל להבין - קיבלנו אפס. וזה לא אמור להיות מפתיע שקיבלנו אפס כי זה בדיוק מה שאומר &lt;strong&gt;אי-שוויון צ&apos;בישב&lt;/strong&gt; עבור התפלגויות שסטיית התקן שלהן היא אפס. כזכור, הוא אומר באופן כללי ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left|X-\mu\right|\ge k\right)\le\frac{\sigma^{2}}{k^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואם סטיית התקן &lt;span&gt;\( \sigma=0 \)&lt;/span&gt; זה אומר שלכל &lt;span&gt;\( k&amp;gt;0 \)&lt;/span&gt;, ההסתברות ש-&lt;span&gt;\( X \)&lt;/span&gt; יקבל ערך שסוטה מהתוחלת ולו ב-&lt;span&gt;\( k \)&lt;/span&gt; היא פשוט 0. עגול. לא קירוב ולא כלום. עכשיו שוב, צריך להזכיר שזה &lt;strong&gt;לא&lt;/strong&gt; אומר שהמשתנה המקרי הוא זהותית אפס; כשאנחנו עוסקים במשתנים מקריים רציפים כל מה שזה יכול לומר הוא שמידת ההסתברות של קבוצת כל התוצאות ששונות מ-&lt;span&gt;\( \mu \)&lt;/span&gt; היא אפס.&lt;/p&gt;

&lt;p&gt;את מה שראינו עכשיו אפשר לקחת טיפה יותר רחוק. בפוסט הקודם הגדרתי &lt;span&gt;\( \overline{X}_{n}=\frac{X_{1}+X_{2}\ldots+X_{n}}{n} \)&lt;/span&gt; (שזה בדיוק מה שקראתי לו כאן &lt;span&gt;\( Z_{n} \)&lt;/span&gt;) ואז הוכחתי שבהסתברות 1 מתקיים &lt;span&gt;\( \overline{X}_{n}\to\mu \)&lt;/span&gt;. התוצאה הזו, שנקראה &lt;strong&gt;החוק החזק של המספרים הגדולים&lt;/strong&gt;, דיברה על ההתנהגות של כל הסדרה &lt;span&gt;\( \overline{X}_{n} \)&lt;/span&gt; “בבת אחת”. אפשר לדבר על זה גם מזווית טיפה שונה. הרי אנחנו יודעים ש-&lt;span&gt;\( \overline{X}_{n} \)&lt;/span&gt; לא בהכרח יהיה &lt;strong&gt;שווה&lt;/strong&gt; לתוחלת - אנחנו צריכים לקחת עוד ועוד איברים ולהגדיל את &lt;span&gt;\( n \)&lt;/span&gt; כדי שהממוצע יתקרב לתוחלת וגם אז הסיכוי שהוא יהיה שווה לה הוא לא בהכרח גדול. אבל אפשר להעריך בצורה גסה מה יהיה גודל הטעות, בעזרת צ’בישב.&lt;/p&gt;

&lt;p&gt;אז נניח שיש לי משתנה &lt;span&gt;\( X \)&lt;/span&gt; כך ש-&lt;span&gt;\( \text{E}\left[X\right]=\mu \)&lt;/span&gt; ו-&lt;span&gt;\( \text{Var}\left(X\right)=\sigma^{2} \)&lt;/span&gt;. עכשיו בניתי משתנה חדש, &lt;span&gt;\( \overline{X}_{n}=\frac{X_{1}+\ldots+X_{n}}{n} \)&lt;/span&gt;. מה התוחלת שלו? לינאריות התוחלת נותנת לנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[\overline{X}_{n}\right]=\text{E}\left[\frac{X_{1}+\ldots+X_{n}}{n}\right]=\frac{\text{E}\left[X_{1}\right]+\ldots+\text{E}\left[X_{n}\right]}{n}=\frac{\mu+\ldots+\mu}{n}=\mu \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, שונות של משתנים מקריים לא מקיימת לינאריות באופן כללי, אבל היא &lt;strong&gt;כן&lt;/strong&gt; משמרת חיבור של משתנים מקריים &lt;strong&gt;בלתי תלויים&lt;/strong&gt; (די בדומה לאיך שתוחלת של מכפלה של משתנים בלתי תלויים מתפרקת למכפלת תוחלות). בפוסט הקודם גם הזכרתי ש-&lt;span&gt;\( \text{Var}\left(\alpha X\right)=\alpha^{2}X \)&lt;/span&gt;. לכן אפשר לחשב:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(\overline{X}_{n}\right)=\text{Var}\left(\frac{X_{1}+\ldots+X_{n}}{n}\right)=\frac{\text{Var}\left(X_{1}\right)+\ldots+\text{Var}\left(X_{n}\right)}{n^{2}}=\frac{\sigma^{2}+\ldots\sigma^{2}}{n^{2}}=\frac{\sigma^{2}}{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן מאי-שוויון צ’בישב:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left|\overline{X}_{n}-\mu\right|\ge\varepsilon\right)\le\frac{\sigma^{2}}{n\varepsilon^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המספר המעניין פה הוא ה-&lt;span&gt;\( n \)&lt;/span&gt; שנשאר במכנה. בזכותו, אם משאיפים את &lt;span&gt;\( n \)&lt;/span&gt; לאינסוף, מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}P\left(\left|\overline{X}_{n}-\mu\right|\ge\varepsilon\right)=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה מה שנקרא &lt;strong&gt;החוק החלש של המספרים הגדולים&lt;/strong&gt; (כי החוק החזק של המספרים הגדולים גורר אותו - ה”התכנסות” שלו היא חזקה יותר מההתכנסות שיש בחוק החלש) וזו דרך קצת יותר פשוטה לראות את “חוסר הטעם” שבהסתכלות על הממוצעים &lt;span&gt;\( \overline{X}_{n} \)&lt;/span&gt; אם אנחנו רוצים לקבל משתנה מקרי שמדמה את ההתפלגות של &lt;span&gt;\( X_{1}+\ldots+X_{n} \)&lt;/span&gt; כש-&lt;span&gt;\( n \)&lt;/span&gt; גדול. המיצוע שאנחנו עושים הוא “טוב מדי” - הוא משמר את המידע על ההתפלגות שבא לידי ביטוי בתוחלת &lt;span&gt;\( \mu \)&lt;/span&gt; אבל מוחק את המידע על ההתפלגות שבא לידי ביטוי בסטיית התקן &lt;span&gt;\( \sigma \)&lt;/span&gt;. המיצוע שבו מחלקים ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; הוא “עדין” יותר ומשמר גם את המידע הזה, והוכחת החוק החלש של המספרים הגדולים נותנת עוד דרך לראות את זה - אם היינו מחלקים ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; ומנסים להשתמש בצ’בישב, היינו מקבלים רק &lt;span&gt;\( P\left(\left|\frac{X_{1}+\ldots+X_{n}}{\sqrt{n}}-\mu\right|\ge\varepsilon\right)\le\frac{\sigma^{2}}{\varepsilon^{2}} \)&lt;/span&gt; שזו תוצאה מעניינת טיפה בפני עצמה אבל אין בה שאיפה לאפס של ההסתברות אלא רק חסם אחיד לכל הממוצעים, לא משנה כמה רחוק ניקח אותם.&lt;/p&gt;

&lt;p&gt;הקסם הגדול של משפט הגבול המרכזי בעיני, כמו שאמרתי כבר לפני כמה פוסטים, הוא שלא משנה כמה המשתנה &lt;span&gt;\( X \)&lt;/span&gt; שאנחנו מתחילים איתו הוא מורכב ומתוסבך - ההתנהגות של &lt;span&gt;\( X_{1}+\ldots+X_{n} \)&lt;/span&gt; תהיה ניתנת לקירוב מצוין רק עם שני הפרמטרים המספריים &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt;. ראינו את זה בתוך ההוכחה של משפט הגבול המרכזי עצמו (היינו צריכים רק לדעת את &lt;span&gt;\( L^{\prime}\left(0\right) \)&lt;/span&gt; ואת &lt;span&gt;\( L^{\prime\prime}\left(0\right) \)&lt;/span&gt; כדי לקבל אותו ולא משהו שתלוי במומנטים מתקדמים יותר) וראינו את זה גם עם החוק החלש של המספרים הגדולים עכשיו (אם המומנט השני הוא אפס גורלה של ההתפלגות נחרץ להיות קבועה בהסתברות 1), אבל למרות שראינו את זה אני עדיין מתקשה להאמין לזה. אולי כי זו לא סתם תוצאה מספרית - זה משהו שבאמת בא לידי ביטוי אמפירית, במציאות, בעולם שלנו, ומשפיע עלינו בשלל דרכים שונות. גם זה אחד מהקסמים של המתמטיקה.&lt;/p&gt;</content><author><name></name></author><category term="התפלגות נורמלית" /><summary type="html">אז מה משפט הגבול המרכזי אומר?</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/2025/histogram_10.png" /><media:content medium="image" url="http://gadial.net/assets/img/2025/histogram_10.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מה הקטע עם התפלגות נורמלית? (חלק ג’: על תוחלת וסטיית תקן)</title><link href="http://gadial.net/2025/02/05/normal_distribution_3/" rel="alternate" type="text/html" title="מה הקטע עם התפלגות נורמלית? (חלק ג&apos;: על תוחלת וסטיית תקן)" /><published>2025-02-05T00:00:00+00:00</published><updated>2025-02-05T00:00:00+00:00</updated><id>http://gadial.net/2025/02/05/normal_distribution_3</id><content type="html" xml:base="http://gadial.net/2025/02/05/normal_distribution_3/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;בסדרת הפוסטים הנוכחית אנחנו מנסים להבין למה ההתפלגות הנורמלית &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt; נראית כמו שהיא נראית. &lt;a href=&quot;https://gadial.net/2025/02/03/normal_distribution_2/&quot;&gt;בפוסט הקודם&lt;/a&gt; הבנו מה הפונקציה הזו בכלל אומרת - זו &lt;strong&gt;פונקציית צפיפות ההסתברות&lt;/strong&gt; של ההתפלגות הנורמלית, כלומר אם &lt;span&gt;\( X \)&lt;/span&gt; הוא המשתנה המקרי שמתואר על ידי הפונקציה הזו, אז &lt;span&gt;\( P\left(a\le X\le b\right)=\int_{a}^{b}\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}dx \)&lt;/span&gt;. בפוסט הקודם גם ראינו מאיפה ה-&lt;span&gt;\( \pi \)&lt;/span&gt; הגיע - זה קבוע נרמול שנדרש כדי שיתקיים &lt;span&gt;\( \int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{x^{2}}{2}}=1 \)&lt;/span&gt;. אבל מה הם ה-&lt;span&gt;\( \mu \)&lt;/span&gt; וה-&lt;span&gt;\( \sigma \)&lt;/span&gt; שמופיעים בנוסחה? אלו שני פרמטרים שמאפיינים לא רק את ההתפלגות הזו, אלא כל התפלגות שהיא: &lt;strong&gt;התוחלת&lt;/strong&gt; &lt;span&gt;\( \mu \)&lt;/span&gt; של ההתפלגות, &lt;strong&gt;וסטיית התקן&lt;/strong&gt; &lt;span&gt;\( \sigma \)&lt;/span&gt; שלה. באופן לא פורמלי, תוחלת של התפלגות היא הממוצע שלה, וסטיית התקן מלמדת אותנו כמה גדול הפיזור של ההתפלגות סביב הממוצע הזה. מה שמפליא הוא כמה מידע על ההתפלגות נמצא כבר בשני הערכים המספריים הללו - וההמחשה לזה היא בדיוק &lt;strong&gt;משפט הגבול המרכזי&lt;/strong&gt;, שאומר שאם אנחנו יודעים את התוחלת וסטיית התקן של התפלגות, אז נדע בדיוק איך נראה מה שמתקבל מסכומים גדולים של משתנים מקריים בלתי תלויים בעלי ההתפלגות הזו.&lt;/p&gt;

&lt;p&gt;בואו נעבור להגדרות פורמליות, ונראה איך זה בא לידי ביטוי בהתפלגות נורמלית ובהתפלגויות אחרות שראינו.&lt;/p&gt;

&lt;h2&gt;תוחלת&lt;/h2&gt;

&lt;p&gt;מה זה “ממוצע”? אם למשל יש לנו את סדרת המספרים &lt;span&gt;\( 10,30,50,60,90 \)&lt;/span&gt; הממוצע שלה היא הסכום של כל המספרים חלקי כמה מספרים יש: &lt;span&gt;\( \frac{10+30+50+60+90}{5}=\frac{240}{5}=48 \)&lt;/span&gt;. מה המשמעות של המספר הזה, 48? אפשר לחשוב על זה כך: אם נחליף כל איבר בסדרה ב-48, נקבל סדרה &lt;span&gt;\( 48,48,48,48,48 \)&lt;/span&gt; שסכום האיברים שלה שווה לסכום אברי הסדרה המקורית.&lt;/p&gt;

&lt;p&gt;את הרעיון הזה אפשר להכליל קצת: אם למשל הסדרה שלנו היא &lt;span&gt;\( 30,60,60 \)&lt;/span&gt; אז הממוצע שלה הוא &lt;span&gt;\( 50 \)&lt;/span&gt;, אבל אפשר גם “לאחד” את שני ה-60-ים ולהגיד שיש בסדרה שלנו שני איברים: האיבר &lt;span&gt;\( 30 \)&lt;/span&gt; עם &lt;strong&gt;המשקל&lt;/strong&gt; 1, והאיבר &lt;span&gt;\( 60 \)&lt;/span&gt; עם &lt;strong&gt;המשקל&lt;/strong&gt; 2. מה שאנחנו עושים הוא לסכום את האיברים כשכל אחד מוכפל במשקל שלו, ולחלק בסכום הכולל של המשקלים. אולי קל יותר להבין את זה עם נוסחה: אם יש לנו את הסדרה &lt;span&gt;\( a_{1},a_{2},\ldots,a_{n} \)&lt;/span&gt; ואת המשקלים &lt;span&gt;\( w_{1},\ldots,w_{n} \)&lt;/span&gt; אז &lt;strong&gt;הממוצע המשוקלל&lt;/strong&gt; הוא &lt;span&gt;\( \frac{\sum_{i=1}^{n}w_{i}a_{i}}{\sum_{i=1}^{n}w_{i}} \)&lt;/span&gt;. כאשר כל המשקלים הם 1 אנחנו מקבלים את הגדרת הממוצע הקודמת.&lt;/p&gt;

&lt;p&gt;ההגדרה של ממוצע משוקלל לא דורשת שום דבר מהמשקלים, חוץ מכך שהסכום שלהם יהיה שונה מאפס (אחרת יקרה משהו מוזר כשמנסים לחלק) אבל כמובן, ההגדרה הזו יוצאת פשוטה במיוחד אם &lt;span&gt;\( 0\le w_{i}\le1 \)&lt;/span&gt; ובנוסף &lt;span&gt;\( \sum_{i=1}^{n}w_{i} \)&lt;/span&gt;; אנחנו מקבלים שהממוצע המשוקלל הוא פשוט &lt;span&gt;\( \sum_{i=1}^{n}w_{i}a_{i} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;איך כל זה קשור להסתברות? ובכן, הסתברות היא בדיוק המקרה שבו יש לנו איברים &lt;span&gt;\( 0\le w_{i}\le1 \)&lt;/span&gt; שמסתכמים ל-1: אם יש לנו מרחב הסתברות ו-&lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי שמקבל מספר &lt;strong&gt;סופי&lt;/strong&gt; של ערכים, נאמר הערכים &lt;span&gt;\( a_{1},a_{2},\ldots,a_{n} \)&lt;/span&gt;, אז אפשר להסתכל על הממוצע המשוקלל &lt;span&gt;\( \sum_{i=1}^{n}P\left(X=a_{i}\right)\cdot a_{i} \)&lt;/span&gt;. כלומר, אנחנו לוקחים את הממוצע המשוקלל של ה-&lt;span&gt;\( a_{i} \)&lt;/span&gt;-ים כשהמשקולות הן בדיוק ההסתברויות ש-&lt;span&gt;\( a_{i} \)&lt;/span&gt; יעלה בגורל. סכום כזה נקרא &lt;strong&gt;תוחלת&lt;/strong&gt; ומסומן ב-&lt;span&gt;\( E\left[X\right] \)&lt;/span&gt;. אם מרחב המדגם הוא אינסופי העניינים מן הסתם מסתבכים קצת מתמטית אבל הרעיון זהה: &lt;span&gt;\( \text{E}\left[X\right]=\sum_{i=1}^{\infty}P\left(X=a_{i}\right)\cdot a_{i} \)&lt;/span&gt; עבור מרחב מדגם אינסופי בדיד, ו-&lt;span&gt;\( \text{E}\left[X\right]=\int_{-\infty}^{\infty}p\left(x\right)xdx \)&lt;/span&gt; עבור מרחב מדגם אינסופי רציף.&lt;/p&gt;

&lt;p&gt;למה ממוצע משוקלל כזה הוא מעניין? אנחנו הרי מצפים שהוא ילמד אותנו משהו על המשתנה המקרי &lt;span&gt;\( X \)&lt;/span&gt; ולא סתם יהיה הגדרה לשם הגדרה. כאן זו אחת מהסיטואציות הנדירות שבהן המתמטיקה הייתה מדע &lt;strong&gt;אמפירי&lt;/strong&gt;: קודם כל התגלתה תופעה, ואחר כך הוכיחו אותה מתמטית. התופעה הייתה האבחנה שאם אנחנו חוזרים על אותו ניסוי הסתברותי מספרי שוב ושוב, &lt;strong&gt;הממוצע&lt;/strong&gt; של התוצאות שלנו נוטה להיות יציב יחסית ככל שמספר הניסויים שאנחנו מבצעים גדל. בואו נראה דוגמא קונקרטית לזה עם הטלת קוביה. בימינו, למרבה השמחה, אפשר לרתום את המחשב לניסויים כאלו, אז הנה קוד פייתון קצרצר:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;מה שהקוד הזה עושה הוא להטיל קוביה מספר כלשהו של פעמים שמסומן ב-&lt;span&gt;\( N \)&lt;/span&gt;, ואז לחשב את ממוצע ההטלות. אנחנו עושים את הניסוי הזה בנפרד עבור ערכי &lt;span&gt;\( N \)&lt;/span&gt; מ-&lt;span&gt;\( 10 \)&lt;/span&gt; עד &lt;span&gt;\( 10^{6} \)&lt;/span&gt;, ולכל אחד מהם אנחנו מדפיסים את הממוצע. כשאני עשיתי את זה, קיבלתי:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.56&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.372&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.4951&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.50129&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.499845&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;די בבירור, הממוצע מתקרב אל &lt;span&gt;\( 3.5 \)&lt;/span&gt;. זו אבחנה אמפירית; אבל אם אנחנו רוצים לדעת לאן הממוצע ישאף אנחנו &lt;strong&gt;לא צריכים&lt;/strong&gt; לבצע ניסויים בפועל - אנחנו יכולים פשוט &lt;strong&gt;לחשב&lt;/strong&gt; את זה, ואיכשהו מובטח שהמציאות תסתדר בהתאם לחישוב שלנו. הערך שאנחנו מחשבים הוא - הפתעה הפתעה - התוחלת של המשתנה המקרי שמתאר את הניסוי.&lt;/p&gt;

&lt;p&gt;במקרה שלנו, &lt;span&gt;\( X \)&lt;/span&gt; מקבל כל ערך בין 1 ל-6 בהסתברות &lt;span&gt;\( \frac{1}{6} \)&lt;/span&gt; לכל איבר, אז על פי הגדרה &lt;span&gt;\( E\left[X\right]=\frac{1+2+3+4+5+6}{6}=\frac{21}{6}=3.5 \)&lt;/span&gt;. אין פה הפתעה, אבל מה שכן יש פה הוא חישוב פשוט למדי, שלא מצריך הטלת מיליון קוביות. והיופי פה הוא שזה עובד &lt;strong&gt;תמיד&lt;/strong&gt;, לכל משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt; שאנחנו משכפלים &lt;span&gt;\( n \)&lt;/span&gt; עותקים זהים שלו שהם בלתי תלויים אחד בשני ומסתכלים על הממוצע של כולם (טוב, &lt;a href=&quot;https://gadial.net/2008/07/25/envelope_paradox/&quot;&gt;כמעט תמיד&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;לתופעה הזו קוראים &lt;strong&gt;חוק המספרים הגדולים&lt;/strong&gt;. יש כמה ניסוחים למשפט שאומר “מה הולך פה” והניסוח הנפוץ הוא בדרך כלל של מה שנקרא &lt;strong&gt;החוק החזק של המספרים הגדולים&lt;/strong&gt; שלא אוכיח כרגע אבל כן אסביר מה הוא אומר. אנחנו מתחילים עם סדרה אינסופית של משתנים מקריים &lt;span&gt;\( X_{1},X_{2},X_{3},\ldots \)&lt;/span&gt; שכולם מתפלגים באותו האופן (כלומר, בעלי אותה פונקצית צפיפות הסתברות) והם בלתי תלויים, במובן הבא: &lt;span&gt;\( X,Y \)&lt;/span&gt; הם בלתי תלויים אם לכל שתי קבוצות אפשריות של תוצאות &lt;span&gt;\( A,B \)&lt;/span&gt; מתקיים &lt;span&gt;\( P\left(X\in A\wedge Y\in B\right)=P\left(X\in A\right)P\left(Y\in B\right) \)&lt;/span&gt;; ראינו את זה טיפה בפוסט הקודם ולא אתעכב על זה הפעם.&lt;/p&gt;

&lt;p&gt;עכשיו, מכיוון שכל המשתנים מתפלגים אותו דבר, יש להם אותה תוחלת. באופן כללי תוחלת עשויה להיות אינסופית או לא מוגדרת, אבל נניח שכאן היא מספר סופי, &lt;span&gt;\( E\left[X_{i}\right]=\mu \)&lt;/span&gt;. במקרה הזה אנחנו יכולים להסתכל על המשתנה המקרי &lt;span&gt;\( \overline{X}_{n}=\frac{X_{1}+X_{2}\ldots+X_{n}}{n} \)&lt;/span&gt;, שהוא המשתנה שמתאר את הממוצע (הרגיל, הלא משוקלל) של &lt;span&gt;\( n \)&lt;/span&gt; התוצאות הראשונות בסדרת המשתנים המקריים. החוק החזק של המספרים הגדולים אומר שמתקיים &lt;span&gt;\( \overline{X}_{n}\to\mu \)&lt;/span&gt; בהסתברות 1. בואו נבין טיפה יותר מה זה אומר בעצם.&lt;/p&gt;

&lt;p&gt;ה-&lt;span&gt;\( \overline{X}_{n} \)&lt;/span&gt;-ים שהגדרנו מתארים &lt;strong&gt;סדרה&lt;/strong&gt; של משתנים שמתארת את הממוצעים ההולכים-ומשתפרים: &lt;span&gt;\( \overline{X}_{1},\overline{X}_{2},\overline{X}_{3},\ldots \)&lt;/span&gt;. אם אנחנו דוגמים איבר &lt;span&gt;\( a \)&lt;/span&gt; כלשהו במרחב המדגם שלנו, הוא ייתן למשתנים &lt;span&gt;\( X_{1},X_{2},\dots \)&lt;/span&gt; ערכים קונקרטיים שהם מספרים ממשיים: &lt;span&gt;\( X_{1}\left(a\right),X_{2}\left(a\right),\ldots \)&lt;/span&gt;, ולכן גם בסדרת הממוצעים נקבל ערכים קונקרטיים &lt;span&gt;\( \overline{X}_{1}\left(a\right),\overline{X}_{2}\left(a\right),\ldots \)&lt;/span&gt;; כלומר, בהינתן שאנחנו מסתכלים על איבר קונקרטי של מרחב המדגם, קיבלנו סדרה “רגילה” של מספרים ממשיים. על סדרה “רגילה” של ממשיים אפשר לשאול האם היא מקיימת את התכונה &lt;span&gt;\( \lim_{n\to\infty}\overline{X}_{n}\left(a\right)=\mu \)&lt;/span&gt;, כלומר האם לכל &lt;span&gt;\( \varepsilon&amp;gt;0 \)&lt;/span&gt; קיים &lt;span&gt;\( N \)&lt;/span&gt; כך שלכל &lt;span&gt;\( n&amp;gt;N \)&lt;/span&gt; מתקיים &lt;span&gt;\( \left|\overline{X}_{n}\left(a\right)-\mu\right|&amp;lt;\varepsilon \)&lt;/span&gt;. לכל &lt;span&gt;\( a \)&lt;/span&gt; במרחב המדגם שלנו התשובה לשאלה הזו היא או “כן” או “לא”. החוק החזק של המספרים הגדולים אומר שקבוצת כל ה-&lt;span&gt;\( a \)&lt;/span&gt;-ים שעבורה התשובה היא “לא” היא ממידה אפס (זה לא אומר שזה לא יכול לקרות; זה אומר שזה זניח).&lt;/p&gt;

&lt;p&gt;אני לא אוכיח כאן את חוק המספרים הגדולים; אני בעיקר משתמש בו כדי לתת מוטיבציה לסיבה שבגללה מושג התוחלת קופץ לנו לפרצוף ודורש שנגדיר אותו. יש עוד שימושים דומים לתוחלת, כשהפשוט שבהם הוא כנראה &lt;strong&gt;אי שוויון מרקוב&lt;/strong&gt;: אם &lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי שמקבל רק ערכים אי-שליליים ו-&lt;span&gt;\( a&amp;gt;0 \)&lt;/span&gt; כלשהו, אז&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X\ge a\right)\le\frac{\text{E}\left[X\right]}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בניסוח שקול שקצת יותר מאפשר להבין מה הקטע אפשר להכניס את התוחלת לתוך אי השוויון:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X\ge a\cdot\text{E}\left[X\right]\right)\le\frac{1}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, זה נותן הערכה גסה לשאלה מה הסיכוי ש-&lt;span&gt;\( X \)&lt;/span&gt; יהיה גדול מפי 2 התוחלת שלו (פחות מחצי), מפי 3 התוחלת שלו (פחות משליש) וכו’. זו באמת הערכה גסה, אבל לעתים קרובות היא מספיקה כדי להוכיח את מה שרוצים לעשות באותו רגע ולכן, בנוסף לפשטות שלו, אי השוויון הזה הוא כלי שימושי מאוד.&lt;/p&gt;

&lt;p&gt;ההוכחה של אי שוויון מרקוב מצחיקה בכמה שהיא פשוטה. אני מגדיר משתנה מקרי &lt;span&gt;\( I \)&lt;/span&gt; שהוא מה שנקרא &lt;strong&gt;אינדיקטור&lt;/strong&gt;: משתנה מקרי שמקבל או 0 או 1, ולכן בעצם נותן “אינדיקציה” לכך שאירוע מסוים קרה או לא. במקרה שלנו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( I=\begin{cases} 1 &amp;amp; X\ge a\\ 0 &amp;amp; X&amp;lt;a \end{cases} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;התוחלת של אינדיקטור, ממש על פי ההגדרה, היא ההסתברות שהאירוע שנותן 1 קרה, כלומר &lt;span&gt;\( E\left[I\right]=P\left(X\ge a\right) \)&lt;/span&gt;. עכשיו, שימו לב ש-&lt;span&gt;\( I\le\frac{X}{a} \)&lt;/span&gt; ותאמינו לי שאפשר פשוט לקחת תוחלת לשני האגפים ולהוציא את הקבוע החוצה, ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X\ge a\right)=E\left[I\right]=\frac{E\left[X\right]}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אתם כמובן לא אמורים להאמין לי שפשוט אפשר לעשות את זה, אבל אני לא אוכיח את זה הפעם. את הקטע עם “להוציא את הקבוע החוצה” אפשר להכליל - התוחלת מקיימת תכונה מועילה מאוד שנקראת &lt;strong&gt;לינאריות&lt;/strong&gt;: אם &lt;span&gt;\( X,Y \)&lt;/span&gt; הם משתנים מקריים כלשהם (שיכולים להיות גם תלויים) ו-&lt;span&gt;\( \alpha,\beta \)&lt;/span&gt; הם קבועים מספריים, אז &lt;span&gt;\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)&lt;/span&gt; (ואפשר להכליל את זה לסכום סופי כלשהו של משתנים מקריים).&lt;/p&gt;

&lt;p&gt;הראיתי את המושג האבסטרקטי של תוחלת ואיזו דוגמא מסכנה עם הטלת קוביה, אבל זה לא מספיק, בואו נראה דוגמא קונקרטית - מה שנקרא &lt;strong&gt;התפלגות בינומית&lt;/strong&gt;. בהתפלגות בינומית יש לנו ניסוי בסיסי שחוזר על עצמו עם הסתברות &lt;span&gt;\( p \)&lt;/span&gt; להצליח ו-&lt;span&gt;\( q=1-p \)&lt;/span&gt; להיכשל בכל פעם; כבר ראינו שאם חוזרים על הניסוי &lt;span&gt;\( n \)&lt;/span&gt; פעמים אז ההסתברות לקבל בדיוק &lt;span&gt;\( k \)&lt;/span&gt; הצלחות היא &lt;span&gt;\( p\left(X=k\right)={n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;. לכן, התוחלת של המשתנה המקרי הזה היא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X\right]=\sum_{k=0}^{n}k{n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;יש טריק מתמטי לא מסובך שמאפשר לחשב את הסכום הזה, אבל למרבה השמחה הוא עובד באופן קצת יותר כללי ויאפשר לחשב לא רק את &lt;span&gt;\( \text{E}\left[X\right] \)&lt;/span&gt; אלא גם את &lt;span&gt;\( \text{E}\left[X^{t}\right] \)&lt;/span&gt; לכל חזקה טבעית &lt;span&gt;\( t \)&lt;/span&gt;, וזה הולך לעזור לנו בקרוב (הערכים &lt;span&gt;\( \text{E}\left[X^{t}\right] \)&lt;/span&gt; נקראים &lt;strong&gt;המומנטים&lt;/strong&gt; של המשתנה המקרי &lt;span&gt;\( X \)&lt;/span&gt; ויש להם חשיבות באופן כללי). הסכום במקרה הכללי יותר הזה הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X^{t}\right]=\sum_{k=0}^{n}k^{t}{n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כי הדרך היחידה שבה הערך &lt;span&gt;\( k^{t} \)&lt;/span&gt; יכול להתקבל על ידי המשתנה &lt;span&gt;\( X^{t} \)&lt;/span&gt; היא אם הערך &lt;span&gt;\( k \)&lt;/span&gt; יתקבל על ידי המשתנה &lt;span&gt;\( X \)&lt;/span&gt;, כלומר &lt;strong&gt;ההסתברות&lt;/strong&gt; היא אותו דבר וכל מה שהשתנה הוא שמופיע בתחילת הסכום &lt;span&gt;\( k^{t} \)&lt;/span&gt; במקום סתם &lt;span&gt;\( k \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, קודם כל שימו לב שאם &lt;span&gt;\( k=0 \)&lt;/span&gt; האיבר שמתאים למקרה הזה הוא פשוט אפס, כלומר אפשר לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X^{t}\right]=\sum_{k=1}^{n}k^{t}{n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הטריק הוא עכשיו לפתוח את ההגדרה של &lt;span&gt;\( {n \choose k}=\frac{n!}{k!\left(n-k\right)!} \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( k{n \choose k}=k\cdot\frac{n!}{k!\left(n-k\right)!}=n\frac{k}{k!}\cdot\frac{\left(n-1\right)!}{\left(n-k\right)!}=n\frac{\left(n-1\right)!}{\left(k-1\right)!\left(n-k\right)!}=n{n-1 \choose k-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;נציב את זה אצלנו ועל הדרך נוציא &lt;span&gt;\( p \)&lt;/span&gt; אחד החוצה כדי להקטין את החזקה של &lt;span&gt;\( p \)&lt;/span&gt; באחד:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=1}^{n}k^{t}{n \choose k}p^{k}q^{n-k}=np\sum_{k=1}^{n}k^{t-1}{n-1 \choose k-1}p^{k-1}q^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו נבצע החלפת משתנה &lt;span&gt;\( i=k-1 \)&lt;/span&gt;. כלומר כש-&lt;span&gt;\( k=1 \)&lt;/span&gt; אז &lt;span&gt;\( i=0 \)&lt;/span&gt; ואילו כש-&lt;span&gt;\( k=n \)&lt;/span&gt; אז &lt;span&gt;\( i=n-1 \)&lt;/span&gt;, ולכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( np\sum_{k=1}^{n}k^{t-1}{n-1 \choose k-1}p^{k-1}q^{n-k}=np\sum_{i=0}^{n-1}\left(i+1\right)^{t-1}{n-1 \choose i}p^{i}q^{n-i-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו בואו נסתכל על הביטוי שקיבלנו בסכום:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{i=0}^{n-1}\left(i+1\right)^{t-1}{n-1 \choose i}p^{i}q^{n-i-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;חוץ מה-&lt;span&gt;\( \left(i+1\right)^{t-1} \)&lt;/span&gt; בהתחלה זה נראה בדיוק כמו סכום על ההסתברויות של משתנה בינומי אחר שאסמן &lt;span&gt;\( Y \)&lt;/span&gt;, עם &lt;span&gt;\( n-1 \)&lt;/span&gt; נסיונות ואותן הסתברויות הצלחה וכישלון &lt;span&gt;\( p,q \)&lt;/span&gt;. ה-&lt;span&gt;\( \left(i+1\right)^{t-1} \)&lt;/span&gt; בתחילת הסכום נראה קצת מוזר אבל אם חושבים על זה, רואים שהסכום פשוט שווה אל &lt;span&gt;\( \text{E}\left[\left(Y+1\right)^{t-1}\right] \)&lt;/span&gt;. כלומר קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X^{t}\right]=np\text{E}\left[\left(Y+1\right)^{t-1}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במקרה הבסיס שבו &lt;span&gt;\( t=1 \)&lt;/span&gt; אז &lt;span&gt;\( \left(Y+1\right)^{t-1} \)&lt;/span&gt; הוא פשוט הקבוע 1 ולכן התוחלת שלו היא 1 ולכן קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X\right]=np \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אבל עם הנוסחה נוכל לחשב בקלות גם את &lt;span&gt;\( \text{E}\left[X^{2}\right] \)&lt;/span&gt;, למשל. כי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X^{2}\right]=np\text{E}\left[Y+1\right]=np\left(\text{E}\left[Y\right]+1\right)=np\left(\left(n-1\right)p+1\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן למשל השתמשתי בלינאריות של התוחלת. אבל למה בעצם &lt;span&gt;\( \text{E}\left[X^{2}\right] \)&lt;/span&gt; מעניין אותי? או, אנחנו בדיוק מגיעים אל זה.&lt;/p&gt;

&lt;h2&gt;שונות וסטיית תקן&lt;/h2&gt;

&lt;p&gt;ראינו זה עתה שאם &lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה בינומי שמתאר ספירה של הצלחות בניסוי שחוזר על עצמו &lt;span&gt;\( n \)&lt;/span&gt; פעמים עם הסתברות הצלחה &lt;span&gt;\( p \)&lt;/span&gt; בכל פעם, אז התוחלת שלו היא &lt;span&gt;\( np \)&lt;/span&gt;. ראינו גם שהתוחלת של התוצאה בהטלת קובייה הוגנת היא &lt;span&gt;\( 3.5 \)&lt;/span&gt;. אז אם נבחר את הפרמטרים של &lt;span&gt;\( X \)&lt;/span&gt; להיות &lt;span&gt;\( n=7,p=\frac{1}{2} \)&lt;/span&gt; נקבל שהתוחלת של &lt;span&gt;\( X \)&lt;/span&gt; היא גם &lt;span&gt;\( 3.5 \)&lt;/span&gt;: התוחלת של “הטל מטבע הוגן 7 פעמים וספור כמה פעמים התקבל עץ” היא אותה תוחלת כמו של “הטל קוביה הוגנת ובדוק מה יצא”. אבל אלו בבירור ניסויים שונים למדי זה מזה - בהטלת קוביה לכל תוצאה יש אותו סיכוי, ובניסוי הבינומי אין סימטריה כזו ויש גם ערכים כמו 0 ו-7 שלא יכולים לצוץ בהטלת קוביה. עוד משחק שאני יכול לעשות הוא לשחק “הטלת מטבע” עם מטבע שהערך של צד אחד שלו הוא 0 והערך של הצד השני שלו הוא 7: גם במקרה הזה נקבל תוחלת &lt;span&gt;\( 3.5 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אם אני לוקח את שלושת הניסויים השונים הללו ועושה עליהם את מה שעשיתי בפוסט הראשון בסדרה, כלומר מצייר את העקומה של ההתפלגות הנורמלית שמקרבת את מה שמקבלים אם חוזרים על הניסוי 100 פעמים וסוכמים את התוצאות - זה מה שאני אקבל:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;יש כאן שלוש עקומות נורמליות, שניסיתי לצבוע בצבעים שונים כדי להבדיל ביניהן (אבל אני לא בטוח אם הצבעים ייראו שונים לכל הקוראים). העקומה שמגיעה הכי גבוהה, שצבועה באדום, מתאימה למשתנה הבינומי; האמצעית, שצבועה בכחול, מתאימה למשתנה של הקוביה; והתחתונה, הירוקה, מתאימה למשתנה של המטבע עם הערכים 0 ו-7.&lt;/p&gt;

&lt;p&gt;מה הסיבה להבדל? ככל שעקומה נורמלית היא יותר גבוהה, כך זה אומר שרוב ההסתברות שהיא מייצגת מתארת טווח קטן יחסית. המקרה הקיצוני ביותר הוא המשתנה המקרי שפשוט מחזיר &lt;span&gt;\( 3.5 \)&lt;/span&gt; תמיד, שיתואר על ידי קו אנכי בודד בדיוק ב-&lt;span&gt;\( 350 \)&lt;/span&gt;. הסיבה שהעקומה הירוקה, הנמוכה, היא כל כך “רחבה” היא שהניסוי שהיא מתארת הוא בעל רק שני ערכים, ששניהם במרחק לא זניח מהתוחלת עצמה ולכן כל אי-אחידות בתוצאות של ההגרלה (נניח, יתרון של 9 הטלות שנתנו 7 במקום 0) “מושך” את הסכום הכולל רחוק מהממוצע הצפוי. זו האינטואיציה, אבל אנחנו רוצים את המתמטיקה הקונקרטית - מדד מספרי שיאפשר לנו לתאר עד כמה סטייה מהתוחלת היא משהו נפוץ או נדיר.&lt;/p&gt;

&lt;p&gt;אם &lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי ו-&lt;span&gt;\( \mu=\text{E}\left[X\right] \)&lt;/span&gt; היא התוחלת שלו, אפשר להסתכל על משתנה מקרי חדש, &lt;span&gt;\( Y=X-\mu \)&lt;/span&gt;. זה המשתנה המקרי המקורי, רק שעכשיו הוא מנורמל כך שהתוחלת שלו תהיה 0. מכיוון שמה שמעניין אותנו הוא גודל ה”סטייה מהממוצע”, והגודל הזה הוא פשוט &lt;span&gt;\( \left|Y\right| \)&lt;/span&gt;, אפשר לשאול את עצמנו &lt;strong&gt;מה הסטייה הממוצע מהממוצע&lt;/strong&gt;, כלומר &lt;span&gt;\( \text{E}\left[\left|Y\right|\right] \)&lt;/span&gt;. זה אמנם מדד מתבקש למדי, אבל הוא פחות מועיל מאשר אפשר היה לקוות. פונקציית הערך המוחלט היא לא “נחמדה” מבחינה מתמטית - בפרט, היא לא גזירה ב-0. עניין אחר הוא שהיא מאותו סדר גודל כמו &lt;span&gt;\( Y \)&lt;/span&gt; ודווקא יש עניין בכך שנעבור אל “סדר הגודל הבא”. זה מוביל אותנו להגדרה שאולי נראית פחות טבעית ממבט ראשון אבל היא שימושית בצורה בלתי נתפסת: &lt;span&gt;\( \text{Var}\left(X\right)=\text{E}\left[Y^{2}\right]=\text{E}\left[\left(X-\mu\right)^{2}\right] \)&lt;/span&gt; כאשר Var כאן הוא קיצור של Variance, &lt;strong&gt;שונות&lt;/strong&gt;. העלאה בריבוע נותנת לנו את היתרונות שרצינו: היא משמשת בתור סוג של ערך מוחלט כי &lt;span&gt;\( a^{2} \)&lt;/span&gt; זה אותו דבר כמו &lt;span&gt;\( \left|a\right|^{2} \)&lt;/span&gt;; זה עובר לסדר הגודל השני (חשבו על העלאה בריבוע בתור העלאה של סדר הגודל; איך זה באמת חשוב, נראה אחר כך). וזו פונקציה נחמדה לעבודה מבחינה מתמטית.&lt;/p&gt;

&lt;p&gt;דבר אחד שקל לראות הוא נוסחה אלטרנטיבית לתוחלת שמתקבלת מכך שפותחים במפורש את הביטוי, מה שאני אדגים במקרה של הסתברות בדידה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(X\right)=\text{E}\left[\left(X-\mu\right)^{2}\right]=\sum_{a}p\left(X=a\right)\left(a-\mu\right)^{2}= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\sum_{a}P\left(X=a\right)a^{2}-2\mu\sum_{a}P\left(X=a\right)a+\mu^{2}\sum_{a}P\left(X=a\right)= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\text{E}\left[X^{2}\right]-2\mu\text{E}\left[X\right]+\mu^{2}=\text{E}\left[X^{2}\right]-2\mu^{2}+\mu^{2}=\text{E}\left[X^{2}\right]-\mu^{2}=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בואו נוודא שהבנו מה הולך פה. את הביטוי המקורי פיצלתי לשלושה סכומים על פי הפתיחה של הסוגריים &lt;span&gt;\( \left(a-\mu\right)^{2}=a^{2}-2a\mu+\mu^{2} \)&lt;/span&gt;. הסכום הראשון היה &lt;span&gt;\( \sum_{a}P\left(X=a\right)a^{2} \)&lt;/span&gt; שזו ממש ההגדרה הפורמלית של &lt;span&gt;\( \text{E}\left[X^{2}\right] \)&lt;/span&gt;. הסכום השני היה קבוע כפול &lt;span&gt;\( \sum_{a}P\left(X=a\right)a \)&lt;/span&gt; שזו ההגדרה הפורמלית של &lt;span&gt;\( \text{E}\left[X\right] \)&lt;/span&gt;, ואחרי שהשתמשתי בכך ש-&lt;span&gt;\( \text{E}\left[X\right]=\mu \)&lt;/span&gt; קיבלתי את הערך שרציתי.&lt;/p&gt;

&lt;p&gt;הנוסחה &lt;span&gt;\( \text{Var}\left(X\right)=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)&lt;/span&gt; בהחלט נראית לי יפה ושימושית יותר מאשר &lt;span&gt;\( \text{E}\left[\left(X-\mu\right)^{2}\right] \)&lt;/span&gt;; היא מציגה את השונות בעזרת שני המומנטים הראשונים של &lt;span&gt;\( X \)&lt;/span&gt;, שיותר קל לחשב ישירות. עשיתי את זה קודם, בדוגמה למעלה, עבור התפלגות בינומית: קיבלנו ש-&lt;span&gt;\( \text{E}\left[X\right]=np \)&lt;/span&gt; ואילו &lt;span&gt;\( \text{E}\left[X^{2}\right]=np\left(\left(n-1\right)p+1\right) \)&lt;/span&gt;, ולכן עכשיו אני אוכל לחשב בקלות את השונות של התפלגות בינומית:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(X\right)=np\left(\left(n-1\right)p+1\right)-\left(np\right)^{2}=np\left[\left(n-1\right)p+1-np\right]= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =np\left(np-p+1-np\right)=np\left(1-p\right)=npq \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובסופו של דבר קיבלנו ביטוי פשוט ואלגנטי מאוד עבור השונות. עבור המשתנה הבינומי הקונקרטי שתיארתי למעלה, של ספירת העצים ב-7 הטלות של מטבע הוגן, הפרמטרים היו &lt;span&gt;\( n=7,p=q=0.5 \)&lt;/span&gt; ולכן התוחלת היא &lt;span&gt;\( \frac{7}{2}=3.5 \)&lt;/span&gt; כפי שכבר ראינו, והשונות היא &lt;span&gt;\( \frac{7}{4}=1.75 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עבור תוחלת ראיתי שמתקיימת תכונת &lt;strong&gt;לינאריות&lt;/strong&gt; מועילה מאוד: &lt;span&gt;\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)&lt;/span&gt;. עבור שונות אין לנו משהו עד כדי כך נוח, אבל עדיין יש לנו נוסחה מועילה: &lt;span&gt;\( \text{Var}\left(\alpha X+\beta\right)=\alpha^{2}\text{Var}\left(X\right) \)&lt;/span&gt;. כלומר - חיבור של &lt;strong&gt;קבוע&lt;/strong&gt; לא משפיע (חיבור של משתנה מקרי אחר מסבך את הכל), והכפלה בקבוע מכילה את השונות באותו קבוע בריבוע.&lt;/p&gt;

&lt;p&gt;עכשיו, העובדה שהשונות כוללת העלאה בריבוע היא מצד אחד חיובית מהסיבות שציינתי, ומצד שני אנחנו עדיין רוצים לקבל מדד דומה שהוא “מסדר גודל אחד פחות” ובכל זאת מתנהג נחמד. דרך פשוטה לקבל את זה היא להגדיר &lt;span&gt;\( \sigma=\sqrt{\text{Var}\left(X\right)} \)&lt;/span&gt; - גם פונקציית השורש היא נחמדה יחסית, ומורידה את סדר הגודל. ה-&lt;span&gt;\( \sigma \)&lt;/span&gt; הזה חשוב מספיק כדי שיקבל שם בפני עצמו: &lt;strong&gt;סטיית התקן&lt;/strong&gt; של &lt;span&gt;\( X \)&lt;/span&gt;, ולעתים קרובות יותר נוח פשוט לכתוב &lt;span&gt;\( \sigma^{2} \)&lt;/span&gt; בתור השונות של &lt;span&gt;\( X \)&lt;/span&gt; במקום &lt;span&gt;\( \text{Var}\left(X\right) \)&lt;/span&gt;. את התוצאה שראינו לפני רגע אפשר לתאר גם בתור “אם כופלים את &lt;span&gt;\( X \)&lt;/span&gt; ב-&lt;span&gt;\( \alpha \)&lt;/span&gt; כופלים את סטיית התקן של &lt;span&gt;\( X \)&lt;/span&gt; ב-&lt;span&gt;\( \alpha \)&lt;/span&gt;”.&lt;/p&gt;

&lt;p&gt;בואו נראה עכשיו שימוש בשונות כדי לשפר את היכולת שלנו להבין את &lt;span&gt;\( X \)&lt;/span&gt; בעזרת מעין שדרוג של אי-שוויון מרקוב שלוקח גם את השונות בחשבון ונקרא &lt;strong&gt;אי-שוויון צ&apos;בישב&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;הרעיון הוא כזה. כזכור, אי-שוויון מרקוב מדבר על משתנה מקרי &lt;strong&gt;אי-שלילי&lt;/strong&gt; &lt;span&gt;\( X \)&lt;/span&gt; ועבורו, לכל &lt;span&gt;\( a&amp;gt;0 \)&lt;/span&gt; , הוא נותן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X\ge a\right)=\frac{E\left[X\right]}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, אם &lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי &lt;strong&gt;כלשהו&lt;/strong&gt;, לאו דווקא אי שלילי, אז בואו ניזכר ש-&lt;span&gt;\( \text{Var}\left(X\right) \)&lt;/span&gt; הוגדרה בתור התוחלת של משתנה מקרי שהוא &lt;strong&gt;כן&lt;/strong&gt; אי-שלילי: &lt;span&gt;\( \sigma^{2}=\text{Var}\left(X\right)=\text{E}\left[Z\right] \)&lt;/span&gt; כאשר &lt;span&gt;\( Z=\left(X-\mu\right)^{2} \)&lt;/span&gt;. על ה-&lt;span&gt;\( Z \)&lt;/span&gt; הזה אני כן יכול להשתמש באי שוויון מרקוב; בואו נראה מה קורה אם אנחנו לוקחים &lt;span&gt;\( k&amp;gt;0 \)&lt;/span&gt; כלשהו ומשתמשים במרקוב עם &lt;span&gt;\( a=k^{2} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(Z\ge a\right)\le\frac{\text{E}\left[Z\right]}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left(X-\mu\right)^{2}\ge k^{2}\right)\le\frac{\text{E}\left[\left(X-\mu\right)^{2}\right]}{k^{2}}=\frac{\sigma^{2}}{k^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, בואו נביט על &lt;span&gt;\( \left(X-\mu\right)^{2}\ge k^{2} \)&lt;/span&gt;. הדבר הזה קורה אם ורק אם &lt;span&gt;\( \left|X-\mu\right|\ge k \)&lt;/span&gt;, ולכן ההסתברות של שני אי השוויונים זהה, כלומר אני יכול לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left|X-\mu\right|\ge k\right)\le\frac{\sigma^{2}}{k^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה אי-שוויון צ’בישב. כמו עם אי-שוויון מרקוב, לפעמים קל יותר להבין מה הוא אומר אם “מכניסים את סטיית התקן אל אי השוויון”, כלומר אם אני מנסח אותו על ידי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left|X-\mu\right|\ge k\sigma\right)\le\frac{1}{k^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם למשל נציב &lt;span&gt;\( k=2 \)&lt;/span&gt; נקבל את הטענה הבאה: לכל משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt;, הסיכוי שהוא יקבל ערך שהמרחק שלו מהתוחלת של &lt;span&gt;\( X \)&lt;/span&gt; הוא יותר משתי סטיות תקן הוא &lt;span&gt;\( \frac{1}{4}=25\% \)&lt;/span&gt;. לי זה מרגיש כמו טענה כללית להפתיע, כי לא משנה בכלל כמה &lt;span&gt;\( X \)&lt;/span&gt; מורכב ומתוחכם - מרגע שחישבנו את התוחלת ואת סטיית התקן שלו, אנחנו יודעים בדיוק מה האיזור שבו 75\% מהערכים ש-&lt;span&gt;\( X \)&lt;/span&gt; נותן הולכים ליפול. יותר מכך - בגלל שבמכנה יש &lt;span&gt;\( k^{2} \)&lt;/span&gt; ולא &lt;span&gt;\( k \)&lt;/span&gt;, זה אומר לנו שהסיכוי של מישהו להיות במרחק של הרבה סטיות תקן צונח מהר - צונח באופן &lt;strong&gt;ריבוע&lt;/strong&gt;. אם הסיכוי להיות במרחק 2 סטיות תקן היה 25\%, עבור 3 סטיות תקן הוא נופל אל &lt;span&gt;\( \frac{1}{9}=11.111\ldots\% \)&lt;/span&gt;, ועבור 4 סטיות תקן הוא כבר &lt;span&gt;\( \frac{1}{16}=6.25\% \)&lt;/span&gt; וכשנרצה להיות במרחק 10 סטיות תקן הסיכוי כבר יהיה &lt;span&gt;\( \frac{1}{100}=1\% \)&lt;/span&gt;, וכן הלאה. ככל שסטיית התקן של &lt;span&gt;\( X \)&lt;/span&gt; גדולה יותר כך האיזור שבו רוב הערכים שלו יכולים ליפול הוא רחב יותר, אבל אם נחלק את המרחב לאיזורים שהרוחב של כל אחד מהם הוא &lt;span&gt;\( \sigma \)&lt;/span&gt;, נדע בדיוק מה ההסתברות של איבר ליפול בכל אחד מהאיזורים הללו. זו המחשה חזקה מאוד לכוח שיש לשני מספרים בודדים &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; לתאר את &lt;span&gt;\( X \)&lt;/span&gt;.&lt;/p&gt;

&lt;h2&gt;חזרה אל ההתפלגות הנורמלית&lt;/h2&gt;

&lt;p&gt;עכשיו כשהכרנו את המושגים של תוחלת ושונות/סטיית תקן אפשר לחזור סוף סוף אל ההתפלגות הנורמלית. הגדרתי אותה בעזרת פונקציית צפיפות ההסתברות &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt;, ועכשיו אפשר לחזור למה שאמרתי בתחילת הפוסט אבל כשיש לנו את ההגדרות הרלוונטיות: ה-&lt;span&gt;\( \mu \)&lt;/span&gt; וה-&lt;span&gt;\( \sigma \)&lt;/span&gt; הללו הם בדיוק התוחלת וסטיית התקן של ההתפלגות הנורמלית ש-&lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; הם הפרמטרים שלה. כלומר, אנחנו מגדירים משתנה מקרי &lt;span&gt;\( N\left(\mu,\sigma\right) \)&lt;/span&gt; על ידי פונקציית הצפיפות &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt;, וכשנחשב את התוחלת וסטיית התקן שלו הנוסחאות יתנו לנו בדיוק &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt;, וזה בדיוק מה שאני רוצה להראות עכשיו. דבר אחד שכדאי לשים אליו לב לפני כן הוא שאפשר להגדיר את ההתפלגות הנורמלית גם בלי להגדיר בכלל סטיית תקן: הרי &lt;span&gt;\( \frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}=\frac{1}{\sqrt{2\pi\sigma^{2}}}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt; ולכן אם היינו למשל בוחרים לסמן את השונות שאנחנו רוצים ב-&lt;span&gt;\( \tau \)&lt;/span&gt; אז היינו מקבלים שהתפלגות נורמלית עם תוחלת &lt;span&gt;\( \mu \)&lt;/span&gt; ושונות &lt;span&gt;\( \tau \)&lt;/span&gt; מתוארת על ידי &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi\tau}}e^{-\left(x-\mu\right)^{2}/2\tau} \)&lt;/span&gt;. הבחירה להשתמש ב-&lt;span&gt;\( \sigma \)&lt;/span&gt; היא עניין של קונבנציה (ומן העבר השני, אנשים גם כותבים לפעמים &lt;span&gt;\( \frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2} \)&lt;/span&gt; כדי שהנוסחה תכלול רק את &lt;span&gt;\( \sigma \)&lt;/span&gt; ולא את &lt;span&gt;\( \sigma^{2} \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;ראשית, הנה טריק מועיל כדי למצוא תוחלת ושונות של דברים. כזכור, ראינו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(\alpha X+\beta\right)=\alpha^{2}\text{Var}\left(X\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז באופן כללי, אם אנחנו רוצים למצוא תוחלת ושונות של משתנה &lt;span&gt;\( X \)&lt;/span&gt; אבל זה קשה לנו, אפשר לנסות להגדיר משתנה “מנורמל” &lt;span&gt;\( Z=\frac{X-\mu}{\sigma} \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X\right]=\sigma\text{E}\left[Z\right]+\mu \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(X\right)=\sigma^{2}\text{Var}\left(Z\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אני אשתמש בזה במקרה שלנו. נניח ש-&lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי שמתפלג נורמלית עם פרמטרים &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt;, כלומר &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2} \)&lt;/span&gt;. אם אני מגדיר את המשתנה החדש &lt;span&gt;\( Z=\frac{X-\mu}{\sigma} \)&lt;/span&gt; אני אקבל פונקציית צפיפות הסתברות &lt;span&gt;\( f\left(z\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;. כדי לראות את זה נשים לב לכך ש:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(a\le Z\le b\right)=P\left(\sigma a+\mu\le X\le\sigma b+\mu\right)=\int_{\sigma a+\mu}^{\sigma b+\mu}\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2}dx \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועל האינטגרל הזה אפשר לבצע את החלפת המשתנים &lt;span&gt;\( z=\frac{x-\mu}{\sigma} \)&lt;/span&gt; שנותנת לנו &lt;span&gt;\( dz=\frac{dx}{\sigma} \)&lt;/span&gt;, כלומר מקבלים &lt;span&gt;\( P\left(a\le Z\le b\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;המסקנה? אם &lt;span&gt;\( X \)&lt;/span&gt; התפלג נורמלית עם פרמטרים &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; אז &lt;span&gt;\( Z=\frac{X-\mu}{\sigma} \)&lt;/span&gt; מתפלג נורמלית עם פרמטרים &lt;span&gt;\( 0,1 \)&lt;/span&gt;. עכשיו אני אוכיח ש-&lt;span&gt;\( \text{E}\left[Z\right]=0 \)&lt;/span&gt; וש-&lt;span&gt;\( \text{Var}\left(Z\right)=1 \)&lt;/span&gt; ואז אסיק ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X\right]=\sigma\text{E}\left[Z\right]+\mu=\mu \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(X\right)=\sigma^{2}\text{Var}\left(Z\right)=\sigma^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו הטענה הכללית שאני רוצה.&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( \text{E}\left[Z\right] \)&lt;/span&gt; זה קל - זה יוצא 0 בגלל שפונקציית הצפיפות &lt;span&gt;\( \frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt; היא סימטרית ביחס ל-0 כי &lt;span&gt;\( z^{2} \)&lt;/span&gt; היא פונקציה סימטרית ביחס ל-0. זה הופך את האינטגרל שמחשבים עבור התוחלת לאינטגרל של פונקציה &lt;strong&gt;אנטיסימטרית&lt;/strong&gt; בגלל ההכפלה ב-&lt;span&gt;\( z \)&lt;/span&gt;. הנה משהו פורמלי קצת יותר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[Z\right]=\int_{-\infty}^{\infty}z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2}=\lim_{a\to\infty}\int_{-a}^{a}z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2}= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}\left.e^{-z^{2}/2}\right|_{-a}^{a}=\frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}\left(e^{-a^{2}/2}-e^{-a^{2}/2}\right)= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}0=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המעבר מאינטגרל אינסופי בשני הכיוונים לגבול כש-&lt;span&gt;\( a \)&lt;/span&gt; שואף לאינסוף של אינטגרל מ-&lt;span&gt;\( -a \)&lt;/span&gt; אל &lt;span&gt;\( a \)&lt;/span&gt; הוא &lt;strong&gt;לא תקין&lt;/strong&gt; באופן כללי אבל בפוסט הקודם כבר אמרנו שבמקרה הנוכחי זה תקין (אבל אפשר להסתדר גם אם עושים שני אינטגרלים, זה פשוט יוצא מסורבל יותר). אז זה מסיים עם התוחלת ומראה שכדי לחשב את השונות צריך פשוט לחשב את &lt;span&gt;\( \text{E}\left[Z^{2}\right] \)&lt;/span&gt;. זה יהיה טיפה יותר מסובך ויצריך טריק אינטגרציה סטנדרטי: &lt;strong&gt;אינטגרציה בחלקים&lt;/strong&gt;. בואו ניזכר את הטריק הזה הולך.&lt;/p&gt;

&lt;p&gt;עבור נגזרות, אחת מהנוסחאות החשובות ביותר היא מה יוצאת הגזירה של מכפלה של פונקציות: &lt;span&gt;\( \left(uv\right)^{\prime}=u^{\prime}v+uv^{\prime} \)&lt;/span&gt;. זו אחת מהנוסחאות הבודדות שצרובות בי עוד מהתיכון. עכשיו, אם מעבירים אגפים, מקבלים מן הסתם &lt;span&gt;\( u^{\prime}v=\left(uv\right)^{\prime}-uv^{\prime} \)&lt;/span&gt; ואם (ועכשיו אני עובר לקצת נפנוף ידיים) לוקחים אינטגרל לשני האגפים מקבלים &lt;span&gt;\( \int u^{\prime}v=uv-\int uv^{\prime} \)&lt;/span&gt;. לכן אם קשה לנו לבצע אינטגרציה לפונקציה שלנו, אנחנו בודקים אם יש דרך נוחה לפרק אותה למכפלה של שתי פונקציות שלאחת מהן (שאנחנו קוראים לה &lt;span&gt;\( u^{\prime} \)&lt;/span&gt;) כן קל לנו להוציא אינטגרל, את השניה (שאנחנו קוראים לה &lt;span&gt;\( v \)&lt;/span&gt;) קל לנו לגזור, ואז אנחנו מקווים שאחרי שנוציא אינטגרל לאחת ונגזרת לשניה, המכפלה של &lt;strong&gt;זה&lt;/strong&gt; תהיה משהו שקל לנו למצוא לו אינטגרל. לפעמים זה נכשל קטסטרופלית ולפעמים, כמו עכשיו, זה עובד יופי. הרי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[Z^{2}\right]=\int_{-\infty}^{\infty}z^{2}\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולפני רגע, בחישוב התוחלת, ראינו שקל לנו להוציא את האינטגרל של &lt;span&gt;\( u^{\prime}=z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt; והאינטגרל יוצא &lt;span&gt;\( u=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;, וכמובן שאת &lt;span&gt;\( v=z \)&lt;/span&gt; קל לגזור ולקבל &lt;span&gt;\( v^{\prime}=1 \)&lt;/span&gt;. כמו כן &lt;span&gt;\( uv \)&lt;/span&gt; הולך לצאת בדיוק הביטוי לתוחלת שראינו לפני רגע שהאינטגרל שלו הוא 0, ו-&lt;span&gt;\( uv^{\prime} \)&lt;/span&gt; הולך לצאת בדיוק פונקציית הצפיפות המקורית שראינו כבר (בפוסט הקודם, ולא בקלות) שהאינטגרל שלה יוצא 1. זה מסיים (בנפנוף ידיים) את ההוכחה.&lt;/p&gt;

&lt;p&gt;אז אם לסכם עוד סיכום ביניים: אנחנו מנסים להבין למה פונקציית הצפיפות של ההתפלגות הנורמלית נראית ככה: &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt;. בינתיים הבנו ש-&lt;span&gt;\( \pi \)&lt;/span&gt; שם בתור קבוע נרמול שמגיע בבסיסו מכך ש-&lt;span&gt;\( 2\pi \)&lt;/span&gt; הוא היקף מעגל היחידה; ואנחנו רואים עכשיו ש-&lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; שמופיעים פה מבטיחים שהתוחלת וסטיית התקן של ההתפלגות יהיו &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt;; אבל עדיין לא ברור לנו הדבר העיקרי - מה הקטע עם ה-&lt;span&gt;\( e \)&lt;/span&gt; הזה? למה הצורה של העקומה היא (עד כדי קבועים) &lt;span&gt;\( e^{-x^{2}} \)&lt;/span&gt;? אני לא רואה איך לענות לשאלה הזו בלי להגיע אל היעד שלנו: &lt;strong&gt;משפט הגבול המרכזי&lt;/strong&gt;. את זה נעשה בפוסט הבא.&lt;/p&gt;</content><author><name></name></author><category term="התפלגות נורמלית" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/2025/histogram_12.png" /><media:content medium="image" url="http://gadial.net/assets/img/2025/histogram_12.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>