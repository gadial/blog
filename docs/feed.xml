<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://gadial.net/feed.xml" rel="self" type="application/atom+xml" /><link href="http://gadial.net/" rel="alternate" type="text/html" /><updated>2025-06-11T17:05:27+00:00</updated><id>http://gadial.net/feed.xml</id><title type="html">לא מדויק</title><subtitle>בלוג על מתמטיקה ומדעי המחשב</subtitle><entry><title type="html">פונקציות יוצרות ומספרי קטלן</title><link href="http://gadial.net/2025/06/11/catalan_numbers_and_generating_functions/" rel="alternate" type="text/html" title="פונקציות יוצרות ומספרי קטלן" /><published>2025-06-11T00:00:00+00:00</published><updated>2025-06-11T00:00:00+00:00</updated><id>http://gadial.net/2025/06/11/catalan_numbers_and_generating_functions</id><content type="html" xml:base="http://gadial.net/2025/06/11/catalan_numbers_and_generating_functions/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://gadial.net/2025/05/31/catalan_numbers/&quot;&gt;בפוסט הקודם&lt;/a&gt; שלי כתבתי על מספרי קטלן, סדרת המספרים &lt;span&gt;\( 1,1,2,5,14,42,\ldots \)&lt;/span&gt;. הראיתי נוסחת נסיגה עבורה, &lt;span&gt;\( C_{n+1}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;; הראיתי נוסחה סגורה עבורה, &lt;span&gt;\( C_{n}=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;; והראיתי שלל בעיות ספירה שמספרי קטלן פותרים, משילושים של מצולעים, עבור בעצים בינאריים וכלה במגדלי קפלר. רק דבר אחד לא הראיתי, למרות שהוא מושג מרכזי וחשוב בקומבינטוריקה באופן כללי: את &lt;strong&gt;הפונקציה היוצרת&lt;/strong&gt; של מספרי קטלן. לא עשיתי את זה כי זה היה מעלה פי כמה את רמת הטכניות של הפוסט ומרחיק אותי מהנושא המעניין בו, שהוא מספרי קטלן עצמם; אבל עכשיו אחרי שהתרגלנו אליהם (או דילגנו לגמרי על הפוסט הקודם כי אנחנו רוצים את האקשן שיהיה כאן) אפשר להפנות זרקור אל פונקציות יוצרות בכלל, וזו של מספרי קטלן בפרט.&lt;/p&gt;

&lt;p&gt;כמיטב מסורת הבלוג, &lt;a href=&quot;https://gadial.net/2011/08/07/generating_functions_hardcore_1/&quot;&gt;כבר יש לי פוסט על הנושא הזה&lt;/a&gt;, כולל אזכור של מספרי קטלן, אבל הפעם אני רוצה &lt;strong&gt;לחפור&lt;/strong&gt; ולהציג נושאים שרק נגעתי בהם בעבר ברמת פורמליות הרבה יותר גדולה. זה אומר שהפוסט יהיה טכני יחסית, ויילך ויסתבך ככל שאתקדם, אבל נגיע לפונקציה היוצרת של קטלן יחסית מהר; האתגר יהיה להבין למה הפונקציה היוצרת הזו “חוקית” וכמה אפשר להכליל את זה. אני אגלה מראש כבר עכשיו שהפונקציה היוצרת היא &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;, אבל - מה זה בעצם אומר? ואיך מגיעים לזה? בשביל זה אני אצטרך לדבר קצת על דברים.&lt;/p&gt;

&lt;h2&gt;למה פונקציות יוצרות זה כמו פולינומים, רק פשוט יותר&lt;/h2&gt;

&lt;p&gt;הרעיון בפונקציות יוצרות הוא לקודד סדרות מספרים כמו מספרי קטלן בתור &lt;strong&gt;טורי חזקות פורמליים&lt;/strong&gt;. זה דורש הגדרה של מה זה בכלל טור חזקות פורמלי, ואם לא מכירים אותם המושג הזה קצת מוזר בהתחלה אז אפשר להתחיל עם אובייקטים יותר ידידותיים: &lt;strong&gt;פולינומים&lt;/strong&gt;. התיאור הכללי שלנו של פולינום הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{d}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( d \)&lt;/span&gt; הוא &lt;strong&gt;דרגת&lt;/strong&gt; הפולינום - החזקה הגבוהה ביותר שלו שהמקדם שלה שונה מאפס. עכשיו, על פולינומים אפשר להגדיר פעולות חיבור וכפל, אז בשביל להדגים את זה בואו נציג שני פולינומים מדרגות &lt;span&gt;\( d_{1},d_{2} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{d_{1}}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b\left(x\right)=\sum_{n=0}^{d_{2}}b_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו החיבור מוגדר “איבר-איבר”:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)+b\left(x\right)=\sum_{n=0}^{\max\left\{ d_{1},d_{2}\right\} }\left(a_{n}+b_{n}\right)x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה בסך הכל יפה מאוד חוץ מהאיכסה של ה-&lt;span&gt;\( \max\left\{ d_{1},d_{2}\right\}  \)&lt;/span&gt; למעלה שגם מצריך אותנו לענות על שאלות קשות כמו מה המקדמים של פולינום מעבר לדרגה המקסימלית שלו (אפס. הם אפס).&lt;/p&gt;

&lt;p&gt;מה עם כפל? כאן זה טיפה יותר מסובך אבל לא בצורה חריגה. בואו נתחיל עם דוגמא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a_{1}x+a_{0}\right)\left(b_{1}x+b_{0}\right)=a_{1}b_{1}x^{2}+\left(a_{0}b_{1}+a_{1}b_{0}\right)x^{1}+a_{0}b_{0}x^{0} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כדאי לחשב את הדוגמא הזו ידנית, או אפילו משהו עם איבר אחד נוסף לאחד הפולינומים, כדי לקבל תחושה טובה של “מה הולך פה”. מה שמקבלים הוא שהמקדם של כל חזקה של &lt;span&gt;\( x^{n} \)&lt;/span&gt; הוא &lt;strong&gt;סכום&lt;/strong&gt; של איברים, כשכל איבר הוא &lt;strong&gt;מכפלה&lt;/strong&gt; של מקדם של &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; ומקדם של &lt;span&gt;\( b\left(x\right) \)&lt;/span&gt;, כשהמקדמים נבחרים כך שסכום האינדקסים של שניהם יוצא &lt;span&gt;\( n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;כדי לכתוב נוסחה כללית עבור זה, קודם כל אני אכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)\cdot b\left(x\right)=\sum_{n=0}^{d_{1}+d_{2}}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו אפשר להגיד מהו כל מקדם &lt;span&gt;\( c_{n} \)&lt;/span&gt; שכזה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עד כאן - חומר לא הכי קל טכנית אבל מאוד בסיסי, הרי משתמשים בפולינומים כמעט בכל מקום במתמטיקה אוניברסיטאית. אבל אפשר להצמיד לו שתי נקודות מבט שהן טיפונת פחות נפוצות:&lt;/p&gt;

&lt;p&gt;ראשית, אפשר לחשוב על הפולינומים כאילו הם מקודדים &lt;strong&gt;סדרת מספרים&lt;/strong&gt; - סדרת המקדמים שלהם. בצורה הזו, חיבור פולינומים מתורגם לחיבור נקודתי של שתי סדרות, וכפל פולינומים מתורגם לפעולת &lt;strong&gt;קונבולוציה&lt;/strong&gt; של הסדרות. חיבור נקודתי אנחנו מכירים, אבל קונבולוציה היא פעולה שיכול לקחת זמן עד שפוגשים אותה בשם הזה לראשונה (אני נתקלתי בה בלימודים רק בסמסטר מתקדם יחסית - וכמובן, באותו סמסטר היא הופיעה שוב ושוב בשלל קורסים שונים ובלתי תלויים; עבורי במקום לומר “אפקט באדר-מיינהוף” אפשר לומר “אפקט הקונבולוציה”) אבל הנה, אנחנו רואים שבעצם הכרנו אותה מאז ומעולם, או לפחות מאז שהכרנו כפל פולינומים.&lt;/p&gt;

&lt;p&gt;שנית, שתי הפעולות הללו של חיבור וכפל הופכות את הפולינומים &lt;strong&gt;לחוג&lt;/strong&gt;. אני לא אניח שהמושג הזה מוכר כאן; לסטודנטים יכול לקחת טיפה זמן עד שהם נתקלים בו לראשונה, למרות החשיבות העצומה שלו למתמטיקה, אבל אני מניח שאנחנו כן מכירים &lt;strong&gt;שדות&lt;/strong&gt;, כי כבר באלגברה לינארית מתעסקים איתם. שדות הן קבוצות עם פעולת חיבור וכפל שמתנהגות ממש נחמד - אפילו נחמד &lt;strong&gt;מדי&lt;/strong&gt;. למשל, אפשר לחלק בכל איבר. כשעוברים לדבר על &lt;strong&gt;חוג&lt;/strong&gt; אנחנו משאירים את הדרישות של ההתנהגות הנחמדה מפעולת החיבור, וממשיכים לדרוש את חוק הפילוג (“דיסטריביוטיביות”) אבל מכפל אנחנו דורשים הרבה פחות; שיהיה אסוציאטיבי וזהו בערך. עכשיו, פולינומים דווקא מתנהגים לא רע בכלל - הכפל הוא קומוטטיבי, יש לו יחידה ואי אפשר בטעות לקבל אפס על ידי הכפלה של שני איברים שאינם אפס: זה הופך פולינומים למה שנקרא &lt;strong&gt;תחום שלמות&lt;/strong&gt;, שזה משהו שהאבטיפוס שלו הוא המספרים השלמים. כשהמקדמים של הפולינומים הם מעל שדה &lt;span&gt;\( F \)&lt;/span&gt; אנחנו מסמנים את חוג הפולינומים המתאים ב-&lt;span&gt;\( F\left[x\right] \)&lt;/span&gt;, משתמשים בו לשלל מטרות יפות (למשל, בנייה של שדות שמרחיבים את &lt;span&gt;\( F \)&lt;/span&gt;) וכולם מרוצים.&lt;/p&gt;

&lt;p&gt;אבל אני לא רוצה לדבר על פולינומים. אני רוצה לדבר על טורי חזקות פורמליים.&lt;/p&gt;

&lt;p&gt;מה ההבדל בין פולינומים לטורי חזקות פורמליים? פשוט מאוד. הנה פולינום:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{d}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנה טור חזקות פורמלי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, במקום סכום של &lt;span&gt;\( d+1 \)&lt;/span&gt; איברים, יש לנו סכום של אינסוף איברים. לראות סכום כזה מייד מעלה את השאלה הקשה - &lt;strong&gt;למה זה מתכנס&lt;/strong&gt;? אבל כשמדברים על “טור חזקות פורמלי” ה”פורמלי” אומר בדיוק שהטור קיים גם בלי לעמוד בדרישות התכנסות כלשהן. זו הנקודה שנשמעת הכי חשודה בסיפור אז בואו נעשה את זה לאט.&lt;/p&gt;

&lt;p&gt;בהחלט &lt;strong&gt;יש&lt;/strong&gt; משמעות לשאלות התכנסות כשאני לוקח טור כמו &lt;span&gt;\( \sum_{n=0}^{\infty}\frac{1}{2^{n}} \)&lt;/span&gt; ושואל מה הסכום שלו. כאן יש לנו סדרה &lt;span&gt;\( \left\{ a_{n}\right\} _{n=0}^{\infty} \)&lt;/span&gt;של מספרים ממשיים, &lt;span&gt;\( a_{n}=\frac{1}{2^{n}} \)&lt;/span&gt;. אנחנו יודעים לחבר שני מספרים ממשיים, ובאינדוקציה גם שלושה, ארבעה וכן הלאה - כל מספר &lt;strong&gt;סופי&lt;/strong&gt; שלהם. אבל להתאים מספר קונקרטי לסכום של &lt;strong&gt;אינסוף&lt;/strong&gt; מביניהם - זה כבר דורש טכניקות נוספות, ולא בהכרח תמיד יעבוד. אפשר לכתוב &lt;span&gt;\( \sum_{n=0}^{\infty}\frac{1}{2^{n}}=2 \)&lt;/span&gt; בעזרת השיטה המקובלת לסכימה של טור אינסופי, אבל היא גם תאלץ אותנו לכתוב &lt;span&gt;\( \sum_{n=0}^{\infty}2^{n}=\infty \)&lt;/span&gt;. העניין הוא שבשני המקרים הללו, בין אם הטור מתכנס ובין אם לא, אף אחד לא חושב שיש בעיה עם קיום &lt;strong&gt;הסדרה&lt;/strong&gt;: גם הסדרה &lt;span&gt;\( \left\{ \frac{1}{2^{n}}\right\} _{n=0}^{\infty} \)&lt;/span&gt; וגם הסדרה &lt;span&gt;\( \left\{ 2^{n}\right\} _{n=0}^{\infty} \)&lt;/span&gt; הן אובייקטים שאנחנו לא מערערים על הקיום שלהם, אלא רק תוהים לגבי השאלה האם לאותם אובייקטים אפשר להתאים מספר שיתאר במובן מסויים את הסכום שלהם.&lt;/p&gt;

&lt;p&gt;עם טורי חזקות פורמליים זה אותו דבר. אם הסימון &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt; מעורר בנו אי נוחות כי אנחנו מצפים, כשאנחנו רואים סכום, שהוא יתכנס למשהו, הרי שלראות את &lt;span&gt;\( \left(a_{0},a_{1},a_{2},\ldots\right) \)&lt;/span&gt; לא יעורר בנו את אותו סוג של אי נוחות, אבל שני אלו הם פשוט סימונים שונים לאותו דבר. כמו שהרברט וילף כותב ב-generatingfunctionology שלו: פונקציות יוצרות הן חבל כביסה שעליו אנחנו תולים מספרים לתצוגה.&lt;/p&gt;

&lt;p&gt;אחרי שאנחנו מוכנים לקבל את &lt;strong&gt;הקיום&lt;/strong&gt; של אובייקט כמו &lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;, אפשר לעבור לדבר על מה שעושים איתו - ומה שעושים איתו הוא &lt;strong&gt;אלגברה&lt;/strong&gt;, כלומר פעולות כמו חיבור וכפל. ראינו את ההגדרה עבור פולינומים; איך היא תשתנה עבור טורי חזקות? ובכן, עבור חיבור היא תהפוך מ-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)+b\left(x\right)=\sum_{n=0}^{\max\left\{ d_{1},d_{2}\right\} }\left(a_{n}+b_{n}\right)x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)+b\left(x\right)=\sum_{n=0}^{\infty}\left(a_{n}+b_{n}\right)x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עבור כפל היא תהפוך מ-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)\cdot b\left(x\right)=\sum_{n=0}^{d_{1}+d_{2}}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)\cdot b\left(x\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר בשני המקרים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, ההגדרה הפכה להיות &lt;strong&gt;אלגנטית יותר&lt;/strong&gt; כי לא צריך להסתבך עם הדרגות המעצבנות של הפולינומים. למה זה עובד, למרות שבטור חזקות יש אינסוף איברים? כי גם בהגדרת החיבור וגם בהגדרת הכפל, הערך של כל מקדם הוא סכום &lt;strong&gt;סופי&lt;/strong&gt; של איברים. המקדמים הם לא איברים פורמליים בעצמם; הם מספרים ממשיים (או מרוכבים, או איברים בשדה אחר). אז ביטוי כמו &lt;span&gt;\( a_{n}+b_{n} \)&lt;/span&gt; הוא סכום של שני מספרים ממשיים, וסכום כזה בוודאי קיים; וביטוי כמו &lt;span&gt;\( \sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt; הוא סכום יותר מורכב אבל עדיין כזה שכולל רק מספר &lt;strong&gt;סופי&lt;/strong&gt; של מחוברים. אם היו אינסוף מחוברים, אז היינו בצרות. אבל אנחנו לא בצרות, ובדיוק כמו שעבור הפולינומים קיבלנו חוג שמסומן ב-&lt;span&gt;\( F\left[x\right] \)&lt;/span&gt;, גם עבור טורי חזקות קיבלנו חוג, ואפילו תחום שלמות (ואפילו תחום שלמות עם כל מני תכונות אלגבריות נחמדות שלא אכנס אליהן) שמסומן ב-&lt;span&gt;\( F\left[\left[x\right]\right] \)&lt;/span&gt;.&lt;/p&gt;

&lt;h2&gt;קצת חימום טכני - הטור ההנדסי האינסופי ומספרי פיבונאצ&apos;י&lt;/h2&gt;

&lt;p&gt;בואו נראה שתי דוגמאות פשוטות לעבודה עם פונקציות יוצרות. ראשית, ניקח את הסדרה הממש פשוטה &lt;span&gt;\( a_{n}=1 \)&lt;/span&gt;, כלומר את הפונקציה היוצרת &lt;span&gt;\( 1+x+x^{2}+x^{3}+\ldots \)&lt;/span&gt;. אם נכפול אותה ב-&lt;span&gt;\( \left(1-x\right) \)&lt;/span&gt;, שהוא הפונקציה היוצרת &lt;span&gt;\( \sum_{n=0}^{\infty}b_{n}x^{n} \)&lt;/span&gt; עם&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{n}=\begin{cases} 1 &amp;amp; n=0\\ -1 &amp;amp; n=1\\ 0 &amp;amp; n&amp;gt;1 \end{cases} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x+x^{2}+x^{3}+\ldots\right)\left(1-x\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( c_{0}=a_{0}b_{0}=1 \)&lt;/span&gt; ו-&lt;span&gt;\( c_{1}=a_{0}b_{1}+a_{1}b_{0}=b_{1}+b_{0}=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובאופן כללי, בגלל שכל ה-&lt;span&gt;\( a_{n} \)&lt;/span&gt;-ים הם 1 אז בעצם &lt;span&gt;\( \sum_{k=0}^{n}a_{k}b_{n-k}=\sum_{k=0}^{n}b_{n-k} \)&lt;/span&gt;, ומכיוון שסכום כל ה-&lt;span&gt;\( b \)&lt;/span&gt;-ים החל מ-&lt;span&gt;\( b_{0} \)&lt;/span&gt; ועד למקום כלשהו הוא סכום של 1, מינוס 1 ועוד אפסים, נקבל &lt;span&gt;\( c_{n}=0 \)&lt;/span&gt; לכל &lt;span&gt;\( n&amp;gt;0 \)&lt;/span&gt;. המסקנה היא ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x+x^{2}+x^{3}+\ldots\right)\left(1-x\right)=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, בחוג &lt;span&gt;\( F\left[\left[x\right]\right] \)&lt;/span&gt; האיבר &lt;span&gt;\( 1+x+x^{2}+\ldots \)&lt;/span&gt; הוא &lt;strong&gt;הפיך&lt;/strong&gt; וההופכי שלו הוא &lt;span&gt;\( \left(1-x\right) \)&lt;/span&gt;. כדי לתאר את זה בצורה שקל לנו לעכל, אוהבים לסמן את זה כך:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;קרוב לודאי שאתם מכירים את השוויון הזה בתור נוסחת הסכום של סדרה הנדסית מתכנסת - אבל כאן הוכחנו את הנכונות שלו בלי שיקולי התכנסות! ה”מחיר” הוא שאי אפשר להציב ערכים ב-&lt;span&gt;\( x \)&lt;/span&gt; ולצפות שהשויון יתקיים עבורם; למשל אם נציב &lt;span&gt;\( x=2 \)&lt;/span&gt; נקבל את הסכום הידוע לשמצה &lt;span&gt;\( 1+2+4+8+\ldots=-1 \)&lt;/span&gt; (שנראה מופרך אבל הוא בעצם לא מופרך בכלל, אם אנחנו לא במספרים הממשיים אלא &lt;a href=&quot;https://gadial.net/2014/01/18/sum_of_naturals/&quot;&gt;במקום קסום אחר&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;בואו נעבור לדוגמא קצת יותר מחוכמת: סדרת פיבונאצ’י. הסדרה הזו מוגדרת על ידי הגדרה רקורסיבית: &lt;span&gt;\( F_{0}=1,F_{1}=1 \)&lt;/span&gt; ו-&lt;span&gt;\( F_{n}=F_{n-1}+F_{n-2} \)&lt;/span&gt;. הגדרה רקורסיבית שכזו נותנת לנו דרך פשוטה לגלות מה הפונקציה היוצרת של הסדרה &lt;span&gt;\( F_{0},F_{1},F_{2},\ldots \)&lt;/span&gt;. ראשית כל, נכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)=\sum_{n=0}^{\infty}F_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, היינו רוצים להציב במקום &lt;span&gt;\( F_{n} \)&lt;/span&gt; את &lt;span&gt;\( F_{n}=F_{n-1}+F_{n-2} \)&lt;/span&gt;, אבל אי אפשר לעשות את זה מיידית, כי עבור &lt;span&gt;\( n=0,1 \)&lt;/span&gt; הנוסחה הזו לא מתקיימת. אז נפריד את הסכום לשני האיברים הראשונים וכל היתר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)=\left(1\cdot x^{0}+1\cdot x^{1}\right)+\sum_{n=2}^{\infty}F_{n}x^{n}=\left(1+x\right)+\sum_{n=2}^{\infty}\left(F_{n-1}+F_{n-2}\right)x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\left(1+x\right)+\sum_{n=2}^{\infty}F_{n-1}x^{n}+\sum_{n=2}^{\infty}F_{n-2}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המטרה שלי היא לנסות לגרום לשני הסכומים הללו להיראות כמו הסכום המקורי שהגדיר את הפונקציה היוצרת של פיבונאצ’י. בואו נסתכל על &lt;span&gt;\( \sum_{n=2}^{\infty}F_{n-2}x^{n} \)&lt;/span&gt; קודם - אני יכול לשנות את אינדקס הסכימה. כלל אצבע שקל לזכור הוא - אני יכול &lt;strong&gt;להגדיל&lt;/strong&gt; את האינדקס באיזה ערך שאני רוצה (במקרה הנוכחי, 2) בתנאי שאני &lt;strong&gt;מקטין&lt;/strong&gt; את הערך ההתחלתי באותה כמות. כלומר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{n=2}^{\infty}F_{n-2}x^{n}=\sum_{n=0}^{\infty}F_{n}x^{n+2}=x^{2}\sum_{n=0}^{\infty}F_{n}x^{n}=x^{2}F\left(x\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עבור &lt;span&gt;\( \sum_{n=2}^{\infty}F_{n-1}x^{n} \)&lt;/span&gt; זה יהיה טיפה טריקי יותר כי אם אני אגדיל את אינדקס הסכימה ב-1, אני עדיין לא אקבל את &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; בסכום, כי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{n=2}^{\infty}F_{n-1}x^{n}=\sum_{n=1}^{\infty}F_{n}x^{n+1}=x\sum_{n=1}^{\infty}F_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הסכום פה מתחיל מ-1, לא מ-0. כדי לטפל בזה אני יכול &lt;strong&gt;לחבר ולחסר&lt;/strong&gt; את אותו איבר, שבמקרה הנוכחי הוא &lt;span&gt;\( F_{0}x^{0}=1 \)&lt;/span&gt; (למעשה, בחרתי להתחיל את פיבונאצ’י מ-1 ולא מ-0 כדי להדגים את ההתמודדות עם הקושי הזה). כלומר, אני אכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x\sum_{n=1}^{\infty}F_{n}x^{n}=x\left(\sum_{n=0}^{\infty}F_{n}x^{n}-1\right)=xF\left(x\right)-x \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן מכל זה קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)=\left(1+x\right)+x^{2}F\left(x\right)+xF\left(x\right)-x=\left(x^{2}+x\right)F\left(x\right)+1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להעביר את &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; אגף ולהוציא גורם משותף - אלו פעולות תקינות בכל חוג. נקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)\left(1-x^{2}-x\right)=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שהייתי רוצה לעשות עכשיו הוא &lt;strong&gt;לחלק&lt;/strong&gt; ב-&lt;span&gt;\( 1-x^{2}-x \)&lt;/span&gt;. האם מותר לי? כבר ראיתי שאפשר לחלק ב-&lt;span&gt;\( \left(1-x\right) \)&lt;/span&gt;, אבל מה עם דברים מורכבים יותר? תכף אני אוכיח שכל עוד המקדם החופשי הפיך, תמיד אפשר לחלק, אז התוצאה היא שאני יכול לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( F\left(x\right)=\frac{1}{1-x^{2}-x} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו הפונקציה היוצרת של מספרי פיבונאצ’י (כשהם מתחילים מ-1 ולא מ-0). בשביל מה זה היה טוב? מה אפשר לעשות איתה שלא יכלנו לעשות בלעדיה? זה סיפור אחר - אפשר למשל לקבל ממנה את הנוסחה הסגורה למספרי פיבונאצ’י, או הערכות אסימפטוטיות על קצב הגידול שלה; כל זה מצריך לקחת את הפונקציה היוצרת ולזרוק עליה כלים סטנדרטיים שיודעים לטפל באנליזה של פונקציות רציונליות. הדגש פה הוא על &lt;strong&gt;סטנדרטיים&lt;/strong&gt; - זו הסיבה שמתמטיקאים אוהבים פונקציות יוצרות, זו דרך קומפקטית לייצר סדרות, שאחר כך אפשר להשתמש עליה בכל המתמטיקה שאנחנו מכירים.&lt;/p&gt;

&lt;p&gt;כדי לסיים את החלק הזה אני צריך להוכיח את מה שטענתי קודם: ש-&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt; הוא הפיך אם ורק אם &lt;span&gt;\( a_{0} \)&lt;/span&gt; הפיך. הרעיון בבסיסו הוא אותו רעיון כמו ההיפוך של &lt;span&gt;\( 1+x+x^{2}+\ldots \)&lt;/span&gt; רק שהפעם במקום לזרוק מהשמיים את ההופכי אני אסביר איך מוצאים אותו.&lt;/p&gt;

&lt;p&gt;אם קיים הופכי, &lt;span&gt;\( b\left(x\right)=\sum_{n=0}^{\infty}b_{n}x^{n} \)&lt;/span&gt;, מה המקדמים שלו &lt;strong&gt;חייבים&lt;/strong&gt; להיות? אנחנו יודעים ש-&lt;span&gt;\( a\left(x\right)b\left(x\right)=1 \)&lt;/span&gt; (כי זו ההגדרה של הופכי), כלומר אם נכתוב &lt;span&gt;\( a\left(x\right)\cdot b\left(x\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt; אז &lt;span&gt;\( c_{0}=1 \)&lt;/span&gt; ו-&lt;span&gt;\( c_{n}=0 \)&lt;/span&gt; לכל &lt;span&gt;\( n&amp;gt;0 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מהשוויון הראשון אנחנו מקבלים &lt;span&gt;\( a_{0}b_{0}=1 \)&lt;/span&gt;. כלומר, אם &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; היה הפיך אז השוויון הזה מראה לנו ש-&lt;span&gt;\( a_{0} \)&lt;/span&gt; הפיך ו-&lt;span&gt;\( b_{0} \)&lt;/span&gt; הוא ההופכי שלו; זה כיוון אחד של ההוכחה. הכיוון המורכב יותר הוא להניח ש-&lt;span&gt;\( a_{0} \)&lt;/span&gt; הפיך ולכן באמת קיים לו הופכי &lt;span&gt;\( b_{0} \)&lt;/span&gt;, וזה נותן לנו את &lt;strong&gt;ההתחלה&lt;/strong&gt; של הבניה של &lt;span&gt;\( b\left(x\right) \)&lt;/span&gt;, אבל צריך להראות שאפשר לבנות גם את יתר המקדמים.&lt;/p&gt;

&lt;p&gt;למרבה המזל, יתר המקדמים מתקבלים מאליהם, בדרך אינדוקטיבית. נניח שכבר ידועים לנו המקדמים &lt;span&gt;\( b_{0},\ldots,b_{n-1} \)&lt;/span&gt; ונבנה את &lt;span&gt;\( b_{n} \)&lt;/span&gt;. מכיוון ש-&lt;span&gt;\( n&amp;gt;0 \)&lt;/span&gt; אז &lt;span&gt;\( c_{n}=0 \)&lt;/span&gt; ולכן השוויון &lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt; שמגדיר את המקדם במכפלה נותן לנו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{0}b_{n}=-\sum_{k=1}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, אמרנו כבר ש-&lt;span&gt;\( a_{0} \)&lt;/span&gt; הפיך, אז אפשר לחלק בו - כלומר, לכפול ב-&lt;span&gt;\( b_{0} \)&lt;/span&gt;, ולקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{n}=-b_{0}\sum_{k=1}^{n}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אגף ימין מורכב כולו מפעולת &lt;strong&gt;חוקיות&lt;/strong&gt; בחוג &lt;span&gt;\( F \)&lt;/span&gt; שמעליו אנחנו מגדירים את &lt;span&gt;\( F\left[\left[x\right]\right] \)&lt;/span&gt;, כך שהבניה עובדת וזה מסיים את ההוכחה! לא רק שהוכחנו ש-&lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; הפיך, גם עשינו את זה בדרך קונסטרוקטיבית שמוצאת את ההופכי שלו.&lt;/p&gt;

&lt;h2&gt;הפונקציה היוצרת של מספרי קטלן&lt;/h2&gt;

&lt;p&gt;עד כאן, הכל טוב, אז בואו נתמודד עם האתגר המרכזי שלנו - מציאת הפונקציה היוצרת של מספרי קטלן.&lt;/p&gt;

&lt;p&gt;יש כמה דרכים להגיע אל הפונקציה היוצרת של מספרי קטלן, ואחת הפשוטות שבהן היא להניח שכבר מצאנו את נוסחת הנסיגה שלהם, שראינו בפוסט הקודם: &lt;span&gt;\( C_{n+1}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;, עם תנאי ההתחלה &lt;span&gt;\( C_{0}=1 \)&lt;/span&gt;. הנוסחה הזו גם מזכירה קצת את זו של פיבונאצ’י ולכן הטכניקה שבה השתמשנו עבור פיבונאצ’י נראית מבטיחה כאן - אבל אפילו עוד יותר מכך, הנוסחה הזו מזכירה את איך שמכפלת פולינומים עובדת: &lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k} \)&lt;/span&gt;. רק הקטע הזה עם ה-&lt;span&gt;\( n+1 \)&lt;/span&gt; טיפה שונה. בואו נראה איך זה יסתדר לנו.&lt;/p&gt;

&lt;p&gt;נתחיל עם להגדיר את הפונקציה היוצרת: &lt;span&gt;\( C\left(x\right)=\sum_{n=0}^{\infty}C_{n}x^{n} \)&lt;/span&gt;. עכשיו, בואו נכפיל את &lt;span&gt;\( C\left(x\right) \)&lt;/span&gt; &lt;strong&gt;בעצמה&lt;/strong&gt; כדי לנסות לקבל משהו שנראה כמו הנוסחה למכפלת פולינומים. אני אסמן את ההכפלה של &lt;span&gt;\( C\left(x\right) \)&lt;/span&gt; בעצמה ב-&lt;span&gt;\( C\left(x\right)^{2} \)&lt;/span&gt; - גם זה סימון סטנדרטי לגמרי בחוגים באופן כללי, ואני מקפיד על הפדנטיות הזו רק כי עוד רגע יגיעו דברים לא לגמרי סטנדרטיים.&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C\left(x\right)^{2}=\sum_{n=0}^{\infty}A_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A_{n}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה מה שנובע מהנוסחה למכפלת פולינומים. אבל בנוסף לכך אנחנו מכירים את נוסחת הנסיגה של קטלן, &lt;span&gt;\( C_{n+1}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;, ולכן משילוב של שתיהן אנחנו מקבלים ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A_{n}=C_{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C\left(x\right)^{2}=\sum_{n=0}^{\infty}C_{n+1}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הייתי רוצה להשתמש באותו טריק כמו פיבונאצ’י כדי להמיר את אגף ימין ל-&lt;span&gt;\( C\left(x\right) \)&lt;/span&gt;, אבל יש לי כאן בעיה. קודם, בפיבונאצ’י, הסכימה התחילה ממשהו גדול מ-0, והמקדם בפנים היה בעל אינדקס קטן מ-&lt;span&gt;\( n \)&lt;/span&gt;, ולכן היה קל לתקן את זה - הגדלנו את האינדקס, הקטנו את הערך ההתחלתי. כאן, לעומת זאת, הסכימה מתחילה מ-0, כלומר מהערך הנכון, והאינדקס הוא גדול מ-&lt;span&gt;\( n \)&lt;/span&gt;. אז נעשה משהו טיפה שונה: קודם כל נכפול את שני האגפים ב-&lt;span&gt;\( x \)&lt;/span&gt; (פעולה מותרת בחוג), ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( xC\left(x\right)^{2}=\sum_{n=0}^{\infty}C_{n+1}x^{n+1}=\sum_{n=1}^{\infty}C_{n}x^{n}=\sum_{n=0}^{\infty}C_{n}x^{n}-C_{0}=C\left(x\right)-1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אחרי העברת אגפים נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( xC\left(x\right)^{2}-C\left(x\right)+1=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו… משוואה ריבועית? עכשיו אפשר לנפנף ממש מהר בידיים כמו שחלק מהספרים עושים: להגיד שנוסחת השורשים מלמדת אותנו ש-&lt;span&gt;\( C\left(x\right)=\frac{1\pm\sqrt{1-4x}}{2x} \)&lt;/span&gt; ושהפתרון ה”נכון” מבין השניים הוא זה עם המינוס, כי אם נסתכל על &lt;span&gt;\( \frac{1+\sqrt{1-4x}}{2x} \)&lt;/span&gt; נראה שכש-&lt;span&gt;\( x \)&lt;/span&gt; שואף ל-0 המונה שואף ל-2 ולכן הביטוי שואף לאינסוף למרות שהוא אמור לשאוף ל-&lt;span&gt;\( C_{0}=1 \)&lt;/span&gt; ולעומת זאת עבור &lt;span&gt;\( \frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt; קל לראות שזה עובד עם כלל לופיטל, וסיימנו! גילינו את הנוסחה לפונקציה היוצרת של מספרי קטלן, &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;. זהו, אפשר לסגור את הפוסט.&lt;/p&gt;

&lt;h2&gt;אפשר לסגור את הפוסט, או שלא&lt;/h2&gt;

&lt;p&gt;אוקיי, בואו לא נסגור עדיין את הפוסט.&lt;/p&gt;

&lt;p&gt;חשוב לי להדגיש שכל מה שראינו פה הוא &lt;strong&gt;נכון&lt;/strong&gt;. זה למעשה מה שאוילר עשה במכתב הראשון שבו הוא סיפר לגולדבך על מספרי קטלן. אבל בבירור לא עשיתי את זה ברמת הפורמליות שבה התייחסתי לטורי חזקות פורמליים בכל יתר הפוסט, ומה שעוד יותר גרוע - פתאום ברגע האחרון עירבתי מושגים מאנליזה ודיברתי על להשאיף את &lt;span&gt;\( x \)&lt;/span&gt; לאפס ועל כלל לופיטל… זה בלאגן שלם. לכן אני רוצה להקדיש את החלק הזה של הפוסט, שיהיה יותר מורכב מתמטית ממה שעשינו עד עכשיו, כדי להסביר למה הכל בסדר.&lt;/p&gt;

&lt;p&gt;הרגע האחרון שבו הכל היה באמת בסדר פורמלית היה כשקיבלתי את המשוואה &lt;span&gt;\( xC\left(x\right)^{2}-C\left(x\right)+1=0 \)&lt;/span&gt;. הדבר הבא שעשיתי היה להזכיר את &lt;strong&gt;נוסחת השורשים&lt;/strong&gt;. נוסחת השורשים היא הכלי הסטנדרטי שלנו לפתרון משוואה ריבועית, והיא נכונה בהרבה סיטואציות, לא רק במספרים הממשיים והמרוכבים. בואו נראה את זה: אני נמצא בחוג &lt;span&gt;\( R \)&lt;/span&gt; כלשהו, עם איברים &lt;span&gt;\( a,b,c\in R \)&lt;/span&gt;, ואני מחפש ערך של &lt;span&gt;\( x\in R \)&lt;/span&gt; שמקיים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( ax^{2}+bx+c=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gadial.net/2023/12/16/quadratic_equations/&quot;&gt;יש לי פוסט&lt;/a&gt; שמסביר מה עושים עכשיו, אבל אני אתן פה תיאור טיפה שונה. ראשית, נכפול את שני אגפי המשוואה ב-&lt;span&gt;\( 4a \)&lt;/span&gt; ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 4a^{2}x^{2}+4abx+4ac=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה עדיין מתקיים בכל חוג &lt;span&gt;\( R \)&lt;/span&gt;. עכשיו, נסתכל על הביטוי &lt;span&gt;\( \Delta=b^{2}-4ac \)&lt;/span&gt; (“הדיסקרימיננטה”). גם הביטוי הזה - קיים בכל חוג &lt;span&gt;\( R \)&lt;/span&gt;. נחבר אותו לשני האגפים ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 4a^{2}x^{2}+4abx+b^{2}=\Delta \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אגף שמאל נראה בדיוק כמו משהו בריבוע: &lt;span&gt;\( 4a^{2}x^{2}+4abx+b^{2}=\left(2ax+b\right)^{2} \)&lt;/span&gt;. &lt;strong&gt;גם זה עדיין נכון בכל חוג&lt;/strong&gt;. כלומר, קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(2ax+b\right)^{2}=\Delta \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו מגיע המעבר ה”בעייתי”:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 2ax+b=\pm\sqrt{\Delta} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המעבר הזה בעייתי לא רק בגלל שאנחנו בחוג כללי - אפילו אם היינו עובדים מעל הממשיים, &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt;, הוא עדיין היה בעייתי אם &lt;span&gt;\( \Delta \)&lt;/span&gt; היה שלילי. אז במקום לראות אותו כ”בעייתי” אפשר לחשוב על זה כאילו אנחנו מוסיפים הנחה: אנחנו אומרים - &lt;strong&gt;נניח&lt;/strong&gt; שקיים &lt;span&gt;\( \alpha\in R \)&lt;/span&gt; כך ש-&lt;span&gt;\( \alpha^{2}=\Delta \)&lt;/span&gt;, אז במקרה הזה אפשר לכתוב &lt;span&gt;\( \left(2ax+b\right)^{2}=\alpha^{2} \)&lt;/span&gt;. אבל האם עכשיו אפשר להסיק ש-&lt;span&gt;\( 2ax+b=\pm\alpha \)&lt;/span&gt;? ובכן, לא.&lt;/p&gt;

&lt;p&gt;בואו נראה דוגמא: החוג &lt;span&gt;\( R=\mathbb{Z}_{8}=\left\{ 0,1,\ldots,7\right\}  \)&lt;/span&gt; עם חיבור וכפל מודולו 8. בחוג הזה מתקיים ש-&lt;span&gt;\( 1^{2}=3^{2}=5^{2}=7^{2}=1 \)&lt;/span&gt;, ולכן אם &lt;span&gt;\( x^{2}=y^{2} \)&lt;/span&gt; זה לא אומר ש-&lt;span&gt;\( x=\pm y \)&lt;/span&gt; כי למשל מה אם &lt;span&gt;\( y=1 \)&lt;/span&gt; ואילו &lt;span&gt;\( x=3 \)&lt;/span&gt;?&lt;/p&gt;

&lt;p&gt;אז אילו תנאים צריך לדרוש מהחוג שלנו כדי ש-&lt;span&gt;\( x^{2}=y^{2} \)&lt;/span&gt; יגרור &lt;span&gt;\( x=\pm y \)&lt;/span&gt;? בואו ננסה להוכיח את זה ונראה את התנאים צצים בדרך.&lt;/p&gt;

&lt;p&gt;נתחיל עם &lt;span&gt;\( x^{2}=y^{2} \)&lt;/span&gt;. נעביר את &lt;span&gt;\( y \)&lt;/span&gt; אגף (לא דורש כלום) ונקבל &lt;span&gt;\( x^{2}-y^{2}=0 \)&lt;/span&gt;, שאפשר לכתוב גם בתור &lt;span&gt;\( \left(x-y\right)\left(x+y\right)=0 \)&lt;/span&gt;. הופס, הוספנו דרישה! רואים מה היא? השתמשתי בדיסטריביוטיביות, אבל זה לא העניין כאן אלא זה שאם נפתח את הסוגריים, נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(x-y\right)\left(x+y\right)=x^{2}-yx+xy-y^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, אני הנחתי ש-&lt;span&gt;\( xy=yx \)&lt;/span&gt; וזה קורה באופן כללי רק אם החוג &lt;strong&gt;קומוטטיבי&lt;/strong&gt;. אבל אוקיי, &lt;span&gt;\( R\left[\left[x\right]\right] \)&lt;/span&gt; שלנו הוא קומוטטיבי אם &lt;span&gt;\( R \)&lt;/span&gt; עצמו הוא קומוטטיבי (ואצלנו &lt;span&gt;\( R \)&lt;/span&gt; הוא הממשיים/המרוכבים). אז בינתיים זו דרישה קלילה יחסית (אבל שמראה יפה כמה חוגים לא קומוטטיביים - למשל חוגי מטריצות - הם עולמות משוגעים בפני עצמם).&lt;/p&gt;

&lt;p&gt;עכשיו, קיבלתי &lt;span&gt;\( \left(x-y\right)\left(x+y\right)=0 \)&lt;/span&gt;, כלומר יש לי מכפלה של שני איברים ששווה אפס. האם בכלל ייתכן שמכפלה של שני איברים תיתן אפס למרות ששניהם שונים מאפס? זה לא משהו שיש באינטואיציה המתמטית היומימית שלנו כי זה לא קורה בשלמים והרחבותיהם, אבל זה &lt;strong&gt;כן&lt;/strong&gt; קורה ב-&lt;span&gt;\( \mathbb{Z}_{8} \)&lt;/span&gt; שהבאתי כאן בתור דוגמה, למשל &lt;span&gt;\( 2\cdot4=0 \)&lt;/span&gt;. לכן בתורת החוגים יש מונחים סטנדרטיים לסיפור הזה: אנחנו אומרים ש-&lt;span&gt;\( a,b \)&lt;/span&gt; הם &lt;strong&gt;מחלקי אפס&lt;/strong&gt; אם &lt;span&gt;\( ab=0 \)&lt;/span&gt; למרות ש-&lt;span&gt;\( a,b\ne0 \)&lt;/span&gt;, וקוראים לחוג (קומוטטיבי בד”כ) בלי מחלקי אפס &lt;strong&gt;תחום שלמות&lt;/strong&gt;. בתחומי שלמות, ש-&lt;span&gt;\( \mathbb{Z} \)&lt;/span&gt; הוא מעין אבטיפוס שלהם, אפשר לבצע “צמצום”: אם &lt;span&gt;\( ax=ay \)&lt;/span&gt; אז &lt;span&gt;\( x=y \)&lt;/span&gt; זו הדוגמא הפשוטה, אבל גם &lt;span&gt;\( x^{2}=y^{2} \)&lt;/span&gt; גורר &lt;span&gt;\( x=\pm y \)&lt;/span&gt; הוא דוגמא לצמצום, ואנחנו מקבלים אותו כי אם יש לנו &lt;span&gt;\( \left(x-y\right)\left(x+y\right)=0 \)&lt;/span&gt; בתחום שלמות, או ש-&lt;span&gt;\( x-y=0 \)&lt;/span&gt; או ש-&lt;span&gt;\( x+y=0 \)&lt;/span&gt;, אין אפשרות אחרת.&lt;/p&gt;

&lt;p&gt;למרבה השמחה, &lt;span&gt;\( R\left[\left[x\right]\right] \)&lt;/span&gt; הוא תחום שלמות אם &lt;span&gt;\( R \)&lt;/span&gt; הוא תחום שלמות, כי אם &lt;span&gt;\( a\left(x\right)b\left(x\right)=0 \)&lt;/span&gt; אז בפרט &lt;span&gt;\( a_{0}b_{0}=0 \)&lt;/span&gt; ואם אנחנו מעל תחום שלמות אז בלי הגבלת הכלליות, &lt;span&gt;\( b_{0}=0 \)&lt;/span&gt;. עכשיו, &lt;span&gt;\( a_{0}b_{1}+a_{1}b_{0}=0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( a_{0}b_{1}=0 \)&lt;/span&gt; ונקבל שגם &lt;span&gt;\( b_{1}=0 \)&lt;/span&gt; וכן הלאה באינדוקציה.&lt;/p&gt;

&lt;p&gt;אם כן, חזרה למשוואות ריבועיות: מה שראינו הוא שמעל תחום שלמות, &lt;strong&gt;אם&lt;/strong&gt; קיים &lt;span&gt;\( \alpha \)&lt;/span&gt; כך ש-&lt;span&gt;\( \alpha^{2}=\Delta \)&lt;/span&gt; אז אפשר לומר &lt;span&gt;\( 2ax+b=\pm\alpha \)&lt;/span&gt;. עכשיו אפשר להעביר אגף ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 2ax=-b\pm\alpha \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כדי להתקדם מכאן, אנחנו צריכים שאפשר יהיה לחלק ב-&lt;span&gt;\( 2a \)&lt;/span&gt; וזה כמובן לא נכון בכל חוג, אפילו לא בתחום שלמות, זה הרי לא נכון אפילו ב-&lt;span&gt;\( \mathbb{Z} \)&lt;/span&gt;. אבל אם אפשר לחלק ב-&lt;span&gt;\( 2a \)&lt;/span&gt; - כלומר, אם &lt;span&gt;\( 2a \)&lt;/span&gt; הוא &lt;strong&gt;הפיך&lt;/strong&gt; בחוג שלנו - אז נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=\frac{-b\pm\alpha}{2a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכדי לא לכתוב &lt;span&gt;\( \alpha \)&lt;/span&gt; מעדיפים לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=\frac{-b\pm\sqrt{b^{2}-4ac}}{2a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מתוך הבנה ש-&lt;span&gt;\( \sqrt{b^{2}-4ac} \)&lt;/span&gt; הוא &lt;strong&gt;סימון&lt;/strong&gt; שאומר “איבר בחוג שכשמעלים אותו בריבוע מקבלים &lt;span&gt;\( b^{2}-4ac \)&lt;/span&gt;, בהנחה שקיים כזה”.&lt;/p&gt;

&lt;p&gt;זה האופן שבו צריך לקרוא את המשוואה &lt;span&gt;\( C\left(x\right)=\frac{1\pm\sqrt{1-4x}}{2x} \)&lt;/span&gt; שקיבלנו עבור מספרי קטלן. מה שהיא אומרת, ברמה הפורמלית ביותר, הוא “אם קיים טור חזקות פורמלי &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( a\left(x\right)^{2}=1-4x \)&lt;/span&gt;, אז &lt;span&gt;\( C\left(x\right) \)&lt;/span&gt; הוא או &lt;span&gt;\( \frac{1+a\left(x\right)}{2x} \)&lt;/span&gt; או &lt;span&gt;\( \frac{1-a\left(x\right)}{2x} \)&lt;/span&gt;, אנחנו לא סגורים על איזה משניהם נכון”.&lt;/p&gt;

&lt;p&gt;אבל רגע, לא סיימנו! צריך להצדיק גם את החלוקה ב-&lt;span&gt;\( 2x \)&lt;/span&gt;. להצדיק חלוקה ב-&lt;span&gt;\( 2 \)&lt;/span&gt; זה קל, הרי &lt;span&gt;\( 2 \)&lt;/span&gt; הוא הפיך. אבל לחלק ב-&lt;span&gt;\( 2x \)&lt;/span&gt;? הרי לפני רגע אמרתי שטור חזקות הוא הפיך אם ורק אם האיבר החופשי שלו הוא הפיך, וב-&lt;span&gt;\( 2x \)&lt;/span&gt;, כשאני חושב עליו בתור טור חזקות, האיבר החופשי הוא 0, כלומר לא הפיך. &lt;strong&gt;אופס&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;העניין הוא שכן אפשר סוג של “לחלק” ב-&lt;span&gt;\( x \)&lt;/span&gt;. לפעמים. הנה דוגמא לאיך זה עובד. נניח ש-&lt;span&gt;\( a\left(x\right)=a_{1}x+a_{2}x^{2}+\ldots \)&lt;/span&gt;, כלומר יש לנו טור חזקות שהמקדם החופשי שלו הוא 0. אז אפשר &lt;strong&gt;להוציא החוצה&lt;/strong&gt; את &lt;span&gt;\( x \)&lt;/span&gt; ולקבל &lt;span&gt;\( a\left(x\right)=x\left(a_{1}+a_{2}x+\ldots\right) \)&lt;/span&gt; ואז אפשר לכתוב &lt;span&gt;\( a_{1}+a_{2}x+\ldots=\frac{a\left(x\right)}{x} \)&lt;/span&gt;. כלומר, את הפעולה “חלוקה ב-&lt;span&gt;\( x \)&lt;/span&gt;” אפשר לראות בתור “הזזה שמאלה של כל האיברים בסדרה שמתחילה ב-0” - אם היה לנו את הסדרה &lt;span&gt;\( \left(0,a_{1},a_{2},\ldots\right) \)&lt;/span&gt; אחרי ביצוע הפעולה הזו קיבלנו את הסדרה &lt;span&gt;\( \left(a_{1},a_{2},\ldots\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עוד יותר פורמלית, מה שאנחנו רואים במשוואה &lt;span&gt;\( C\left(x\right)=\frac{1\pm a\left(x\right)}{2x} \)&lt;/span&gt; הוא בעצם את &lt;span&gt;\( 2xC\left(x\right)=1\pm a\left(x\right)^{2} \)&lt;/span&gt;. אם נגלה שיש &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( 1-a\left(x\right)=x\cdot b\left(x\right) \)&lt;/span&gt; כלשהו, אז נוכל לכתוב &lt;span&gt;\( 2xC\left(x\right)=xb\left(x\right) \)&lt;/span&gt; ואז נוכל &lt;strong&gt;לצמצם&lt;/strong&gt; ב-&lt;span&gt;\( x \)&lt;/span&gt;, כי אנחנו בתחום שלמות, ולקבל &lt;span&gt;\( 2C\left(x\right)=b\left(x\right) \)&lt;/span&gt;, כלומר &lt;span&gt;\( C\left(x\right)=\frac{b\left(x\right)}{2} \)&lt;/span&gt;. זה התוכן הפורמלי של הכתיב &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;העניין הזה גם מסביר לנו למה אנחנו בוחרים מינוס ולא פלוס, גם בלי שנזדקק ישירות להסברים אנליטיים: אם קיים &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( a\left(x\right)^{2}=1-4x \)&lt;/span&gt;, אז המקדם החופשי שלו מקיים &lt;span&gt;\( a_{0}^{2}=1 \)&lt;/span&gt; (כי &lt;span&gt;\( 1 \)&lt;/span&gt; הוא המקדם החופשי של המכפלה, &lt;span&gt;\( 1-4x \)&lt;/span&gt;) ובגלל שאנחנו בתחום שלמות, &lt;span&gt;\( a_{0}=\pm1 \)&lt;/span&gt;. כשמשתמשים בסימן &lt;span&gt;\( \sqrt{\cdot} \)&lt;/span&gt; עבור מספרים ממשיים הכוונה היא תמיד ללקיחת השורש החיובי, אז גם כאן נוכל להשתמש במוסכמה שלוקחים את ה-&lt;span&gt;\( a\left(x\right) \)&lt;/span&gt; עם המקדם החופשי &lt;span&gt;\( a_{0}=1 \)&lt;/span&gt;. עכשיו, אם אנחנו רוצים שהביטוי &lt;span&gt;\( \frac{1\pm a\left(x\right)}{2x} \)&lt;/span&gt; יהיה מוגדר היטב, צריך שהמקדם החופשי של &lt;span&gt;\( 1\pm a\left(x\right) \)&lt;/span&gt; יהיה 0, וזה יעבוד עבור חיסור ולא יעבוד עבור חיבור.&lt;/p&gt;

&lt;p&gt;כמובן, עדיין נותרה לנו שאלה אחת: &lt;strong&gt;למה&lt;/strong&gt; אנחנו יודעים ש-&lt;span&gt;\( \sqrt{1-4x} \)&lt;/span&gt; קיים בכלל? אני יכול לכתוב &lt;span&gt;\( a\left(x\right)^{2}=1-4x \)&lt;/span&gt; ולנסות לפתור את המשוואה ולחלץ את המקדמים של &lt;span&gt;\( a\left(x\right) \)&lt;/span&gt;, כמו שעשיתי עבור הופכי. אבל אני יכול גם לחפור יותר עמוק…&lt;/p&gt;

&lt;h2&gt;חופרים יותר עמוק&lt;/h2&gt;

&lt;p&gt;אני מניח שאנחנו מכירים את הבינום של ניוטון, ואם לא - &lt;a href=&quot;https://gadial.net/2010/06/22/newton_binom/&quot;&gt;יש לי על זה פוסט&lt;/a&gt;. זו הנוסחה החביבה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a+b\right)^{n}=\sum_{k=0}^{n}{n \choose k}a^{k}b^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;שנכונה לכל &lt;span&gt;\( n \)&lt;/span&gt; טבעי ו-&lt;span&gt;\( a,b \)&lt;/span&gt; כלשהם, אפילו איברים בחוג &lt;strong&gt;קומוטטיבי&lt;/strong&gt; כללי.&lt;/p&gt;

&lt;p&gt;זו נוסחה שימושית ונהדרת עם הוכחה קומבינטורית מקסימה וכל זה מתואר בפוסט שלי. אני רוצה לדבר הפעם על &lt;strong&gt;ההכללה&lt;/strong&gt; שלה: מה קורה אם אנחנו רוצים ש-&lt;span&gt;\( n \)&lt;/span&gt; לא יהיה מספר טבעי דווקא, אלא מספר ממשי כללי? ובכן, ניוטון דאג גם לזה, ובאמצעות חדו”א אפשר להוכיח את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a+b\right)^{r}=\sum_{k=0}^{\infty}{r \choose k}a^{k}b^{r-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( r\in\mathbb{R} \)&lt;/span&gt; הוא מספר ממשי כללי, והסימון &lt;span&gt;\( {r \choose k} \)&lt;/span&gt; מוגדר בתור&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( {r \choose k}=\frac{r\left(r-1\right)\left(r-2\right)\cdots\left(r-k+1\right)}{k!} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו ממש הכללה ישירה של הבינום הרגיל של ניוטון, שבו &lt;span&gt;\( {n \choose k}=\frac{n!}{k!\left(n-k!\right)}=\frac{n\left(n-1\right)\left(n-2\right)\cdots\left(n-k+1\right)}{k!} \)&lt;/span&gt;. העניין הוא שאם &lt;span&gt;\( n \)&lt;/span&gt; הוא מספר טבעי, ואם &lt;span&gt;\( k&amp;gt;n \)&lt;/span&gt;, אז נקבל &lt;span&gt;\( {n \choose k}=0 \)&lt;/span&gt; כי במכפלה &lt;span&gt;\( \left(n-1\right)\ldots\left(n-k+1\right) \)&lt;/span&gt; יופיע מתישהו &lt;span&gt;\( \left(n-n\right) \)&lt;/span&gt;, כלומר כל המכפלה הזו מוכפלת ב-0 ושווה ל-0 ולכן אנחנו מקבלים ש-&lt;span&gt;\( \left(a+b\right)^{n} \)&lt;/span&gt; הוא לא סכום אינסופי אלא סופי (ליתר דיוק - הוא סכום אינסופי שכל אבריו הם 0 החל ממקום מסויים).&lt;/p&gt;

&lt;p&gt;אם לעומת זאת &lt;span&gt;\( r \)&lt;/span&gt; הוא לא מספר טבעי, אז &lt;span&gt;\( \left(r-r\right) \)&lt;/span&gt; לא יופיע במכפלה ולכן היא אף פעם לא תתאפס. לכן צריך לעבור לסכום אינסופי ולקוות ממש חזק שהוא יתכנס.&lt;/p&gt;

&lt;p&gt;בואו נראה דוגמא. נניח ש- &lt;span&gt;\( a=-4x \)&lt;/span&gt; ו-&lt;span&gt;\( b=1 \)&lt;/span&gt; ו-&lt;span&gt;\( r=\frac{1}{2} \)&lt;/span&gt;, אז נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sqrt{1-4x}=\left(-4x+1\right)^{\frac{1}{2}}=\sum_{k=0}^{\infty}{1/2 \choose k}\left(-4x\right)^{k}=\sum_{k=0}^{\infty}\left(-4\right)^{k}{1/2 \choose k}x^{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנוסחה הזו מאפשר חישוב פשוט של המקדמים של &lt;span&gt;\( x^{k} \)&lt;/span&gt; עבור הערכים הראשונים של &lt;span&gt;\( k \)&lt;/span&gt; (אני מציע לכם לנסות לחשב בעצמכם, גם אני “מרגיש” את הביטוי רק כשאני עושה את זה):&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( \left(-4\right)^{0}{1/2 \choose 0}=1\cdot1=1 \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left(-4\right)^{1}{1/2 \choose 1}=-4\cdot\frac{1}{2}=-2 \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left(-4\right)^{2}{1/2 \choose 2}=16\cdot\frac{1}{2}\cdot\frac{1}{2}\cdot\left(-\frac{1}{2}\right)=-2 \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left(-4\right)^{3}{1/2 \choose 3}=-64\cdot\frac{1}{2\cdot3}\cdot\frac{1}{2}\cdot\left(-\frac{1}{2}\right)\cdot\left(-\frac{3}{2}\right)=-4 \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;מכאן כבר יש לי מספיק אומץ לנסות לכתוב את הביטוי הכללי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(-4\right)^{n}{1/2 \choose n}=\left(-1\right)^{n}2^{n}\cdot2^{n}\cdot\frac{1}{2\cdot3\cdots n}\cdot\frac{1}{2}\cdot\left(-\frac{1}{2}\right)\cdot\left(-\frac{3}{2}\right)\cdots\left(-\frac{2n-3}{2}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =2^{n}\cdot\frac{3\cdot5\cdots\left(2n-3\right)}{2\cdot3\cdots n}=\frac{6\cdot10\cdots\left(4n-6\right)}{2\cdot3\cdots n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שנותן לנו, אם נציב ערכים קונקרטיים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sqrt{1-4x}=1-2x-2x^{2}-4x^{3}-10x^{4}-28x^{5}-84x^{6}-\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה כמובן מזכיר את סדרת מספרי קטלן, &lt;span&gt;\( 1,1,2,5,14,42,\ldots \)&lt;/span&gt;, ולא במקרה: הנוסחה שקיבלנו הייתה &lt;span&gt;\( C\left(x\right)=\frac{1-\sqrt{1-4x}}{2x} \)&lt;/span&gt;, כך שמספרי קטלן מתקבלים מ-&lt;span&gt;\( \sqrt{1-4x} \)&lt;/span&gt; באופן הבא:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;החליפו את ה-1 שבהתחלה ב-0, והסירו את סימני המינוס (זה החלק של &lt;span&gt;\( 1- \)&lt;/span&gt; השורש)&lt;/li&gt;


&lt;li&gt;הזיזו את הסדרה צעד אחד שמאלה כך שה-0 בהתחלה נעלם (זה החלק של החלוקה ב-&lt;span&gt;\( x \)&lt;/span&gt;)&lt;/li&gt;


&lt;li&gt;חלקו את אברי כל הסדרה ב-2 (זו החלוקה ב-2).&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;במילים אחרות - כן! הבינום המוכלל של ניוטון עובד ונותן לנו את מספרי קטלן! ככה &lt;strong&gt;בדיוק&lt;/strong&gt; אוילר גילה את הנוסחה הסגורה למספרי קטלן. לא על ידי תעלול קומבינטורי מרהיב כמו שהראיתי בפוסט הקודם, אלא על ידי “הא, מצאתי את הפונקציה היוצרת, עכשיו בוא ניקח את המתמטיקה הסטנדרטית שלנו ונפעיל אותה על הפונקציה כדי לקבל את סדרת המקדמים”.&lt;/p&gt;

&lt;p&gt;זה השלב שבו כולם מרוצים… חוץ ממני. כל הקטע הזה של הבינום המוכלל של ניוטון? זו התעסקות בטורי חזקות של חדו”א, לא בטורי חזקות פורמליים. זה לא אומר שזה לא תקין - אפשר בהחלט לומר שזו תוצאה שתקפה רק בתחום ההתכנסות של הטור, אבל זה מספיק כדי לקבל את סדרת המקדמים - אבל אני רוצה לראות כמה רחוק אפשר ללכת כשדבקים &lt;strong&gt;רק&lt;/strong&gt; בפורמליות, בלי חדו”א בכלל. עכשיו יש לנו מטרה הרבה יותר ברורה: אנחנו לא רוצים להבין “סתם” איך להתעסק במספרי קטלן פורמלית, אלא איך אפשר להוכיח את &lt;strong&gt;הבינום המוכלל של ניוטון&lt;/strong&gt; פורמלית.&lt;/p&gt;

&lt;h2&gt;הבינום הפורמלי המוכלל של ניוטון&lt;/h2&gt;

&lt;p&gt;נשמור על העניין פשוט ונסתכל על הבינום של ניוטון כשאחד המחוברים הוא 1. כלומר, על הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שיש לנו באגף ימין כאן הוא פונקציה יוצרת - הפונקציה היוצרת של הסדרה &lt;span&gt;\( a_{n}={r \choose n} \)&lt;/span&gt;. באגף שמאל יש לנו ביטוי שאין לו משמעות פורמלית - לא הגדרנו בשום שלב העלאה בחזקה כללית של פולינומים, או של טורי חזקות. אז אני יכול &lt;strong&gt;להגדיר&lt;/strong&gt; את המשמעות של אגף שמאל להיות מה שכתוב באגף ימין; השאלה המעניינת היא האם ההגדרה הזו תסכים עם מה שאנחנו מצפים שיהיה, כלומר אם עבור &lt;span&gt;\( r \)&lt;/span&gt; שהוא &lt;strong&gt;מספר טבעי&lt;/strong&gt; ההגדרה תתלכד עם ההגדרה הרגילה, ואם יישמרו חוקי החשבון הרגילים של חזקות, שהם מה שעומד מאחורי הרחבת הגדרת החזקה מטבעיים למספרים ממשיים באופן כללי. כלומר, האם יתקיים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{r}\cdot\left(1+x\right)^{s}=\left(1+x\right)^{r+s} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ו-&lt;span&gt;\( \left(\left(1+x\right)^{r}\right)^{s}=\left(1+x\right)^{rs} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אבל כבר כאן צצה בעיה: הביטוי &lt;span&gt;\( \left(\left(1+x\right)^{r}\right)^{s} \)&lt;/span&gt; הוא לא מוגדר היטב, כי הרי &lt;span&gt;\( \left(1+x\right)^{r} \)&lt;/span&gt; הוא כבר פונקציה יוצרת עם אינסוף מחוברים, ולא הגדרתי העלאה בחזקה &lt;strong&gt;שלה&lt;/strong&gt;, רק של הביטוי הפשוט &lt;span&gt;\( 1+x \)&lt;/span&gt;. אז אני צריך מראש ללכת על הגדרה כללית יותר. מה בדבר…&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+F\left(x\right)\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}F\left(x\right)^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; היא פונקציה יוצרת כלשהי? ובכן, זה &lt;strong&gt;כמעט&lt;/strong&gt; עובד, אבל בואו ננצל את ההזדמנות כדי להציג גם את הדבר הזה בהקשר טיפה יותר כללי: &lt;strong&gt;הרכבה&lt;/strong&gt; של פונקציות יוצרות.&lt;/p&gt;

&lt;p&gt;אז נניח שיש לנו שתי פונקציות יוצרות&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b\left(x\right)=\sum_{n=0}^{\infty}b_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואנחנו רוצים להגדיר את ההרכבה, &lt;span&gt;\( a\left(b\left(x\right)\right) \)&lt;/span&gt;. אם הפונקציות היוצרות היו פונקציות אמיתיות ולא סתם חבלי כביסה, מה שהיה מתקיים (כשרדיוס ההתכנסות היה מתיר את זה) הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(b\left(x\right)\right)=\sum_{n=0}^{\infty}a_{n}b\left(x\right)^{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הדבר הזה הוא לא ביטוי מפורש. כלומר, זה לא שבהרכבה, המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; יהיה &lt;span&gt;\( a_{n}b\left(x\right)^{n} \)&lt;/span&gt;. מה שקורה הוא שצריך לקחת את הטור האינסופי &lt;span&gt;\( b\left(x\right) \)&lt;/span&gt;, לכפול אותו בעצמו &lt;span&gt;\( n \)&lt;/span&gt; פעמים (את זה אנחנו יודעים לעשות), לכפול את התוצאה במקדם המספרי &lt;span&gt;\( a_{n} \)&lt;/span&gt; ואז להוסיף את זה לטור הכולל שאנחנו בונים. בצורה הזו לאותו &lt;span&gt;\( x^{n} \)&lt;/span&gt; יכולות לתרום חזקות רבות ושונות מהצורה &lt;span&gt;\( b\left(x\right)^{k} \)&lt;/span&gt;. למעשה, קיימת הסכנה שלאותו &lt;span&gt;\( x^{n} \)&lt;/span&gt; יהיו &lt;strong&gt;אינסוף&lt;/strong&gt; חזקות שתורמות מחוברים. זה קורה אם ורק אם &lt;span&gt;\( b_{n}\ne0 \)&lt;/span&gt;. כי למשל, בואו נסתכל על המקרה הפשוט שבו &lt;span&gt;\( b\left(x\right)=1+x \)&lt;/span&gt;, אז מהן החזקות?&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{0}=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{1}=1+x \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{2}=1+2x+x^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+x\right)^{3}=1+3x+3x^{2}+x^{3} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכן הלאה - אנחנו רואים שכל חזקה החל מ-2 תתרום ל-&lt;span&gt;\( x^{1} \)&lt;/span&gt;, למשל. למה? כי מה זה בעצם &lt;span&gt;\( \left(1+x\right)^{3} \)&lt;/span&gt;? זו המכפלה &lt;span&gt;\( \left(1+x\right)\left(1+x\right)\left(1+x\right) \)&lt;/span&gt;. בכל פעם אנחנו בוחרים אחד משני האיברים שבתוך זוג סוגריים ספציפי ומוסיפים אותו למכפלה שלנו. אם בכל פעם היינו חייבים לבחור איבר שהוא לפחות &lt;span&gt;\( x \)&lt;/span&gt;, אז כל זוג סוגריים שמשתתף במכפלה היה מגדיל ב-1 לפחות את החזקה של &lt;span&gt;\( x \)&lt;/span&gt; בתוצאה הסופית. אבל אם 1 נמצא בסוגריים, אז אפשר לבחור אותו ולא להגדיל את החזקה של &lt;span&gt;\( x \)&lt;/span&gt; בתוצאה הסופית. זה היה מבטיח שעבור חזקות מסוימות של &lt;span&gt;\( x \)&lt;/span&gt;, אפשר יהיה תמיד לייצר אותן החל ממקום מסוים - לכן המקדם שלהם יהיה אינסופי, וזה לא מוגדר היטב.&lt;/p&gt;

&lt;p&gt;אפשר לחזור עכשיו אל ההעלאה בחזקה. במקרה הזה, יש לנו את הפונקציה היוצרת&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\left(1+x\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, &lt;span&gt;\( a_{n}={r \choose n} \)&lt;/span&gt;, אז אני יכול להציב בה את &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; לכל &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; שמקיים &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt;. למשל, עבור &lt;span&gt;\( \sqrt{1-4x} \)&lt;/span&gt; הצבתי את &lt;span&gt;\( F\left(x\right)=-4x \)&lt;/span&gt;, שבהחלט מקיימת את זה. ומה עם תכונות החזקה שאנחנו רוצים להוכיח?&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+F\left(x\right)\right)^{r}\cdot\left(1+F\left(x\right)\right)^{s}=\left(1+F\left(x\right)\right)^{r+s} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ו-&lt;span&gt;\( \left(\left(1+F\left(x\right)\right)^{r}\right)^{s}=\left(1+F\left(x\right)\right)^{rs} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כדי שזה יהיה מוגדר היטב, &lt;span&gt;\( \left(1+F\left(x\right)\right)^{r} \)&lt;/span&gt; צריך להיות מהצורה &lt;span&gt;\( 1+G\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( G_{0}=0 \)&lt;/span&gt;. את זה אפשר לראות ממש מההגדרה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+F\left(x\right)\right)^{r}=\sum_{n=0}^{\infty}{r \choose n}F\left(x\right)^{n}=1+\sum_{n=1}^{\infty}{r \choose n}F\left(x\right)^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו נגדיר &lt;span&gt;\( G\left(x\right)=\sum_{n=1}^{\infty}{r \choose n}F\left(x\right)^{n} \)&lt;/span&gt; ונשתמש בכך ש-&lt;span&gt;\( F_{0}=0 \)&lt;/span&gt; בעצמו ולכן כל העלאה בחזקה של &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; כוללת רק חזקות של &lt;span&gt;\( x \)&lt;/span&gt; החל מ-&lt;span&gt;\( x^{1} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו אפשר לעבור לעבודה הטכנית עצמה של להוכיח ש-&lt;span&gt;\( \left(1+x\right)^{r}\cdot\left(1+x\right)^{s}=\left(1+x\right)^{r+s}=\sum_{n=0}^{\infty}{r+s \choose n}x^{n} \)&lt;/span&gt;. יש לנו כאן כפל של שני טורי חזקות, ואנחנו יודעים בדיוק איך זה עובד. נגדיר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)=\sum_{n=0}^{\infty}{r \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b\left(x\right)=\sum_{n=0}^{\infty}{s \choose n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{n}={r \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{n}={s \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכעת&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a\left(x\right)b\left(x\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{k}b_{n-k}=\sum_{k=0}^{n}{r \choose k}{s \choose n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שאנחנו &lt;strong&gt;מצפים&lt;/strong&gt; לקבל הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=0}^{n}{r \choose k}{s \choose n-k}={r+s \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם יש לנו את זה - סיימנו את ההוכחה. למרבה המזל, זה שוויון מפורסם מאוד, שאפילו יש לו שם משלו: שוויון צ’ו-ונדרמונדה. עוד יותר למרבה המזל, זה שוויון שקל מאוד להוכיח &lt;strong&gt;קומבינטורית&lt;/strong&gt;, כלומר יש לנו אחלה אינטואיציה למה הוא נכון… אבל רק אם &lt;span&gt;\( s,r \)&lt;/span&gt; הם מספרים טבעיים. במקרה הזה, אפשר לחשוב על כך שיש לנו קבוצה של &lt;span&gt;\( r \)&lt;/span&gt; חתולים ו-&lt;span&gt;\( s \)&lt;/span&gt; כלבים ואנחנו רוצים להרכיב צוות מרגלים שכולל בדיוק &lt;span&gt;\( n \)&lt;/span&gt; חברים - זו בעיה של &lt;strong&gt;בחירה בלי חשיבות לסדר ובלי חזרות&lt;/strong&gt;, ומכיוון שקבוצת המרגלים הפוטנציאליים הכוללת היא מגודל &lt;span&gt;\( r+s \)&lt;/span&gt; יש לנו בסך הכל &lt;span&gt;\( {r+s \choose n} \)&lt;/span&gt; אפשרויות. אבל היה אפשר גם לסרבל את זה טיפה: אם היינו מחליטים לקחת לקבוצה שלנו &lt;strong&gt;בדיוק&lt;/strong&gt; &lt;span&gt;\( k \)&lt;/span&gt; חתולים, אז היו לנו &lt;span&gt;\( {r \choose k} \)&lt;/span&gt; אפשרויות לבחור את החתולים, ואחר כך היינו צריכים לבחור עוד &lt;span&gt;\( n-k \)&lt;/span&gt; כלבים, ולזה יש &lt;span&gt;\( {s \choose n-k} \)&lt;/span&gt; אפשרויות, ולכן מעקרון הכפל יש לנו &lt;span&gt;\( {r \choose k}{s \choose n-k} \)&lt;/span&gt; אפשרויות להרכיב צוות שכולל בדיוק &lt;span&gt;\( k \)&lt;/span&gt; חתולים. את הסיפור הזה יכלנו לעשות לכל &lt;span&gt;\( k \)&lt;/span&gt; בין 0 ל-&lt;span&gt;\( n \)&lt;/span&gt;, ועקרון החיבור אומר שמספר האפשרויות הכולל, אם כך, הוא &lt;span&gt;\( \sum_{k=0}^{n}{r \choose k}{s \choose n-k} \)&lt;/span&gt;. זה מסיים את ההוכחה הקומבינטורית.&lt;/p&gt;

&lt;p&gt;השאלה היא מה עושים עכשיו, כשרוצים להוכיח את השוויון ל-&lt;span&gt;\( r,s \)&lt;/span&gt; שהם מספרים ממשיים כלליים. לא ברור איך הגיון קומבינטורי יעזור לנו כאן, אבל למרבה המזל גם לא צריך אותו - אפשר להסתמך על מה שכבר הוכחנו. בשביל זה בואו נדבר לרגע על &lt;strong&gt;פולינומים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;נניח ש-&lt;span&gt;\( p\left(x\right),q\left(x\right) \)&lt;/span&gt; הם שני פולינומים. אנחנו יודעים שפולינום ממעלה &lt;span&gt;\( d \)&lt;/span&gt; נקבע בצורה יחידה על ידי הערכים שלו ב-&lt;span&gt;\( d+1 \)&lt;/span&gt; נקודות, ולכן פולינום ממעלה &lt;span&gt;\( d \)&lt;/span&gt; שמתאפס ב-&lt;span&gt;\( d+1 \)&lt;/span&gt; נקודות הוא זהותית פולינום האפס. עכשיו, אם אנחנו יודעים ש-&lt;span&gt;\( p\left(n\right)=q\left(n\right) \)&lt;/span&gt; &lt;strong&gt;לכל&lt;/strong&gt; &lt;span&gt;\( n\in\mathbb{N} \)&lt;/span&gt;, אז אנחנו יודעים שהפולינום &lt;span&gt;\( p-q \)&lt;/span&gt; מתאפס על &lt;strong&gt;אינסוף&lt;/strong&gt; נקודות, ובפרט על מספר נקודות שגדול מהדרגה שלו, ולכן הוא זהותית אפס: &lt;span&gt;\( p-q=0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( p=q \)&lt;/span&gt; - &lt;strong&gt;פולינומים שמזדהים על אינסוף נקודות הם זהים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו בואו נסבך את זה ונהפוך את הפולינומים לבעלי שני משתנים: &lt;span&gt;\( p\left(x,y\right),q\left(x,y\right) \)&lt;/span&gt;. כאן צריך להיזהר: אם למשל &lt;span&gt;\( p\left(x,y\right)=x \)&lt;/span&gt; ו-&lt;span&gt;\( q\left(x,y\right)=y \)&lt;/span&gt; אז נקבל ש-&lt;span&gt;\( p\left(n,n\right)=q\left(n,n\right) \)&lt;/span&gt; עבור אינסוף ערכי &lt;span&gt;\( n\in\mathbb{N} \)&lt;/span&gt; אבל זה כמובן לא אומר שהפולינומים הללו זהים. הטיעון צריך להיות קצת יותר עדין. באופן כללי, אם יש שתי קבוצות אינסופיות &lt;span&gt;\( A,B \)&lt;/span&gt; כך ש-&lt;span&gt;\( p\left(a,b\right)=0 \)&lt;/span&gt; לכל &lt;span&gt;\( a\in A,b\in B \)&lt;/span&gt;, אז &lt;span&gt;\( p \)&lt;/span&gt; הוא פולינום האפס (כלומר, הפואנטה היא ש-&lt;span&gt;\( p \)&lt;/span&gt; מתאפס על כל &lt;span&gt;\( A\times B \)&lt;/span&gt;, לא רק על איזו תת-קבוצה נחמדה של &lt;span&gt;\( A\times B \)&lt;/span&gt;). בואו נוכיח את זה: באופן כללי, &lt;span&gt;\( p\left(x,y\right)=\sum_{i,j}a_{ij}x^{i}y^{j} \)&lt;/span&gt;. אפשר לסדר את הסכום הזה לפי חזקות של &lt;span&gt;\( y \)&lt;/span&gt;, כלומר לכתוב &lt;span&gt;\( p\left(x,y\right)=\sum_{j}\left(\sum_{i}a_{ij}x^{i}\right)y^{j} \)&lt;/span&gt;, ולסמן &lt;span&gt;\( p_{j}\left(x\right)=\sum_{i}a_{ij}x^{i} \)&lt;/span&gt;. עכשיו, אם כל ה-&lt;span&gt;\( p_{j}\left(x\right) \)&lt;/span&gt; הללו הם פולינומי האפס, סיימנו; מקבלים ש-&lt;span&gt;\( p\left(x,y\right)=\sum_{j}p_{j}\left(x\right)y^{j}=\sum_{j}0\cdot y=0 \)&lt;/span&gt;. אז בואו נניח בשלילה שעבור &lt;span&gt;\( j \)&lt;/span&gt; כלשהו, &lt;span&gt;\( p_{j}\left(x\right) \)&lt;/span&gt; הוא &lt;strong&gt;לא&lt;/strong&gt; פולינום האפס. בפרט, קיים ערך קונקרטי, &lt;span&gt;\( a\in A \)&lt;/span&gt;, כך ש-&lt;span&gt;\( p_{j}\left(a\right)\ne0 \)&lt;/span&gt; - כי אם לכל &lt;span&gt;\( a\in A \)&lt;/span&gt; היינו מקבלים &lt;span&gt;\( p_{j}\left(x\right)=0 \)&lt;/span&gt; אז היינו מקבלים פולינום שמתאפס על אינסוף ערכים ולכן הוא זהותית 0. אם כן, &lt;span&gt;\( p_{j}\left(a\right)\ne0 \)&lt;/span&gt; ולכן אם נסתכל על הפולינום &lt;span&gt;\( q\left(y\right)=p\left(a,y\right) \)&lt;/span&gt; אנחנו רואים שמצד אחד, &lt;span&gt;\( q\left(y\right)=\sum_{j}p_{j}\left(a\right)y^{j} \)&lt;/span&gt; הוא לא פולינום האפס כי &lt;strong&gt;לכל הפחות&lt;/strong&gt; המקדם של &lt;span&gt;\( y^{j} \)&lt;/span&gt; הוא לא אפס. מצד שני - אנחנו יודעים שלכל אינסוף הערכים &lt;span&gt;\( b\in B \)&lt;/span&gt; מתקיים &lt;span&gt;\( q\left(b\right)=p\left(a,b\right)=0 \)&lt;/span&gt; ולכן זה כן פולינום האפס - סתירה. לב העניין הוא בדיוק בשלב האחרון: ש&lt;strong&gt;לכל&lt;/strong&gt; &lt;span&gt;\( b\in B \)&lt;/span&gt; מקבלים &lt;span&gt;\( p\left(a,b\right)=0 \)&lt;/span&gt;, באופן שלא תלוי בזהות של &lt;span&gt;\( a \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;המסקנה מכל זה היא שאם יש לנו זוג פולינומים בשני משתנים &lt;span&gt;\( p\left(x,y\right),q\left(x,y\right) \)&lt;/span&gt; כך ש&lt;strong&gt;לכל זוג מספרים טבעיים&lt;/strong&gt; &lt;span&gt;\( r,s \)&lt;/span&gt; מתקיים &lt;span&gt;\( p\left(r,s\right)=q\left(r,s\right) \)&lt;/span&gt; אז הפולינום הם זהים, לכל זוג ערכים, כולל ערכים ממשיים (או אפילו מרוכבים). עכשיו נסתכל על הביטוי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=0}^{n}{r \choose k}{s \choose n-k}={r+s \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לב העניין הוא שבאופן כללי, &lt;span&gt;\( {x \choose n}=\frac{x\left(x-1\right)\left(x-2\right)\ldots\left(x-n+1\right)}{n!} \)&lt;/span&gt; הוא פולינום ב-&lt;span&gt;\( x \)&lt;/span&gt;: המונה הוא הרי מכפלה של &lt;span&gt;\( n \)&lt;/span&gt; פולינומים ב-&lt;span&gt;\( x \)&lt;/span&gt;, אז גם הוא פולינום. לכן גם &lt;span&gt;\( \sum_{k=0}^{n}{x \choose k}{y \choose n-k}={x+y \choose n} \)&lt;/span&gt; הוא שוויון של פולינומים - ושוויון שמתקיים לכל הצבה של &lt;span&gt;\( r,s \)&lt;/span&gt; טבעיים ב-&lt;span&gt;\( x,y \)&lt;/span&gt;. זה מוכיח את השוויון לכל &lt;span&gt;\( r,s \)&lt;/span&gt; ממשיים, ולכן מסיים את ההוכחה &lt;strong&gt;הפורמלית&lt;/strong&gt; לכך ש-&lt;span&gt;\( \left(1+x\right)^{r}\cdot\left(1+x\right)^{s}=\left(1+x\right)^{r+s} \)&lt;/span&gt;, וכמסקנה אנחנו מקבלים ש-&lt;span&gt;\( \left(1+F\left(x\right)\right)^{r}\cdot\left(1+F\left(x\right)\right)^{s}=\left(1+F\left(x\right)\right)^{r+s} \)&lt;/span&gt; לכל &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; עם &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;זה מקדם אותנו בצורה משמעותית לתפיסה האינטואיטיבית של &lt;span&gt;\( \left(1+x\right)^{r} \)&lt;/span&gt; בתור פעולת החזקה. כדי לראות את זה, בואו נוותר לרגע על שיטת הסימון שבה אנחנו משתמשים ובמקום זה נכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),r\right)=\sum_{n=0}^{\infty}{r \choose n}F\left(x\right)^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, בינתיים פשוט הגדרנו דרך לבנות פונקציה יוצרת חדשה מתוך &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt;. מה לזה ולפעולת ההעלאה בחזקה? ובכן, ראשית נשים לב לכך שעל פי הגדרה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),1\right)=\sum_{n=0}^{\infty}{1 \choose n}F\left(x\right)^{n}=F\left(x\right)^{0}+F\left(x\right)^{1}=1+F\left(x\right)=\left(1+F\left(x\right)\right)^{1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, &lt;span&gt;\( \Phi\left(1+F\left(x\right),1\right) \)&lt;/span&gt; מתלכד עם מה שאנחנו מכירים בתור &lt;span&gt;\( \left(1+F\left(x\right)\right)^{1} \)&lt;/span&gt;. שימו לב שאת הביטוי &lt;span&gt;\( \left(1+F\left(x\right)\right)^{1} \)&lt;/span&gt; אנחנו מכירים לא בתור “פונקציה יוצרת שהוגדרה מוזר” אלא זו חזקה במשמעות הרגילה שלה בחוגים - כפל של האיבר בעצמו שוב ושוב (פעם אחת, במקרה הזה).&lt;/p&gt;

&lt;p&gt;טוב ויפה, אבל כזכור עבדנו קשה כדי להוכיח את התכונה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),r+s\right)=\Phi\left(1+F\left(x\right),r\right)\Phi\left(1+F\left(x\right),s\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן עכשיו אפשר להראות באינדוקציה שלכל &lt;span&gt;\( n \)&lt;/span&gt; טבעי,&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),n+1\right)=\Phi\left(1+F\left(x\right),n\right)\Phi\left(1+F\left(x\right),1\right)= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\left(1+F\left(x\right)\right)^{n}\left(1+F\left(x\right)\right)^{1}=\left(1+F\left(x\right)\right)^{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר גם כאן - החזקה היא במשמעות המקורית והרגילה שלה בחוג, אז הפונקציה &lt;span&gt;\( \Phi \)&lt;/span&gt; &lt;strong&gt;מתלכדת&lt;/strong&gt; עם המשמעות הרגילה בחוג. כדי להשתכנע שהיא מרחיבה אותה בצורה נכונה, בואו נסתכל למשל על&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),1\right)=\Phi\left(1+F\left(x\right),\frac{1}{2}+\frac{1}{2}\right)=\Phi\left(1+F\left(x\right),\frac{1}{2}\right)^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, &lt;span&gt;\( G\left(x\right)=\Phi\left(1+F\left(x\right),\frac{1}{2}\right) \)&lt;/span&gt; הוא מצד אחד טור חזקות פורמלי מוגדר היטב, שלא נזקקנו לחשבון דיפרנציאלי כדי להגדיר; ומצד שני הוא מקיים &lt;span&gt;\( G\left(x\right)^{2}=1+F\left(x\right) \)&lt;/span&gt; וכמו כן קל לראות ש-&lt;span&gt;\( G_{0}=1 \)&lt;/span&gt; ולכן, בסימון שלנו בתחילת הפוסט, &lt;span&gt;\( G\left(x\right)=\sqrt{1+F\left(x\right)} \)&lt;/span&gt;, וזה תואם את המשמעות האינטואיטיבית שיש לנו למה העלאה בחזקת &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; אמורה להיות.&lt;/p&gt;

&lt;p&gt;זה עובד גם עבור אפס ועבור מספרים שליליים. אפשר לבדוק ישירות על פי ההגדרה ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),0\right)=\sum_{n=0}^{\infty}{0 \choose n}F\left(x\right)^{n}=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שמתאים להעלאה “רגילה” בחזקת 0, ועכשיו עבור שליליים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1=\Phi\left(1+F\left(x\right),0\right)=\Phi\left(1+F\left(x\right),n-n\right)= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\Phi\left(1+F\left(x\right),n\right)\Phi\left(1+F\left(x\right),-n\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר קיבלנו ש-&lt;span&gt;\( \Phi\left(1+F\left(x\right),-n\right)=\frac{1}{\Phi\left(1+F\left(x\right),n\right)} \)&lt;/span&gt;. הצעד האחרון דורש כזכור שהאיבר החופשי של &lt;span&gt;\( \Phi\left(1+F\left(x\right),n\right) \)&lt;/span&gt; לא יהיה 0, ואנחנו כבר יודעים שהוא 1, אז הכל בסדר.&lt;/p&gt;

&lt;p&gt;זה נחמד כי זה מחזיר אותנו לתחילת הפוסט, שבו הוכחנו בדרך די ישירה ש-&lt;span&gt;\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)&lt;/span&gt;. עכשיו זה אמור לנבוע מההגדרה הכללית יותר שלנו. נסמן &lt;span&gt;\( F\left(x\right)=x+x^{2}+\ldots \)&lt;/span&gt; ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \Phi\left(1+F\left(x\right),-1\right)=\sum_{n=0}^{\infty}{-1 \choose n}F\left(x\right)^{n}=\frac{1}{0!}F\left(x\right)^{0}+\frac{\left(-1\right)}{1!}F\left(x\right)^{1}+\frac{\left(-1\right)\left(-2\right)}{2!}F\left(x\right)^{2}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;באופן כללי, האיבר ה-&lt;span&gt;\( n \)&lt;/span&gt;-י בסכום יהיה &lt;span&gt;\( \frac{\left(-1\right)\left(-2\right)\cdots\left(-n\right)}{n!}=\frac{\left(-1\right)^{n}n!}{n!}=\left(-1\right)^{n} \)&lt;/span&gt;, כלומר אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1-F\left(x\right)+F\left(x\right)^{2}-F\left(x\right)^{3}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בכמה דרכים &lt;span&gt;\( x^{n} \)&lt;/span&gt;, עבור &lt;span&gt;\( n\ge2 \)&lt;/span&gt;, יכול להתקבל כאן? אם נסתכל על &lt;span&gt;\( F\left(x\right)^{k} \)&lt;/span&gt;, הוא כולל &lt;span&gt;\( k \)&lt;/span&gt; זוגות סוגריים שמכל אחד מהם בוחרים חזקה של &lt;span&gt;\( x \)&lt;/span&gt; כך שהחזקות מסתכמות אל &lt;span&gt;\( n \)&lt;/span&gt; - זה כמו לספור כמה פתרונות יש למשוואה &lt;span&gt;\( a_{1}+\ldots+a_{k}=n \)&lt;/span&gt;. מה שכן, שימו לב שהסוגריים לא כוללים את &lt;span&gt;\( x^{0} \)&lt;/span&gt; אז הפתרונות הם &lt;strong&gt;בטבעיים חיוביים&lt;/strong&gt;. זו בעיה קלה, קומבינטורית: זה כמו לשאול כמה פתרונות בשלמים אי-שליליים יש ל-&lt;span&gt;\( a_{1}+\ldots+a_{k}=n-k \)&lt;/span&gt; וזו בדיוק בחירה בלי חשיבות לסדר ועם חזרות של &lt;span&gt;\( n-k \)&lt;/span&gt; פעמים מתוך &lt;span&gt;\( k \)&lt;/span&gt; איברים - הפתרון הוא &lt;span&gt;\( {\left(n-k\right)+k-1 \choose k-1}={n-1 \choose k-1} \)&lt;/span&gt;. עכשיו, זה נתן לנו את המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; באיבר &lt;span&gt;\( F\left(x\right)^{k} \)&lt;/span&gt;, אבל כדי לקבל את המקדם הכולל של &lt;span&gt;\( x^{n} \)&lt;/span&gt; צריך לחבר את המקדמים שמקבלים לכל &lt;span&gt;\( k \)&lt;/span&gt; וגם לקחת בחשבון את סימן המינוס שיש על איברים שבהם &lt;span&gt;\( k \)&lt;/span&gt; אי זוגי. כלומר נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=1}^{n}\left(-1\right)^{k}{n-1 \choose k-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במקרה הזה קל לטפל בעזרת &lt;strong&gt;הבינום של ניוטון&lt;/strong&gt;. נשנה את משתנה הסכימה באותה דרך שבה עשינו את זה קודם עבור פיבונאצ’י:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=1}^{n}\left(-1\right)^{k}{n-1 \choose k-1}=-\sum_{k=0}^{n-1}\left(-1\right)^{k}{n-1 \choose k}=-\left(1-1\right)^{n-1}=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המקרים החריגים היחידים הם &lt;span&gt;\( n=0,1 \)&lt;/span&gt;. עבור &lt;span&gt;\( n=0 \)&lt;/span&gt; בכלל אי אפשר להשתמש בנוסחה הזו, אבל אם חושבים רגע רואים שהיא אמורה לתת 0 כאן - וזה נכון, כי &lt;span&gt;\( x^{0} \)&lt;/span&gt; בכלל לא מופיע ב-&lt;span&gt;\( -F\left(x\right)+F\left(x\right)^{2}-F\left(x\right)^{3}+\ldots \)&lt;/span&gt;, הוא מופיע רק ב-1 בהתחלה. כמו כן עבור &lt;span&gt;\( n=1 \)&lt;/span&gt; יש לנו סיטואציה חריגה של &lt;span&gt;\( 0^{0} \)&lt;/span&gt; וזו מהסיטואציות שבהן הדבר הנכון לעשות הוא להגדיר &lt;span&gt;\( 0^{0}=1 \)&lt;/span&gt; (&lt;a href=&quot;https://gadial.net/2018/01/01/zero_power_equals_one/&quot;&gt;יש לי פוסט על זה&lt;/a&gt;), ובואו לא נשכח את המינוס הזה שהשתרבב החוצה, כלומר מקבלים &lt;span&gt;\( -1 \)&lt;/span&gt; במקרה הזה, ולכן &lt;span&gt;\( 1-F\left(x\right)+F\left(x\right)^{2}-F\left(x\right)^{3}+\ldots=1-x \)&lt;/span&gt; וזה - הפלא ופלא, זה בדיוק מה שציפינו לקבל, כי אנחנו כבר יודעים ש-&lt;span&gt;\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)&lt;/span&gt; אז כמובן ש-&lt;span&gt;\( \left(1+x+x^{2}+\ldots\right)^{-1}=1-x \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אוקיי, אז אני מקווה שהשתכנענו שהצלחנו להגדיר את &lt;span&gt;\( \left(1+F\left(x\right)\right)^{r} \)&lt;/span&gt; לכל &lt;span&gt;\( r \)&lt;/span&gt; &lt;strong&gt;רציונלי&lt;/strong&gt;. איך נגדיר אותו לכל ממשי? ובכן, כאן אנחנו בבעיה וחייבים לדבר על מושגים מחדו”א פשוט כי &lt;strong&gt;מספר ממשי&lt;/strong&gt; הוא מושג מחדו”א. הייתה לי &lt;a href=&quot;https://gadial.net/2024/08/11/real_numbers_decimal_notation/&quot;&gt;סדרת פוסטים&lt;/a&gt; על זה לא מזמן. בגדול, דרך נוחה לחשוב על מספרים ממשיים הם בתור אובייקטים שלכל אחד מהם, אנחנו יכולים לקחת סדרת רציונליים ששואפת אליו. זה מוביל להגדרה “הרגילה” של חזקה שהיא מספר ממשי כללי: בהינתן &lt;span&gt;\( r \)&lt;/span&gt;, לוקחים סדרה &lt;span&gt;\( q_{n} \)&lt;/span&gt; של רציונליים כך ש-&lt;span&gt;\( q_{n}\to r \)&lt;/span&gt;, ואז מגדירים &lt;span&gt;\( x^{r}=\lim_{n\to\infty}x^{q_{n}} \)&lt;/span&gt; וצריך לשבור את הראש כדי להוכיח שזה מוגדר היטב. אבל איך אפשר לעשות משהו דומה עם טורי חזקות פורמליים? אין לנו מושג של התכנסות על טורי חזקות, נכון? נכון…?&lt;/p&gt;

&lt;h2&gt;החפירה העמוקה ביותר (שנגיע אליה כאן)&lt;/h2&gt;

&lt;p&gt;אז כן, יש לנו מושג של התכנסות על טורי חזקות, הוא לא מסובך במיוחד, והוא כנראה יאפשר את הראייה הצלולה ביותר של מה שעשינו כאן ולאן אפשר להתקדם מפה.&lt;/p&gt;

&lt;p&gt;בגדול, הרעיון הוא שאם יש לנו סדרה &lt;span&gt;\( F^{1}\left(x\right),F^{2}\left(x\right),F^{3}\left(x\right),\ldots \)&lt;/span&gt; ואנחנו רוצים לדעת אם היא מתכנסת לאנשהו, נסתכל על המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; עבור כל הסדרות הללו. אם &lt;strong&gt;החל ממקום מסוים&lt;/strong&gt; המקדם הזה קבוע, ואם זה קורה &lt;strong&gt;לכל&lt;/strong&gt; &lt;span&gt;\( n \)&lt;/span&gt;, אז לסדרה יש גבול שהוא הפונקציה היוצרת שבנויה מהמקדמים הללו. קצת יותר פורמלית: אם לכל &lt;span&gt;\( n \)&lt;/span&gt; קיימים &lt;span&gt;\( a_{n}\in\mathbb{R} \)&lt;/span&gt; ו-&lt;span&gt;\( k_{n} \)&lt;/span&gt; כך שלכל &lt;span&gt;\( i\ge k_{N} \)&lt;/span&gt; מתקיים ש-&lt;span&gt;\( F_{n}^{i}=a_{n} \)&lt;/span&gt; (כאן &lt;span&gt;\( F_{n}^{i} \)&lt;/span&gt; פירושו המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; בטור החזקות &lt;span&gt;\( F^{i}\left(x\right) \)&lt;/span&gt;) אז &lt;span&gt;\( \lim_{i\to\infty}F^{i}\left(x\right)=F\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( F\left(x\right)=\sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אבל אפשר לעשות את זה עוד יותר מסודר. מי שמכירות את הבניה האנליטית של המספרים ה-&lt;span&gt;\( p \)&lt;/span&gt;-אדיים (&lt;a href=&quot;https://gadial.net/2010/01/12/padic_numbers_analytic_constructions/&quot;&gt;הצגתי אותה כאן&lt;/a&gt;) כנראה ירגישו בבית.&lt;/p&gt;

&lt;p&gt;ראשית, לכל טור חזקות פורמלי &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; ששונה מאפס, נגדיר &lt;span&gt;\( \nu\left(F\left(x\right)\right)=\min_{F_{n}\ne0}n \)&lt;/span&gt;, כלומר האינדקס של המקדם הראשון בטור ששונה מאפס. בנוסף נגדיר &lt;span&gt;\( \nu\left(0\right)=\infty \)&lt;/span&gt; כדי שהכל יסתדר יפה. עכשיו אפשר להגדיר &lt;strong&gt;מטריקה&lt;/strong&gt; על חוג טורי החזקות הפורמליים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( d\left(F,G\right)=2^{-\nu\left(F-G\right)} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, ככל שהאינדקס הראשון שבו &lt;span&gt;\( F,G \)&lt;/span&gt; נבדלים זה מזה הוא גבוה יותר, כך ה”מרחק” שלהם יהיה קטן יותר. אם הם נבדלים כבר באינדקס ה-0 המרחק שלהם יהיה 1, ואם הם נבדלים לראשונה באינדקס ה-3 אז המרחק שלהם יהיה &lt;span&gt;\( \frac{1}{8} \)&lt;/span&gt; וכן הלאה.&lt;/p&gt;

&lt;p&gt;מה שקורה כאן הוא שראשית כל, אם &lt;span&gt;\( F=G \)&lt;/span&gt; אז &lt;span&gt;\( F-G=0 \)&lt;/span&gt; ולכן &lt;span&gt;\( d\left(F,G\right)=2^{-\nu\left(F-G\right)}=2^{-\nu\left(0\right)}=2^{-\infty}=0 \)&lt;/span&gt; (מי שמפריע לו השימוש הזה באינסוף - אוקיי, בסדר, פשוט נגדיר &lt;span&gt;\( d\left(F,G\right)=0 \)&lt;/span&gt; כאשר &lt;span&gt;\( F=G \)&lt;/span&gt; וחסל, מרוצים?).&lt;/p&gt;

&lt;p&gt;שנית, &lt;span&gt;\( d\left(F,G\right)=2^{-\nu\left(F-G\right)}=2^{-\nu\left(G-F\right)}=d\left(G,F\right) \)&lt;/span&gt;; זה עובד כי המקדם הראשון ששונה מאפס ב-&lt;span&gt;\( F-G \)&lt;/span&gt; הוא אותו מקדם כמו ב-&lt;span&gt;\( G-F \)&lt;/span&gt;, פשוט עם סימן הפוך.&lt;/p&gt;

&lt;p&gt;לבסוף, אם &lt;span&gt;\( F,G,H \)&lt;/span&gt; הם שלושה טורים, אז ראשית בואו נסמן ב-&lt;span&gt;\( n \)&lt;/span&gt; את האינדקס הראשון שבו &lt;span&gt;\( F,H \)&lt;/span&gt; נבדלים (אם הם זהים התוצאה שאגיע אליה עוד מעט נובעת עוד יותר בקלות), כלומר &lt;span&gt;\( d\left(F,H\right)=2^{-n} \)&lt;/span&gt;. בואו נסמן ב-&lt;span&gt;\( m_{1} \)&lt;/span&gt; את האינדקס הראשון שבו &lt;span&gt;\( F,G \)&lt;/span&gt; נבדלים וב-&lt;span&gt;\( m_{2} \)&lt;/span&gt; את האינדקס הראשון שבו &lt;span&gt;\( G,H \)&lt;/span&gt; נבדלים (ייתכן ש-&lt;span&gt;\( m_{1},m_{2}=\infty \)&lt;/span&gt;). אני טוען ש-&lt;span&gt;\( n\ge\min\left\{ m_{1},m_{2}\right\}  \)&lt;/span&gt;. למה? ובכן, אם &lt;span&gt;\( G \)&lt;/span&gt; נבדל מ-&lt;span&gt;\( F,H \)&lt;/span&gt; בשלב שבו הם עדיין זהים, זה אומר ש-&lt;span&gt;\( m_{1}=m_{2} \)&lt;/span&gt; (כי הוא ייבדל משניהם בו זמנית שהרי הם זהים עדיין בשלב הזה) ומכיוון שזה לפני שהם נבדלים, האינדקס הזה בא לפני &lt;span&gt;\( n \)&lt;/span&gt;, כלומר במקרה הזה &lt;span&gt;\( m_{1},m_{2}&amp;lt;n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, באינדקס ה-&lt;span&gt;\( n \)&lt;/span&gt; מתקיים &lt;span&gt;\( F_{n}\ne H_{n} \)&lt;/span&gt; ולכן &lt;strong&gt;פשוט לא ייתכן&lt;/strong&gt; ש-&lt;span&gt;\( G_{n}=F_{n} \)&lt;/span&gt; וגם &lt;span&gt;\( G_{n}=H_{n} \)&lt;/span&gt;, כי שוויון כזה היה מכריח את &lt;span&gt;\( F_{n}=H_{n} \)&lt;/span&gt;. לכן זה השלב שבו &lt;strong&gt;בודאות&lt;/strong&gt; &lt;span&gt;\( G \)&lt;/span&gt; הולך להיבדל מ-&lt;span&gt;\( F \)&lt;/span&gt; או מ-&lt;span&gt;\( H \)&lt;/span&gt;. אנחנו לא יודעים מי מהם, לכן אנחנו לוקחים את המינימום על &lt;span&gt;\( \left\{ m_{1},m_{2}\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה המסקנה? &lt;span&gt;\( n\ge\min\left\{ m_{1},m_{2}\right\}  \)&lt;/span&gt; גורר ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( d\left(F,H\right)=2^{-n}\le2^{-\min\left\{ m_{1},m_{2}\right\} }=\max\left\{ 2^{-m_{1}},2^{-m_{2}}\right\} =\max\left(d\left(F,G\right),d\left(G,H\right)\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה נותן לנו את &lt;strong&gt;אי שוויון המשולש&lt;/strong&gt;, בגרסה יותר חזקה מהרגיל אפילו: אם אני קטן מהמקסימום של שני מספרים אי שליליים, אני בוודאי קטן יותר מהסכום שלהם (שכולל את המקסימום ועוד איזה מספר)&lt;/p&gt;

&lt;p&gt;אז קיבלנו פונקציה &lt;span&gt;\( d \)&lt;/span&gt; כך ש-&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( d\left(F,G\right)\ge0 \)&lt;/span&gt; ויש שוויון אם ורק אם &lt;span&gt;\( F=G \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( d\left(F,G\right)=d\left(G,F\right) \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( d\left(F,H\right)\le d\left(F,G\right)+d\left(G,H\right) \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;שלוש התכונות הללו הופכות את &lt;span&gt;\( d \)&lt;/span&gt; למה שנקרא &lt;strong&gt;מטריקה&lt;/strong&gt;, שהיא פונקציה שמאפשרת לדבר באופן כללי על גבולות והתכנסות (למעשה, התכונה החזקה יותר של אי-שוויון המשולש נותנת משהו שנקרא &lt;strong&gt;אולטרמטריקה&lt;/strong&gt; אבל נעזוב את זה). עכשיו אפשר לומר משהו כזה: &lt;span&gt;\( \lim_{n\to\infty}F^{n}\left(x\right)=F\left(x\right) \)&lt;/span&gt; אם לכל &lt;span&gt;\( \varepsilon&amp;gt;0 \)&lt;/span&gt; קיים &lt;span&gt;\( N \)&lt;/span&gt; כך שאם &lt;span&gt;\( n&amp;gt;N \)&lt;/span&gt; אז &lt;span&gt;\( d\left(F^{n}\left(x\right),F\left(x\right)\right)&amp;lt;\varepsilon \)&lt;/span&gt;. זו ההגדרה הסטנדרטית לגבול, ואם חושבים עליה קצת בהקשר של ה-&lt;span&gt;\( d \)&lt;/span&gt; הספציפית שלנו רואים שהמשמעות של &lt;span&gt;\( \lim_{n\to\infty}F^{n}\left(x\right)=F\left(x\right) \)&lt;/span&gt; היא בדיוק מה שהזכרתי קודם: כדי שהסדרה &lt;span&gt;\( F^{n}\left(x\right) \)&lt;/span&gt; תתכנס לגבול, צריך שהמקדם של &lt;span&gt;\( x^{k} \)&lt;/span&gt; יתקבע החל ממקום מסוים בסדרה, ואז הוא יהיה המקדם של אותו איבר ב-&lt;span&gt;\( F\left(x\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להסתכל על ביטוי כמו &lt;span&gt;\( \sum_{n=0}^{\infty}F\left(x\right)^{n} \)&lt;/span&gt;. כבר היינו בסיטואציה דומה קודם, וראינו שכדי שחזקה של &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; תתנהג יפה, היה צריך שיתקיים &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt;, אז נניח שזה קורה. עכשיו אפשר לחשוב על &lt;span&gt;\( \sum_{n=0}^{\infty}F\left(x\right)^{n} \)&lt;/span&gt; פשוט כמו טור במובן הרגיל, כזה שמוגדר עם סכומים חלקיים &lt;span&gt;\( \sum_{n=0}^{\infty}F\left(x\right)^{n}=\lim_{n\to\infty}S_{n} \)&lt;/span&gt; כאשר &lt;span&gt;\( S_{n}=\sum_{k=0}^{n}F\left(x\right)^{k} \)&lt;/span&gt;. בכל פעם שבה מוסיפים חזקה חדשה &lt;span&gt;\( F\left(x\right)^{n} \)&lt;/span&gt; לסכום שיש לנו, היא משנה רק את המקדמים של &lt;span&gt;\( x^{n} \)&lt;/span&gt; וחזקות גבוהות יותר - כלומר, החזקות הנמוכות יותר &lt;strong&gt;התקבעו&lt;/strong&gt; ולכן הטור מתכנס.\textbackslash אפשר לעשות משהו אפילו עוד יותר משעשע כדי לחשב את הסכום שלו: הרי כדי לחשב את הסכום של &lt;span&gt;\( \sum_{n=0}^{\infty}q^{n} \)&lt;/span&gt; במספרים ממשיים אנחנו מסתכלים על הסכום החלקי ה-&lt;span&gt;\( n \)&lt;/span&gt;-י שיוצא &lt;span&gt;\( \frac{q^{n+1}-1}{q-1} \)&lt;/span&gt;, נוכל להסתכל על סכום דומה גם עבור &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt;. הרי איך מוכיחים את הנוסחה לסכום החלקי? מסתכלים על המכפלה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(1+F\left(x\right)+\ldots+F\left(x\right)^{n}\right)\left(F\left(x\right)-1\right)=F\left(x\right)^{n+1}-1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו זהות שאפשר להוכיח בכל חוג קומוטטיבי. עכשיו, אם &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt; אז המקדם החופשי של &lt;span&gt;\( F\left(x\right)-1 \)&lt;/span&gt; שונה מאפס ולכן הוא הפיך, ולכן אפשר לכפול בהופכי ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1+F\left(x\right)+\ldots+F\left(x\right)^{n}=\frac{F\left(x\right)^{n+1}-1}{F\left(x\right)-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו, מהו &lt;span&gt;\( \lim_{n\to\infty}\frac{F\left(x\right)^{n+1}-1}{F\left(x\right)-1} \)&lt;/span&gt;? המכנה נשאר קבוע, ובמונה יש לנו חזקה הולכת וגדלה &lt;span&gt;\( F\left(x\right)^{n+1} \)&lt;/span&gt;. בחזקה הזו, המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; וכל הקודמים לו הוא 0, ולכן… &lt;span&gt;\( \lim_{n\to\infty}F\left(x\right)^{n+1}=0 \)&lt;/span&gt; ומכאן נקבל &lt;span&gt;\( \lim_{n\to\infty}\frac{F\left(x\right)^{n+1}-1}{F\left(x\right)-1}=\frac{0-1}{F\left(x\right)-1}=\frac{1}{1-F\left(x\right)} \)&lt;/span&gt; והנה קיבלנו את התוצאה שממנה התחיל הפוסט - רק שעכשיו הוכחנו אותה &lt;strong&gt;באותה צורה בדיוק&lt;/strong&gt; שבה מוכיחים את הסכום ה”קלאסי”. אותה טרמינולוגיה, אותו עולם מושגים של התכנסות, אותה טכניקה - &lt;strong&gt;ובלי לערב רדיוסי התכנסות בכלל&lt;/strong&gt;. אין זכר למגבלה &lt;span&gt;\( \left|q\right|&amp;lt;1 \)&lt;/span&gt;, פשוט כי בחוג שלנו, עם המטריקה שלנו, העניינים הם למעשה &lt;strong&gt;פשוטים יותר&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו גם קצת יותר ברורה העניין הזה של להציב את &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; בתוך &lt;span&gt;\( G\left(x\right) \)&lt;/span&gt;. אנחנו מקבלים בסוף טור מהצורה &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}F^{n}\left(x\right) \)&lt;/span&gt;, וזה מתכנס אם &lt;span&gt;\( F_{0}=0 \)&lt;/span&gt;. עכשיו אפשר לקחת את זה ולהשתמש בזה עבור טורים מוכרים. למשל, אם ניזכר איך נראה הפיתוח של פונקציית האקספוננט לטור חזקות: &lt;span&gt;\( e^{x}=\sum_{n=0}^{\infty}\frac{1}{n!}x^{n} \)&lt;/span&gt;, אז אפשר להגדיר &lt;span&gt;\( e^{F\left(x\right)}=\sum_{n=0}^{\infty}\frac{1}{n!}F^{n}\left(x\right) \)&lt;/span&gt;, ואפשר להגדיר &lt;span&gt;\( \ln\left(1+F\left(x\right)\right)=\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+1}}{n}F^{n}\left(x\right) \)&lt;/span&gt; ועוד ועוד. אז ביטוי כמו &lt;span&gt;\( \sqrt{1-4x} \)&lt;/span&gt; שמופיע בתוך פונקציה יוצרת? נראה לי שאנחנו כבר יודעים איך להסתדר איתו.&lt;/p&gt;</content><author><name></name></author><category term="מספרי קטלן" /><category term="פונקציות יוצרות" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מספרי קטלן</title><link href="http://gadial.net/2025/05/31/catalan_numbers/" rel="alternate" type="text/html" title="מספרי קטלן" /><published>2025-05-31T00:00:00+00:00</published><updated>2025-05-31T00:00:00+00:00</updated><id>http://gadial.net/2025/05/31/catalan_numbers</id><content type="html" xml:base="http://gadial.net/2025/05/31/catalan_numbers/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;אם אני אלך ברחוב ואשאל באקראי אנשים איזו סדרה מתמטית הם מכירים, אחרי שנקלף את שכבות האלו שיבהלו ויברחו או יתחכמו ויגידו ש-Numb3rs (אף אחד לא יגיד, העולם כבר שכח שהייתה סדרה כזו וגם לי לא יצא לראות אותה) כנראה אקבל שלל תשובות: “סדרת פיבונאצ’י”, “סדרת פיבונאצ’י!”, “פיבונאצ’י”, “הטבעיים” (חכמולוג, לסנן) ו”פיבונאצ’י”. ובכן, סדרת פיבונאצ’י כבודה במקומו מונח, יש עוד סדרות מעניינות בעולם ואני רוצה לדבר בפוסט הזה על אחת אהובה במיוחד - סדרת מספרי קטלן (Catalan, על שם המתמטיקאי הבלגי אז’ן שרל קטלן). זו הסדרה הבאה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1,1,2,5,14,42,132,429,1430,4862,\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שמעניין בה הוא שהיא הפתרון של שלל בעיות קומבינטורית שונות ומשונות. המתמטיקאי ריצ’רד סטנלי (שכתב את הספר הפנטסטי Enumerative Combinatorics) התמחה בלאסוף בעיות שונות ומשונות שמספרי קטלן הם הפתרון שלהן, ובסופו של דבר פרסם ספר עם 214 בעיות כאלו. מן הסתם אני לא אכסה כמעט כלום מזה הפעם; אבל אני רוצה בפוסט הזה שנכיר את התכונות הבסיסיות של המספרים הללו (שאנחנו מבינים די טוב) ונראה שלל בעיות שונות ומשונות ולכאורה לא קשורות שהם פותרים.&lt;/p&gt;

&lt;p&gt;היסטורית, האדם הראשון שיש לנו אינדיקציה שנתקל במספרי קטלן הוא המתמטיקאי המונגולי Minggatu, בספר על חישוב קירובים שכתב בסביבות 1730 שבו מספרי קטלן הופיעו בתוך חלק מהנוסחאות; זה פחות רלוונטי לנו כאן כי זה לא שימוש במספרי קטלן לפתרון בעיה קומבינטורית. מכאן אנחנו קופצים ל-1751, כשלאונרד אוילר (מהמתמטיקאים הפורים בהיסטוריה שנראה שהתעסק פשוט בכל דבר) תיאר אותם במכתב לשותפו המתמטי כריסטיאן גולדבך, בתור הפתרון של בעיה קומבינטורית ספציפית - אז בואו נתחיל מלדבר על הבעיה הזו למרות שהיא אולי לא הכי פשוטה מבין אלו שאפשר לפתוח בהן.&lt;/p&gt;

&lt;h2&gt;שילושים של מצולע&lt;/h2&gt;

&lt;p&gt;במקרה הזה תמונה אחת שווה אלף מילים, ואני מתנצל בפני מי שלא יכולים לראות אותה (ואת כל יתר האיורים שהפוסט הזה יהיה עמוס בהם):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulations.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה רואים פה? אני מצייר משושה משוכלל (כלומר מצולע עם שש צלעות שאורכי כל הצלעות שלו שווים וכל הזוויות שלו שוות) ובתוך המשושה אני מותח קווים בין חלק מהקודקודים, בצורה כזו שאין שני קווים שחוצים אחד את השני, ואני מותח מספיק קווים כדי לחלק את המצולע למשולשים. דבר כזה נקרא “שילוש”. בימינו אנו שילושים הם דבר מאוד מעניין, למשל בגרפיקה תלת ממדית, אבל כבר בימי אוילר זה היה מספיק מעניין כדי לנסות להבין איך נראים השילושים האפשריים השונים של מצולע - ובפרט, כמה כאלו יש. מה שאנחנו רואים בתמונה הוא את כל 14 השילושים האפשריים של משושה משוכלל. חלק מהשילושים נראים דומים אחד לשני - כאילו אפשר לסובב או לשקף אחד ולקבל את האחר. מה שמעניין אותנו כאן הוא לספור אותם בתור שילושים שונים - כלומר, אפשר לחשוב על זה כאילו מספרנו את הקודקודים של המצולע, ואנחנו מסתכלים על רשימה של שלשות שמציינות קודקודים. הנה דוגמא:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulation_numbered.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כאן מספרתי את הקודקודים מ-1 עד 6 בכיוון השעון החל מהקודקוד העליון השמאלי, והמשולשים שלי הם &lt;span&gt;\( \left\{ 1,5,6\right\} ,\left\{ 1,2,5\right\} ,\left\{ 2,4,5\right\} ,\left\{ 2,3,4\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;האם יש דרך מסודרת “לייצר” שילושים? למרבה השמחה, כן - דרך &lt;strong&gt;רקורסיבית&lt;/strong&gt;. כלומר, אם אנחנו כבר יודעים למצוא שילושים למצולעים פשוטים, אנחנו יכולים לנצל את זה כדי למצוא שילושים למצולעים מורכבים יותר. מה המצולעים הפשוטים ביותר? ובכן, כמובן שמשולש הוא די פשוט - אם יש לנו משולש, ה”שילוש” שלו זה בסך הכל הוא עצמו. שימו לב שזה לא צריך להיות משולש משוכלל (“משולש שווה צלעות”) - זה נכון לכל משולש.&lt;/p&gt;

&lt;p&gt;אבל חוץ ממשולש, תכף נראה שישתלם לנו לדבר על מצולע אפילו עוד יותר פשוט - מצולע בן &lt;strong&gt;שני קודקודים&lt;/strong&gt;. מה זה הדבר הזה? זה בסך הכל קו ישר אחד; אפשר להתלונן ולומר שזה לא &lt;strong&gt;באמת&lt;/strong&gt; מצולע, אבל זה לא משנה - כאמור, זה הולך להשתלם לנו לחשוב עליו כמצולע עוד מעט.&lt;/p&gt;

&lt;p&gt;בואו ננסה למצוא שילוש למשושה המשוכלל. אני מתחיל עם השאלה - מה קורה עם הצלע 1-2? אני יודע שבסופו של דבר היא תהיה חלק ממשולש שכל הקודקודים שלו שייכים למצולע המקורי, כלומר משולש ששניים מהקודקודים שלו הם 1 ו-2 ואני חופשי לבחור את הקודקוד הנוסף - כל בחירה שונה תניב בסופו של דבר שילושים שונים. בואו נאמר שבחרתי את 5, אז אני מותח קווים אליו מ-1 ו-2, ומקבל:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulation_initial.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;עכשיו מגיע הצעד הרקורסיבי: קונספטואלית, אפשר לחשוב על זה כאילו אני &lt;strong&gt;מוחק&lt;/strong&gt; את הצלע 1-2 מהמשושה ומקבל:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulation_erase.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה שקיבלתי פה הוא שפירקתי את המשושה המקורי לשני מצולעים שונים: המצולע 1-5-6 והמצולע 2-3-4-5. שני המצולעים חולקים קודקוד משותף אחד, את 5 - הקודקוד שבחרתי. בנוסף, יש להם פחות צלעות: לאחד יש 3 ולשני 4 (שימו לב שמספר הצלעות הכולל שלהם הוא כמספר הצלעות במצולע שהתחלנו ממנו, ועוד 1 - זה בגלל שמחקנו את 1-2 אבל הוספנו את 1-5 ואת 2-5). אם יש להם פחות צלעות, אני יכול רקורסיבית לשלש אותם… רגע, שניה, הרי 2-3-4-5 הוא אמנם מצולע, אבל הוא לא מצולע משוכלל, הוא נראה כמו מין טרפז שכזה. למה שאוכל לשלש אותו?&lt;/p&gt;

&lt;p&gt;בואו נחשוב שניה - מה אנחנו צריכים כדי שנוכל לשלש צורה? ראינו שכל משולש הוא בר-שילוש, אבל מה קורה בצורה מורכבת יותר? במשושה שלנו הייתה לי הנחה סמויה - שאני באמת יכול להעביר קווים מ-1 ו-2 אל 5. לא הייתה לי בעיה לעשות את זה כי משושה משוכלל הוא צורה &lt;strong&gt;קמורה&lt;/strong&gt; - כלומר, צורה שבה כל קו בין שתי נקודות ששייכות לצורה עובר כולו בתוך הצורה. זו ההנחה שאני זקוק לה - כלומר, מה שאני סופר הוא כמה שילושים יש למצולע קמור כלשהו, ויוצא שזה לא באמת תלוי בצורה של המצולע אלא רק במספר הקודקודים שלו.&lt;/p&gt;

&lt;p&gt;בואו נכנס סימון לעניין: נסמן ב-&lt;span&gt;\( T_{n} \)&lt;/span&gt; את מספר השילושים של מצולע קמור עם &lt;span&gt;\( n \)&lt;/span&gt; קודקודים. הספירה שלנו מתחילה מ-2, ואז אמרנו שאני בוחר בצורה שנראית קצת שרירותית להגדיר &lt;span&gt;\( T_{2}=1 \)&lt;/span&gt;. בנוסף &lt;span&gt;\( T_{3}=1 \)&lt;/span&gt; כי למשולש יש שילוש יחיד. ומה קורה עבור &lt;span&gt;\( n \)&lt;/span&gt; גדולים יותר? אני אעשה את הטריק שכבר ראינו: אסתכל על הקודקודים 1,2 במצולע בן &lt;span&gt;\( n \)&lt;/span&gt; הצלעות שלי, ואשאל את עצמי מי הקודקוד הנוסף שמתחבר אליהם. נסמן את הקודקוד הזה ב-&lt;span&gt;\( k \)&lt;/span&gt; (&lt;span&gt;\( 3\le k\le n \)&lt;/span&gt;). אחרי שנחבר את 1,2 אליו ונסיר את הקשת 1-2 נקבל שני מצולעים עם פחות צלעות. כמה צלעות? ובכן, בואו נסתכל על הדוגמא למעלה - שם בחרתי &lt;span&gt;\( k=5 \)&lt;/span&gt;, מה שאמר שהמצולע הראשון שקיבלנו כלל את הקודקודים &lt;span&gt;\( 2,3,4,5 \)&lt;/span&gt; והמצולע השני את &lt;span&gt;\( 5,6,1 \)&lt;/span&gt;. זה מה שקורה באופן כללי - המצולעים שלנו יהיו בעלי קבוצות הקודקודים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left\{ 2,3,\ldots,k\right\} ,\left\{ k,k+1,\ldots,n,1\right\}  \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בקבוצה הראשונה יש &lt;span&gt;\( k-1 \)&lt;/span&gt; קודקודים ובשתיהן יחד יש &lt;span&gt;\( n+1 \)&lt;/span&gt; קודקודים (כי &lt;span&gt;\( k \)&lt;/span&gt; מופיע פעמיים) ולכן בקבוצה השניה יש &lt;span&gt;\( \left(n+1\right)-\left(k-1\right) \)&lt;/span&gt; קודקודים. זה אומר שמספר השילושים האפשרי של המצולע הראשון הוא &lt;span&gt;\( T_{k-1} \)&lt;/span&gt; ושל השני הוא &lt;span&gt;\( T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt;. עכשיו נשתמש &lt;strong&gt;בקומבינטוריקה&lt;/strong&gt;: כל שילוש של המצולע המקורי שלנו מתקבל מבחירה של שילוש אחד של המצולע הראשון ושילוש אחד של המצולע השני, ושתי הבחירות הללו הן בלתי תלויות זו בזו (כלומר, &lt;strong&gt;לכל&lt;/strong&gt; שילוש של המצולע הראשון אפשר לבחור &lt;strong&gt;כל&lt;/strong&gt; שילוש של המצולע השני ונקבל שילוש שונה של המצולע המקורי) ולכן מספר האפשרויות הכולל הוא &lt;strong&gt;מכפלה&lt;/strong&gt; של מספר האפשרויות הראשון ומספר האפשרויות השני - זה מה שנקרא בקומבינטוריקה &lt;strong&gt;עקרון הכפל&lt;/strong&gt;. בסך הכל יש &lt;span&gt;\( T_{k-1}\cdot T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt; אפשרויות.&lt;/p&gt;

&lt;p&gt;עכשיו, זה היה מספר האפשרויות אם המשולש שאני בונה עם 1,2 כולל גם את &lt;span&gt;\( k \)&lt;/span&gt;. עבור בחירות שונות של &lt;span&gt;\( k \)&lt;/span&gt; אני אקבל שילושים שונים. האם אותו ניתוח יעבוד בכולן? נראה שכן, אבל כדי לוודא בואו נסתכל על המקרה הקיצוני - נאמר, כשבוחרים את הקודקוד &lt;span&gt;\( k=6 \)&lt;/span&gt;:
&lt;img src=&quot;/assets/img/2025/catalan_triangulation_trivial_case.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;למה זה המקרה הקיצוני? כי אם עכשיו אני מסיר את הצלע 1-2 אני מקבל “מצולע” בעל שני קודקודים, &lt;span&gt;\( \left\{ 1,6\right\}  \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/catalan_triangulation_trivial_case_erase.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אבל זו בדיוק הסיבה שבגללה אמרתי קודם שנוח לי לחשוב גם על המקרה הזה בתור מצולע, עם שילוש יחיד. למי שהגישה הזו מפריעה לו אפשר לנסח עוד דרכים לחשוב על זה - למשל, שאנחנו פשוט גוזרים את כל המשולש 1-2-6 מהמצולע ונשארנו רק עם מצולע יחיד להתמודד איתו. זה לא באמת משנה - השורה התחתונה היא שאני מקבל &lt;span&gt;\( T_{k-1}\cdot T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt; אפשרויות תמיד, לכל &lt;span&gt;\( k \)&lt;/span&gt;, כולל מקרי הקיצון של &lt;span&gt;\( k=3 \)&lt;/span&gt; ו-&lt;span&gt;\( k=n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אם כך, אפשר לחשוב על בניית שילוש של מצולע בתור תהליך שבו אנחנו בוחרים &lt;span&gt;\( k \)&lt;/span&gt;, ועבור ה-&lt;span&gt;\( k \)&lt;/span&gt; שבחרנו יש לנו &lt;span&gt;\( T_{k-1}\cdot T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt; אפשרויות לבנות שילוש. כאן זה לא תהליך דו-שלבי אלא סיטואציה של “או זה, או זה, או זה”. במקרה הזה &lt;strong&gt;עקרון החיבור&lt;/strong&gt; בקומבינטוריקה אומר שאנחנו צריכים לחבר את מספר האפשרויות בכל אחד מהמקרים. אצלנו &lt;span&gt;\( 3\le k\le n \)&lt;/span&gt; ולכן בסך הכל קיבלנו את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( T_{n}=\sum_{k=3}^{n}T_{k-1}T_{\left(n+1\right)-\left(k-1\right)} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שאני אוהב בנוסחה הזו הוא שברור לנו איך היא התקבלה. הבעיה היא שהיא לא יפה במיוחד - יש קטסטרופה שלמה עם האינדקסים שם. אז המתמטיקאים אומרים - היי, בעצם, סדרת ה-&lt;span&gt;\( T \)&lt;/span&gt;-ים הזו “מבזבזת” את שני האינדקסים הראשונים של, &lt;span&gt;\( T_{0},T_{1} \)&lt;/span&gt; שבכלל לא מוגדרים. בואו נשנה סימון ונתחיל עם סדרה שכן מתחילה מאפס. נסמן ב-&lt;span&gt;\( C \)&lt;/span&gt; את האיברים שלה, כלומר &lt;span&gt;\( C_{0}=T_{2} \)&lt;/span&gt; ו-&lt;span&gt;\( C_{1}=T_{3} \)&lt;/span&gt; וכדומה - באופן כללי, &lt;span&gt;\( C_{n}=T_{n+2} \)&lt;/span&gt;. אז נוסחת הנסיגה תהפוך להיות:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C_{n}=T_{n+2}=\sum_{k=3}^{n+2}T_{k-1}T_{\left(n+3\right)-\left(k-1\right)}=\sum_{k=3}^{n+2}C_{k-3}C_{\left(n+1\right)-\left(k-1\right)}= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\sum_{i=0}^{n-1}C_{i}C_{n+1-\left(i+2\right)}=\sum_{i=0}^{n-1}C_{i}C_{n-1-i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן השתמשתי בשינוי האינדקס &lt;span&gt;\( i=k-3 \)&lt;/span&gt; כדי לפשט עוד יותר, ויש כאלו שכדאי שהנוסחה תהיה עוד יותר פשוטה מעדיפים להציג אותה ככה, עם &lt;span&gt;\( C_{n+1} \)&lt;/span&gt; במקום &lt;span&gt;\( C_{n} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C_{n+1}=\sum_{i=0}^{n}C_{i}C_{n-i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו נוסחת הנסיגה המהותית שמגדירה את מספרי קטלן, והיא מה שאוילר מצא (והסיק ממנה את מה שנקרא &lt;strong&gt;הפונקציה היוצרת&lt;/strong&gt; של הסדרה ובשיטות מפוקפקות של חשבון דיפרנציאלי ואינטגרלי הסיק ממנה את הנוסחה הסגורה של הסדרה, שנראה בהמשך). כשהיא מוצגת כך, אפשר להבין למה מספרי קטלן הם כל כך בסיסיים - הנוסחה בעצם מתארת כל סיטואציה שבה כדי לבנות אובייקט מגודל &lt;span&gt;\( n+1 \)&lt;/span&gt; אנחנו בונים זוג אובייקטים שהגודל שלהם מסתכם אל &lt;span&gt;\( n \)&lt;/span&gt;, וכל זוג כזה מייצר לנו באופן ייחודי אובייקט מגודל &lt;span&gt;\( n+1 \)&lt;/span&gt;. זה טיפה טריקי (לפחות עבורי) לראות את זה ישירות עבור שילוש של מצולעים בגלל שמצולע מ”גודל” &lt;span&gt;\( n+1 \)&lt;/span&gt; במקרה הזה הוא מצולע עם &lt;span&gt;\( n+3 \)&lt;/span&gt; קודקודים ובהתאם, כשאנחנו מפרקים אותו לאובייקט מגודל &lt;span&gt;\( i \)&lt;/span&gt; ומגודל &lt;span&gt;\( n-i \)&lt;/span&gt; יש לנו מצולעים עם &lt;span&gt;\( i+2 \)&lt;/span&gt; קודקודים ו-&lt;span&gt;\( n-i+2 \)&lt;/span&gt; קודקודים ולכן בסך הכל &lt;span&gt;\( n+4 \)&lt;/span&gt; קודקודים שאחד מהם (קודקוד &lt;span&gt;\( i \)&lt;/span&gt;) נספר פעמיים ולכן הם בדיוק &lt;span&gt;\( n+3 \)&lt;/span&gt; הקודקודים של המצולע המקורי. הצלחתן לעקוב? יופי, כי אני לא. בכל פעם שבה אני מנסה לראות את זה ככה אני מסתבך בגלל כל עניין הפלוס 2 הזה; לכן הצגתי את זה קודם עם ה-&lt;span&gt;\( T \)&lt;/span&gt;-ים.&lt;/p&gt;

&lt;p&gt;למרבה המזל יש בעיות קומבינטוריות שנותנות את &lt;span&gt;\( C_{n} \)&lt;/span&gt; בצורה ישירה יותר.&lt;/p&gt;

&lt;h2&gt;מסלולי שריג&lt;/h2&gt;

&lt;p&gt;גם כאן, תמונה אחת עוזרת מאוד להבין מה אני בכלל רוצה. ראשית, תמונה של כל ה-14 אובייקטים מגודל 4 שאני הולך לספור:
&lt;img src=&quot;/assets/img/2025/grid_walks_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אוקיי, אולי זה לא לגמרי ברור. בואו נראה עוד דוגמא קונקרטית:
&lt;img src=&quot;/assets/img/2025/grid_walk_basic.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;יש לנו כאן לוח משבצות, אבל אני מתעניין פחות במשבצות הפעם ויותר בקודקודים שלהן ובקווים שמחברים אותן - לרשת כזו של קודקודים וקווים במרווחים שווים קוראים &lt;strong&gt;שריג&lt;/strong&gt;. עכשיו, אני נותן קואורדינטות לכל נקודות השריג כך ש-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; היא הנקודה השמאלית-תחתונה ו-&lt;span&gt;\( \left(7,7\right) \)&lt;/span&gt; היא הקואורדינטה הימנית-עליונה, ואני מסתכל על &lt;strong&gt;מסלול&lt;/strong&gt; שמתחיל מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; ומסתיים ב-&lt;span&gt;\( \left(7,7\right) \)&lt;/span&gt;. כל צעד במסלול עובר מקודקוד אחד לאחר על הקו שמחבר ביניהם, המסלול הספציפי שלי מתחיל בצעד ימינה, ואז למעלה, ימינה, למעלה… טוב, זה כאב ראש לתאר הכל במפורש, אבל אפשר לתאר בצורה קומפקטית בתור רצף של אותיות: R מסמן צעד ימינה ו-U מסמן צעד למעלה, ואז המסלול שמתואר באיור הוא&lt;/p&gt;

&lt;p&gt;RURURRRUURUUUR&lt;/p&gt;

&lt;p&gt;ספירה מהירה תראה שיש במסלול הזה 14 צעדים - בדיוק 7 צעדי R ו-7 צעדי U, מה שלא כל כך מפתיע כי כדי להגיע מלמטה למעלה צריך 7 צעדים, וכך גם כדי להגיע משמאל לימין. השאלה היא רק מה יהיה הסדר הפנימי בין הצעדים הללו. עכשיו, אפשר להוסיף גם צעדים שמאלה/למטה, אבל הם רק יובילו לכך שהמסלול יהיה ארוך יותר, ואנחנו מתעניינים בשאלה כמה מסלולים קצרים ביותר יש. באופן כללי, לכל &lt;span&gt;\( n \)&lt;/span&gt; טבעי, אנחנו שואלים את השאלה כמה מסלולי שריג יש מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; שאורכם בדיוק &lt;span&gt;\( 2n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מתברר שזו שאלה &lt;strong&gt;קלה&lt;/strong&gt; שאנחנו לא צריכים את מספרי קטלן עבורה, אבל כן צריך להכיר קצת קומבינטוריקה בסיסית מהסוג שתיארתי &lt;a href=&quot;https://gadial.net/2010/06/20/combinatorics_intro/&quot;&gt;בפוסט הזה&lt;/a&gt;: שם דיברתי על כך שמספר האפשרויות לבחור &lt;span&gt;\( k \)&lt;/span&gt; מתוך &lt;span&gt;\( n \)&lt;/span&gt; איברים, כשאין חשיבות לסדר שבו האיברים נבחרים ואי אפשר לבחור איבר פעמיים, הוא בדיוק מה שמסומן בתור &lt;span&gt;\( {n \choose k} \)&lt;/span&gt; (קרי: “&lt;span&gt;\( n \)&lt;/span&gt; בחר &lt;span&gt;\( k \)&lt;/span&gt;”) ושווה ל-&lt;span&gt;\( {n \choose k}=\frac{n!}{k!\left(n-k\right)!} \)&lt;/span&gt;. אני אניח פה שהדבר הזה מוכר.&lt;/p&gt;

&lt;p&gt;עכשיו, אפשר לחשוב על מסלול מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; שכולל בדיוק &lt;span&gt;\( n \)&lt;/span&gt; צעדי U ו-&lt;span&gt;\( n \)&lt;/span&gt; צעדי R בתור משהו שניתן להרכיב כך: ראשית, מבין &lt;span&gt;\( 2n \)&lt;/span&gt; הצעדים במסלול (הצעד הראשון, השני, השלישי וכו’) אנחנו בוחרים בדיוק &lt;span&gt;\( n \)&lt;/span&gt; ומציבים בהם U, ואז בכל השאר מציבים R. זו בחירה &lt;strong&gt;בלי&lt;/strong&gt; חשיבות לסדר, כי זה לא משנה אם קודם החלטתי שבצעד 1 יהיה U ואז החלטתי שבצעד 5 יהיה גם U או אם החלטתי את זה קודם עבור צעד 5 ורק אז עבור צעד 1. זו גם בחירה שבה אי אפשר לבחור איבר פעמיים, כי אני לא יכול להחליט שאני רוצה לדחוף לצעד 5 “פעמיים U”. לכן מספר מסלולי השריג מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; הוא בדיוק &lt;span&gt;\( {2n \choose n} \)&lt;/span&gt;. זה היה קל.&lt;/p&gt;

&lt;p&gt;אז בואו נסבך קצת את הבעיה. אני הולך למתוח &lt;strong&gt;אלכסון&lt;/strong&gt; בלוח שלי, ולחפש רק את המסלולים &lt;strong&gt;שלא מגיעים מעל האלכסון&lt;/strong&gt;, כלומר לא מבקרים באף משבצת מהצורה &lt;span&gt;\( \left(a,b\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( a&amp;lt;b \)&lt;/span&gt;. המסלול שציירתי קודם &lt;strong&gt;כמעט&lt;/strong&gt; מקיים את זה, אבל נכשל ברגע האחרון:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/grid_walk_wrong.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כדי שיהיה קל להבין מה הולך פה, האיור שלי משתמש בויזואליזציה נחמדה שראיתי במקור בויקיפדיה האנגלית: צובעים את כל המשבצות &lt;strong&gt;מתחת&lt;/strong&gt; למסלול בצבע כתום, והקריטריון לכך שהמסלול תקין הוא שהאלכסון (הקו המקווקו) לא עובר בתוך אף משבצת כתומה. כמה מסלולים כאלו יש? האינטואיציה הראשונית שלי היא שחצי ממספר המסלולים הכולל, כלומר &lt;span&gt;\( \frac{1}{2}{2n \choose n} \)&lt;/span&gt;, כי אנחנו לוקחים רק את המסלולים ש&lt;strong&gt;מתחת&lt;/strong&gt; לאלכסון ולכל מסלול כזה יש מסלול סימטרי &lt;strong&gt;מעל&lt;/strong&gt; האלכסון (כזה שבו כל צעד “למעלה” מוחלף בצעד “ימינה” וכל צעד “ימינה” מוחלף בצעד “למעלה”). רק שכמובן שזה לא עובד כי רוב המסלולים הם בכלל כאלו ש&lt;strong&gt;חוצים&lt;/strong&gt; את האלכסון, לא שנשארים רק מעליו או מתחתיו. אז מה עושים?&lt;/p&gt;

&lt;p&gt;אני אתחיל מלמצוא נוסחה רקורסיבית עבור מספר המסלולים, והפלא ופלא נקבל בדיוק את הנוסחה הרקורסיבית שכבר ראינו עבור &lt;span&gt;\( C_{n} \)&lt;/span&gt;. אחרי זה נראה להטוט שאני מאוד אוהב שיאפשר לנו לקבל עבור &lt;span&gt;\( C_{n} \)&lt;/span&gt; את הנוסחה המדויקת &lt;span&gt;\( C_{n}=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;. אם היקום היה מושלם, אז הלהטוט היה פשוט לראות בעיה קומבינטורית שקל באופן ישיר לראות שיש לה &lt;span&gt;\( \frac{1}{n+1}{2n \choose n} \)&lt;/span&gt; פתרונות, אבל את זה אני לא יודע איך עושים אז אעשה משהו קצת יותר מתוסבך, אבל לא הרבה יותר.&lt;/p&gt;

&lt;p&gt;אז איך נראה מסלול שריג “חוקי”, כזה שבשום שלב לא עובר מעל האלכסון? דבר אחד שאנחנו יודעים בודאות הוא שהצעד הראשון חייב להיות R, אחרת המסלול יגיע מעל האלכסון כבר בצעד הראשון שלו. אז בואו נתחיל את זה:
&lt;img src=&quot;/assets/img/2025/grid_walk_example_1.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אחרי הצעד הזה, המסלול לא נוגע באלכסון - הוא מתחתיו. הדבר השני שאנחנו יודעים הוא ש&lt;strong&gt;מתישהו&lt;/strong&gt; המסלול הולך לגעת באלכסון - לכל המאוחר הוא יגיע אליו ממש בסוף, כשיגיע אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt;, אבל הוא בהחלט יכול להגיע לשם עוד קודם ולגעת בו כמה פעמים. מה שאני הולך להסתכל עליו הוא מה שקורה למסלול עד הפעם &lt;strong&gt;הראשונה&lt;/strong&gt; שבה הוא מגיע אל האלכסון. מה שברור הוא שבצעד האחרון, שבו מגיעים אל האלכסון, המסלול הולך &lt;strong&gt;למעלה&lt;/strong&gt; (כי אם הוא היה הולך ימינה ומגיע אל האלכסון, זה אומר שהוא נמצא מעליו, וזה לא חוקי). אז מה קורה למסלול &lt;strong&gt;בין&lt;/strong&gt; ה-R ההתחלתי וה-U האחרון הזה? אפשר לצייר &lt;strong&gt;עוד&lt;/strong&gt; אלכסון, מתחת לאלכסון המרכזי שלנו, לקרוא לו “האלכסון המשני” ולראות שהמסלול שלנו בין הצעד הראשון והאחרון נמצא כולו &lt;strong&gt;מתחת לאלכסון המשני&lt;/strong&gt;. פשוט כי לעלות מעל האלכסון המשני אומר להגיע ולגעת באלכסון הראשי, וזה מה שאמרתי שקורה רק בסוף. במילים אחרות - בין הצעד הראשון והאחרון יש לנו &lt;strong&gt;עוד&lt;/strong&gt; משהו שמתנהג בדיוק כמו מסלול שריג חוקי, פשוט על שריג קטן יותר. בדוגמא שלי צבעתי באדום את הצעדים שמתאימים למסלול הזה והאורך שלו הוא 6 (כלומר, 3 צעדי R ו-3 צעדי U).
&lt;img src=&quot;/assets/img/2025/grid_walk_example_2.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;אחרי&lt;/strong&gt; ההגעה לאלכסון הראשי, יש לנו עוד מסלול שמתנהג כמו מסלול שריג חוקי שלא עובר מעל האלכסון, פשוט על שריג קטן יותר - המשבצות שנותרו. אצלי צבעתי אותו בכחול והאורך שלו הוא גם כן 3:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/grid_walk_example_3.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;זו החוקיות הכללית: כל מסלול חוקי מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; מורכב מ-R בהתחלה (שמביא את המסלול אל &lt;span&gt;\( \left(1,0\right) \)&lt;/span&gt;), ואז מסלול חוקי מאורך &lt;span&gt;\( 2k \)&lt;/span&gt; כלשהו (שמביא את המסלול אל &lt;span&gt;\( \left(k+1,k\right) \)&lt;/span&gt;), ואז U (שמביא את המסלול אל &lt;span&gt;\( \left(k+1,k+1\right) \)&lt;/span&gt;) ואז עוד מסלול חוקי (שמגיע אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt;). מכיוון שהאורך הכולל של המסלולים הוא &lt;span&gt;\( 2n \)&lt;/span&gt; ו”בזבזנו” 2 צעדים על ה-R בהתחלה וה-U בהמשך ובזבזנו עוד &lt;span&gt;\( 2k \)&lt;/span&gt; צעדים על המסלול החוקי הראשון, אז השני יהיה מאורך &lt;span&gt;\( 2n-2-2k=2\left(n-k-1\right) \)&lt;/span&gt;. כדי שהמספרים ייראו נחמד, בואו נדבר על מסלול מאורך &lt;span&gt;\( 2\left(n+1\right) \)&lt;/span&gt;, נמשיך לקרוא לאורך של המסלול הראשון &lt;span&gt;\( 2k \)&lt;/span&gt; ואז האורך של השני יהיה &lt;span&gt;\( 2\left(n-k\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;קל לנחש את הצעד הבא: אני אסמן ב-&lt;span&gt;\( C_{n} \)&lt;/span&gt; את מספר המסלולים מאורך &lt;span&gt;\( 2n \)&lt;/span&gt;, אז קיבלתי ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( C_{n+1}=\sum_{k=0}^{n}C_{k}C_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שאנחנו רואים פה בפעולה הוא בדיוק את העיקרון של “שני אובייקטים בלתי תלויים שסכום הגדלים שלהם הוא &lt;span&gt;\( n \)&lt;/span&gt; מצטרפים ליצירת אובייקט חדש מגודל &lt;span&gt;\( n+1 \)&lt;/span&gt;” (כאן ה”גודל” הוא, נאמר, מספר צעדי ה-R). עבורי, כשאני סתם רואה את הנוסחה של קטלן, השאלה שבאה מעצמה היא “למה בעצם איברים שסכום הגדלים שלהם הוא &lt;span&gt;\( n \)&lt;/span&gt; יוצרים משהו מגודל &lt;span&gt;\( n+1 \)&lt;/span&gt;? מאיפה הפלוס אחד הזה בא?” וכאן אנחנו רואים דוגמא לדרך שבה הוא עשוי לבוא - אין לנו &lt;strong&gt;חופש בחירה&lt;/strong&gt; מלא של איך לבנות את האובייקט החדש מתוך הקיימים; אנחנו &lt;strong&gt;חייבים&lt;/strong&gt; לתת צעד ראשון R, מה ש”מבזבז” לנו צעד אחד.&lt;/p&gt;

&lt;p&gt;אגב, מה מקרה הקיצון כאן? מה קורה בעצם כש-&lt;span&gt;\( k=0 \)&lt;/span&gt;? במקרה הזה המסלול הראשון הוא “ריק” ולא כולל צעדים: המסלול הגדול פשוט עושה את ה-R בהתחלה ואז מייד את ה-U שמביא אותו אל האלכסון הראשי - וזה בסדר, אנחנו סופרים את המסלול הריק פעם אחת והנוסחה מסתדרת יפה (“מסלול ריק” זו לא איזו המצאה תלושה; זו בסך הכל סדרה ריקה, דהיינו פונקציה שהתחום שלה ריק, כלומר קבוצה ריקה - אפשר לפרמל את זה עד הסוף, אבל האם זה באמת עוזר לנו להבין את זה יותר טוב?)&lt;/p&gt;

&lt;p&gt;טוב ויפה, אז שוכנענו שמספר מסלולי השריג שלא עולים מעל האלכסון הוא בדיוק מספר קטלן, אבל הבטחתי להראות דרך למצוא נוסחה סגורה עבורם בעזרת מסלולי שריג. בואו נראה את זה קורה. מה שאני הולך לעשות בפועל הוא לספור את המסלולים &lt;strong&gt;הלא חוקיים&lt;/strong&gt;, אלו שכן חוצים את האלכסון. אני אוכיח שהמספר שלהם, עבור השריג מגודל &lt;span&gt;\( n \)&lt;/span&gt;, הוא &lt;span&gt;\( {2n \choose n-1} \)&lt;/span&gt;. עכשיו אפשר לעשות טיפה אלגברה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( {2n \choose n-1}=\frac{\left(2n\right)!}{\left(n-1\right)!\left(n+1\right)!}=\left(2n\right)!\cdot\frac{n}{n!}\cdot\frac{1}{n!\left(n+1\right)}=\frac{\left(2n\right)!}{n!n!}\cdot\frac{n}{n+1}={2n \choose n}\cdot\frac{n}{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מכיוון שמספר המסלולים הכללי הוא &lt;span&gt;\( {2n \choose n} \)&lt;/span&gt;, אני אקבל שמספר המסלולים החוקיים הוא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( {2n \choose n}-{2n \choose n-1}={2n \choose n}-{2n \choose n}\cdot\frac{n}{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( ={2n \choose n}\left(1-\frac{n}{n+1}\right)=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;קיבלנו את הנוסחה הסגורה &lt;span&gt;\( C_{n}=\frac{1}{n+1}{2n \choose n} \)&lt;/span&gt;. יש כאמור עוד שלל דרכים להסיק אותה (ואוילר עשה את זה אלגברית, בעזרת הפונקציה היוצרת) אבל אני אוהב את הדרך הקומבינטורית שאראה עכשיו כי היא מאוד ציורית.&lt;/p&gt;

&lt;p&gt;האתגר שלנו הוא לספור כמה מסלולים קיימים ש&lt;strong&gt;כן&lt;/strong&gt; עולים מעל האלכסון. בדומה למה שעשיתי קודם, גם עכשיו הרעיון יהיה להסתכל על מסלול כללי כזה ולפרק אותו לחלק שלפני המעבר על החוק, והחלק שאחריו, ואז לעשות איזו מניפולציה. בואו נראה דוגמא:
&lt;img src=&quot;/assets/img/2025/grid_walk_mirror_1.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;הפעם הראשונה שבה המסלול הזה מגיע אל מעל האלכסון המרכזי הוא בקואורדינטה &lt;span&gt;\( \left(4,5\right) \)&lt;/span&gt;. מה שקורה אז הוא שהמסלול נוגע לראשונה באלכסון &lt;strong&gt;המשני&lt;/strong&gt; שנמצא מעל האלכסון הראשי - כלומר האלכסון &lt;span&gt;\( y=x+1 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו מגיע הטריק: אני הולך &lt;strong&gt;לשקף&lt;/strong&gt; את החלק של המסלול עד להגעה אל &lt;span&gt;\( \left(4,5\right) \)&lt;/span&gt;, ולשקף אותו ביחס לאלכסון המשני הזה. זה הולך להיראות ככה:
&lt;img src=&quot;/assets/img/2025/grid_walk_mirror_2.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;המסלול המשוקף עושה בדיוק ההפך ממה שהמסלול הרגיל עושה - בכל פעם שהרגיל עושה U המשוקף עושה R, ולהפך. הבדל נוסף הוא בנקודת ההתחלה: המסלול הרגיל מתחיל בנקודה &lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt;, שהיא צעד R אחד מהנקודה &lt;span&gt;\( \left(-1,0\right) \)&lt;/span&gt; שדרכה עובר האלכסון המשני; המסלול המשוקף מתחיל בנקודה שהיא צעד U אחד מאותה נקודה, כלומר הוא מתחיל מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, אם ניקח את המסלול המשוקף עד שהוא מגיע לנקודה &lt;span&gt;\( \left(4,5\right) \)&lt;/span&gt; ואז נמשיך ללכת במסלול &lt;strong&gt;הרגיל&lt;/strong&gt;, מה שקיבלנו הוא מסלול מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(10,10\right) \)&lt;/span&gt;, והיופי הוא כמובן שזה עובד באופן כללי. כלומר, הטכניקה הזו של “לקחת מסלול שעובר מעל האלכסון הראשי, להעביר אלכסון משני מהנקודה הראשונה שבה זה קורה, לשקף ולחבר עם המשך המסלול” - זו טכניקה שבהינתן מסלול שעובר מעל האלכסון הראשי נותנת לנו מסלול מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt;. לא קשה להוכיח את זה פורמלית: הרי מסלול הוא בסך הכל סדרה של U ו-R, ומה שעושה פעולת השיקוף היא כאמור להפוך כל R אל U וכל U אל R. אם אנחנו עושים את זה עבור מסלול כללי עד הנקודה שבה המסלול הגיע לנקודה מהצורה &lt;span&gt;\( \left(a,a+1\right) \)&lt;/span&gt;, זה אומר שהמסלול כלל &lt;span&gt;\( a \)&lt;/span&gt; צעדי R ו-&lt;span&gt;\( a+1 \)&lt;/span&gt; צעדי U ולכן המסלול המשוקף כולל &lt;span&gt;\( a \)&lt;/span&gt; צעדי U ו-&lt;span&gt;\( a+1 \)&lt;/span&gt; צעדי R - ולכן אם הוא מתחיל מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; הוא יגיע אל &lt;span&gt;\( \left(-1+\left(a+1\right),1+a\right)=\left(a,a+1\right) \)&lt;/span&gt; ומשם אפשר יהיה להמשיך אותו כרגיל.&lt;/p&gt;

&lt;p&gt;העניין הוא שאפשר לעשות גם &lt;strong&gt;את ההפך&lt;/strong&gt;: לקחת מסלול &lt;strong&gt;כלשהו&lt;/strong&gt; מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; ולקבל ממנו מסלול מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; שעובר מעל האלכסון. הרעיון פשוט: ברגע שהמסלול שלנו נוגע באלכסון המשני &lt;span&gt;\( y=x+1 \)&lt;/span&gt;, לבצע עליו את אותה פעולת שיקוף בדיוק. והנה הפאנץ’: &lt;strong&gt;כל&lt;/strong&gt; מסלול מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; חייב מתישהו להגיע אל האלכסון המשני, כי הוא מתחיל את המסלול &lt;strong&gt;מעליו&lt;/strong&gt; אבל מסיים את המסלול &lt;strong&gt;מתחתיו&lt;/strong&gt;. מכאן שבאמת אפשר להפוך ככה כל מסלול מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt;, ובמילים אחרות - ההתאמה בין מסלולים מ-מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; ומסלולים לא חוקיים מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; היא התאמה חח”ׂע ועל - גודל שתי הקבוצות הללו זהה. אבל מסלולים &lt;strong&gt;כלשהם&lt;/strong&gt; מ-&lt;span&gt;\( \left(-1,1\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,n\right) \)&lt;/span&gt; שכוללים רק צעדי U ו-R - את זה קל לספור. מסלול כזה חייב להכיל &lt;span&gt;\( n+1 \)&lt;/span&gt; צעדי R ו-&lt;span&gt;\( n-1 \)&lt;/span&gt; צעדי U, ולכן מספר הצעדים הכולל שלו הוא &lt;span&gt;\( \left(n-1\right)+\left(n+1\right)=2n \)&lt;/span&gt; ומתוכם צריך לבחור &lt;span&gt;\( n-1 \)&lt;/span&gt; כדי להציב בהם את ה-U - וזה בדיוק &lt;span&gt;\( {2n \choose n-1} \)&lt;/span&gt;. קיבלנו את התוצאה שחיפשנו.&lt;/p&gt;

&lt;p&gt;למסלולי שריג יש שם: &lt;strong&gt;מסלולי דיק&lt;/strong&gt; (Dyck), והם קשורים בצורה ישירה לסדרות של תווים שנקראות &lt;strong&gt;מילות דיק&lt;/strong&gt;. הרעיון במילת דיק, בהקשר הזה, הוא שזו מילה מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; שמורכבת משני תווים שכל אחד מופיע &lt;span&gt;\( n \)&lt;/span&gt; פעמים - אלו בדיוק ה-U,R אצלנו. הדרישה הנוספת, שתואמת את הדרישה שהמסלול לא יעבור מעל האלכסון, היא שבאף &lt;strong&gt;רישא&lt;/strong&gt; של המילה לא יהיו יותר U מאשר R-ים (רישא היא תת-מילה שמקבלים מכך שמתחילים מהאות הראשונה במילה, מתקדמים הלאה ועוצרים מתישהו). דרך אחרת לתאר מסלולי דיק היא אם מפרשים את U בתור “למטה וימינה” ואת R בתור “למעלה וימינה” ואז מקבלים מסלול מ-&lt;span&gt;\( \left(0,0\right) \)&lt;/span&gt; אל &lt;span&gt;\( \left(n,0\right) \)&lt;/span&gt; שלא יורד מתחת לציר &lt;span&gt;\( x \)&lt;/span&gt; בשום שלב. הנה ציור סכמטי של איך 14 המסלולים מאורך 4 נראים:
&lt;img src=&quot;/assets/img/2025/dyck_paths_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;דרך נחמדה אחת לחשוב על מילות דיק היא אם מפרשים את R בתור סוגריים שמאליים, כלומר הסימן “)”, ואת U בתור סוגריים ימניים, כלומר “(“. כשכותבים סוגריים, מקובל לפעמים לשים סוגריים בתוך סוגריים (אמנם, לא תמיד אבל זה די נפוץ (למשל פראצ’ט מאוד אהב התחכמויות כאלו (האמת שאני לא בטוח אם פראצ’ט השתמש בסוגריים בתוך סוגריים או בהערות שוליים בתוך הערות שוליים) והוא לא היחיד מסוגו) ולכן כשאני משתמש בזה כאן זה לא כזה חריג). כשכותבים משמאל לימין, כמו למשל במתמטיקה, הכלל הוא שסוגריים שמאליים פותחים קונטקסט חדש וסוגריים ימניים סוגרים את הקונטקסט הפתוח הנוכחי. אם ברישא כלשהי יהיו יותר סוגריים ימניים משמאליים, זה אומר שייסגרו יותר קונטקסטים מאשר נפתחו עד כה, וזה לא הגיוני - ולכן זה “אסור”. ובאמת, כשמנסים לנתח ביטוי שכולל סוגריים הרבה פעמים עושים בדיוק את הפירוק שראינו כאן - הולכים עד הפעם הראשונה שבה מספר הסוגריים הימניים משתווה לשמאליים, ומפרקים ל”מה שבין הסוגר הימני שבהתחלה והסוגר השמאלי שעכשיו, וכל מה שבא אחר כך”.&lt;/p&gt;

&lt;h2&gt;עצים&lt;/h2&gt;

&lt;p&gt;נראה לי שכבר הבנו את הרעיון - אני מציג משהו חדש שמתאים למספרי קטלן, קודם כל אני מראה תמונה של 14 האובייקטים שמתאימים לגודל 4, כלומר למקרה &lt;span&gt;\( C_{4}=14 \)&lt;/span&gt;:
&lt;img src=&quot;/assets/img/2025/binary_trees_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה שאנחנו רואים פה הוא &lt;strong&gt;עצים בינאריים&lt;/strong&gt; עם 4 צמתים. עצים בינאריים כאלו הם מקרה פרטי של &lt;strong&gt;גרף&lt;/strong&gt; - הרעיון בגרף הוא שיש לנו אוסף של נקודות שנקראות “צמתים” וקווים שמחברים אותם, שנקראים “קשתות”. הרעיון הכללי ב”עץ” הוא שזה גרף שבו יש צומת מיוחד - “השורש” - שאפשר להגיע ממנו לכל הצמתים האחרים בגרף. אנחנו אוהבים לצייר עצים כך שהשורש הוא הצומת העליון ביותר וה”כיוון” של העץ הוא כלפי מטה (אבל אם רוצים אפשר גם להגדיר שמותר לעלות למעלה בחזרה, מה שאומר שכל צומת הוא בעצם שורש, וזו לא בעיה). אם אנחנו משתמשים בקונבנציה הזו של “מלמעלה למטה” אז בסיטואציה שבה יש קשת מצומת א’ לצומת ב’ הנמוך יותר, אומרים שא’ הוא &lt;strong&gt;אבא&lt;/strong&gt; של ב’ ושב’ הוא &lt;strong&gt;ילד&lt;/strong&gt; של א’. הרעיון בעץ &lt;strong&gt;בינארי&lt;/strong&gt; הוא שלכל צומת יש לכל היותר שני בנים - ויותר מכך, יש ביניהם &lt;strong&gt;סדר&lt;/strong&gt;. יש בן ימני ובן שמאלי, וזה נשאר כך גם אם אחד מהבנים חסר. כלומר, לכל צומת יש ארבע אפשרויות: או שיש לו שני בנים, או שאין לו בנים, או שיש לו בן ימני או שיש לו בן שמאלי.&lt;/p&gt;

&lt;p&gt;עצים בינאריים הם מושג חשוב ומועיל במדעי המחשב - למשל, נוח לאחסן בהם נתונים בצורה שהופכת חיפושים ליעילים. אבל כאן אנחנו מתעניינים &lt;strong&gt;במספר&lt;/strong&gt; שלהם, וכצפוי התוצאה היא שמספר העצים הבינאריים עם &lt;span&gt;\( n \)&lt;/span&gt; צמתים הוא &lt;span&gt;\( C_{n} \)&lt;/span&gt;. גם פה קל לראות את זה בעזרת בניה רקורסיבית, ועצים הם אולי המקרה הטבעי ביותר שבו בניה כזו צצה; זה ממש נעוץ בהגדרה. אני מגדיר &lt;strong&gt;עץ בינארי&lt;/strong&gt; באופן הבא: עץ ריק (עם 0 צמתים) הוא עץ בינארי, ובהינתן שני עצים בינאריים &lt;span&gt;\( T_{1},T_{2} \)&lt;/span&gt; ניתן לבנות מהם עץ בינארי חדש על ידי הוספת צומת שורש חדש כך שאם יש ל-&lt;span&gt;\( T_{1} \)&lt;/span&gt; שורש, הוא הבן הימני של השורש החדש, ואם יש ל-&lt;span&gt;\( T_{2} \)&lt;/span&gt; שורש הוא הבן השמאלי של השורש החדש.&lt;/p&gt;

&lt;p&gt;עם ההגדרה הזו, מה קיבלנו? שמשני עצים אנחנו מקבלים עץ חדש &lt;strong&gt;על ידי הוספת צומת&lt;/strong&gt;. כלומר, אם קודם סכום הצמתים ב-&lt;span&gt;\( T_{1},T_{2} \)&lt;/span&gt; היה &lt;span&gt;\( n \)&lt;/span&gt;, בעץ החדש יש &lt;span&gt;\( n+1 \)&lt;/span&gt; צמתים. מכאן הנוסחה הרקורסיבית מגיעה מייד - והפעם הבניה הייתה סימטרית, להבדיל ממה שקרה עבור שילושים או מסלולי שריג.&lt;/p&gt;

&lt;p&gt;יופי, זה היה פשוט! בואו נעבור למשהו קצת יותר מוזר:
&lt;img src=&quot;/assets/img/2025/plane_trees_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה אנחנו רואים כאן? גם זה נראה כמו עצים, אבל לא בינאריים - יש צמתים עם יותר משני בנים. אלו גם לא עצים עם 4 צמתים אלא דווקא עם 5 צמתים, אז מה הקטע? עצים כאלו נקראים “עצים סדורים” (או plane trees ועוד כל מני שמות) וההסבר הכי פשוט מה הם הוא פשוט ההגדרה: עץ סדור הוא גרף שכולל צומת מיוחד שנקרא &lt;strong&gt;השורש&lt;/strong&gt; של העץ, ובנוסף יש רשימה &lt;span&gt;\( P_{1},\ldots,P_{n} \)&lt;/span&gt; (אולי ריקה) של עצים סדורים כך שלכל &lt;span&gt;\( i \)&lt;/span&gt; יש קשת מהשורש של העץ אל השורש של &lt;span&gt;\( P_{i} \)&lt;/span&gt;, והסדר בין הבנים של צומת הוא חשוב (כלומר, הרשימות &lt;span&gt;\( P_{1},P_{2} \)&lt;/span&gt; ו-&lt;span&gt;\( P_{2},P_{1} \)&lt;/span&gt; ייתנו עצים שונים אם &lt;span&gt;\( P_{1}\ne P_{2} \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;עבור עצים סדורים מתקיים שמספר העצים הסדורים עם &lt;span&gt;\( n+1 \)&lt;/span&gt; צמתים הוא &lt;span&gt;\( C_{n} \)&lt;/span&gt;, וזה מה שמודגם באיור. במבט ראשון זה קצת מפתיע - עץ סדור זו הגדרה יותר “חופשית” מעצים בינאריים, אז איך ייתכן שיש &lt;strong&gt;יותר&lt;/strong&gt; עצים בינארים מעצים סדורים? הרי בהינתן &lt;span&gt;\( n \)&lt;/span&gt; יש &lt;span&gt;\( C_{n} \)&lt;/span&gt; עצים בינאריים אבל רק &lt;span&gt;\( C_{n-1} \)&lt;/span&gt; עצים סדורים עם &lt;span&gt;\( n \)&lt;/span&gt; צמתים. העניין הוא שבעץ בינארי מקרים של בנים חסרים &lt;strong&gt;עדיין נספרים&lt;/strong&gt;. כמו שאמרתי קודם, אנחנו מבדילים בין המקרה שבו יש לצומת רק בן ימני והמקרה שיש לו רק בן שמאלי - ואת זה אין בעצים סדורים. אם יש רק בן יחיד לצומת, אז זה מקרה אחד שלא הולך להיספר פעמיים.&lt;/p&gt;

&lt;p&gt;טוב ויפה, אז איך מראים שעצים סדורים מקיימים את הנוסחה הרקורסיבית? ובכן… אה… אני לא יודע. עבורי זה מקרה מעניין בדיוק בגלל שעצים סדורים &lt;strong&gt;לא&lt;/strong&gt; נראים ממבט ראשון כמו משהו שקל להתאים לבניה רקורסיבית של שני חלקים. אני מניח שאם מתאמצים קצת אפשר למצוא דרך לקבל את הנוסחה הרקורסיבית גם כאן, אבל אני לא רוצה לעשות את זה כי יש התאמה חד-חד-ערכית ועל יפהפיה בין עצים בינאריים ועצים סדורים. בואו נראה דוגמא לאיך זה עובד, באדיבות הספר של Stanely:
&lt;img src=&quot;/assets/img/2025/trees_bijaction_diragram.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;בצד שמאל יש לנו עץ סדור ובצד ימין יש לנו את העץ הבינארי שמתאים לו, כשבמרכז יש לנו איזה שהוא “ייצוג ביניים” שמסביר איך מקבלים אחד מהשני. איך זה עובד? נתחיל מהעץ הסדור בצד השמאל ונבצע עליו את הפעולות הבאות:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;לכל צומת, נחבר כל בן של הצומת לבן הבא בתור של הצומת בקו מקוווקו.&lt;/li&gt;


&lt;li&gt;לכל צומת, נמחק את כל הקשתות ממנו לבנים שלו חוץ מאשר לבן השמאלי ביותר.&lt;/li&gt;


&lt;li&gt;נמחק את צומת השורש מהגרף.&lt;/li&gt;


&lt;li&gt;נהפוך את הקווים המקווקווים לקווים רגילים.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;במילים אחרות, כל צומת “איבד” את כל הבנים שלו חוץ מאחד, אבל “הרוויח” את אחד האחים שלו (אם יש כזה). הבנים של הצומת שנותקו לא הלכו לאיבוד כי כולם עדיין מחוברים אל הבן שלא נותק, והעץ בינארי כי עכשיו לכל צומת יש לכל היותר שני בנים: הבן השמאלי המקורי שלו (אם היו לו בנים) והאח שמימין לו (אם היה לו כזה).&lt;/p&gt;

&lt;p&gt;למה זו התאמה חח”ע ועל? כי אפשר &lt;strong&gt;להפוך&lt;/strong&gt; אותה, כלומר מכל עץ בינארי לקבל עץ סדור, ובצורה כזו שאם נתחיל מעץ סדור, נהפוך אותו לבינארי ואז חזרה לעץ סדור, אכן נחזור לעץ שהתחלנו ממנו. הנה השיטה:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;נוסיף לגרף צומת חדש שיהיה מחובר לבן שמאלי יחיד - השורש של הגרף המקורי.&lt;/li&gt;


&lt;li&gt;לכל צומת, אם יש לו בן ימני נהפוך את הקו שמחבר אותם למקווקו.&lt;/li&gt;


&lt;li&gt;לכל צומת &lt;span&gt;\( a \)&lt;/span&gt;, אם יש לו בן שמאלי &lt;span&gt;\( b \)&lt;/span&gt;, נלך ימינה על גבי הקווים המקווקווים החל מ-&lt;span&gt;\( b \)&lt;/span&gt; ונהפוך כל צומת שנפגוש בדרך לבן של הצומת &lt;span&gt;\( a \)&lt;/span&gt;, כשהסדר שלהם הוא כמו הסדר שבו פוגשים אותם על המסלול (&lt;span&gt;\( b \)&lt;/span&gt; נותר הבן הכי שמאלי).&lt;/li&gt;


&lt;li&gt;נמחק את הקווים המקווקווים מהגרף.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;קל לראות שזה באמת עובד - ובחיי שזו התאמה מרהיבה.&lt;/p&gt;

&lt;h2&gt;דברים שלא נחתכים&lt;/h2&gt;

&lt;p&gt;בואו נראה עוד תמונה של 14 דברים!
&lt;img src=&quot;/assets/img/2025/nonintersecting_chords_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה שיש לנו כאן הוא קבוצות של 8 נקודות &lt;strong&gt;על מעגל&lt;/strong&gt;. אני לא מצייר את המעגל כי הוא רק מקשה להבין מה קורה פה, אבל מכאן הנקודות מגיעות. חלק מהנקודות מחוברות בקווים שעוברים בתוך המעגל - &lt;strong&gt;מיתרים&lt;/strong&gt;. הפואנטה פה היא שאנחנו מחלקים את הנקודות לזוגות, ובין כל זוג מעבירים מיתר, כך שהמיתרים &lt;strong&gt;לא נחתכים&lt;/strong&gt;. עבור &lt;span&gt;\( n \)&lt;/span&gt; מיתרים שאנחנו מעבירים דרך &lt;span&gt;\( 2n \)&lt;/span&gt; נקודות נקבל &lt;span&gt;\( C_{n} \)&lt;/span&gt; אפשרויות שונות לעשות את זה.&lt;/p&gt;

&lt;p&gt;אם מנסים לפרמל את זה די מהר רואים דרך פשוטה לתאר סיטואציה של “היחתכות” בלי גאומטריה: אם אני אמספר את הנקודות על ידי &lt;span&gt;\( 1,2,\ldots,2n \)&lt;/span&gt;, אז המיתר &lt;span&gt;\( \left(a,b\right) \)&lt;/span&gt; חותך את המיתר &lt;span&gt;\( \left(c,d\right) \)&lt;/span&gt;, כאשר אני מניח בלי הגבלת הכלליות ש-&lt;span&gt;\( a&amp;lt;c \)&lt;/span&gt;, רק אם &lt;span&gt;\( c&amp;lt;b \)&lt;/span&gt; וגם &lt;span&gt;\( d&amp;gt;b \)&lt;/span&gt;. בניסוח שונה, אם אני אתאר את נקודות ההתחלה והסיום של אחד המיתרים עם סוגריים עגולים ושל מיתר אחר עם סוגריים מרובעים, אז הסיטואציה הבאה מובילה לחיתוך: &lt;span&gt;\( )[(] \)&lt;/span&gt;, וזאת להבדיל מ-&lt;span&gt;\( \left(\right)\left[\right] \)&lt;/span&gt; שהיא בסדר (זה &lt;span&gt;\( c&amp;gt;b \)&lt;/span&gt;) או &lt;span&gt;\( \left(\left[\right]\right) \)&lt;/span&gt; שהיא גם בסדר (זה &lt;span&gt;\( d&amp;lt;b \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;כדי להוכיח שזה שקול למשהו שאנחנו כבר מכירים, בואו נעבור לייצוג ביניים שהוא בעיה מעניינת בפני עצמה:
&lt;img src=&quot;/assets/img/2025/nonintersecting_arcs_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כאן אנחנו מציירים &lt;span&gt;\( 2n \)&lt;/span&gt; נקודות &lt;strong&gt;בשורה&lt;/strong&gt; ומחברים אותן בקשתות שלא נחתכות. זה באופן מובהק אותו הדבר בדיוק כמו הנקודות על המעגל, אבל הציור שונה (ולשם שינוי קשה לי לסדר אותו בשתי שורות של שבע פריטים כל אחת, כי כל שורת נקודות כזו היא די ארוכה).&lt;/p&gt;

&lt;p&gt;הרעיון הוא להתאים לכל סידור כזה מילת דיק, שאציג בתור סדרת סוגריים מאוזנת - כלומר, סדרה של אותו מספר של “)”{} ו-“(“ כך שבכל רישא אין יותר “(“ מאשר “)”. הנה איך זה עובד:
&lt;img src=&quot;/assets/img/2025/nonintersecting_arcs_example.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;הרעיון פשוט: לכל נקודה, אם היא &lt;strong&gt;הראשונה&lt;/strong&gt; בזוג שלה, שמים “)”{} ואם היא &lt;strong&gt;השניה&lt;/strong&gt; שמים “(“, כשהולכים משמאל לימין. מכיוון שיש לנו חלוקה של &lt;span&gt;\( 2n \)&lt;/span&gt; הנקודות ל-&lt;span&gt;\( n \)&lt;/span&gt; זוגות יהיו לנו בסך הכל &lt;span&gt;\( n \)&lt;/span&gt; מופעים של כל סוג סוגריים, אבל למה התנאי על הרישא מתקיים? זה די פשוט: בכל פעם שמופיע “(“ זה בגלל שהנקודה שמעליו &lt;strong&gt;היא השניה בזוג&lt;/strong&gt;, כלומר בשלב מוקדם יותר פגשנו את הנקודה הראשונה שהתאימה לה ואז כתבנו “)”. לכן ההתאמה עובדת - אנחנו תמיד מקבלים מילת דיק חוקית.&lt;/p&gt;

&lt;p&gt;כדי להשלים את ההתאמה צריך להסביר את הכיוון השני - איך בונים ממילת דיק התאמה כזו של נקודות לזוגות? גם זה קל: מעל כל אות במילת הדיק מציירים נקודה, ואז עוברים עליהן משמאל לימין. בכל פעם שבה נתקלים ב-“(“, מתחילים ללכת שמאלה שוב עד שמגיעים אל הנקודה הראשונה שטרם חוברה למישהו. היא בודאות תהיה מסומנת ב-“)”{} כי כאמור, בכל פעם שבה אנחנו נתקלים ב-“(“ אנחנו מייד מחברים את הנקודה שלו למישהו. התנאי על הרישות של מילות דיק מבטיח שתמיד נמצא &lt;strong&gt;מישהו&lt;/strong&gt; להתחבר אליו, ומכיוון שאנחנו תמיד מתחברים לנקודה הפנויה הראשונה שאנחנו מגיעים אליה לא יכולים להיווצר חיתוכים.&lt;/p&gt;

&lt;p&gt;כדי לראות את זה, בואו נחשוב שאני הנקודה &lt;span&gt;\( b \)&lt;/span&gt; ואני מתחיל ללכת שמאלה כדי לחפש מישהו להתחבר אליו עד שאני מוצא &lt;span&gt;\( a \)&lt;/span&gt; פנוי. עכשיו, האם ייתכן שיש נקודות &lt;span&gt;\( c,d \)&lt;/span&gt; כך ש-&lt;span&gt;\( a&amp;lt;c&amp;lt;b&amp;lt;d \)&lt;/span&gt;? לא! כי אם &lt;span&gt;\( c \)&lt;/span&gt; מחוברת ל-&lt;span&gt;\( d \)&lt;/span&gt; זה אומר שבזמן ש-&lt;span&gt;\( d \)&lt;/span&gt; חיפש אל מי להתחבר, &lt;span&gt;\( c \)&lt;/span&gt; הייתה &lt;strong&gt;פנויה&lt;/strong&gt;, אבל אם זה היה המצב - למה &lt;span&gt;\( b \)&lt;/span&gt; לא התחברה אליה אלא המשיכה עד &lt;span&gt;\( a \)&lt;/span&gt;? אוקיי, אז &lt;span&gt;\( a&amp;lt;c&amp;lt;b&amp;lt;d \)&lt;/span&gt; הוא בלתי אפשרי. מה בדבר &lt;span&gt;\( c&amp;lt;a&amp;lt;d&amp;lt;b \)&lt;/span&gt;? במקרה הזה, מאותו שיקול, &lt;span&gt;\( d \)&lt;/span&gt; לא הייתה יכולה להיות מחוברת אל &lt;span&gt;\( c \)&lt;/span&gt; כי היא הייתה מתחברת אל &lt;span&gt;\( a \)&lt;/span&gt; לפני כן. זה מסיים את ההוכחה.&lt;/p&gt;

&lt;h2&gt;מגדלי קפלר&lt;/h2&gt;

&lt;p&gt;שמרתי לסוף את הדבר הכי חדש והכי מוזר: מגדלי קפלר.
&lt;img src=&quot;/assets/img/2025/kepler_towers_4.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה הולך כאן? כרגע זה בעיקר מזכיר לי את הסמל של ערוץ 1 העתיק, אבל חלק מהעניין הוא שבמקרה הזה, המגדלים מגודל 4 הם קטנים מדי מכדי שאפשר יהיה להסביר בצורה טובה את ההגדרה הכללית, אז אלך על דוגמא מורכבת יותר. המגדלים הוצגו במאמר Three Catalan Bijections של דונלד קנות’ שמספר שהם הומצאו בפברואר 2005 (חדשים!) על ידי Xavier Viennot שנתן להם את שמם. למה “קפלר”? קנות’ מסביר שזה בגלל שהדיאגרמה של מגדל קפלר (כמו אלו שרואים למעלה) מזכירה את מודל מערכת השמש של קפלר.
&lt;img src=&quot;/assets/img/2025/kepler_tower_example.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כדי לעזור להבין את הדוגמא הזו אני כבר אספר שאפשר לתאר מגדל קפלר בצורה פשוטה גם בתור רשימה של רשימות של רשימות של מספרים - פשוט! במקרה שלנו, המגדל הוא &lt;span&gt;\( T=\left(W_{1},W_{2},W_{3}\right) \)&lt;/span&gt; כאשר &lt;span&gt;\( W_{1}=\left[\left(1\right),\left(2\right),\left(3\right)\right] \)&lt;/span&gt; ו-&lt;span&gt;\( W_{2}=\left[\left(1,3\right),\left(4\right),\left(1,3\right)\right] \)&lt;/span&gt; ו-&lt;span&gt;\( W_{3}=\left[\left(1,3,5,7\right),\left(1,4,7\right),\left(3,8\right),\left(2,4,7\right),\left(1,7\right)\right] \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, כפי שאפשר לראות מהתמונה, מגדל קפלר מורכב מאוסף של מעגלים. כל מעגל כזה מכונה &lt;strong&gt;טבעת&lt;/strong&gt; (Ring) ואפשר לראות שיש בכל טבעת קשתות שחורות בולטות. הקשתות הללו מכונות &lt;strong&gt;לבנים&lt;/strong&gt; (Bricks) והן מה שאנחנו סופרים: יש בדיוק &lt;span&gt;\( C_{n} \)&lt;/span&gt; מגדלי קפלר עם &lt;span&gt;\( n \)&lt;/span&gt; לבנים.&lt;/p&gt;

&lt;p&gt;עכשיו, אפשר גם לראות שהטבעות מאוגדות בקבוצות, עם רווחים גדולים שמסמנים מתי קבוצה אחת נגמרת והבאה בתור מתחילה. כל קבוצה כזו מכונה &lt;strong&gt;חומה&lt;/strong&gt; (Wall). האינטואיציה הציורית שלנו יכולה להיות זו: חומה היא הדבר הרגיל שאנחנו חושבים עליו - אוסף של לבנים שמונחות בשכבות אחת מעל השניה. במקרה הזה השכבות הן מעגליות, וכל שכבה מכונה “טבעת” ומכילה כמה “לבנים”. קנות’ מציע לנו לחשוב על הלבנים כאילו הן עשויות מלגו, כך שאפשר “להדביק” לבנים זו לזו, כך שכדי שלבנה לא תיפול מספיק שתהיה מתחתיה לבנה במקום כלשהו, אפילו אם מרכז המסה שלה בולט החוצה.&lt;/p&gt;

&lt;p&gt;בואו נעבור לדבר על זה קצת יותר פורמלי. בצורת הרישום &lt;span&gt;\( T=\left(W_{1},W_{2},\ldots,W_{m}\right) \)&lt;/span&gt; כל &lt;span&gt;\( W_{k} \)&lt;/span&gt; כזה הוא חומה, וכל חומה היא מהצורה &lt;span&gt;\( W_{k}=\left(R_{1}^{k},R_{2}^{k},\ldots,R_{t_{k}}^{k}\right) \)&lt;/span&gt;, כלומר כל חומה היא רשימה של טבעות, ובחומות שונות יכולים להיות מספרים שונים של טבעות. המוסכמה היא שאנחנו מתחילים מהמרכז ומתקדמים החוצה - כלומר, החומה הראשונה היא זו שהכי פנימית, והטבעת הראשונה בכל חומה היא זו שהכי פנימית וכן הלאה.&lt;/p&gt;

&lt;p&gt;עכשיו, מה יש בכל טבעת? כאן העניינים מתחילים להסתבך. קונספטואלית, אנחנו מחלקים את המעגל לחלקים, וכל טבעת מכילה לבנים שהן חלק מהחלקים הללו. השאלה &lt;strong&gt;לכמה&lt;/strong&gt; חלקים מחלקים את המעגל תלויה במספר החומה הנוכחי. בחומה הראשונה, כל המעגלים מחולקים ל-2 חלקים. בחומה השניה הם מחולקים ל-4 חלקים; בשלישית ל-8 וכן הלאה עם חזקות של 2. בניסוח פורמלי, &lt;span&gt;\( R_{i}^{k}\subseteq\left[2^{k}\right] \)&lt;/span&gt;, כאשר הסימון &lt;span&gt;\( \left[n\right] \)&lt;/span&gt; הוא סימון סטנדרטי ל-&lt;span&gt;\( \left\{ 1,2,3,\ldots,n\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, החוק שמגדיר את מגדלי קפלר קובע שבכל חומה, הטבעת הראשונה תמיד מכילה בדיוק את כל הלבנים האי-זוגיות, כלומר &lt;span&gt;\( R_{1}^{k}=\left\{ 1,3,5,\ldots,2^{k}-1\right\}  \)&lt;/span&gt;. כל טבעת אחרת יכולה להכיל איזה מספרים שרוצים, אבל יש &lt;strong&gt;שתי מגבלות&lt;/strong&gt;. כדי להבין איך הן נראות באופן ציורי, תעיפו לרגע מבט בציור - אפשר לראות שאני מצייר לבנים לא בתור בדיוק חצי עיגול, רבע עיגול וכו’ אלא &lt;strong&gt;קצת יותר מזה&lt;/strong&gt;, כאילו הוספתי צ’ופצ’יקים בקצוות. זה אומר שאם היו לי שתי לבנים סמוכות באותה טבעת הן היו עולות אחת על השניה &lt;strong&gt;וזה אסור&lt;/strong&gt;. זה גם אומר שאם יש לי בטבעת אחת לבנה במקום &lt;span&gt;\( x \)&lt;/span&gt; ובטבעת שלפניה לבנה במקום &lt;span&gt;\( x+1 \)&lt;/span&gt; או &lt;span&gt;\( x-1 \)&lt;/span&gt;, זה נראה שהן עולות אחת על השניה. אז הנה החוקים:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;אסור שבאותה טבעת יהיו שתי לבנים שעולות זו על זו. כלומר, אם &lt;span&gt;\( x\in R_{i}^{k} \)&lt;/span&gt; אז &lt;span&gt;\( x-1,x+1\notin R_{i}^{k} \)&lt;/span&gt;, כאשר פעולות החשבון הן מודולו &lt;span&gt;\( 2^{k} \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;אם בטבעת שאיננה הראשונה בחומה יש לבנה כלשהי, היא חייבת להישען על לבנה בטבעת שלפניה. כלומר, אם &lt;span&gt;\( x\in R_{i+1}^{k} \)&lt;/span&gt; &lt;span&gt;\( x\in R_{i}^{k} \)&lt;/span&gt; או &lt;span&gt;\( x-1\in R_{i}^{k} \)&lt;/span&gt; או &lt;span&gt;\( x+1\in R_{i}^{k} \)&lt;/span&gt; כששוב, החשבון הוא מודולו &lt;span&gt;\( 2^{k} \)&lt;/span&gt;.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;זהו, זו כל ההגדרה! טיפה מסובך, אבל אין קושי עקרוני לכתוב קוד שבודק אם רשימה של רשימות של רשימות של מספרים הוא מגדל קפלר חוקי, או קוד שיודע לייצר את כל המגדלים עם &lt;span&gt;\( n \)&lt;/span&gt; לבנים (בצורה לא יעילה) וכדומה.&lt;/p&gt;

&lt;p&gt;מה שקנות’ עושה במאמר שלו הוא להראות התאמה חח”ע ועל מפורשת בין מגדלי קפלר עם &lt;span&gt;\( n \)&lt;/span&gt; לבנים ומסלולי דיק מאורך &lt;span&gt;\( 2n \)&lt;/span&gt;, ואני רוצה להציג את זה כאן, אם כי בצורה טיפה שונה ממה שקנות’ עושה. פישוט אחד שהוא לא קריטי אבל בהחלט יעזור לקוד שאני אציג להיות קצת פחות מסורבל הוא לשנות את איך שממספרים לבנים: במקום שהלבנים בקיר ה-&lt;span&gt;\( k \)&lt;/span&gt; יהיו &lt;span&gt;\( \left\{ 1,2,3,\ldots,2^{k}\right\}  \)&lt;/span&gt; אני אסמן אותן ב-&lt;span&gt;\( \left\{ 0,1,2,3,\ldots,2^{k}-1\right\}  \)&lt;/span&gt;. זה נוח, כי כשלוקחים דברים מודולו &lt;span&gt;\( 2^{k} \)&lt;/span&gt; מקבלים מספרים בקבוצה הזו; אם היינו מסתכלים על הקבוצה מ-&lt;span&gt;\( 1 \)&lt;/span&gt; עד &lt;span&gt;\( 2^{k} \)&lt;/span&gt; היינו צריכים טיפה לשנות את איך שעושים מודולו, וזה סתם מסרבל.&lt;/p&gt;

&lt;p&gt;הרעיון המבריק של קנות’ הולך ככה: אנחנו מסתכלים על מסלול דיק מאורך &lt;span&gt;\( 2n \)&lt;/span&gt;. אפשר לחשוב על מסלול כזה בתור סדרה של U ו-D כך ש-U הוא צעד למעלה-ימינה ו-D הוא צעד למטה-ימינה, והמסלול מתחיל בגובה 0, מסיים בגובה 0 ולא יורד מתחת לגובה 0 בשום שלב. הרעיון של קנות’ הוא עכשיו לשים “גבולות” - בגובה 1, בגובה 3, בגובה 7 וכן הלאה - בגובה &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt; לכל &lt;span&gt;\( k\ge0 \)&lt;/span&gt;. כעת, חומה מספר &lt;span&gt;\( k \)&lt;/span&gt; תיבנה על פי בסיס החלק של המסלול שמתחיל עם ההגעה הראשונה לגבול &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt; ומסתיים עם ההגעה הראשונה לגבול &lt;span&gt;\( 2^{k+1}-1 \)&lt;/span&gt;, או מסתיים בסוף המסלול אם לא מגיעים לגובה הזה.&lt;/p&gt;

&lt;p&gt;בואו נראה דוגמא:
&lt;img src=&quot;/assets/img/2025/dyck_split.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מה שיש כאן הוא המסלול שמתאים למחרוזת הבאה:&lt;/p&gt;

&lt;p&gt;UUDUDUDDUUUDUDDUUDDDUDUDUUUUUDUUUDDDUDDDUUDUUDDDDD&lt;/p&gt;

&lt;p&gt;צבעתי את המסלול בשלושה צבעים - החלק הראשון בכחול, השני בירוק והשלישי באדום. הרעיון הוא שנשתמש בכל המסלול כדי לבנות מגדל קפלר: החומה הראשונה תיבנה על בסיס החלק הכחול, החומה השניה על בסיס החלק הירוק והשלישית על בסיס החלק האדום. מתי חלק מתחיל? החל מהפעם הראשונה שבה המסלול מגיע לקו הגבול שלו, ומרגע זה והלאה המסלול הקודם נזנח לאנחות. אפשר לראות שבאיור, הצעד הראשון צבוע בשחור - זה בגלל שעדיין לא הגענו אפילו לקו הגבול הראשון ולכן עוד לא התחלנו לבנות את החומות (אבל הצעד הראשון הוא תמיד למעלה ולכן תמיד נתחיל לבנות את החומה הראשונה מייד אחריו).&lt;/p&gt;

&lt;p&gt;הרעיון עכשיו הוא זה: בחומה מס’ &lt;span&gt;\( k \)&lt;/span&gt; יכולות להופיע לבנים שממוספרות ב-&lt;span&gt;\( 0,1,\ldots,2^{k}-1 \)&lt;/span&gt;, כלומר, מספרים שהם החל מ-0 וכלה בגובה של הגבול שהגעה אליו התחילה את המסלול שלנו. כפי שרואים טוב עם המסלול הירוק, המסלול יכול להיות &lt;strong&gt;מעל&lt;/strong&gt; הגבול, וגם &lt;strong&gt;מתחת&lt;/strong&gt; לגבול. בשני המקרים הללו העקרון הוא - אם המסלול ביצע צעד &lt;strong&gt;לכיוון הגבול&lt;/strong&gt;, אז הצעד הזה יתורגם להוספת לבנה לחומה; אחרת הוא לא ישפיע על המגדל שאותו בונים. כך למשל במסלול הירוק, הצעד הראשון הוא &lt;strong&gt;למטה&lt;/strong&gt; והוא מתרחק מהגבול, ולכן הצעד הזה &lt;strong&gt;לא&lt;/strong&gt; יוסיף לבנה למגדל; אבל הצד השני הוא &lt;strong&gt;למעלה&lt;/strong&gt; ומתקרב אל הגבול (ואפילו מגיע אליו) ולכן הוא כן יוסיף לבנה למגדל.&lt;/p&gt;

&lt;p&gt;איזו לבנה הולכים להוסיף? זה תלוי &lt;strong&gt;בגובה&lt;/strong&gt; של המקום שהגענו אליו אחרי הצעד. אם היינו &lt;strong&gt;מתחת&lt;/strong&gt; לגבול וביצענו צעד למעלה, אז נוסיף את הלבנה שהמספר שלה הוא כמו הגובה של המסלול. אם היינו &lt;strong&gt;מעל&lt;/strong&gt; הגבול וביצענו צעד אחד למטה, אז נוסיף את הלבנה שהמספר שלה הוא כמו הגובה של המסלול &lt;strong&gt;מעל הגבול&lt;/strong&gt;, כלומר אם הגבול הוא 3 ואנחנו בגובה 5, אז נוסיף את לבנה 2. ככה זה נראה בדוגמא שלנו:
&lt;img src=&quot;/assets/img/2025/dyck_split_with_nums.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;למשל, ה-0-ים בהתחלה מגיעים מכך שהקו הכחול שוב ושוב &lt;strong&gt;יורד&lt;/strong&gt; אל הגבול. אחר כך הוא חוצה אותו כלפי מטה ואז &lt;strong&gt;עולה&lt;/strong&gt; שוב - ולכן הפעם זה נספר בתור הגעה לגובה 1. או למשל, בחלק של הירוק שבו הוא מתחיל לעלות ולעלות הוא בהתחלה מוסיף את הלבנים 1,2,3 ואז פתאום מפסיק למרות שהעלייה נמשכת - למה? כי הוא חצה את קו הגבול 3, ומרגע שהוא חוצה אותו, לבנים חדשות מתווספות כשהוא &lt;strong&gt;יורד&lt;/strong&gt;, לא כשהוא עולה.&lt;/p&gt;

&lt;p&gt;מה בעצם הרעיון כאן? תסתכלו על המסלול הכחול: אסור לו לרדת מתחת ל-0 (כי כל מסלול דיק מקיים את זה) ו”אסור” לו להגיע אל 3 (כי בפעם הראשונה שבה הוא יגיע אל 3 הוא יהפוך להיות מסלול שונה, המסלול הירוק), כך שכל “מרחב התמרון” שלו הוא פס צר סביב קו הגבול 1: הוא יכול להיות ב-0,1,2 ולכן הלבנים שהוא יכול להוסיף &lt;strong&gt;מתחת&lt;/strong&gt; לגבול הן 0 ו-1 (הגבהים האפשריים שלו מתחת לגבול, עד שמגיעים אליו) והלבנים שהוא יכול להוסיף &lt;strong&gt;מעל&lt;/strong&gt; לגבול הן גם כן 0,1 (הגבהים שלו מעל הגבול הזה). כלומר, “מרחב התמרון” של המסלול הכחול מאפשר לו רק להוסיף לבנים עם המספר 0,1 ואלו &lt;strong&gt;בדיוק&lt;/strong&gt; הלבנים שיכולות להופיע בחומה הראשונה במגדל.&lt;/p&gt;

&lt;p&gt;המסלול השני, הירוק, מקבל מרחב תמרון רחב יותר ויכול להוסיף את הלבנים &lt;span&gt;\( 0,1,2,3 \)&lt;/span&gt; שהן בדיוק מה שיכול להופיע בחומה השניה במגדל, וכן הלאה.&lt;/p&gt;

&lt;p&gt;עכשיו, אפשר לשאול - בשביל מה זה טוב, שיש גם חלק &lt;strong&gt;מעל&lt;/strong&gt; וגם חלק &lt;strong&gt;מתחת&lt;/strong&gt; לקו הגבול, אם הם מייצרים את אותן לבנים בדיוק? ובכן, זה כל היופי פה: זה מאפשר למסלול ליצור לבנים &lt;strong&gt;כשהוא רוצה&lt;/strong&gt;. תראו למשל את הסיום של המסלול האדום - הוא &lt;strong&gt;חייב&lt;/strong&gt; לסיים בכך שהוא יורד עד 0, אבל מרגע שהוא מתחת לקו הגבול, עוד ירידה לא תוסיף לבנים - אז הצורך לרדת עד הסוף לא מכריח את המסלול להוסיף לבנים למגדל שהוא בונה. זה נותן לנו בדיוק את הגמישות שאנחנו צריכים כאן.&lt;/p&gt;

&lt;p&gt;אם כן, טוב ויפה, אבל מה זה בעצם אומר, “להוסיף לבנה”? איך בוחרים לאיזו טבעת להוסיף אותה? ובכן, זה קל: פשוט זורקים אותה ורואים מה קורה.&lt;/p&gt;

&lt;p&gt;בואו ניזכר איך חומה בנויה. ברגע שמתחילים חומה חדשה, כי המסלול הגיע לגובה מתאים חדש ושינה צבע, אוטומטית יוצרים חומה חדשה עם טבעת ראשונה שכוללת את כל המספרים שהטבעת הראשונה חייבת לכלול. כלומר, כשמגיעים לראשונה לגובה &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt; יוצרים חומה חדשה עם הטבעת &lt;span&gt;\( \left\{ 0,2,4,\ldots,2^{k}-2\right\}  \)&lt;/span&gt;. זה עדיין לא החלק של “להוסיף לבנים למגדל”, זה פשוט יוצר לנו את החומה הבסיסית שהמסלול יבנה מעליה.&lt;/p&gt;

&lt;p&gt;עכשיו, אם המסלול רוצה להוסיף את הלבנה &lt;span&gt;\( s \)&lt;/span&gt; למגדל, אנחנו עוברים על הטבעות במגדל מהעליונה ביותר אל התחתונה. לכל טבעת כזו, אם &lt;span&gt;\( s \)&lt;/span&gt; או &lt;span&gt;\( s+1 \)&lt;/span&gt; או &lt;span&gt;\( s-1 \)&lt;/span&gt; (מודולו &lt;span&gt;\( 2^{k} \)&lt;/span&gt;) נמצאות בה - “נתקענו” - אי אפשר להכניס את הלבנה לטבעת הזו (היא תתנגש באחת מהלבנים הללו) וגם אי אפשר לדחוף אותה דרכן אל טבעת נמוכה יותר כי הן חוסמות את הדרך (זו הצורה שבה כדאי לחשוב על זה כי זה נותן אינטואיציה למה הוספת לבנה מתנהגת כפי שהיא מתנהגת; הסיבה &lt;strong&gt;האמיתית&lt;/strong&gt; להתנהגות הזו היא כי ככה הבניה עובדת). אם אף אחת מהלבנים הללו לא נמצאת בטבעת, אפשר לעבור לטבעת הבאה בתור, הנמוכה יותר, ולראות אם גם שם אפשר להתקדם או שנתקעים. בסופו של דבר מוסיף את הלבנה החדשה לטבעת הנמוכה ביותר שמצאנו שאפשר להוסיף את &lt;span&gt;\( s \)&lt;/span&gt; אליה - או, אם לא הייתה כזו, פותחים טבעת חדשה שכוללת רק את &lt;span&gt;\( s \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;זהו, זו כל הבניה! הנה קוד פייתון שעושה את הכל ואני מקווה שברור וחף מבאגים:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# new ring
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
     
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generate_kepler_tower_from_dyck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_border&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;add_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;add_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;new_wall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;השאלה הראשונה שאנחנו צריכים לשאול את עצמנו היא אם הבניה הזו באמת נותנת מגדל קפלר, אבל ברור שהיא עושה את זה כי כללי הוספת הלבנים שלנו מבטיחים שתמיד יהיה לנו מגדל חוקי - אנחנו מוסיף במפורש את הטבעת הראשונה בכל חומה, וכשאנחנו מוסיפים לבנה אנחנו מקפידים שהיא תיכנס למקום שבו מותר לה להיות, ובטבעת שמתחתיה היא כבר לא יכולה להיכנס כי יש שם לבנה &lt;strong&gt;שעליה היא יכולה להישען&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;שאלה קצת יותר טריקית היא למה מסלול מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; נותן מגדל קפלר עם בדיוק &lt;span&gt;\( n \)&lt;/span&gt; לבנים. בדוגמא שראינו למעלה, המסלול שלי היה מאורך 50, כלומר &lt;span&gt;\( n=25 \)&lt;/span&gt;. אם סופרים את הלבנים שהמסלולים מוסיפים (המספרים שמתחת למסלולים, באיור השני) מגיעים ל-18. איפה הלבנים החסרות? ובכן, בטבעת הראשונה בכל חומה. יש לנו שלוש חומות. בחומה הראשונה הטבעת הראשונה היא &lt;span&gt;\( \left\{ 0\right\}  \)&lt;/span&gt;, בשניה היא &lt;span&gt;\( \left\{ 0,2\right\}  \)&lt;/span&gt; ובשלישית היא &lt;span&gt;\( \left\{ 0,2,4,6\right\}  \)&lt;/span&gt;. בסך הכל קיבלנו את שבע הלבנים החסרות - אבל איך בדיוק אנחנו יודעים שזה לא הסתדר בפוקס?&lt;/p&gt;

&lt;p&gt;בואו נדמיין לרגע שהמסלול שלנו כולו מאותו צבע. במסלול הזה, בכל פעם שאנחנו מבצעים צעד “למעלה”, יהיה אי שם בהמשך צעד “למטה” שיקזז אותו, כי בסוף אנחנו חוזרים אל 0. אני אחדד: אם היה לנו צעד “למעלה” שהעלה אותנו מגובה &lt;span&gt;\( h \)&lt;/span&gt; אל גובה &lt;span&gt;\( h+1 \)&lt;/span&gt;, יהיה צעד “למטה” שיוריד אותנו מגובה &lt;span&gt;\( h+1 \)&lt;/span&gt; אל גובה &lt;span&gt;\( h \)&lt;/span&gt;. עכשיו, אם הצעדים הללו התבצעו &lt;strong&gt;מתחת לגבול&lt;/strong&gt; אז צעד ה”למעלה” הוסיף לבנה וצעד ה”למטה” לא הוסיף; ואם הם התבצעו &lt;strong&gt;מעל לגבול&lt;/strong&gt; אז צעד ה”למטה” הוסיף וצעד ה”למעלה” לא הוסיף. בשני המקרים בדיוק חצי מהצעדים שלנו הוסיפו לבנה.&lt;/p&gt;

&lt;p&gt;אם נסתכל על האיור שבדוגמא, קל להיזכר שיש חריג - הצעד הראשון, שהוא צעד “למעלה” אל הגבול אבל הוא לא מוסיף לבנה, כי בשלב הזה המסלול הכחול עוד לא קיים. זה מתקזז עם העובדה שכשהגענו לגבול, יצרנו חומה חדשה עם טבעת ראשונה &lt;span&gt;\( \left\{ 0\right\}  \)&lt;/span&gt;. זה גם מה שהולך לקרות &lt;strong&gt;באופן כללי&lt;/strong&gt; כשיש לנו מסלול שמשנה צבע: כשהמסלול הירוק הגיע לגובה 7 ושינה את הצבע שלו, מה שקרה הוא שנוצרו אצלו צעדים שקודם &lt;strong&gt;לא הוסיפו&lt;/strong&gt; לבנים אבל עכשיו יתקזזו עם עוד צעדים ש&lt;strong&gt;לא יוסיפו&lt;/strong&gt; לבנים: הצעדים החל מהגבול ומעלה, כלומר &lt;span&gt;\( 3\to4\to5\to6\to7 \)&lt;/span&gt;. ארבעה צעדים שעכשיו כשיתבצעו בכיוון ההפוך גם כן לא יוסיפו לבנים - אבל עכשיו מתקזזים עם העובדה שהמסלול האדום נפתח עם הוספת הטבעת &lt;span&gt;\( \left\{ 0,2,4,6\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;זה קורה גם באופן כללי: אם היה לנו מסלול סביב קו הגבול &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt; והוא הגיע אל &lt;span&gt;\( 2^{k+1}-1 \)&lt;/span&gt; אז “איבדנו” את כל הצעדים &lt;span&gt;\( 2^{k}-1\to2^{k}\to\ldots\to2^{k+1}-1 \)&lt;/span&gt;, כלומר &lt;span&gt;\( 2^{k} \)&lt;/span&gt; צעדים; אבל אז אנחנו יוצרים קיר חדש שבטבעת הראשונה שלו יש את &lt;span&gt;\( \left\{ 0,2,\ldots,2^{k+1}-2\right\}  \)&lt;/span&gt;, כלומר בדיוק &lt;span&gt;\( 2^{k} \)&lt;/span&gt; הלבנים שהיו חסרות לנו.&lt;/p&gt;

&lt;p&gt;זה מוכיח שקיבלנו פונקציה ממסלולי דיק מאורך &lt;span&gt;\( 2n \)&lt;/span&gt; אל מגדלי קפלר מגודל &lt;span&gt;\( n \)&lt;/span&gt;. כדי להראות שהיא חח”ע ועל, צריך להסביר איך להפוך אותה.&lt;/p&gt;

&lt;p&gt;הרעיון הוא די פשוט: בהינתן מגדל קפלר, נבנה את המסלול שיוצר אותו “מהסוף להתחלה”, על ידי כך שנפרק לאט ובזהירות את החומות של המגדל. אם נעקוב אחרי הגובה הנוכחי של המסלול, נוכל לראות שבהינתן הגובה הזה והמצב הנוכחי של המגדל, יש בדיוק אפשרות אחת למצב של המגדל והגובה של המסלול בצעד הקודם שהביאו אותנו לכאן.&lt;/p&gt;

&lt;p&gt;בואו נחזור למסלול שראינו קודם. כשמייצרים ממנו מגדל קפלר, מקבלים את זה:
&lt;img src=&quot;/assets/img/2025/kepler_tower_from_dyck.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;אנחנו רוצים להבין איך אפשר לקבל ממנו בחזרה את המסלול הזה:
&lt;img src=&quot;/assets/img/2025/dyck_split.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כאמור - אני ארכיב את המסלול מהסוף להתחלה. בשביל זה צריך לדעת בכל רגע נתון מה קו הגבול הנוכחי, שקובע איזו לבנה מוסיפים למגדל. עבור המסלול האדום קו הגבול הזה הוא ב-7. איך אפשר לדעת את זה רק מהסתכלות על מגדל הקפלר שלנו? אנחנו סופרים כמה &lt;strong&gt;חומות&lt;/strong&gt; יש בו - כאן יש שלוש, מה שאומר שהחומה החיצונית ביותר, זו שאנחנו מתחילים מלפרק אותה, זו שתיתן את המסלול האדום - מורכבת מהלבנים &lt;span&gt;\( \left\{ 0,1,2,\ldots,2^{3}-1\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, אנחנו זוכרים בכל רגע נתון מה הגובה הנוכחי של המסלול שאנחנו משחזרים מהסוף להתחלה, ומה המצב הנוכחי של המגדל (שאמור להיות תואם את המצב של המגדל כשהוא נבנה על ידי המסלול המקורי עד שהוא מגיע בדיוק אל הנקודה בשחזור שבה אנחנו נמצאים). אנחנו מתחילים מגובה 0. אם אני בגובה 0, מה היה הצעד הקודם? זה היה &lt;strong&gt;חייב&lt;/strong&gt; להיות צעד D כי אם זה היה צעד U, והצעד הזה הביא אותי לגובה 0, זה אומר שקודם הייתי בגובה &lt;span&gt;\( -1 \)&lt;/span&gt; וזה בלתי אפשרי. באופן דומה, אם במהלך הבניה של המסלול האדום הייתי איכשהו מטפס עד לגובה 14, הייתי יודע שהצעד הקודם היה חייב להיות U, כי צעד D היה אומר שקודם הייתי בגובה 15 &lt;strong&gt;וזה היה יוצר מסלול חדש&lt;/strong&gt;, עם חומה חדשה - יותר חומות מאשר יש במגדל. אז אלו שני מקרי הקיצון שבהם אנחנו יודעים בדיוק מה חייב לקרות אפילו בלי לבדוק מה הולך עם הלבנים שבתוך המגדל שלנו - ובשני המקרים הללו, הצעדים שעושים הם &lt;strong&gt;לכיוון&lt;/strong&gt; קו הגבול שבאמצע ולכן לא מוסיפים לבנים, ולכן אין לי מה &lt;strong&gt;להסיר&lt;/strong&gt; לבנים מהמגדל שאני מפרק.&lt;/p&gt;

&lt;p&gt;יש עוד אפשרויות. אם אני בגובה &lt;span&gt;\( s \)&lt;/span&gt; שהוא 1 לפחות אבל עדיין מתחת לקו האמצע, יכלתי להגיע לגובה הזו או בפעולת D שלא הייתה מוסיפה לבנה למגדל, או בפעולת U שכן הייתה מוסיפה - והיא הייתה מוסיפה בדיוק את הלבנה &lt;span&gt;\( s \)&lt;/span&gt;, כי זה מה שקורה כשאנחנו מתחת לקו האמצע, אנחנו מוסיפים לבנה ששווה לגובה שהגענו אליו &lt;strong&gt;אחרי&lt;/strong&gt; ביצוע הצעד. אז אנחנו מנסים להסיר מהמגדל שלנו את הלבנה &lt;span&gt;\( s \)&lt;/span&gt;, כלומר בודקים אם היא נמצאת בחומה הנוכחית, במיקום שבו אין לבנים אחרות שיושבות עליה, באחת מהטבעות &lt;strong&gt;מעל&lt;/strong&gt; הטבעת הראשונה (הטבעת הראשונה כזכור נבנית בצורה שונה). אם היא שם, אנחנו מסירים אותה ומסמנים שבוצע צעד U, ואחרת פשוט מסמנים שבוצע צעד D, ומעדכנים את הגובה שלנו בהתאם (אם בוצע צעד U אנחנו &lt;strong&gt;מקטינים&lt;/strong&gt; את הגובה, כי הרי אנחנו רוצים לדעת באיזה גובה היינו &lt;strong&gt;קודם&lt;/strong&gt;). באופן דומה מטפלים גם במקרה שבו אנחנו מעל קו האמצע.&lt;/p&gt;

&lt;p&gt;המקרה הכי בעייתי הוא זה שהוא אנחנו נמצאים &lt;strong&gt;בדיוק&lt;/strong&gt; על קו האמצע. במקרה הזה יש שתי אפשרויות שונות להגעה לשם, ששתיהן מוסיפות לבנה למגדל - או עלייה למעלה שמוסיפה את הלבנה &lt;span&gt;\( 2^{k}-1 \)&lt;/span&gt;, או ירידה למטה שמוסיפה את הלבנה 0. אז מנסים לחלץ מהמגדל את שתי הלבנים הללו ורואים איזו מהן הצליחה. ברור ש&lt;strong&gt;רק אחת&lt;/strong&gt; היא אפשרית, כי שתי הלבנים הללו הן שכנות ולכן מתנגשות אחת עם השניה ולא יכולות להיות באותה טבעת, ולכן אם הן נמצאות במגדל, אחת נמצאת גבוה יותר והיא זו שתקבע לנו איזה מהלך אנחנו משחזרים. אבל למה בעצם שאחת משתיהן תהיה במגדל? אי אפשר להנדס מגדלים שבהם זה לא קורה? זה הטיעון הכי עדין כאן: אפשר להראות שאלא אם החומה התרוקנה למעט הטבעת הראשונה, זה לא יכול לקרות כי &lt;strong&gt;בדרך&lt;/strong&gt; אל קו האמצע הזה היינו מרוקנים מהחומה כל לבנה שלא תקועה - חוץ מאשר הלבנים &lt;span&gt;\( 0,2^{k-1} \)&lt;/span&gt; שאפשר להוציא רק כשמגיעים לאמצע, וכל לבנה אחרת שאי אפשר להוציא כי אחת משתי הלבנים הללו חוסמת אותה. זה טיעון קצת מעצבן להוכחה פורמלית אבל הוא עובד; כל מה שנשאר לעשות הוא לדבר על מה שקורה כשמגיעים לאמצע כשהחומה ריקה חוץ מהטבעת הראשונה, וברור מה עושים בשלב הזה - מעיפים את החומה ומתחילים לשחזר את המסלול מהצבע הבא (כלומר, הקודם).&lt;/p&gt;

&lt;p&gt;הנה קוד (חף מבאגים, אני מקווה - היו בו כל כך הרבה בהתחלה!) שעושה את זה:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# we are trying to understand if it&apos;s possible that s was the latest brick added to the tower
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# for this, it&apos;s not enough that it&apos;s IN the tower, the way for it must be clear, meaning no s+1 and no s-1 in the way
&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# print(f&quot;Trying to remove brick {s} from wall {wall}, num_segments={num_segments}&quot;)
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;reversed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# skip the first ring, it&apos;s not touched by add_brick()
&lt;/span&gt;        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# if the ring is empty, remove it
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generate_dyck_from_kepler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deepcopy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# we&apos;re going to remove bricks
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# go over the walls from last to first
&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# continue until wall is empty except the first ring
&lt;/span&gt;            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# we&apos;re near the next border. we can&apos;t reach it, otherwise the tower would have had more walls
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# we&apos;re at the bottom, we can&apos;t go down anymore
&lt;/span&gt;                &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# if s_down is in the tower, we made a &quot;down&quot; move, else nothing
&lt;/span&gt;                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# if s_up is in the tower, we made an &quot;up&quot; move, else nothing
&lt;/span&gt;                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# we reached the border either by &quot;down&quot; from above, and then s_down is in the tower, or by &quot;up&quot; from below, and then s_up is in the tower
&lt;/span&gt;                &lt;span class=&quot;c1&quot;&gt;# they can&apos;t both be in the tower since in this case, s_down = 1 and s_up = current_border + 1, which are adjacent (modulo current_border + 1)
&lt;/span&gt;                &lt;span class=&quot;c1&quot;&gt;# print(&quot;height == current_border, so we are at the border, trying to remove bricks&quot;, s_down, s_up)
&lt;/span&gt;                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_border&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remove_brick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;This should not happen&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# first step is always U
&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;reversed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;זה מסיים את הסיפור מבחינתי, אבל מספרי קטלן לא נגמרים שם - הספר של Stanely עמוס בשלל דוגמאות אחרות (אם כי חייבים להודות שרובן הן פשוט וריאציות עם כל מני מגבלות ופרמטרים על אותה בעיה), אבל שולי הפוסט הזה כבר צרים מלהכילן.&lt;/p&gt;</content><author><name></name></author><category term="מספרי קטלן" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">אז למה 1=…0.999?</title><link href="http://gadial.net/2025/03/15/why_0999_equals_1/" rel="alternate" type="text/html" title="אז למה 1=...0.999?" /><published>2025-03-15T00:00:00+00:00</published><updated>2025-03-15T00:00:00+00:00</updated><id>http://gadial.net/2025/03/15/why_0999_equals_1</id><content type="html" xml:base="http://gadial.net/2025/03/15/why_0999_equals_1/">&lt;h2&gt;פרק א&apos;, ובו אני מנסה להשתמש בשוויון מוזר כדי לשכנע שיש על מה לדבר פה&lt;/h2&gt;

&lt;p&gt;בראשית ימי הבלוג היה לי &lt;a href=&quot;https://gadial.net/2008/06/07/almost_1_is_one/&quot;&gt;פוסט&lt;/a&gt; על הויכוח המפואר סביב השוויון &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt;. באותם ימים עוד ניסיתי לקצר ולכן הפוסט לא עמד בפני עצמו אלא היה תלוי ב&lt;a href=&quot;https://gadial.net/2008/06/17/infinite_series/&quot;&gt;פוסט ההמשך&lt;/a&gt; שלו ואיכשהו יצא שאני לא הכי מרוצה משניהם ולכן בואו נדבר שוב על השוויון המוזר הזה, בתקווה ברמת העמקה גדולה יותר מאשר אז.&lt;/p&gt;

&lt;p&gt;מבחינה מתמטית &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; הוא שוויון פשוט, כמעט טריוויאלי, אבל איכשהו יוצא שכל כמה זמן אני נתקל בעוד דיון סביבו שבו נזרקים לחלל האוויר הרבה טיעונים למה השוויון הזה לא נכון, חלקם יפים מאוד, שאף אחד מהם לא באמת יכול לעבוד כי כולם מפספסים את ההגדרות שבבסיס הדיון - וחלק מהעניין הוא שאלו אכן הגדרות לא טריוויאליות שאין סיבה שאנשים לא מתמטיים לא יכירו (אבל! למה שלאנשים לא מתמטיים תהיה דעה מוצקה על &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt;?).&lt;/p&gt;

&lt;p&gt;אוהבים לומר, למשל, ש-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא “המספר הכי קרוב ל-1 שאינו 1”, או ש-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא “תהליך” אבל לא מספר, וכו’. אלו, כאמור, רעיונות יפים - אולי אפילו יפים &lt;strong&gt;מדי&lt;/strong&gt; כי הם מכניסים למתמטיקה עוד תוכן שלא באמת יש בה. בפועל &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא לא תהליך אלא מספר ממשי תמים, שמיוצג בייצוג עשרוני כמו כל המספרים הממשיים, ופשוט בגלל איזה צ’ופצ’יק מוזר של שיטת הייצוג העשרוני של מספרים יוצא שלחלק מהמספרים (להמון, כפי שעוד נראה) יש שני ייצוגים שונים.&lt;/p&gt;

&lt;p&gt;ובכן, הדרך להסביר מדוע השוויון נכון היא לצלול לנבכי הייצוג העשרו… רגע, רגע, רגע, אני לא בטוח שלהפיל עלינו הגדרות שהן לא לגמרי טריוויאליות זה הדבר הנכון לעשות. בואו קודם נתחיל מההוכחה ה”קלאסית” שאוהבים להראות לטענה הזו.&lt;/p&gt;

&lt;p&gt;הרעיון הוא זה: ראשית נסמן &lt;span&gt;\( x=0.999\ldots \)&lt;/span&gt; ואז נעשה על המשוואה הזו סדרה של מניפולציות די פשוטות, שמוכרות לכל מי שהיה צריך לפתור משוואות בבית הספר:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;span&gt;\( x=0.999\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 10x=9.999\ldots \)&lt;/span&gt; (כפלנו ב-10 את שני האגפים)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 10x-x=9.999\ldots-0.999\ldots \)&lt;/span&gt; (החסרנו &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; משני האגפים)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 9x=9 \)&lt;/span&gt; (חישבנו את תוצאת פעולת החיסור באגפים ימין ושמאל)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( x=1 \)&lt;/span&gt; (חילקנו את שני האגפים ב-9)&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;ההוכחה הזו פחות מעניינת אותי בתור משהו שבאמת ישכנע אנשים ש-&lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; (למרות שאני מניח שיש כאלו שמשתכנעים) ויותר בגלל שלל הסיבות שבעטיין היא &lt;strong&gt;לא&lt;/strong&gt; תשכנע אנשים. ראשית, כל העסק קצת מרגיש כמו רמאות או הוכחה מעגלית כי מתחילים עם &lt;span&gt;\( x \)&lt;/span&gt; שווה משהו ומסיימים עם &lt;span&gt;\( x \)&lt;/span&gt; שווה משהו אחר (לכאורה) ולכן האינטואיציה שלנו זועקת שרימו אותנו איפה שהוא. אבל איפה? הפעולות של לכפול את שני האגפים של משוואה באותו מספר, או לחבר לשני האגפים אותו מספר אכן משמרות את המשוואה לשני הכיוונים בדרך כלל. כלומר, אם &lt;span&gt;\( A,B \)&lt;/span&gt; הם ביטויים כלשהם ו-&lt;span&gt;\( a \)&lt;/span&gt; הוא מספר כלשהו, אז אני יכול לומר ש-&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( A=B \)&lt;/span&gt; אם ורק אם &lt;span&gt;\( A+a=B+a \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;ואם &lt;span&gt;\( a\ne0 \)&lt;/span&gt; אפשר גם לומר ש-&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( A=B \)&lt;/span&gt; אם ורק אם &lt;span&gt;\( aA=aB \)&lt;/span&gt;.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;עבור &lt;span&gt;\( a=0 \)&lt;/span&gt; זה נשבר, כי בהחלט ייתכן ש-&lt;span&gt;\( A\ne B \)&lt;/span&gt; אבל &lt;span&gt;\( aA=aB \)&lt;/span&gt;, למשל &lt;span&gt;\( 3\ne5 \)&lt;/span&gt; אבל &lt;span&gt;\( 0\cdot3=0=0\cdot5 \)&lt;/span&gt;. עם זאת, בהוכחה שהצגתי לא היה שום דבר כזה - כפלנו ב-10 וחילקנו ב-9, כש”לחלק ב-9” בעצם אומר לכפול ב-&lt;span&gt;\( \frac{1}{9} \)&lt;/span&gt;. אז מהבחינה הזו ההוכחה תקינה. המקומות שבהם היא קצת יותר חשודה הן כשאנחנו מניחים איך פעולות החשבון מתנהגות על &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt;, כלומר כשאני עושה&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( 10\cdot0.999\ldots=9.999\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 9.999\ldots-0.999\ldots=9 \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;עכשיו, חשוב לי להדגיש ששני אלו &lt;strong&gt;נכונים&lt;/strong&gt;, והם גם אינטואיטיביים למדי כי אני עושה כאן דברים שמוכרים לכל מי שעושה חשבון עם מספרים בייצוג עשרוני. אבל &lt;strong&gt;למה&lt;/strong&gt; הם נכונים? כדי לראות את זה כן צריך להיכנס אל מה זו ההגדרה של ייצוג עשרוני בכלל. אבל לפני שנדבר על מה זה כן ייצוג עשרוני, בואו נדבר על מה זה לא. דרך נפוצה לנסות לשכנע ש-&lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; היא להסתכל על ההפרש, &lt;span&gt;\( 1-0.999\ldots \)&lt;/span&gt;, ולשאול מה הוא יוצא - איך אפשר לקבל כאן משהו גדול מ-0? ותשובה נפוצה לזה היא שההפרש שווה &lt;span&gt;\( 0.000\ldots1 \)&lt;/span&gt;. כלומר - סדרה אינסופית של אפסים עם 1 בסוף שלה.&lt;/p&gt;

&lt;p&gt;זה רעיון ממש ממש נחמד, ובאופן כללי הקטע הזה של “לאינסוף… ומעבר לו!” הוא בעל מקום של כבוד במתמטיקה מאז ימי קנטור &lt;a href=&quot;https://gadial.net/2011/05/25/ordinals_overview/&quot;&gt;ויש לי פוסט על זה&lt;/a&gt;. רק מה, בהקשר הספציפי שעליו אנחנו מדברים כאן - המספרים הממשיים והייצוגים העשרוניים שלהם - זה פשוט לא רלוונטי. אין מספר ממשי כזה, &lt;span&gt;\( 0.000\ldots1 \)&lt;/span&gt;. הרעיון בייצוג עשרוני הוא שיש לנו אינסוף ספרות אחרי הנקודה בלי שיבואו עוד ספרות “אחרי זה”. אנחנו פשוט לא יודעים מה תהיה המשמעות של מספר כזה.&lt;/p&gt;

&lt;p&gt;כדי שזה לא יישמע כמו סתם איסור שרירותי, צריך לענות על השאלה הבסיסית - מה זה ייצוג עשרוני בכלל?&lt;/p&gt;

&lt;h2&gt;פרק ב&apos;, ובו אני מנסה להשתמש בחזון יוחנן כדי לשכנע שהשיטה העשרונית היא סבבה&lt;/h2&gt;

&lt;p&gt;אחד הקטעים ההזויים בחזון יוחנן בברית החדשה מדבר על משהו שנקרא “החיה” שהיא או מטאפורה מחוכמת לרומא של נירון קיסר או תוצר של דמיון פעיל יותר מדי, ואחד מהדברים שנאמרים שם על “החיה” הוא שמספרה הוא 666. כתוצאה מכך חזרה של שלוש פעמים על הספרה 6 נכנסה לתרבות שלנו בתור ייצוג פופולרי של דברים שטניים - והאמת, אני יכול להבין למה. יש אסתטיקה גדולה מאוד בחזרה הזו על 6 שלוש פעמים, ביחד עם המקור המיסטי של המספר. העניין הוא שאם נפתח את חזון יוחנן כדי לראות מה הלך שם במקור לא נמצא את 666 בשום מקום. חזון יוחנן נכתב במקור ביוונית במאה הראשונה לספירה, עוד לפני שהספרה 6 הייתה קיימת בכלל - ועוד יותר מכך, לפני שהשיטה שמשתמשת בספרה 6 - השיטה ההודית-ערבית - הייתה קיימת בכלל. מה שמופיע בחזון יוחנן הוא המספר &lt;strong&gt;שש מאות שישים ושש&lt;/strong&gt; שנכתב בשיטה היוונית (שדומה לשיטה העברית - אותיות שונות מייצגות מספרים שונים, כולל עשרות ומאות) בתור χξϛ. זה… די מאכזב! כל האסתטיקה היפה של חזרתיות על 6 הלכה לאיבוד, וזה די מרתק להבין שהאסתטיקה הזו פשוט נוצרה במקרה, באופן ממוזל.&lt;/p&gt;

&lt;p&gt;כשאנחנו כותבים 666, לכל אחת מהספרות יש משמעות שונה. ה-6 השמאלית ביותר אומרת “שש מאות”. ה-6 האמצעית אומרת “שישים” וה-6 הימנית אומרת “שש”. בשיטה היוונית χ הוא “שש מאות”, ξ הוא “שישים” ו–ϛ הוא “שש”. כלומר, בשיטה העשרונית קורה איזה שהוא קסם שמאפשר לנו לחסוך בסימונים - אותו סימון בדיוק, 6, מאפשר לנו לתאר שלושה מספרים שונים שבשיטה היוונית נזקקו לשלוש אותיות שונות בשבילם. הקסם הזה נובע מכך שבשיטה העשרונית המשמעות של ספרה נובעת &lt;strong&gt;מהמיקום&lt;/strong&gt; שלה בתוך המספר. זה רעיון יפהפה ומועיל, שאנחנו רגילים אליו עוד מילדות ולכן מפספסים לפעמים את זה שהוא לא טריוויאלי (אבל זה לא רעיון &lt;strong&gt;חדש&lt;/strong&gt;; כבר הבבלים לפני 4,000 שנים השתמשו בשיטת ספירה דומה, אם כי לא עשרונית).&lt;/p&gt;

&lt;p&gt;בואו נעזוב את 666 ונעבור למספר עם ספרות שונות: 42, “ארבעים ושתיים”. כאן 4 היא ספרת &lt;strong&gt;העשרות&lt;/strong&gt; ואילו 2 היא ספרת &lt;strong&gt;האחדות&lt;/strong&gt;. כלומר, מה שאנחנו רואים פה הוא שהספרה הימנית ביותר אומרת כמה אחדות (1) אנחנו לוקחים והספרה השניה אומרת כמה עשרות (10) אנחנו לוקחים. אם נוסיף עוד ספרות מצד שמאל, הם יתאימו למאות (100) ולאלפים (1000) וכן הלאה - למספרים שהם &lt;strong&gt;חזקות של &lt;/strong&gt;&lt;strong&gt;10&lt;/strong&gt;. החשיבות של 10 כאן היא שנותנת לשיטה ה&lt;strong&gt;עשר&lt;/strong&gt;ונית את שמה; בתיאוריה היה אפשר לעשות את אותו דבר גם עם חזקות של 2, או של 16, או של 60, אבל זה היה מרגיש לנו פחות טבעי (כל השיטות הללו קיימות בפועל). אז למשל, מספר כמו 473 מייצג את התרגיל החשבוני “ארבע כפול מאה ועוד שבע כפול עשר ועוד 3 כפול אחד”, כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 473=4\times100+7\times10+3\times1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;או, אם רוצים להדגיש שכופלים בחזקות של 10, אפשר לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 473=4\times10^{2}+7\times10^{1}+3\times10^{0} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://gadial.net/2018/01/01/zero_power_equals_one/&quot;&gt;יש לי פוסט&lt;/a&gt; שמסביר למה דברים בחזקת 0 הם 1, כלומר למה כאן &lt;span&gt;\( 10^{0} \)&lt;/span&gt; מתאר את 1).&lt;/p&gt;

&lt;p&gt;עד כאן אני מקווה שהכל פשוט. מתי הסיפור מסתבך? כשרוצים לתאר ככה גם &lt;strong&gt;שברים&lt;/strong&gt;. כאן פתאום כותבים נקודה (“הנקודה העשרונית”) וכותבים ספרות מצד ימין שלה. למשל, “שמונה וחצי” נכתב כך: &lt;span&gt;\( 8.5 \)&lt;/span&gt;. למה? את ה-8 אני מבין, אבל למה “חצי” נכתב על ידי 5? ובכן, זה אותו עיקרון בדיוק של “כפל בחזקות של 10”, רק שהפעם אנחנו עוברים לכפול בחזקות &lt;strong&gt;שליליות&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;מה זה אומר, חזקה שלילית? למשל, &lt;span&gt;\( 10^{-1}=\frac{1}{10} \)&lt;/span&gt; ו-&lt;span&gt;\( 10^{-3}=\frac{1}{10^{3}}=\frac{1}{1000} \)&lt;/span&gt; וכן הלאה. בצורה הכללית ביותר, &lt;span&gt;\( a^{-n}=\frac{1}{a^{n}} \)&lt;/span&gt;, כלומר חזקה שלילית זה פשוט לחלק את 1 בחזקה הרגילה של אותו המספר. אז ב-&lt;span&gt;\( 8.5 \)&lt;/span&gt; יש לנו את 8 כפול &lt;span&gt;\( 10^{0} \)&lt;/span&gt; ואז את 5 כפול &lt;span&gt;\( 10^{-1} \)&lt;/span&gt;, כלומר &lt;span&gt;\( 5\times10^{-1}=\frac{5}{10}=\frac{1}{2} \)&lt;/span&gt;. במילים אחרות, 5 מימין לנקודה העשרונית מתאר “חצי” כי 5 הוא חצי מ-10. באופן דומה &lt;span&gt;\( 0.25 \)&lt;/span&gt; הוא “רבע” כי &lt;span&gt;\( 25 \)&lt;/span&gt; הוא רבע מ-100; התרגיל המדויק שמבצעים כאן הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0.25=2\times\frac{1}{10}+5\times\frac{1}{100}=\frac{2}{10}+\frac{5}{100}=\frac{20+5}{100}=\frac{25}{100}=\frac{1}{4} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;טוב ויפה, ראינו איך מייצגים את חצי ואת רבע. מה עם מי שביניהם, כלומר שליש? זה מספר פשוט, ויש לו תיאור פשוט בתור שבר: &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt;. איך מתארים אותו בייצוג עשרוני? ובכן, אה… הנה הבשורות הלא נעימות. מייצגים אותו ככה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{3}=0.333\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, הספרה 3 חוזרת על עצמה שוב ושוב עד אינסוף. &lt;strong&gt;אינסוף&lt;/strong&gt;. אנחנו צריכים אינסוף ספרות כדי לייצג משהו פשוט כמו &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt;. לא, נאמר, מספר משוגע כמו &lt;span&gt;\( \pi \)&lt;/span&gt; שאומרים עליו שהוא “אי רציונלי” ו”טרנסנדנטי” ויש פרויקטים שלמים כדי לחשב את הספרות שלו אחרי הנקודה. לא, גם עבור &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt; אנחנו צריכים אינסוף ספרות - אם כי במקרה שלו זה מאוד קל לדעת מהן; הן פשוט הספרה 3 שחוזרת על עצמה שוב ושוב עד אינסוף.&lt;/p&gt;

&lt;p&gt;אני רוצה להוכיח לעצמנו שזה חייב להיות ככה. שאי אפשר להסתפק במספר סופי של ספרות. זו תהיה הוכחה קצרה אז אם היא מבלבלת אפשר פשוט לדלג עליה. הרעיון הוא זה: אם, למשל, היו מספיקות לנו שתי ספרות אחרי הנקודה כדי לייצג את שליש, זה אומר שהיינו מקבלים &lt;span&gt;\( \frac{1}{3}=\frac{x}{100} \)&lt;/span&gt;כש-&lt;span&gt;\( x \)&lt;/span&gt; הוא מספר טבעי כלשהו בין 0 ל-99 (כמו שעבור רבע ראינו ש-&lt;span&gt;\( x=25 \)&lt;/span&gt; עושה את העבודה). עכשיו, אם נכפול את שני האגפים ב-100 נקבל &lt;span&gt;\( x=\frac{100}{3} \)&lt;/span&gt;, אבל זו הבעיה - 100 לא מתחלק ב-3. וגם 1000 לא מתחלק ב-3 אז לא יעזרו לנו לקחת 3 ספרות במקום 2, ובאופן כללי אף מספר מהצורה &lt;span&gt;\( 100\ldots0 \)&lt;/span&gt; לא מתחלק ב-3 (דרך פשוטה לראות את זה: סכום הספרות שלהם הוא 1, שלא מתחלק ב-3). וזה לא רק עניין של 3, זה עניין של רוב המספרים: עבור שבר כללי, &lt;span&gt;\( \frac{a}{b} \)&lt;/span&gt;, אם &lt;span&gt;\( \frac{a}{b}=\frac{x}{10^{n}} \)&lt;/span&gt; אז זה אומר ש-&lt;span&gt;\( x=\frac{10^{n}}{b}a \)&lt;/span&gt;. עכשיו, אם נבחר להציג את השבר בצורה כזו ש-&lt;span&gt;\( a,b \)&lt;/span&gt; הם &lt;strong&gt;זרים&lt;/strong&gt; (אין להם גורם משותף) - מה שנקרא “שבר מצומצם”, אז הדרך היחידה שבה &lt;span&gt;\( x \)&lt;/span&gt; יהיה מספר שלם היא אם &lt;span&gt;\( \frac{10^{n}}{b} \)&lt;/span&gt; הוא שלם, כלומר &lt;span&gt;\( b \)&lt;/span&gt; חייב לחלק את &lt;span&gt;\( 10^{n} \)&lt;/span&gt;. אבל מי בכלל יכול לחלק את &lt;span&gt;\( 10^{n} \)&lt;/span&gt;? מכיוון שהפירוק לראשוניים של 10 הוא &lt;span&gt;\( 10=2\cdot5 \)&lt;/span&gt; אז כדי שמישהו יחלק חזקה של 10 הוא חייב שגם הגורמים הראשוניים שלו יהיו או 2 או 5 או שילוב שלהם. כל גורם ראשוני אחר יהרוס לנו.&lt;/p&gt;

&lt;p&gt;גם אם לא עקבתם אחרי כל זה, המסקנה היא פשוטה: שברים שיש להם ייצוג עשרוני &lt;strong&gt;סופי&lt;/strong&gt; כמו &lt;span&gt;\( \frac{1}{2}=0.5 \)&lt;/span&gt; או &lt;span&gt;\( \frac{1}{4}=0.25 \)&lt;/span&gt; או &lt;span&gt;\( \frac{1}{5}=0.2 \)&lt;/span&gt; או &lt;span&gt;\( \frac{1}{8}=0.125 \)&lt;/span&gt; הם המקרה &lt;strong&gt;הנדיר&lt;/strong&gt;. כל שבר מהצורה &lt;span&gt;\( \frac{1}{n} \)&lt;/span&gt; כש-&lt;span&gt;\( n \)&lt;/span&gt; מתחלק במשהו שהוא לא 2 או 5 יהיה בהכרח אינסופי. כלומר, הקטע הזה של שימוש באינסוף ספרות לא נולד כי בא לנו להריץ קטעים מוזרים עם אינסוף, אלא כי אנחנו &lt;strong&gt;חייבים.&lt;/strong&gt; כי בלי זה אין לנו שיטה עשרונית לייצוג שברים.&lt;/p&gt;

&lt;h2&gt;פרק ג&apos;, ובו אני מנסה להשתמש באכילס כדי לשכנע שכדאי להסתכל על הסכום ולא רק על מה שיש בו&lt;/h2&gt;

&lt;p&gt;אני רוצה שנבין למה &lt;span&gt;\( 0.333\ldots=\frac{1}{3} \)&lt;/span&gt;. זו דוגמא יותר טובה מ-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; כי בניגוד ל-1 שיש לנו ייצוג עשרוני פשוט שלו ואנחנו &lt;strong&gt;לא צריכים&lt;/strong&gt; את &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt;, ל-&lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt; כאמור אין כזה. וכמו כן, אם השתכנענו ש-&lt;span&gt;\( 0.333\ldots=\frac{1}{3} \)&lt;/span&gt; אז בואו פשוט נכפול את שני האגפים ב-3 ונקבל &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; וסיימנו! (זה עדיין לא מספיק טוב, כי צריך להסביר למה &lt;span&gt;\( 0.333\ldots \)&lt;/span&gt; כפול 3 הוא &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;מבחינת הגדרה יבשה, כבר ראינו שייצוג עשרוני הוא סכום של חזקות של 10 כשהן מוכפלות בערכים של הספרות. ההבדל היחיד הוא שעכשיו יש לנו אינסוף ספרות ולכן סכום אינסופי - הסכום הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0.333\ldots=\frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אנחנו לא יודעים מה זה אומר, לחבר אינסוף איברים. חיבור זה משהו שאנחנו מכירים בתור פעולה &lt;strong&gt;בינארית&lt;/strong&gt; שמפעילים על שני מספרים. מכאן אפשר להכליל: חיבור של שלושה מספרים הוא מה שמקבלים כשמחברים את שני המספרים הראשונים, ומחברים את השלישי לתוצאת החיבור של שני הראשונים. וחיבור של ארבעה הוא לחבר את הרביעי לתוצאה של חיבור שלושת הראשונים וכן הלאה וכן הלאה - אבל זה רק אומר לנו איך לחבר &lt;strong&gt;מספר סופי&lt;/strong&gt; כלשהו של איברים, לא אינסוף.&lt;/p&gt;

&lt;p&gt;עם זאת, זו התחלה טובה. אם אנחנו יודעים לחבר מספר סופי כלשהו של איברים, אז כשיש לנו סכום אינסופי נוכל להסתכל מה מקבלים מכך שמחברים רק את האיבר הראשון, רק את שני הראשונים, רק את שלושת הראשונים וכן הלאה - מקבלים &lt;strong&gt;סדרה&lt;/strong&gt; אינסופית, שנקראת “סדרת הסכומים החלקיים” של הסכום האינסופי (סכום חלקי, כי חיברנו רק חלק מהאיברים). עבור &lt;span&gt;\( \frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots \)&lt;/span&gt; נקבל את הסדרה הבאה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{3}{10},\frac{33}{100},\frac{333}{1000},\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו עדיין סדרה אינסופית אבל הסיטואציה הזו פשוטה קצת יותר כי אין לנו עכשיו חיבור של המון איברים. השאלה היא מה עושים עם הסדרה שקיבלנו, והתשובה של המתמטיקאים היא - בודקים אם יש לסדרה הזו &lt;strong&gt;גבול&lt;/strong&gt;, והכוונה היא לא ל”גבול” יומיומי אלא למושג מתמטי ספציפי, טכני ומרכזי מאוד, שדומה למושג האינטואיבי אבל מורכב יותר ממנו.&lt;/p&gt;

&lt;p&gt;בשביל המושג הזה, בואו נסתכל על עוד דוגמא מפורסמת - מה שנקרא &lt;strong&gt;פרדוקס הדיכוטומיה&lt;/strong&gt; מבין הפרדוקסים של זנון. אני אציג גרסה של הפרדוקס שטיפה שונה מאיך שהוא מופיע, נאמר, אצל אריסטו - נניח שהגיבור היווני אכילס ניצב בתחילת מסלול ריצה של קילומטר אחד ומתחיל לרוץ - מתי הוא יגיע לצד השני? על פי זנון יש פה בעיה: לפני שהוא מגיע לצד השני, כלומר אל הנקודה &lt;span&gt;\( 1 \)&lt;/span&gt;, הוא אמור להגיע לחצי מהדרך. אוקיי, יופי, אז הוא הגיע אל הנקודה &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt;, מה עכשיו? לפני שיגיע לצד השני הוא עדיין צריך לעבור חצי מהדרך &lt;strong&gt;שנשארה&lt;/strong&gt;, כלומר להגיע אל הנקודה &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}=\frac{3}{4} \)&lt;/span&gt;. גם זה לוקח לו זמן. אוקיי, יופי, הגיע אל &lt;span&gt;\( \frac{3}{4} \)&lt;/span&gt;. עכשיו כדי להגיע לצד השני הוא צריך לעבור חצי מהדרך שנשארה, כלומר &lt;span&gt;\( \frac{3}{4}+\frac{1}{8}=\frac{7}{8} \)&lt;/span&gt;, וכן הלאה וכן הלאה. כלומר, אם אנחנו מנסים להבין מה המרחק שאכילס חייב לעבור כדי להגיע אל הצד השני אנחנו רואים שזה הסכום &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\frac{1}{16}+\ldots \)&lt;/span&gt; (בניסוח המקורי של הפרדוקס מנסים להפעיל את טיעון ה”חצי” הזה על תחילת המסלול כדי לטעון שאכילס לא יכול להתחיל לרוץ בכלל, אבל אז לא מקבלים סכום אינסופי נחמד כמו פה).&lt;/p&gt;

&lt;p&gt;במקור, פרדוקס הדיכוטומיה ניסה להדגים שתנועה היא &lt;strong&gt;בלתי אפשרית&lt;/strong&gt; על ידי הטרלה של הקונספט, אבל אפשר לנצל אותו בשביל הדבר ההפוך. הרי אנחנו יודעים שאכילס &lt;strong&gt;כן יגיע&lt;/strong&gt; לקצה המסלול, כלומר הוא כן יעבור מרחק של 1, והוא יעשה את זה אפילו אם אני אציג בצורה חכמה את המרחק שהוא צריך לעבור בתור סכום אינסופי &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\frac{1}{16}+\ldots \)&lt;/span&gt;, ולכן האינטואיציה שלי היא שצריך להיות קיים מובן מתמטי שבו &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\frac{1}{16}+\ldots=1 \)&lt;/span&gt;, ובאמת יש למתמטיקאים מובן כזה. בשבילו הם מסתכלים על מה שקראתי לו “סדרת הסכומים החלקיים” של הסכום הזה: ראינו קודם שזו סדרה שמתחילה עם &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; ואחר כך &lt;span&gt;\( \frac{3}{4} \)&lt;/span&gt; ואחר כך &lt;span&gt;\( \frac{7}{8} \)&lt;/span&gt; וכן הלאה. מצליחים לראות את החוקיות? בכל פעם יש במכנה חזקה של 2, ובמונה יש את אותה החזקה פחות 1, כלומר הסכום החלקי ה”כללי” הוא &lt;span&gt;\( \frac{2^{n}-1}{2^{n}} \)&lt;/span&gt;, או בניסוח אחר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{2^{n}-1}{2^{n}}=\frac{2^{n}}{2^{n}}-\frac{1}{2^{n}}=1-\frac{1}{2^{n}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בשלב ה-&lt;span&gt;\( n \)&lt;/span&gt; אכילס &lt;strong&gt;כמעט&lt;/strong&gt; הגיע אל &lt;span&gt;\( 1 \)&lt;/span&gt;, נשאר לו רק מרחק זעום של &lt;span&gt;\( \frac{1}{2^{n}} \)&lt;/span&gt; לעבור, והמרחק הזה רק הולך וקטן עוד ועוד. זה מוביל את המתמטיקאים להגיד ש-1 הוא &lt;strong&gt;הגבול&lt;/strong&gt; של הסדרה &lt;span&gt;\( a_{n}=1-\frac{1}{2^{n}} \)&lt;/span&gt;. ההגדרה הכללית של “גבול” היא לא פשוטה כי היא מנסה (ומצליחה) לכסות כל מני מקרים מטרילים הרבה יותר מהנוכחי, אבל בגרסה פשוטה שלה שמתאימה למקרה הזה, היא אומרת את הדבר הבא: 1 הוא הגבול של הסדרה &lt;span&gt;\( 1-\frac{1}{2^{n}} \)&lt;/span&gt; אם ההפרש שלהן (שהוא &lt;span&gt;\( \frac{1}{2^{n}} \)&lt;/span&gt; כאמור) &lt;strong&gt;שואף לאפס&lt;/strong&gt; כש”שואף לאפס” פה אומר שלא משנה כמה קטן ההפרש צריך להיות, אם נתקדם מספיק בסדרה מתישהו הוא יהפוך לקטן כזה. קצת יותר פורמלית: אם &lt;span&gt;\( \varepsilon&amp;gt;0 \)&lt;/span&gt; הוא מספר ממשי כלשהו, אז קיים בסדרה &lt;span&gt;\( n \)&lt;/span&gt; כך ש-&lt;span&gt;\( a_{n}&amp;lt;\varepsilon \)&lt;/span&gt;, כלומר &lt;span&gt;\( \frac{1}{2^{n}}&amp;lt;\varepsilon \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;איך מוכיחים את זה? חשבון טכני שהוא לא מסובך במיוחד: במשוואה &lt;span&gt;\( \frac{1}{2^{n}}&amp;lt;\varepsilon \)&lt;/span&gt; המשתנה שאנחנו רוצים לבודד הוא &lt;span&gt;\( n \)&lt;/span&gt;, אז קודם כל נכפול את המשוואה ב-&lt;span&gt;\( 2^{n} \)&lt;/span&gt; ונחלק אותה ב-&lt;span&gt;\( \varepsilon \)&lt;/span&gt; ונקבל שצריך להתקיים &lt;span&gt;\( 2^{n}&amp;gt;\frac{1}{\varepsilon} \)&lt;/span&gt;. אחר כך, כדי להוריד את &lt;span&gt;\( n \)&lt;/span&gt; מהמעריך של החזקה, מפעילים &lt;strong&gt;לוגריתם&lt;/strong&gt; על שני האגפים - במקרה הזה, לוגריתם על בסיס 2, מה שאוהבים לסמן בתור &lt;span&gt;\( \lg \)&lt;/span&gt;. הרעיון בלוגריתם כזה הוא שמתקיים &lt;span&gt;\( \lg\left(2^{n}\right)=n \)&lt;/span&gt; - זו ממש ההגדרה - ומצד שני שלוגריתם הוא פונקציה “נחמדה” שאם מפעילים אותה על אי שוויון משמרת אותו, כך שאנחנו מקבלים שצריך להתקיים &lt;span&gt;\( n&amp;gt;\lg\left(\frac{1}{\varepsilon}\right) \)&lt;/span&gt;. כאשר &lt;span&gt;\( \varepsilon \)&lt;/span&gt; הוא קטן מאוד אז &lt;span&gt;\( \frac{1}{\varepsilon} \)&lt;/span&gt; הוא גדול מאוד ולכן &lt;span&gt;\( \lg\left(\frac{1}{\varepsilon}\right) \)&lt;/span&gt; הוא גדול מאוד - אבל עדיין קיים מספר טבעי &lt;span&gt;\( n \)&lt;/span&gt; שגדול מהם, כי לכל מספר ממשי אפשרי יש מספר טבעי שגדול ממנו - זה נקרא &lt;strong&gt;התכונה הארכימדית&lt;/strong&gt; של המספרים הממשיים והיא אחד מהדברים שבזכותם יש לנו מתמטיקה מתפקדת. אז יש לנו נימוקים מתמטיים פורמליים לטענה שנראית כמעט מובנת מאליה - שוואלה, אם אנחנו מגדילים את &lt;span&gt;\( n \)&lt;/span&gt; אז &lt;span&gt;\( \frac{1}{2^{n}} \)&lt;/span&gt; נהיה ממש קטן.&lt;/p&gt;

&lt;p&gt;אז בואו נעשה עצירת ביניים. ראינו שלושה אובייקטים שונים:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;strong&gt;סכום אינסופי&lt;/strong&gt;, &lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\frac{1}{16}+\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סדרה אינסופית&lt;/strong&gt; של מספרים שהוסקה איכשהו מהסכום האינסופי ונקראה &lt;strong&gt;סדרת הסכומים החלקיים&lt;/strong&gt; שלו, &lt;span&gt;\( a_{n}=1-\frac{1}{2^{n}} \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;מספר ממשי&lt;/strong&gt; שהוסק איכשהו מהסדרה האינסופית ונקרא &lt;strong&gt;הגבול&lt;/strong&gt; שלה, 1.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;אפשר לחשוב על הסכום האינסופי בתור משהו שמייצג תהליך אינסופי שלעולם לא יסתיים - “מה שעובר לזנון בראש כשהוא מדמיין את אכילס מנסה לעבור מסלול ריצה”. על הגבול, 1, אפשר לחשוב בתור “מה שיקרה עם אכילס בעולם האמיתי”. ההתאמה הזו של גבול עבור הסכום האינסופי הוא הדרך שבה המתמטיקה לוקחת אובייקט שיש מידע שמיוצג בו בצורה &lt;strong&gt;מובלעת&lt;/strong&gt;, וחושפת את המידע הזה בצורה &lt;strong&gt;מפורשת&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;אותו דבר בדיוק קורה עם ייצוג עשרוני של מספרים.&lt;/p&gt;

&lt;h2&gt;פרק ד&apos;, ובו אני מנסה להשתמש במתמטיקה כדי לשכנע שייצוג עשרוני מחזורי הוא שבר&lt;/h2&gt;

&lt;p&gt;אחרי כל הדיבורים שלי, עדיין לא הסברתי - למה &lt;span&gt;\( 0.333\ldots=\frac{1}{3} \)&lt;/span&gt;? כאן יש לנו בעצם ארבעה אובייקטים שונים:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;strong&gt;ייצוג עשרוני&lt;/strong&gt; של מספר שהוא הביטוי &lt;span&gt;\( 0.333\ldots \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סכום אינסופי&lt;/strong&gt; &lt;span&gt;\( \frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots \)&lt;/span&gt; שהסקנו איכשהו מהייצוג העשרוני.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סדרה אינסופית&lt;/strong&gt; &lt;span&gt;\( \frac{}{} \)&lt;/span&gt;&lt;span&gt;\( \frac{3}{10},\frac{33}{100},\frac{333}{1000},\ldots \)&lt;/span&gt; שהסקנו מהסכום האינסופי.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;גבול&lt;/strong&gt; שאני טוען שהוא &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt; אבל לא הוכחתי את זה.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;איך מוכיחים את זה? מה, לחשב &lt;span&gt;\( \frac{1}{3}-\frac{333}{1000} \)&lt;/span&gt;? זה נראה לי קצת כואב. זו אחת מהסיטואציות במתמטיקה שבהן אני חושב ש&lt;strong&gt;אבסטרקציה&lt;/strong&gt; יכולה לעזור לנו. במקום לפתור את המקרה הקונקרטי הזה ולהסתבך עם מספרים שיבלבלו אותי, לפתור מקרה כללי יותר. ראשית, בואו נשים לב שאת הסכום &lt;span&gt;\( \frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots \)&lt;/span&gt; אפשר לכתוב גם בתור &lt;span&gt;\( 3\left(\frac{1}{10^{1}}+\frac{1}{10^{2}}+\frac{1}{10^{3}}+\ldots\right) \)&lt;/span&gt;, כלומר מספיק לי להבין מה קורה בסוגריים. אם אני אסמן &lt;span&gt;\( q=\frac{1}{10} \)&lt;/span&gt;, אז בעצם השאלה היא מהו הסכום &lt;span&gt;\( q+q^{2}+q^{3}+\ldots \)&lt;/span&gt; באופן כללי. לדבר כזה קוראים &lt;strong&gt;טור הנדסי&lt;/strong&gt; אינסופי ולמרבה השמחה יש טריקים מתמטיים נחמדים כדי לחשב אותו. ראשית, מה הסכום החלקי, &lt;span&gt;\( q+q^{2}+\ldots+q^{n} \)&lt;/span&gt;? הטריק פה הוא לכפול את הסכום הזה ב-&lt;span&gt;\( \left(q-1\right) \)&lt;/span&gt; ולראות מה מקבלים. כשאני כופל את כל הסכום החלקי ב-&lt;span&gt;\( q \)&lt;/span&gt; אני מקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( q^{2}+q^{3}+\ldots+q^{n+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, המעריך של כל ה-&lt;span&gt;\( q \)&lt;/span&gt; בסכום גדל ב-1. עכשיו, כשאני כופל את כל הסכום החלקי ב-&lt;span&gt;\( -1 \)&lt;/span&gt; אני מקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( -q-q^{2}-\ldots-q^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המעריך נשאר אותו דבר, אבל עכשיו יש לנו מינוס במקום פלוס. לכן כשנחבר את הסכום העליון לתחתון, כמעט כל החזקות של &lt;span&gt;\( q \)&lt;/span&gt; ייעלמו; הדברים היחידים שלא מופיעים גם למעלה וגם למטה הם &lt;span&gt;\( q^{n+1} \)&lt;/span&gt; ו-&lt;span&gt;\( -q \)&lt;/span&gt;, אז אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(q+q^{2}+\ldots+q^{n}\right)\left(q-1\right)=\left(q^{n+1}-q\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו נחלק את שני האגפים ב-&lt;span&gt;\( q-1 \)&lt;/span&gt; ונקבל את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( q+q^{2}+\ldots+q^{n}=q\frac{q^{n}-1}{q-1} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה קורה כש-&lt;span&gt;\( n \)&lt;/span&gt; הולך וגדל? כאן יש חשיבות לשאלה מהו &lt;span&gt;\( q \)&lt;/span&gt;. אם למשל &lt;span&gt;\( q=2 \)&lt;/span&gt; אז &lt;span&gt;\( q^{n} \)&lt;/span&gt; גדל וגדל עד אין קץ ונקבל שהסכום החלקי שואף לאינסוף - אין פה גבול במובן שדיברתי עליו קודם. אבל אם &lt;span&gt;\( q&amp;lt;1 \)&lt;/span&gt;, למשל &lt;span&gt;\( q=\frac{1}{10} \)&lt;/span&gt;, אז &lt;span&gt;\( q^{n} \)&lt;/span&gt; הולך &lt;strong&gt;לשאוף לאפס&lt;/strong&gt; באותו מובן שדיברתי עליו קודם, ועם אותה הוכחה (לוגריתמים וכאלה). לכן אפשר להראות שהגבול של הסדרה &lt;span&gt;\( q\frac{q^{n}-1}{q-1} \)&lt;/span&gt; הוא מה שמתקבל כשמחליפים את &lt;span&gt;\( q^{n} \)&lt;/span&gt; ב-0, כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( q\frac{0-1}{q-1}=\frac{q}{1-q} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם נציב &lt;span&gt;\( q=\frac{1}{10} \)&lt;/span&gt;, נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{q}{1-q}=\frac{1}{10}\cdot\frac{1}{1-\frac{1}{10}}=\frac{1}{10}\frac{1}{\frac{9}{10}}=\frac{10}{10\cdot9}=\frac{1}{9} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועכשיו אפשר לחזור לטור המקורי: &lt;span&gt;\( \frac{3}{10}+\frac{3}{100}+\frac{3}{1000}+\ldots=3\left(\frac{1}{10^{1}}+\frac{1}{10^{2}}+\frac{1}{10^{3}}+\ldots\right)=3\cdot\frac{1}{9}=\frac{1}{3} \)&lt;/span&gt;. זה מסיים לנו את ההוכחה במקרה של שלישי.&lt;/p&gt;

&lt;p&gt;מה עם &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt;? זה אותו דבר בדיוק:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0.999\ldots=9\left(\frac{1}{10^{1}}+\frac{1}{10^{2}}+\frac{1}{10^{3}}+\ldots\right)=9\cdot\frac{1}{9}=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו ההוכחה הפורמלית של השוויון הזה, ואני אחזור לזה עוד רגע, אבל אני לא רוצה שנעצור פה כי מה שעשינו כאן הוא בעצם הרבה יותר כללי מזה.&lt;/p&gt;

&lt;p&gt;אם נפתח מחשבון ונכתוב &lt;span&gt;\( 1\div7 \)&lt;/span&gt; נקבל את המספר הזה או לפחות את ההתחלה שלו: &lt;span&gt;\( 0.142857142857\ldots \)&lt;/span&gt;. איך מגיעים לזה? אני מדגים טכנית בדיוק את החישוב שמוביל לייצוג העשרוני הזה &lt;a href=&quot;https://gadial.net/2021/03/24/how_to_division/&quot;&gt;בפוסט שלי על חילוק&lt;/a&gt;, וכאן אני מתעניין בדיוק בכיוון ההפוך - איך בעצם מהספרות &lt;span&gt;\( 0.142857142857\ldots \)&lt;/span&gt; אני יכול להגיע חזרה אל &lt;span&gt;\( \frac{1}{7} \)&lt;/span&gt;? סתם לכפול ב-&lt;span&gt;\( \frac{1}{9} \)&lt;/span&gt; כמו קודם מן הסתם לא יעזור.&lt;/p&gt;

&lt;p&gt;ראשית, הנקודה הקריטית פה היא ש-&lt;span&gt;\( 0.142857142857\ldots \)&lt;/span&gt; אולי נראה כמו ממבו-ג’מבו מפחיד של ספרות אבל יש בו חוקיות &lt;strong&gt;מחזורית&lt;/strong&gt; פשוטה: יש את הספרות &lt;span&gt;\( 142857 \)&lt;/span&gt; שחוזרות על עצמן שוב, ושוב, ושוב (בפוסט על החילוק אנחנו רואים בדיוק למה אנחנו יודעים את זה בודאות וזו לא סיטואציה של “פתאום בספרה ה-312,438 אחרי הנקודה התבנית נשברת”). זה אומר שאני יכול לכתוב את הייצוג העשרוני הזה בתור&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{142857}{1000000}+\frac{142857}{1000000^{2}}+\frac{142857}{1000000^{3}}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;רגע, מה? איך? אולי כדאי שאסביר את זה יותר אם זה לא ברור. בוא נתחיל מלהסתכל על &lt;span&gt;\( 0.142857 \)&lt;/span&gt;, בלי שלוש נקודות והכל, רק השבר הזה. על פי ההגדרה הפורמלית הוא שווה ל-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{10}+\frac{4}{100}+\frac{2}{1000}+\frac{8}{10000}+\frac{5}{100000}+\frac{7}{1000000} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשרוצים לחבר את כל אלו עושים מכנה משותף. לכן ה-&lt;span&gt;\( 1 \)&lt;/span&gt; מוכפל ב-10000 וה-4 מוכפל ב-1000 וכן הלאה. מה שמקבלים הוא בדיוק את &lt;span&gt;\( \frac{142857}{1000000} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, את &lt;span&gt;\( 0.142857142857 \)&lt;/span&gt; (עדיין בלי שלוש נקודות, רק שתי חזרות על &lt;span&gt;\( 142857 \)&lt;/span&gt;) אפשר לכתוב בתור &lt;span&gt;\( 0.142857+0.000000142857 \)&lt;/span&gt;. ראינו שהמספר השמאלי הוא &lt;span&gt;\( \frac{142857}{1000000} \)&lt;/span&gt;. אם נכפול את המספר הימני &lt;span&gt;\( 0.000000142857 \)&lt;/span&gt; ב-1000000, התוצאה תהיה “הזזה של הספרות” שישה מקומות שמאלה (כי כפל ב-10 הוא הזזה של הספרות צעד אחד שמאלה. אז נקבל שוב את &lt;span&gt;\( 0.142857 \)&lt;/span&gt;, והמסקנה היא ש-&lt;span&gt;\( 10^{6}\cdot0.000000142857=\frac{142857}{10^{6}} \)&lt;/span&gt;, כלומר אם נחלק ב-&lt;span&gt;\( 10^{6} \)&lt;/span&gt; את שני האגפים נקבל &lt;span&gt;\( 0.000000142857=\frac{142857}{\left(10^{6}\right)^{2}} \)&lt;/span&gt; וככה זה נמשיך עוד ועוד. לכן גם &lt;span&gt;\( 0.142857\ldots \)&lt;/span&gt; הוא בבסיסו מספר כפול טור הנדסי - הפעם המספר הוא &lt;span&gt;\( 142857 \)&lt;/span&gt; והטור ההנדסי הוא עם &lt;span&gt;\( q=\frac{1}{10^{6}} \)&lt;/span&gt;. אפשר להציב את &lt;span&gt;\( q \)&lt;/span&gt; בתוך הנוסחה הכללית לסכום שראינו קודם, &lt;span&gt;\( \frac{q}{1-q} \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{10^{6}}\frac{1}{\frac{9999999}{10^{6}}}=\frac{1}{999999} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם נפתח מחשבון ונחשב את &lt;span&gt;\( 999999\div142857 \)&lt;/span&gt; נקבל בדיוק 7, ולכן באמת קיבלנו &lt;span&gt;\( \frac{1}{7}=\frac{142857}{999999} \)&lt;/span&gt;. אותי זה מכה בהלם - איך ייתכן שמספר כל כך מסודר כמו 999999 יתחלק יפה בבלאגן כמו 142857? אבל זה קורה, וזה &lt;strong&gt;חייב לקרות&lt;/strong&gt; עבור כמעט כל מספר שהוא שבר מהצורה &lt;span&gt;\( \frac{1}{d} \)&lt;/span&gt;: מתישהו יהיה מספר מתוסבך שכשמחלקים את &lt;span&gt;\( 9999\ldots9 \)&lt;/span&gt; בו מקבלים בדיוק &lt;span&gt;\( d \)&lt;/span&gt; - או בניסוח אחר - אם נסתכל על כל המספרים מהצורה &lt;span&gt;\( 9,99,999,9999,\ldots \)&lt;/span&gt; מתישהו אחד מהם יתחלק ב-&lt;span&gt;\( d \)&lt;/span&gt; בלי שארית. החריגים היחיד הם המקרים המקרה שבהם &lt;span&gt;\( d \)&lt;/span&gt; מתחלק ב-2 או ב-5; ראינו כבר שאם &lt;span&gt;\( d \)&lt;/span&gt; מתחלק &lt;strong&gt;רק&lt;/strong&gt; ב-2 או ב-5 אז יש לו ייצוג עשרוני &lt;strong&gt;סופי&lt;/strong&gt;, ועוד מעט נראה מה קורה במקרה הכללי.&lt;/p&gt;

&lt;p&gt;בואו נוכיח את הטענה הזו על ה-9-ים וההתחלקות כי ההוכחה ממש חמודה ומאפשרת להציג עוד רעיון מתמטי נחמד (אבל אפשר גם לדלג עליה). ראשית, במקום לכתוב &lt;span&gt;\( 99999 \)&lt;/span&gt; וכו’ יותר נוח לכתוב &lt;span&gt;\( 10^{n}-1 \)&lt;/span&gt;, אז אנחנו מסתכלים על הסדרה של כל המספרים מהצורה &lt;span&gt;\( 10^{n}-1 \)&lt;/span&gt; ורוצים להוכיח שאיבר כלשהו שלה מתחלק ב-&lt;span&gt;\( d \)&lt;/span&gt;. עכשיו, כשמחלקים איבר כזה ב-&lt;span&gt;\( d \)&lt;/span&gt; &lt;strong&gt;עם שארית&lt;/strong&gt; השארית יכולה לצאת כל מספר מ-0 עד &lt;span&gt;\( d-1 \)&lt;/span&gt;, בסך הכל יש &lt;span&gt;\( d \)&lt;/span&gt; אפשרויות. זה אומר שאם אני אסתכל על כל המספרים &lt;span&gt;\( 10^{1}-1,10^{2}-1,\ldots,10^{d+1}-1 \)&lt;/span&gt; יהיו לי &lt;span&gt;\( d+1 \)&lt;/span&gt; מספרים, שכשאני מחלק אותם ב-&lt;span&gt;\( d \)&lt;/span&gt; אני מקבל אחת מבין &lt;span&gt;\( d \)&lt;/span&gt; שאריות אפשריות, ובגלל שיש &lt;span&gt;\( d+1 \)&lt;/span&gt; מספרים בהכרח תהיה שארית שתופיע &lt;strong&gt;פעמיים&lt;/strong&gt; - זה יישום של עקרון כללי שנקרא &lt;strong&gt;עקרון שובך היונים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;נניח שהשארית שמופיעה פעמיים, מופיעה במספרים &lt;span&gt;\( 10^{m}-1 \)&lt;/span&gt; ו-&lt;span&gt;\( 10^{k}-1 \)&lt;/span&gt;, עבור &lt;span&gt;\( m&amp;gt;k \)&lt;/span&gt;. עכשיו בואו נסתכל על המספר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(10^{m}-1\right)-\left(10^{k}-1\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם אני אחלק את המספר &lt;strong&gt;הזה&lt;/strong&gt; ב-&lt;span&gt;\( d \)&lt;/span&gt;, אני אקבל שארית אפס, כי השארית מחלוקת &lt;span&gt;\( \left(10^{m}-1\right) \)&lt;/span&gt; ב-&lt;span&gt;\( d \)&lt;/span&gt; תתקזז עם השארית מחלוקת &lt;span&gt;\( \left(10^{k}-1\right) \)&lt;/span&gt; ב-&lt;span&gt;\( d \)&lt;/span&gt;. בנוסף, אני יכול לכתוב את המספר הזה בצורה נחמדה יותר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(10^{m}-1\right)-\left(10^{k}-1\right)=10^{m}-10^{k}=10^{k}\left(10^{m-k}-1\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, אני מניח ש-&lt;span&gt;\( d \)&lt;/span&gt; לא מתחלק ב-2 או ב-5. במילים אחרות, אין לו &lt;strong&gt;בכלל&lt;/strong&gt; מחלקים משותפים עם &lt;span&gt;\( 10^{k} \)&lt;/span&gt; - על זה אומרים במתמטית ש-&lt;span&gt;\( d \)&lt;/span&gt; ו-&lt;span&gt;\( 10^{k} \)&lt;/span&gt; הם &lt;strong&gt;זרים&lt;/strong&gt;. זה אומר שאם אני יודע ש-&lt;span&gt;\( d \)&lt;/span&gt; מחלק את כל &lt;span&gt;\( 10^{k}\left(10^{m-k}-1\right) \)&lt;/span&gt; אז בהכרח &lt;span&gt;\( d \)&lt;/span&gt; מחלק את &lt;span&gt;\( 10^{m-k}-1 \)&lt;/span&gt;, כי במספר השני במכפלה אין אף גורם שמופיע ב-&lt;span&gt;\( d \)&lt;/span&gt;. זה מסיים את ההוכחה: קיבלנו מספר מהצורה &lt;span&gt;\( 999\ldots9 \)&lt;/span&gt; שמתחלק על ידי &lt;span&gt;\( d \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה קורה במקרה הכי כללי? כשיש לנו &lt;span&gt;\( d \)&lt;/span&gt; שמצד אחד מתחלק או ב-2 או ב-5 ומצד שני לא מתחלק &lt;strong&gt;רק&lt;/strong&gt; בהם? המקרה הקלאסי הוא &lt;span&gt;\( \frac{1}{6} \)&lt;/span&gt;, כי &lt;span&gt;\( 6=2\cdot3 \)&lt;/span&gt;. אם נפתח מחשבון נגלה ש-&lt;span&gt;\( \frac{1}{6}=0.1666\ldots \)&lt;/span&gt;, כלומר יש פה בייצוג העשרוני שילוב של שני חלקים - חלק בהתחלה שלא חוזר על עצמו, וחלק בהמשך שכן חוזר על עצמו. את זה כבר ראינו איך לחשב:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0.1666=0.1+0.0666\ldots=\frac{1}{10}+\frac{1}{10}\cdot\frac{2}{3}=\frac{3+2}{30}=\frac{5}{30}=\frac{1}{6} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו גם הצורה הכללית של ייצוג עשרוני של מספר שהוא שבר: מספר שהספרות שלו אחרי הנקודה הופכת להיות מחזוריות החל משלב מסוים, לאו דווקא מהספרה הראשונה. יש הרבה מספרים שלא מקיים את החוקיות הזו, למשל &lt;span&gt;\( \pi=3.1415\ldots \)&lt;/span&gt; שאי אפשר לייצג בתור שבר (הוא &lt;strong&gt;אי-רציונלי&lt;/strong&gt;) אבל זה סיפור לפעם אחרת.&lt;/p&gt;

&lt;h2&gt;פרק ה&apos; ואחרון, ובו אני מנסה להשתמש במה שראינו כאן כדי לשכנע שזה לא סיפור של צודקים וטועים&lt;/h2&gt;

&lt;p&gt;בואו נסכם את מה שראינו. כפי שאמרתי קודם, כשמדברים על ייצוג עשרוני מדברים בעצם במובלע על ארבעה אובייקטים שונים:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;strong&gt;ייצוג עשרוני&lt;/strong&gt; של מספר.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סכום אינסופי&lt;/strong&gt; שהסקנו איכשהו מהייצוג העשרוני.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;סדרה אינסופית&lt;/strong&gt; שהסקנו מהסכום האינסופי.&lt;/li&gt;


&lt;li&gt;&lt;strong&gt;גבול&lt;/strong&gt; שהסקנו מהסדרה האינסופית.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;הרעיון בייצוג עשרוני הוא שהגבול שמקבלים בשלב 4 יהיה שווה למספר שאנחנו מעוניינים לייצג עשרונית. אם המספר הזה הוא מספר רציונלי (“שבר”) קל לראות שזה באמת עובד והראיתי את זה למעלה - עבור מספרים אי רציונליים הטיעון עשוי להיות מסובך יותר. בפרט עבור &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; מקבלים די בקלות שהגבול הוא 1, ולכן כותבים &lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt;. מזה נובע שגם באופן כללי יותר, בכל פעם שבה מספר מסתיים בסדרה אינסופית של 999, בעצם יש לנו שני ייצוגים שונים לאותו מספר. למשל &lt;span&gt;\( 0.3999\ldots \)&lt;/span&gt; הוא ייצוג שונה של &lt;span&gt;\( 0.4 \)&lt;/span&gt;, וכן הלאה; זה לא שיש משהו מיוחד ספציפית ב-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; עצמו. זו אפילו לא אנומליה שקשורה לכך שאנחנו סופרים בבסיס 10; אם היינו סופרים בבסיס 60, אז ייצוג שמסתיים בסדרה אינסופית של הסימבול עבור 59 היה מקיים את אותה כפילות בדיוק. זה פשוט האופן שבו ייצוגים כאלו של מספרים ממשיים עובדים.&lt;/p&gt;

&lt;p&gt;התחושה שלי היא שרוב אלו שלא מסכימים שהשוויון נכון בעצם מזהים את &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; עם אחד מהאובייקטים משלב 2 או 3, ולא עם האובייקט משלב 4 שהוא היעד של ההגדרה והתוצאה הסופית שלה. במובן הזה הם לא “טועים”; ההפך, הם מתארים &lt;strong&gt;נכון&lt;/strong&gt; חלק מההגדרה, פשוט לא את הכל. הם נעצרים מוקדם מדי. למשל אצל מי שאומרים ש-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא “תהליך” (הם אי שם בשלב 2). שווה להתייחס במיוחד אל מי שאומרים שההפרש בין &lt;span&gt;\( 1 \)&lt;/span&gt; ו-&lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; הוא &lt;span&gt;\( 0.000\ldots1 \)&lt;/span&gt;: הם בעצם מסתכלים על סדרת ההפרשים &lt;span&gt;\( 0.1,0.01,0.001,\ldots \)&lt;/span&gt; שמופיעה במובלע בשלב 3, ואז מסיקים שה”גבול” שלה הוא &lt;span&gt;\( 0.000\ldots1 \)&lt;/span&gt; במקום סתם 0. זה קורה כי הם לא &lt;strong&gt;מחשבים&lt;/strong&gt; את הגבול (הזוועה עם הלוגריתמים שעשיתי קודם) אלא כי הם עושים איזה להטוט סינטקטי, כלומר כזה שמתייחס ל&lt;strong&gt;צורה&lt;/strong&gt; ולא ל&lt;strong&gt;תוכן&lt;/strong&gt; של המספרים שהם עובדים איתם. אם מסתכלים על &lt;span&gt;\( 0.1,0.01,0.001,\ldots \)&lt;/span&gt; בתור “הסימבול 0 ואז הסימבול נקודה ואז סדרה &lt;strong&gt;סופית&lt;/strong&gt; של הסימבולים 0 ואז הסימבול 1 לסיום” אפשר לחשוב על החוקיות שבה לוקחים את הייצוג הסינטקטי הזה לאינסוף ומחליפים את ה&lt;strong&gt;סופית&lt;/strong&gt; שהופיעה קודם ב&lt;strong&gt;אינסופית&lt;/strong&gt;. עכשיו, שיהיה ברור, זה רעיון &lt;strong&gt;ממש נחמד&lt;/strong&gt; ואפשר לפתח אותו מתמטית ולעשות איתו כל מני דברים - אבל הוא פשוט לא רלוונטי למה שאנחנו עושים כאן, כי זה לא מייצג את האופן שבו במתמטיקה אנחנו מבצעים חישובים במספרים ממשיים.&lt;/p&gt;

&lt;p&gt;לסיום, אני רוצה לחזור להוכחה שהצגתי בהתחלה:&lt;/p&gt;

&lt;ol&gt; &lt;li&gt;&lt;span&gt;\( x=0.999\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 10x=9.999\ldots \)&lt;/span&gt; (כפלנו ב-10 את שני האגפים)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 10x-x=9.999\ldots-0.999\ldots \)&lt;/span&gt; (החסרנו &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; משני האגפים)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 9x=9 \)&lt;/span&gt; (חישבנו את תוצאת פעולת החיסור באגפים ימין ושמאל)&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( x=1 \)&lt;/span&gt; (חילקנו את שני האגפים ב-9)&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;ההוכחה הזו תמיד צצה בדיונים על הנושא וכאמור אני חושב שהיא בהחלט מסוגלת לשכנע חלק מהמתדיינים (בשום פנים ואופן לא את כולם). אפשר אולי לטעון שההוכחה הזו מסתירה את העומק האמיתי של ההגדרות ועם זה אני לא מנסה להתווכח, אבל אני כן רוצה שנראה שזו הוכחה תקינה לגמרי. השלבים ה”מסוכנים” הם 2 ו-3; בואו נבין למה אפשר לעשות אותם.&lt;/p&gt;

&lt;p&gt;בשלב 2 אני אומר שאם כופלים את &lt;span&gt;\( 0.999\ldots \)&lt;/span&gt; ב-10 מקבלים &lt;span&gt;\( 9.999\ldots \)&lt;/span&gt;. בואו קודם כל נפתח את ההגדרות של שני המספרים הללו:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( 0.999\ldots=\frac{9}{10}+\frac{9}{100}+\frac{9}{1000}+\ldots \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( 9.999\ldots=9+\frac{9}{10}+\frac{9}{100}+\frac{9}{1000}+\ldots \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;אם ניקח את הטור העליון ונכפול אותו “איבר-איבר” ב-10, נקבל את הטור השני. לכן מה שאנחנו מתבססים עליו כאן הוא הטענה שאפשר לכפול טורים “איבר-איבר”. ברשותכם, אני אכניס את הסימן &lt;span&gt;\( \Sigma \)&lt;/span&gt; לתיאור סכום כדי לפשט עניינים. פורמלית, המשפט הוא שאם &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n} \)&lt;/span&gt; הוא טור &lt;strong&gt;מתכנס&lt;/strong&gt;, כלומר קיים &lt;span&gt;\( A \)&lt;/span&gt; כך ש-&lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}=A \)&lt;/span&gt; (עם ההגדרה של הגבול של סדרת הסכומים החלקיים שהזכרתי קודם), ואם &lt;span&gt;\( B \)&lt;/span&gt; הוא מספר כלשהו, אז מתקיים &lt;span&gt;\( \sum_{n=0}^{\infty}Ba_{n}=B\left(\sum_{n=0}^{\infty}a_{n}\right)=BA \)&lt;/span&gt;. ההוכחה היא די פשוטה: אם כופלים את הטור ב-&lt;span&gt;\( B \)&lt;/span&gt; יוצא שזה כמו לכפול את סדרת הסכומים החלקיים ב-&lt;span&gt;\( B \)&lt;/span&gt; ואנחנו עוברים לטיעון שאם יש לנו סדרה מתכנסת ואנחנו כופלים אותה ב-&lt;span&gt;\( B \)&lt;/span&gt; אז הגבול שלה מוכפל ב-&lt;span&gt;\( B \)&lt;/span&gt; מה שנובע יחסית בקלות מההגדרה של הגבול (שלא הצגתי כאן במלואה אז אני לא אוכיח פה פורמלית).&lt;/p&gt;

&lt;p&gt;באופן דומה בשלב 3 בעצם יש לנו טיעון על &lt;strong&gt;הפרש&lt;/strong&gt; של שני טורים ששניהם מתכנסים: ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}-\sum_{n=0}^{\infty}b_{n}=\sum_{n=0}^{\infty}\left(a_{n}-b_{n}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;גם פה ההוכחה היא אותו דבר - מעבר מהטורים אל סדרות, ושימוש בכך שהגבול של סדרת הפרשים &lt;span&gt;\( \left(a_{n}-b_{n}\right) \)&lt;/span&gt; שווה להפרש הגבולות של הסדרות &lt;span&gt;\( a_{n},b_{n} \)&lt;/span&gt; בנפרד. אלו טענות פשוטות למדי שנתקלים בהן בלימודי חשבון אינפיניטסימלי בסיסיים - אבל זה העניין, שבשביל לראות את זה פורמלית צריך להגיע ללימודי חשבון אינפיניטסימלי בסיסיים ורוב גדול של האנשים לא יעשו את זה. מצד שני, אני חושד שרוב האנשים שלא למדו חשבון אינפיניטסימלי גם ייטו לקבל אינטואיטיבית את זה שמעברים 2 ו-3 הם נכונים (אלא אם הם ממש רוצים לחפש בכוח בעיות בהוכחה) - פשוט כי חשבון אינפיניטסימלי הוא הזדמנות לראות את הדרכים השונות שבהן תוצאות “אינטואיטיביות” דומות קורסות ומתרסקות ברעש עצום. מכירים את הקטע הזה שאם יש לנו סכום אינסופי שבניגוד למה שראינו בפוסט הזה יש בו גם איברים חיוביים וגם שליליים, אז ייתכן שעל ידי סידור מחדש של האיברים שלו נוכל להגיע לכל מספר אפשרי? &lt;a href=&quot;https://gadial.net/2010/04/10/riemann_series_theorem/&quot;&gt;יש לי פוסט על זה&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;פתחתי בלומר ש-&lt;span&gt;\( 0.999\ldots=1 \)&lt;/span&gt; הוא שוויון פשוט, כמעט טריוויאלי. זה כמובן נכון, אבל עדיין יצא לי פוסט לא קטן עליו. זה בגלל שהשוויון הקטן והמוזר הזה הוא לשמחתי הרבה &lt;strong&gt;מעניין&lt;/strong&gt;. הוא נותן תירוץ לדבר על שלל דברים נחמדים במתמטיקה. קצת חבל לי על כל המקרים שבהם אנשים מתחילים לריב על השוויון ובמקום לנצל את זה כדי לדבר על דברים מגניבים פשוט ממשיכים… לריב. כדי לראות “מי צודק”. אנחנו יכולים להיות טובים יותר מזה, לא סתם לשאוף לשם.&lt;/p&gt;</content><author><name></name></author><category term="מספרים ממשיים" /><summary type="html">פרק א&apos;, ובו אני מנסה להשתמש בשוויון מוזר כדי לשכנע שיש על מה לדבר פה</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מה הקטע עם התפלגות נורמלית? (חלק ד’ ואחרון: משפט הגבול המרכזי)</title><link href="http://gadial.net/2025/02/07/normal_distribution_4/" rel="alternate" type="text/html" title="מה הקטע עם התפלגות נורמלית? (חלק ד&apos; ואחרון: משפט הגבול המרכזי)" /><published>2025-02-07T00:00:00+00:00</published><updated>2025-02-07T00:00:00+00:00</updated><id>http://gadial.net/2025/02/07/normal_distribution_4</id><content type="html" xml:base="http://gadial.net/2025/02/07/normal_distribution_4/">&lt;h2&gt;אז מה משפט הגבול המרכזי אומר?&lt;/h2&gt;

&lt;p&gt;סדרת הפוסטים הזו מנסה להבין למה התפלגות נורמלית נראית כמו שהיא נראית. מן הסתם השאלה הראשונה שצריך לענות עליה בשביל זה היא “מה זו בכלל התפלגות נורמלית?” ולזה יש שתי תשובות: אחת יבשה, של לתת את ההגדרה הפורמלית, וזה מה שעשינו בפוסטים הקודמים; והשניה, המהותית יותר, היא להסביר למה בכלל מתעניינים בהתפלגות הזו - והתשובה היא &lt;strong&gt;משפט הגבול המרכזי&lt;/strong&gt;. תיארתי אותו בנפנופי ידיים קודם, אז עכשיו הגיע הזמן לתת את הניסוח הפורמלי.&lt;/p&gt;

&lt;p&gt;משפט הגבול המרכזי מסתכל על סדרה אינסופית &lt;span&gt;\( X_{1},X_{2},X_{3},\ldots \)&lt;/span&gt; של משתנים מקריים שהם בלתי תלויים ובעלי אותה התפלגות (בדומה לתנאים של &lt;strong&gt;חוק המספרים הגדולים&lt;/strong&gt; שהזכרתי בפוסט הקודם). אנחנו מסמנים ב-&lt;span&gt;\( \mu \)&lt;/span&gt; את התוחלת וב-&lt;span&gt;\( \sigma^{2} \)&lt;/span&gt; את השונות שלהם (בפרט, אנחנו מניחים שהמספרים הללו מוגדרים, סופיים וש-&lt;span&gt;\( \sigma\ne0 \)&lt;/span&gt;). עכשיו, לכל &lt;span&gt;\( n \)&lt;/span&gt; אנחנו מגדירים משתנה מקרי &lt;span&gt;\( Z_{n} \)&lt;/span&gt; שהוא בערך הסכום של ה-&lt;span&gt;\( X_{i} \)&lt;/span&gt;-ים עד האיבר ה-&lt;span&gt;\( n \)&lt;/span&gt;-י, אבל עם שקלול נוסף שאמור לנרמל את הסכום:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Z_{n}=\frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז הסדרה &lt;span&gt;\( Z_{n} \)&lt;/span&gt; שואפת להתפלגות הנורמלית &lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; כאשר &lt;span&gt;\( n \)&lt;/span&gt; שואף לאינסוף. פורמלית, לכל &lt;span&gt;\( -\infty&amp;lt;a&amp;lt;\infty \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}P\left(Z_{n}\le a\right)=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{a}e^{-x^{2}/2}dx \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה הניסוח הפורמלי, אבל הוא די שונה ממה שהצגתי עד כה בפוסטים שלי. מה שאני תמיד אמרתי הוא “בואו ניקח משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt; כלשהו. עכשיו בואו נחזור על ההגרלה שלו המון פעמים ונחבר את התוצאות” - כלומר, הסתכלתי על הסכום &lt;span&gt;\( X_{1}+\ldots+X_{n} \)&lt;/span&gt;. מכאן אמרתי “היי תראו עכשיו אם מציירים היסטוגרמה של הסכום אז פתאום יש עקומה של התפלגות נורמלית שמתארת אותה די במדויק”. כדי לקבל את העקומה, חישבתי את &lt;span&gt;\( \text{E}\left[X\right]=\mu \)&lt;/span&gt; ואת &lt;span&gt;\( \text{Var}\left(X\right)=\sigma^{2} \)&lt;/span&gt; ואז בניתי את העקומה &lt;span&gt;\( N\left(n\mu,\sqrt{n}\sigma\right) \)&lt;/span&gt;. בואו נראה שזה באמת אמור לעבוד, על פי משפט הגבול המרכזי.&lt;/p&gt;

&lt;p&gt;ראשית, תזכורת: טענתי בפוסט הקודם שאם &lt;span&gt;\( N\left(\mu,\sigma\right) \)&lt;/span&gt; היא התפלגות נורמלית עם תוחלת &lt;span&gt;\( \mu \)&lt;/span&gt; וסטיית תקן &lt;span&gt;\( \sigma \)&lt;/span&gt; אז &lt;span&gt;\( N\left(0,1\right)=\frac{N\left(\mu,\sigma\right)-\mu}{\sigma} \)&lt;/span&gt;, או בניסוח אחר - &lt;span&gt;\( N\left(\mu,\sigma\right)=\sigma N\left(0,1\right)+\mu \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, אם אני אסמן &lt;span&gt;\( Y_{n}=X_{1}+\ldots+X_{n} \)&lt;/span&gt; אז משפט הגבול המרכזי אומר ש-&lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; היא קירוב טוב של &lt;span&gt;\( Z_{n}=\frac{Y_{n}-n\mu}{\sigma\sqrt{n}} \)&lt;/span&gt;. השוויון הזה מלמד אותי ש-&lt;span&gt;\( Y_{n}=\sigma\sqrt{n}Z_{n}+n\mu \)&lt;/span&gt;, כך שאני מצפה שקירוב טוב אל &lt;span&gt;\( Y_{n} \)&lt;/span&gt; (שהוא המשתנה המקרי שהופיע בהיסטוגרמות שלי) יהיה &lt;span&gt;\( \sigma\sqrt{n}N\left(0,1\right)+n\mu=N\left(n\mu,\sigma\sqrt{n}\right) \)&lt;/span&gt;, וזו העקומה שציירתי בפועל. זה מסביר מאיפה האיורים שלי הגיעו אבל עדיין לא ברור למה משפט הגבול המרכזי נראה כמו שהוא נראה; לי למשל מפריע שהחלוקה היא ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; ולא ב-&lt;span&gt;\( n \)&lt;/span&gt; כמו שעושים בחוק המספרים הגדולים. בהוכחה של משפט הגבול המרכזי אנחנו נראה למה הדברים הללו הם כמות שהם.&lt;/p&gt;

&lt;h2&gt;פונקציות יוצרות מומנטים&lt;/h2&gt;

&lt;p&gt;הכלי הטכני המרכזי שבו משתמשים בהוכחה הוא מושג שטרם הזכרתי בסדרת הפוסטים הזו: &lt;strong&gt;פונקציה יוצרת מומנטים&lt;/strong&gt;. מה זה מומנטים כן הזכרתי, בחטף: עבור משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt;, &lt;strong&gt;המומנטים&lt;/strong&gt; שלו הם הערכים המספריים &lt;span&gt;\( \text{E}\left[X^{n}\right] \)&lt;/span&gt; עבור &lt;span&gt;\( n=1,2,\ldots \)&lt;/span&gt;. עבור &lt;span&gt;\( n=1 \)&lt;/span&gt; המומנט הוא פשוט התוחלת, וראינו שעבור &lt;span&gt;\( n=2 \)&lt;/span&gt; המומנט הוא פשוט השונות ועוד התוחלת בריבוע (כי &lt;span&gt;\( \text{Var}\left(X\right)=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)&lt;/span&gt;), אבל לא דיברתי על המומנטים עבור חזקות גבוהות יותר. הרעיון הוא שסדרת המומנטים של משתנה מקרי היא כמו ה-DNA שלו: מכילה כמות גדולה כל כך של מידע עליו שאפשר להסיק ממנה דברים מאוד לא טריוויאליים, גם אם היא לבדה לא כל הסיפור.&lt;/p&gt;

&lt;p&gt;עוד מושג מאוד מועיל במתמטיקה, &lt;a href=&quot;https://gadial.net/2011/08/07/generating_functions_hardcore_1/&quot;&gt;שכבר הזכרתי&lt;/a&gt; בבלוג כמה פעמים, הוא &lt;strong&gt;פונקציה יוצרת&lt;/strong&gt;. הרעיון בפונקציה יוצרת הוא זה: אם יש לנו סדרה מעניינת של מספרים, &lt;span&gt;\( a_{0},a_{1},a_{2},\ldots \)&lt;/span&gt;, אחד מהקסמים שאנחנו יכולים לעשות הוא “לשתול” את המספרים הללו בתור מקדמים של טור חזקות, &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt; ואז פתאום אנחנו מסוגלים לעשות עם הטור הזה מניפולציות מעניינות שמתורגמות לפעולות לא טריוויאליות על כל סדרת המספרים בבת אחת. זה כלי חזק ומרהיב.&lt;/p&gt;

&lt;p&gt;על הרעיון הבסיסי הזה יש כמה וריאציות מועילות, ואחת מהן היא מה שנקרא &lt;strong&gt;הפונקציה היוצרת האקספוננציאלית&lt;/strong&gt; של סדרת המספרים. כאן הרעיון הוא לשתול את המספרים בתוך הטור &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!} \)&lt;/span&gt; שמזכיר קצת את הטור של פונקציית האקספוננט (עבור הסדרה &lt;span&gt;\( a_{n}=1 \)&lt;/span&gt; מקבלים בדיוק את הטור של &lt;span&gt;\( e^{x} \)&lt;/span&gt;). איכשהו יצא לגמרי במקרה שדיברתי על הפונקציה הזו &lt;a href=&quot;https://gadial.net/2024/12/18/bernoulli_numbers/&quot;&gt;באחד מהפוסטים האחרונים&lt;/a&gt; בבלוג; זה לא יצא ככה בכוונה, פשוט היא כל כך מועילה שהיא מתעקשת לצוץ בשני הקשרים שונים כמעט בו זמנית (אחרי שמעולם לא כתבתי עליה קודם בבלוג לדעתי אבל נעזוב את זה).&lt;/p&gt;

&lt;p&gt;מה שנקרא בתורת ההסתברות &lt;strong&gt;פונקציה יוצרת מומנטים&lt;/strong&gt; הוא בדיוק זה - הפונקציה היוצרת האקספוננציאלית של סדרת המומנטים, אם כי נוח להגדיר אותה בצורה קצת שונה. ראשית, אני אשתמש במשתנה &lt;span&gt;\( t \)&lt;/span&gt; כדי לא לבלבל עם המשתנה המקרי &lt;span&gt;\( X \)&lt;/span&gt; שהוא מרכז הדיון שלנו. עכשיו, עם משתנה מקרי אפשר כזכור להשתגע בשלל צורות, כי בסופו של דבר מדובר במשהו שמחזיר מספרים ממשיים אז אפשר לעשות איתו דברים שאנחנו עושים עם מספרים ממשיים - למשל להסתכל על &lt;span&gt;\( e^{X} \)&lt;/span&gt;, שזה פשוט משתנה מקרי שאומר “תגריל תוצאה כלשהי, תבדוק מה הערך ש-&lt;span&gt;\( X \)&lt;/span&gt; נותן על התוצאה הזו, תעלה את &lt;span&gt;\( e \)&lt;/span&gt; בחזקת הערך הזה”. כדי לעשות את זה מעניין אני יכול גם לדחוף פנימה ערך מספרי &lt;span&gt;\( t \)&lt;/span&gt; כלשהו שאני מתייחס אליו כפרמטר ומכפיל אותו ב-&lt;span&gt;\( X \)&lt;/span&gt;, כלומר אני מסתכל על המשתנה המקרי &lt;span&gt;\( e^{tX} \)&lt;/span&gt;. אם זה משתנה מקרי, אפשר לחשב את התוחלת שלו, והיא תהיה תלויה בפרמטר &lt;span&gt;\( t \)&lt;/span&gt;, כלומר קיבלנו &lt;strong&gt;פונקציה&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M\left(t\right)=\text{E}\left[e^{tX}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו הפונקציה יוצרת המומנטים, ואנחנו ליטרלי יכולים להשתמש בה כדי &lt;strong&gt;ליצור&lt;/strong&gt; את המומנטים על ידי “חילוץ” המקדמים מתוך הטור של &lt;span&gt;\( e^{tX} \)&lt;/span&gt; על ידי גזירה, כמו שקורה בחדו”א עם מה שנקרא &lt;strong&gt;טור טיילור&lt;/strong&gt;. הנה איך שזה עובד:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M^{\prime}\left(t\right)=\left(\text{E}\left[e^{tX}\right]\right)^{\prime}=\text{E}\left[\left(e^{tX}\right)^{\prime}\right]=\text{E}\left[Xe^{tX}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אוקיי, קצת מיהרתי פה. אני מבצע &lt;strong&gt;החלפה&lt;/strong&gt; בין אופרטור התוחלת ואופרטור הגזירה במעבר האמצעי - למה זה מעבר לגיטימי? אם פותחים את ההגדרה של התוחלת במקרה הסופי מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[e^{tX}\right]=\sum_{i=1}^{k}P\left(X=a_{i}\right)e^{ta_{i}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואפשר להשתמש בכך שנגזרת היא לינארית, כלומר &lt;span&gt;\( \left(f+g\right)^{\prime}=f^{\prime}+g^{\prime} \)&lt;/span&gt;, מה שניתן להכללה באינדוקציה לכל סכום סופי, ולכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[\sum_{i=1}^{k}P\left(X=a_{i}\right)e^{ta_{i}}\right]^{\prime}=\sum_{i=1}^{k}P\left(X=a_{i}\right)\left(e^{ta_{i}}\right)^{\prime}=\sum_{i=1}^{k}P\left(X=a_{i}\right)a_{i}e^{ta_{i}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וקיבלנו בדיוק את הביטוי של &lt;span&gt;\( \text{E}\left[Xe^{tX}\right] \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;העניין הוא שמה שעובד עבור סכום &lt;strong&gt;סופי&lt;/strong&gt; לא בהכרח עובד במקרה של סכום אינסופי, או במקרה הרציף שבו התוחלת היא אינטגרל. כלומר, את הקסם הזה אי אפשר לעשות &lt;strong&gt;לכל&lt;/strong&gt; משתנה מקרי אלא רק לכאלו שהם “נחמדים מספיק”, אבל בואו לא ניכנס לתנאים המדויקים הפעם. במקום זה, בואו נראה איך אפשר להשתמש בזה: אם &lt;span&gt;\( M^{\prime}\left(t\right)=\text{E}\left[Xe^{tX}\right] \)&lt;/span&gt; אז &lt;span&gt;\( M^{\prime}\left(0\right)=\text{E}\left[X\right] \)&lt;/span&gt; וקיבלנו את המומנט הראשון.&lt;/p&gt;

&lt;p&gt;עכשיו, אפשר להמשיך לגזור את &lt;span&gt;\( Xe^{tX} \)&lt;/span&gt;. מכיוון שהנגזרת היא על פי &lt;span&gt;\( t \)&lt;/span&gt;, ה-&lt;span&gt;\( X \)&lt;/span&gt; שבו מוכפל &lt;span&gt;\( e^{tX} \)&lt;/span&gt; הוא בסך הכל קבוע, ולכן מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M^{\prime\prime}\left(t\right)=\text{E}\left[X^{2}e^{tX}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M^{\prime\prime}\left(0\right)=\text{E}\left[X^{2}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובאופן כללי נקבל &lt;span&gt;\( M^{\left(i\right)}=\text{E}\left[X^{i}\right] \)&lt;/span&gt;. זה בדיוק מה שקורה גם כשגוזרים את הטור &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!} \)&lt;/span&gt; בדיוק &lt;span&gt;\( i \)&lt;/span&gt; פעמים ומציבים &lt;span&gt;\( x=0 \)&lt;/span&gt;; מקבלים את &lt;span&gt;\( a_{i} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;איך כל זה מתקשר למשפט הגבול המרכזי? עם הטענה הבאה: אם יש לנו סדרה &lt;span&gt;\( Z_{1},Z_{2},\ldots \)&lt;/span&gt; של משתנים מקריים עם פונקציות צפיפות &lt;span&gt;\( F_{Z_{n}} \)&lt;/span&gt; ופונקציות יוצרות הסתברות &lt;span&gt;\( M_{Z_{n}} \)&lt;/span&gt;, ואם &lt;span&gt;\( Z \)&lt;/span&gt; הוא משתנה מקרי עם פונקציית צפיפות &lt;span&gt;\( F_{Z} \)&lt;/span&gt; ופונקציה יוצרת הסתברות &lt;span&gt;\( M_{Z} \)&lt;/span&gt;, אז אם מתקיים &lt;span&gt;\( \lim_{n\to\infty}M_{Z_{n}}\left(t\right)=M_{Z}\left(t\right) \)&lt;/span&gt; עבור כל &lt;span&gt;\( t \)&lt;/span&gt;, אז &lt;span&gt;\( F_{Z_{n}}\left(t\right)\to F_{Z}\left(t\right) \)&lt;/span&gt; עבור כל &lt;span&gt;\( t \)&lt;/span&gt; שעבורו &lt;span&gt;\( F_{Z}\left(t\right) \)&lt;/span&gt; רציפה. במילים אחרות - מספיק לנו להראות שאיפה של סדרת הפונקציות יוצרות המומנטים כדי להראות שאיפה של פונקציות הצפיפות, שהן לכאורה האובייקט המורכב יותר.&lt;/p&gt;

&lt;p&gt;הטענה הזו היא טענה &lt;strong&gt;כבדה&lt;/strong&gt;. כדי להוכיח אותה אני אצטרך כנראה פוסט שלם (או אפילו יותר) ולהיכנס למתמטיקה טכנית יותר מאשר אני רוצה כרגע. המטרה שלי בפוסטים הללו היא לראות איך זה שהתפלגות נורמלית היא מה שהיא גורר את משפט הגבול המרכזי; אז בואו נראה איך טענת העזר הזו מוכיחה לנו את משפט הגבול המרכזי.&lt;/p&gt;

&lt;h2&gt;הוכחת משפט הגבול המרכזי&lt;/h2&gt;

&lt;p&gt;בואו נזכיר שוב מה אנחנו רוצים להוכיח. אנחנו לוקחים סדרה &lt;span&gt;\( X_{1},X_{2},\ldots \)&lt;/span&gt; של משתנים מקריים בלתי תלויים שמתפלגים באותו אופן, עם תוחלת &lt;span&gt;\( \mu \)&lt;/span&gt; וסטיית תקן &lt;span&gt;\( \sigma \)&lt;/span&gt;, מגדירים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Z_{n}=\frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ומקבלים שהסדרה &lt;span&gt;\( Z_{n} \)&lt;/span&gt; שואפת להתפלגות הנורמלית &lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; כאשר &lt;span&gt;\( n \)&lt;/span&gt; שואף לאינסוף. מה שנוכיח הוא את המשפט למקרה שבו &lt;span&gt;\( \mu=0,\sigma=1 \)&lt;/span&gt;, כי אפשר לבצע רדוקציה מהמקרה הכללי למקרה הזה: אם נגדיר &lt;span&gt;\( Y_{i}=\frac{X_{i}-\mu}{\sigma} \)&lt;/span&gt; אז נקבל שהתוחלת של &lt;span&gt;\( Y_{i} \)&lt;/span&gt; היא 0 וסטיית התקן היא 1, ולכן &lt;span&gt;\( \frac{Y_{i}+\ldots+Y_{n}}{\sqrt{n}} \)&lt;/span&gt; שואפת אל &lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt;. עכשיו נציב את &lt;span&gt;\( Y_{i}=\frac{X_{i}-\mu}{\sigma} \)&lt;/span&gt; בביטוי &lt;span&gt;\( \frac{Y_{i}+\ldots+Y_{n}}{\sqrt{n}} \)&lt;/span&gt; ששואף ל-&lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; ונקבל את הביטוי &lt;span&gt;\( \frac{X_{1}+\ldots+X_{n}-n\mu}{\sigma\sqrt{n}} \)&lt;/span&gt; שגם שואף ל-&lt;span&gt;\( N\left(0,1\right) \)&lt;/span&gt; כי זה אותו ביטוי.&lt;/p&gt;

&lt;p&gt;אם כן, מעתה והלאה נניח &lt;span&gt;\( \mu=0 \)&lt;/span&gt; ו-&lt;span&gt;\( \sigma=1 \)&lt;/span&gt; ולכן &lt;span&gt;\( Z_{n}=\frac{X_{1}+\ldots+X_{n}}{\sqrt{n}}=\frac{X_{1}}{\sqrt{n}}+\ldots+\frac{X_{n}}{\sqrt{n}} \)&lt;/span&gt;. המטרה שלי היא למצוא את &lt;span&gt;\( M_{Z_{n}}\left(t\right) \)&lt;/span&gt; - הפונקציה יוצרת המומנטים של &lt;span&gt;\( Z_{n} \)&lt;/span&gt;, ולראות לאן היא שואפת (כשאני אראה לאן היא שואפת זה מה ש&lt;strong&gt;יכתיב&lt;/strong&gt; לי את האופן שבו התפלגות נורמלית אמורה להיראות). מכיוון שהצגתי את &lt;span&gt;\( Z_{n} \)&lt;/span&gt; בתור סכום סופי, בואו קודם נראה איך הפונקציה יוצרת המומנטים של כל איבר בסכום נראית.&lt;/p&gt;

&lt;p&gt;ראשית, עבור &lt;span&gt;\( X_{i} \)&lt;/span&gt;, הפונקציה יוצרת המומנטים שלו היא &lt;span&gt;\( M\left(t\right)=\text{E}\left[e^{tX_{i}}\right] \)&lt;/span&gt;. שנית, עבור האיבר המנורמל &lt;span&gt;\( \frac{X_{i}}{\sqrt{n}} \)&lt;/span&gt; הפונקציה יוצרת המומנטים היא &lt;span&gt;\( \text{E}\left[e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\text{E}\left[e^{\frac{t}{\sqrt{n}}X_{i}}\right]=M\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;. ולכן עכשיו נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( M_{Z_{n}}\left(t\right)=\text{E}\left[e^{tZ_{n}}\right]=\text{E}\left[e^{t\sum_{i=1}^{n}\frac{X_{i}}{\sqrt{n}}}\right]=\text{E}\left[\prod_{i=1}^{n}e^{t\frac{X_{i}}{\sqrt{n}}}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כי זה הקסם של אקספוננט - סכום במעריך הופך למכפלת אקספוננטים (על פי כללי החזקות: &lt;span&gt;\( e^{a+b}=e^{a}\cdot e^{b} \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;עכשיו, זה &lt;strong&gt;בהחלט לא נכון&lt;/strong&gt; באופן כללי שתוחלת של מכפלה היא מכפלת התוחלות, כלומר &lt;span&gt;\( \text{E}\left[XY\right]\ne\text{E}\left[X\right]\text{E}\left[Y\right] \)&lt;/span&gt; באופן כללי, וזה די ברור - אם זה היה נכון, היינו מקבלים ש-&lt;span&gt;\( \text{E}\left[X^{2}\right]=\text{E}\left[X\right]^{2} \)&lt;/span&gt; וכל מושג סטיית התקן היה נעלם. אבל השוויון &lt;span&gt;\( \text{E}\left[XY\right]=\text{E}\left[X\right]\text{E}\left[Y\right] \)&lt;/span&gt; דווקא &lt;strong&gt;כן נכון&lt;/strong&gt; אם &lt;span&gt;\( X,Y \)&lt;/span&gt; הם משתנים מקריים בלתי תלויים, וזה בדיוק מה שאני מניח כאן - שכל אברי הסדרה &lt;span&gt;\( X_{1},X_{2},\ldots,X_{n} \)&lt;/span&gt; הם בלתי תלויים, ולכן גם המשתנים &lt;span&gt;\( e^{t\frac{X_{i}}{\sqrt{n}}} \)&lt;/span&gt; שנבנים מתוכם. כך שאני מקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[\prod_{i=1}^{n}e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\prod_{i=1}^{n}\text{E}\left[e^{t\frac{X_{i}}{\sqrt{n}}}\right]=\prod_{i=1}^{n}M\left(\frac{t}{\sqrt{n}}\right)=\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז מה שאנחנו רוצים להבין הוא את הגבול &lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt;. זה בעצם המקום הראשון שבו קופץ לעיניים למה “צריך” ש-&lt;span&gt;\( e \)&lt;/span&gt; יופיע בהתפלגות נורמלית. כזכור, אחת מהדרכים השקולות לתאר את &lt;span&gt;\( e^{x} \)&lt;/span&gt; היא באמצעות גבול: &lt;span&gt;\( e^{x}=\lim_{n\to\infty}\left(1+\frac{x}{n}\right)^{n} \)&lt;/span&gt;, אז העובדה שיש לנו בביטוי &lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt; גבול שתלוי ב-&lt;span&gt;\( n \)&lt;/span&gt;, חזקה שהיא &lt;span&gt;\( n \)&lt;/span&gt; ואיבר פנימי שהוא &lt;span&gt;\( \frac{t}{\sqrt{n}} \)&lt;/span&gt; זה… מעורר חשד.&lt;/p&gt;

&lt;p&gt;עכשיו, איך מטפלים בביטוי &lt;span&gt;\( \left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt;? ה-&lt;span&gt;\( n \)&lt;/span&gt; במעריך הוא מעצבן, והדרך הסטנדרטית להיפטר ממנו היא לקחת לוגריתם להכל, כי &lt;span&gt;\( \left(a^{n}\right)=n\log a \)&lt;/span&gt;&lt;span&gt;\( \log \)&lt;/span&gt;. אז בואו נשאל את עצמנו מהו הגבול&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}n\log M\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם הגבול הזה יהיה &lt;span&gt;\( A \)&lt;/span&gt; והלוגריתם שלי הוא על בסיס &lt;span&gt;\( a \)&lt;/span&gt;, אז הגבול של &lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt; יהיה &lt;span&gt;\( a^{A} \)&lt;/span&gt;. איזה בסיס של לוגריתם &lt;strong&gt;כדאי לי&lt;/strong&gt; לבחור? אני לא רוצה שיהיו לי החלטות שרירותיות, אז בואו נתקדם עם ההוכחה ונראה איזה בסיס יצוץ מאליו (ספוילר: &lt;span&gt;\( e \)&lt;/span&gt;. זה תמיד &lt;span&gt;\( e \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;אם כן, הביטוי שאנחנו צריכים להבין עכשיו הוא הפונקציה &lt;span&gt;\( \log M\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;. הכל נהיה פשוט יותר אחרי שיש לנו סימונים, אז נסמן: &lt;span&gt;\( L\left(t\right)=\log M\left(t\right) \)&lt;/span&gt;, ועכשיו אנחנו רוצים להבין את הגבול &lt;span&gt;\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;. איך עושים את זה? אין לי מושג, אבל לגשש בצורה עיוורת אפשר, ואחד מהכלים המועילים שיש לנו בחישוב גבולות הוא &lt;strong&gt;כלל לופיטל&lt;/strong&gt;. הרעיון בו פשוט: אם &lt;span&gt;\( f\left(x\right),g\left(x\right) \)&lt;/span&gt; הן שתי פונקציות כך ש-&lt;span&gt;\( \lim_{x\to\infty}f\left(x\right)=\lim_{x\to\infty}g\left(x\right)=0 \)&lt;/span&gt; אז &lt;span&gt;\( \lim_{x\to\infty}\frac{f\left(x\right)}{g\left(x\right)}=\lim_{x\to\infty}\frac{f^{\prime}\left(x\right)}{g^{\prime}\left(x\right)} \)&lt;/span&gt;. כלומר, בדומה לאינטגרציה בחלקים שבה השתמשתי בפוסט הקודם, גם כאן אפשר לחשב דברים על ידי גזירה של הפונקציות הרלוונטיות עד שיהיו פשוטות מספיק.&lt;/p&gt;

&lt;p&gt;אצלנו הגבול הוא לא של פונקציות אלא של סדרה, אבל כל עוד הפונקציות המעורבות הן רציפות מקבלים אותו דבר. אבל בשביל להשתמש בלופיטל אנחנו צריכים &lt;strong&gt;מנה &lt;/strong&gt;של שתי פונקציות ששואפות לאפס: אצלנו יש &lt;strong&gt;מכפלה&lt;/strong&gt; של שתי פונקציות, &lt;span&gt;\( nL\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;, שאחת מהן (&lt;span&gt;\( n \)&lt;/span&gt;) בכלל שואפת לאינסוף… אה, הטריק פה הוא פשוט מאוד: &lt;span&gt;\( nL\left(\frac{t}{\sqrt{n}}\right)=\frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}} \)&lt;/span&gt;, ועכשיו הפונקציה במכנה היא &lt;span&gt;\( \frac{1}{n} \)&lt;/span&gt; ששואפת לאפס כש-&lt;span&gt;\( n\to\infty \)&lt;/span&gt;. ומה קורה במונה? הרציפות של &lt;span&gt;\( L \)&lt;/span&gt; אומרת ש-&lt;span&gt;\( L\left(\frac{t}{\sqrt{n}}\right)\to L\left(0\right) \)&lt;/span&gt;, אבל מהו &lt;span&gt;\( L\left(0\right) \)&lt;/span&gt;? ומה נקבל אחרי שנגזור?&lt;/p&gt;

&lt;p&gt;ובכן, כזכור &lt;span&gt;\( L\left(t\right)=\log M\left(t\right) \)&lt;/span&gt;. מכיוון ש-&lt;span&gt;\( M\left(t\right)=\text{E}\left[e^{tX_{i}}\right] \)&lt;/span&gt; הרי ש-&lt;span&gt;\( M\left(0\right)=\text{E}\left[e^{0\cdot X_{i}}\right]=\text{E}\left[1\right]=1 \)&lt;/span&gt; כך ש-&lt;span&gt;\( L\left(0\right)=\log1=0 \)&lt;/span&gt;. זה טוב, זה בדיוק מה שאנחנו רוצים. עכשיו, מה עם הנגזרת? יש לנו כאן עסק עם הרכבה של פונקציות: &lt;span&gt;\( \log \)&lt;/span&gt; שמורכבת על &lt;span&gt;\( M \)&lt;/span&gt;. זה מצריך מאיתנו שני דברים: את הכלל של נגזרת של לוגריתם, ואת כלל השרשרת. והכלל לנגזרת של לוגריתם הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(\log_{a}t\right)^{\prime}=\frac{1}{t\ln a} \)&lt;/span&gt;, כאשר &lt;span&gt;\( \ln \)&lt;/span&gt; הוא לוגריתם על בסיס &lt;span&gt;\( e \)&lt;/span&gt;. הביטוי הזה הופך לפשוט יותר אם מלכתחילה הלוגריתם שלנו הוא על בסיס &lt;span&gt;\( e \)&lt;/span&gt;; אז מקבלים &lt;span&gt;\( \left(\log t\right)^{\prime}=\frac{1}{t} \)&lt;/span&gt;. אז יש לנו סיבה טובה לבחור שהלוגריתם שלנו יהיה על בסיס &lt;span&gt;\( e \)&lt;/span&gt;, מה שאומר שאחרי שנצליח לחשב את &lt;span&gt;\( \lim_{n\to\infty}n\log M\left(\frac{t}{\sqrt{n}}\right)=A \)&lt;/span&gt;, נקבל ש-&lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n}=e^{A} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, על פי כלל השרשרת &lt;span&gt;\( \left[f\left(g\left(x\right)\right)\right]^{\prime}=f^{\prime}\left(g\left(x\right)\right)g^{\prime}\left(x\right) \)&lt;/span&gt; אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( L^{\prime}=\left(\log M\right)^{\prime}=\frac{M^{\prime}}{M} \)&lt;/span&gt; (יש לדבר כזה שם - “הנגזרת הלוגריתמית” של &lt;span&gt;\( M \)&lt;/span&gt;)&lt;/p&gt;

&lt;p&gt;ראינו כבר ש-&lt;span&gt;\( M\left(0\right)=1 \)&lt;/span&gt;. כמו כן, &lt;span&gt;\( M^{\prime}\left(0\right)=\text{E}\left[X\right]=\mu=0 \)&lt;/span&gt; (זוכרים? ראינו שככה פונקציה יוצרת מומנטים עובדת). אז קיבלנו ש-&lt;span&gt;\( L^{\prime}\left(0\right)=0 \)&lt;/span&gt;, מה שאומר שכלל לופיטל צפוי להיתקל בקשיים כי גם אחרי הגזירה המונה ישאף ל-0. אבל אפשר לגזור שוב! הפעם נשתמש בכלל לגזירה של מנה, &lt;span&gt;\( \left(\frac{f}{g}\right)^{\prime}=\frac{f^{\prime}g-fg^{\prime}}{g^{2}} \)&lt;/span&gt; ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( L^{\prime\prime}=\left(\frac{M^{\prime}}{M}\right)^{\prime}=\frac{M^{\prime\prime}M-\left(M^{\prime}\right)^{2}}{M^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן כשנציב &lt;span&gt;\( 0 \)&lt;/span&gt; ונשתמש בכך ש-&lt;span&gt;\( M\left(0\right)=1,M^{\prime}\left(0\right)=0,M^{\prime\prime}\left(0\right)=\text{E}\left[X^{2}\right]=\sigma^{2}+\mu^{2}=1 \)&lt;/span&gt;, נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( L^{\prime\prime}\left(0\right)=\frac{1-0^{2}}{1}=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה כבר משהו לעבוד איתו! כל מה שנשאר לנו הוא לקחת את הביטוי &lt;span&gt;\( \frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}} \)&lt;/span&gt; ולגזור בו (בנפרד!) את המונה והמכנה פעמיים. זה לא יהיה כזה נורא, נכון? נקודה אחת שצריך לשים לב אליה היא שהגזירה שלנו היא ביחס למשתנה &lt;span&gt;\( n \)&lt;/span&gt;, ואילו דווקא אל &lt;span&gt;\( t \)&lt;/span&gt; אנחנו מתייחסים בתור קבוע, כי הגבול שלנו הוא כש-&lt;span&gt;\( n \)&lt;/span&gt; רץ לאינסוף. זה הופך את הכל לטיפה יותר מסובך.&lt;/p&gt;

&lt;p&gt;כלל הגזירה הבסיסי ביותר הוא &lt;span&gt;\( \left(x^{a}\right)^{\prime}=ax^{a-1} \)&lt;/span&gt;. מכאן נקבל ש-&lt;span&gt;\( \left(n^{-1}\right)^{\prime}=-n^{-2} \)&lt;/span&gt; וש-&lt;span&gt;\( \left(\frac{1}{\sqrt{n}}\right)^{\prime}=\left(n^{-\frac{1}{2}}\right)^{\prime}=-\frac{1}{2}n^{-\frac{3}{2}} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;הנגזרת של &lt;span&gt;\( L\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; על פי כלל השרשרת היא &lt;span&gt;\( \left(\frac{t}{\sqrt{n}}\right)^{\prime}L^{\prime}\left(\frac{t}{\sqrt{n}}\right)=-\frac{t}{2}n^{-\frac{3}{2}}L^{\prime}\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; , ולכן מכלל לופיטל אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}\frac{L\left(\frac{t}{\sqrt{n}}\right)}{n^{-1}}=\lim_{n\to\infty}\frac{-\frac{t}{2}n^{-\frac{3}{2}}L^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{-n^{-2}}=\lim_{n\to\infty}\frac{tL^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{2n^{-1/2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המונה עדיין שואף לאפס כש-&lt;span&gt;\( n\to\infty \)&lt;/span&gt; (כי ראינו &lt;span&gt;\( L^{\prime}\left(0\right)=0 \)&lt;/span&gt;) והמכנה, שהוא עכשיו &lt;span&gt;\( -\frac{2}{\sqrt{n}} \)&lt;/span&gt;, גם כן שואף לאפס, אז אפשר להשתמש שוב בכלל לופיטל. הנגזרת של המכנה תהיה &lt;span&gt;\( \left(2n^{-\frac{1}{2}}\right)^{\prime}=-n^{-\frac{3}{2}} \)&lt;/span&gt;. המונה יהיה כמו קודם (אל ה-&lt;span&gt;\( t \)&lt;/span&gt; שמופיע שם אנחנו כאמור מתייחסים בתור קבוע והוא לא משפיע על הגזירה). לכן נקבל מכלל לופיטל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}\frac{tL^{\prime}\left(\frac{t}{\sqrt{n}}\right)}{2n^{-1/2}}=\lim_{n\to\infty}\frac{-\frac{t^{2}}{2}n^{-\frac{3}{2}}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right)}{-n^{-3/2}}=\lim_{n\to\infty}\frac{t^{2}}{2}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הופה! העלמנו לגמרי את מה שהופיע במכנה! ועכשיו, בגלל ש-&lt;span&gt;\( L^{\prime\prime}\left(0\right)=1 \)&lt;/span&gt;, אנחנו מקבלים גבול פשוט במיוחד: &lt;span&gt;\( \lim_{n\to\infty}\frac{t^{2}}{2}L^{\prime\prime}\left(\frac{t}{\sqrt{n}}\right)=\frac{t^{2}}{2} \)&lt;/span&gt;. זה אומר שמצאנו את מה שהפונקציה יוצרת המומנטים של &lt;span&gt;\( Z_{n} \)&lt;/span&gt; שואפת אליו: &lt;span&gt;\( \lim_{n\to\infty}M_{Z_{n}}\left(t\right)=e^{\frac{t^{2}}{2}} \)&lt;/span&gt;. זה, סוף כל סוף, מסביר מאיפה מגיע &lt;span&gt;\( e^{\frac{t^{2}}{2}} \)&lt;/span&gt; להתפלגות הנורמלית - לפחות מבחינה טכנית - אם כי יש עוד שלב לא טריוויאלי אחד שצריך להתגבר עליו.&lt;/p&gt;

&lt;h2&gt;הפונקציה יוצרת המומנטים של התפלגות נורמלית&lt;/h2&gt;

&lt;p&gt;ההוכחה עדיין לא בדיוק הסתיימה. מה שהראיתי הוא שאם &lt;span&gt;\( Z \)&lt;/span&gt; הוא משתנה מקרי עם פונקציה יוצרת מומנטים &lt;span&gt;\( M_{Z}\left(t\right)=e^{\frac{t^{2}}{2}} \)&lt;/span&gt; אז הפונקציה יוצרת המומנטים של אברי הסדרה &lt;span&gt;\( Z_{n} \)&lt;/span&gt; תתכנס לפונקציה יוצרת המומנטים של &lt;span&gt;\( Z \)&lt;/span&gt;. המסקנה, מטענת העזר שציטטתי בלי הוכחה, היא ש-&lt;span&gt;\( F_{Z_{n}}\left(t\right) \)&lt;/span&gt; מתכנסת אל &lt;span&gt;\( F_{Z}\left(t\right) \)&lt;/span&gt;. אבל מהי פונקציית הצפיפות &lt;span&gt;\( F_{Z}\left(t\right) \)&lt;/span&gt;? זה השלב שבו צריך לקחת את ההתפלגות הנורמלית, לחשב את הפונקציה יוצרת המומנטים שלה ולקבל &lt;span&gt;\( e^{\frac{t^{2}}{2}} \)&lt;/span&gt;. זה חישוב די פשוט בהינתן כל החישובים שכבר עברנו, אבל יש כאן גם שאלה מעניינת - האם אפשר ללכת “בכיוון השני”? להתחיל מהשוויון שצריך להתקיים ולהסיק איך ההתפלגות הנורמלית אמורה להיראות?&lt;/p&gt;

&lt;p&gt;באופן כללי אני יכול לסמן &lt;span&gt;\( F_{Z}\left(z\right)=f\left(z\right) \)&lt;/span&gt; ואז להשתמש בשוויון &lt;span&gt;\( e^{t^{2}/2}=\text{E}\left[e^{tZ}\right] \)&lt;/span&gt; כש-&lt;span&gt;\( \text{E}\left[e^{tZ}\right] \)&lt;/span&gt; הוא מה ש&lt;strong&gt;מגדיר&lt;/strong&gt; את הפונקציה יוצרת המומנטים, ולקבל שאני צריך שיתקיים השוויון&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( e^{t^{2}/2}=\int_{-\infty}^{\infty}e^{tz}f\left(z\right)dz \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הדבר הזה נקרא &lt;strong&gt;משוואה אינטגרלית&lt;/strong&gt;: בדומה למשוואה דיפרנציאלית, זו משוואה שבה הנעלם הוא לא סתם ערך מספרי אלא &lt;strong&gt;פונקציה&lt;/strong&gt;, והמידע שיש לנו על הפונקציה הזו מערב אינטגרל שלה. כמו עם משוואות דיפרנציאליות, פתרון משוואות אינטגרליות זה עניין מסובך והרבה פעמים לומר “אוקיי, בואו ננחש שהפתרון הוא מהצורה כך וכך…” הוא לגיטימי, אבל עבור המשוואה שלעיל דווקא יש שיטת פתרון כללית, פחות או יותר, בעזרת מה שנקרא &lt;strong&gt;התמרת לפלס&lt;/strong&gt;. להיכנס לזה לוקח אותי רחוק מדי ממה שאפשר לדבר עליו במרוכז כאן, אז בואו ננקוט בגישה השניה: נתחיל עם ההגדרה הידועה של &lt;span&gt;\( f\left(z\right) \)&lt;/span&gt; עבור התפלגות נורמלית ונראה שאנחנו מקבלים את השוויון למעלה. החישובים הספציפיים שנצטרך לבצע הם דומים למדי לחישובים שצריך לעשות אם פותרים את המשוואה האינטגרלית.&lt;/p&gt;

&lt;p&gt;אם כן, &lt;span&gt;\( f\left(z\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;, ולכן אנחנו מחשבים את האינטגרל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{tz}e^{-z^{2}/2}dz \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לב העניין הוא מה שהולך בחזקה של &lt;span&gt;\( e \)&lt;/span&gt;. בהתחלה כתוב שם&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( tz-\frac{z^{2}}{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לב הרעיון הטכני (גם פה וגם בגישת המשוואה האינטגרלית) הוא &lt;strong&gt;להשלים לריבוע&lt;/strong&gt; את הביטוי הזה; להכניס את ה-&lt;span&gt;\( z \)&lt;/span&gt;-ים בצורה יפה לסוגריים שאותם מעלים בריבוע, ואולי להוציא החוצה איזה קבוע שקשור ל-&lt;span&gt;\( t \)&lt;/span&gt;. זו בדיוק אותה השלמה לריבוע שאיתה גם פותרים משוואה ריבועית, &lt;a href=&quot;https://gadial.net/2023/12/16/quadratic_equations/&quot;&gt;כמו שהראיתי&lt;/a&gt; פעם בבלוג.&lt;/p&gt;

&lt;p&gt;אז ראשית, בואו נעשה חישובון:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( tz-\frac{z^{2}}{2}=-\frac{1}{2}\left(z^{2}-2tz\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שבתוך הסוגריים כבר די קרוב למשהו ריבועי! רק צריך להוסיף ולחסר &lt;span&gt;\( t^{2} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( -\frac{1}{2}\left(z^{2}-2tz\right)=-\frac{1}{2}\left(z^{2}-2tz+t^{2}-t^{2}\right)=\frac{t^{2}}{2}-\frac{1}{2}\left(z-t\right)^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בום! ה-&lt;span&gt;\( \frac{t^{2}}{2} \)&lt;/span&gt; שקיבלנו יהיה בדיוק אותו &lt;span&gt;\( \frac{t^{2}}{2} \)&lt;/span&gt; ב-&lt;span&gt;\( e^{t^{2}/2} \)&lt;/span&gt; שאנחנו מצפים לקבל בסוף הדרך. בואו נחזור אל האינטגרל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{tz}e^{-z^{2}/2}dz=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{t^{2}/2-\left(z-t\right)^{2}/2}dz \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להוציא את הקבוע החוצה, תוך שימוש בכך ש-&lt;span&gt;\( e^{a-b}=e^{a}e^{-b} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{t^{2}/2-\left(z-t\right)^{2}/2}dz=e^{t^{2}/2}\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\left(z-t\right)^{2}/2}dz \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;את האינטגרל &lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\left(z-t\right)^{2}/2}dz \)&lt;/span&gt; אנחנו כבר יודעים לחשב; שברנו עליו את הראש כשרצינו להוכיח שפונקציית הצפיפות של ההתפלגות הנורמלית מסתכמת ל-1. העובדה שאנחנו צריכים לעבור דרכו היא “חוק שימור הקושי” - גם אם הייתי מנסה ללכת דרך משוואות אינטגרליות הייתי צריך לצלול בים טכני של טענות כלליות על הלהטוטים שאנחנו יכולים לעשות במסגרת חדו”א; למזלי בגישה הנוכחית אני יכול פשוט לומר שכבר עשינו את זה. מה שראינו היה &lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx=1 \)&lt;/span&gt;, וזה בדיוק אותו הדבר כמו אצלנו עד כדי החלפת המשתנה &lt;span&gt;\( x=z-t \)&lt;/span&gt; שלא משפיעה על האינטגרל כי גבולות האינטגרציה הם ממילא מ-&lt;span&gt;\( -\infty \)&lt;/span&gt; עד &lt;span&gt;\( \infty \)&lt;/span&gt; והיעקוביאן של ההחלפה (שהוא במקרה הזה פשוט נגזרת) יוצא 1.&lt;/p&gt;

&lt;h2&gt;ולסיום - אז למה הדברים הם כמו שהם?&lt;/h2&gt;

&lt;p&gt;לסיום סדרת הפוסטים הזו, בואו נחזור אל הפונקציה שאותה רצינו להבין: &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt;, פונקציית הצפיפות של התפלגות נורמלית. בשלב הזה אנחנו כבר יודעים ש-&lt;span&gt;\( \pi \)&lt;/span&gt; כאן כדי להבטיח שהכל יסתכם ל-1, שה-&lt;span&gt;\( \mu \)&lt;/span&gt; וה-&lt;span&gt;\( \sigma \)&lt;/span&gt; מייצגים את התוחלת וסטיית התקן ואפשר לנרמל אותם החוצה ושהאקספוננט מגיע, בגדול, מזה שהפונקציה שמתארת התנהלות של סכום משתנים מקריים בלתי תלויים ומפולגים אחיד נראית כמו&lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{\sqrt{n}}\right)\right]^{n} \)&lt;/span&gt;. וזה בעצם מגיע אל מה שהטריד &lt;strong&gt;אותי&lt;/strong&gt; עם משפט הגבול המרכזי: מה זה ה-&lt;span&gt;\( \frac{1}{\sqrt{n}} \)&lt;/span&gt; הזה? למה כדי לנרמל מחלקים דווקא בו? מה קרה ל-&lt;span&gt;\( \frac{1}{n} \)&lt;/span&gt; הישן והטוב? ולמה לחלק בכלל? בתחילת הפוסט הזכרתי את השימוש שעשיתי במשפט הגבול המרכזי - פשוט חיברתי את ה-&lt;span&gt;\( X_{i} \)&lt;/span&gt;-ים שלי וקירבתי את התוצאה הזו עם עקומה נורמלית; בשביל לעשות את זה לא הספיק לדעת רק את &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; אלא הייתי צריך להכניס גם את &lt;span&gt;\( n \)&lt;/span&gt; למשוואה: כפלתי ב-&lt;span&gt;\( n \)&lt;/span&gt; גם את &lt;span&gt;\( \mu \)&lt;/span&gt; וגם את &lt;span&gt;\( \sigma^{2} \)&lt;/span&gt; (כלומר, בפועל כפלתי את &lt;span&gt;\( \sigma \)&lt;/span&gt; ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; והנה השורש צץ שוב).&lt;/p&gt;

&lt;p&gt;אבל מה היה קורה אם מלכתחילה הייתי מנרמל על ידי חלוקה ב-&lt;span&gt;\( n \)&lt;/span&gt; ולכן מגיע אל חישוב של &lt;span&gt;\( \lim_{n\to\infty}\left[M\left(\frac{t}{n}\right)\right]^{n} \)&lt;/span&gt;? התשובה, כמובן, היא ששום דבר לא היה עובד. כזכור, כדי להתמודד עם הגבול הזה הגדרתי &lt;span&gt;\( L\left(t\right)=\log M\left(t\right) \)&lt;/span&gt; ואז חישבתי את הגבול &lt;span&gt;\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; באמצעות כלל לופיטל. עוד לפני שאומרים לופיטל, כבר ברור שהגבול &lt;span&gt;\( \lim_{n\to\infty}nL\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; קיים בכלל רק בזכות זה שיש פה שני כוחות שונים וסותרים שמאזנים אחד את השני. ה-&lt;span&gt;\( n \)&lt;/span&gt; שבו כופלים שואף לאינסוף, בעוד שה-&lt;span&gt;\( L\left(\frac{t}{\sqrt{n}}\right) \)&lt;/span&gt; שואף לאפס. בגבולות מהצורה “משהו ששואף לאינסוף כפול משהו ששואף לאפס” פחות או יותר הכל יכול לקרות, והסיכוי שנקבל תוצאה סופית תלוי ביחסים העדינים בין שתי הפונקציות שאותם כופלים. כלל לופיטל הוא בדיוק דרך “לקלף” מעל שתי הפונקציות המעורבות שכבה אחר שכבה של סיבוכיות עד שמגיעים אל הגרעין העדין שלהן שאנחנו יודעים להשוות. ועכשיו חדל פילוסופיה ובואו נדבר תכל’ס. מה היה קורה אם היינו מחלקים ב-&lt;span&gt;\( n \)&lt;/span&gt; ולא ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt;? (אם לא היינו מחלקים &lt;strong&gt;בכלל&lt;/strong&gt; ב-&lt;span&gt;\( n \)&lt;/span&gt; אז היינו מקבלים &lt;span&gt;\( \lim_{n\to\infty}L\left(t\right)=L\left(t\right) \)&lt;/span&gt; וקבוע כפול אינסוף הוא אינסוף).&lt;/p&gt;

&lt;p&gt;בואו נעשה קופי-פייסט מההוכחה שכתבתי קודם ונחליף כל מופע של -&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; ב-&lt;span&gt;\( n \)&lt;/span&gt;, עם ההשלכות המתאימות:&lt;/p&gt;

&lt;p&gt;הנגזרת של &lt;span&gt;\( L\left(\frac{t}{n}\right) \)&lt;/span&gt; על פי כלל השרשרת היא &lt;span&gt;\( \left(\frac{t}{n}\right)^{\prime}L^{\prime}\left(\frac{t}{n}\right)=-tn^{-2}L^{\prime}\left(\frac{t}{n}\right) \)&lt;/span&gt; , ולכן מכלל לופיטל אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}\frac{L\left(\frac{t}{n}\right)}{n^{-1}}=\lim_{n\to\infty}\frac{-tn^{-2}L^{\prime}\left(\frac{t}{n}\right)}{-n^{-2}}=\lim_{n\to\infty}tL^{\prime}\left(\frac{t}{n}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה… טוב? נפטרנו לגמרי מהגורם שבמכנה! אבל ראינו קודם ש-&lt;span&gt;\( L^{\prime}\left(0\right)=0 \)&lt;/span&gt;, כלומר &lt;span&gt;\( \lim_{n\to\infty}tL^{\prime}\left(\frac{t}{n}\right)=0 \)&lt;/span&gt;, וזה ממש לא טוב לנו. זה אומר שעבור המשתנה המקרי &lt;span&gt;\( Z_{n}=\frac{X_{1}+\ldots+X_{n}}{n} \)&lt;/span&gt; מתקיים &lt;span&gt;\( M_{Z}=e^{0}=1 \)&lt;/span&gt;, ובמילים אחרות - קיבלנו משתנה מקרי שכל המומנטים שלו הם 0. או, בניסוח שקצת יותר קל להבין - קיבלנו אפס. וזה לא אמור להיות מפתיע שקיבלנו אפס כי זה בדיוק מה שאומר &lt;strong&gt;אי-שוויון צ&apos;בישב&lt;/strong&gt; עבור התפלגויות שסטיית התקן שלהן היא אפס. כזכור, הוא אומר באופן כללי ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left|X-\mu\right|\ge k\right)\le\frac{\sigma^{2}}{k^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואם סטיית התקן &lt;span&gt;\( \sigma=0 \)&lt;/span&gt; זה אומר שלכל &lt;span&gt;\( k&amp;gt;0 \)&lt;/span&gt;, ההסתברות ש-&lt;span&gt;\( X \)&lt;/span&gt; יקבל ערך שסוטה מהתוחלת ולו ב-&lt;span&gt;\( k \)&lt;/span&gt; היא פשוט 0. עגול. לא קירוב ולא כלום. עכשיו שוב, צריך להזכיר שזה &lt;strong&gt;לא&lt;/strong&gt; אומר שהמשתנה המקרי הוא זהותית אפס; כשאנחנו עוסקים במשתנים מקריים רציפים כל מה שזה יכול לומר הוא שמידת ההסתברות של קבוצת כל התוצאות ששונות מ-&lt;span&gt;\( \mu \)&lt;/span&gt; היא אפס.&lt;/p&gt;

&lt;p&gt;את מה שראינו עכשיו אפשר לקחת טיפה יותר רחוק. בפוסט הקודם הגדרתי &lt;span&gt;\( \overline{X}_{n}=\frac{X_{1}+X_{2}\ldots+X_{n}}{n} \)&lt;/span&gt; (שזה בדיוק מה שקראתי לו כאן &lt;span&gt;\( Z_{n} \)&lt;/span&gt;) ואז הוכחתי שבהסתברות 1 מתקיים &lt;span&gt;\( \overline{X}_{n}\to\mu \)&lt;/span&gt;. התוצאה הזו, שנקראה &lt;strong&gt;החוק החזק של המספרים הגדולים&lt;/strong&gt;, דיברה על ההתנהגות של כל הסדרה &lt;span&gt;\( \overline{X}_{n} \)&lt;/span&gt; “בבת אחת”. אפשר לדבר על זה גם מזווית טיפה שונה. הרי אנחנו יודעים ש-&lt;span&gt;\( \overline{X}_{n} \)&lt;/span&gt; לא בהכרח יהיה &lt;strong&gt;שווה&lt;/strong&gt; לתוחלת - אנחנו צריכים לקחת עוד ועוד איברים ולהגדיל את &lt;span&gt;\( n \)&lt;/span&gt; כדי שהממוצע יתקרב לתוחלת וגם אז הסיכוי שהוא יהיה שווה לה הוא לא בהכרח גדול. אבל אפשר להעריך בצורה גסה מה יהיה גודל הטעות, בעזרת צ’בישב.&lt;/p&gt;

&lt;p&gt;אז נניח שיש לי משתנה &lt;span&gt;\( X \)&lt;/span&gt; כך ש-&lt;span&gt;\( \text{E}\left[X\right]=\mu \)&lt;/span&gt; ו-&lt;span&gt;\( \text{Var}\left(X\right)=\sigma^{2} \)&lt;/span&gt;. עכשיו בניתי משתנה חדש, &lt;span&gt;\( \overline{X}_{n}=\frac{X_{1}+\ldots+X_{n}}{n} \)&lt;/span&gt;. מה התוחלת שלו? לינאריות התוחלת נותנת לנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[\overline{X}_{n}\right]=\text{E}\left[\frac{X_{1}+\ldots+X_{n}}{n}\right]=\frac{\text{E}\left[X_{1}\right]+\ldots+\text{E}\left[X_{n}\right]}{n}=\frac{\mu+\ldots+\mu}{n}=\mu \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, שונות של משתנים מקריים לא מקיימת לינאריות באופן כללי, אבל היא &lt;strong&gt;כן&lt;/strong&gt; משמרת חיבור של משתנים מקריים &lt;strong&gt;בלתי תלויים&lt;/strong&gt; (די בדומה לאיך שתוחלת של מכפלה של משתנים בלתי תלויים מתפרקת למכפלת תוחלות). בפוסט הקודם גם הזכרתי ש-&lt;span&gt;\( \text{Var}\left(\alpha X\right)=\alpha^{2}X \)&lt;/span&gt;. לכן אפשר לחשב:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(\overline{X}_{n}\right)=\text{Var}\left(\frac{X_{1}+\ldots+X_{n}}{n}\right)=\frac{\text{Var}\left(X_{1}\right)+\ldots+\text{Var}\left(X_{n}\right)}{n^{2}}=\frac{\sigma^{2}+\ldots\sigma^{2}}{n^{2}}=\frac{\sigma^{2}}{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן מאי-שוויון צ’בישב:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left|\overline{X}_{n}-\mu\right|\ge\varepsilon\right)\le\frac{\sigma^{2}}{n\varepsilon^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המספר המעניין פה הוא ה-&lt;span&gt;\( n \)&lt;/span&gt; שנשאר במכנה. בזכותו, אם משאיפים את &lt;span&gt;\( n \)&lt;/span&gt; לאינסוף, מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \lim_{n\to\infty}P\left(\left|\overline{X}_{n}-\mu\right|\ge\varepsilon\right)=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה מה שנקרא &lt;strong&gt;החוק החלש של המספרים הגדולים&lt;/strong&gt; (כי החוק החזק של המספרים הגדולים גורר אותו - ה”התכנסות” שלו היא חזקה יותר מההתכנסות שיש בחוק החלש) וזו דרך קצת יותר פשוטה לראות את “חוסר הטעם” שבהסתכלות על הממוצעים &lt;span&gt;\( \overline{X}_{n} \)&lt;/span&gt; אם אנחנו רוצים לקבל משתנה מקרי שמדמה את ההתפלגות של &lt;span&gt;\( X_{1}+\ldots+X_{n} \)&lt;/span&gt; כש-&lt;span&gt;\( n \)&lt;/span&gt; גדול. המיצוע שאנחנו עושים הוא “טוב מדי” - הוא משמר את המידע על ההתפלגות שבא לידי ביטוי בתוחלת &lt;span&gt;\( \mu \)&lt;/span&gt; אבל מוחק את המידע על ההתפלגות שבא לידי ביטוי בסטיית התקן &lt;span&gt;\( \sigma \)&lt;/span&gt;. המיצוע שבו מחלקים ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; הוא “עדין” יותר ומשמר גם את המידע הזה, והוכחת החוק החלש של המספרים הגדולים נותנת עוד דרך לראות את זה - אם היינו מחלקים ב-&lt;span&gt;\( \sqrt{n} \)&lt;/span&gt; ומנסים להשתמש בצ’בישב, היינו מקבלים רק &lt;span&gt;\( P\left(\left|\frac{X_{1}+\ldots+X_{n}}{\sqrt{n}}-\mu\right|\ge\varepsilon\right)\le\frac{\sigma^{2}}{\varepsilon^{2}} \)&lt;/span&gt; שזו תוצאה מעניינת טיפה בפני עצמה אבל אין בה שאיפה לאפס של ההסתברות אלא רק חסם אחיד לכל הממוצעים, לא משנה כמה רחוק ניקח אותם.&lt;/p&gt;

&lt;p&gt;הקסם הגדול של משפט הגבול המרכזי בעיני, כמו שאמרתי כבר לפני כמה פוסטים, הוא שלא משנה כמה המשתנה &lt;span&gt;\( X \)&lt;/span&gt; שאנחנו מתחילים איתו הוא מורכב ומתוסבך - ההתנהגות של &lt;span&gt;\( X_{1}+\ldots+X_{n} \)&lt;/span&gt; תהיה ניתנת לקירוב מצוין רק עם שני הפרמטרים המספריים &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt;. ראינו את זה בתוך ההוכחה של משפט הגבול המרכזי עצמו (היינו צריכים רק לדעת את &lt;span&gt;\( L^{\prime}\left(0\right) \)&lt;/span&gt; ואת &lt;span&gt;\( L^{\prime\prime}\left(0\right) \)&lt;/span&gt; כדי לקבל אותו ולא משהו שתלוי במומנטים מתקדמים יותר) וראינו את זה גם עם החוק החלש של המספרים הגדולים עכשיו (אם המומנט השני הוא אפס גורלה של ההתפלגות נחרץ להיות קבועה בהסתברות 1), אבל למרות שראינו את זה אני עדיין מתקשה להאמין לזה. אולי כי זו לא סתם תוצאה מספרית - זה משהו שבאמת בא לידי ביטוי אמפירית, במציאות, בעולם שלנו, ומשפיע עלינו בשלל דרכים שונות. גם זה אחד מהקסמים של המתמטיקה.&lt;/p&gt;</content><author><name></name></author><category term="התפלגות נורמלית" /><summary type="html">אז מה משפט הגבול המרכזי אומר?</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/2025/histogram_10.png" /><media:content medium="image" url="http://gadial.net/assets/img/2025/histogram_10.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מה הקטע עם התפלגות נורמלית? (חלק ג’: על תוחלת וסטיית תקן)</title><link href="http://gadial.net/2025/02/05/normal_distribution_3/" rel="alternate" type="text/html" title="מה הקטע עם התפלגות נורמלית? (חלק ג&apos;: על תוחלת וסטיית תקן)" /><published>2025-02-05T00:00:00+00:00</published><updated>2025-02-05T00:00:00+00:00</updated><id>http://gadial.net/2025/02/05/normal_distribution_3</id><content type="html" xml:base="http://gadial.net/2025/02/05/normal_distribution_3/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;בסדרת הפוסטים הנוכחית אנחנו מנסים להבין למה ההתפלגות הנורמלית &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt; נראית כמו שהיא נראית. &lt;a href=&quot;https://gadial.net/2025/02/03/normal_distribution_2/&quot;&gt;בפוסט הקודם&lt;/a&gt; הבנו מה הפונקציה הזו בכלל אומרת - זו &lt;strong&gt;פונקציית צפיפות ההסתברות&lt;/strong&gt; של ההתפלגות הנורמלית, כלומר אם &lt;span&gt;\( X \)&lt;/span&gt; הוא המשתנה המקרי שמתואר על ידי הפונקציה הזו, אז &lt;span&gt;\( P\left(a\le X\le b\right)=\int_{a}^{b}\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}dx \)&lt;/span&gt;. בפוסט הקודם גם ראינו מאיפה ה-&lt;span&gt;\( \pi \)&lt;/span&gt; הגיע - זה קבוע נרמול שנדרש כדי שיתקיים &lt;span&gt;\( \int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{x^{2}}{2}}=1 \)&lt;/span&gt;. אבל מה הם ה-&lt;span&gt;\( \mu \)&lt;/span&gt; וה-&lt;span&gt;\( \sigma \)&lt;/span&gt; שמופיעים בנוסחה? אלו שני פרמטרים שמאפיינים לא רק את ההתפלגות הזו, אלא כל התפלגות שהיא: &lt;strong&gt;התוחלת&lt;/strong&gt; &lt;span&gt;\( \mu \)&lt;/span&gt; של ההתפלגות, &lt;strong&gt;וסטיית התקן&lt;/strong&gt; &lt;span&gt;\( \sigma \)&lt;/span&gt; שלה. באופן לא פורמלי, תוחלת של התפלגות היא הממוצע שלה, וסטיית התקן מלמדת אותנו כמה גדול הפיזור של ההתפלגות סביב הממוצע הזה. מה שמפליא הוא כמה מידע על ההתפלגות נמצא כבר בשני הערכים המספריים הללו - וההמחשה לזה היא בדיוק &lt;strong&gt;משפט הגבול המרכזי&lt;/strong&gt;, שאומר שאם אנחנו יודעים את התוחלת וסטיית התקן של התפלגות, אז נדע בדיוק איך נראה מה שמתקבל מסכומים גדולים של משתנים מקריים בלתי תלויים בעלי ההתפלגות הזו.&lt;/p&gt;

&lt;p&gt;בואו נעבור להגדרות פורמליות, ונראה איך זה בא לידי ביטוי בהתפלגות נורמלית ובהתפלגויות אחרות שראינו.&lt;/p&gt;

&lt;h2&gt;תוחלת&lt;/h2&gt;

&lt;p&gt;מה זה “ממוצע”? אם למשל יש לנו את סדרת המספרים &lt;span&gt;\( 10,30,50,60,90 \)&lt;/span&gt; הממוצע שלה היא הסכום של כל המספרים חלקי כמה מספרים יש: &lt;span&gt;\( \frac{10+30+50+60+90}{5}=\frac{240}{5}=48 \)&lt;/span&gt;. מה המשמעות של המספר הזה, 48? אפשר לחשוב על זה כך: אם נחליף כל איבר בסדרה ב-48, נקבל סדרה &lt;span&gt;\( 48,48,48,48,48 \)&lt;/span&gt; שסכום האיברים שלה שווה לסכום אברי הסדרה המקורית.&lt;/p&gt;

&lt;p&gt;את הרעיון הזה אפשר להכליל קצת: אם למשל הסדרה שלנו היא &lt;span&gt;\( 30,60,60 \)&lt;/span&gt; אז הממוצע שלה הוא &lt;span&gt;\( 50 \)&lt;/span&gt;, אבל אפשר גם “לאחד” את שני ה-60-ים ולהגיד שיש בסדרה שלנו שני איברים: האיבר &lt;span&gt;\( 30 \)&lt;/span&gt; עם &lt;strong&gt;המשקל&lt;/strong&gt; 1, והאיבר &lt;span&gt;\( 60 \)&lt;/span&gt; עם &lt;strong&gt;המשקל&lt;/strong&gt; 2. מה שאנחנו עושים הוא לסכום את האיברים כשכל אחד מוכפל במשקל שלו, ולחלק בסכום הכולל של המשקלים. אולי קל יותר להבין את זה עם נוסחה: אם יש לנו את הסדרה &lt;span&gt;\( a_{1},a_{2},\ldots,a_{n} \)&lt;/span&gt; ואת המשקלים &lt;span&gt;\( w_{1},\ldots,w_{n} \)&lt;/span&gt; אז &lt;strong&gt;הממוצע המשוקלל&lt;/strong&gt; הוא &lt;span&gt;\( \frac{\sum_{i=1}^{n}w_{i}a_{i}}{\sum_{i=1}^{n}w_{i}} \)&lt;/span&gt;. כאשר כל המשקלים הם 1 אנחנו מקבלים את הגדרת הממוצע הקודמת.&lt;/p&gt;

&lt;p&gt;ההגדרה של ממוצע משוקלל לא דורשת שום דבר מהמשקלים, חוץ מכך שהסכום שלהם יהיה שונה מאפס (אחרת יקרה משהו מוזר כשמנסים לחלק) אבל כמובן, ההגדרה הזו יוצאת פשוטה במיוחד אם &lt;span&gt;\( 0\le w_{i}\le1 \)&lt;/span&gt; ובנוסף &lt;span&gt;\( \sum_{i=1}^{n}w_{i} \)&lt;/span&gt;; אנחנו מקבלים שהממוצע המשוקלל הוא פשוט &lt;span&gt;\( \sum_{i=1}^{n}w_{i}a_{i} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;איך כל זה קשור להסתברות? ובכן, הסתברות היא בדיוק המקרה שבו יש לנו איברים &lt;span&gt;\( 0\le w_{i}\le1 \)&lt;/span&gt; שמסתכמים ל-1: אם יש לנו מרחב הסתברות ו-&lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי שמקבל מספר &lt;strong&gt;סופי&lt;/strong&gt; של ערכים, נאמר הערכים &lt;span&gt;\( a_{1},a_{2},\ldots,a_{n} \)&lt;/span&gt;, אז אפשר להסתכל על הממוצע המשוקלל &lt;span&gt;\( \sum_{i=1}^{n}P\left(X=a_{i}\right)\cdot a_{i} \)&lt;/span&gt;. כלומר, אנחנו לוקחים את הממוצע המשוקלל של ה-&lt;span&gt;\( a_{i} \)&lt;/span&gt;-ים כשהמשקולות הן בדיוק ההסתברויות ש-&lt;span&gt;\( a_{i} \)&lt;/span&gt; יעלה בגורל. סכום כזה נקרא &lt;strong&gt;תוחלת&lt;/strong&gt; ומסומן ב-&lt;span&gt;\( E\left[X\right] \)&lt;/span&gt;. אם מרחב המדגם הוא אינסופי העניינים מן הסתם מסתבכים קצת מתמטית אבל הרעיון זהה: &lt;span&gt;\( \text{E}\left[X\right]=\sum_{i=1}^{\infty}P\left(X=a_{i}\right)\cdot a_{i} \)&lt;/span&gt; עבור מרחב מדגם אינסופי בדיד, ו-&lt;span&gt;\( \text{E}\left[X\right]=\int_{-\infty}^{\infty}p\left(x\right)xdx \)&lt;/span&gt; עבור מרחב מדגם אינסופי רציף.&lt;/p&gt;

&lt;p&gt;למה ממוצע משוקלל כזה הוא מעניין? אנחנו הרי מצפים שהוא ילמד אותנו משהו על המשתנה המקרי &lt;span&gt;\( X \)&lt;/span&gt; ולא סתם יהיה הגדרה לשם הגדרה. כאן זו אחת מהסיטואציות הנדירות שבהן המתמטיקה הייתה מדע &lt;strong&gt;אמפירי&lt;/strong&gt;: קודם כל התגלתה תופעה, ואחר כך הוכיחו אותה מתמטית. התופעה הייתה האבחנה שאם אנחנו חוזרים על אותו ניסוי הסתברותי מספרי שוב ושוב, &lt;strong&gt;הממוצע&lt;/strong&gt; של התוצאות שלנו נוטה להיות יציב יחסית ככל שמספר הניסויים שאנחנו מבצעים גדל. בואו נראה דוגמא קונקרטית לזה עם הטלת קוביה. בימינו, למרבה השמחה, אפשר לרתום את המחשב לניסויים כאלו, אז הנה קוד פייתון קצרצר:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;f&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;מה שהקוד הזה עושה הוא להטיל קוביה מספר כלשהו של פעמים שמסומן ב-&lt;span&gt;\( N \)&lt;/span&gt;, ואז לחשב את ממוצע ההטלות. אנחנו עושים את הניסוי הזה בנפרד עבור ערכי &lt;span&gt;\( N \)&lt;/span&gt; מ-&lt;span&gt;\( 10 \)&lt;/span&gt; עד &lt;span&gt;\( 10^{6} \)&lt;/span&gt;, ולכל אחד מהם אנחנו מדפיסים את הממוצע. כשאני עשיתי את זה, קיבלתי:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.1&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.56&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.372&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.4951&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.50129&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.499845&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;די בבירור, הממוצע מתקרב אל &lt;span&gt;\( 3.5 \)&lt;/span&gt;. זו אבחנה אמפירית; אבל אם אנחנו רוצים לדעת לאן הממוצע ישאף אנחנו &lt;strong&gt;לא צריכים&lt;/strong&gt; לבצע ניסויים בפועל - אנחנו יכולים פשוט &lt;strong&gt;לחשב&lt;/strong&gt; את זה, ואיכשהו מובטח שהמציאות תסתדר בהתאם לחישוב שלנו. הערך שאנחנו מחשבים הוא - הפתעה הפתעה - התוחלת של המשתנה המקרי שמתאר את הניסוי.&lt;/p&gt;

&lt;p&gt;במקרה שלנו, &lt;span&gt;\( X \)&lt;/span&gt; מקבל כל ערך בין 1 ל-6 בהסתברות &lt;span&gt;\( \frac{1}{6} \)&lt;/span&gt; לכל איבר, אז על פי הגדרה &lt;span&gt;\( E\left[X\right]=\frac{1+2+3+4+5+6}{6}=\frac{21}{6}=3.5 \)&lt;/span&gt;. אין פה הפתעה, אבל מה שכן יש פה הוא חישוב פשוט למדי, שלא מצריך הטלת מיליון קוביות. והיופי פה הוא שזה עובד &lt;strong&gt;תמיד&lt;/strong&gt;, לכל משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt; שאנחנו משכפלים &lt;span&gt;\( n \)&lt;/span&gt; עותקים זהים שלו שהם בלתי תלויים אחד בשני ומסתכלים על הממוצע של כולם (טוב, &lt;a href=&quot;https://gadial.net/2008/07/25/envelope_paradox/&quot;&gt;כמעט תמיד&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;לתופעה הזו קוראים &lt;strong&gt;חוק המספרים הגדולים&lt;/strong&gt;. יש כמה ניסוחים למשפט שאומר “מה הולך פה” והניסוח הנפוץ הוא בדרך כלל של מה שנקרא &lt;strong&gt;החוק החזק של המספרים הגדולים&lt;/strong&gt; שלא אוכיח כרגע אבל כן אסביר מה הוא אומר. אנחנו מתחילים עם סדרה אינסופית של משתנים מקריים &lt;span&gt;\( X_{1},X_{2},X_{3},\ldots \)&lt;/span&gt; שכולם מתפלגים באותו האופן (כלומר, בעלי אותה פונקצית צפיפות הסתברות) והם בלתי תלויים, במובן הבא: &lt;span&gt;\( X,Y \)&lt;/span&gt; הם בלתי תלויים אם לכל שתי קבוצות אפשריות של תוצאות &lt;span&gt;\( A,B \)&lt;/span&gt; מתקיים &lt;span&gt;\( P\left(X\in A\wedge Y\in B\right)=P\left(X\in A\right)P\left(Y\in B\right) \)&lt;/span&gt;; ראינו את זה טיפה בפוסט הקודם ולא אתעכב על זה הפעם.&lt;/p&gt;

&lt;p&gt;עכשיו, מכיוון שכל המשתנים מתפלגים אותו דבר, יש להם אותה תוחלת. באופן כללי תוחלת עשויה להיות אינסופית או לא מוגדרת, אבל נניח שכאן היא מספר סופי, &lt;span&gt;\( E\left[X_{i}\right]=\mu \)&lt;/span&gt;. במקרה הזה אנחנו יכולים להסתכל על המשתנה המקרי &lt;span&gt;\( \overline{X}_{n}=\frac{X_{1}+X_{2}\ldots+X_{n}}{n} \)&lt;/span&gt;, שהוא המשתנה שמתאר את הממוצע (הרגיל, הלא משוקלל) של &lt;span&gt;\( n \)&lt;/span&gt; התוצאות הראשונות בסדרת המשתנים המקריים. החוק החזק של המספרים הגדולים אומר שמתקיים &lt;span&gt;\( \overline{X}_{n}\to\mu \)&lt;/span&gt; בהסתברות 1. בואו נבין טיפה יותר מה זה אומר בעצם.&lt;/p&gt;

&lt;p&gt;ה-&lt;span&gt;\( \overline{X}_{n} \)&lt;/span&gt;-ים שהגדרנו מתארים &lt;strong&gt;סדרה&lt;/strong&gt; של משתנים שמתארת את הממוצעים ההולכים-ומשתפרים: &lt;span&gt;\( \overline{X}_{1},\overline{X}_{2},\overline{X}_{3},\ldots \)&lt;/span&gt;. אם אנחנו דוגמים איבר &lt;span&gt;\( a \)&lt;/span&gt; כלשהו במרחב המדגם שלנו, הוא ייתן למשתנים &lt;span&gt;\( X_{1},X_{2},\dots \)&lt;/span&gt; ערכים קונקרטיים שהם מספרים ממשיים: &lt;span&gt;\( X_{1}\left(a\right),X_{2}\left(a\right),\ldots \)&lt;/span&gt;, ולכן גם בסדרת הממוצעים נקבל ערכים קונקרטיים &lt;span&gt;\( \overline{X}_{1}\left(a\right),\overline{X}_{2}\left(a\right),\ldots \)&lt;/span&gt;; כלומר, בהינתן שאנחנו מסתכלים על איבר קונקרטי של מרחב המדגם, קיבלנו סדרה “רגילה” של מספרים ממשיים. על סדרה “רגילה” של ממשיים אפשר לשאול האם היא מקיימת את התכונה &lt;span&gt;\( \lim_{n\to\infty}\overline{X}_{n}\left(a\right)=\mu \)&lt;/span&gt;, כלומר האם לכל &lt;span&gt;\( \varepsilon&amp;gt;0 \)&lt;/span&gt; קיים &lt;span&gt;\( N \)&lt;/span&gt; כך שלכל &lt;span&gt;\( n&amp;gt;N \)&lt;/span&gt; מתקיים &lt;span&gt;\( \left|\overline{X}_{n}\left(a\right)-\mu\right|&amp;lt;\varepsilon \)&lt;/span&gt;. לכל &lt;span&gt;\( a \)&lt;/span&gt; במרחב המדגם שלנו התשובה לשאלה הזו היא או “כן” או “לא”. החוק החזק של המספרים הגדולים אומר שקבוצת כל ה-&lt;span&gt;\( a \)&lt;/span&gt;-ים שעבורה התשובה היא “לא” היא ממידה אפס (זה לא אומר שזה לא יכול לקרות; זה אומר שזה זניח).&lt;/p&gt;

&lt;p&gt;אני לא אוכיח כאן את חוק המספרים הגדולים; אני בעיקר משתמש בו כדי לתת מוטיבציה לסיבה שבגללה מושג התוחלת קופץ לנו לפרצוף ודורש שנגדיר אותו. יש עוד שימושים דומים לתוחלת, כשהפשוט שבהם הוא כנראה &lt;strong&gt;אי שוויון מרקוב&lt;/strong&gt;: אם &lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי שמקבל רק ערכים אי-שליליים ו-&lt;span&gt;\( a&amp;gt;0 \)&lt;/span&gt; כלשהו, אז&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X\ge a\right)\le\frac{\text{E}\left[X\right]}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בניסוח שקול שקצת יותר מאפשר להבין מה הקטע אפשר להכניס את התוחלת לתוך אי השוויון:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X\ge a\cdot\text{E}\left[X\right]\right)\le\frac{1}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, זה נותן הערכה גסה לשאלה מה הסיכוי ש-&lt;span&gt;\( X \)&lt;/span&gt; יהיה גדול מפי 2 התוחלת שלו (פחות מחצי), מפי 3 התוחלת שלו (פחות משליש) וכו’. זו באמת הערכה גסה, אבל לעתים קרובות היא מספיקה כדי להוכיח את מה שרוצים לעשות באותו רגע ולכן, בנוסף לפשטות שלו, אי השוויון הזה הוא כלי שימושי מאוד.&lt;/p&gt;

&lt;p&gt;ההוכחה של אי שוויון מרקוב מצחיקה בכמה שהיא פשוטה. אני מגדיר משתנה מקרי &lt;span&gt;\( I \)&lt;/span&gt; שהוא מה שנקרא &lt;strong&gt;אינדיקטור&lt;/strong&gt;: משתנה מקרי שמקבל או 0 או 1, ולכן בעצם נותן “אינדיקציה” לכך שאירוע מסוים קרה או לא. במקרה שלנו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( I=\begin{cases} 1 &amp;amp; X\ge a\\ 0 &amp;amp; X&amp;lt;a \end{cases} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;התוחלת של אינדיקטור, ממש על פי ההגדרה, היא ההסתברות שהאירוע שנותן 1 קרה, כלומר &lt;span&gt;\( E\left[I\right]=P\left(X\ge a\right) \)&lt;/span&gt;. עכשיו, שימו לב ש-&lt;span&gt;\( I\le\frac{X}{a} \)&lt;/span&gt; ותאמינו לי שאפשר פשוט לקחת תוחלת לשני האגפים ולהוציא את הקבוע החוצה, ונקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X\ge a\right)=E\left[I\right]=\frac{E\left[X\right]}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אתם כמובן לא אמורים להאמין לי שפשוט אפשר לעשות את זה, אבל אני לא אוכיח את זה הפעם. את הקטע עם “להוציא את הקבוע החוצה” אפשר להכליל - התוחלת מקיימת תכונה מועילה מאוד שנקראת &lt;strong&gt;לינאריות&lt;/strong&gt;: אם &lt;span&gt;\( X,Y \)&lt;/span&gt; הם משתנים מקריים כלשהם (שיכולים להיות גם תלויים) ו-&lt;span&gt;\( \alpha,\beta \)&lt;/span&gt; הם קבועים מספריים, אז &lt;span&gt;\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)&lt;/span&gt; (ואפשר להכליל את זה לסכום סופי כלשהו של משתנים מקריים).&lt;/p&gt;

&lt;p&gt;הראיתי את המושג האבסטרקטי של תוחלת ואיזו דוגמא מסכנה עם הטלת קוביה, אבל זה לא מספיק, בואו נראה דוגמא קונקרטית - מה שנקרא &lt;strong&gt;התפלגות בינומית&lt;/strong&gt;. בהתפלגות בינומית יש לנו ניסוי בסיסי שחוזר על עצמו עם הסתברות &lt;span&gt;\( p \)&lt;/span&gt; להצליח ו-&lt;span&gt;\( q=1-p \)&lt;/span&gt; להיכשל בכל פעם; כבר ראינו שאם חוזרים על הניסוי &lt;span&gt;\( n \)&lt;/span&gt; פעמים אז ההסתברות לקבל בדיוק &lt;span&gt;\( k \)&lt;/span&gt; הצלחות היא &lt;span&gt;\( p\left(X=k\right)={n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;. לכן, התוחלת של המשתנה המקרי הזה היא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X\right]=\sum_{k=0}^{n}k{n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;יש טריק מתמטי לא מסובך שמאפשר לחשב את הסכום הזה, אבל למרבה השמחה הוא עובד באופן קצת יותר כללי ויאפשר לחשב לא רק את &lt;span&gt;\( \text{E}\left[X\right] \)&lt;/span&gt; אלא גם את &lt;span&gt;\( \text{E}\left[X^{t}\right] \)&lt;/span&gt; לכל חזקה טבעית &lt;span&gt;\( t \)&lt;/span&gt;, וזה הולך לעזור לנו בקרוב (הערכים &lt;span&gt;\( \text{E}\left[X^{t}\right] \)&lt;/span&gt; נקראים &lt;strong&gt;המומנטים&lt;/strong&gt; של המשתנה המקרי &lt;span&gt;\( X \)&lt;/span&gt; ויש להם חשיבות באופן כללי). הסכום במקרה הכללי יותר הזה הוא&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X^{t}\right]=\sum_{k=0}^{n}k^{t}{n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כי הדרך היחידה שבה הערך &lt;span&gt;\( k^{t} \)&lt;/span&gt; יכול להתקבל על ידי המשתנה &lt;span&gt;\( X^{t} \)&lt;/span&gt; היא אם הערך &lt;span&gt;\( k \)&lt;/span&gt; יתקבל על ידי המשתנה &lt;span&gt;\( X \)&lt;/span&gt;, כלומר &lt;strong&gt;ההסתברות&lt;/strong&gt; היא אותו דבר וכל מה שהשתנה הוא שמופיע בתחילת הסכום &lt;span&gt;\( k^{t} \)&lt;/span&gt; במקום סתם &lt;span&gt;\( k \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, קודם כל שימו לב שאם &lt;span&gt;\( k=0 \)&lt;/span&gt; האיבר שמתאים למקרה הזה הוא פשוט אפס, כלומר אפשר לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X^{t}\right]=\sum_{k=1}^{n}k^{t}{n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הטריק הוא עכשיו לפתוח את ההגדרה של &lt;span&gt;\( {n \choose k}=\frac{n!}{k!\left(n-k\right)!} \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( k{n \choose k}=k\cdot\frac{n!}{k!\left(n-k\right)!}=n\frac{k}{k!}\cdot\frac{\left(n-1\right)!}{\left(n-k\right)!}=n\frac{\left(n-1\right)!}{\left(k-1\right)!\left(n-k\right)!}=n{n-1 \choose k-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;נציב את זה אצלנו ועל הדרך נוציא &lt;span&gt;\( p \)&lt;/span&gt; אחד החוצה כדי להקטין את החזקה של &lt;span&gt;\( p \)&lt;/span&gt; באחד:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=1}^{n}k^{t}{n \choose k}p^{k}q^{n-k}=np\sum_{k=1}^{n}k^{t-1}{n-1 \choose k-1}p^{k-1}q^{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו נבצע החלפת משתנה &lt;span&gt;\( i=k-1 \)&lt;/span&gt;. כלומר כש-&lt;span&gt;\( k=1 \)&lt;/span&gt; אז &lt;span&gt;\( i=0 \)&lt;/span&gt; ואילו כש-&lt;span&gt;\( k=n \)&lt;/span&gt; אז &lt;span&gt;\( i=n-1 \)&lt;/span&gt;, ולכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( np\sum_{k=1}^{n}k^{t-1}{n-1 \choose k-1}p^{k-1}q^{n-k}=np\sum_{i=0}^{n-1}\left(i+1\right)^{t-1}{n-1 \choose i}p^{i}q^{n-i-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו בואו נסתכל על הביטוי שקיבלנו בסכום:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{i=0}^{n-1}\left(i+1\right)^{t-1}{n-1 \choose i}p^{i}q^{n-i-1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;חוץ מה-&lt;span&gt;\( \left(i+1\right)^{t-1} \)&lt;/span&gt; בהתחלה זה נראה בדיוק כמו סכום על ההסתברויות של משתנה בינומי אחר שאסמן &lt;span&gt;\( Y \)&lt;/span&gt;, עם &lt;span&gt;\( n-1 \)&lt;/span&gt; נסיונות ואותן הסתברויות הצלחה וכישלון &lt;span&gt;\( p,q \)&lt;/span&gt;. ה-&lt;span&gt;\( \left(i+1\right)^{t-1} \)&lt;/span&gt; בתחילת הסכום נראה קצת מוזר אבל אם חושבים על זה, רואים שהסכום פשוט שווה אל &lt;span&gt;\( \text{E}\left[\left(Y+1\right)^{t-1}\right] \)&lt;/span&gt;. כלומר קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X^{t}\right]=np\text{E}\left[\left(Y+1\right)^{t-1}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במקרה הבסיס שבו &lt;span&gt;\( t=1 \)&lt;/span&gt; אז &lt;span&gt;\( \left(Y+1\right)^{t-1} \)&lt;/span&gt; הוא פשוט הקבוע 1 ולכן התוחלת שלו היא 1 ולכן קיבלנו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X\right]=np \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אבל עם הנוסחה נוכל לחשב בקלות גם את &lt;span&gt;\( \text{E}\left[X^{2}\right] \)&lt;/span&gt;, למשל. כי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X^{2}\right]=np\text{E}\left[Y+1\right]=np\left(\text{E}\left[Y\right]+1\right)=np\left(\left(n-1\right)p+1\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן למשל השתמשתי בלינאריות של התוחלת. אבל למה בעצם &lt;span&gt;\( \text{E}\left[X^{2}\right] \)&lt;/span&gt; מעניין אותי? או, אנחנו בדיוק מגיעים אל זה.&lt;/p&gt;

&lt;h2&gt;שונות וסטיית תקן&lt;/h2&gt;

&lt;p&gt;ראינו זה עתה שאם &lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה בינומי שמתאר ספירה של הצלחות בניסוי שחוזר על עצמו &lt;span&gt;\( n \)&lt;/span&gt; פעמים עם הסתברות הצלחה &lt;span&gt;\( p \)&lt;/span&gt; בכל פעם, אז התוחלת שלו היא &lt;span&gt;\( np \)&lt;/span&gt;. ראינו גם שהתוחלת של התוצאה בהטלת קובייה הוגנת היא &lt;span&gt;\( 3.5 \)&lt;/span&gt;. אז אם נבחר את הפרמטרים של &lt;span&gt;\( X \)&lt;/span&gt; להיות &lt;span&gt;\( n=7,p=\frac{1}{2} \)&lt;/span&gt; נקבל שהתוחלת של &lt;span&gt;\( X \)&lt;/span&gt; היא גם &lt;span&gt;\( 3.5 \)&lt;/span&gt;: התוחלת של “הטל מטבע הוגן 7 פעמים וספור כמה פעמים התקבל עץ” היא אותה תוחלת כמו של “הטל קוביה הוגנת ובדוק מה יצא”. אבל אלו בבירור ניסויים שונים למדי זה מזה - בהטלת קוביה לכל תוצאה יש אותו סיכוי, ובניסוי הבינומי אין סימטריה כזו ויש גם ערכים כמו 0 ו-7 שלא יכולים לצוץ בהטלת קוביה. עוד משחק שאני יכול לעשות הוא לשחק “הטלת מטבע” עם מטבע שהערך של צד אחד שלו הוא 0 והערך של הצד השני שלו הוא 7: גם במקרה הזה נקבל תוחלת &lt;span&gt;\( 3.5 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אם אני לוקח את שלושת הניסויים השונים הללו ועושה עליהם את מה שעשיתי בפוסט הראשון בסדרה, כלומר מצייר את העקומה של ההתפלגות הנורמלית שמקרבת את מה שמקבלים אם חוזרים על הניסוי 100 פעמים וסוכמים את התוצאות - זה מה שאני אקבל:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_12.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;יש כאן שלוש עקומות נורמליות, שניסיתי לצבוע בצבעים שונים כדי להבדיל ביניהן (אבל אני לא בטוח אם הצבעים ייראו שונים לכל הקוראים). העקומה שמגיעה הכי גבוהה, שצבועה באדום, מתאימה למשתנה הבינומי; האמצעית, שצבועה בכחול, מתאימה למשתנה של הקוביה; והתחתונה, הירוקה, מתאימה למשתנה של המטבע עם הערכים 0 ו-7.&lt;/p&gt;

&lt;p&gt;מה הסיבה להבדל? ככל שעקומה נורמלית היא יותר גבוהה, כך זה אומר שרוב ההסתברות שהיא מייצגת מתארת טווח קטן יחסית. המקרה הקיצוני ביותר הוא המשתנה המקרי שפשוט מחזיר &lt;span&gt;\( 3.5 \)&lt;/span&gt; תמיד, שיתואר על ידי קו אנכי בודד בדיוק ב-&lt;span&gt;\( 350 \)&lt;/span&gt;. הסיבה שהעקומה הירוקה, הנמוכה, היא כל כך “רחבה” היא שהניסוי שהיא מתארת הוא בעל רק שני ערכים, ששניהם במרחק לא זניח מהתוחלת עצמה ולכן כל אי-אחידות בתוצאות של ההגרלה (נניח, יתרון של 9 הטלות שנתנו 7 במקום 0) “מושך” את הסכום הכולל רחוק מהממוצע הצפוי. זו האינטואיציה, אבל אנחנו רוצים את המתמטיקה הקונקרטית - מדד מספרי שיאפשר לנו לתאר עד כמה סטייה מהתוחלת היא משהו נפוץ או נדיר.&lt;/p&gt;

&lt;p&gt;אם &lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי ו-&lt;span&gt;\( \mu=\text{E}\left[X\right] \)&lt;/span&gt; היא התוחלת שלו, אפשר להסתכל על משתנה מקרי חדש, &lt;span&gt;\( Y=X-\mu \)&lt;/span&gt;. זה המשתנה המקרי המקורי, רק שעכשיו הוא מנורמל כך שהתוחלת שלו תהיה 0. מכיוון שמה שמעניין אותנו הוא גודל ה”סטייה מהממוצע”, והגודל הזה הוא פשוט &lt;span&gt;\( \left|Y\right| \)&lt;/span&gt;, אפשר לשאול את עצמנו &lt;strong&gt;מה הסטייה הממוצע מהממוצע&lt;/strong&gt;, כלומר &lt;span&gt;\( \text{E}\left[\left|Y\right|\right] \)&lt;/span&gt;. זה אמנם מדד מתבקש למדי, אבל הוא פחות מועיל מאשר אפשר היה לקוות. פונקציית הערך המוחלט היא לא “נחמדה” מבחינה מתמטית - בפרט, היא לא גזירה ב-0. עניין אחר הוא שהיא מאותו סדר גודל כמו &lt;span&gt;\( Y \)&lt;/span&gt; ודווקא יש עניין בכך שנעבור אל “סדר הגודל הבא”. זה מוביל אותנו להגדרה שאולי נראית פחות טבעית ממבט ראשון אבל היא שימושית בצורה בלתי נתפסת: &lt;span&gt;\( \text{Var}\left(X\right)=\text{E}\left[Y^{2}\right]=\text{E}\left[\left(X-\mu\right)^{2}\right] \)&lt;/span&gt; כאשר Var כאן הוא קיצור של Variance, &lt;strong&gt;שונות&lt;/strong&gt;. העלאה בריבוע נותנת לנו את היתרונות שרצינו: היא משמשת בתור סוג של ערך מוחלט כי &lt;span&gt;\( a^{2} \)&lt;/span&gt; זה אותו דבר כמו &lt;span&gt;\( \left|a\right|^{2} \)&lt;/span&gt;; זה עובר לסדר הגודל השני (חשבו על העלאה בריבוע בתור העלאה של סדר הגודל; איך זה באמת חשוב, נראה אחר כך). וזו פונקציה נחמדה לעבודה מבחינה מתמטית.&lt;/p&gt;

&lt;p&gt;דבר אחד שקל לראות הוא נוסחה אלטרנטיבית לתוחלת שמתקבלת מכך שפותחים במפורש את הביטוי, מה שאני אדגים במקרה של הסתברות בדידה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(X\right)=\text{E}\left[\left(X-\mu\right)^{2}\right]=\sum_{a}p\left(X=a\right)\left(a-\mu\right)^{2}= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\sum_{a}P\left(X=a\right)a^{2}-2\mu\sum_{a}P\left(X=a\right)a+\mu^{2}\sum_{a}P\left(X=a\right)= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\text{E}\left[X^{2}\right]-2\mu\text{E}\left[X\right]+\mu^{2}=\text{E}\left[X^{2}\right]-2\mu^{2}+\mu^{2}=\text{E}\left[X^{2}\right]-\mu^{2}=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בואו נוודא שהבנו מה הולך פה. את הביטוי המקורי פיצלתי לשלושה סכומים על פי הפתיחה של הסוגריים &lt;span&gt;\( \left(a-\mu\right)^{2}=a^{2}-2a\mu+\mu^{2} \)&lt;/span&gt;. הסכום הראשון היה &lt;span&gt;\( \sum_{a}P\left(X=a\right)a^{2} \)&lt;/span&gt; שזו ממש ההגדרה הפורמלית של &lt;span&gt;\( \text{E}\left[X^{2}\right] \)&lt;/span&gt;. הסכום השני היה קבוע כפול &lt;span&gt;\( \sum_{a}P\left(X=a\right)a \)&lt;/span&gt; שזו ההגדרה הפורמלית של &lt;span&gt;\( \text{E}\left[X\right] \)&lt;/span&gt;, ואחרי שהשתמשתי בכך ש-&lt;span&gt;\( \text{E}\left[X\right]=\mu \)&lt;/span&gt; קיבלתי את הערך שרציתי.&lt;/p&gt;

&lt;p&gt;הנוסחה &lt;span&gt;\( \text{Var}\left(X\right)=\text{E}\left[X^{2}\right]-\text{E}\left[X\right]^{2} \)&lt;/span&gt; בהחלט נראית לי יפה ושימושית יותר מאשר &lt;span&gt;\( \text{E}\left[\left(X-\mu\right)^{2}\right] \)&lt;/span&gt;; היא מציגה את השונות בעזרת שני המומנטים הראשונים של &lt;span&gt;\( X \)&lt;/span&gt;, שיותר קל לחשב ישירות. עשיתי את זה קודם, בדוגמה למעלה, עבור התפלגות בינומית: קיבלנו ש-&lt;span&gt;\( \text{E}\left[X\right]=np \)&lt;/span&gt; ואילו &lt;span&gt;\( \text{E}\left[X^{2}\right]=np\left(\left(n-1\right)p+1\right) \)&lt;/span&gt;, ולכן עכשיו אני אוכל לחשב בקלות את השונות של התפלגות בינומית:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(X\right)=np\left(\left(n-1\right)p+1\right)-\left(np\right)^{2}=np\left[\left(n-1\right)p+1-np\right]= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =np\left(np-p+1-np\right)=np\left(1-p\right)=npq \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובסופו של דבר קיבלנו ביטוי פשוט ואלגנטי מאוד עבור השונות. עבור המשתנה הבינומי הקונקרטי שתיארתי למעלה, של ספירת העצים ב-7 הטלות של מטבע הוגן, הפרמטרים היו &lt;span&gt;\( n=7,p=q=0.5 \)&lt;/span&gt; ולכן התוחלת היא &lt;span&gt;\( \frac{7}{2}=3.5 \)&lt;/span&gt; כפי שכבר ראינו, והשונות היא &lt;span&gt;\( \frac{7}{4}=1.75 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עבור תוחלת ראיתי שמתקיימת תכונת &lt;strong&gt;לינאריות&lt;/strong&gt; מועילה מאוד: &lt;span&gt;\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)&lt;/span&gt;. עבור שונות אין לנו משהו עד כדי כך נוח, אבל עדיין יש לנו נוסחה מועילה: &lt;span&gt;\( \text{Var}\left(\alpha X+\beta\right)=\alpha^{2}\text{Var}\left(X\right) \)&lt;/span&gt;. כלומר - חיבור של &lt;strong&gt;קבוע&lt;/strong&gt; לא משפיע (חיבור של משתנה מקרי אחר מסבך את הכל), והכפלה בקבוע מכילה את השונות באותו קבוע בריבוע.&lt;/p&gt;

&lt;p&gt;עכשיו, העובדה שהשונות כוללת העלאה בריבוע היא מצד אחד חיובית מהסיבות שציינתי, ומצד שני אנחנו עדיין רוצים לקבל מדד דומה שהוא “מסדר גודל אחד פחות” ובכל זאת מתנהג נחמד. דרך פשוטה לקבל את זה היא להגדיר &lt;span&gt;\( \sigma=\sqrt{\text{Var}\left(X\right)} \)&lt;/span&gt; - גם פונקציית השורש היא נחמדה יחסית, ומורידה את סדר הגודל. ה-&lt;span&gt;\( \sigma \)&lt;/span&gt; הזה חשוב מספיק כדי שיקבל שם בפני עצמו: &lt;strong&gt;סטיית התקן&lt;/strong&gt; של &lt;span&gt;\( X \)&lt;/span&gt;, ולעתים קרובות יותר נוח פשוט לכתוב &lt;span&gt;\( \sigma^{2} \)&lt;/span&gt; בתור השונות של &lt;span&gt;\( X \)&lt;/span&gt; במקום &lt;span&gt;\( \text{Var}\left(X\right) \)&lt;/span&gt;. את התוצאה שראינו לפני רגע אפשר לתאר גם בתור “אם כופלים את &lt;span&gt;\( X \)&lt;/span&gt; ב-&lt;span&gt;\( \alpha \)&lt;/span&gt; כופלים את סטיית התקן של &lt;span&gt;\( X \)&lt;/span&gt; ב-&lt;span&gt;\( \alpha \)&lt;/span&gt;”.&lt;/p&gt;

&lt;p&gt;בואו נראה עכשיו שימוש בשונות כדי לשפר את היכולת שלנו להבין את &lt;span&gt;\( X \)&lt;/span&gt; בעזרת מעין שדרוג של אי-שוויון מרקוב שלוקח גם את השונות בחשבון ונקרא &lt;strong&gt;אי-שוויון צ&apos;בישב&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;הרעיון הוא כזה. כזכור, אי-שוויון מרקוב מדבר על משתנה מקרי &lt;strong&gt;אי-שלילי&lt;/strong&gt; &lt;span&gt;\( X \)&lt;/span&gt; ועבורו, לכל &lt;span&gt;\( a&amp;gt;0 \)&lt;/span&gt; , הוא נותן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X\ge a\right)=\frac{E\left[X\right]}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, אם &lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי &lt;strong&gt;כלשהו&lt;/strong&gt;, לאו דווקא אי שלילי, אז בואו ניזכר ש-&lt;span&gt;\( \text{Var}\left(X\right) \)&lt;/span&gt; הוגדרה בתור התוחלת של משתנה מקרי שהוא &lt;strong&gt;כן&lt;/strong&gt; אי-שלילי: &lt;span&gt;\( \sigma^{2}=\text{Var}\left(X\right)=\text{E}\left[Z\right] \)&lt;/span&gt; כאשר &lt;span&gt;\( Z=\left(X-\mu\right)^{2} \)&lt;/span&gt;. על ה-&lt;span&gt;\( Z \)&lt;/span&gt; הזה אני כן יכול להשתמש באי שוויון מרקוב; בואו נראה מה קורה אם אנחנו לוקחים &lt;span&gt;\( k&amp;gt;0 \)&lt;/span&gt; כלשהו ומשתמשים במרקוב עם &lt;span&gt;\( a=k^{2} \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(Z\ge a\right)\le\frac{\text{E}\left[Z\right]}{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left(X-\mu\right)^{2}\ge k^{2}\right)\le\frac{\text{E}\left[\left(X-\mu\right)^{2}\right]}{k^{2}}=\frac{\sigma^{2}}{k^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, בואו נביט על &lt;span&gt;\( \left(X-\mu\right)^{2}\ge k^{2} \)&lt;/span&gt;. הדבר הזה קורה אם ורק אם &lt;span&gt;\( \left|X-\mu\right|\ge k \)&lt;/span&gt;, ולכן ההסתברות של שני אי השוויונים זהה, כלומר אני יכול לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left|X-\mu\right|\ge k\right)\le\frac{\sigma^{2}}{k^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה אי-שוויון צ’בישב. כמו עם אי-שוויון מרקוב, לפעמים קל יותר להבין מה הוא אומר אם “מכניסים את סטיית התקן אל אי השוויון”, כלומר אם אני מנסח אותו על ידי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(\left|X-\mu\right|\ge k\sigma\right)\le\frac{1}{k^{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם למשל נציב &lt;span&gt;\( k=2 \)&lt;/span&gt; נקבל את הטענה הבאה: לכל משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt;, הסיכוי שהוא יקבל ערך שהמרחק שלו מהתוחלת של &lt;span&gt;\( X \)&lt;/span&gt; הוא יותר משתי סטיות תקן הוא &lt;span&gt;\( \frac{1}{4}=25\% \)&lt;/span&gt;. לי זה מרגיש כמו טענה כללית להפתיע, כי לא משנה בכלל כמה &lt;span&gt;\( X \)&lt;/span&gt; מורכב ומתוחכם - מרגע שחישבנו את התוחלת ואת סטיית התקן שלו, אנחנו יודעים בדיוק מה האיזור שבו 75\% מהערכים ש-&lt;span&gt;\( X \)&lt;/span&gt; נותן הולכים ליפול. יותר מכך - בגלל שבמכנה יש &lt;span&gt;\( k^{2} \)&lt;/span&gt; ולא &lt;span&gt;\( k \)&lt;/span&gt;, זה אומר לנו שהסיכוי של מישהו להיות במרחק של הרבה סטיות תקן צונח מהר - צונח באופן &lt;strong&gt;ריבוע&lt;/strong&gt;. אם הסיכוי להיות במרחק 2 סטיות תקן היה 25\%, עבור 3 סטיות תקן הוא נופל אל &lt;span&gt;\( \frac{1}{9}=11.111\ldots\% \)&lt;/span&gt;, ועבור 4 סטיות תקן הוא כבר &lt;span&gt;\( \frac{1}{16}=6.25\% \)&lt;/span&gt; וכשנרצה להיות במרחק 10 סטיות תקן הסיכוי כבר יהיה &lt;span&gt;\( \frac{1}{100}=1\% \)&lt;/span&gt;, וכן הלאה. ככל שסטיית התקן של &lt;span&gt;\( X \)&lt;/span&gt; גדולה יותר כך האיזור שבו רוב הערכים שלו יכולים ליפול הוא רחב יותר, אבל אם נחלק את המרחב לאיזורים שהרוחב של כל אחד מהם הוא &lt;span&gt;\( \sigma \)&lt;/span&gt;, נדע בדיוק מה ההסתברות של איבר ליפול בכל אחד מהאיזורים הללו. זו המחשה חזקה מאוד לכוח שיש לשני מספרים בודדים &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; לתאר את &lt;span&gt;\( X \)&lt;/span&gt;.&lt;/p&gt;

&lt;h2&gt;חזרה אל ההתפלגות הנורמלית&lt;/h2&gt;

&lt;p&gt;עכשיו כשהכרנו את המושגים של תוחלת ושונות/סטיית תקן אפשר לחזור סוף סוף אל ההתפלגות הנורמלית. הגדרתי אותה בעזרת פונקציית צפיפות ההסתברות &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt;, ועכשיו אפשר לחזור למה שאמרתי בתחילת הפוסט אבל כשיש לנו את ההגדרות הרלוונטיות: ה-&lt;span&gt;\( \mu \)&lt;/span&gt; וה-&lt;span&gt;\( \sigma \)&lt;/span&gt; הללו הם בדיוק התוחלת וסטיית התקן של ההתפלגות הנורמלית ש-&lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; הם הפרמטרים שלה. כלומר, אנחנו מגדירים משתנה מקרי &lt;span&gt;\( N\left(\mu,\sigma\right) \)&lt;/span&gt; על ידי פונקציית הצפיפות &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt;, וכשנחשב את התוחלת וסטיית התקן שלו הנוסחאות יתנו לנו בדיוק &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt;, וזה בדיוק מה שאני רוצה להראות עכשיו. דבר אחד שכדאי לשים אליו לב לפני כן הוא שאפשר להגדיר את ההתפלגות הנורמלית גם בלי להגדיר בכלל סטיית תקן: הרי &lt;span&gt;\( \frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}=\frac{1}{\sqrt{2\pi\sigma^{2}}}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt; ולכן אם היינו למשל בוחרים לסמן את השונות שאנחנו רוצים ב-&lt;span&gt;\( \tau \)&lt;/span&gt; אז היינו מקבלים שהתפלגות נורמלית עם תוחלת &lt;span&gt;\( \mu \)&lt;/span&gt; ושונות &lt;span&gt;\( \tau \)&lt;/span&gt; מתוארת על ידי &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi\tau}}e^{-\left(x-\mu\right)^{2}/2\tau} \)&lt;/span&gt;. הבחירה להשתמש ב-&lt;span&gt;\( \sigma \)&lt;/span&gt; היא עניין של קונבנציה (ומן העבר השני, אנשים גם כותבים לפעמים &lt;span&gt;\( \frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2} \)&lt;/span&gt; כדי שהנוסחה תכלול רק את &lt;span&gt;\( \sigma \)&lt;/span&gt; ולא את &lt;span&gt;\( \sigma^{2} \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;ראשית, הנה טריק מועיל כדי למצוא תוחלת ושונות של דברים. כזכור, ראינו&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[\alpha X+\beta Y\right]=\alpha\text{E}\left[X\right]+\beta\text{E}\left[Y\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(\alpha X+\beta\right)=\alpha^{2}\text{Var}\left(X\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז באופן כללי, אם אנחנו רוצים למצוא תוחלת ושונות של משתנה &lt;span&gt;\( X \)&lt;/span&gt; אבל זה קשה לנו, אפשר לנסות להגדיר משתנה “מנורמל” &lt;span&gt;\( Z=\frac{X-\mu}{\sigma} \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X\right]=\sigma\text{E}\left[Z\right]+\mu \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(X\right)=\sigma^{2}\text{Var}\left(Z\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אני אשתמש בזה במקרה שלנו. נניח ש-&lt;span&gt;\( X \)&lt;/span&gt; הוא משתנה מקרי שמתפלג נורמלית עם פרמטרים &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt;, כלומר &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2} \)&lt;/span&gt;. אם אני מגדיר את המשתנה החדש &lt;span&gt;\( Z=\frac{X-\mu}{\sigma} \)&lt;/span&gt; אני אקבל פונקציית צפיפות הסתברות &lt;span&gt;\( f\left(z\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;. כדי לראות את זה נשים לב לכך ש:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(a\le Z\le b\right)=P\left(\sigma a+\mu\le X\le\sigma b+\mu\right)=\int_{\sigma a+\mu}^{\sigma b+\mu}\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(\frac{x-\mu}{\sigma}\right)^{2}/2}dx \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ועל האינטגרל הזה אפשר לבצע את החלפת המשתנים &lt;span&gt;\( z=\frac{x-\mu}{\sigma} \)&lt;/span&gt; שנותנת לנו &lt;span&gt;\( dz=\frac{dx}{\sigma} \)&lt;/span&gt;, כלומר מקבלים &lt;span&gt;\( P\left(a\le Z\le b\right)=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;המסקנה? אם &lt;span&gt;\( X \)&lt;/span&gt; התפלג נורמלית עם פרמטרים &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; אז &lt;span&gt;\( Z=\frac{X-\mu}{\sigma} \)&lt;/span&gt; מתפלג נורמלית עם פרמטרים &lt;span&gt;\( 0,1 \)&lt;/span&gt;. עכשיו אני אוכיח ש-&lt;span&gt;\( \text{E}\left[Z\right]=0 \)&lt;/span&gt; וש-&lt;span&gt;\( \text{Var}\left(Z\right)=1 \)&lt;/span&gt; ואז אסיק ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[X\right]=\sigma\text{E}\left[Z\right]+\mu=\mu \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{Var}\left(X\right)=\sigma^{2}\text{Var}\left(Z\right)=\sigma^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו הטענה הכללית שאני רוצה.&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( \text{E}\left[Z\right] \)&lt;/span&gt; זה קל - זה יוצא 0 בגלל שפונקציית הצפיפות &lt;span&gt;\( \frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt; היא סימטרית ביחס ל-0 כי &lt;span&gt;\( z^{2} \)&lt;/span&gt; היא פונקציה סימטרית ביחס ל-0. זה הופך את האינטגרל שמחשבים עבור התוחלת לאינטגרל של פונקציה &lt;strong&gt;אנטיסימטרית&lt;/strong&gt; בגלל ההכפלה ב-&lt;span&gt;\( z \)&lt;/span&gt;. הנה משהו פורמלי קצת יותר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[Z\right]=\int_{-\infty}^{\infty}z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2}=\lim_{a\to\infty}\int_{-a}^{a}z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2}= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =\frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}\left.e^{-z^{2}/2}\right|_{-a}^{a}=\frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}\left(e^{-a^{2}/2}-e^{-a^{2}/2}\right)= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{\sqrt{2\pi}}\lim_{a\to\infty}0=0 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;המעבר מאינטגרל אינסופי בשני הכיוונים לגבול כש-&lt;span&gt;\( a \)&lt;/span&gt; שואף לאינסוף של אינטגרל מ-&lt;span&gt;\( -a \)&lt;/span&gt; אל &lt;span&gt;\( a \)&lt;/span&gt; הוא &lt;strong&gt;לא תקין&lt;/strong&gt; באופן כללי אבל בפוסט הקודם כבר אמרנו שבמקרה הנוכחי זה תקין (אבל אפשר להסתדר גם אם עושים שני אינטגרלים, זה פשוט יוצא מסורבל יותר). אז זה מסיים עם התוחלת ומראה שכדי לחשב את השונות צריך פשוט לחשב את &lt;span&gt;\( \text{E}\left[Z^{2}\right] \)&lt;/span&gt;. זה יהיה טיפה יותר מסובך ויצריך טריק אינטגרציה סטנדרטי: &lt;strong&gt;אינטגרציה בחלקים&lt;/strong&gt;. בואו ניזכר את הטריק הזה הולך.&lt;/p&gt;

&lt;p&gt;עבור נגזרות, אחת מהנוסחאות החשובות ביותר היא מה יוצאת הגזירה של מכפלה של פונקציות: &lt;span&gt;\( \left(uv\right)^{\prime}=u^{\prime}v+uv^{\prime} \)&lt;/span&gt;. זו אחת מהנוסחאות הבודדות שצרובות בי עוד מהתיכון. עכשיו, אם מעבירים אגפים, מקבלים מן הסתם &lt;span&gt;\( u^{\prime}v=\left(uv\right)^{\prime}-uv^{\prime} \)&lt;/span&gt; ואם (ועכשיו אני עובר לקצת נפנוף ידיים) לוקחים אינטגרל לשני האגפים מקבלים &lt;span&gt;\( \int u^{\prime}v=uv-\int uv^{\prime} \)&lt;/span&gt;. לכן אם קשה לנו לבצע אינטגרציה לפונקציה שלנו, אנחנו בודקים אם יש דרך נוחה לפרק אותה למכפלה של שתי פונקציות שלאחת מהן (שאנחנו קוראים לה &lt;span&gt;\( u^{\prime} \)&lt;/span&gt;) כן קל לנו להוציא אינטגרל, את השניה (שאנחנו קוראים לה &lt;span&gt;\( v \)&lt;/span&gt;) קל לנו לגזור, ואז אנחנו מקווים שאחרי שנוציא אינטגרל לאחת ונגזרת לשניה, המכפלה של &lt;strong&gt;זה&lt;/strong&gt; תהיה משהו שקל לנו למצוא לו אינטגרל. לפעמים זה נכשל קטסטרופלית ולפעמים, כמו עכשיו, זה עובד יופי. הרי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \text{E}\left[Z^{2}\right]=\int_{-\infty}^{\infty}z^{2}\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולפני רגע, בחישוב התוחלת, ראינו שקל לנו להוציא את האינטגרל של &lt;span&gt;\( u^{\prime}=z\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt; והאינטגרל יוצא &lt;span&gt;\( u=\frac{1}{\sqrt{2\pi}}e^{-z^{2}/2} \)&lt;/span&gt;, וכמובן שאת &lt;span&gt;\( v=z \)&lt;/span&gt; קל לגזור ולקבל &lt;span&gt;\( v^{\prime}=1 \)&lt;/span&gt;. כמו כן &lt;span&gt;\( uv \)&lt;/span&gt; הולך לצאת בדיוק הביטוי לתוחלת שראינו לפני רגע שהאינטגרל שלו הוא 0, ו-&lt;span&gt;\( uv^{\prime} \)&lt;/span&gt; הולך לצאת בדיוק פונקציית הצפיפות המקורית שראינו כבר (בפוסט הקודם, ולא בקלות) שהאינטגרל שלה יוצא 1. זה מסיים (בנפנוף ידיים) את ההוכחה.&lt;/p&gt;

&lt;p&gt;אז אם לסכם עוד סיכום ביניים: אנחנו מנסים להבין למה פונקציית הצפיפות של ההתפלגות הנורמלית נראית ככה: &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt;. בינתיים הבנו ש-&lt;span&gt;\( \pi \)&lt;/span&gt; שם בתור קבוע נרמול שמגיע בבסיסו מכך ש-&lt;span&gt;\( 2\pi \)&lt;/span&gt; הוא היקף מעגל היחידה; ואנחנו רואים עכשיו ש-&lt;span&gt;\( \mu,\sigma \)&lt;/span&gt; שמופיעים פה מבטיחים שהתוחלת וסטיית התקן של ההתפלגות יהיו &lt;span&gt;\( \mu,\sigma \)&lt;/span&gt;; אבל עדיין לא ברור לנו הדבר העיקרי - מה הקטע עם ה-&lt;span&gt;\( e \)&lt;/span&gt; הזה? למה הצורה של העקומה היא (עד כדי קבועים) &lt;span&gt;\( e^{-x^{2}} \)&lt;/span&gt;? אני לא רואה איך לענות לשאלה הזו בלי להגיע אל היעד שלנו: &lt;strong&gt;משפט הגבול המרכזי&lt;/strong&gt;. את זה נעשה בפוסט הבא.&lt;/p&gt;</content><author><name></name></author><category term="התפלגות נורמלית" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/2025/histogram_12.png" /><media:content medium="image" url="http://gadial.net/assets/img/2025/histogram_12.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מה הקטע עם התפלגות נורמלית? (חלק ב’: על שתי הסתברויות)</title><link href="http://gadial.net/2025/02/03/normal_distribution_2/" rel="alternate" type="text/html" title="מה הקטע עם התפלגות נורמלית? (חלק ב&apos;: על שתי הסתברויות)" /><published>2025-02-03T00:00:00+00:00</published><updated>2025-02-03T00:00:00+00:00</updated><id>http://gadial.net/2025/02/03/normal_distribution_2</id><content type="html" xml:base="http://gadial.net/2025/02/03/normal_distribution_2/">&lt;h2&gt;מבוא&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://gadial.net/2025/01/31/normal_distribution_1/&quot;&gt;בפוסט הקודם&lt;/a&gt; התחלתי לדבר על מה שנקרא &lt;strong&gt;התפלגות נורמלית&lt;/strong&gt; ופורמלית מוגדר בתור &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt; אבל בגלל שאלו הרבה סימנים מפחידים שלא אומרים הרבה כרגע, העדפתי להסתכל על הדבר הזה:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;התמונה הזו מציגה את הקשר בין שתי התפלגויות שונות. אחת נקראת &lt;strong&gt;התפלגות בינומית&lt;/strong&gt; ומתוארת על ידי הפסים, והשניה שמתוארת על ידי קו רציף היא ההתפלגות הנורמלית, ומה שאנחנו רואים הוא שבמובן מסוים ההתפלגות הנורמלית היא &lt;strong&gt;קירוב טוב&lt;/strong&gt; של ההתפלגות הבינומית. בפוסט הזה אני רוצה שנבהיר בצורה מתמטית איך בעצם מגדירים את הנפשות הפועלות - איך מגדירים התפלגויות ומה הולך בהגדרה של התפלגות נורמלית. העניין הוא שההגדרות בתורת ההסתברות הן &lt;strong&gt;לא דבר פשוט&lt;/strong&gt; ולכן הפוסט הזה כבר ייכנס למתמטיקה לא לגמרי טריוויאלית. למעשה, תמונת הפסים-מול-עקומה ממחישה את זה יפה - יש שתי דרכים &lt;strong&gt;שונות&lt;/strong&gt; להגדיר התפלגויות, דרך אחת שנקראת &lt;strong&gt;התפלגות בדידה&lt;/strong&gt; וכאן מתאימה לפסים, והדרך השניה שנקראת &lt;strong&gt;התפלגות רציפה&lt;/strong&gt; ומתאימה לעקומה. יש המון דמיון בין שתי הגישות אבל גם הבדלים מהותיים; ויש דרך “מאחדת” להציג את שניהם בתור מקרים פרטיים של אותו דבר, אבל היא לא בהכרח הופכת את הסיטואציה לקלה יותר להבנה אז אני לא אכנס אליה כאן. בואו נתחיל מהמקרה שקצת יותר מתאים לתפיסה היומיומית שלנו של הסתברות - התפלגות בדידה.&lt;/p&gt;

&lt;h2&gt;התפלגויות בדידות&lt;/h2&gt;

&lt;p&gt;בואו נסתכל על סיטואציה הסתברותית פשוטה: הטלת קוביה הוגנת. במקרה הזה, יש שש תוצאות אפשריות להטלת הקוביה: &lt;span&gt;\( X=\left\{ 1,2,3,4,5,6\right\}  \)&lt;/span&gt;. לכל תוצאה כזו אנחנו מתאימים &lt;strong&gt;הסתברות&lt;/strong&gt; שהיא תקרה: &lt;span&gt;\( p\left(1\right)=p\left(2\right)=\ldots=p\left(6\right)=\frac{1}{6} \)&lt;/span&gt;. הרעיון פה הוא שהסכום של כל ההסתברויות יוצא 1, או כמו שמסמנים בקיצור, &lt;span&gt;\( \sum_{i=1}^{6}p\left(i\right)=1 \)&lt;/span&gt;. אפשר כמובן גם לדבר על קוביה לא הוגנת, למשל כזו שיש לה סיכוי של לא פחות מאשר &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; ליפול על 4, וכל יתר הצדדים מתחלקים שווה בשווה. במקרה הזה, מכיוון שההסתברויות צריכות להסתכם ל-1, יש לנו הסתברות של &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; לחלק בין חמישה צדדים של הקוביה, אז נקבל &lt;span&gt;\( p\left(1\right)=\frac{1}{10} \)&lt;/span&gt; וכן הלאה לכל &lt;span&gt;\( i \)&lt;/span&gt; חוץ מאשר &lt;span&gt;\( p\left(4\right)=\frac{1}{2} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אפשר להכליל את הרעיון הזה בקלות: &lt;span&gt;\( A=\left\{ a_{1},a_{2},\ldots,a_{n}\right\}  \)&lt;/span&gt; תהיה קבוצה של &lt;span&gt;\( n \)&lt;/span&gt; תוצאות אפשריות של הסיטואציה ההסתברותית שלנו. לכזו קבוצה קוראים &lt;strong&gt;מרחב המדגם&lt;/strong&gt; (כי הסיטואציה ההסתברותית &lt;strong&gt;דוגמת&lt;/strong&gt; תוצאה אחת מתוכו) ואנחנו מגדירים פונקציה &lt;span&gt;\( p:A\to\left[0,1\right] \)&lt;/span&gt; שמתאימה לכל איבר במרחב המדגם מספר בין 0 ל-1 כך ש-&lt;span&gt;\( \sum_{i=1}^{n}p\left(a_{i}\right)=1 \)&lt;/span&gt;. ההגדרה הפשוטה הזו מספיקה להרבה מאוד סיטואציות הסתברותיות שאנחנו נתקלים בהן במציאות.&lt;/p&gt;

&lt;p&gt;אבל ממש לא לכולן.&lt;/p&gt;

&lt;p&gt;בפוסט הקודם דיברתי על הסיטואציה שבה אני זורק כדורסל ובגלל שאני לא באמת יודע איך לזרוק כדורסל לסל, יש לי הסתברות של &lt;span&gt;\( \frac{1}{10} \)&lt;/span&gt; לקלוע (הייתי נדיב) והשאלה שאני שואל היא - כמה זריקות לסל יידרשו לי עד שאקלע? ובכן, ברור שיש לי הסתברות של &lt;span&gt;\( \frac{1}{10} \)&lt;/span&gt; לקלוע בנסיון הראשון. אם פספסתי, זה קרה בהסתברות &lt;span&gt;\( \frac{9}{10} \)&lt;/span&gt; והסיכוי שאני אצליח בנסיון השני הוא &lt;span&gt;\( \frac{1}{10} \)&lt;/span&gt;, אז אינטואיטיבית יש לי הסתברות של &lt;span&gt;\( \frac{9}{10}\cdot\frac{1}{10}=\frac{9}{100} \)&lt;/span&gt; להצליח בזריקה השניה, וכן הלאה. טוב ויפה, אבל איך ממדלים את זה כמו שעשיתי לפני רגע, עם קבוצה &lt;span&gt;\( X \)&lt;/span&gt; של כל התוצאות האפשריות? אני יכול לומר משהו כמו &lt;span&gt;\( p\left(1\right)=\frac{1}{10} \)&lt;/span&gt; ו-&lt;span&gt;\( p\left(2\right)=\frac{9}{100} \)&lt;/span&gt; וכן הלאה, אבל מספר ההטלות שיידרשו לי עד שאקלע לסל הוא &lt;strong&gt;לא חסום&lt;/strong&gt;. אני לא יכול להבטיח שיידרשו לי רק 42 הטלות. אם אני אגיע אל ההטלה ה-42 זה אומר שהייתי מאוד חסר מזל עד כה, אבל ליקום לא אכפת מחוסר המזל שלי עד כה - גם בהטלה ה-42, הסיכוי שלי לקלוע יהיה רק &lt;span&gt;\( \frac{1}{10} \)&lt;/span&gt; ולכן בהחלט ייתכן שאגיע להטלה ה-43. במילים אחרות, אם אני רוצה שיהיה לי סיכוי כלשהו למשל אפילו את הסיטואציה המאוד פשוטה הזו אני צריך ש-&lt;span&gt;\( X \)&lt;/span&gt; תהיה קבוצה &lt;strong&gt;אינסופית&lt;/strong&gt;, במקרה הזה &lt;span&gt;\( A=\left\{ 1,2,3,\ldots\right\}  \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אם &lt;span&gt;\( X=\left\{ a_{1},a_{2},a_{3},\ldots\right\}  \)&lt;/span&gt; היא קבוצה אינסופית, זה יוצר לנו קושי טכני חדש. דרשתי קודם שיתקיים &lt;span&gt;\( \sum_{i=1}^{n}p\left(a_{i}\right)=1 \)&lt;/span&gt;, אבל עכשיו &lt;span&gt;\( X \)&lt;/span&gt; היא &lt;strong&gt;אינסופית&lt;/strong&gt; ולכן גם הסכום צריך להיות אינסופי: &lt;span&gt;\( \sum_{i=1}^{\infty}p\left(a_{i}\right)=1 \)&lt;/span&gt;. זה מכניס לנו לתמונה מושג חדש &lt;strong&gt;וממש לא טריוויאלי&lt;/strong&gt; - &lt;a href=&quot;https://gadial.net/2008/06/17/infinite_series/&quot;&gt;סכום אינסופי&lt;/a&gt;, משהו שלומדים בדרך כלל בחדו”א. כל הסיפור הפך לפתע למסובך יותר: בשביל למדל סיטואציה פשוטה יחסית, אנחנו צריכים כלים מתמטיים לא לגמרי טריוויאליים.&lt;/p&gt;

&lt;p&gt;יש עוד מושג מרכזי אחד שצריך להכיר. בואו נחזור אל ההיסטוגרמה שהבאתי בתחילת הפוסט; בפוסט הקודם סיפרתי עליה סיפור של משחק שבו אני מטיל מטבע הוגן 10 פעמים וסופר כמה פעמים נפלתי על “עץ”. אפשר למדל כאן את מרחב המדגם בתור &lt;span&gt;\( A=\left\{ 0,1,\ldots,10\right\}  \)&lt;/span&gt; אבל זה יהיה טיפה מסובך כי לא לגמרי ברור איזו הסתברות לתת לכל איבר במרחב המדגם. תחת זאת אפשר לתת מרחב מדגם שבמובן מסוים הוא פשוט יותר: &lt;span&gt;\( X \)&lt;/span&gt; פשוט יכיל את כל התוצאות האפשריות של הטלת מטבע הוגן 10 פעמים. אם אני אסמן “עץ” בתור 1 ו”פלי” בתור 0 אני יכול לחשוב על כל תוצאה אפשרית בתור עשירייה &lt;span&gt;\( b=\left(b_{1},b_{2},\ldots,b_{10}\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( b_{i}\in\left\{ 0,1\right\}  \)&lt;/span&gt;, כלומר מרחב המדגם שלי הוא מה שמסומן ב-&lt;span&gt;\( A=\left\{ 0,1\right\} ^{10} \)&lt;/span&gt;. בגלל שלעץ ולפלי יש בדיוק אותה הסתברות &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; בכל הטלה, ההסתברות של כל עשירייה היא &lt;span&gt;\( \frac{1}{2}\cdot\frac{1}{2}\cdots\frac{1}{2}=\frac{1}{2^{10}} \)&lt;/span&gt; (זו עדיין אמירה אינטואיטיבית ולא טענה פורמלית - אגיע לטענה הפורמלית עוד מעט).&lt;/p&gt;

&lt;p&gt;עכשיו, אני יכול להגדיר &lt;strong&gt;פונקציה&lt;/strong&gt; &lt;span&gt;\( X:A\to\mathbb{R} \)&lt;/span&gt; שלכל עשירייה, סופרת כמה “עץ” יש בה, כלומר הכי פורמלית שרק אפשר, &lt;span&gt;\( X\left(b\right)=\sum_{i=1}^{10}b_{i} \)&lt;/span&gt;. זו פונקציה במובן הרגיל של תורת הקבוצות, אבל מכיוון שהיא מוגדרת על מרחב מדגם שיש עליו &lt;strong&gt;מבנה&lt;/strong&gt; של אקראיות, המבנה הזה עובר גם אליה - אפשר לשאול עכשיו שאלות כמו “אם אני בוחר איבר מ-&lt;span&gt;\( A \)&lt;/span&gt; באקראי, מה ההסתברות ש-&lt;span&gt;\( X \)&lt;/span&gt; יחזיר עליו 3?” או בכתיב הסטנדרטי, מהו &lt;span&gt;\( P\left(X=3\right) \)&lt;/span&gt;. התשובה לזה פשוטה: כדי ש-&lt;span&gt;\( X \)&lt;/span&gt; יקבל 3, צריך שמי שיעלה בגורל הוא אחד מאיברי מרחב המדגם שיש לו בדיוק 3 פעמים 1 ויתר הפעמים 0, אז אני סוכם את ההסתברויות של &lt;strong&gt;כל&lt;/strong&gt; האיברים הללו. לכל איבר, ההסתברות שלו היא &lt;span&gt;\( \frac{1}{2^{10}} \)&lt;/span&gt;, ומספר האיברים הללו הוא בדיוק &lt;span&gt;\( {10 \choose 3} \)&lt;/span&gt; - מספר הדרכים לבחור 3 מקומות מתוך 10 כדי לשים בהם 1 (&lt;a href=&quot;https://gadial.net/2010/06/20/combinatorics_intro/&quot;&gt;יש לי פוסט&lt;/a&gt; שמסביר את זה; כאן אני מניח שאנחנו מכירים קומבינטוריקה בסיסית), אז בסך הכל נקבל &lt;span&gt;\( P\left(X=3\right)={10 \choose 3}\frac{1}{2^{10}} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;הפונקציה &lt;span&gt;\( X \)&lt;/span&gt; שהגדרתי כאן מכונה &lt;strong&gt;משתנה מקרי&lt;/strong&gt;. זה סוג האובייקטים המרכזי שאנחנו מתעסקים בו בהסתברות. היופי בשימוש במשתנים מקריים הוא שאנחנו יכולים לשמור את מרחב המדגם שלנו פשוט יחסית, ולהגדיר מעל אותו מרחב מדגם שלל משתנים מקריים שונים ומשונים, ולשאול גם שאלות יותר מורכבות מאשר סתם “איך מחשבים את זה?” אלא גם “מה הקשרים בין המשתנים המקריים השונים” וכן הלאה.&lt;/p&gt;

&lt;p&gt;בואו נעבור למשהו כללי יותר. נניח שאני מטיל מטבע &lt;strong&gt;לא הוגן&lt;/strong&gt; בדיוק &lt;span&gt;\( n \)&lt;/span&gt; פעמים וסופר כמה פעמים קיבלתי עץ, וניקח &lt;span&gt;\( 0\le k\le n \)&lt;/span&gt; - מה ההסתברות שקיבלתי &lt;span&gt;\( k \)&lt;/span&gt; פעמים עץ? אפשר להגדיר משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt; כמו קודם, ועכשיו השאלה היא מהו &lt;span&gt;\( P\left(X=k\right) \)&lt;/span&gt;. אני אסמן ב-&lt;span&gt;\( p \)&lt;/span&gt; את ההסתברות שבהטלת המטבע מקבלים עץ וב-&lt;span&gt;\( q \)&lt;/span&gt; את ההסתברות שמקבלים פלי (&lt;span&gt;\( p+q=1 \)&lt;/span&gt; כי בכל הטלה יש הסתברות 1 שתתקבל אחת משתי התוצאות). אז כדי לקבל &lt;strong&gt;בדיוק&lt;/strong&gt; &lt;span&gt;\( k \)&lt;/span&gt; פעמים עץ, צריך לבחור &lt;span&gt;\( k \)&lt;/span&gt; מתוך &lt;span&gt;\( n \)&lt;/span&gt; ההטלות שבהן יתקבל עץ (לזה יש &lt;span&gt;\( {n \choose k} \)&lt;/span&gt; אפשרויות) ואז באותן &lt;span&gt;\( k \)&lt;/span&gt; הטלות ההסתברות לקבל עץ הוא &lt;span&gt;\( p \)&lt;/span&gt; לכל הטלה, כלומר &lt;span&gt;\( p^{k} \)&lt;/span&gt; בסך הכל, ועבור יתר ההטלות ההסתברות לקבל פלי היא &lt;span&gt;\( q \)&lt;/span&gt; בכל הטלה, כלומר &lt;span&gt;\( q^{n-k} \)&lt;/span&gt; בסך הכל, ולכן נקבל &lt;span&gt;\( P\left(X=k\right)={n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;. משתנה מקרי שמקיים את הנוסחה הזו נקרא &lt;strong&gt;משתנה מקרי בינומי&lt;/strong&gt; או פשוט &lt;strong&gt;התפלגות בינומית&lt;/strong&gt; כשהמילה “בינומי” כאן מגיעה מכך שהמספרים בנוסחה מגיעים מהבינום של ניוטון (הנוסחה &lt;span&gt;\( \left(p+q\right)^{n}=\sum_{k=0}^{n}{n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;).&lt;/p&gt;

&lt;p&gt;לא הייתי חייב לספר את כל סיפור המטבעות הזה. הייתי יכול פשוט &lt;strong&gt;להגדיר&lt;/strong&gt; משתנה מקרי בינומי עם הנוסחה &lt;span&gt;\( P\left(X=k\right)={n \choose k}p^{k}q^{n-k} \)&lt;/span&gt;. להגיד “בואו ניקח &lt;span&gt;\( X \)&lt;/span&gt; שמקיים את הנוסחה הזו ועכשיו בואו נעשה איתו דברים”. אני טרחתי וסיפרתי סיפור ובניתי מרחב מדגם &lt;span&gt;\( A \)&lt;/span&gt; ספציפי, אבל אפשר גם לספר סיפורים אחרים ולבנות מרחבי מדגם אחרים שעדיין יניבו לנו משתנה מקרי &lt;span&gt;\( X \)&lt;/span&gt; עם אותה התפלגות (אפילו אם בתור פונקציה, &lt;span&gt;\( X \)&lt;/span&gt; יוגדר בצורה שונה). זו רמת אבסטרקציה שקצת צריך להתרגל אליה.&lt;/p&gt;

&lt;p&gt;עדיין, סיפור המטבעות &lt;strong&gt;כן&lt;/strong&gt; עוזר לנו להבין את &lt;span&gt;\( X \)&lt;/span&gt; יותר טוב. הנה דוגמא: על אותו מרחב מדגם של &lt;span&gt;\( A=\left\{ 0,1\right\} ^{n} \)&lt;/span&gt; אני יכול להגדיר עוד משתנים מקריים &lt;span&gt;\( Y_{1},Y_{2},\ldots,Y_{n} \)&lt;/span&gt;. כל משתנה מקרי מסתכל על הטלת מטבע אחת ויחידה ואומר האם &lt;strong&gt;בה&lt;/strong&gt; התקבל עץ או פלי. למשל &lt;span&gt;\( Y_{7} \)&lt;/span&gt; מקבל 1 אם בהטלה 7 יצא עץ ואחרת הוא מקבל 0. פורמלית, &lt;span&gt;\( Y_{k}\left(b\right)=b_{k} \)&lt;/span&gt;, אבל אני הולך לוותר יותר ויותר על ה”פורמלית” הזה ככל שנתקדם. משתנה מקרי כזה, שמקבל או 0 או 1, נקרא &lt;strong&gt;אינדיקטור&lt;/strong&gt;, ובמקרה שלנו &lt;span&gt;\( P\left(Y_{k}=1\right)=p \)&lt;/span&gt; ואפשר לראות שמתקיים &lt;span&gt;\( X=Y_{1}+Y_{2}+\ldots+Y_{n} \)&lt;/span&gt;, כלומר אני יכול לתאר את &lt;span&gt;\( X \)&lt;/span&gt; בתור סכום של אינדיקטורים. כשאני אגיע לדיבורים על &lt;strong&gt;תוחלת&lt;/strong&gt; זה יהיה נוח למדי לראות את &lt;span&gt;\( X \)&lt;/span&gt; ככה.&lt;/p&gt;

&lt;p&gt;יש עוד נקודה אחת לגבי משתנים מקריים ששווה לדבר עליה עכשיו. בואו נניח שאני שולף איבר &lt;span&gt;\( b\in A \)&lt;/span&gt; אקראי ממרחב המדגם שלי, ועכשיו אני מסתכל על &lt;span&gt;\( Y_{3}\left(b\right) \)&lt;/span&gt;. האם זה נותן לי &lt;strong&gt;אינפורמציה&lt;/strong&gt; כלשהי על הערכים של משתנים מקריים אחרים? למשל, אם &lt;span&gt;\( Y_{3}\left(b\right)=1 \)&lt;/span&gt;, בהחלט קיבלתי אינפורמציה כלשהי על &lt;span&gt;\( X \)&lt;/span&gt;: אני יודע ש-&lt;span&gt;\( X\left(b\right)&amp;gt;0 \)&lt;/span&gt;. זה אומר שחשיפה למידע ש-&lt;span&gt;\( Y_{3}\left(b\right)=1 \)&lt;/span&gt; &lt;strong&gt;שינתה&lt;/strong&gt; את הערכות ההסתברות שלי לגבי &lt;span&gt;\( X \)&lt;/span&gt;; אם קודם הערכתי ש-&lt;span&gt;\( P\left(X=0\right)=q^{n} \)&lt;/span&gt;, עכשיו אני מעריך ש-&lt;span&gt;\( P\left(X=0|Y_{3}=1\right)=0 \)&lt;/span&gt; (הקו המפריד אומר “בתנאי ש-“, כלומר ההסתברות של &lt;span&gt;\( X=0 \)&lt;/span&gt; בתנאי שמתקיים &lt;span&gt;\( Y_{3}=1 \)&lt;/span&gt;). לעומת זאת, המידע שלי על &lt;span&gt;\( Y_{5} \)&lt;/span&gt; לא מושפע מידע כלשהו על &lt;span&gt;\( Y_{3} \)&lt;/span&gt; (כי הם בודקים הטלות שונות). כלומר, אפשר לכתוב באופן כללי &lt;span&gt;\( P\left(Y_{5}=k|Y_{3}=t\right)=P\left(Y_{5}=k\right) \)&lt;/span&gt;. על סיטואציה כזו, שבה יש לנו משתנים &lt;span&gt;\( X,Y \)&lt;/span&gt; ואנחנו יודעים ש-&lt;span&gt;\( P\left(X=k|Y=t\right)=P\left(X=k\right) \)&lt;/span&gt; אנחנו אומרים ש-&lt;span&gt;\( X,Y \)&lt;/span&gt; הם משתנים &lt;strong&gt;בלתי תלויים&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, מה ההסתברות ש-&lt;span&gt;\( X=k \)&lt;/span&gt; וגם &lt;span&gt;\( Y=t \)&lt;/span&gt; &lt;strong&gt;ביחד&lt;/strong&gt;? אני אסמן את זה ב-&lt;span&gt;\( P\left(X=k\wedge Y=t\right) \)&lt;/span&gt;. אינטואיטיבית (ואפשר גם להוכיח את זה פורמלית) זה יהיה שווה להסתברות &lt;span&gt;\( P\left(Y=t\right) \)&lt;/span&gt;, כפול ההסתברות ש-&lt;span&gt;\( X=k \)&lt;/span&gt; &lt;strong&gt;בהינתן&lt;/strong&gt; שאנחנו כבר יודעים ש-&lt;span&gt;\( Y=t \)&lt;/span&gt;, כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X=k\wedge Y=t\right)=P\left(Y=t\right)\cdot P\left(X=k|Y=t\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואם ידוע ש-&lt;span&gt;\( X,Y \)&lt;/span&gt; בלתי תלויים אפשר להציב &lt;span&gt;\( P\left(X=k|Y=t\right)=P\left(X=k\right) \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( P\left(X=k\wedge Y=t\right)=P\left(X=k\right)P\left(Y=t\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר - עבור משתנים בלתי תלויים, ההסתברות לאירוע משותף לשניהם היא &lt;strong&gt;מכפלת&lt;/strong&gt; ההסתברויות עבור כל אחד מהם בנפרד. זו ההצדקה (בנפנוף ידיים) לכך שההסתברות לקבל בדיוק &lt;span&gt;\( k \)&lt;/span&gt; פעמים “עץ” בהטלת מטבע ספציפית היא &lt;span&gt;\( p^{k}q^{n-k} \)&lt;/span&gt; - אחרי שבחרנו &lt;span&gt;\( k \)&lt;/span&gt; משתנים שיקבלו “עץ” ההסתברות שכולם אכן יקבלו עץ היא &lt;span&gt;\( p^{k} \)&lt;/span&gt;, מכפלת ההסתברויות של כל אחד מהם, כי הם בלתי תלויים (ואז גם מוסיפים את &lt;span&gt;\( n-k \)&lt;/span&gt; המשתנים האחרים שמקבלים פלי בהסתברות &lt;span&gt;\( q \)&lt;/span&gt; לתמונה).&lt;/p&gt;

&lt;h2&gt;התפלגויות רציפות&lt;/h2&gt;

&lt;p&gt;עד עכשיו מה שראינו היה יחסית פשוט. עכשיו בואו נסבך את זה ממש. נתחיל משאלה תמימה: איך, בעצם, עם הכלים שיש לי כרגע, אני יכול להגדיר סיטואציה הסתברותית שבה אני בוחר מספר בין &lt;span&gt;\( 0 \)&lt;/span&gt; ל-&lt;span&gt;\( 1 \)&lt;/span&gt; באקראי, בהסתברות שווה לכל מספר?&lt;/p&gt;

&lt;p&gt;זו כמובן לא סיטואציה מופרכת. בכל שפת תכנות שמכבדת את עצמה יש פונקציית ספרייה שמחזירה מספר בין 0 ל-1 באקראי ובהסתברות אחידה לכל תוצאה. אבל לדבר על זה במונחים של שפת תכנות זו רמאות, כי בשפת תכנות יש רק מספר &lt;strong&gt;סופי&lt;/strong&gt; של מספרים בין 0 ל-1 שאנחנו בכלל טורחים לייצג, אז אנחנו פשוט במקרה פשוט של הסתברות בדידה. אבל בין 0 ל-1 &lt;strong&gt;אין&lt;/strong&gt; מספר סופי של מספרים. יש למשל את &lt;span&gt;\( 1 \)&lt;/span&gt;, ואת &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt;, ואת &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt;, ואת &lt;span&gt;\( \frac{1}{4} \)&lt;/span&gt; וכן הלאה וכן הלאה. עכשיו, מה ההסתברות שכל אחד מהמספרים הללו יתקבל? נניח ש-&lt;span&gt;\( p\left(1\right)=\frac{1}{n} \)&lt;/span&gt; עבור &lt;span&gt;\( 0\le\frac{1}{n}\le1 \)&lt;/span&gt; כלשהו. מכיוון שההתפלגות הזו היא אחידה, גם &lt;span&gt;\( p\left(\frac{1}{2}\right)=\frac{1}{n} \)&lt;/span&gt; וכן הלאה, ואז אני מקבל &lt;span&gt;\( p\left(1\right)+p\left(\frac{1}{2}\right)+\ldots+p\left(\frac{1}{n+1}\right)=\frac{n+1}{n}&amp;gt;1 \)&lt;/span&gt; ואופס! חרגתי מהגבול. סכום ההסתברויות על &lt;strong&gt;כל&lt;/strong&gt; התוצאות האפשריות במרחב חייב להיות לכל היותר 1 וכבר עברתי את זה. המסקנה היא פשוטה: אם אני רוצה להגדיר התפלגות כלשהי על אינסוף איברים, ההתפלגות &lt;strong&gt;לא יכולה&lt;/strong&gt; להיות אחידה; היא חייבת לקטון כל הזמן, אחרת סכום ההסתברות של כל התוצאות האפשריות יעבור את 1.&lt;/p&gt;

&lt;p&gt;אז יש לנו בעיה מהותית פה, וקל להצביע על האשם בבעיה המהותית הזו: &lt;strong&gt;אינסוף&lt;/strong&gt;. מושג האינסוף מסבך לנו את החיים בצורה שבה מחשבים לא מסתבכים. העניין הוא שמתמטיקאים דווקא אוהבים את האינסוף הזה - אחרי שמתרגלים אליו ומאלפים אותו, הרבה יותר קל לבצע חישובים איתו. יש תחום שלם שעוסק בזה שנקרא &lt;strong&gt;חדו&quot;א&lt;/strong&gt;. הנקודה היא שאת מה שהולך לקרות עכשיו המתמטיקאים מקבלים בשמחה ובששון כי הוא &lt;strong&gt;משפר&lt;/strong&gt; להם את תורת ההסתברות, לא מסבך אותה. אבל במבט ראשון זה יהיה קצת מוזר.&lt;/p&gt;

&lt;p&gt;הרעיון הבסיסי הוא לשנות את הגישה שלנו להסתברות. עד עכשיו הגישה הייתה “יש לנו קבוצה &lt;span&gt;\( A \)&lt;/span&gt; ולכל איבר &lt;span&gt;\( a\in A \)&lt;/span&gt; אנחנו מגדירים הסתברות &lt;span&gt;\( p\left(a\right) \)&lt;/span&gt;”. עכשיו הגישה תהיה שונה - אנחנו &lt;strong&gt;לא&lt;/strong&gt; נגדיר הסתברות עבור איבר בודד אלא עבור &lt;strong&gt;קבוצות&lt;/strong&gt; של איברים, וההסתברות שנקבל באה לומר מה הסיכוי שנעלה בגורל איבר &lt;strong&gt;כלשהו&lt;/strong&gt; מתוך הקבוצה.&lt;/p&gt;

&lt;p&gt;בואו נבין קודם איך זה עובד עבור התפלגות אחידה בין 0 ל-1 כי אפילו במקרה הפשוט הזה אפשר לראות את הסיבוכים. ראשית, &lt;span&gt;\( p\left(\left[0,1\right]\right)=1 \)&lt;/span&gt; על פי מה שזה עתה תיארתי - ההסתברות שאני אקבל איבר &lt;strong&gt;כלשהו&lt;/strong&gt; בין 0 ל-1 היא כמובן 1, ההסתברות הכוללת האפשרית.&lt;/p&gt;

&lt;p&gt;מה עם &lt;span&gt;\( p\left(\left[0,\frac{1}{2}\right]\right) \)&lt;/span&gt;? אם חילקתי את הקטע שלי לשני חלקים שווים בגודלם, וההתפלגות אחידה, אני מניח שההסתברות שמספר אקראי יפול בחצי הראשון היא &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt;. אז קיבלנו &lt;span&gt;\( p\left(\left[0,\frac{1}{2}\right]\right)=\frac{1}{2} \)&lt;/span&gt; ומאותו נימוק &lt;span&gt;\( p\left(\left[\frac{1}{2},1\right]\right)=\frac{1}{2} \)&lt;/span&gt;. ואם אני אחלק את העולם שלי לשלושה חלקים? אז מתבקש ש-&lt;span&gt;\( p\left(\left[0,\frac{1}{3}\right]\right)=\frac{1}{3} \)&lt;/span&gt; וכן הלאה, ומכאן קצרה הדרך לטענה הכללית: &lt;span&gt;\( p\left(\left[a,b\right]\right)=b-a \)&lt;/span&gt;, לכל &lt;span&gt;\( 0\le a&amp;lt;b\le1 \)&lt;/span&gt;. כלומר, ההסתברות שמספר ייפול בקטע כלשהו שווה ממש לאורך שלו.&lt;/p&gt;

&lt;p&gt;זה כמובן מעלה את השאלה מה קורה אם &lt;span&gt;\( a=b \)&lt;/span&gt;. אם ה”קטע” שלי כולל בדיוק נקודה אחת. על פי מה שאמרתי כרגע, &lt;span&gt;\( p\left(\left[a,a\right]\right)=0 \)&lt;/span&gt;, ואם חושבים על זה לרגע פשוט &lt;strong&gt;אין לי ברירה&lt;/strong&gt;, זה חייב להיות ככה בדיוק מהנימוק שכבר ראינו. אבל אם ההסתברות של איבר בודד היא 0, מה הולך כאן? איך זה ייתכן שעבור איבר בודד ההסתברות היא 0 אבל עבור קבוצה של איברים היא לא, הרי ההסתברות של כל איבר בקבוצה היא 0!&lt;/p&gt;

&lt;p&gt;אז ראשית, אנחנו לומדים מכאן ש”הסתברות 0” בהקשר הרציף שבו אנחנו נמצאים עכשיו היא בעלת משמעות &lt;strong&gt;שונה&lt;/strong&gt; מאשר “הסתברות 0” בהקשר הבדיד. בהקשר הבדיד הסתברות 0 פירושה “זה אף פעם לא יקרה לעולם בחיים תשכחו מזה אין מצב” ואילו בהקשר הרציף הסתברות 0 פירושה “זה לא משהו סביר בפני עצמו אבל זה יכול לקרות”. זה לא “פרדוקס” או משהו דומה פשוט כי הסתברות רציפה היא משהו שאני ממציא &lt;strong&gt;כרגע&lt;/strong&gt;. זה מבנה מתמטי שבא להקל עלינו לתאר כל מני דברים; אין איזה חוק טבע קוסמי שקובע מה המשמעות של “הסתברות 0” במבנה הזה &lt;strong&gt;אמורה להיות&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;שנית, הקטע הזה של משהו שאינו 0 שמורכב מהרבה דברים שהם כן 0 לא אמור להיות חדש לנו, זו לא המצאה של תורת ההסתברות, אלא זו תוצאה של &lt;strong&gt;הגאומטריה&lt;/strong&gt; שבחרנו לבסס את תורת ההסתברות עליה. אנחנו מגדירים את ההסתברות של קטע בתור &lt;strong&gt;האורך&lt;/strong&gt; שלו, וקטע שכולל נקודה אחת הוא מאורך 0. אנחנו חיים עם זה טוב למרות שזה אומר שקטעים מאורך שגדול מ-0 מורכבים מאינסוף נקודות שהאורך של כל אחת מהן הוא כן 0, כי אנחנו לא &lt;strong&gt;מצפים&lt;/strong&gt; שהאורך של קטע יהיה בסך הכל סכום האורכים של הנקודות שמרכיבות אותו אלא משהו כללי יותר. באופן דומה כשאנחנו עוברים לדו מימד אז לקו אין &lt;strong&gt;שטח&lt;/strong&gt; למרות שאם ניקח ריבוע, אפשר לפרק אותו לאוסף של קווים, וכן הלאה.&lt;/p&gt;

&lt;p&gt;בסדר, אז השלמנו נפשית עם זה שלנקודה יש הסתברות 0, והיה לנו קל לקנות את זה שבהתפלגות האחידה, ההסתברות של הקטע &lt;span&gt;\( \left[a,b\right] \)&lt;/span&gt; היא &lt;span&gt;\( b-a \)&lt;/span&gt;. אבל מה ההסתברות של קבוצות מורכבות יותר של נקודות? אז למשל, אם ניקח את איחוד הקטעים &lt;span&gt;\( \left[0,\frac{1}{3}\right]\cup\left[\frac{2}{3},1\right] \)&lt;/span&gt; שאורך כל אחד מהם הוא &lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt; והם זרים, נצפה שהאורך של שניהם ביחד יהיה סכום האורכים שלהם, &lt;span&gt;\( \frac{1}{3}+\frac{1}{3} \)&lt;/span&gt;. זה יוצר ציפיה כללית יותר: שאם &lt;span&gt;\( A,B \)&lt;/span&gt; הן קבוצות זרות (או אפילו בעלות חיתוך שהוא נקודה משותפת בודדת כי פשוט אפשר להשמיט את הנקודה הזו מאחת הקבוצות) אז &lt;span&gt;\( p\left(A\cup B\right)=p\left(A\right)+p\left(B\right) \)&lt;/span&gt;. התכונה הזו נקראת &lt;strong&gt;אדיטיביות&lt;/strong&gt; ואם היא מתקיימת אז אפשר להוכיח באינדוקציה שמתקיים &lt;span&gt;\( p\left(\bigcup_{i=1}^{n}A_{i}\right)=\sum_{i=1}^{n}p\left(A_{i}\right) \)&lt;/span&gt; עבור קבוצות זרות. אבל למעשה, אנחנו רוצים אפילו יותר מכך - בגלל שאפשר לעשות לקטע &lt;span&gt;\( \left[0,1\right] \)&lt;/span&gt; את מה שנקרא “פרדוקס הדיכוטומיה” (הפרדוקס שבו אכילס רוצה לרוץ מקצה אחד של מסלול לקצה השני אבל קודם הוא צריך לעבור את חצי הדרך ואז את חצי מה שנשאר וכן הלאה) ולקבל &lt;span&gt;\( \left[0,1\right]=\left[0,\frac{1}{2}\right]\cup\left[\frac{1}{2},\frac{3}{4}\right]\cup\left[\frac{3}{4},\frac{7}{8}\right]\cup\ldots \)&lt;/span&gt; כך שהיינו מצפים שיתקיים &lt;span&gt;\( p\left(\left[0,\frac{1}{2}\right]\cup\left[\frac{1}{2},\frac{3}{4}\right]\cup\left[\frac{3}{4},\frac{7}{8}\right]\cup\ldots\right)=1 \)&lt;/span&gt; וזה אכן מתקיים אם מניחים ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( p\left(\left[0,\frac{1}{2}\right]\cup\left[\frac{1}{2},\frac{3}{4}\right]\cup\left[\frac{3}{4},\frac{7}{8}\right]\cup\ldots\right)=p\left(\left[0,\frac{1}{2}\right]\right)+p\left(\left[\frac{1}{2},\frac{3}{4}\right]\right)+\ldots=\frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\ldots=1 \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשהשוויון האחרון נובע ממה שאנחנו יודעים על סכומים אינסופיים (ואנחנו יודעים אותו כי זה חלק מחדו”א). אז התכונה שאנחנו מצפים שתתקיים היא &lt;span&gt;\( p\left(\bigcup_{i=1}^{\infty}A_{i}\right)=\sum_{i=1}^{\infty}p\left(A_{i}\right) \)&lt;/span&gt; ולדבר כזה קוראים “&lt;span&gt;\( \sigma \)&lt;/span&gt;-אדיטיביות”.&lt;/p&gt;

&lt;p&gt;במילים אחרות, אנחנו רוצים ש-&lt;span&gt;\( p \)&lt;/span&gt; תהיה פונקציה על תתי-קבוצות של &lt;span&gt;\( \left[0,1\right] \)&lt;/span&gt; שמקיימת &lt;span&gt;\( \sigma \)&lt;/span&gt;-אדיטיביות ושלכל &lt;span&gt;\( A \)&lt;/span&gt; יתקיים &lt;span&gt;\( p\left(A\right)\ge0 \)&lt;/span&gt; ולא אמרתי את זה במפורש אבל מן הסתם &lt;span&gt;\( p\left(\emptyset\right)=0 \)&lt;/span&gt; כי אפילו על קבוצה עם נקודה אחת מקבלים 0. לפונקציה &lt;span&gt;\( p \)&lt;/span&gt; כזו יש שם: &lt;strong&gt;מידה&lt;/strong&gt;. יש תחום שלם שעוסק במידות ובשימושים הנרחבים שלהן, אבל אני לא אכנס לזה בכלל כאן, רק אעיר שלוש הערות. ראשית, מ-&lt;span&gt;\( p \)&lt;/span&gt; אנחנו דורשים עוד משהו שלא נדרש ממידות באופן כללי - ש-&lt;span&gt;\( p \)&lt;/span&gt; על “הכל” יהיה שווה 1. למידה שמקיימת את זה קוראים &lt;strong&gt;מידת הסתברות&lt;/strong&gt;. שנית, גם אם ההתפלגויות הבדידות שראינו קודם אפשר לנסח בפורמליזם של מידות. אני אוותר על זה כאן, אבל זו הדרך “לאחד” את ההתפלגויות הבדידות עם הרציפות. לבסוף, וזה החלק הקריטי, &lt;strong&gt;למידה יש מגבלות&lt;/strong&gt;. בפרט, פשוט אי אפשר להגדיר מידה על &lt;strong&gt;כל&lt;/strong&gt; תת-הקבוצות של &lt;span&gt;\( \left[0,1\right] \)&lt;/span&gt; ואני נותן הוכחה לזה &lt;a href=&quot;https://gadial.net/2010/03/03/no_measure_on_the_real_line/&quot;&gt;כאן&lt;/a&gt;. זה אומר שלא לכל תת-קבוצה של &lt;span&gt;\( \left[0,1\right] \)&lt;/span&gt; תהיה הסתברות מוגדרת, אפילו תחת ההתפלגות האחידה, פשוט כי תתי-הקבוצות הללו “מסובכות מדי” (לא לבלבל את זה עם תת-הקבוצה &lt;span&gt;\( \left\{ a\right\}  \)&lt;/span&gt; שההסתברות שלה בהחלט מוגדרת, פשוט שווה לאפס).&lt;/p&gt;

&lt;p&gt;כל זה דיבר רק על התפלגות &lt;strong&gt;אחידה&lt;/strong&gt;, אבל מה קורה באופן כללי? במקרה הכללי עדיין ההסתברות של כל נקודה תהיה אפס, אבל לא כל הנקודות יהיו שוות זו לזו - יהיו נקודות שהאפס שלהן “יותר גדול”. למעשה, זה &lt;strong&gt;כבר קרה&lt;/strong&gt; אם חושבים על ההתפלגות האחידה על &lt;span&gt;\( \left[0,1\right] \)&lt;/span&gt; בתור משהו שה”עולם” שלו הוא כל הממשיים, &lt;span&gt;\( \mathbb{R} \)&lt;/span&gt;. מה שקרה הוא שלממשיים ב-&lt;span&gt;\( \left[0,1\right] \)&lt;/span&gt; היה משקל חיובי שבא לידי ביטוי כשמאגדים מספיק מהם ביחד, בזמן שלממשיים מחוץ לקטע היה משקל אפס ולכן לא משנה כמה מהם מאגדים ביחד, לא יוצא מזה כלום. עולה השאלה - מה הכלי הטכני שיש לנו שמסוגל לשלב ככה בין &lt;strong&gt;האורך&lt;/strong&gt; של קטע ובין &lt;strong&gt;המשקל&lt;/strong&gt; שאנחנו נותנים לו? ויש כלי כזה, שהוא אחד מהכוכבים הנוצצים של המתמטיקה: &lt;strong&gt;אינטגרל&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;הנה הרעיון הפורמלי: כשאנחנו באים להגדיר משתנה מקרי רציף &lt;span&gt;\( X \)&lt;/span&gt;, הוא תאופיין על ידי פונקציה &lt;span&gt;\( f:\mathbb{R}\to[0,\infty( \)&lt;/span&gt; שנקראת &lt;strong&gt;פונקציית צפיפות ההסתברות&lt;/strong&gt; כך ש-&lt;span&gt;\( P\left(X\in B\right)=\int_{B}f\left(x\right)dx \)&lt;/span&gt; בהנחה שהאינטגרל מוגדר (ואחרת &lt;span&gt;\( P\left(X\in B\right) \)&lt;/span&gt; פשוט לא יהיה מוגדר). ה”צפיפות” בשם הפונקציה לא תפתיע כנראה אף אחת שמכירה פיזיקה: אם יש לנו צורה &lt;span&gt;\( B \)&lt;/span&gt; ואנחנו רוצים לחשב את המסה שלה, אנחנו מבצעים אינטגרל על &lt;span&gt;\( B \)&lt;/span&gt; על הפונקציה שמתארת את &lt;strong&gt;הצפיפות&lt;/strong&gt; של &lt;span&gt;\( B \)&lt;/span&gt; (כמה מסה מרוכזת בכל איזור של &lt;span&gt;\( B \)&lt;/span&gt;). זה בדיוק אותו רעיון.&lt;/p&gt;

&lt;p&gt;הדרישה היחידה שלנו מ-&lt;span&gt;\( f \)&lt;/span&gt; פרט לחיוביות שלה היא שההסתברות הכוללת תצא 1, כלומר שיתקיים &lt;span&gt;\( \int_{-\infty}^{\infty}f\left(x\right)dx=1 \)&lt;/span&gt;. אני מניח כאן שאנחנו בסדר עם אינטגרלים מוכללים - אבל גם אם אנחנו לא בסדר לא נורא, נראה שהחישובים הרלוונטיים הם לא סוף העולם.&lt;/p&gt;

&lt;p&gt;עבור ההתפלגות האחידה, פונקציית הצפיפות די פשוטה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( f\left(x\right)=\begin{cases} 1 &amp;amp; x\in\left[0,1\right]\\ 0 &amp;amp; x\notin\left[0,1\right] \end{cases} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אם היינו רוצים להגדיר התפלגות אחידה על קטע גדול יותר, למשל &lt;span&gt;\( \left[0,2\right] \)&lt;/span&gt;, היינו צריכים לשנות את הפונקציה בהתאם כדי שהאינטגרל על הכל ייצא 1:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( f\left(x\right)=\begin{cases} \frac{1}{2} &amp;amp; x\in\left[0,2\right]\\ 0 &amp;amp; x\notin\left[0,2\right] \end{cases} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הבנו את הרעיון? יפה, אז אפשר סוף כל סוף להגיע אל ההתפלגות שהיא הסיבה שלשמה נתכנסנו: ההתפלגות הנורמלית.&lt;/p&gt;

&lt;h2&gt;מפגש ראשון עם התפלגות נורמלית&lt;/h2&gt;

&lt;p&gt;אמרתי בתחילת הפוסט שהתפלגות נורמלית מוגדרת עם &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt; ועכשיו אנחנו סוף סוף יכולים להבין מה הולך כאן, אבל זה &lt;strong&gt;עדיין&lt;/strong&gt; מסובך מדי; לעת עתה אני אסתכל על מקרה פרטי מרכזי, שממנו בעצם קל יחסית להבין את המקרה הכללי - הפונקציה &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}} \)&lt;/span&gt; שמתקבלת מהצבת &lt;span&gt;\( \mu=0,\sigma=1 \)&lt;/span&gt; בנוסחה הקודמת. ככה הפונקציה הזו נראית כשמציירים גרף שלה:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_11.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;הגרף הזה מתאר רק את החלק &lt;span&gt;\( \left[-3,3\right] \)&lt;/span&gt; כי זה החלק המעניין; מחוץ לו הפונקציה פשוט נראית ממש שטוחה. לפונקציה הזו יש שלל שמות - בפרט “עקומת הפעמון” בגלל הצורה שלה, או “גאוסיאן” על שם המתמטיקאי גאוס שעשה בה שימוש נרחב (אבל לא היה הראשון שתיאר אותה; זה היה דה-מואבר).&lt;/p&gt;

&lt;p&gt;השאלה המנחה שלנו בכל סדרת הפוסטים הזו היא “מאיפה הפונקציה הזו הגיעה בכלל?” והתשובה שאני נותן כאן היא “ממשפט הגבול המרכזי” שאותו אני עוד צריך להראות פורמלית אבל כבר אמרתי מהו - העקומה הספציפית הזו פשוט מתארת &lt;strong&gt;ממש טוב&lt;/strong&gt; את מה שקורה כשיש לנו משתנה מקרי ואנחנו מחברים הרבה עותקים בלתי תלויים של עצמו. אבל כבר בשלב הזה אני יכול להסביר מאיפה&lt;strong&gt; חלק&lt;/strong&gt; מהפונקציה הגיע - למה &lt;span&gt;\( \pi \)&lt;/span&gt; נמצא שם. התשובה הקצרה היא שהוא שם כי &lt;span&gt;\( 2\pi \)&lt;/span&gt; הוא היקף מעגל היחידה. התשובה הקצת פחות קצרה היא שהוא שם בגלל הדרישה &lt;span&gt;\( \int_{-\infty}^{\infty}f\left(x\right)dx=1 \)&lt;/span&gt; על פונקציות צפיפות. בואו נעבור לתשובה המלאה.&lt;/p&gt;

&lt;p&gt;אז כאמור, אנחנו צריכים להראות שמתקיים &lt;span&gt;\( \int_{-\infty}^{\infty}f\left(x\right)dx=1 \)&lt;/span&gt;, כלומר &lt;span&gt;\( \int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}dx=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx=1 \)&lt;/span&gt;, כלומר מספיק להראות ש-&lt;span&gt;\( \int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx=\sqrt{2\pi} \)&lt;/span&gt;. עכשיו, איך בדרך כלל מחשבים אינטגרל מהצורה &lt;span&gt;\( \int_{-\infty}^{\infty}f\left(x\right)dx \)&lt;/span&gt;? קודם כל מוצאים &lt;strong&gt;פונקציה קדומה&lt;/strong&gt;, &lt;span&gt;\( F\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( F^{\prime}\left(x\right)=f\left(x\right) \)&lt;/span&gt;. אחר כך מחשבים את האינטגרל על הגבולות הסופיים &lt;span&gt;\( \int_{a}^{b}f\left(x\right)dx=F\left(b\right)-F\left(a\right) \)&lt;/span&gt;, ולבסוף משאיפים בזהירות את &lt;span&gt;\( b \)&lt;/span&gt; ל-&lt;span&gt;\( \infty \)&lt;/span&gt; ואת &lt;span&gt;\( a \)&lt;/span&gt; ל-&lt;span&gt;\( -\infty \)&lt;/span&gt; ובודקים לאן הביטוי הולך.&lt;/p&gt;

&lt;p&gt;זה לא מה שיקרה כאן.&lt;/p&gt;

&lt;p&gt;לב הבעיה הוא שלפונקציה &lt;span&gt;\( e^{-x^{2}} \)&lt;/span&gt; &lt;strong&gt;אין&lt;/strong&gt; פונקציה קדומה שאפשר להציג בצורה פשוטה (“אלמנטרית”). להוכיח את זה זה סיפור בפני עצמו ואני לא אכנס לזה הפעם, אבל תשכחו מהשיטה המסורתית. לא נחשב את האינטגרל הזה בדרך המסורתית. למרבה השמחה, לא חסרות דרכים אחרות.&lt;/p&gt;

&lt;p&gt;בואו נסמן &lt;span&gt;\( I=\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt;. במקום להוכיח &lt;span&gt;\( I=\sqrt{2\pi} \)&lt;/span&gt;, נוכיח ש-&lt;span&gt;\( I^{2}=2\pi \)&lt;/span&gt; (ובגלל שהאינטגרל של &lt;span&gt;\( I \)&lt;/span&gt; הוא על פונקציה &lt;strong&gt;חיובית&lt;/strong&gt;, &lt;span&gt;\( I \)&lt;/span&gt; הוא השורש החיובי של &lt;span&gt;\( 2\pi \)&lt;/span&gt;). הרעיון הוא להפוך את &lt;span&gt;\( I^{2} \)&lt;/span&gt;, שהוא מכפלה של שני אינטגרלים במשתנה יחיד, לאינטגרל &lt;strong&gt;כפול&lt;/strong&gt; באמצעות מה שנקרא &lt;strong&gt;משפט פוביני&lt;/strong&gt;. בואו נתחיל מלראות איך זה בערך עובד ואז נדבר על הפרטים הטכניים שצריך לגהץ. הטריק הבסיסי הוא זה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( I^{2}=\left(\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx\right)\left(\int_{-\infty}^{\infty}e^{-\frac{y^{2}}{2}}dy\right)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו מבצעים &lt;strong&gt;החלפת משתנים&lt;/strong&gt; של האינטגרל הכפול. מגדירים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=r\cos\theta \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( y=r\sin\theta \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עבור &lt;span&gt;\( r\in[0,\infty( \)&lt;/span&gt; ו-&lt;span&gt;\( \theta\in\left[0,2\pi\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שנותן לנו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x^{2}+y^{2}=r^{2}\left(\cos^{2}\theta+\sin^{2}\theta\right)=r^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( dxdy=rd\theta dr \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy=\int_{0}^{\infty}\left(\int_{0}^{2\pi}re^{-\frac{r^{2}}{2}}d\theta\right)dr= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( =2\pi\int_{0}^{\infty}re^{-\frac{r^{2}}{2}}dr=-2\pi\left.e^{\frac{-r^{2}}{2}}\right|_{0}^{\infty}=2\pi \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אוקיי, מה קרה פה כרגע? לי זה נראה כמו קסם בכל פעם שאני רואה את זה, אבל האמת היא שלא קרה פה שום דבר חריג - זה תרגיל מאוד סטנדרטי בחדו”א, וכפי שקורה בדרך כלל בחדו”א - &lt;strong&gt;להצדיק&lt;/strong&gt; כל מעבר דורש עבודה אבל מרגע שיושב לנו למה אפשר להצדיק את כולם, העבודה היא די פשוטה. אני אתחיל דווקא מהסוף ואלך אחורה צעד-צעד כדי שנראה שהכל תקין, כי ככל שמתקרבים להתחלה כך הנניח-נזניח שלנו נהיה גדול יותר.&lt;/p&gt;

&lt;p&gt;ראשית, האינטגרל &lt;span&gt;\( \int_{0}^{\infty}re^{-\frac{r^{2}}{2}}dr \)&lt;/span&gt;. הוא מאוד מזכיר את מה שהתחלנו ממנו, &lt;span&gt;\( \int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt;, אבל יש הבדל מהותי אחד: &lt;span&gt;\( e^{-\frac{r^{2}}{2}} \)&lt;/span&gt; מוכפל ב-&lt;span&gt;\( r \)&lt;/span&gt;, וההבדל הקטן הזה פירושו &lt;strong&gt;שיש&lt;/strong&gt; פונקציה קדומה אלמנטרית לאינטגרנד. אם אנחנו גוזרים את &lt;span&gt;\( e^{x} \)&lt;/span&gt; אנחנו מקבלים &lt;span&gt;\( e^{x} \)&lt;/span&gt;; זו התכונה הבסיסית של הפונקציה הזו (אפשר אפילו &lt;strong&gt;להגדיר&lt;/strong&gt; אותה באמצעותה, &lt;a href=&quot;https://gadial.net/2010/03/27/exponent/&quot;&gt;הנה פוסט&lt;/a&gt; שעושה את זה). עכשיו, על פי כלל השרשרת, &lt;span&gt;\( \left(e^{g\left(x\right)}\right)^{\prime}=g^{\prime}\left(x\right)e^{g\left(x\right)} \)&lt;/span&gt;, ומכיוון שבמקרה שלנו &lt;span&gt;\( g\left(r\right)=-\frac{r^{2}}{2} \)&lt;/span&gt; נקבל &lt;span&gt;\( g^{\prime}\left(r\right)=-r \)&lt;/span&gt; כלומר &lt;span&gt;\( \left(e^{-\frac{r^{2}}{2}}\right)=-re^{-\frac{r^{2}}{2}} \)&lt;/span&gt; ולכן הפונקציה הקדומה של &lt;span&gt;\( re^{-\frac{r^{2}}{2}} \)&lt;/span&gt; היא &lt;span&gt;\( -e^{-\frac{r^{2}}{2}} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;מה שנשאר לנו, אם אנחנו יודעים את הפונקציה הקדומה, הוא לחשב את &lt;span&gt;\( -2\pi\left.e^{\frac{-r^{2}}{2}}\right|_{0}^{\infty} \)&lt;/span&gt;. החישוב הוא סטנדרטי לאינטגרלים מוכללים: כדי לחשב את &lt;span&gt;\( \left.F\left(r\right)\right|_{0}^{\infty} \)&lt;/span&gt; לוקחים &lt;span&gt;\( a\in[0,\infty( \)&lt;/span&gt; כלשהו ומחשבים את &lt;span&gt;\( \lim_{a\to\infty}\left[F\left(a\right)-F\left(0\right)\right] \)&lt;/span&gt;. במקרה שלנו, &lt;span&gt;\( \lim_{a\to\infty}e^{-\frac{a^{2}}{2}}=0 \)&lt;/span&gt; כי &lt;span&gt;\( e^{x} \)&lt;/span&gt; הוא פונקציה רציפה וכש-&lt;span&gt;\( a\to\infty \)&lt;/span&gt; אז &lt;span&gt;\( -\frac{a^{2}}{2}\to-\infty \)&lt;/span&gt; ואנחנו יודעים ש-&lt;span&gt;\( \lim_{x\to-\infty}e^{x}=0 \)&lt;/span&gt;. מצד שני, כשמציבים &lt;span&gt;\( ra=0 \)&lt;/span&gt; ב-&lt;span&gt;\( e^{\frac{-r^{2}}{2}} \)&lt;/span&gt; מקבלים 1, ולכן בסך הכל נשארים עם &lt;span&gt;\( -2\pi\cdot0-\left(-2\pi\cdot1\right)=2\pi \)&lt;/span&gt;. עד כאן הכל טוב.&lt;/p&gt;

&lt;p&gt;עכשיו בואו נדבר על &lt;strong&gt;החלפת המשתנים&lt;/strong&gt; שמאפשרת לנו לכתוב &lt;span&gt;\( \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy=\int_{0}^{\infty}\left(\int_{0}^{2\pi}re^{-\frac{r^{2}}{2}}d\theta\right)dr \)&lt;/span&gt;. כאן יש את הפער הגדול ביותר בין כמה שהפעולה הטכנית הזו היא סטנדרטית אחרי שהתרגלנו אליה, וכמה המשפט שעליה היא מבוססת הוא עמוק ומורכב. &lt;a href=&quot;https://gadial.net/2016/04/12/general_change_of_variables/&quot;&gt;יש לי פוסט&lt;/a&gt; על הוכחת המשפט באופן כללי וזה… לא כל כך פשוט. אבל למרבה השמחה מה שפשוט הוא &lt;strong&gt;הרעיון&lt;/strong&gt;. את הרעיון, גם במקרה הכי כללי, אפשר לתאר על ידי הנוסחה הפשוטה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \int_{B}f=\int_{A}\left(f\circ g\right)\left|\det Dg\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;(הנוסחה הזו משמיטה את ה-&lt;span&gt;\( dx \)&lt;/span&gt;-ים למיניהם שאנחנו משתמשים בהם כדי לעקוב אחרי משתני האינטגרציה). הרעיון פה הוא ש-&lt;span&gt;\( f \)&lt;/span&gt; היא הפונקציה שעליה מבצעים אינטגרציה, וכדי שהמשפט יעבוד היא צריכה להיות רציפה (במקרה שלנו &lt;span&gt;\( e^{-\frac{\left(x^{2}+y^{2}\right)}{2}} \)&lt;/span&gt; רציפה) ואילו &lt;span&gt;\( g \)&lt;/span&gt; היא הפונקציה שמתארת את החלפת המשתנים - במקרה שלנו זו החלפה היא &lt;strong&gt;מאוד סטנדרטית&lt;/strong&gt;, אולי ההחלפה הכי בסיסית שרואים בחדו”א. היא מתבססת על פונקציה &lt;span&gt;\( g:\mathbb{R}^{2}\to\mathbb{R}^{2} \)&lt;/span&gt; שמוגדרת על ידי &lt;span&gt;\( g\left(r,\theta\right)=\left(r\cos\theta,r\sin\theta\right) \)&lt;/span&gt;. את הפונקציה הזו צריך לצמצם לתת-קבוצה &lt;span&gt;\( A \)&lt;/span&gt;, כך שעל תת-הקבוצה הזו &lt;span&gt;\( g \)&lt;/span&gt; היא חח”ע ועל, והתמונה שלה היא בדיוק &lt;span&gt;\( B \)&lt;/span&gt;, הקבוצה שעליה אנחנו מנסים לבצע את האינטגרציה של &lt;span&gt;\( f \)&lt;/span&gt;. במקרה שלנו, &lt;span&gt;\( A=\left(0,\infty\right)\times[0,2\pi( \)&lt;/span&gt; בזמן ש-&lt;span&gt;\( B=\mathbb{R}^{2}\backslash\left\{ 0\right\}  \)&lt;/span&gt; (אני משמיט את 0 כי איתו &lt;span&gt;\( g \)&lt;/span&gt; כבר לא תהיה חח”ע, אבל נקודה אחת לא משפיעה על האינטגרל). על &lt;span&gt;\( g \)&lt;/span&gt; יש דרישה חזקה יותר של רציפות - גם היא וגם ההופכית שלה צריכות להיות גזירות ברציפות, אבל לא קשה לבדוק שזה מתקיים.&lt;/p&gt;

&lt;p&gt;הביטוי &lt;span&gt;\( f\circ g \)&lt;/span&gt; פירושו “קודם להפעיל את &lt;span&gt;\( g \)&lt;/span&gt; ואז את &lt;span&gt;\( f \)&lt;/span&gt;” (כן, אני יודע שיש טקסטים שעושים בדיוק ההפך) אז במקרה שלנו אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(f\circ g\right)\left(r,\theta\right)=e^{-\frac{\left(r\cos\theta\right)^{2}+\left(r\sin\theta\right)^{2}}{2}}=e^{-\frac{r^{2}}{2}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זו “החלפת המשתנים” בפעולה (ואני מקווה שזה מבהיר למה &lt;span&gt;\( g \)&lt;/span&gt; היא דווקא מהמשתנים ה”חדשים” ל”ישנים”; אותי זה תמיד מבלבל). מה שנשאר לעשות הוא לכפול בביטוי &lt;span&gt;\( \left|\det Dg\right| \)&lt;/span&gt; שנקרא &lt;strong&gt;היעקוביאן&lt;/strong&gt; של &lt;span&gt;\( g \)&lt;/span&gt;, שהוא הגורם שמודד כמה &lt;span&gt;\( g \)&lt;/span&gt; “מעוותת את המרחב” ולכן משנה את תפיסת השטח שלנו. כאן &lt;span&gt;\( Dg \)&lt;/span&gt; היא מטריצה של כל הנגזרות החלקיות של &lt;span&gt;\( g \)&lt;/span&gt;: מכיוון ש-&lt;span&gt;\( g:\mathbb{R}^{2}\to\mathbb{R}^{2} \)&lt;/span&gt; היא פונקציה בשני משתנים יש ל-&lt;span&gt;\( Dg \)&lt;/span&gt; שתי עמודות - בעמודה הראשונה גוזרים לפי &lt;span&gt;\( r \)&lt;/span&gt; ובשניה לפי &lt;span&gt;\( \theta \)&lt;/span&gt;. בנוסף, מכיוון ש-&lt;span&gt;\( g \)&lt;/span&gt; היא פונקציה עם שני רכיבים, יש ל-&lt;span&gt;\( Dg \)&lt;/span&gt; שני שורות: בראשונה גוזרים את הרכיב &lt;span&gt;\( r\cos\theta \)&lt;/span&gt; ובשניה את הרכיב &lt;span&gt;\( r\sin\theta \)&lt;/span&gt;. מקבלים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( Dg=\left[\begin{array}{cc} \cos\theta &amp;amp; -r\sin\theta\\ \sin\theta &amp;amp; r\cos\theta \end{array}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \det Dg=r\cos^{2}\theta+r\sin^{2}\theta=r\left(\cos^{2}\theta+\sin^{2}\theta\right)=r \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואנחנו כופלים &lt;strong&gt;בערך המוחלט&lt;/strong&gt; של הביטוי הזה, כלומר עדיין כופלים ב-&lt;span&gt;\( r \)&lt;/span&gt;. כל הדבר הזה מתבטא בפועל בכלל המצחיק &lt;span&gt;\( dxdy=rd\theta dr \)&lt;/span&gt; שהוא לא משהו פורמלי (למרות &lt;a href=&quot;https://gadial.net/2016/08/21/stokes_theorem_overview/&quot;&gt;שאם באמת רוצים&lt;/a&gt; &lt;strong&gt;אפשר&lt;/strong&gt; לפרמל את המשמעות של ה-&lt;span&gt;\( dx \)&lt;/span&gt;-ים הללו אבל בואו לא נעשה את זה הפעם) שאומר לנו “אחרי שהחלפתם את המשתנים באינטגרנד, תחליפו גם את הסימן שמתאר לכם את משתני הסכימה אבל אל תשכחו בנוסף גם לכפול ביעקוביאן &lt;span&gt;\( r \)&lt;/span&gt;”. מכאן והלאה האינטגרל נפתר בקלות.&lt;/p&gt;

&lt;p&gt;מה שנשאר לי להסביר הוא את המעבר&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx\right)\left(\int_{-\infty}^{\infty}e^{-\frac{y^{2}}{2}}dy\right)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;שבו הופכים מכפלה של שני אינטגרלים חד-ממדיים לאינטגרל דו-ממדי. הכלי הבסיסי פה הוא &lt;strong&gt;משפט פוביני&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \int\int_{X\times Y}f\left(x,y\right)dxdy=\int_{X}\left(\int_{Y}f\left(x,y\right)dy\right)dx \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן באגף שמאל יש לנו אינטגרל כפול, ובאגף ימין יש לנו שני אינטגרלים חד-ממדיים, אבל לא מוכפלים אלא מופעלים אחד על השני. כלומר, האינטגרל החיצוני &lt;span&gt;\( \int_{X}\left(\ldots\right)dx \)&lt;/span&gt; מופעל על פונקציה של &lt;span&gt;\( x \)&lt;/span&gt; שמתקבלת מכך שבוחרים ערך ל-&lt;span&gt;\( x \)&lt;/span&gt;, “מקפיאים” אותו ומחשבים את האינטגרל החד-ממדי &lt;span&gt;\( \int_{Y}f_{x}\left(y\right)dy \)&lt;/span&gt; שמופעל על הפונקציה &lt;span&gt;\( f_{x}\left(y\right) \)&lt;/span&gt; שמוגדרת על ידי &lt;span&gt;\( f_{x}\left(y\right)=f\left(x,y\right) \)&lt;/span&gt;. כדי שהטריק הזה יעבוד צריך שה-&lt;span&gt;\( f \)&lt;/span&gt; שלנו תהיה רציפה (כבר ראינו שזה קורה) או שהאינטגרל לא יהיה אינטגרל רגיל אלא הגרסה המוכללת והחזקה שלו, &lt;strong&gt;אינטגרל לבג&lt;/strong&gt;, אבל על זה אני לא אדבר הפעם.&lt;/p&gt;

&lt;p&gt;במקרה הספציפי שלנו, &lt;span&gt;\( f\left(x,y\right)=e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}=e^{-\frac{x^{2}}{2}}\cdot e^{-\frac{y^{2}}{2}} \)&lt;/span&gt; כלומר אם אני מסתכל על &lt;span&gt;\( f_{x}\left(y\right) \)&lt;/span&gt; זו פונקציה מהצורה של קבוע (שתלוי ב-&lt;span&gt;\( x \)&lt;/span&gt;) שמוכפל ב-&lt;span&gt;\( e^{-\frac{y^{2}}{2}} \)&lt;/span&gt;. מכפלה בקבוע אפשר להוציא מחוץ לאינטגרל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \int_{X}\left(\int_{Y}f\left(x,y\right)dy\right)dx=\int_{X}e^{-\frac{x^{2}}{2}}\left(\int_{Y}e^{-\frac{y^{2}}{2}}dy\right)dx \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אבל עכשיו מה שיש באינטגרל הפנימי &lt;strong&gt;לא תלוי&lt;/strong&gt; ב-&lt;span&gt;\( x \)&lt;/span&gt; בשום צורה, כלומר הוא תמיד יוצא אותו מספר לא משנה מה הערך של &lt;span&gt;\( x \)&lt;/span&gt;, ולכן מנקודת המבט של האינטגרל החיצוני, &lt;span&gt;\( \int_{Y}e^{-\frac{y^{2}}{2}}dy \)&lt;/span&gt; הוא &lt;strong&gt;קבוע&lt;/strong&gt; שאפשר להוציא החוצה, ומקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \int_{X}\left(\int_{Y}f\left(x,y\right)dy\right)dx=\int_{X}e^{-\frac{x^{2}}{2}}dx\int_{Y}e^{-\frac{y^{2}}{2}}dy \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה מה שהשתמשתי בו בהוכחה.&lt;/p&gt;

&lt;p&gt;יש רק בעיה קטנה אחת פה: בשביל להשתמש במשפט פוביני, אני צריך ש-&lt;span&gt;\( X,Y \)&lt;/span&gt; יהיו קטעים סופיים. זה גורר עוד סיבוך טכני. במקום לחשב את &lt;span&gt;\( I=\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt; אני בוחר &lt;span&gt;\( a\in[0,\infty( \)&lt;/span&gt; ומחשב את &lt;span&gt;\( I\left(a\right)=\int_{-a}^{a}e^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt; ואז בודק מה יוצא &lt;span&gt;\( \lim_{a\to\infty}I\left(a\right) \)&lt;/span&gt;. אבל אפילו כאן מתחבא &lt;strong&gt;עוד&lt;/strong&gt; סיבוך טכני! כי באינטגרל מוכלל מהצורה &lt;span&gt;\( \int_{-\infty}^{\infty}f\left(x\right)dx \)&lt;/span&gt; זה &lt;strong&gt;לא תקין&lt;/strong&gt; לבחור נקודה אחת &lt;span&gt;\( a \)&lt;/span&gt; ולהסתכל על הגבול &lt;span&gt;\( \lim_{a\to\infty}\int_{-a}^{a}f\left(x\right)dx \)&lt;/span&gt; כי הסימטריה שזה יוצר עלולה “למסך” תקלות. האופן שבו &lt;strong&gt;באמת&lt;/strong&gt; מגדירים את הערך של אינטגרל אינסופי לשני הכיוונים שכזה הוא עם אחת משתי השיטות הבאות: או שבוחרים &lt;span&gt;\( a,b \)&lt;/span&gt; ומסתכלים על הגבול &lt;strong&gt;הכפול&lt;/strong&gt; &lt;span&gt;\( \lim_{a\to\infty}\lim_{b\to\infty}\int_{a}^{b}f\left(x\right)dx \)&lt;/span&gt; או שמפצלים את האינטגרל לסכום של שני אינטגרלים, &lt;span&gt;\( \int_{-\infty}^{\infty}f\left(x\right)dx=\int_{-\infty}^{c}f\left(x\right)dx+\int_{c}^{\infty}f\left(x\right)d\left(x\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;כדי לראות למה זה קריטי, בואו ניקח &lt;span&gt;\( f\left(x\right)=x \)&lt;/span&gt;. אז למשל &lt;span&gt;\( \int_{0}^{\infty}xdx=\left.\frac{x^{2}}{2}\right|_{0}^{\infty}=\infty \)&lt;/span&gt; ובדומה &lt;span&gt;\( \int_{-\infty}^{0}xdx=-\infty \)&lt;/span&gt; והביטוי &lt;span&gt;\( \infty-\infty \)&lt;/span&gt; בכלל לא מוגדר; ואם אני מסתכל על &lt;span&gt;\( \int_{a}^{b}xdx=\frac{b^{2}-a^{2}}{2} \)&lt;/span&gt; אז הגבול הכפול &lt;span&gt;\( \lim_{a\to\infty}\lim_{b\to\infty}\frac{b^{2}-a^{2}}{2} \)&lt;/span&gt; שוב לא יהיה מוגדר, מאותן סיבות.&lt;/p&gt;

&lt;p&gt;באינטגרל שלנו, &lt;span&gt;\( \int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt;, זו לא בעיה אמיתית כי אפשר לפרק את האינטגרל באמצע ולקבל שני חלקים שכל אחד מהם מתכנס יפה למשהו סופי (אל &lt;span&gt;\( \frac{\sqrt{2\pi}}{2} \)&lt;/span&gt; בגלל הסימטריה) אבל אם אני חותך את האינטגרל באמצע, כל הטריקים היפים שעשיתי קודם כבר לא עובדים! הצילו! חדו”א יכול להיות מאוד אכזרי לפעמים.&lt;/p&gt;

&lt;p&gt;למרבה המזל, יש לנו דרך קיצור כאן. יש שיטה שנקראת “הערך העיקרי של קושי” (Principal Value) שמאפשרת לתת ערך ל-&lt;span&gt;\( \lim_{a\to\infty}\int_{-a}^{a}f\left(x\right)dx \)&lt;/span&gt;, והערך הזה יוצא שווה אל &lt;span&gt;\( \int_{-\infty}^{\infty}f\left(x\right)dx \)&lt;/span&gt; במקרים שבהם &lt;span&gt;\( f\left(x\right) \)&lt;/span&gt; מתכנסת בערך מוחלט, כלומר אם &lt;span&gt;\( \int_{-\infty}^{\infty}\left|f\left(x\right)\right|dx&amp;lt;\infty \)&lt;/span&gt;. זה בהחלט המצב גם עבור &lt;span&gt;\( \int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt;. ראשית, הערך המוחלט בכלל לא משפיע כאן כי &lt;span&gt;\( e \)&lt;/span&gt; בחזקת משהו ממשי הוא תמיד חיובי; ושנית, אפשר לחסום את האינטגרל הזה בצורה די נחמדה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx&amp;lt;\int_{-\infty}^{-1}-xe^{-\frac{x^{2}}{2}}dx+\int_{-1}^{1}e^{-\frac{x^{2}}{2}}dx+\int_{1}^{\infty}xe^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כי כאשר &lt;span&gt;\( x \)&lt;/span&gt; גדול מ-1 מכפלה בו רק מגדילה את האינטגרל, וכשהוא קטן ממינוס 1 מכפלה ב-&lt;span&gt;\( -x \)&lt;/span&gt; רק מגדילה את האינטגרל. עכשיו קיבלנו סכום של שלושה אינטגרלים שהאמצעי מביניהם הוא בוודאי סופי (כי הוא של פונקציה רציפה על קטע סגור) ואת האחרים אפשר לחשב במפורש כפי שכבר ראינו קודם, למשל &lt;span&gt;\( \int_{1}^{\infty}xe^{-\frac{x^{2}}{2}}=\left.-e^{-\frac{x^{2}}{2}}\right|_{1}^{\infty}=e^{-\frac{1}{2}} \)&lt;/span&gt;. זה מוכיח שהאינטגרל חסום ואפשר כמו שאמרתי קודם לכתוב &lt;span&gt;\( I\left(a\right)=\int_{-a}^{a}e^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt; ולבדוק מה יוצא &lt;span&gt;\( \lim_{a\to\infty}I\left(a\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;את &lt;span&gt;\( I\left(a\right)=\int_{-a}^{a}e^{-\frac{x^{2}}{2}}dx \)&lt;/span&gt; אפשר לחשב כמו שראינו עם משפט פוביני, ומקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \int_{-a}^{a}e^{-\frac{x^{2}}{2}}dx=\int_{-a}^{a}\int_{-a}^{a}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אבל עכשיו נוצר לנו סיבוך בשלב החלפת המשתנים. אנחנו עדיין משתמשים באותה החלפה בדיוק:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x=r\cos\theta \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( y=r\sin\theta \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אבל הרעיון בהחלפת משתנים הוא כזכור לקחת אינטגרל שמוגדר על קבוצה אחת &lt;span&gt;\( A \)&lt;/span&gt; ולהגדיר אותו על קבוצה אחרת &lt;span&gt;\( B \)&lt;/span&gt; כך שהחלפת המשתנים מעבירה את &lt;span&gt;\( B \)&lt;/span&gt; &lt;strong&gt;בדיוק&lt;/strong&gt; אל &lt;span&gt;\( A \)&lt;/span&gt;. ואצלנו עכשיו &lt;span&gt;\( A \)&lt;/span&gt; הוא &lt;strong&gt;ריבוע&lt;/strong&gt;, &lt;span&gt;\( A=\left[-a,a\right]\times\left[-a,a\right] \)&lt;/span&gt; בזמן שהחלפת המשתנים מוגדרת על קבוצה &lt;span&gt;\( B=\left[0,t\right]\times\left[0,2\pi\right] \)&lt;/span&gt; (שוב, עד כדי התעלמות מהבעייתיות בנקודה 0) ומעבירה את הקבוצה הזו אל &lt;strong&gt;העיגול &lt;/strong&gt;&lt;span&gt;\( \left\{ \left(r\cos\theta,r\sin\theta\right)\ |\ 0\le\theta\le2\pi,0\le r\le t\right\}  \)&lt;/span&gt; שהרדיוס שלו הוא &lt;span&gt;\( t \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אז מה עושים? שוב חוסמים! העיגול ש&lt;strong&gt;חסום&lt;/strong&gt; בתוך &lt;span&gt;\( A \)&lt;/span&gt; הוא בעל רדיוס &lt;span&gt;\( a \)&lt;/span&gt;, והמעגל &lt;strong&gt;שחוסם&lt;/strong&gt; את &lt;span&gt;\( A \)&lt;/span&gt; הוא בעל רדיוס &lt;span&gt;\( \sqrt{2}a \)&lt;/span&gt; (זה תרגיל נחמד לצייר את הריבע ולהבין למה אלו רדיוסי המעגלים), ומכיוון שהפונקציה חיובית, האינטגרל שלה על &lt;span&gt;\( A \)&lt;/span&gt; יהיה בין האינטגרלים שלה על שני המעגלים הללו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \int_{0}^{a}\left(\int_{0}^{2\pi}re^{-\frac{r^{2}}{2}}d\theta\right)dr\le I\left(a\right)\le\int_{0}^{\sqrt{2}a}\left(\int_{0}^{2\pi}re^{-\frac{r^{2}}{2}}d\theta\right)dr \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואת האינטגרלים הללו כבר ראינו איך לחשב. מכיוון שאין &lt;span&gt;\( \infty \)&lt;/span&gt; מעורב שמאפס את האקספוננט, הם יוצאים פחות “נקיים”, אבל אנחנו כבר שקועים בלכלוך מכאן ועד להודעה חדשה אז למי אכפת? בסופו של חישוב האינטגרל מקבלים &lt;span&gt;\( -2\pi\left.e^{\frac{-r^{2}}{2}}\right|_{0}^{t}=-2\pi\left(e^{-\frac{t^{2}}{2}}-1\right)=2\pi\left(1-e^{-\frac{t^{2}}{2}}\right) \)&lt;/span&gt; ורק נשאר להציב &lt;span&gt;\( t=a,\sqrt{2}a \)&lt;/span&gt; ולקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 2\pi\left(1-e^{-\frac{a^{2}}{2}}\right)\le I\left(a\right)\le2\pi\left(1-e^{-a^{2}}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להשתמש בכלל הסנדוויץ’: &lt;span&gt;\( \lim_{a\to\infty}2\pi\left(1-e^{-\frac{a^{2}}{2}}\right)=2\pi\left(1-e^{-a^{2}}\right)=2\pi \)&lt;/span&gt; ולכן מקבלים &lt;span&gt;\( \lim_{a\to\infty}I\left(a\right)=2\pi \)&lt;/span&gt; בצורה הכי פורמלית בעולם.&lt;/p&gt;

&lt;p&gt;בספרי לימוד של תורת ההסתברות בדרך כלל לא יראו לכם את כל המהומה הזו; יסתפקו בהוכחה שהראיתי בהתחלה, שמדלגת מעל שלבים בצורה קלילה. עכשיו אנחנו כנראה גם מבינים למה - כי אחרי שרואים את זה צריך לנוח, ולכן אני מסיים את הפוסט כאן ולא מדלג בקלילות אל הנושא הבא - כלומר, אל השאלה מה בנוסחה הכללית &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt; התפקיד של אותם &lt;span&gt;\( \sigma \)&lt;/span&gt; ו-&lt;span&gt;\( \mu \)&lt;/span&gt; מזעזעים שמתחבאים בה ואיך אנחנו מקשרים את המקרה הכללי איתם אל מה שראינו כרגע.&lt;/p&gt;</content><author><name></name></author><category term="התפלגות נורמלית" /><summary type="html">מבוא</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/2025/histogram_11.png" /><media:content medium="image" url="http://gadial.net/assets/img/2025/histogram_11.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מה הקטע עם התפלגות נורמלית? (חלק א’: שלוש היסטוגרמות למלכי ההתפלגות במרומם, ועקומה אחת למשול בם ולקשרם)</title><link href="http://gadial.net/2025/01/31/normal_distribution_1/" rel="alternate" type="text/html" title="מה הקטע עם התפלגות נורמלית? (חלק א&apos;: שלוש היסטוגרמות למלכי ההתפלגות במרומם, ועקומה אחת למשול בם ולקשרם)" /><published>2025-01-31T00:00:00+00:00</published><updated>2025-01-31T00:00:00+00:00</updated><id>http://gadial.net/2025/01/31/normal_distribution_1</id><content type="html" xml:base="http://gadial.net/2025/01/31/normal_distribution_1/">&lt;p&gt;סדרת הפוסטים הזו נולדה משאלה קונקרטית ששאלו אותי: למה בנוסחה של &lt;strong&gt;התפלגות נורמלית&lt;/strong&gt; מופיעים &lt;span&gt;\( e \)&lt;/span&gt; ו-&lt;span&gt;\( \pi \)&lt;/span&gt;?&lt;/p&gt;

&lt;p&gt;הנוסחה המדוברת היא &lt;span&gt;\( f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}} \)&lt;/span&gt; מה שנראה &lt;strong&gt;מבעית לגמרי&lt;/strong&gt; במבט ראשון ולכן במקום לענות מייד לשאלה שממנה סדרת הפוסטים נולדה בואו נדבר על דברים בסיסיים יותר: מה זו בכלל התפלגות נורמלית? מה היא באה להשיג? מה הנוסחה הזו מייצגת? מה הולך בה? מה זו בכלל התפלגות? מה זו הסתברות? מהי מתמטיקה?&lt;/p&gt;

&lt;p&gt;אוקיי, על מהי מתמטיקה לא נדבר הפעם, אבל מכיוון שהתפלגות נורמלית היא סוג של הנקודה שבה הנחל של תורת ההסתברות נשפך אל האוקיינוס של המתמטיקה, אולי צריך להתחיל בקטן ולחזור אל המקורות.&lt;/p&gt;

&lt;p&gt;בואו נתחיל הכי בקטן, עם הדבר הבסיסי ביותר בתורת ההסתברות: &lt;strong&gt;הטלת מטבע&lt;/strong&gt;. הטלת מטבע היא אחד מהאמצעים הפשוטים ביותר שבעזרתם אנחנו מכניסים אקראיות לחיים (השני הוא קוביה, שהיא טיפה יותר מסובכת). למטבע יש שני צדדים - “עץ” ו”פלי”, וכשמטילים אותו הוא נוטה ליפול על אחד מהם ולא להישאר עומד בדיוק על קו התפר. ההנחה שלנו היא שהסיכוי שלו ליפול על עץ או על פלי הוא שווה - כלומר, שאם נזרוק את המטבע המון פעמים, בערך בחצי מהן הוא ייצא עץ ובחצי מהן הוא ייצא פלי. לכזו הסתברות קוראים לפעמים “50:50” כשה-50 בא לתאר &lt;strong&gt;אחוזים&lt;/strong&gt;. הרעיון באחוזים הוא שמאה אחוז זה בדיוק משהו שלם, אז חמישים אחוז זה &lt;strong&gt;חצי&lt;/strong&gt;, ואכן אומרים לפעמים גם שההסתברות היא “חצי-חצי”. אפשר להפוך את הטיעון הזה לטיפה יותר מתמטי אם אומרים שעץ הוא 1 ופלי הוא 0 ואז כותבים &lt;span&gt;\( p\left(0\right)=p\left(1\right)=\frac{1}{2} \)&lt;/span&gt; - “ההסתברות ל-0 היא חצי וגם ההסתברות ל-1 היא חצי”.&lt;/p&gt;

&lt;p&gt;הטלה אחת זה נחמד, אבל מה נקבל אם נטיל את המטבע &lt;strong&gt;עשר&lt;/strong&gt; פעמים ונספור כמה פעמים קיבלנו עץ? כאמור, אפשר היה לקוות שבדיוק ב-5 מהפעמים ייצא עץ וב-5 מהפעמים ייצא פלי, וזה באמת יכול לקרות אבל זה לא &lt;strong&gt;חייב&lt;/strong&gt; לקרות. המציאות לא עובדת ככה. ייתכן שהמטבע ייפול על “עץ” בכל הפעמים, אם כי זה לא סביר, וייתכן שהוא ייפול 6 פעמים על עץ ו-4 על פלי. אז כדי לעשות סדר בבלאגן הזה ולחפש ודאות שכן קיימת, אנחנו משחקים את המשחק הזה של “בואו נטיל מטבע 10 פעמים” &lt;strong&gt;הרבה&lt;/strong&gt; פעמים ובודקים מה התוצאות הכי נפוצות. למשל, אני יכול לבקש מהמחשב לשחק את המשחק הזה 10,000 פעמים, ואז לצייר את מה שנקרא &lt;strong&gt;היסטוגרמה&lt;/strong&gt; - איור שבו הנתונים מוצגים בצורה שקל להבין אותם:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_1.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;יש באיור הזה 11 פסים בגבהים שונים. כל פס מתאים למספר בין 0 ל-10: אלו בדיוק מספר הפעמים שבהן עץ יכול להתקבל כשמטילים מטבע עשר פעמים. הגובה של כל פס מתאים למספר המשחקים שבהם הוא יצא: אנחנו רואים שהעמוד של 5 הוא בערך בגובה 2,500, כלומר בערך ב-2,500 מהמשחקים (מתוך 10,000 בסך הכל) קיבלנו באמת 5 פעמים עץ. אז התוצאה 5 היא באמת הכי נפוצה, אבל היא לא לבד. רק ברבע מהמשחקים בערך קיבלנו אותה. בכלל, התמונה הזו היא די &lt;strong&gt;יפה&lt;/strong&gt;. הפסים די סימטרים. אם מסתכלים טוב רואים הפרשים קטנים בגבהים בין פס 4 ו-6 למשל, אבל הם נראים די אותו דבר. הסיבה שזה עבד יפה היא שביקשתי מהמחשב לשחק 10,000 משחקים. כשאני מבקש ממנו רק 100, זה נראה ככה:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;זה כבר שונה לגמרי ונראה די עקום. 4 הרבה יותר גבוה מ-6, ואילו 1 ו-2 הם בדיוק באותו הגובה. לאן נעלמה הסימטריה? ובכן, יש כאן לקח חשוב שמוכר לכל מי שמתעסק בהסתברות - ככל שחוזרים על אותו דבר יותר ויותר פעמים, כך הוא נהיה פחות מבולגן ויותר קל לראות את הסדר שמאחוריו. לכן, אם יש לי ניסוי אקראי כלשהו ואני רוצה לצייר היסטוגרמה יפה של התוצאות האפשריות שלו, כך שהגובה של הפס שמתאים לכל תוצאה גבוה יותר ככל שהיא שכיחה יותר, אני אחזור על אותו הניסוי מספר פעמים גדול - למשל 10,000 - ואבדוק מה &lt;strong&gt;אחוז&lt;/strong&gt; הפעמים שבו כל תוצאה התקבלה. הנה איך ההיסטוגרמה הראשונה נראית כשאני כותב בערכים של ציר &lt;span&gt;\( y \)&lt;/span&gt; את האחוז:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_3.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ההיסטוגרמה הזו משקפת לא רע את הניסוי “מטילים מטבע עשר פעמים וסופרים כמה פעמים קיבלנו עץ”. עכשיו בואו נדבר על ניסוי אחר: אני מנסה לזרוק כדור לסל, וזורק שוב ושוב עד שאני סוף סוף קולע. הבעיה היא שאני גרוע בהשלכת כדורים לסל ולכן מצליח לקלוע רק בהסתברות של 1 ל-10. מה שכן, אני אדם מאוד רגוע ולכן גם אם פספסתי שלושים פעמים ואני לכאורה אמור להיות מעוצבן והידיים שלי אמורות לכאוב, בפועל עדיין יש לי את אותה הסתברות בדיוק לקלוע - 1 ל-10. ועכשיו השאלה היא - מה ההסתברות שאצליח לקלוע על הפעם הראשונה? אחרי שתי פעמים? שלוש? אם מבצעים 10,000 חזרות על הניסוי ומציירים היסטוגרמה, מקבלים:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_4.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;זה נראה מאוד שונה ממה שהיה קודם - ואכן, הגרף הקודם הציג משהו שנקרא &lt;strong&gt;התפלגות בינומית&lt;/strong&gt; והגרף הנוכחי מציג משהו אחר שנקרא &lt;strong&gt;התפלגות גאומטרית&lt;/strong&gt;. אבל בואו ותראו קסם. נניח שאני עושה את המשחק של “לזרוק לסל שוב ושוב עד הפעם הראשונה שבה אני קולע” לא רק לסל אחד, אלא למאה סלים שונים בזה אחר זה, וסופר כמה זמן &lt;strong&gt;בסך הכל&lt;/strong&gt; לקח לי לקלוע לכולם. מה שהאינטואיציה הראשונית שלי אומרת לי הוא שההיסטוגרמה הזו צריכה להיות דומה להיסטוגרמה של התפלגות גאומטרית - הפס הראשון יהיה הכי גבוה כי הוא כמו סכום כל הפסים הגבוהים ב-100 ההיסטוגרמות של כל הסלים בנפרד, והפס הבא יהיה קצת פחות גבוה וכן הלאה. רק שזה לא מה שקורה. מה שקורה הוא זה:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_5.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;זה… קצת מזכיר את הגרף שראינו קודם, של ההתפלגות הבינומית. מה הולך כאן? המספרים שכתובים למטה נראים גבוהים מדי. הרי “1” הוא בהסתברות הכי גבוהה, ואני בסך הכל מאגד 100 היסטוגרמות ביחד. זה לא אמור לצאת קרוב אל 100? ובכן, לא. בלי להיכנס עדיין למונחים הטכניים הרלוונטיים, הערך ה”ממוצע” שאפשר לצפות לו בהתפלגות הגאומטרית של משחק הסלים שלי הוא 10. כי אמנם השטח של הפסים הראשונים נראה גדול ומרשים אבל הוא לא מה שאנחנו מודדים - ה”ממוצע” הוא סכום המכפלות של הגבהים של הפסים בערך המספרי שהם מייצגים. הגובה של הפס של 1 הוא בערך &lt;span&gt;\( \frac{10}{100} \)&lt;/span&gt;? אנחנו כופלים אותו בערך המספרי 1. הגובה של פס 2 הוא בערך &lt;span&gt;\( \frac{9}{100} \)&lt;/span&gt;? אנחנו כופלים אותו ב-2 ומקבלים &lt;span&gt;\( \frac{18}{100} \)&lt;/span&gt;. כך אנחנו עושים לכל ערך אפשרי - כופלים אותו בהסתברות שהוא יתקבל, סוכמים, ומגלים שדווקא ה”זנב” שבכלל לא רואים בהיסטוגרמה תורם חלקים נכבדים לממוצע. אז אם הממוצע הוא 10 למשחק, ויש 100 משחקים, לא מפתיע שהסכום הכולל הוא בסביבות 1000; ככל שמשחקים יותר משחקים כך התוצאות מסתדרות יפה סביב הממוצע.&lt;/p&gt;

&lt;p&gt;בואו נראה עוד דוגמא. נניח שאני מטיל קוביה עם עשר פאות, כלומר מקבל תוצאה בין 1 ל-10, אבל הקוביה הזו היא לא הוגנת אלא מוטה בשלל דרכים שונות ומשונות שהופכות תוצאות מסוימות ליותר נפוצות ותוצאות אחרות לנדירות. הנה היסטוגרמה של 10,000 הטלות של הקוביה הזו:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_6.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;מכאן אפשר לראות ש-8 היא התוצאה הכי נפוצה ואילו 2 ו-7 בקושי מופיעות ובאופן כללי הכל פה נראה כאוטי. מאיפה ההיסטוגרמה הזו הגיעה? ובכן, פשוט הגרלתי באקראי מה יהיו המספרים שמתארים את ההסתברות שבה כל תוצאה מקבלת. אין בקוביה הזו שום דבר מיוחד או קסום בפני עצמו, זה משהו &lt;strong&gt;שרירותי&lt;/strong&gt; לחלוטין.&lt;/p&gt;

&lt;p&gt;עכשיו בואו נטיל את הקוביה הזו מאה פעמים ונחבר את התוצאות ונראה מה קיבלנו. נחזור על הניסוי הזה 10,000 פעם, ונקבל את ההיסטוגרמה:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_7.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;הנה זה שוב. אותו מבנה דמוי פירמידה שכבר ראינו שוב ושוב. הוא הופיע בהתפלגות בינומית; הוא הופיע בהתפלגות גאומטרית; והנה הוא מופיע גם בהתפלגות שרירותית כלשהי. בדיאגרמות של ההתפלגויות המקוריות לא בהכרח ראינו אפילו את הצל שלו, אבל אחרי שמחברים מספיק תוצאות - בום, המבנה הזה צץ.&lt;/p&gt;

&lt;p&gt;המתמטיקאים שמו לב לתופעה הזו כבר לפני מאות שנים, והאבחנה המרכזית שלהם היא שקיימת דרך &lt;strong&gt;פשוטה&lt;/strong&gt; לתאר את המבנה הזה, באמצעות משהו שנקרא &lt;strong&gt;התפלגות נורמלית&lt;/strong&gt;. המילה “נורמלית” כאן מגיעה בדיוק מתוך התופעה עצמה: בגלל שהתופעה המתמטית קיימת, התפלגות נורמלית מופיעה &lt;strong&gt;שוב ושוב&lt;/strong&gt; בשלל מקומות בסטטיסטיקה. למשל, הגבהים של בני האדם מתפלגים נורמלית, וגם תוצאות במבחן מתפלגות נורמלית, וכדומה. כמובן, כשאני אומר שמשהו מתפלג נורמלית אני לא מתכוון שהוא מתאים &lt;strong&gt;בדיוק&lt;/strong&gt; למה שנקרא “התפלגות נורמלית” - גם הגרפים שהצגתי לא מתאימים בדיוק. הרעיון הוא שהתפלגות נורמלית היא &lt;strong&gt;קירוב טוב&lt;/strong&gt; להתפלגויות הללו, ויש לנו מושג טכני מדויק שבא לתאר את ה”קירוב טוב” הזה ומשפט מרכזי בתורת ההסתברות שאומר שהקירוב הטוב הוא באמת טוב - &lt;strong&gt;משפט הגבול המרכזי&lt;/strong&gt;. הניסוח של משפט הגבול המרכזי והוכחה שלו (עד כדי טענת עזר שלא אוכיח) הם המטרה של סדרת הפוסטים הזו.&lt;/p&gt;

&lt;p&gt;לפני שנגיע להגדרות הפורמליות, בואו נראה על מה אני מדבר ב”התפלגות נורמלית” ואיך זה “קירוב”. נתחיל עם ההיסטוגרמה של ההתפלגות הבינומית שראינו בהתחלה:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_8.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;הקו האדום מייצג את ההתפלגות הנורמלית. שימו לב שאני לא מציג אותה בתור פסים כפי שהצגתי את ההתפלגות הבינומית, כי מבחינה מתמטית ההתפלגות הנורמלית היא אכן משהו קצת שונה - היא מיוצגת על ידי פונקציה ממשית &lt;strong&gt;רציפה&lt;/strong&gt;, ואדבר על זה בהמשך. הרעיון הוא עדיין אותו רעיון - באיזור שבו הקו גבוה, יש הסתברות גבוהה יותר לקבל תוצאות שנמצאות באותו איזור.&lt;/p&gt;

&lt;p&gt;עכשיו, הציור הזה נראה טוב. למעשה, הוא נראה טוב &lt;strong&gt;מדי&lt;/strong&gt;. אני צריך להישבע שלא בישלתי אותו בשום צורה כי אפילו אני לא ציפיתי שזה ייצא עד כדי כך טוב בדוגמא האקראית שיצרתי. הקו האדום מצליח איכשהו לעבור דרך הפסים כך שהוא מגיע לגובה של כל פס תוך שהוא עובר כמעט בדיוק דרך נקודת האמצע שלו. עכשיו, אפשר לומר שלא ברור מה מרשים פה - הרי בסך הכל לקחתי את הפסים, מצאתי את נקודות האמצע של כל פס ואת הגובה, זרקתי את כל המידע הזה לסקריפט שלי ואמרתי לו “יאללה, תחשב עקומה” - לא? ובכן, ממש לא. הקוד שצייר את הקו האדום לא ידע &lt;strong&gt;כלום&lt;/strong&gt; על הפסים &lt;strong&gt;וכלום&lt;/strong&gt; על התוצאות ההסתברותיות הקונקרטיות שקיבלתי. הוא ידע רק &lt;strong&gt;שני מספרים&lt;/strong&gt; שמאפיינים את ההתפלגות הבינומית הזו - &lt;strong&gt;התוחלת&lt;/strong&gt; של ההסתברות ו&lt;strong&gt;סטיית התקן&lt;/strong&gt; שלה, ושניהם הם מספרים שלא מחושבים מתוך ההיסטוגרמה עצמה (כלומר, מתוך התוצאות הקונקרטיות שקיבלתי שמתוארות על ידי הפסים) אלא באופן תיאורטי, מתוך התכונות הבסיסיות של ההתפלגות. שני המספרים הממשיים הללו הם כל מה שצריך כדי לקבל עקומה שמקרבת בדיוק מופלא את ההתנהגות של ההתפלגות הבינומית.&lt;/p&gt;

&lt;p&gt;בואו נראה את זה קורה עבור ההתפלגות הגאומטרית:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_9.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;כזכור, מה שאנחנו רואים פה הוא &lt;strong&gt;לא&lt;/strong&gt; גרף שמתאר איך ההתפלגות הגאומטרית נראית (היא לא דומה להתפלגות נורמלית) אלא מה קורה לה אחרי שאני לוקח 100 תוצאות שונות שלה, ומחבר. גם פה, העקומה של התפלגות נורמלית, מרגע שאני מזין לה את שני הפרמטרים המתאימים, ממדלת די במדויק את ההיסטוגרמה. כדי לחשב את שני הפרמטרים המתאימים הייתי צריך לחשב את התוחלת וסטיית התקן של ההתפלגות הגאומטרית, אבל הייתי צריך לשקלל פנימה איכשהו גם את ה-100 הזה; בהמשך כשנגיע לפרטים הטכניים נבין למה צריך לשקלל אותו פנימה, איך זה בדיוק מתבצע ולמה לכאורה קודם בהתפלגות הבינומית לא עשיתי את זה (התשובה היא שכן עשיתי את זה באופן מובלע, כי ההתפלגות הבינומית שלי היא בעצמה סכום של ניסויים &lt;strong&gt;פשוטים יותר&lt;/strong&gt; של הטלות מטבע).&lt;/p&gt;

&lt;p&gt;לסיום, הנה המקרה של ההתפלגות השרירותית לגמרי:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/2025/histogram_10.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;גם פה: אותה עקומה, פרמטרים שונים. לחשב את הפרמטרים מתוך מה שידוע לי על ההתפלגות השרירותית - זה היה קל, וזה גם כל מה שהיה צריך. ההתפלגות השרירותית נותנת משקל שונה לכל מספר מ-1 עד 10; כדי לייצר את העקומה הזו לא היה שום צורך לדעת מה המשקלות הללו. היה צריך לדעת רק את התוחלת, סטיית התקן ומספר התוצאת שחיברנו זו לזו (שגם פה היה 100). זה יפהפה. נראה שהטבע &lt;strong&gt;רוצה&lt;/strong&gt; שיהיה סדר באי סדר; שהאקראיות תתגשם בסופו של דבר, כשאנחנו מסתכלים על סיטואציות שמורכבות מהרבה תהליכים אקראיים שכל אחד תורם את חלקו, בתור פונקציה פשוטה מאוד.&lt;/p&gt;

&lt;p&gt;אז הבנו שיש פה איזו שהיא תופעת טבע; בפוסט הבא נעסוק בצורה שבה אנחנו מפרמלים את המודל המתמטי שמנסה לתאר את הסיטואציה הזו.&lt;/p&gt;</content><author><name></name></author><category term="התפלגות נורמלית" /><summary type="html">סדרת הפוסטים הזו נולדה משאלה קונקרטית ששאלו אותי: למה בנוסחה של התפלגות נורמלית מופיעים \( e \) ו-\( \pi \)?</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/2025/histogram_8.png" /><media:content medium="image" url="http://gadial.net/assets/img/2025/histogram_8.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">מספרי ברנולי</title><link href="http://gadial.net/2024/12/18/bernoulli_numbers/" rel="alternate" type="text/html" title="מספרי ברנולי" /><published>2024-12-18T00:00:00+00:00</published><updated>2024-12-18T00:00:00+00:00</updated><id>http://gadial.net/2024/12/18/bernoulli_numbers</id><content type="html" xml:base="http://gadial.net/2024/12/18/bernoulli_numbers/">&lt;h2&gt;בואו נסכום סכומים&lt;/h2&gt;

&lt;p&gt;אחד מהדברים הבאמת נחמדים שלמדתי במתמטיקה בתיכון היה הנוסחה לסכום של סדרה חשבונית, שבמקרה הפשוט ביותר שלה הוא הסכום הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1+2+3+\ldots+n=\frac{n\left(n+1\right)}{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;סביב הסכום הזה יש את הצ’יזבט האהוב על המתמטיקאי קרל פרידריך גאוס, שלכאורה גילה אותו בתור ילד קטן שהמורה בבית הספר נתן לו וליתר התלמידים לסכום את המספרים מ-1 עד 100 כדי להעסיק אותם בזמן שהוא נח. גאוס הילד היה נאמן לסלוגן על כך שמתמטיקאים הם עצלנים: במקום לחבר את הכל במפורש, הוא שם לב לכך ש-1 ועוד 100 שווה 101, וגם 2 ועוד 99 שווה 101 וכן הלאה, כך שיש לו 50 זוגות מספרים שהסכום של כולם הוא 101 ורק צריך לחשב את הכפל הקל 50 כפול 101 ואת זה אפילו אני יודע לעשות בראש ולקבל 5050. הנוסחה שכתבתי למעלה היא אותו דבר: יש לנו &lt;span&gt;\( \frac{n}{2} \)&lt;/span&gt; זוגות שהסכום של כולם הוא &lt;span&gt;\( n+1 \)&lt;/span&gt;, אז אנחנו פשוט כופלים (אם &lt;span&gt;\( n \)&lt;/span&gt; אי זוגי יש איבר בודד באמצע שאי אפשר למצוא לו בן זוג, אבל הנוסחה עדיין עובדת כי היא סופרת אותו בתור “חצי זוג” - נסו בעצמכם לבדוק על מספרים קטנים!)&lt;/p&gt;

&lt;p&gt;מה שלא שמעתי עליו בבית הספר, וקצת חבל, הוא שיש לנו נוסחה דומה גם עבור הסכום של &lt;strong&gt;הריבועים&lt;/strong&gt; של הטבעיים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1^{2}+2^{2}+3^{2}+4^{2}+\ldots+n^{2}=\frac{n\left(n+1\right)\left(2n+1\right)}{6} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הנוסחה הזו פחות פשוטה מהקודמת, אבל היא עדיין די פשוטה ומערבת רק מכפלה של שלושה מספרים. זה מעלה את השאלה אם גם כשאני מחבר חזקות גבוהות יותר של הטבעיים, אני עדיין אקבל נוסחה פשוטה יחסית. מה למשל קורה עם &lt;span&gt;\( 1^{3}+2^{3}+3^{3}+\ldots \)&lt;/span&gt;? התשובה היא שאכן, יש נוסחה פשוטה יחסית למקרה הזה ובעצם לכל מקרה של &lt;span&gt;\( 1^{m}+2^{m}+3^{m}+\ldots+n^{m} \)&lt;/span&gt;, אם כי “פשוטה” זה כמובן עניין יחסי כי ככל ש-&lt;span&gt;\( m \)&lt;/span&gt; גדול יותר הנוסחה תהיה מסובכת יותר. אבל מה שאפשר לומר שהופך את העניין לפשוט הוא שני דברים:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;הנוסחה היא תמיד &lt;strong&gt;פולינום&lt;/strong&gt; ממעלה &lt;span&gt;\( m+1 \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;אפשר לכתוב את הנוסחה באופן כללי, לכל &lt;span&gt;\( m \)&lt;/span&gt; שהוא, בעזרת משהו שנקרא &lt;strong&gt;מספרי ברנולי.&lt;/strong&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;קודם כל - מה זה “פולינום”? יהיה קל להסביר את זה אם ניקח את הנוסחה &lt;span&gt;\( \frac{n\left(n+1\right)}{2} \)&lt;/span&gt; ונפתח את הסוגריים. נקבל, על פי כללי החשבון הרגילים, &lt;span&gt;\( \frac{1}{2}n^{2}+\frac{1}{2}n \)&lt;/span&gt;. באופן דומה אם נפתח את &lt;span&gt;\( \frac{n\left(n+1\right)\left(2n+1\right)}{6} \)&lt;/span&gt; נקבל &lt;span&gt;\( \frac{1}{3}n^{3}+\frac{1}{2}n^{2}+\frac{1}{6}n \)&lt;/span&gt;. ביטוי כזה נקרא &lt;strong&gt;פולינום&lt;/strong&gt;: זה ביטוי שכולל &lt;strong&gt;משתנה&lt;/strong&gt;, במקרה שלנו &lt;span&gt;\( n \)&lt;/span&gt;, שהרעיון בו הוא שהוא לא מייצג מספר קונקרטי (אבל אפשר &lt;strong&gt;להציב&lt;/strong&gt; בו מספרים קונקרטיים ולראות מה קורה) ואנחנו מסתכלים גם על חזקות שלו, כמו למשל &lt;span&gt;\( n^{2} \)&lt;/span&gt; או &lt;span&gt;\( n^{3} \)&lt;/span&gt;, ועל מכפלות של כל אלו במספרים, ועל סכומים של כל זה. בביטוי כמו &lt;span&gt;\( \frac{1}{3}n^{3}+\frac{1}{2}n^{2}+\frac{1}{6}n \)&lt;/span&gt; אני אומר שה-&lt;span&gt;\( \frac{1}{3} \)&lt;/span&gt; שבו מוכפל &lt;span&gt;\( n^{3} \)&lt;/span&gt; הוא &lt;strong&gt;המקדם&lt;/strong&gt; של &lt;span&gt;\( n^{3} \)&lt;/span&gt; (ולכן &lt;span&gt;\( \frac{1}{6} \)&lt;/span&gt; הוא המקדם של &lt;span&gt;\( n \)&lt;/span&gt; וכדומה). באופן כללי יכול להופיע בפולינום גם מספר שלא מוכפל ב-&lt;span&gt;\( n \)&lt;/span&gt; ואז הוא נקרא &lt;strong&gt;המקדם החופשי&lt;/strong&gt; אבל אפשר לחשוב עליו כאילו הוא מוכפל ב-&lt;span&gt;\( n^{0} \)&lt;/span&gt; (&lt;a href=&quot;https://gadial.net/2018/01/01/zero_power_equals_one/&quot;&gt;הנה פוסט&lt;/a&gt; על למה דברים בחזקת 0 נחשבים 1) אם כי בהקשר שלנו מקדם חופשי כזה פשוט לא הולך להופיע. בנוסף, &lt;strong&gt;המעלה&lt;/strong&gt; של פולינום היא החזקה הגבוהה ביותר שמופיעה בו, כלומר לדוגמא, המעלה של &lt;span&gt;\( \frac{1}{3}n^{3}+\frac{1}{2}n^{2}+\frac{1}{6}n \)&lt;/span&gt; היא 3.&lt;/p&gt;

&lt;p&gt;פולינומים הם באמת ובתמים פונקציות פשוטות מאוד. אם מציבים ערך בפולינום, החישוב רק דורש לחשב חזקות של הערך, לכפול אותן במקדמים, ולחבר. אם אני מצליח לתרגם את החיבור של המספרים &lt;span&gt;\( 1^{10}+2^{10}+3^{10}+\ldots+1000^{10} \)&lt;/span&gt; לחישוב של הצבה של 1000 בפולינום ממעלה 11, המרתי את הבעיה של חישוב 1000 חזקות עשיריות של מספרים וחיבור של כולן, לבעיה של חישוב 11 חזקות שונות של אותו מספר (וכשהמספר הזה הוא 1,000 זה לא בדיוק החלק הקשה פה) ואז כפל של 11 החזקות הללו במקדמים וחיבור שלהן - משמעותית פחות עבודה. זה הוביל את יעקב ברנולי, שגילה את הנוסחה הכללית (ולא אכנס כאן לדיון ההיסטורי של מי בדיוק גילה מה ובאיזה נוסח למרות שיש דיון כזה) לכתוב בהתלהבות ביומן שלו שבעזרת הנוסחה לקחה לו פחות מרבע שעה כדי לחשב את סכום החזקות העשיריות של המספרים עד 1000 ולקבל שיצא &lt;span&gt;\( 91,409,924,241,424,243,424,241,924,242,500 \)&lt;/span&gt;. גם ברנולי היה נאמן לסלוגן “מתמטיקאים הם עצלנים”, בדרך המאוד מוזרה שבה העצלנות הזו מתבטאת בפועל.&lt;/p&gt;

&lt;p&gt;בהמשך אני אראה איך מגיעים לנוסחה ומוכיחים אותה, אבל מכיוון שזה ידרוש מתמטיקה טיפה לא טריוויאלית בואו נתחיל קודם מתיאור של הנוסחה עצמה. בשביל לתאר אותה צריך להגדיר את מספרי ברנולי, ובשבילם צריך קצת קונבנציות מתמטיות.&lt;/p&gt;

&lt;p&gt;ראשית, יש את הסימון המוסכם לסכימה. למשל, במקום לכתוב &lt;span&gt;\( 1^{m}+2^{m}+3^{m}+\ldots+n^{m} \)&lt;/span&gt; אני כותב &lt;span&gt;\( \sum_{k=1}^{n}k^{m} \)&lt;/span&gt;. כאן הסימן &lt;span&gt;\( \Sigma \)&lt;/span&gt; אומר שיש לי תיאור של סכום, ה-&lt;span&gt;\( k^{m} \)&lt;/span&gt; שליד ה-&lt;span&gt;\( \Sigma \)&lt;/span&gt; הוא “האיבר הכללי” של הסכום - כלומר, הצורה שיש לכל איבר בסכום. ה-&lt;span&gt;\( k=1 \)&lt;/span&gt; למטה גם אומר שמשתנה הסכימה הוא &lt;span&gt;\( k \)&lt;/span&gt;, מה שאומר שבביטוי &lt;span&gt;\( k^{m} \)&lt;/span&gt; אני מציב ערכים ב-&lt;span&gt;\( k \)&lt;/span&gt; אבל משאיר את &lt;span&gt;\( m \)&lt;/span&gt; כמות שהוא, וגם שהערך של &lt;span&gt;\( k \)&lt;/span&gt; הזה מתחיל מ-1. ה-&lt;span&gt;\( n \)&lt;/span&gt; למעלה אומר שהערך הגדול ביותר ש-&lt;span&gt;\( k \)&lt;/span&gt; מגיע אליו הוא &lt;span&gt;\( n \)&lt;/span&gt;, והקונבנציה הלא כתובה היא שמגדילים בכל פעם את הערך של &lt;span&gt;\( k \)&lt;/span&gt; ב-1. לכן &lt;span&gt;\( \sum_{k=1}^{n}k^{m}=1^{m}+2^{m}+3^{m}+\ldots+n^{m} \)&lt;/span&gt;. למרות שסימון הסכימה הזה נראה קצת מרתיע בהתחלה הוא הרבה יותר קומפקטי וברור אחרי שמתרגלים אליו.&lt;/p&gt;

&lt;p&gt;שנית, אנחנו הולכים לראות מספרים מהצורה &lt;span&gt;\( {a \choose b} \)&lt;/span&gt;. הסימון הזה, שנקרא &lt;strong&gt;מקדם הבינום&lt;/strong&gt; (אסביר בהמשך למה) מוגדר באופן הבא. ראשית, מגדירים &lt;strong&gt;עצרת&lt;/strong&gt; של מספר טבעי, שמסומנת בתור המספר עם סימן קריאה אחריו: &lt;span&gt;\( a!=1\cdot2\cdot3\cdots a \)&lt;/span&gt;, כלומר מכפלת כל המספרים הטבעיים מ-1 עד &lt;span&gt;\( a \)&lt;/span&gt; (למשל &lt;span&gt;\( 4!=1\cdot2\cdot3\cdot4=24 \)&lt;/span&gt;) ובנוסף ההגדרה המפורשת &lt;span&gt;\( 0!=1 \)&lt;/span&gt;. שנית, &lt;span&gt;\( {a \choose b}=\frac{a!}{b!\left(a-b!\right)} \)&lt;/span&gt; והביטוי הזה מוגדר כאשר &lt;span&gt;\( 0\le b\le a \)&lt;/span&gt;. יש הגיון מאחורי הביטוי הזה, לא סתם החלטנו להמציא אותו: &lt;span&gt;\( {a \choose b} \)&lt;/span&gt; סופר את מספר הדרכים שבהן אפשר לבחור &lt;span&gt;\( b \)&lt;/span&gt; איברים מתוך &lt;span&gt;\( a \)&lt;/span&gt; איברים, במקרה שבו אין חשיבות לסדר שבו הבחירה הזו מתבצעת. (אני מתאר את זה &lt;a href=&quot;https://gadial.net/2010/06/20/combinatorics_intro/&quot;&gt;כאן&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;לבסוף, בנוסחה שאני הולך להציג יופיעו &lt;strong&gt;מספרי ברנולי&lt;/strong&gt; שמסומנים ב-&lt;span&gt;\( B_{0},B_{1},B_{2},\ldots \)&lt;/span&gt; והם יהיו המושג המרכזי בפוסט.&lt;/p&gt;

&lt;p&gt;אני אגלה כבר עכשיו שמספרי ברנולי הראשונים הם &lt;span&gt;\( B_{0}=1,B_{1}=-\frac{1}{2},B_{2}=\frac{1}{6},B_{3}=0 \)&lt;/span&gt; ואת ההגדרה הכללית שלהם אביא עוד מעט, אבל קודם אני רוצה להראות איך הם נותנים לנו את הנוסחה לסכום החזקות. אלא שכאן יש סיבוך קטן. אמרתי ש-&lt;span&gt;\( B_{1}=-\frac{1}{2} \)&lt;/span&gt;, אבל יש גם כאלו שמעדיפים להגדיר &lt;span&gt;\( B_{1}=\frac{1}{2} \)&lt;/span&gt;. שתי הקונבנציות סבירות, אבל אני בפוסט הזה הולך להשתמש בקונבנציה ש-&lt;span&gt;\( B_{1}=-\frac{1}{2} \)&lt;/span&gt; וזה טיפה משפיע על הנוסחה: במקום להסתכל על &lt;span&gt;\( \sum_{k=1}^{n}k^{m} \)&lt;/span&gt; אני מסתכל על &lt;span&gt;\( \sum_{k=1}^{n-1}k^{m} \)&lt;/span&gt;, כלומר על הסכום &lt;span&gt;\( 1^{m}+2^{m}+\ldots+\left(n-1\right)^{m} \)&lt;/span&gt;. את הסכום הזה אני אסמן ב-&lt;span&gt;\( S_{m}\left(n\right) \)&lt;/span&gt;. כמובן שזה לא שינוי גדול במיוחד; אם ניקח את הנוסחה &lt;span&gt;\( \frac{n\left(n+1\right)}{2} \)&lt;/span&gt; שראינו קודם ונחליף את &lt;span&gt;\( n \)&lt;/span&gt; ב-&lt;span&gt;\( n-1 \)&lt;/span&gt; נקבל &lt;span&gt;\( S_{1}\left(n\right)=\frac{n\left(n-1\right)}{2}=\frac{1}{2}n^{2}-\frac{1}{2}n \)&lt;/span&gt;. באופן דומה אם ניקח את &lt;span&gt;\( \frac{n\left(n+1\right)\left(2n+1\right)}{6} \)&lt;/span&gt; ונחליף את &lt;span&gt;\( n \)&lt;/span&gt; ב-&lt;span&gt;\( n-1 \)&lt;/span&gt; נקבל &lt;span&gt;\( S_{2}\left(n\right)=\frac{n\left(n-1\right)\left(2n-1\right)}{6}=\frac{1}{3}n^{3}-\frac{1}{2}n^{2}+\frac{1}{6}n \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו אפשר להציג את הנוסחה הכללית&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( S_{m}\left(n\right)=\frac{1}{m+1}\sum_{k=0}^{m}{m+1 \choose k}B_{k}n^{m+1-k} \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;בואו נראה איך היא נותנת את הסכומים שכבר ראינו. ראשית, עבור &lt;span&gt;\( 1+2+3+\ldots+n-1 \)&lt;/span&gt;, זה הסכום &lt;span&gt;\( \sum_{k=1}^{n-1}k^{1} \)&lt;/span&gt;, כלומר &lt;span&gt;\( m=1 \)&lt;/span&gt;. לכן כשמשתמשים בנוסחה הכללית שראינו, מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S_{1}\left(n\right)=\frac{1}{2}\left[{2 \choose 0}B_{0}n^{2}+{2 \choose 1}B_{1}n^{1}\right]=\frac{1}{2}\left[n^{2}+2\cdot\left(-\frac{1}{2}\right)n\right]=\frac{1}{2}n^{2}-\frac{1}{2}n \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובאופן דומה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S_{2}\left(n\right)=\frac{1}{3}\left[{3 \choose 0}B_{0}n^{3}+{3 \choose 1}B_{1}n^{2}+{3 \choose 2}B_{2}n\right]=\frac{1}{3}\left[n^{3}-\frac{3}{2}n^{2}+\frac{3}{6}n\right]=\frac{1}{3}n^{3}-\frac{1}{2}n^{2}+\frac{1}{6}n \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לי הנוסחה הכללית נראית טיפה מפחידה, אבל כשאני מקליד את המקרים המפורשים החוקיות “מרגישה” לי הרבה יותר פשוטה - בעצם אין בנוסחאות הללו כמעט שום דבר מסובך, חוץ ממספרי ברנולי עצמם - הם ה”לב” של הסיבוך כאן. אז איך מגדירים אותם? ולמה זה עובד? אני פשוט אציג את ההגדרה כאן, ובהמשך נגיע אל ההוכחה שגם תסביר לנו מאיפה ההגדרה בעצם צצה.&lt;/p&gt;

&lt;p&gt;ההגדרה היא &lt;strong&gt;רקורסיבית&lt;/strong&gt;: אני מניח שכבר הגדרתי את כל המספרים &lt;span&gt;\( B_{0},B_{1},B_{2},\ldots,B_{k-1} \)&lt;/span&gt; ומגדיר באמצעותם את &lt;span&gt;\( B_{k} \)&lt;/span&gt;, בצורה הבאה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B_{k}=-\frac{1}{k+1}\sum_{i=0}^{k-1}{k+1 \choose i}B_{i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עם מקרה הבסיס &lt;span&gt;\( B_{0}=1 \)&lt;/span&gt;. גם פה, הרבה יותר קל “להרגיש” את ההגדרה כשכותבים כמה מקרים ידנית:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B_{1}=-\frac{1}{2}{2 \choose 0}B_{0}=-\frac{1}{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B_{2}=-\frac{1}{3}\left[{3 \choose 0}B_{0}+{3 \choose 1}B_{1}\right]=-\frac{1}{3}\left[1-\frac{3}{2}\right]=-\frac{1}{3}\left(-\frac{1}{2}\right)=\frac{1}{6} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ואם ממשיכים בחישובים, מקבלים את הסדרה הבאה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1,-\frac{1}{2},\frac{1}{6},0,-\frac{1}{30},0,\frac{1}{42},0,-\frac{1}{30},0,\frac{5}{66},0,-\frac{691}{2730},\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בדרך כלל ה-&lt;span&gt;\( -\frac{691}{2730} \)&lt;/span&gt; הוא זה שבו מרימים ידיים בייאוש ושואלים “אתם צוחקים עלינו?!”. עד לשם, אפשר לראות ניצוצות של חוקיות סבירה - כל המספרים במקומות האי זוגיים למעט &lt;span&gt;\( B_{1} \)&lt;/span&gt; הם 0; המספרים האחרים מחליפים סימן בין מינוס לפלוס; במכנה מופיעים מספרים סבירים יחסית כולל 42 יקיר המין האנושי; אבל אז מגיע &lt;span&gt;\( -\frac{691}{2730} \)&lt;/span&gt; שכולל מונה ומכנה שאין לאף אחד שמץ של מושג מה הם רוצים מחיינו, והורס כל תקווה לאיזו נוסחה פשוטה יחסית, יותר מנוסחת הנסיגה שיש לנו (יש גם נוסחאות סגורות שכוללות סכימה ואני לא חושב שאפשר לומר שהן פשוטות יותר).&lt;/p&gt;

&lt;p&gt;אוקיי, אז זה מה שעושים עם זה, בואו נוכיח שזה עובד.&lt;/p&gt;

&lt;h2&gt;בואו נביים בינומים&lt;/h2&gt;

&lt;p&gt;לפני שאני מגיע להוכחה האמיתית, שמשתמשת בכלי אלגנטי ויפה אבל לא טריוויאלי להבנה, הנה גישה קצת יותר בסיסית לנושא שכל אחד יכול להבין. בינתיים אני לא אנסה להוכיח את הנוסחה שראינו למעלה אלא משהו צנוע יותר - להוכיח ש-&lt;span&gt;\( S_{m}\left(n\right) \)&lt;/span&gt; הוא פולינום ממעלה &lt;span&gt;\( m+1 \)&lt;/span&gt; ולהראות איך למצוא אותו. בשביל זה אני קודם כל הולך להשתמש במשהו שנקרא &lt;strong&gt;הבינום של ניוטון&lt;/strong&gt; (יש לי עליו &lt;a href=&quot;https://gadial.net/2010/06/22/newton_binom/&quot;&gt;פוסט&lt;/a&gt;) שאומר באופן כללי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a+b\right)^{n}=\sum_{i=0}^{n}{n \choose i}a^{i}b^{n-i} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם במקום &lt;span&gt;\( b \)&lt;/span&gt; יש לי 1 זה נהיה משמעותית פשוט יותר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a+1\right)^{n}=\sum_{i=0}^{n}{n \choose i}a^{i}=1+{n \choose 1}a+{n \choose 2}a^{2}+\ldots+{n \choose n-1}a^{n-1}+a^{n} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו נשתמש בזה עבור &lt;span&gt;\( a=k \)&lt;/span&gt; ו-&lt;span&gt;\( n=m+1 \)&lt;/span&gt; ונקבל את הדבר הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(k+1\right)^{m+1}-k^{m+1}=1+{m+1 \choose 1}k+{m+1 \choose 2}k^{2}+\ldots+{m+1 \choose m}k^{m} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שנחמד בביטוי &lt;span&gt;\( \left(k+1\right)^{m+1}-k^{m+1} \)&lt;/span&gt; הוא שהוא יוצר לנו &lt;strong&gt;טור טלסקופי&lt;/strong&gt;, כלומר טור שבו כל האיברים מבטלים זה את זה חוץ מהראשון והאחרון. כדי לראות את זה, בואו נחבר את כל הביטויים הללו עבור &lt;span&gt;\( k=0,1,2,\ldots,n-1 \)&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[n^{m+1}-\left(n-1\right)^{m+1}\right]+\left[\left(n-1\right)^{m+1}-\left(n-2\right)^{m+1}\right]+\ldots+\left[2^{m+1}-1^{m+1}\right]+\left[1^{m+1}-0^{m+1}\right]=n^{m+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אז אם אנחנו מחברים את אגף &lt;strong&gt;שמאל&lt;/strong&gt; של הביטוי&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(k+1\right)^{m+1}-k^{m+1}=1+{m+1 \choose 1}k+{m+1 \choose 2}k^{2}+\ldots+{m+1 \choose m}k^{m} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;לכל &lt;span&gt;\( k=0,1,2,\ldots,n-1 \)&lt;/span&gt; אנחנו מקבלים &lt;span&gt;\( n^{m+1} \)&lt;/span&gt;. מה קורה כשאנחנו מחברים את אגף &lt;strong&gt;ימין&lt;/strong&gt;? אפשר להסתכל על כל מחובר לבד. המחובר &lt;span&gt;\( 1 \)&lt;/span&gt; יחובר לעצמו &lt;span&gt;\( n \)&lt;/span&gt; פעמים ויהפוך ל-&lt;span&gt;\( n \)&lt;/span&gt;; המחובר &lt;span&gt;\( {m+1 \choose 1}k \)&lt;/span&gt; הופך לטור &lt;span&gt;\( {m+1 \choose 1}\left(1+2+\ldots+n-1\right)={m+1 \choose 1}S_{1}\left(n\right) \)&lt;/span&gt;. המחובר &lt;span&gt;\( {m+1 \choose 2}k^{2} \)&lt;/span&gt; הופך לטור &lt;span&gt;\( {m+1 \choose 2}S_{2}\left(n\right) \)&lt;/span&gt; וכן הלאה. אז אנחנו מקבלים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( n^{m+1}=n+{m+1 \choose 1}S_{1}\left(n\right)+{m+1 \choose 2}S_{2}\left(n\right)+\ldots+{m+1 \choose m}S_{m}\left(n\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו נוסחה די מרהיבה כי היא מקשרת את כל הנוסחאות לסכומים עד לחזקה ה-&lt;span&gt;\( m \)&lt;/span&gt;-ית. אפשר לבודד את &lt;span&gt;\( S_{m}\left(n\right) \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S_{m}\left(n\right)=\frac{1}{m+1}\left[n^{m+1}-{m+1 \choose m-1}S_{m-1}\left(n\right)-\ldots-{m+1 \choose 1}S_{1}\left(n\right)-n\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אם אנחנו כבר יודעים, אינדוקטיבית, שכל &lt;span&gt;\( S_{k}\left(n\right) \)&lt;/span&gt; כזה הוא ממעלה לכל היותר &lt;span&gt;\( k+1 \)&lt;/span&gt; המסקנה היא שהביטוי באגף ימין הוא פולינום ממעלה &lt;span&gt;\( m+1 \)&lt;/span&gt; (בגלל ה-&lt;span&gt;\( n^{m+1} \)&lt;/span&gt; שמופיע שם והעובדה שכל ה-&lt;span&gt;\( S_{k}\left(n\right) \)&lt;/span&gt;-ים הם ממעלה קטנה יותר). הנוסחה הזו גם פותחת פתח לבניה רקורסיבית של ה-&lt;span&gt;\( B_{m} \)&lt;/span&gt;-ים ויש ספרים שנוקטים בגישה הזו (למשל Concrete Mathematics של קנות’ ושות’) אבל זה טכני לא כיף. אני רוצה טכני כיף.&lt;/p&gt;

&lt;h2&gt;בואו טכני כיף&lt;/h2&gt;

&lt;p&gt;הכלי הטכני שאני משתמש בו נקרא &lt;strong&gt;פונקציות יוצרות&lt;/strong&gt;. הרעיון בפונקציות יוצרות הוא זה: אם יש לנו סדרה, אפשר “לשתול” את האיברים שלה בתור מקדמים של טור חזקות, ואז לבצע מניפולציות על הפונקציה שטור החזקות הזה מתאר והמניפולציות הללו יתורגמו למניפולציות בסדרות ש”שתלנו”.&lt;/p&gt;

&lt;p&gt;זה לא נושא קל לעיכול (&lt;a href=&quot;https://gadial.net/2011/08/07/generating_functions_hardcore_1/&quot;&gt;יש לי פוסט&lt;/a&gt; עליו) אבל חלק מהקושי בו, לטעמי, הוא שקשה להבין אותו בלי לראות דוגמאות קונקרטיות לשימושים שלו - וכאלו שבאמת מפשטים דברים. עכשיו יש לנו הזדמנות לראות דבר כזה.&lt;/p&gt;

&lt;p&gt;הנה מבוא קצרצר לפונקציות יוצרות: בהינתן סדרת מספרים &lt;span&gt;\( a_{0},a_{1},a_{2},\ldots \)&lt;/span&gt; &lt;strong&gt;הפונקציה היוצרת&lt;/strong&gt; שלה היא הטור &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}x^{n} \)&lt;/span&gt;. צריך להבהיר כבר עכשיו נקודה קריטית - הטור הזה הוא &lt;strong&gt;אובייקט פורמלי&lt;/strong&gt;, כמו פולינום. הוא לא פונקציה. לא מציבים ב-&lt;span&gt;\( x \)&lt;/span&gt; ערכים (&lt;strong&gt;אפשר&lt;/strong&gt; להציב ב-&lt;span&gt;\( x \)&lt;/span&gt; ערכים כחלק מניתוח מתקדם יותר של מה שהפונקציה היוצרת מייצגת, אבל לא &lt;strong&gt;חייבים&lt;/strong&gt; לעשות את זה). המשמעות של זה היא שאפשר לכתוב משהו כמו &lt;span&gt;\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)&lt;/span&gt; וזה יהיה שוויון תקין, שלא תלוי בסייגים כמו לומר ש-&lt;span&gt;\( \left|x\right|&amp;lt;1 \)&lt;/span&gt; או משהו.&lt;/p&gt;

&lt;p&gt;איך זה עובד? האובייקט הבסיסי הוא כאמור הטור עצמו. על האובייקט הזה מגדירים פעולות חיבור וכפל שהופכות אותו לחוג:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}x^{n}+\sum_{n=0}^{\infty}b_{n}x^{n}=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt; עם &lt;span&gt;\( c_{n}=a_{n}+b_{n} \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;&lt;span&gt;\( \left(\sum_{n=0}^{\infty}a_{n}x^{n}\right)\left(\sum_{n=0}^{\infty}b_{n}x^{n}\right)=\sum_{n=0}^{\infty}c_{n}x^{n} \)&lt;/span&gt; עם &lt;span&gt;\( c_{n}=\sum_{k=0}^{n}a_{n-k}b_{k} \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;הדוגמא הקלאסית לכפל היא &lt;span&gt;\( \left(1+x+x^{2}+\ldots\right)\left(1-x\right)=1 \)&lt;/span&gt; (נסו לבצע את החישוב בעצמכם!) שהיא זו שמצדיקה את הכתיב &lt;span&gt;\( 1+x+x^{2}+\ldots=\left(1-x\right)^{-1} \)&lt;/span&gt; או, בכתיב הנפוץ יותר, &lt;span&gt;\( 1+x+x^{2}+\ldots=\frac{1}{1-x} \)&lt;/span&gt;. אני בכוונה לא נכנס יותר מדי לפרטים כי כאמור, יש לי פוסט על זה.&lt;/p&gt;

&lt;p&gt;דבר אחד שאין בפוסט וכן נשתמש בו כאן הוא &lt;strong&gt;פונקציות יוצרות אקספוננציאליות&lt;/strong&gt;. הפונקציה היוצרת האקספוננציאלית של &lt;span&gt;\( \left\{ a_{n}\right\} _{n=0}^{\infty} \)&lt;/span&gt; היא &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!} \)&lt;/span&gt;. זה עדיין ביטוי פורמלי וההגדרות למעלה עדיין תקפות לגביו, אבל בואו נראה מה קורה לפעולות החיבור והכפל. עבור חיבור עדיין נקבל &lt;span&gt;\( \sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!}+\sum_{n=0}^{\infty}b_{n}\frac{x^{n}}{n!}=\sum_{n=0}^{\infty}c_{n}\frac{x^{n}}{n!} \)&lt;/span&gt; עם &lt;span&gt;\( c_{n}=a_{n}+b_{n} \)&lt;/span&gt;, כלומר פעולת החיבור של פונקציות יוצרות של שתי סדרות מניבה את הפונקציה היוצרת של סדרת הסכומים. כפל, לעומת זאת, הוא קצת יותר טריקי.&lt;/p&gt;

&lt;p&gt;מה שאנחנו רוצים לעשות הוא, בהינתן הסדרות &lt;span&gt;\( a_{n},b_{n} \)&lt;/span&gt;, להבין מה הסדרה &lt;span&gt;\( c_{n} \)&lt;/span&gt; שעבורה תתקיים המשוואה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(\sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!}\right)\left(\sum_{n=0}^{\infty}b_{n}\frac{x^{n}}{n!}\right)=\sum_{n=0}^{\infty}c_{n}\frac{x^{n}}{n!} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כדי להבין למה זה טריקי, בואו נראה מה קורה עבור &lt;span&gt;\( x^{2} \)&lt;/span&gt;: אנחנו רוצים שהמכפלה תיתן את המקדם &lt;span&gt;\( \frac{c_{2}}{2!} \)&lt;/span&gt;. עכשיו, אם מסתכלים על &lt;span&gt;\( \left(a_{0}+a_{1}x+\frac{a_{2}}{2!}x^{2}\right)\left(b_{0}+b_{1}x+\frac{b_{2}}{2!}x^{2}\right) \)&lt;/span&gt; ופותחים סוגריים ומקבצים לפי החזקה של &lt;span&gt;\( x \)&lt;/span&gt;, מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(\frac{a_{2}}{2}b_{0}+a_{1}b_{1}+a_{0}\frac{b_{2}}{2}\right)x^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אנחנו רוצים להוציא החוצה את ה-&lt;span&gt;\( \frac{1}{2!} \)&lt;/span&gt; ולכן נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(a_{2}b_{0}+2a_{1}b_{1}+a_{0}b_{2}\right)\frac{x^{2}}{2!} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה קורה באופן כללי? המקדם של &lt;span&gt;\( x^{n} \)&lt;/span&gt; יהיה &lt;span&gt;\( \sum_{k=0}^{n}\frac{a_{k}}{k!}\frac{b_{n-k}}{\left(n-k\right)!} \)&lt;/span&gt;. עכשיו, זכרו את הבינום של ניוטון: &lt;span&gt;\( {n \choose k}=\frac{n!}{k!\left(n-k\right)!} \)&lt;/span&gt;. לכן, אם נכפול ונחלק את הסכום ב-&lt;span&gt;\( n! \)&lt;/span&gt;, נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{k=0}^{n}\frac{a_{k}}{k!}\frac{b_{n-k}}{\left(n-k\right)!}=\frac{1}{n!}\sum_{k=0}^{n}{n \choose k}a_{k}b_{n-k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, את נוסחת הכפל צריך לתקן באופן הבא:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;span&gt;\( \left(\sum_{n=0}^{\infty}a_{n}\frac{x^{n}}{n!}\right)\left(\sum_{n=0}^{\infty}b_{n}\frac{x^{n}}{n!}\right)=\sum_{n=0}^{\infty}c_{n}\frac{x^{n}}{n!} \)&lt;/span&gt; עם &lt;span&gt;\( c_{n}=\sum_{k=0}^{n}{n \choose k}a_{n-k}b_{k} \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;עכשיו אפשר לדבר על הפונקציה היוצרת האקספוננציאלית הבסיסית שלנו: זו שמתאימה לסדרה &lt;span&gt;\( a_{n}=1 \)&lt;/span&gt;, כלומר לטור &lt;span&gt;\( \sum_{n=0}^{\infty}\frac{x^{n}}{n!} \)&lt;/span&gt;. את הפונקציה הזו אני אסמן בסימון המקוצר המסתורי &lt;span&gt;\( e^{x} \)&lt;/span&gt;. כמובן, ייתכן שחלקכם מכירים את הסימון הזה והוא לא נראה להם מסתורי, אבל זה &lt;strong&gt;מסוכן מאוד&lt;/strong&gt; לחשוב ככה כי למשל אם אני אכתוב עכשיו &lt;span&gt;\( e^{2x} \)&lt;/span&gt; אתם תגידו “כמובן, זה הטור &lt;span&gt;\( \sum_{n=0}^{\infty}2^{n}\frac{x^{n}}{n!} \)&lt;/span&gt;” וזה יהיה נכון בכל מה שנוגע לפונקציה שנקראת “אקספוננט” שאנחנו פוגשים בחדו”א, אבל כאן אנחנו בעולם קצת שונה, של טורי חזקות פורמליים, והביטוי &lt;span&gt;\( e^{2x} \)&lt;/span&gt; הוא פשוט &lt;strong&gt;לא מוגדר&lt;/strong&gt;. מה שמתבקש הוא להגדיר אותו בתור &lt;span&gt;\( e^{x}\cdot e^{x} \)&lt;/span&gt;, כי כפל כן הגדרנו, אבל צריך לוודא שזה עובד.&lt;/p&gt;

&lt;p&gt;מכיוון ש-&lt;span&gt;\( e^{x} \)&lt;/span&gt; התאים לסדרה &lt;span&gt;\( a_{n}=1 \)&lt;/span&gt;, אז &lt;span&gt;\( e^{x}\cdot e^{x} \)&lt;/span&gt; מתאים לסדרה &lt;span&gt;\( c_{n}=\sum_{k=0}^{n}{n \choose k} \)&lt;/span&gt;. למרבה השמחה, אנחנו יודעים ש-&lt;span&gt;\( \sum_{k=0}^{n}{n \choose k}=2^{n} \)&lt;/span&gt; (הוכחה קומבינטורית: &lt;span&gt;\( {n \choose k} \)&lt;/span&gt; הוא מספר הדרכים לבחור &lt;span&gt;\( k \)&lt;/span&gt; איברים מתוך &lt;span&gt;\( n \)&lt;/span&gt;, ואילו &lt;span&gt;\( 2^{n} \)&lt;/span&gt; הוא מספר הדרכים לבחור תת-קבוצה כלשהי מתוך &lt;span&gt;\( n \)&lt;/span&gt;) ולכן באמת מקבלים ש-&lt;span&gt;\( e^{x}\cdot e^{x} \)&lt;/span&gt; מיוצג על ידי הטור &lt;span&gt;\( \sum_{n=0}^{\infty}2^{n}\frac{x^{n}}{n!} \)&lt;/span&gt; מה ש”מצדיק” את הסימון &lt;span&gt;\( e^{2x}=e^{x}\cdot e^{x} \)&lt;/span&gt;. בגישה קצת פחות פורמלית הייתי אומר “מכיוון ש-&lt;span&gt;\( e^{x} \)&lt;/span&gt; שלי הוגדרה עם אותו טור כמו אקספוננט אז כל תוצאה שיש לנו על אקספוננט עובדת כאן עם הבונוס שלא צריך להתחשב בשיקולי התכנסות” אבל אני לא אעשה את זה.&lt;/p&gt;

&lt;p&gt;עכשיו, אם יש לנו את &lt;span&gt;\( e^{2x} \)&lt;/span&gt;, מה עם &lt;span&gt;\( e^{kx} \)&lt;/span&gt; עבור &lt;span&gt;\( k \)&lt;/span&gt; טבעי כללי? ההגדרה המתבקשת היא &lt;span&gt;\( e^{kx}=\sum_{n=0}^{\infty}k^{n}\frac{x^{n}}{n!} \)&lt;/span&gt;. הייתי רוצה להראות שזו באמת החזקה ה-&lt;span&gt;\( k \)&lt;/span&gt;-ית של &lt;span&gt;\( e^{x} \)&lt;/span&gt;, ואת זה אני יכול להוכיח באינדוקציה. נניח שבאמת מתקיים &lt;span&gt;\( e^{kx}=\sum_{n=0}^{\infty}k^{n}\frac{x^{n}}{n!} \)&lt;/span&gt; ונוכיח ש-&lt;span&gt;\( e^{x}\cdot e^{kx}=\sum_{n=0}^{\infty}\left(k+1\right)^{n}\frac{x^{n}}{n!} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;לצורך ההוכחה שוב נתבסס על הגדרת הכפל עבור האיבר הכללי - הפעם הוא יוצא &lt;span&gt;\( c_{n}=\sum_{i=0}^{n}{n \choose i}k^{i} \)&lt;/span&gt;. על &lt;span&gt;\( {n \choose i}k^{i} \)&lt;/span&gt; אפשר לחשוב קומבינטורית בתור בחירה של &lt;span&gt;\( i \)&lt;/span&gt; מתוך &lt;span&gt;\( n \)&lt;/span&gt; איברים, ואז צביעה של כל איבר בצבע מתוך קבוצה בת &lt;span&gt;\( k \)&lt;/span&gt; צבעים, כך שאפשר לבחור את אותו צבע יותר מפעם אחת. עכשיו, אם אני סופר את מספר הדרכים לבחור &lt;strong&gt;תת-קבוצה&lt;/strong&gt; של &lt;span&gt;\( n \)&lt;/span&gt; האיברים ולצבוע את אבריה ב-&lt;span&gt;\( k \)&lt;/span&gt; צבעים, אפשר להתחכם טיפה - ל-&lt;span&gt;\( k \)&lt;/span&gt; הצבעים נוסיף “צבע שקוף”, ואז פשוט נצבע את כל &lt;span&gt;\( n \)&lt;/span&gt; האיברים ב-&lt;span&gt;\( k+1 \)&lt;/span&gt; הצבעים, ומי שצבוע בצבע שקוף ייחשב כאילו לא לקחנו אותו לתת הקבוצה. כך קיבלנו שמספר הדרכים הכולל הוא &lt;span&gt;\( \left(k+1\right)^{n} \)&lt;/span&gt;, כלומר &lt;span&gt;\( c_{n}=\left(k+1\right)^{n} \)&lt;/span&gt;, כמו שרצינו להראות.&lt;/p&gt;

&lt;p&gt;למה אני בכלל טורח כל כך להתעסק בחזקות של &lt;span&gt;\( e^{x} \)&lt;/span&gt;? מן הסתם אני חותר למשהו. בואו נחזור אל המטרה שלנו - אנחנו רוצים למצוא נוסחה עבור &lt;span&gt;\( S_{m}\left(n\right) \)&lt;/span&gt;, לכל &lt;span&gt;\( m \)&lt;/span&gt;. קודם ראינו שאולי קשה להבין את &lt;span&gt;\( S_{m}\left(n\right) \)&lt;/span&gt; עבור &lt;span&gt;\( m \)&lt;/span&gt; &lt;strong&gt;בודד&lt;/strong&gt; אבל אם מסתכלים על ה-&lt;span&gt;\( S_{m} \)&lt;/span&gt;-ים הללו &lt;strong&gt;כמכלול&lt;/strong&gt;, כולם ביחד, יש ביניהם קשרים. פונקציות יוצרות הן בדיוק דרך לנצל את הקשרים הללו, אז די מתבקש לקחת את &lt;span&gt;\( S_{m} \)&lt;/span&gt; ולשתול אותם בתוך פונקציה יוצרת. עכשיו, בפונקציה יוצרת מה ששותלים הוא &lt;strong&gt;סדרות מספרים&lt;/strong&gt;, אבל &lt;span&gt;\( S_{m} \)&lt;/span&gt; היא לא סדרה של מספרים, היא סדרה של פונקציות - אז נבחר &lt;span&gt;\( n \)&lt;/span&gt; קונקרטי, נקבל עבורו סדרה קונקרטית של מספרים, &lt;span&gt;\( \left\{ S_{m}\left(n\right)\right\} _{m=0}^{\infty} \)&lt;/span&gt;. נשתול אותה בתוך פונקציה יוצרת אקספוננציאלית ונראה מה נקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{m=0}^{\infty}S_{m}\left(n\right)\frac{x^{m}}{m!}=\sum_{m=0}^{\infty}\left(\sum_{k=0}^{n-1}k^{m}\right)\frac{x^{m}}{m!} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו שימו לב מה קורה כאן: יש לנו פונקציה יוצרת אקספוננציאלית שהאיבר הכללי שלה הוא &lt;strong&gt;סכום סופי&lt;/strong&gt; של איברים. זה מתאים לסיטואציה &lt;span&gt;\( c_{n}=a_{n}+b_{n} \)&lt;/span&gt; שראינו קודם, רק לא עם שני איברים אלא עם &lt;span&gt;\( n \)&lt;/span&gt; איברים, אבל באינדוקציה אפשר להראות שכל איבר כללי שהוא סכום של מספר סופי כלשהו של איברים מתפרק לסכום של פונקציות יוצרות, ולכן נקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{m=0}^{\infty}S_{m}\left(n\right)\frac{x^{m}}{m!}=\sum_{m=0}^{\infty}\left(\sum_{k=0}^{n-1}k^{m}\right)\frac{x^{m}}{m!}=\sum_{k=0}^{n-1}\left[\sum_{m=0}^{\infty}k^{m}\frac{x^{m}}{m!}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הפלא ופלא, כל הפונקציות היוצרות שבסכום מתאימות בדיוק לחזקות של &lt;span&gt;\( e \)&lt;/span&gt; שראינו קודם, אז קיבלנו את התוצאה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{m=0}^{\infty}S_{m}\left(n\right)\frac{x^{m}}{m!}=e^{0x}+e^{x}+e^{2x}+e^{3x}+\ldots+e^{\left(n-1\right)x} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו אפשר סוף סוף לראות את הכוח של פונקציות יוצרות: את הביטוי &lt;span&gt;\( e^{0x}+e^{x}+e^{2x}+e^{3x}+\ldots+e^{\left(n-1\right)x} \)&lt;/span&gt; אפשר לראות בתור &lt;strong&gt;טור הנדסי&lt;/strong&gt;. כזכור, אם יש לנו טור הנדסי &lt;span&gt;\( 1+q+q^{2}+q^{3}+\ldots+q^{n-1} \)&lt;/span&gt; אנחנו יודעים לחשב את הסכום שלו על ידי הטריק הבא: נכפול ונחלק ב-&lt;span&gt;\( \left(q-1\right) \)&lt;/span&gt; ואז נקבל במונה טור טלסקופי שכל מה שיישאר ממנו הוא &lt;span&gt;\( q^{n}-1 \)&lt;/span&gt;, בזמן שבמכנה יהיה לנו &lt;span&gt;\( q-1 \)&lt;/span&gt;, כלומר קיבלנו &lt;span&gt;\( 1+q+q^{2}+q^{3}+\ldots+q^{n-1}=\frac{q^{n}-1}{q-1} \)&lt;/span&gt;. אם נציב &lt;span&gt;\( q=e^{x} \)&lt;/span&gt;, זה נותן לנו את הביטוי &lt;span&gt;\( \frac{e^{nx}-1}{e^{x}-1} \)&lt;/span&gt; (חדי העין ישימו לב שטיפה רימיתי פה - אני אחזור לזה בהמשך).&lt;/p&gt;

&lt;p&gt;עכשיו, בואו נכפול ונחלק את הביטוי הזה ב-&lt;span&gt;\( x \)&lt;/span&gt; ונקבל &lt;span&gt;\( \frac{e^{nx}-1}{e^{x}-1}=\frac{e^{nx}-1}{x}\frac{x}{e^{x}-1} \)&lt;/span&gt;. אני עוד מעט אקדיש חלק שלם כדי להסביר למה &lt;span&gt;\( \frac{x}{e^{x}-1}=\sum_{k=0}^{\infty}B_{k}\frac{x^{k}}{k!} \)&lt;/span&gt;, כלומר &lt;span&gt;\( \frac{x}{e^{x}-1} \)&lt;/span&gt; הוא הפונקציה היוצרת האקספוננציאלית של מספרי ברנולי. לגבי &lt;span&gt;\( \frac{e^{nx}-1}{x} \)&lt;/span&gt;, קל יותר לטפל בו: &lt;span&gt;\( e^{nx}=1+nx+\frac{n^{2}x^{2}}{2}+\ldots \)&lt;/span&gt; ולכן &lt;span&gt;\( \frac{e^{nx}-1}{x}=n+\frac{n^{2}x}{2}+\ldots=\sum_{k=0}^{\infty}\frac{n^{k+1}}{k+1}\cdot\frac{x^{k}}{k!} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;נסכם לרגע בזהירות את מה שראינו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \sum_{m=0}^{\infty}S_{m}\left(n\right)\frac{x^{m}}{m!}=\left(\sum_{k=0}^{\infty}\frac{n^{k+1}}{k+1}\frac{x^{k}}{k!}\right)\left(\sum_{k=0}^{\infty}B_{k}\frac{x^{k}}{k!}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, כשעוברים מרמת הפונקציות היוצרות האקספוננציאליות לרמת האיבר הבודד, וזוכרים איך כפל של פונקציות יוצרות אקספוננציאליות עובד כשעוברים לרמת האיבר הבודד, מקבלים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S_{m}\left(n\right)=\sum_{k=0}^{m}{m \choose k}B_{k}\frac{n^{\left(m-k\right)+1}}{\left(m-k\right)+1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;את הגורם שבפנים אפשר לפשט עם עוד תעלול אלגברי/קומבינטורי קטן:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( {m \choose k}\frac{1}{m-k+1}=\frac{m!}{k!\left(m-k\right)!}\cdot\frac{1}{m-k+1}=\frac{m!}{k!\left(m-k+1\right)!}=\frac{1}{m+1}\frac{\left(m+1\right)!}{k!\left(m-k+1\right)!}=\frac{1}{m+1}{m+1 \choose k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וקיבלנו את הנוסחה שמציגים בכל מקום:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( S_{m}\left(n\right)=\frac{1}{m+1}\sum_{k=0}^{m}{m+1 \choose k}n^{m+1-k}B_{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה היה… ממש טכני? ובכן, כן ולא. אני יודע שזה די מרתיע אבל בסופו של דבר כשמבינים את הרעיון של פונקציות יוצרות כל מה שעשינו פה הוא מאוד סטנדרטי. זה לא אומר שהיה כיף גדול לעשות את זה, אבל בהתחשב בתוצאה הדי כללית שמקבלים פה זה ממש נחמד - בפרט שזו תוצאה שמטפלת בכל אינסוף ה-&lt;span&gt;\( S_{m}\left(n\right) \)&lt;/span&gt;-ים בו זמנית.&lt;/p&gt;

&lt;p&gt;אבל עדיין לא סיימתי כי נשאר לי להסביר מאיפה מספרי ברנולי הגיעו.&lt;/p&gt;

&lt;h2&gt;בואו למסע אל מקורות הברנולי&lt;/h2&gt;

&lt;p&gt;אני טענתי, ללא הוכחה, ש-&lt;span&gt;\( \frac{x}{e^{x}-1}=\sum_{k=0}^{\infty}B_{k}\frac{x^{k}}{k!} \)&lt;/span&gt;. כלומר אני &lt;strong&gt;מגדיר&lt;/strong&gt; את מספרי ברנולי בתור הסדרה ש-&lt;span&gt;\( \frac{x}{e^{x}-1} \)&lt;/span&gt; היא הפונקציה היוצרת האקספוננציאלית שלה. יש כאן שתי שאלות&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;למה אני יודע בכלל ש-&lt;span&gt;\( \frac{x}{e^{x}-1} \)&lt;/span&gt; ניתן לתיאור על ידי טור חזקות כזה?&lt;/li&gt;


&lt;li&gt;איך אני יודע שאלו מספרי ברנולי? כלומר, איך אני מראה שמתקיימת הנוסחה הרקורסיבית &lt;span&gt;\( B_{n}=-\frac{1}{n+1}\sum_{k=0}^{n-1}{n+1 \choose k}B_{k} \)&lt;/span&gt; שהצגתי קודם?&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;נתחיל מהשאלה הראשונה, למה &lt;span&gt;\( \frac{x}{e^{x}-1} \)&lt;/span&gt; ניתן לתיאור על ידי טור חזקות פורמלי. אם לא היינו עובדים במסגרת פורמלית אלא בחדו”א, הסיפור היה הולך ככה: היינו שמים לב שכשמציבים &lt;span&gt;\( x=0 \)&lt;/span&gt; אז &lt;span&gt;\( e^{x}=1 \)&lt;/span&gt; ולכן &lt;span&gt;\( e^{x}-1=0 \)&lt;/span&gt; ולכן המכנה של &lt;span&gt;\( \frac{x}{e^{x}-1} \)&lt;/span&gt; יכול להתאפס ומדובר בקטסטרופה. אבל מצד שני, גם &lt;strong&gt;המונה&lt;/strong&gt; מתאפס כש-&lt;span&gt;\( x=0 \)&lt;/span&gt; ולכן אפשר להשתמש בלהטוט החדו”אי שנקרא כלל לופיטל ולקבל &lt;span&gt;\( \lim_{x\to0}\frac{x}{e^{x}-1}=\lim_{x\to0}\frac{1}{e^{x}}=1 \)&lt;/span&gt;. כלומר, אפשר “לתקן” את הפונקציה &lt;span&gt;\( \frac{x}{e^{x}-1} \)&lt;/span&gt; כך שב-&lt;span&gt;\( x=0 \)&lt;/span&gt; היא תוגדר להיות 1 ולקבל פונקציה נחמדה שאפשר לפתח לטור והכל טוב ויפה.&lt;/p&gt;

&lt;p&gt;אני לא הולך לעשות את זה כאן. כאמור, אני דוגל בגישה הפורמלית. בגישה הזו כל מה שיש בעולם הוא טורי חזקות פורמליים ולכן הביטוי &lt;span&gt;\( \frac{x}{e^{x}-1} \)&lt;/span&gt; הוא בסך הכל &lt;strong&gt;סימון מקוצר&lt;/strong&gt; לטור חזקות פורמלי כלשהו. איזה? על פניו, הטור &lt;span&gt;\( x\left(e^{x}-1\right)^{-1} \)&lt;/span&gt; כאשר &lt;span&gt;\( \left(e^{x}-1\right)^{-1} \)&lt;/span&gt; הוא טור החזקות ההופכי של &lt;span&gt;\( e^{x}-1 \)&lt;/span&gt;, דהיינו הטור שכשכופלים אותו ב-&lt;span&gt;\( e^{x}-1 \)&lt;/span&gt; מקבלים &lt;span&gt;\( 1 \)&lt;/span&gt;. אבל, לצערנו, &lt;strong&gt;אין טור חזקות כזה&lt;/strong&gt;. בשביל שטור חזקות יהיה “הפיך” במובן שציינתי, המקדם החופשי שלו צריך להיות הפיך - ובמקרה שלנו, המקדם החופשי של &lt;span&gt;\( e^{x}-1 \)&lt;/span&gt; הוא 0 שאינו הפיך.&lt;/p&gt;

&lt;p&gt;אבל לא הכל אבוד, אני לא באמת צריך הופכיים פה. מה שאני רוצה להגיד בביטוי &lt;span&gt;\( \frac{x}{e^{x}-1}=f\left(x\right) \)&lt;/span&gt; הוא שמתקיים השוויון &lt;span&gt;\( x=f\left(x\right)\left(e^{x}-1\right) \)&lt;/span&gt;. אז אני אבדוק אם אני מסוגל &lt;strong&gt;להגדיר&lt;/strong&gt; את &lt;span&gt;\( f\left(x\right) \)&lt;/span&gt; כדי שהשוויון הזה יתקיים; אם אני מסוגל, אז אפשר יהיה להשתמש בסימון המקוצר &lt;span&gt;\( \frac{x}{e^{x}-1} \)&lt;/span&gt; כמו קודם.&lt;/p&gt;

&lt;p&gt;בואו נתחיל מלכתוב את &lt;span&gt;\( f\left(x\right) \)&lt;/span&gt; בתור טור חזקות אקספוננציאלי כללי: &lt;span&gt;\( f\left(x\right)=\sum_{k=0}^{\infty}b_{k}\frac{x^{k}}{k!} \)&lt;/span&gt;. כרגע אני &lt;strong&gt;לא יודע&lt;/strong&gt; שה-&lt;span&gt;\( b_{k} \)&lt;/span&gt;-ים הללו הם מספרי ברנולי, או אפילו שאני יכול לבחור להם ערכים בצורה כזו שתצדיק את השוויון &lt;span&gt;\( \frac{x}{e^{x}-1}=f\left(x\right) \)&lt;/span&gt;, אבל אני כן יכול לקחת טור חזקות אקספוננציאלי כללי כלשהו, לתת למקדמים שלו את הסימון &lt;span&gt;\( b_{k} \)&lt;/span&gt;, לכפול אותו ב-&lt;span&gt;\( e^{x}-1 \)&lt;/span&gt; ולראות מה קורה. נוסחת הכפל הרגילה של טורי חזקות אקספוננציאליים תקפה גם כאן:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n}=\sum_{k=0}^{n}{n \choose k}a_{n-k}b_{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;אצלנו &lt;span&gt;\( a_{0}=0 \)&lt;/span&gt; ואילו &lt;span&gt;\( a_{k}=1 \)&lt;/span&gt; לכל &lt;span&gt;\( k&amp;gt;0 \)&lt;/span&gt; (כי החסרת 1 מ-&lt;span&gt;\( e^{x} \)&lt;/span&gt; הורידה 1 מהאיבר במקום 0; אם למשל היינו רוצים להוריד 3 מהאיבר במקום 2 היינו צריכים לחסר &lt;span&gt;\( 3x^{2} \)&lt;/span&gt;). בנוסחה &lt;span&gt;\( c_{n}=\sum_{k=0}^{n}{n \choose k}a_{n-k}b_{k} \)&lt;/span&gt; אני מקבל את &lt;span&gt;\( a_{0} \)&lt;/span&gt; כאשר &lt;span&gt;\( k=n \)&lt;/span&gt; ולכן המקרה הזה אף פעם לא יופיע, ואני מקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n}=\sum_{k=0}^{n-1}{n \choose k}b_{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר, עבור &lt;span&gt;\( c_{0} \)&lt;/span&gt; אני מקבל סכום “ריק” ולכן &lt;span&gt;\( c_{0}=0 \)&lt;/span&gt; תמיד, אין לי שליטה על זה (זו בדיוק הסיבה שבגללה &lt;span&gt;\( e^{x}-1 \)&lt;/span&gt; לא הפיך). זו לא באמת בעיה, כי אנחנו רוצים לקבל את התוצאה &lt;span&gt;\( x \)&lt;/span&gt;, כלומר התוצאה שמתאימה למקרה שבו &lt;span&gt;\( c_{1}=1 \)&lt;/span&gt; ואילו &lt;span&gt;\( c_{n}=0 \)&lt;/span&gt; לכל &lt;span&gt;\( n\ne1 \)&lt;/span&gt;. אז מה באמת קורה עבור &lt;span&gt;\( c_{1} \)&lt;/span&gt;?&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{1}={1 \choose 0}b_{0}=b_{0} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה מאלץ אותנו להגדיר &lt;span&gt;\( b_{0}=1 \)&lt;/span&gt;, אבל יופי - אם אנחנו מגדירים את &lt;span&gt;\( b_{0}=1 \)&lt;/span&gt; אנחנו באמת מקבלים את הערך המבוקש של &lt;span&gt;\( c_{1} \)&lt;/span&gt;. מה עם היתר?&lt;/p&gt;

&lt;p&gt;עבור &lt;span&gt;\( c_{2} \)&lt;/span&gt; צריך להתקיים &lt;span&gt;\( c_{2}=0 \)&lt;/span&gt;, ואנחנו יודעים ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{2}={2 \choose 0}b_{0}+{2 \choose 1}b_{1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0=b_{0}+2b_{1} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כלומר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{1}=-\frac{1}{2}b_{0}=-\frac{1}{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;בינתיים זה מתקדם כמו שרצינו! באמת הגדרנו ש-&lt;span&gt;\( b_{1}=-\frac{1}{2} \)&lt;/span&gt; בהגדרה שלנו למספרי ברנולי! אז יופי, בואו נעבור למקרה הכללי. נניח שכבר הגדרנו את &lt;span&gt;\( b_{0},b_{1},\ldots,b_{n-1} \)&lt;/span&gt; בצורה כזו שבה כל המקדמים עד &lt;span&gt;\( c_{n} \)&lt;/span&gt; קיבלו את הערך הנכון, ונטפל ב-&lt;span&gt;\( c_{n+1}=0 \)&lt;/span&gt;. על פי נוסחת המכפלה, אנחנו יודעים ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( c_{n+1}=\sum_{k=0}^{n}{n+1 \choose k}b_{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;נציב &lt;span&gt;\( c_{n+1}=0 \)&lt;/span&gt; וכמו כן נפריד את &lt;span&gt;\( b_{n} \)&lt;/span&gt; מכל היתר:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 0={n+1 \choose n}b_{n}+\sum_{k=0}^{n-1}{n+1 \choose k}b_{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו, &lt;span&gt;\( {n+1 \choose n}=n+1 \)&lt;/span&gt; ולכן אחרי העברת אגפים וחלוקה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( b_{n}=-\frac{1}{n+1}\sum_{k=0}^{n-1}{n+1 \choose k}b_{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזו בדיוק, אבל בדיוק, הנוסחה עבור מספרי ברנולי:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B_{n}=-\frac{1}{n+1}\sum_{k=0}^{n-1}{n+1 \choose k}B_{k} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שמשיג את שתי המטרות שלנו: הראנו שבאמת קיימת פונקציה &lt;span&gt;\( f\left(x\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( f\left(x\right)\left(e^{x}-1\right)=x \)&lt;/span&gt; למרות ש-&lt;span&gt;\( e^{x}-1 \)&lt;/span&gt; לא הפיכה, והראינו שהמקדמים של הפונקציה היוצרת האקספוננציאלית שלה הם מספרי ברנולי &lt;span&gt;\( B_{k} \)&lt;/span&gt;, ולכן אפשר לכתוב&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{x}{e^{x}-1}=\sum_{k=0}^{\infty}B_{k}\frac{x^{k}}{k!} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כפי שרצינו.&lt;/p&gt;

&lt;p&gt;האם סיימנו? כמעט. אני עדיין רוצה להסביר את הפורמליות שמאחורי יתר נפנופי הידיים שביצעתי. בואו ניזכר מה בדיוק קרה שם:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;הגעתי איכשהו אל הפונקציה היוצרת &lt;span&gt;\( e^{0x}+\ldots+e^{\left(n-1\right)x} \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;טענתי ש-&lt;span&gt;\( e^{0x}+\ldots+e^{\left(n-1\right)x}=\frac{e^{nx}-1}{e^{x}-1} \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;טענתי ש-&lt;span&gt;\( \frac{e^{nx}-1}{e^{x}-1}=\frac{e^{nx}-1}{x}\frac{x}{e^{x}-1} \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;אלו טענות “מפוקפקות” כי הן מחלקות בדברים שאין להם הופכי (גם &lt;span&gt;\( e^{x}-1 \)&lt;/span&gt; וגם &lt;span&gt;\( x \)&lt;/span&gt;). אז בואו ננסח אותן מחדש בצורה פורמלית יותר אם כי אינטואיטיבית פחות.&lt;/p&gt;

&lt;p&gt;כבר ראיתי שיש פונקציה &lt;span&gt;\( f\left(x\right)=\frac{x}{e^{x}-1} \)&lt;/span&gt;, כלומר פורמלית זה טור חזקות שמקיים &lt;span&gt;\( \left(e^{x}-1\right)f\left(x\right)=x \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;בנוסף, ראיתי שיש &lt;span&gt;\( g\left(x\right)=\frac{e^{nx}-1}{x} \)&lt;/span&gt;, כלומר פורמלית זה טור חזקות שמקיים &lt;span&gt;\( xg\left(x\right)=e^{nx}-1 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;בנוסף, במקום להשתמש בנוסחת הטור ההנדסי אפשר לתאר את הסיטואציה בעזרת כפל בלבד, כלומר להישאר ברמת הטור הטלסקופי: &lt;span&gt;\( \left(e^{x}-1\right)\left(e^{0x}+\ldots+e^{\left(n-1\right)x}\right)=e^{nx}-1 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו אני יכול לעשות שרשרת של הצבות:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(e^{x}-1\right)\left(e^{0x}+\ldots+e^{\left(n-1\right)x}\right)=e^{nx}-1=xg\left(x\right)=\left(e^{x}-1\right)f\left(x\right)g\left(x\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וכאן מגיע להטוט אחד אחרון: באופן כללי, בכל חוג שהוא &lt;strong&gt;תחום שלמות&lt;/strong&gt; (כלומר, אין בו מחלקי אפס - איברים שונים מאפס שכשכופלים אותם מקבלים אפס) אפשר תמיד &lt;strong&gt;לצמצם&lt;/strong&gt;: אם יש לי &lt;span&gt;\( ab=ac \)&lt;/span&gt; עבור &lt;span&gt;\( a\ne0 \)&lt;/span&gt; אז נובע מכך &lt;span&gt;\( b=c \)&lt;/span&gt; אפילו אם &lt;span&gt;\( a \)&lt;/span&gt; לא הפיך, פשוט כי אני מסתכל על &lt;span&gt;\( a\left(b-c\right)=0 \)&lt;/span&gt; ובגלל שאני בתחום שלמות ו-&lt;span&gt;\( a\ne0 \)&lt;/span&gt; אז &lt;span&gt;\( b-c=0 \)&lt;/span&gt; כלומר &lt;span&gt;\( b=c \)&lt;/span&gt;. זה בדיוק מה שאני אשתמש בו למעלה כדי להיפטר מה-&lt;span&gt;\( e^{x}-1 \)&lt;/span&gt; המשותף, ולקבל את השוויון הפורמלי לחלוטין:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( e^{0x}+\ldots+e^{\left(n-1\right)x}=f\left(x\right)g\left(x\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שמסיים את ההוכחה.&lt;/p&gt;

&lt;p&gt;הסיפור של מספרי ברנולי לא נגמר כאן - יש עוד כל מני דברים מעניינים להראות עליהם, אבל עם סיום התוצאה הבסיסית הזו הגענו אל נקודה טובה לעצור בה לבינתיים.&lt;/p&gt;</content><author><name></name></author><category term="מספרי ברנולי" /><category term="סכומי חזקות" /><category term="פונקציות יוצרות אקספוננציאליות" /><summary type="html">בואו נסכום סכומים</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">איך מחשבים דטרמיננטה עם אלגוריתם בריס?</title><link href="http://gadial.net/2024/12/14/computing_determinants_bareiss_algorithm/" rel="alternate" type="text/html" title="איך מחשבים דטרמיננטה עם אלגוריתם בריס?" /><published>2024-12-14T00:00:00+00:00</published><updated>2024-12-14T00:00:00+00:00</updated><id>http://gadial.net/2024/12/14/computing_determinants_bareiss_algorithm</id><content type="html" xml:base="http://gadial.net/2024/12/14/computing_determinants_bareiss_algorithm/">&lt;h2&gt;חלק ראשון, שבו אנחנו לומדים שמינוס 32 הוא כמעט 256&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://gadial.net/2024/12/03/computing_determinants/&quot;&gt;בפוסט הקודם שלי&lt;/a&gt; על דטרמיננטות הסברתי איך מחשבים אותן. הצגתי שתי דרכים: אחת שהולכת דרך ההגדרה הרקורסיבית והיא מאוד לא יעילה לחישוב, ואחת שמבצעת פישוט למטריצה שרוצים לחשב את הדטרמיננטה שלה והיא משמעותית יותר יעילה. יש שיטות שהן אפילו יעילות יותר, אבל בפוסט הזה אני רוצה לקחת צעד אחד אחורה דווקא ולהציג שיטה יעילה פחות, אבל עם יתרון נחמד אחד: אם האיברים של המטריצה הם כולם מספרים שלמים, אנחנו לא נזדקק לשברים במהלך כל החישוב. למה זה טוב? תכף אתן דוגמא פשוטה.&lt;/p&gt;

&lt;p&gt;ראשית, בואו נבין מה באלגוריתם ה”יעיל” מכריח את השברים להיכנס למשחק. בואו נסתכל במטריצה הבאה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[\begin{array}{ccc} 2 &amp;amp; 1 &amp;amp; 3\\ 3 &amp;amp; 1 &amp;amp; 6\\ 4 &amp;amp; 1 &amp;amp; 8 \end{array}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;האלגוריתם מבוסס על כך שאנחנו עוברים עמודה-עמודה, ובכל פעם אנחנו משתמשים באיבר כלשהו מהעמודה כדי לאפס את כל האיברים שאחריו בעמודה - זה הופך את חישוב הדטרמיננטה לפשוט כי כאשר מפתחים את הדטרמיננטה לפי עמודות, יוצא שבכל פעם יש רק איבר אחד בכל עמודה שצריך לפתח לפיו, ולכן מה שהוא בדרך כלל חישוב רקורסיבי מסובך שמתפצל להרבה מקרים לא מתפצל בכלל. כדי לאפס איברים בעמודה משתמשים בתוצאה המרהיבה לפיה אם לוקחים שורה במטריצה, ומחברים אותה עם שורה אחרת כשהיא מוכפלת בסקלר כלשהו, התוצאה היא בעלת אותה דטרמיננטה כמו המטריצה המקורית. למשל, אם במטריצה לעיל אני אקח את השורה הראשונה, אכפול אותה ב-&lt;span&gt;\( -2 \)&lt;/span&gt; ואחבר לשורה האחרונה, אני אקבל את המטריצה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[\begin{array}{ccc} 2 &amp;amp; 1 &amp;amp; 3\\ 3 &amp;amp; 1 &amp;amp; 6\\ 0 &amp;amp; -1 &amp;amp; 2 \end{array}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;והמטריצה הזו היא בעלת אותה דטרמיננטה בדיוק כמו המטריצה שהתחלתי ממנה, והנה - קיבלתי אפס בעמודה הראשונה. הבעיה היא שכדי להיפטר מה-3 שבשורה האמצעית אני צריך לכפול את השורה הראשונה במשהו שאינו מספר שלם - ב-&lt;span&gt;\( -\frac{3}{2} \)&lt;/span&gt;, מה שמוביל אותי למטריצה הבאה:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left[\begin{array}{ccc} 2 &amp;amp; 1 &amp;amp; 3\\ 0 &amp;amp; -\frac{1}{2} &amp;amp; \frac{3}{2}\\ 0 &amp;amp; -1 &amp;amp; 2 \end{array}\right] \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזהו, עכשיו יש לי שברים בתוך המטריצה, למרות שהתחלתי עם מטריצה שכולה מספרים שלמים ולמרות &lt;strong&gt;שגם התוצאה תהיה מספר שלם&lt;/strong&gt;. כדי לראות שהתוצאה תהיה מספר שלם מספיק להיזכר באופן שבו דטרמיננטה מוגדרת רקורסיבית: אנחנו מקבלים סכום של איברים שכל אחד מהם שייך למטריצה (כלומר הוא מספר שלם) שמוכפל ב-&lt;span&gt;\( \pm1 \)&lt;/span&gt; (מספר שלם) וזה מוכפל בדטרמיננטה של תת-מטריצות שמתקבלות מהמטריצה המקורית על ידי מחיקת שורות ועמודות (ולכן גם בהן יש מספרים שלמים). לי הסיטואציה הזו טיפה מזכירה את המקרה של ה-Casus irreducibilis בפתרון משוואות ממעלה שלישית (&lt;a href=&quot;https://gadial.net/2018/07/26/casus_irreducibilis/&quot;&gt;יש לי פוסט על זה&lt;/a&gt;): שם העניין הוא שיש לנו משוואה פולינומית עם מקדמים שהם מספרים ממשיים, והפתרונות שלה כולם מספרים ממשיים, אבל בלי לעבור “דרך” המספרים המרוכבים (כלומר, להוציא שורש ריבועי למספר שלילי) לא נוכל לכתוב את הפתרונות הללו באמצעות נוסחה. אלא שיש הבדל מהותי - במקרה ההוא &lt;strong&gt;חייבים&lt;/strong&gt; לעבור דרך המרוכבים (יש לזה הוכחה די מרהיבה באמצעות תורת גלואה שאני מראה בפוסט ההוא) אבל במקרה שלנו זה לא הכרחי. יש דרכים אחרות לחשב את הדטרמיננטה גם בלי להכניס שברים למשחק. כבר ראינו אחת: לחשב את הדטרמיננטה באמצעות האלגוריתם הרקורסיבי, אלא שזה כאמור פשוט לא יעיל ולכן בפוסט הזה אני אציג את מה שנקרא “האלגוריתם של ברייס” (Bareiss) ששומר על הכל שלם והנזק שהוא גורם לזמן הריצה הוא לא כזה משמעותי (אבל יש נזק; זה בהחלט אלגוריתם שבעייתי בשלל סיטואציות ולכן טוב שמכירים אותו &lt;strong&gt;וגם&lt;/strong&gt; שיטות אחרות).&lt;/p&gt;

&lt;p&gt;בואו נדבר שניה על המוטיבציה האישית שלי לכתוב את הפוסט כדי להבין למה לא כדאי לסמוך בעיניים עצומות על השיטות הקיימות ולמה לפעמים חשוב לדבוק במספרים שלמים במקום בשברים. נסיבות אלו ואחרות הובילו אותי לחשב דטרמיננטה של מטריצה &lt;span&gt;\( 5\times5 \)&lt;/span&gt;, שנותנת לנו את הנפח של טטרהדרון (פירמידה עם בסיס משולש) שאורכי הצלעות שלו נתונים על ידי &lt;span&gt;\( d_{ij} \)&lt;/span&gt; עבור &lt;span&gt;\( 1\le i,j\le4 \)&lt;/span&gt;. הנפח &lt;span&gt;\( V \)&lt;/span&gt; נתון באמצעות&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 288V^{2}=\left|\begin{array}{ccccc} 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 1 &amp;amp; 1\\ 1 &amp;amp; 0 &amp;amp; d_{12}^{2} &amp;amp; d_{13}^{2} &amp;amp; d_{14}^{2}\\ 1 &amp;amp; d_{21}^{2} &amp;amp; 0 &amp;amp; d_{23}^{2} &amp;amp; d_{24}^{2}\\ 1 &amp;amp; d_{31}^{2} &amp;amp; d_{32}^{2} &amp;amp; 0 &amp;amp; d_{34}^{2}\\ 1 &amp;amp; d_{41}^{2} &amp;amp; d_{42}^{2} &amp;amp; d_{43}^{2} &amp;amp; 0 \end{array}\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הדטרמיננטה הזו נקראת &lt;strong&gt;דטרמיננטת קיילי-מנגר&lt;/strong&gt; והיא ראויה לפוסט בפני עצמה (היא עושה יותר מאשר לחשב נפח של טטרהדרון) והאמת העצובה היא שהדרך הכי פשוטה לחשב אותה היא פשוט להשתמש בנוסחה הרקורסיבית - זו בסך הכל מטריצת &lt;span&gt;\( 5\times5 \)&lt;/span&gt;, הרקורסיה תסתיים כמעט מייד, ואין צורך באלגוריתם שאני הולך להציג - אבל את זה נזכרתי לנסות רק אחרי שכבר מימשתי את האלגוריתם (כי על מי אני עובד, כל כך התלהבתי מהאלגוריתם שהייתי חייב לממש אותו בכל מקרה). אבל למה היא גרמה לי להגיע אל אלגוריתם בריס מלכתחילה? ובכן, כי עשיתי את הטעות של לחשב אותה באמצעות numpy. מבלי להיכנס לפרטים, המטרה שלי הייתה למצוא אורכי צלעות שעבורם הדטרמיננטה תהיה שווה בדיוק ל-256. עכשיו, בואו נניח שיש לנו מספר שלם &lt;span&gt;\( n \)&lt;/span&gt; כלשהו ואנחנו מסתכלים על הדטרמיננטה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left|\begin{array}{ccccc} 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 1 &amp;amp; 1\\ 1 &amp;amp; 0 &amp;amp; 1 &amp;amp; n^{2} &amp;amp; n^{2}\\ 1 &amp;amp; 1 &amp;amp; 0 &amp;amp; \left(n-1\right)^{2} &amp;amp; \left(n-1\right)^{2}\\ 1 &amp;amp; n^{2} &amp;amp; \left(n-1\right)^{2} &amp;amp; 0 &amp;amp; 4\\ 1 &amp;amp; n^{2} &amp;amp; \left(n-1\right)^{2} &amp;amp; 4 &amp;amp; 0 \end{array}\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;שהיא מקרה פרטי של הדטרמיננטה לעיל עבור סדרת האורכים &lt;span&gt;\( 1,n,n,n-1,n-1,2 \)&lt;/span&gt;. אם מחשבים את הדטרמיננטה בצורה סימבולית (כלומר, פשוט פותחים את הביטוי, מקבלים פולינום ב-&lt;span&gt;\( n \)&lt;/span&gt; ומפשטים אותו) מקבלים &lt;span&gt;\( -32 \)&lt;/span&gt;, כלומר הערך של הדטרמיננטה הזו לא תלוי ב-&lt;span&gt;\( n \)&lt;/span&gt;. למי שתוהים איך עושים את זה במחשב בלי לעבור את התהליך המהנה של לחשב ידנית דטרמיננטה &lt;span&gt;\( 5\times5 \)&lt;/span&gt;, אפשר לעשות את זה עם ספריית הפייתון sympy:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sympy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sp&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;n&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;matrix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;determinant&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;det&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;simplify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;determinant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;טוב ויפה, אלא שאני לא השתמשתי ב-sympy כי בדקתי שלל דטרמיננטות משלל סוגים ולא רק מהמבנה הספציפי הזה שאותו מצאתי אחר כך. ספציפית, אני בדקתי את הדטרמיננטה שמתקבלת עבור הערך &lt;span&gt;\( n=524,283 \)&lt;/span&gt; וחישבתי אותו בעזרת הספריה הסטנדרטית לחישובים נומריים בפייתון - numpy. ומה ש-numpy נתנה הוא את התוצאה &lt;span&gt;\( 255.99999991524982 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;במבט ראשון, התוצאה הזו היא “זה 256, פשוט numpy משתמשת בייצוג שברים עם נקודה צפה ולכן יש אי דיוקים קטנים”. אבל לא! זו דרך טובה לעבוד על עצמנו! כי אם אני מכניס &lt;span&gt;\( n=524,283 \)&lt;/span&gt; ואז עוד מעלה דברים בריבוע, אני עובד עם מספרי ענק ולכן יש לי שגיאות דיוק גדולות, וחישובים שקשורים במטריצות יכולים להיות מאוד רגישים לשגיאות דיוק, וזה מתנפח ומתנפח. התוצאה, כאמור, הייתה אמורה להיות &lt;span&gt;\( -32 \)&lt;/span&gt;; זה שהגענו אל כמעט 256 זה סתם מקרה (על ידי ערכים שונים של &lt;span&gt;\( n \)&lt;/span&gt; אפשר להגיע קרוב לשלל מספרים שלמים לא קשורים, פשוט 256 היה מה שחיפשנו). הנה קוד פייתון שמשתמש ב-numpy ומאפשר לראות מה הולך פה. עבור &lt;span&gt;\( n=1 \)&lt;/span&gt; החישוב מדויק כמעט לחלוטין, וכך גם עבור &lt;span&gt;\( n=10,000 \)&lt;/span&gt;; אבל כשהוא נשבר, הוא נשבר &lt;strong&gt;חזק&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;524283&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;         &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;         &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
                  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;det&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;הבעיה פה היא כאמור ש-numpy מייצג שברים בשיטת הנקודה הצפה, ולכן יש לו רמת דיוק מוגבלת, בעוד שבפייתון יש רמת דיוק בלתי מוגבלת לעבודה עם מספרים שלמים. אז מכיוון שחשדתי ש-numpy מרמה אותי החלטתי שאני לא צריך להתעצל ולהסתמך עליו או אפילו לחפש ספריה אחרת שמבצעת את החישוב (כי אולי גם היא תרמה אותי?) אלא פשוט לממש את זה בעצמי. עכשיו, &lt;strong&gt;הייתי יכול&lt;/strong&gt; להשתמש באלגוריתם הרקורסיבי הנאיבי; וגם &lt;strong&gt;הייתי יכול&lt;/strong&gt; להשתמש בשיטה מבוססת השברים שראינו, ופשוט להשתמש בספריה frac בפייתון שמאפשרת ייצוג של שברים עם דיוק לא מוגבל. אבל באותו הרגע הדבר הראשון שעלה לי לראש היה לחפש “אלגוריתם לחישוב דטרמיננטה שלא משתמש בשברים” ואני שמח שזה קרה כי אלגוריתם בריס הוא די מגניב גם אם הייתי יכול להסתדר בלעדיו.&lt;/p&gt;

&lt;p&gt;אז בואו נדבר עליו סוף סוף.&lt;/p&gt;

&lt;h2&gt;חלק שני שבו אנו רואים את מה שלשמו התכנסנו פה&lt;/h2&gt;

&lt;p&gt;קודם כל, מה אלגוריתם בריס &lt;strong&gt;לא&lt;/strong&gt; עושה: הוא לא מעביר את המטריצה &lt;span&gt;\( A \)&lt;/span&gt; שלנו למטריצה אחרת &lt;span&gt;\( B \)&lt;/span&gt; כך ש-&lt;span&gt;\( \left|A\right|=\left|B\right| \)&lt;/span&gt;, כמו האלגוריתם היעיל שהצגתי. זה לא הולך לקרות. אני כן הולך להפוך את &lt;span&gt;\( A \)&lt;/span&gt; למטריצה אחרת &lt;span&gt;\( B \)&lt;/span&gt;, אבל יהיו להן דטרמיננטות שונות לגמרי והרעיון הוא שבסיום האלגוריתם, &lt;span&gt;\( \left[B\right]_{nn} \)&lt;/span&gt; (הכניסה הימנית-תחתונה של &lt;span&gt;\( B \)&lt;/span&gt;) תהיה שווה ל-&lt;span&gt;\( \left|A\right| \)&lt;/span&gt;. יותר מכך - אין בעצם סיבה להציג את האלגוריתם בתור אוסף של שינויים של המטריצה &lt;span&gt;\( A \)&lt;/span&gt; (ובמאמר שלו עליו אני מתבסס כאן, Sylvester’s Identity and Multistep Integer Preserving Gaussian Elimination, בריס באמת לא מציג אותו ככה). אפשר לחשוב על האלגוריתם גם ככה: אם בהתחלה האיבר הכללי של &lt;span&gt;\( A \)&lt;/span&gt; הוא &lt;span&gt;\( a_{ij} \)&lt;/span&gt; (עבור &lt;span&gt;\( 1\le i,j\le n \)&lt;/span&gt;) אז האלגוריתם מייצר סדרה של איברים &lt;span&gt;\( a_{ij}^{\left(0\right)},a_{ij}^{\left(1\right)},\ldots a_{ij}^{\left(n-1\right)} \)&lt;/span&gt; כך שבסופו של דבר יוצא ש-&lt;span&gt;\( a_{nn}^{\left(n-1\right)}=\left|A\right| \)&lt;/span&gt;. ה”חזקה” של האיברים היא לא חזקה אלא אינדקס של השלב באלגוריתם שבו אנחנו נמצאים כרגע, והאתחול הוא &lt;span&gt;\( a_{ij}^{\left(0\right)}=a_{ij} \)&lt;/span&gt;. בפועל, כשמממשים את האלגוריתם, הכי נוח באמת לבצע שינויים מקומיים ב-&lt;span&gt;\( A \)&lt;/span&gt; כדי לשמור את המספרים של השלב הבא - זה חוסך זיכרון.&lt;/p&gt;

&lt;p&gt;אז איך עובד האלגוריתם? אין שום טעם להציג אותו כרגע כי לא נבין כלום ממה שהולך שם. זה לא הולך למנוע ממני להציג אותו בכל מקרה כי זה לפחות יוצר עניין - אני קודם כל מימשתי את האלגוריתם ורק אז תהיתי למה בעצם זה עובד. הרעיון, כאמור, הוא לעבוד בשלבים, כשבשלב מספר &lt;span&gt;\( k \)&lt;/span&gt; אנחנו מעדכנים את המספרים &lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; שעדיין רלוונטיים לנו (כמו בחישוב דטרמיננטה רגיל, ככל שמתקדמים בשלבים כך פחות ופחות איברים הופכים לרלוונטיים לנו.&lt;/p&gt;

&lt;p&gt;הנה האלגוריתם:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;אתחל את המשתנים &lt;span&gt;\( a_{ij}^{\left(0\right)}=a_{ij} \)&lt;/span&gt; לכל &lt;span&gt;\( 1\le i,j\le n \)&lt;/span&gt; ואת המשתנה המיוחד &lt;span&gt;\( a_{00}^{\left(-1\right)}=1 \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;לכל &lt;span&gt;\( k=1,2,\ldots,n-1 \)&lt;/span&gt;: &lt;/li&gt;
&lt;ul&gt;
&lt;li&gt;לכל &lt;span&gt;\( k+1\le i,j\le n \)&lt;/span&gt;, קבעו &lt;span&gt;\( a_{ij}^{\left(k\right)}\leftarrow\frac{a_{ij}^{\left(k-1\right)}a_{kk}^{\left(k-1\right)}-a_{ik}^{\left(k-1\right)}a_{kj}^{\left(k-1\right)}}{a_{k-1,k-1}^{\left(k-2\right)}} \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;/ul&gt;

&lt;li&gt;החזירו את &lt;span&gt;\( a_{nn}^{\left(n-1\right)} \)&lt;/span&gt;&lt;/li&gt;

&lt;p&gt;בקיצור, האלגוריתם די דומה למה שקורה באלגוריתם הרגיל - גם פה פשוט מעדכנים באופן סדרתי כניסות עם כל מני מכפלות וחיסורים ו… רגע… האם זה רק אני או שיש סימן &lt;strong&gt;חילוק&lt;/strong&gt; ענקי באמצע האלגוריתם? איך בדיוק פתרנו את הבעיה? ובכן, הרעיון הוא שבסימן החילוק שמופיע שם, המכנה מחלק את המונה &lt;strong&gt;בלי שארית&lt;/strong&gt;. במילים אחרות - אנחנו צריכים לבצע פעולת חילוק, אבל פעולת &lt;strong&gt;חילוק שלמים&lt;/strong&gt; שיכולה להיות מדויקת, ובשום שלב אנחנו לא צריכים לעבוד עם מספר שהוא שבר (אם תקראו את הפוסט עד כה תראו שנמנעתי בזהירות מלטעון דברים מופרכים כמו “האלגוריתם לא מבצע חילוק”).&lt;/p&gt;

&lt;p&gt;אוקיי, אבל למה זה עובד? במאמר שלו שעליו אני מתבסס כאן, בריס מביא טיעון לא טריוויאלי, שאולי היה אפשר להחליף בטיעונים אלמנטריים יותר (יש לבריס מאמר מוקדם יותר שבו יש טיעונים כאלו) אבל אני דווקא מאוד אוהב את הטכניקה שלו, אז בואו נראה אותה במלואה.&lt;/p&gt;

&lt;h2&gt;חלק שלישי שבו קורים קסמים עם מטריצות בלוקים&lt;/h2&gt;

&lt;p&gt;באלגוריתם שהצגתי, &lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; חושב באמצעות תרגיל מפוקפק כלשהו (שבמסגרתו הבטחתי שתתבצע חלוקה ללא שארית). זה לא ממש עוזר לנו להבין מה הולך פה, אז מה שנרצה לעשות הוא למצוא דרך טובה יותר &lt;strong&gt;להגדיר&lt;/strong&gt; את הערכים של אותם &lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; מלכתחילה. ההגדרה תיראה די משונה אם פשוט אציג אותה, אז בואו נוכיח תוצאה כללית כלשהי קודם.&lt;/p&gt;

&lt;p&gt;משהו שלא דיברתי עליו בכלל עד כה בפוסטים הללו הוא שדרך נוחה להתמודד עם מטריצות היא לפעמים לחלק אותן ל&lt;strong&gt;בלוקים&lt;/strong&gt;. כל מטריצה ריבועית &lt;span&gt;\( A \)&lt;/span&gt; מסדר &lt;span&gt;\( n\times n \)&lt;/span&gt; אפשר להציג בתור &lt;span&gt;\( A=\left(\begin{array}{cc} A_{11} &amp;amp; A_{12}\\ A_{21} &amp;amp; A_{22} \end{array}\right) \)&lt;/span&gt; כך ש-&lt;span&gt;\( A_{11} \)&lt;/span&gt; היא מטריצה מסדר &lt;span&gt;\( k\times k \)&lt;/span&gt; שכוללת את מה שמקבלים אם מעתיקים מ-&lt;span&gt;\( A \)&lt;/span&gt; את כל הכניסות מהצורה &lt;span&gt;\( a_{ij} \)&lt;/span&gt; עבור &lt;span&gt;\( 1\le i,j\le k \)&lt;/span&gt;. גם שאר המטריצות נקבעות בצורה דומה: &lt;span&gt;\( A_{12} \)&lt;/span&gt; תהיה מסדר &lt;span&gt;\( k\times\left(n-k\right) \)&lt;/span&gt;, &lt;span&gt;\( A_{21} \)&lt;/span&gt; תהיה מסדר &lt;span&gt;\( \left(n-k\right)\times k \)&lt;/span&gt; ו-&lt;span&gt;\( A_{22} \)&lt;/span&gt; תהיה מסדר &lt;span&gt;\( \left(n-k\right)\times\left(n-k\right) \)&lt;/span&gt;, אבל בואו נתמקד לרגע ב-&lt;span&gt;\( A_{11} \)&lt;/span&gt;. זו המטריצה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A_{11}=\left(\begin{array}{cccc} a_{11} &amp;amp; a_{12} &amp;amp; \cdots &amp;amp; a_{1k}\\ a_{21} &amp;amp; a_{22} &amp;amp;  &amp;amp; a_{2k}\\ \vdots &amp;amp;  &amp;amp; \ddots &amp;amp; \vdots\\ a_{k1} &amp;amp; a_{k2} &amp;amp; \cdots &amp;amp; a_{kk} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מטריצה כזו, שמתקבלת מ-&lt;span&gt;\( A \)&lt;/span&gt; על ידי לקיחת &lt;span&gt;\( k \)&lt;/span&gt; השורות והעמודות הראשונות ומחיקת כל היתר, נקראת לפעמים &lt;strong&gt;המינור העיקרי&lt;/strong&gt; (principle) מסדר &lt;span&gt;\( k \)&lt;/span&gt; של המטריצה. אני הולך להניח שהוא הפיך, כלומר &lt;span&gt;\( \left|A_{11}\right|\ne0 \)&lt;/span&gt;; בהמשך נראה מה קורה כשזה לא המצב (רמז: האלגוריתם שהצגתי קודם עדיין לא שלם). אם הוא לא הפיך, זה נותן לנו פירוק פשוט יחסית של &lt;span&gt;\( A \)&lt;/span&gt; למכפלה של שתי מטריצות בלוקים אלכסוניות:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( A=\left(\begin{array}{cc} A_{11} &amp;amp; A_{12}\\ A_{21} &amp;amp; A_{22} \end{array}\right)=\left(\begin{array}{cc} A_{11} &amp;amp; 0\\ A_{21} &amp;amp; I \end{array}\right)\left(\begin{array}{cc} I &amp;amp; A_{11}^{-1}A_{12}\\ 0 &amp;amp; A_{22}-A_{21}A_{11}^{-1}A_{12} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה הולך כאן? במבט ראשון זה נראה מבעית, אבל בעצם יש כאן שתי שאלות פשוטות יחסית:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;כשכופלים מטריצות בלוקים, האם חוקי כפל המטריצות הרגילים עדיין תקפים כמו קודם?&lt;/li&gt;


&lt;li&gt;אם מניחים שכן, האם החישוב של המכפלה למעלה באמת מחזיר את &lt;span&gt;\( A \)&lt;/span&gt;?&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;בואו נענה קודם לשאלה השניה - כמובן. כדי לוודא שאין בעיה עם זה, אני אחשב את כל ארבע הכניסות&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;הכניסה של &lt;span&gt;\( A_{11} \)&lt;/span&gt;: מתקבלת מכפל השורה הראשונה בעמודה הראשונה, כלומר &lt;span&gt;\( A_{11}\cdot I+0\cdot0=A_{11} \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;הכניסה של &lt;span&gt;\( A_{12} \)&lt;/span&gt;: מתקבלת מכפל השורה הראשונה בעמודה השניה, כלומר &lt;span&gt;\( A_{11}\cdot\left(A_{11}^{-1}A_{12}\right)+0\cdot\left(A_{22}-A_{21}A_{11}^{-1}A_{12}\right)=A_{12} \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;הכניסה של &lt;span&gt;\( A_{21} \)&lt;/span&gt;: מתקבלת מכפל השורה השניה בעמודה הראשונה, כלומר &lt;span&gt;\( A_{21}\cdot I+I\cdot0=A_{21} \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;הכניסה של &lt;span&gt;\( A_{22} \)&lt;/span&gt;: מתקבלת מכפלה השורה השניה בעמודה השניה, כלומר &lt;span&gt;\( A_{21}\cdot A_{11}^{-1}A_{12}+I\cdot A_{22}-A_{21}A_{11}^{-1}A_{12}=A_{22} \)&lt;/span&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;כל זה אולי נראה קצת מהונדס מדי כדי שהכל יעבוד, אבל זה כמובן עובד. השאלה היותר מהותית היא למה בכלל מותר לכפול מטריצות בלוקים - וכמו הרבה דברים באלגברה לינארית בסיסית זו תוצאה שאני גם מניח שכולנו מכירים והיא גם די טכנית להוכחה, אז אני לא אוכיח אותה כאן אבל אין כאן חוכמה מיוחדת - אם אתם סקפטיים, נסו להוכיח אותה על שתי מטריצות קטנות קונקרטיות ותראו מה קורה.&lt;/p&gt;

&lt;p&gt;עכשיו, מה שנחמד בפירוק המוזר הזה של &lt;span&gt;\( A \)&lt;/span&gt; למכפלה של שתי מטריצות בלוקים הוא שזה ממשיך לעבוד כשלוקחים &lt;strong&gt;דטרמיננטה&lt;/strong&gt;. כזכור, דטרמיננטה של מכפלה היא מכפלת הדטרמיננטות; וכשיש לנו מטריצת בלוקים &lt;span&gt;\( \left(\begin{array}{cc} A &amp;amp; 0\\ C &amp;amp; D \end{array}\right) \)&lt;/span&gt; הדטרמיננטה שלה היא &lt;span&gt;\( \left|A\right|\left|D\right| \)&lt;/span&gt; (ובאופן דומה כשה-0 הוא במקום &lt;span&gt;\( C \)&lt;/span&gt;), כך שנקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left|A\right|=\left|\left(\begin{array}{cc} A_{11} &amp;amp; 0\\ A_{21} &amp;amp; I \end{array}\right)\right|\left|\left(\begin{array}{cc} I &amp;amp; A_{11}^{-1}A_{12}\\ 0 &amp;amp; A_{22}-A_{21}A_{11}^{-1}A_{12} \end{array}\right)\right|= \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left|A_{11}\right|\left|A_{22}-A_{21}A_{11}^{-1}A_{12}\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עכשיו משתמשים בטריק: כופלים את שני האגפים בסקלר &lt;span&gt;\( \left|A_{11}\right|^{n-k-1} \)&lt;/span&gt; ומקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left|A_{11}\right|^{n-k-1}\left|A\right|=\left|\left|A_{11}\right|\left(A_{22}-A_{21}A_{11}^{-1}A_{12}\right)\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;זה יכול להיות די מבלבל, הנה מה שקרה פה: באופן כללי, אם יש לי מטריצה &lt;span&gt;\( B \)&lt;/span&gt; ואני כופל שורה כלשהי שלה בסקלר, זה מכפיל את כל הדטרמיננטה באותו סקלר. כדי להוכיח את זה אפשר להשתמש באותה טכניקה שראינו בפוסט הקודם: כפל שורה בסקלר זה כמו כפל במטריצת יחידה &lt;span&gt;\( I \)&lt;/span&gt; שאחד מה-1-ים על האלכסון שלה הוחלף בסקלר הבודד &lt;span&gt;\( \lambda \)&lt;/span&gt;, והדטרמיננטה של מטריצה כזו היא &lt;span&gt;\( \lambda \)&lt;/span&gt; כי היא הרי מכפלת הערכים על האלכסון.&lt;/p&gt;

&lt;p&gt;עכשיו, מה קורה אם כופלים את &lt;strong&gt;כל&lt;/strong&gt; השורות של &lt;span&gt;\( B \)&lt;/span&gt; באותו סקלר, כלומר אם פשוט כפלנו את כל המטריצה &lt;span&gt;\( B \)&lt;/span&gt; בסקלר הזה? אם &lt;span&gt;\( B \)&lt;/span&gt; היא מטריצה מסדר &lt;span&gt;\( n\times n \)&lt;/span&gt; זה אומר שכפלנו את הדטרמיננטה &lt;span&gt;\( n \)&lt;/span&gt; פעמים בסקלר &lt;span&gt;\( \lambda \)&lt;/span&gt;, אז יש לנו את המשוואה &lt;span&gt;\( \left|\lambda B\right|=\lambda^{n}\left|B\right| \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אם נחזור עכשיו למה שעשינו למעלה - יש לנו את המטריצה &lt;span&gt;\( B=A_{22}-A_{21}A_{11}^{-1}A_{12} \)&lt;/span&gt;. הסדר של המטריצה הזו הוא &lt;span&gt;\( \left(n-k\right)\times\left(n-k\right) \)&lt;/span&gt; ולכן &lt;span&gt;\( \lambda^{n-k}\left|B\right|=\left|\lambda B\right| \)&lt;/span&gt;. אצלנו &lt;span&gt;\( \lambda=\left|A_{11}\right| \)&lt;/span&gt;, ואנחנו מקבלים אותו בחזקת &lt;span&gt;\( n-k \)&lt;/span&gt; כי בהתחלה הוא הופיע פעם אחת באגף ימין ואז כפלנו ב-&lt;span&gt;\( \lambda^{n-k-1} \)&lt;/span&gt;. זה מסביר את המעבר הזה.&lt;/p&gt;

&lt;h2&gt;חלק רביעי, שבו אנו חוזים בשובם של המספרים מהאלגוריתם&lt;/h2&gt;

&lt;p&gt;עכשיו הגענו לקאץ’: אני אראה שהאיברים של המטריצה &lt;span&gt;\( \left|A_{11}\right|\left(A_{22}-A_{21}A_{11}^{-1}A_{12}\right) \)&lt;/span&gt; שאליה הגענו הם בעצם ה-&lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; שמופיעים בשלבי הביניים של האלגוריתם. ראשית, בואו נגדיר את ה-&lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; הללו במפורש, מה שעד כה נמנעתי מלעשות:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{ij}^{\left(k\right)}=\left|\begin{array}{ccccc} a_{11} &amp;amp; a_{12} &amp;amp; \cdots &amp;amp; a_{1k} &amp;amp; a_{1j}\\ a_{21} &amp;amp; a_{22} &amp;amp; \cdots &amp;amp; a_{2k} &amp;amp; a_{2j}\\ \cdots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots\\ a_{k1} &amp;amp; a_{k2} &amp;amp; \cdots &amp;amp; a_{kk} &amp;amp; a_{kj}\\ a_{i1} &amp;amp; a_{i1} &amp;amp; \cdots &amp;amp; a_{ik} &amp;amp; a_{ij} \end{array}\right| \)&lt;/span&gt; עבור &lt;span&gt;\( k&amp;lt;i,j\le n \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה קורה פה? ראשית לוקחים את המטריצה &lt;span&gt;\( A_{11} \)&lt;/span&gt; שמתקבלת מ-&lt;span&gt;\( A \)&lt;/span&gt; המקורית על ידי לקיחת &lt;span&gt;\( k \)&lt;/span&gt; השורות והעמודות הראשונות. עכשיו, מוסיפים שורה חדשה - את שורה מס’ &lt;span&gt;\( i \)&lt;/span&gt;, כאשר &lt;span&gt;\( k&amp;lt;i \)&lt;/span&gt; כלומר זו אחת מהשורות שלא הופיעו במטריצה קודם. אנחנו לא מוסיפים את כל השורה אלא רק את &lt;span&gt;\( k \)&lt;/span&gt; העמודות הראשונות שלה. אחר כך אנחנו מוסיפים עמודה &lt;span&gt;\( j \)&lt;/span&gt; כך ש-&lt;span&gt;\( k&amp;lt;j \)&lt;/span&gt; וגם כאן - לא את כל העמודה, רק את &lt;span&gt;\( k \)&lt;/span&gt; השורות הראשונות שלה. לסיום, אחרי שהוספנו את השורה והעמודה עוד נותר מקום ריק אחד בקצה הימני-תחתון של המטריצה, ושם אנחנו שמים את &lt;span&gt;\( ij \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;למה&lt;/strong&gt; שנגדיר ככה? במאמר המקורי שלו בריס מגיע אל המטריצה הזו בדרך שונה וטכנית יותר - אני דווקא מעדיף את הדרך שבה נוקטים כאן, למרות שהיא נראית כמו קסם (במתמטיקה אין קסמים; כל הגדרה קסומה מגיעה אחרי שמישהו שבר את הראש על הבעיה הרבה זמן וניסה הרבה דברים).&lt;/p&gt;

&lt;p&gt;עכשיו, הדטרמיננטה הזו נראית קצת מפחידה אבל כבר ראינו דרך להתמודד איתה - אם שמים לב שיש לנו כאן דטרמיננטה של &lt;strong&gt;מטריצת בלוקים&lt;/strong&gt;. הבלוקים הם בדיוק ארבעת הדברים שתיארתי: המטריצה &lt;span&gt;\( A_{11} \)&lt;/span&gt; שממנה מתחילים, השורה שהוספתי למטה, העמודה שהוספתי משמאל, וה-&lt;span&gt;\( a_{ij} \)&lt;/span&gt; שהוספתי למטה. כלומר יש לנו כאן את מטריצת הבלוקים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B=\left(\begin{array}{cc} B_{11} &amp;amp; B_{12}\\ B_{21} &amp;amp; B_{22} \end{array}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כך ש-&lt;span&gt;\( B_{11}=A_{11} \)&lt;/span&gt;, &lt;span&gt;\( B_{12}=\left(a_{1j},\ldots,a_{kj}\right)^{t},B_{21}=\left(a_{i1},\ldots,a_{ik}\right) \)&lt;/span&gt; ו-&lt;span&gt;\( B_{22}=\left(a_{ij}\right) \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;ראינו את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left|B\right|=\left|B_{11}\right|\left|B_{22}-B_{21}B_{11}^{-1}B_{12}\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאן &lt;span&gt;\( \left|B\right|=a_{ij}^{\left(k\right)} \)&lt;/span&gt; כי &lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; הוגדר בתור הדטרמיננטה של המטריצה הזו. קצת יותר מעניין מה זה &lt;span&gt;\( B_{21}B_{11}^{-1}B_{12} \)&lt;/span&gt; - זה כפל של מטריצה (&lt;span&gt;\( A_{11}^{-1} \)&lt;/span&gt;) במטריצת עמודה מימין ומטריצת שורה משמאל - התוצאה היא סקלר, וחישוב ישיר על פי ההגדרה של כפל מטריצות נותן ש-&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( B_{21}B_{11}^{-1}B_{12}=\sum_{r=1}^{k}\sum_{s=1}^{k}a_{ir}\left[A_{11}^{-1}\right]_{rs}a_{sj} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולכן משילוב כל הדברים הללו אנחנו מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{ij}^{\left(k\right)}=\left|A_{11}\right|\left(a_{ij}-\sum_{r=1}^{k}\sum_{s=1}^{k}a_{ir}\left[A_{11}^{-1}\right]_{rs}a_{sj}\right) \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה שיש לנו באגף שמאל הוא בדיוק את האיבר ה-&lt;span&gt;\( ij \)&lt;/span&gt; של המטריצה &lt;span&gt;\( \left|A_{11}\right|\left(A_{22}-A_{21}A_{11}^{-1}A_{12}\right) \)&lt;/span&gt;, אם כי צריך קצת להיזהר עם האינדקסים כדי לראות את זה כי המטריצה הזו &lt;strong&gt;מתחילה&lt;/strong&gt; לא מהאינדקס &lt;span&gt;\( 1,1 \)&lt;/span&gt; אלא מהאינדקס &lt;span&gt;\( k+1,k+1 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;איך זה עוזר לנו? ובכן, קודם כל שימו לב שכמו שאמרתי קודם - המינורים העיקריים של &lt;span&gt;\( A \)&lt;/span&gt; מתקבלים ככה. ממש על פי ההגדרה, מתקיים &lt;span&gt;\( \left|A_{11}\right|=a_{kk}^{\left(k-1\right)} \)&lt;/span&gt;, כי &lt;span&gt;\( A_{11} \)&lt;/span&gt; מתקבלת מלקיחת &lt;span&gt;\( k \)&lt;/span&gt; השורות והעמודות הראשונות ואילו המטריצה שבה משתמשים לחישוב &lt;span&gt;\( a_{kk}^{\left(k-1\right)} \)&lt;/span&gt; מתקבלת מלקיחת &lt;span&gt;\( k-1 \)&lt;/span&gt; השורות והעמודות הראשונות ואז הוספה אליהן של השורה והעמודה הבאות בתור.&lt;/p&gt;

&lt;p&gt;לכן אני יכול ללכת אל הנוסחה שהוכחתי קודם:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left|A_{11}\right|^{n-k-1}\left|A\right|=\left|\left|A_{11}\right|\left(A_{22}-A_{21}A_{11}^{-1}A_{12}\right)\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ולהציב בתוכה את &lt;span&gt;\( \left|A_{11}\right|=a_{kk}^{\left(k-1\right)} \)&lt;/span&gt; מצד אחד, ואילו בצד השני יש לנו כאמור את המטריצה &lt;span&gt;\( \left|A_{11}\right|\left(A_{22}-A_{21}A_{11}^{-1}A_{12}\right) \)&lt;/span&gt; שהאיברים שלה הם בדיוק ה-&lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; עבור &lt;span&gt;\( k&amp;lt;i,j\le n \)&lt;/span&gt;, ולכן קיבלנו את הנוסחה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left|A\right|\left[a_{kk}^{\left(k-1\right)}\right]^{n-k-1}=\left|\begin{array}{ccc} a_{k+1,k+1}^{\left(k\right)} &amp;amp; \cdots &amp;amp; a_{k+1,n}^{\left(k\right)}\\ \cdots &amp;amp; \cdots &amp;amp; \cdots\\ a_{n,k+1}^{\left(k\right)} &amp;amp; \cdots &amp;amp; a_{n,n}^{\left(k\right)} \end{array}\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;את הנוסחה הזו הוכחנו לכל מטריצה &lt;span&gt;\( A \)&lt;/span&gt; (עם ההנחה שהמינור העיקרי שלה, מה שסימנתי ב-&lt;span&gt;\( A_{11} \)&lt;/span&gt;, הוא מדטרמיננטה שונה מאפס), אז אפשר להשתמש בה גם עבור המטריצה שאיתה הגדרנו את &lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt;, כלומר המטריצה שמורכבת מהמינור העיקרי &lt;span&gt;\( A_{11} \)&lt;/span&gt; ואז עוד שורה ועמודה. צריך קצת להיזהר עם האינדקסים: עד עכשיו השתמשתי ב-&lt;span&gt;\( k \)&lt;/span&gt; כדי לציין אינדקס כלשהו, &lt;span&gt;\( 1\le k\le n \)&lt;/span&gt; שמתאים למינור העיקרי שבו מטפלים באותו הרגע, אבל עכשיו כשאני רוצה להשתמש בנוסחה הזו כדי לטפל ב-&lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; ולכן יש לי חופש בחירה של המינור העיקרי &lt;strong&gt;שלו&lt;/strong&gt; שאנחנו בוחרים, צריך להשתמש באינדקס אחר - במאמר שלו ברייס משתמש ב-&lt;span&gt;\( l \)&lt;/span&gt;, ואז מקבלים&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{ij}^{\left(k\right)}\left[a_{ll}^{\left(l-1\right)}\right]^{\left(k+1\right)-l-1}=\left|\begin{array}{cccc} a_{l+1,l+1}^{\left(l\right)} &amp;amp; \cdots &amp;amp; a_{l+1,k}^{\left(l\right)} &amp;amp; a_{l+1,j}^{\left(l\right)}\\ \cdots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots\\ a_{k,l+1}^{\left(l\right)} &amp;amp; \cdots &amp;amp; a_{k,k}^{\left(l\right)} &amp;amp; a_{k,j}^{\left(l\right)}\\ a_{i,l+1}^{\left(l\right)} &amp;amp; \cdots &amp;amp; a_{i,k}^{\left(l\right)} &amp;amp; a_{i,j}^{\left(l\right)} \end{array}\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הסיבה לכך שיש &lt;span&gt;\( k+1 \)&lt;/span&gt; בחזקה באגף שמאל הוא שזה הסדר של המטריצה שמגדירה את &lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; (כי לקחנו מטריצה &lt;span&gt;\( k\times k \)&lt;/span&gt; והוספנו לה שורה ועמודה). השינוי באיך שאני מציג את האיברים בתוך הדטרמיננטה באגף ימין (עוד שורה ועמודה) הוא רק כדי שיהיה יותר קל להבין מה קורה, בגלל שהמבנה של השורה והעמודה האחרונות במטריצה הוא שונה מאשר עבור יתר הכניסות.&lt;/p&gt;

&lt;p&gt;עכשיו, תחת ההנחה שלנו על כך שהדטרמיננטה של המינורים העיקריים היא לא אפס אנחנו מקבלים ש-&lt;span&gt;\( a_{ll}^{\left(l-1\right)} \)&lt;/span&gt; הוא לא אפס (כי הוא שווה למינור עיקרי שכזה) ולכן אפשר לחלק בו ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{ij}^{\left(k\right)}=\frac{1}{\left[a_{ll}^{\left(l-1\right)}\right]^{k-l}}\left|\begin{array}{cccc} a_{l+1,l+1}^{\left(l\right)} &amp;amp; \cdots &amp;amp; a_{l+1,k}^{\left(l\right)} &amp;amp; a_{l+1,j}^{\left(l\right)}\\ \cdots &amp;amp; \cdots &amp;amp; \cdots &amp;amp; \cdots\\ a_{k,l+1}^{\left(l\right)} &amp;amp; \cdots &amp;amp; a_{k,k}^{\left(l\right)} &amp;amp; a_{k,j}^{\left(l\right)}\\ a_{i,l+1}^{\left(l\right)} &amp;amp; \cdots &amp;amp; a_{i,k}^{\left(l\right)} &amp;amp; a_{i,j}^{\left(l\right)} \end{array}\right| \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;וזה נותן לנו דרך לחשב רקורסיבית את ה-&lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt;-ים! נזכיר את תנאי ההתחלה שלנו:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{00}^{\left(-1\right)}=1,a_{ij}^{\left(0\right)}=a_{ij} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;ובנוסחה למעלה, כדי לצמצם כמה שרק ניתן את הגודל של הדטרמיננטה אפשר לבחור &lt;span&gt;\( l=k-1 \)&lt;/span&gt; ולקבל&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( a_{ij}^{\left(k\right)}=\frac{1}{a_{k-1,k-1}^{\left(k-2\right)}}\left|\begin{array}{cc} a_{kk}^{\left(k-1\right)} &amp;amp; a_{kj}^{\left(k-1\right)}\\ a_{ik}^{\left(k-1\right)} &amp;amp; a_{ij}^{\left(k-1\right)} \end{array}\right|=\frac{a_{ij}^{\left(k-1\right)}a_{kk}^{\left(k-1\right)}-a_{ik}^{\left(k-1\right)}a_{kj}^{\left(k-1\right)}}{a_{k-1,k-1}^{\left(k-2\right)}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשהשוויון האחרון נובע פשוט מחישוב ישיר של הדטרמיננטה. זה משלים את ההוכחה, כי קיבלנו בדיוק את הנוסחה שהופיעה באלגוריתם, ועכשיו אנחנו גם מבינים למה החלוקה ב-&lt;span&gt;\( a_{k-1,k-1}^{\left(k-2\right)} \)&lt;/span&gt; “מצליחה” ואנחנו מקבלים מספר שלם - כי &lt;span&gt;\( a_{ij}^{\left(k\right)} \)&lt;/span&gt; מלכתחילה הוגדר בתור דטרמיננטה של מטריצה שמכילה רק מספרים שלמים (זאת בהנחה שהמטריצה המקורית הכילה רק שלמים) ולכן אם יש שבר ששווה לו, המכנה חייב לחלק את המונה.&lt;/p&gt;

&lt;h2&gt;חלק חמישי ואחרון, שבו אנו מגיעים לגרסה המלאה של האלגוריתם&lt;/h2&gt;

&lt;p&gt;יפה, אז ראינו את ההוכחה לכך שהאלגוריתם הבא עובד:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;אתחל את המשתנים &lt;span&gt;\( a_{ij}^{\left(0\right)}=a_{ij} \)&lt;/span&gt; לכל &lt;span&gt;\( 1\le i,j\le n \)&lt;/span&gt; ואת המשתנה המיוחד &lt;span&gt;\( a_{00}^{\left(-1\right)}=1 \)&lt;/span&gt;.&lt;/li&gt;


&lt;li&gt;לכל &lt;span&gt;\( k=1,2,\ldots,n-1 \)&lt;/span&gt;:&lt;/li&gt;
&lt;ul&gt;
&lt;li&gt;לכל &lt;span&gt;\( k+1\le i,j\le n \)&lt;/span&gt;, קבעו &lt;span&gt;\( a_{ij}^{\left(k\right)}\leftarrow\frac{a_{ij}^{\left(k-1\right)}a_{kk}^{\left(k-1\right)}-a_{ik}^{\left(k-1\right)}a_{kj}^{\left(k-1\right)}}{a_{k-1,k-1}^{\left(k-2\right)}} \)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/ul&gt;

&lt;li&gt;החזירו את &lt;span&gt;\( a_{nn}^{\left(n-1\right)} \)&lt;/span&gt;&lt;/li&gt;

&lt;p&gt;עכשיו, מהנוסחה הזו ברור שאם אנחנו בשלב &lt;span&gt;\( k \)&lt;/span&gt;, אז כל הערכים במטריצה שהשורה או העמודה שלהם היא לכל היותר &lt;span&gt;\( k \)&lt;/span&gt; כבר לא מעניינים אותנו, למעט האיבר במקום &lt;span&gt;\( k-1,k-1 \)&lt;/span&gt; - אבל גם עבורו, אנחנו נצטרך רק &lt;strong&gt;לקרוא&lt;/strong&gt; את הערך שלו ולא נשנה אותו יותר. זה אומר שאם אנחנו מקבלים את המטריצה כקלט, אז בשביל לחסוך מקום אפשר לשמור את ערכי הביניים &lt;strong&gt;בתוכה&lt;/strong&gt; (אם לא מפריע לנו שהיא תשתנה; אם לא נרצה שהפונקציה תשפיע על המטריצה המקורית יהיה צורך ליצור עותק שלה, אבל גם אז עדיף עותק אחד על סביבות &lt;span&gt;\( n \)&lt;/span&gt; עותקים כאלו).&lt;/p&gt;

&lt;p&gt;אם נוקטים בגישה הזו, זה מה שהאלגוריתם הופך להיות:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;אתחלו את המשתנה &lt;span&gt;\( A_{00}=1 \)&lt;/span&gt;&lt;/li&gt;


&lt;li&gt;לכל &lt;span&gt;\( k=1,2,\ldots,n-1 \)&lt;/span&gt;:&lt;/li&gt;
&lt;ul&gt;

&lt;li&gt;לכל &lt;span&gt;\( k+1\le i,j\le n \)&lt;/span&gt;, קבעו &lt;span&gt;\( A_{ij}\leftarrow\frac{A_{ij}A_{kk}-A_{ik}A_{kj}}{A_{k-1,k-1}} \)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/ul&gt;

&lt;li&gt;החזירו את &lt;span&gt;\( A_{n-1,n-1} \)&lt;/span&gt;&lt;/li&gt;

&lt;p&gt;בפועל כשכותבים קוד לא כזה כיף להוסיף משתנה &lt;span&gt;\( A_{00} \)&lt;/span&gt; כי צריך קוד מיוחד לטפל בו ולא במטריצה &lt;span&gt;\( A \)&lt;/span&gt;, ולכן הרבה יותר פשוט לבדוק אם &lt;span&gt;\( k=1 \)&lt;/span&gt; ואם כן - פשוט לוותר על פעולת החילוק באיטרציה הזו של האלגוריתם. בקוד שאצרף עוד רגע אפשר יהיה לראות את זה.&lt;/p&gt;

&lt;p&gt;יש רק דבר אחד שטרם התייחסתי אליו - מה קורה אם אחד מהמינורים העיקריים הוא עם דטרמיננטה 0? במקרה הזה, החישוב יניב בשלב כלשהו &lt;span&gt;\( A_{kk}=0 \)&lt;/span&gt; ואי אפשר יהיה לחלק בו. בסיטואציה הזו עושים דבר דומה למה שהיה באלגוריתם ה”רגיל” לדטרמיננטה - מחפשים בעמודה ה-&lt;span&gt;\( k \)&lt;/span&gt;-ית החל מהשורה ה-&lt;span&gt;\( k+1 \)&lt;/span&gt; כניסה ששונה מאפס, ואם נמצאה כזו - מחליפים את השורות ומכפילים את הסימן של הדטרמיננטה ב-&lt;span&gt;\( -1 \)&lt;/span&gt;. זה האלגוריתם המלא (שימו לב שבפייתון // מייצג חילוק בשלמים - כלומר, חילוק שמתעלם מהשארית, אם יש כזו, ומחזיר רק את המנה השלמה):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bareiss_det&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;</content><author><name></name></author><category term="דטרמיננטה" /><summary type="html">חלק ראשון, שבו אנחנו לומדים שמינוס 32 הוא כמעט 256</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">האם רוב המספרים הראשוניים הם קטנים?</title><link href="http://gadial.net/2024/12/10/are_most_prime_numbers_small/" rel="alternate" type="text/html" title="האם רוב המספרים הראשוניים הם קטנים?" /><published>2024-12-10T00:00:00+00:00</published><updated>2024-12-10T00:00:00+00:00</updated><id>http://gadial.net/2024/12/10/are_most_prime_numbers_small</id><content type="html" xml:base="http://gadial.net/2024/12/10/are_most_prime_numbers_small/">&lt;h2&gt;חלק ראשון, ובו כמעט הכל ממש ממש ממש גדול&lt;/h2&gt;

&lt;p&gt;כשאני רואה דיונים נרגשים על מתמטיקה ברשתות חברתיות, זה לרוב בגלל שמישהו זרק פצצת סירחון וברח והשאיר אנשים לריב אחד עם השני על טיב הריח. הפצצה האהובה ביותר היא הביטוי &lt;span&gt;\( 6\div2\left(1+2\right) \)&lt;/span&gt; הידוע לשמצה (&lt;a href=&quot;https://gadial.net/2011/05/02/damn_stupid_equation/&quot;&gt;יש לי על זה פוסט&lt;/a&gt;) אבל נתקלתי עכשיו בפצצה מסוג קצת שונה שכבר הכתה גלים - השאלה האם המשפט “רוב המספרים הראשוניים הם קטנים” הוא אמת או שקר.&lt;/p&gt;

&lt;p&gt;לפני שמתחילים בכלל לדבר על זה צריך להתחיל מלציין את המובן מאליו: השאלה הזו היא &lt;strong&gt;הטרלה&lt;/strong&gt; במובן הקלאסי ביותר של המילה - סוג של התחכמות או פרובוקציה שהמטרה שלה לגרום לאנשים להתרגז, לריב אחד עם השני או להגיד שטויות בזמן שהמטריל יכול להיתמם שהוא סך הכל ניסה לעורר דיון פורה. חברים, זו לא הדרך לעורר דיון פורה. זו הדרך לגרום לאנשים לשלוף תשובות סותרות ולריב אחד עם השני עליהן למרות שהשורה התחתונה היא שכולם צודקים כי אין פה תשובה חד משמעית. המשפט “רוב המספרים הראשוניים הם קטנים” הוא לא אמת ולא שקר, אין לו ערך אמת מוגדר כי באופן ממש לא מפתיע, ערך האמת של פסוקים תלוי בשאלה מה המשמעות שאנחנו נותנים למושגים שמופיעים בהם, והמושג &lt;strong&gt;קטן&lt;/strong&gt; כאן הוא לחלוטין לא מוגדר היטב.&lt;/p&gt;

&lt;p&gt;אבל פצצות כאלו הן גם הזדמנות - לא לריב עם אף אחד, אלא לכתוב פוסט שמציג כמה מהדרכים השונות לפרש את השאלה הזו ולראות איזו פיסת מתמטיקה מעניינת נחשפת אלינו בזכותן. זה מה שאני אנסה לעשות פה - אבל בשום פנים ואופן לא בצורה שתתיימר להיות מקיפה. אני בסך הכל נותן כמה מהאסוציאציות &lt;strong&gt;שלי&lt;/strong&gt; שהשאלה הזו מעוררת.&lt;/p&gt;

&lt;p&gt;בואו נתחיל מההתחלה. &lt;strong&gt;מספר ראשוני&lt;/strong&gt; הוא מספר טבעי גדול מ-1 שמתחלק רק ב-1 ובעצמו, למשל 2 או 31. &lt;a href=&quot;https://gadial.net/2017/11/27/why_1_is_not_prime/&quot;&gt;יש לי פוסט&lt;/a&gt; שמסביר למה ראשוניים הם מעניינים ולמה 1 לא נחשב ראשוני אז לא אחזור על זה כאן, אבל בגדול - אם רוצים לדבר על קבוצה כלשהי של מספרים טבעיים שהיא לא ממש בנאלית (למשל, “המספרים הזוגיים”) אז הראשוניים זו הדוגמא הכי מתבקשת ואני מניח שלכן השתמשו בה בשאלה הזו.&lt;/p&gt;

&lt;p&gt;עכשיו, תכונה בסיסית של ראשוניים היא שיש &lt;strong&gt;אינסוף&lt;/strong&gt; מהם. הדרך הפשוטה לראות את זה מלווה אותנו עוד מימי אוקלידס, שהציג את ההוכחה הזו לראשונה: בואו ניקח קבוצה סופית כלשהי של ראשוניים, &lt;span&gt;\( \left\{ p_{1},p_{2},\ldots,p_{k}\right\}  \)&lt;/span&gt;. מכיוון שיש לנו מספר &lt;strong&gt;סופי&lt;/strong&gt; של ראשוניים, אפשר לכפול את כולם ולהוסיף 1 ולקבל מספר &lt;span&gt;\( n=p_{1}p_{2}\ldots p_{k}+1 \)&lt;/span&gt;. המספר הזה לא מתחלק באף אחד מהראשוניים בקבוצה (לחלק בכל אחד מהם מחזיר שארית 1 בגלל ה-1 שהוספתי) ולכן אם אני אפרק את &lt;span&gt;\( n \)&lt;/span&gt; לגורמים אני אמצא ראשוניים חדשים שלא היו שייכים לקבוצה. למשל, אם הקבוצה שלי היא &lt;span&gt;\( \left\{ 2,3,5\right\}  \)&lt;/span&gt; אז אני אקבל &lt;span&gt;\( n=2\cdot3\cdot5+1=31 \)&lt;/span&gt; וכבר &lt;span&gt;\( n \)&lt;/span&gt; עצמו הוא ראשוני “חדש”; אם לעומת זאת הקבוצה היא &lt;span&gt;\( \left\{ 2,3,5,7,11,13\right\}  \)&lt;/span&gt; אז אחרי כפל והוספת 1 אני אקבל את &lt;span&gt;\( n=30,031 \)&lt;/span&gt; שהוא לא ראשוני כי הוא שווה &lt;span&gt;\( 59\cdot509 \)&lt;/span&gt;, אבל שני הגורמים הללו הם כן ראשוניים אז מצאתי את הראשוניים החדשים 59 ו-509. המסקנה: אין מספר סופי של ראשוניים, כי לכל קבוצה סופית של ראשוניים תמיד אפשר למצוא ראשוני שלא שייך אליה.&lt;/p&gt;

&lt;p&gt;מכיוון שיש אינסוף ראשוניים, התחושה המיידית היא שנכון לומר שרוב הראשוניים הם גדולים כי “רוב המספרים הם גדולים”. יש אפילו “משפט” שאומר את זה, שמכונה “המשפט המגוחך של האריתמטיקה” שמופיע בספר Field Guide to Simple Graphs של Steinbach - הטענה ש”כמעט כל המספרים הטבעיים הם מאוד מאוד מאוד גדולים”. הרעיון פה הוא ש”כמעט כל” הוא מונח טכני מדויק: הוא אומר “כל הטבעיים פרט למספר סופי”, תוך שימוש בכך שיש אינסוף טבעיים אז אם מורידים מתוכם כמות סופית, עדיין נשארים עם אינסוף. אפשר לצקת תוכן למשפט בשתי דרכים שונות: ראשית, אפשר להניח שהמספרים הטבעיים מתחלקים איכשהו ל”קטנים” ו”גדולים” ויש מספר שרירותי, נאמר &lt;span&gt;\( N \)&lt;/span&gt;, שהחל ממנו ה”גדולים” מתחילים (או אפילו ה”מאוד מאוד מאוד גדולים” אם רוצים לשמור על נאמנות לניסוח של המשפט). אז אם נסתכל על קבוצת כל הטבעיים שגדולים מ-&lt;span&gt;\( N \)&lt;/span&gt;, כל האיברים בקבוצה הזו הם מאוד מאוד מאוד גדולים, ואילו איברים שלא גדולים מ-&lt;span&gt;\( N \)&lt;/span&gt; יש רק במספר סופי, ולכן באמת כמעט כל הטבעיים הם מאוד מאוד מאוד גדולים.&lt;/p&gt;

&lt;p&gt;את אותו רעיון בדיוק אפשר להחיל גם על הראשוניים. להגיד “אין לי מושג מה זה מספר קטן או גדול אבל יש איזה שהוא &lt;span&gt;\( N \)&lt;/span&gt; שהחל ממנו כל המספרים הם גדולים, ובגלל שיש אינסוף ראשוניים אז יש אינסוף ראשוניים שגדולים מ-&lt;span&gt;\( N \)&lt;/span&gt; ולכן רוב הראשוניים הם גדולים”. זו טענה סבירה בהחלט, והתלונה המרכזית שלי אליה היא שזו לא טענה כל כך &lt;strong&gt;מעניינת&lt;/strong&gt;; התוכן המתמטי שבא בה לידי ביטוי הוא רק האבחנה שיש אינסוף ראשוניים - וזו אבחנה די מעניינת בפני עצמה, אבל אנחנו רק מגרדים איתה את השטח של מה שאפשר לומר על ראשוניים, זה הבסיס של הבסיס. אז לעצור כאן? ממש חבל.&lt;/p&gt;

&lt;p&gt;בואו נחזור אל הטענה המקורית: “רוב המספרים הראשוניים הם קטנים”. יש כאן בעצם שלושה מושגים מתמטיים בפעולה. על אחד מהם, “מספרים ראשוניים”, אין ויכוח - כולנו יודעים מה הם מספרים ראשוניים ואיך הם מוגדרים. שני המושגים האחרים - “רוב” ו”קטנים” הם חסרי משמעות מתמטית קונקרטית. “קטנים” הוא מושג נטול הגדרה מתמטית קונקרטית כלשהי; ו”רוב” אמנם נשמע לנו כמו משהו טריוויאלי מבחינה מתמטית אבל הוא הרבה יותר ערמומי ממה שנראה במבט ראשון. למשל, האם “רוב” המספרים הטבעיים הם ריבועים של מספר טבעי (למשל &lt;span&gt;\( 1,4,9,16,\dots \)&lt;/span&gt;) או לא? לכאורה רוב המספרים הטבעיים הם לא כאלו (למשל בין 9 ו-16 יש לנו את המספרים 10,11,12,13,14,15 - לא פחות משישה מספרים שאינם כאלו) אבל מצד שני כבר גלילאו שם לב לכך שיש התאמה חד-חד-ערכית ועל בין ריבועים של מספרים טבעיים ובין הטבעיים, כך שבמובן מסויים יש את אותה כמות של שניהם (במתמטית אנחנו אומרים שיש כאן &lt;strong&gt;שוויון עוצמות&lt;/strong&gt; של שתי קבוצות אינסופיות). בקיצור, אני מבקש שננסה לשכוח את האינטואיציות היומיומיות שלנו לגבי “קטן” ו”רוב” וננסה לבנות אותן מחדש בזהירות, כמו שעושים הרבה פעמים במתמטיקה.&lt;/p&gt;

&lt;p&gt;בואו נחזור למשפט המגוחך של האריתמטיקה, “כמעט כל המספרים הטבעיים הם מאוד מאוד מאוד גדולים”. אמרתי שאפשר לצקת אל המשפט הזה תוכן בשתי דרכים שונות. דרך אחת התבססה על זה שהמספרים הטבעיים הם אינסופיים, אבל הדרך השניה יכולה לומר - עזבו אותנו מאינסוף טבעיים. זה לא משהו אמיתי. זה לא משהו שאנחנו יודעים לתפוס בידיים. יש גבול לכמות המספרים שנוכל לייצג ביקום - אפילו אם נגייס את כל האטומים למשימת ייצוג מספר, בסוף יהיה מספר שהוא גדול מכדי שנוכל לייצג אותו. כל אינסוף המספרים שמעבר אליו? לא רלוונטיים לנו. במילים אחרות, בואו נניח שיש גבול עליון למספרים הטבעיים ונקרא לו &lt;span&gt;\( N \)&lt;/span&gt; ומעכשיו “שדה המשחק” שלנו הוא רק אוסף המספרים הטבעיים מ-&lt;span&gt;\( 1 \)&lt;/span&gt; עד &lt;span&gt;\( N \)&lt;/span&gt;; הקבוצה &lt;span&gt;\( \left\{ 1,\ldots,N\right\}  \)&lt;/span&gt;. זו גישה שנשמעת תבוסתנית ומתעלמת מהמציאות במבט ראשון, אבל כפי שנראה עוד מעט היא דווקא פרודקטיבית ומועילה.&lt;/p&gt;

&lt;p&gt;בואו נשכח לרגע מראשוניים ונדבר על מספרים באופן כללי. נניח ש-&lt;span&gt;\( N=1,000,000,000,000 \)&lt;/span&gt; - “טריליון”. זה מספר גדול כל כך שאנחנו לא ממש נתקלים בו בחיי היום יום בהקשרים כמו מרחקים, מהירויות, גודל אוכלוסיה, כסף וכו’ (אנחנו כן נתקלים בו כל הזמן למשל בהקשר של זיכרון במחשב אבל אז קוראים לו “טרהבייט”). עכשיו, בואו נניח שההגדרה שלנו למספר &lt;strong&gt;גדול&lt;/strong&gt; היא די קיצונית - אפילו מיליארד עדיין לא נתפס בעינינו כמספר גדול. אפילו לא עשרה מיליארד! או 37 מיליארד! לא, המספר הראשון שאנחנו מואילים בטובנו לומר שהוא גדול הוא לא פחות מאשר &lt;span&gt;\( 100,000,000,000 \)&lt;/span&gt; - מאה מיליארד. ממש קרוב לטריליון. רק אפס אחד נוסף.&lt;/p&gt;

&lt;p&gt;תחת ההגדרה הזו, &lt;strong&gt;רוב עצום&lt;/strong&gt; של המספרים ב”עולם” שלנו הם מספרים ממש, ממש גדולים. למה? כי עד מאה מיליארד יש, ובכן, מאה מיליארד מספרים; וממאה מיליארד עד טריליון יש עוד תשע-מאות מיליארד מספרים - פי 9! אפילו אם נהיה שמרנים ונאמר שרק המספרים החל מ-500 מיליארד הם ממש, ממש ממש גדולים אז עדיין כמות המספרים הממש ממש ממש גדולים בעולם שלנו היא 500 מיליארד… ועוד 1 (טריליון עצמו; זה כמו שבין 5 ל-10 כולל 10 עצמו יש 6 מספרים) כלומר רוב המספרים הם ממש ממש ממש גדולים. זה המובן שבו המשפט “המגוחך” של האריתמטיקה הוא דווקא מעניין למדי; הוא מצביע יפה על כך שהמספרים שאנחנו רגילים אליהם מהיומיום הם כנראה רק טיפה בים לעומת כמות המספרים שעדיין אפשר לדחוס אל מה שנחשב בעינינו “הגבול של המספרים” שאחריו אנחנו כבר לא עוקבים בכלל.&lt;/p&gt;

&lt;p&gt;טוב ויפה, אבל איך המספרים הראשוניים נכנסים לפה? אם למשל אני באמת בוחר את &lt;span&gt;\( N \)&lt;/span&gt; להיות טריליון ומחלק את העולם שלי לכל המספרים שקטנים מ-500 מיליארד וכל המספרים מ-500 מיליארד עד טריליון, האם בחצי השני תהיה אותה כמות ראשוניים כמו בחצי הראשון? ובכן, לא. בחצי הראשון יהיו יותר ראשוניים. אז אם אני אמתח את הגבול ב-&lt;span&gt;\( N/2 \)&lt;/span&gt;, כלומר כל מה שעד &lt;span&gt;\( N/2 \)&lt;/span&gt; הוא “קטן” וכל מה שאחריו הוא “גדול” אז רוב הראשוניים יהיו דווקא קטנים. אבל אם אני אמתח את הגבול טיפה אחרת, למשל ב-&lt;span&gt;\( N/3 \)&lt;/span&gt; במקום ב-&lt;span&gt;\( N/2 \)&lt;/span&gt; זה כבר לא יעבוד ויהיו יותר ראשוניים “גדולים”. אז יש לנו כאן סיטואציה מעניינת - סיטואציה שבה התשובה לשאלה תלויה מאוד בסדר הגודל המדויק, ביחס ל”גבול” העולם, שעבורו אנחנו מגדירים “גדול”.&lt;/p&gt;

&lt;p&gt;איך בעצם אני יודע את מה שטענתי כרגע על הראשוניים? או, אני שמח ששאלתם כי זה מאפשר לנו לדבר על תוכן מתמטי אמיתי - &lt;strong&gt;משפט המספרים הראשוניים&lt;/strong&gt;, שהוא אחד מפסגות המתמטיקה של המאה ה-19.&lt;/p&gt;

&lt;h2&gt;חלק שני, שבו בקירוב אנחנו מגיעים למסקנה שחצי הוא מיוחד&lt;/h2&gt;

&lt;p&gt;בואו נסמן לרגע ב-&lt;span&gt;\( \pi\left(n\right) \)&lt;/span&gt; את מספר הראשוניים שקטנים או שווים ל-&lt;span&gt;\( n \)&lt;/span&gt;. זו פונקציה שמאוד מעניינת מתמטיקאים גם כי היא נותנת בדיוק את סוג המידע שמעניין אותנו כאן - כמה ראשוניים יש בתחום מסוים - וגם כי זו פונקציה שמתקדמת ב”קפיצות” (היא גדלה ב-1 בכל פעם שבה &lt;span&gt;\( n \)&lt;/span&gt; הוא ראשוני) ולכן אם היינו יודעים לחשב אותה טוב, היינו יכולים למצוא ראשוניים על ידי זיהוי של נקודות הקפיצה. ספוילר: אנחנו לא יודעים לחשב אותה טוב, ולכן מה שהמתמטיקאים עשו הוא לנסות ולהבין איך הפונקציה מתנהגת &lt;strong&gt;בערך&lt;/strong&gt;. מה התכונות האסימפטוטיות שלה. ומשפט המספרים הראשוניים (שההוכחה שלו מורכבת למדי ובוודאי שלא אכנס אליה כאן) אומר ש-&lt;span&gt;\( \pi\left(n\right)\approx\frac{n}{\ln n} \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אני לא אכנס כאן למשמעות המדויקת של &lt;span&gt;\( \approx \)&lt;/span&gt; כי מספיק לנו לחשוב על זה בתור “בערך” שהולך ומשתפר ככל ש-&lt;span&gt;\( n \)&lt;/span&gt; גדול יותר. ה-&lt;span&gt;\( \ln n \)&lt;/span&gt; שמופיע במכנה הוא פונקציית ה&lt;strong&gt;לוגריתם הטבעי&lt;/strong&gt;, כלומר לוגריתם שהבסיס שלו הוא לא 10 אלא המספר הקבוע המיוחד &lt;span&gt;\( e=2.78\ldots \)&lt;/span&gt; וגם את זה לא באמת חייבים להבין עד הסוף. במקום זה, בואו נראה כמה דוגמאות.&lt;/p&gt;

&lt;p&gt;ראשית, לא כזה קשה לחשב את &lt;span&gt;\( \pi\left(n\right) \)&lt;/span&gt; לערכים קטנים יחסית. אני למשל מצליח במחשב שלי, עם שפת תכנות לא יעילה במיוחד כמו פייתון, לחשב את &lt;span&gt;\( \pi\left(10,000,000\right)=664,579 \)&lt;/span&gt; די בקלות באמצעות &lt;strong&gt;הכברה של ארטוסתנס&lt;/strong&gt; (אין לי פוסט על זה עדיין, כל כך מביך). אז הנה כמה זוגות של &lt;span&gt;\( \pi\left(n\right) \)&lt;/span&gt; לעומת &lt;span&gt;\( \frac{n}{\ln n} \)&lt;/span&gt;, כדי שנבין איך הקירוב הזה עובד:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( n=100,\pi\left(n\right)=25,\frac{n}{\ln n}=21.71\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( n=1,000,\pi\left(n\right)=168,\frac{n}{\ln n}=144.76\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( n=10,000,\pi\left(n\right)=1229,\frac{n}{\ln n}=1085.73\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( n=100,000,\pi\left(n\right)=9592,\frac{n}{\ln n}=8685.88\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( n=1,000,000,\pi\left(n\right)=78498,\frac{n}{\ln n}=72382.41\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( n=10,000,000,\pi\left(n\right)=664579,\frac{n}{\ln n}=620420.68\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;משהו שאפשר מייד לראות הוא שהקירוב הזה עובד לא רע, אבל בוודאי גם לא טוב כפי שאפשר היה לקוות. גודל הטעות - ההפרש בין המספר האמיתי והקירוב - רק גדל. עבור 100 הטעות היא בערך 3, עבור 100,000 היא בערך 906 ועבור 10,000,000 היא בערך 44158, כלומר היא הולכת וגדלה בערך האבסולוטי שלה. אבל הערך &lt;strong&gt;היחסי&lt;/strong&gt; שלה - כלומר, הגודל שלה כשהוא מחולק ב-&lt;span&gt;\( n \)&lt;/span&gt; - דווקא הולך וקטן, מ-0.03 עבור &lt;span&gt;\( n=100 \)&lt;/span&gt; אל &lt;span&gt;\( 0.004 \)&lt;/span&gt; עבור &lt;span&gt;\( n=10,000,000 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;איך כל זה עוזר לנו? אם אנחנו קובעים רף מסוים שמעליו כל המספרים הם “גדולים” ומתחתיו הם “קטנים”, זה מאפשר לנו להעריך כמה ראשוניים קטנים יהיו אל מול כמה ראשוניים גדולים. נניח למשל שהרף היא &lt;span&gt;\( \frac{N}{2} \)&lt;/span&gt;, אז כמות הראשוניים הכוללת עד &lt;span&gt;\( N \)&lt;/span&gt; היא בערך &lt;span&gt;\( \frac{N}{\ln N} \)&lt;/span&gt; וכמות הראשוניים ה”קטנים” עד &lt;span&gt;\( N \)&lt;/span&gt; היא בערך &lt;span&gt;\( \frac{N/2}{\ln\left(N/2\right)} \)&lt;/span&gt; וכדי לדעת איך היא ביחס לכמות הראשוניים הכוללת אני אחלק את &lt;span&gt;\( \frac{N/2}{\ln\left(N/2\right)} \)&lt;/span&gt; ב-&lt;span&gt;\( \frac{N}{\ln N} \)&lt;/span&gt;. כדי לפשט את הביטוי אני הולך להשתמש בתכונה סטנדרטית של לוגריתמים: &lt;span&gt;\( \ln\left(\frac{a}{b}\right)=\ln a-\ln b \)&lt;/span&gt;, ולכן &lt;span&gt;\( \ln\left(N/2\right)=\ln N-\ln2 \)&lt;/span&gt;. הערך המספרי המדויק של &lt;span&gt;\( \ln2 \)&lt;/span&gt; לא כל כך חשוב, אבל הוא בערך &lt;span&gt;\( 0.693\ldots \)&lt;/span&gt; (כלומר - מספר חיובי, אבל ממש קטן). אם כן:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{N/2}{\ln\left(N/2\right)}/\frac{N}{\ln\left(N\right)}=\frac{1}{2}\frac{\ln N}{\left(\ln N-\ln2\right)}=\frac{1}{2}\frac{1}{1-\frac{\ln2}{\ln N}} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;מה קיבלנו פה? לוגריתם הוא פונקציה עולה שהיא אי-שלילית החל מ-1, כך ש-&lt;span&gt;\( 0&amp;lt;\ln2&amp;lt;\ln N \)&lt;/span&gt;, כלומר &lt;span&gt;\( 0&amp;lt;\frac{\ln2}{\ln N}&amp;lt;1 \)&lt;/span&gt;, כלומר &lt;span&gt;\( 0&amp;lt;1-\frac{\ln2}{\ln N}&amp;lt;1 \)&lt;/span&gt; ולכן &lt;span&gt;\( \frac{1}{2}\frac{1}{1-\frac{\ln2}{\ln N}}&amp;gt;\frac{1}{2} \)&lt;/span&gt;. מכאן אנחנו לומדים שני דברים:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;&lt;strong&gt;תמיד&lt;/strong&gt; יש יותר ראשוניים &quot;קטנים&quot; מאשר &quot;גדולים&quot; אם &quot;קטן&quot; מוגדר בתור &quot;קטן מ-&lt;span&gt;\( \frac{N}{2} \)&lt;/span&gt;&quot;.&lt;/li&gt;


&lt;li&gt;כאשר &lt;span&gt;\( N \)&lt;/span&gt; שואף לאינסוף, היחס בין ה&quot;קטנים&quot; וה&quot;גדולים&quot; שואף ל-&lt;span&gt;\( 1 \)&lt;/span&gt;, כלומר יש פחות ופחות ראשוניים &quot;קטנים&quot; ביחס ל&quot;גדולים&quot;. למרות שהם תמיד רוב.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;כל זה קורה אם אני בוחר באופן שרירותי ש”קטן” יהיה קטן מ-&lt;span&gt;\( \frac{N}{2} \)&lt;/span&gt;. מה קורה במקרים אחרים? למשל אם “קטן” זה קטן מ-&lt;span&gt;\( \frac{N}{10} \)&lt;/span&gt;? בואו נסתכל באופן כללי על &lt;span&gt;\( \frac{N}{k} \)&lt;/span&gt;, אז החישוב שעשיתי למעלה לא משתנה בצורה מהותית - אני מקבל בסוף &lt;span&gt;\( \frac{1}{k}\cdot\frac{1}{1-\frac{\ln k}{\ln N}} \)&lt;/span&gt;. זה אומר שאם אני רוצה להגיע למצב שבו &lt;strong&gt;רוב&lt;/strong&gt; הראשוניים (יותר מחצי) הם “קטנים” אני חייב להגדיר “קטן” בתור “קטן מ-&lt;span&gt;\( \frac{N}{2} \)&lt;/span&gt;” (או קטן אפילו ממספר עוד יותר גדול). עכשיו, האינטואיציה שלי היא שחצי זה לא מספיק - צריך להיות קטנים יותר בסדר גודל או משהו, כמו קודם שהיה לנו 100 מיליארד ביחס לטריליון. אז גם מהניתוח הזה מקבלים את אותה התוצאה ה”ברורה” - יש יותר ראשוניים גדולים מאשר קטנים. אפילו אם לא מסתכלים על כל אינסוף הראשוניים אלא מצמצמים את עצמנו לאיזור מסוים, ואפילו אם משתמשים בכלים מתמטיים כבדים ומרשימים. ההבדל? עכשיו יש לטענות שלנו יותר תוכן מתמטי, וראינו תוצאות מתמטיות יפות על הדרך.&lt;/p&gt;

&lt;p&gt;אבל רגע, זה עדיין רחוק מאוד מלהיות סוף הסיפור!&lt;/p&gt;

&lt;h2&gt;חלק שלישי, ובו השאלה הפילוסופית איך בעצם משווים?&lt;/h2&gt;

&lt;p&gt;עד עכשיו הגישה שאימצנו כדי לדבר על “קטן” הייתה פשוטה: קבענו מספר טבעי כלשהו, כל מה שמתחתיו היה “קטן” וכל מה שמעליו היה “גדול”. זו גישה סבירה מאוד כי הרי צריך לשים גבול איפה שהוא, אבל מצד שני היא לוקה בכשל הסטנדרטי של “פרדוקס הערימה”. אם &lt;span&gt;\( n \)&lt;/span&gt; הוא מספר גדול, הרי שגם &lt;span&gt;\( n-1 \)&lt;/span&gt; הוא מספר גדול, לא? הוא בוודאי לא קטן; ההפרש שלו מהמספר הגדול &lt;span&gt;\( n \)&lt;/span&gt; הוא בסך הכל 1. אם 1 הוא מה שמפריד מספר קטן מגדול, למה &lt;span&gt;\( n-1 \)&lt;/span&gt; עצמו אינו גדול? הרי &lt;span&gt;\( n-2 \)&lt;/span&gt; הוא קטן, ו-&lt;span&gt;\( n-1 \)&lt;/span&gt; הוא &lt;span&gt;\( \left(n-2\right)+1 \)&lt;/span&gt;, אז הוספת ה-1 הזו הייתה אמורה להיות אותו לגדול, לא? התשובה לפרדוקס הזה היא שאין תשובה. “גדול” הוא מושג עמום ובגלל שאין לנו הגדרה טובה אליו אנחנו קובעים משהו שרירותית, וזהו. תסתדרו. עכשיו, שיהיה ברור, &lt;strong&gt;מותר&lt;/strong&gt; לנו לבצע קביעות כאלו; אבל מה שלא כדאי לנו לעשות הוא להתנהג כאילו קביעה כזו היא האמת האחת והיחידה, וגישות אחרות לשאלה מה זה קטן/גדול הן לא לגיטימיות.&lt;/p&gt;

&lt;p&gt;אז אני הולך להראות כמה גישות כאלו, ואנסה שיהיו שונות ממש באופי שלהן כדי שנבין עד כמה אפשר להשתגע פה אם רוצים.&lt;/p&gt;

&lt;p&gt;ראשית, הנה הגדרה שונה לגמרי ל”קטן”: מספר &lt;span&gt;\( n \)&lt;/span&gt; הוא קטן אם קיים מספר &lt;span&gt;\( N \)&lt;/span&gt; שגדול ממנו פי גוגול, כלומר פי &lt;span&gt;\( 10^{100} \)&lt;/span&gt;. מה מצדיק את ההגדרה הזו? יחסיות - בוודאי ש-&lt;span&gt;\( n \)&lt;/span&gt; כזה הוא ממש ממש ממש ממש ממש ממש ממש קטן ביחס ל-&lt;span&gt;\( N \)&lt;/span&gt; שגדול ממנו פי &lt;span&gt;\( 10^{100} \)&lt;/span&gt;. אלא מה, עבור &lt;strong&gt;כל&lt;/strong&gt; מספר טבעי &lt;span&gt;\( n \)&lt;/span&gt; קיים מספר &lt;span&gt;\( N=n\cdot10^{100} \)&lt;/span&gt; שכזה, אז ההגדרה שנתתי בעצם אומרת ש&lt;strong&gt;כל&lt;/strong&gt; המספרים הטבעיים הם קטנים. אפשר לומר שזה מוכיח שההגדרה גרועה, אבל אפשר גם לומר שזה מראה שהציפייה שלנו למושג אבסולוטי של “קטן” היא מופרכת כי כל מספר, גדול ככל שיהיה, הוא קטן בהקשר מסוים.&lt;/p&gt;

&lt;p&gt;ערעור אפשרי אחד על ההגדרה הזו אפשר לתת בכך שאותו &lt;span&gt;\( n \)&lt;/span&gt; “קטן” שלי עשוי להיות בעצמו גדול פי &lt;span&gt;\( 10^{100} \)&lt;/span&gt; מאיזה מספר טבעי אחר - מה שהופך אותו בו זמנית ל”גדול” ול”קטן” והיינו רוצים הגדרה שלא תאפשר משהו כזה בכלל. אז הנה הגדרה טיפה שונה שלא חשופה לסימטריה כזו: מספר &lt;span&gt;\( n \)&lt;/span&gt; הוא קטן אם קיימים אינסוף מספרים טבעיים שגדולים ממנו. אין כאן סימטריה כי לכל מספר טבעי יש רק מספר סופי של מספרים טבעיים שקטנים ממנו, ואני חושב שיש פה אינטואיציה טובה - לא משנה כמה &lt;span&gt;\( n \)&lt;/span&gt; נראה לנו גדול, הוא בסך הכל צעד ראשוני זעיר בדרך אל הנצח העצום שהוא כלל המספרים הטבעיים. אלא מה, גם ההגדרה הזו בעצם אומרת שכל המספרים הטבעיים הם קטנים. בצורה הזו אנחנו מקבלים את הטענה “כל המספרים הראשוניים הם קטנים” שזה נחמד, אבל האמת היא שהיה מעניין אם היינו רואים כאן תכונה שייחודית לראשוניים עצמם, לא לכל המספרים הטבעיים.&lt;/p&gt;

&lt;p&gt;אז הנה גישה שונה לחלוטין לחשוב על כל העניין - &lt;strong&gt;יחסי סדר&lt;/strong&gt;. &lt;a href=&quot;https://gadial.net/2020/01/10/order_relations/&quot;&gt;יש לי פוסט&lt;/a&gt; על יחסי סדר, אבל בואו נראה את זה גם כאן. כשאני אומר &lt;span&gt;\( a\le b \)&lt;/span&gt;, אל מה אני מתכוון בזה? אם &lt;span&gt;\( a,b \)&lt;/span&gt; שניהם מספרים טבעיים, הסימון הזה בדרך כלל אומר “קיים &lt;span&gt;\( d \)&lt;/span&gt; טבעי כך ש-&lt;span&gt;\( a+d=b \)&lt;/span&gt;”. זו ההגדרה הפורמלית. למשל &lt;span&gt;\( 3\le5 \)&lt;/span&gt; כי &lt;span&gt;\( 3+2=5 \)&lt;/span&gt;, או &lt;span&gt;\( 7\le7 \)&lt;/span&gt; כי &lt;span&gt;\( 7+0=7 \)&lt;/span&gt;. זו הגדרה &lt;strong&gt;קונקרטית&lt;/strong&gt; של יחס סדר &lt;strong&gt;מסוים&lt;/strong&gt; אבל מתמטיקאים אוהבים לבצע &lt;strong&gt;הפשטה&lt;/strong&gt; של אובייקטים קונקרטיים - לזהות את התכונות המעניינות של האובייקט ולהישאר רק איתן ולראות איך עדיין אפשר “לשחזר” חלקים גדולים מהמידע הרלוונטי על האובייקט רק מהתכונות המעניינות הללו - רק שעכשיו גם אובייקטים אחרים שחולקים את אותן תכונות ייהנו מהדברים שהסקנו. עבור יחסי סדר, התכונות המעניינות שאנחנו שמים לב אליהן הן:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;לכל &lt;span&gt;\( a \)&lt;/span&gt; מתקיים &lt;span&gt;\( a\le a \)&lt;/span&gt; (זה נקרא &lt;strong&gt;רפלקסיביות&lt;/strong&gt;)&lt;/li&gt;


&lt;li&gt;לכל &lt;span&gt;\( a,b,c \)&lt;/span&gt; אם &lt;span&gt;\( a\le b \)&lt;/span&gt; וגם &lt;span&gt;\( b\le c \)&lt;/span&gt; אז &lt;span&gt;\( a\le c \)&lt;/span&gt; (זה נקרא &lt;strong&gt;טרנזיטיביות&lt;/strong&gt;)&lt;/li&gt;


&lt;li&gt;לכל &lt;span&gt;\( a,b \)&lt;/span&gt; אם &lt;span&gt;\( a\le b \)&lt;/span&gt; וגם &lt;span&gt;\( b\le a \)&lt;/span&gt; אז &lt;span&gt;\( a=b \)&lt;/span&gt; (זה נקרא &lt;strong&gt;אנטי-סימטריה&lt;/strong&gt;).&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;בואו נראה דוגמא ליחס &lt;strong&gt;אחר&lt;/strong&gt; על הטבעיים שמקיים את אותן תכונות בדיוק - יחס החלוקה. אני מסמן &lt;span&gt;\( a|b \)&lt;/span&gt; כדי לומר “&lt;span&gt;\( a \)&lt;/span&gt; מחלק את &lt;span&gt;\( b \)&lt;/span&gt;” ופורמלית זה מוגדר באופן די דומה ליחס הסדר הרגיל: זה אומר שקיים &lt;span&gt;\( d \)&lt;/span&gt; טבעי כך ש-&lt;span&gt;\( a\cdot d=b \)&lt;/span&gt;. כלומר, במקום &lt;strong&gt;לחבר&lt;/strong&gt; את &lt;span&gt;\( d \)&lt;/span&gt; אנחנו &lt;strong&gt;כופלים&lt;/strong&gt; ב-&lt;span&gt;\( d \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;קל להראות ששלוש התכונות למעלה מתקיימות: לכל &lt;span&gt;\( a \)&lt;/span&gt;, &lt;span&gt;\( a\cdot1=a \)&lt;/span&gt; ולכן &lt;span&gt;\( a|a \)&lt;/span&gt;. לכל &lt;span&gt;\( a,b,c \)&lt;/span&gt; אם &lt;span&gt;\( a|b \)&lt;/span&gt; אז קיים &lt;span&gt;\( d_{1} \)&lt;/span&gt; כך ש-&lt;span&gt;\( ad_{1}=b \)&lt;/span&gt; ואם גם &lt;span&gt;\( b|c \)&lt;/span&gt; אז קיים &lt;span&gt;\( d_{2} \)&lt;/span&gt; כך ש-&lt;span&gt;\( bd_{2}=c \)&lt;/span&gt;, ומשני אלו נקבל &lt;span&gt;\( a\left(d_{1}d_{2}\right)=\left(ad_{1}\right)d_{2}=bd_{2}=c \)&lt;/span&gt; כלומר &lt;span&gt;\( a|c \)&lt;/span&gt;; ולבסוף, אם &lt;span&gt;\( a|b \)&lt;/span&gt; וגם &lt;span&gt;\( b|a \)&lt;/span&gt; אז זה אומר שקיימים &lt;span&gt;\( d_{1},d_{2} \)&lt;/span&gt; כך ש-&lt;span&gt;\( ad_{1}=b \)&lt;/span&gt; ו-&lt;span&gt;\( bd_{2}=a \)&lt;/span&gt; ולכן &lt;span&gt;\( a\left(d_{1}d_{2}\right)=\left(ad_{1}\right)d_{2}=bd_{2}=a \)&lt;/span&gt;, ואם נצמצם את &lt;span&gt;\( a \)&lt;/span&gt; משני האגפים נקבל &lt;span&gt;\( d_{1}d_{2}=1 \)&lt;/span&gt; ומכיוון ש-&lt;span&gt;\( d_{1},d_{2} \)&lt;/span&gt; שניהם מספרים טבעיים זה יכול לקרות רק אם &lt;span&gt;\( d_{1}=d_{2}=1 \)&lt;/span&gt;, כלומר &lt;span&gt;\( a=b \)&lt;/span&gt;. זה מסיים את ההוכחה שחלוקה היא יחס סדר.&lt;/p&gt;

&lt;p&gt;עכשיו מגיע החלק המוזר - אם אנחנו משווים גודל של איברים על בסיס יחס הסדר הזה, יוצא ש&lt;strong&gt;כל&lt;/strong&gt; הראשוניים הם קטנים. הרי &lt;span&gt;\( p \)&lt;/span&gt; הוא ראשוני אם שני המספרים היחידים שמחלקים אותו הם 1 ו-&lt;span&gt;\( p \)&lt;/span&gt; עצמו. כלומר אנחנו מקבלים ש-&lt;span&gt;\( 1 \)&lt;/span&gt; הוא המספר ה”מינימלי” על פי יחס הסדר (לכל &lt;span&gt;\( a \)&lt;/span&gt; קיים, &lt;span&gt;\( 1|a \)&lt;/span&gt;) אבל הראשוניים נמצאים דרגה אחת מעליו.&lt;/p&gt;

&lt;p&gt;אני אפילו לא אטרח לנסות להגדיר את “קטן” בצורה יותר מפורשת; אם אנחנו הולכים על פי יחס הסדר שהצגתי, די ברור לי שכל מספר ראשוני הולך להיות “קטן” כי הוא כמעט לגמרי בתחתית הדיאגרמה. כמובן, כשמבינים ש-0 נמצא בראש הדיאגרמה ולכן הוא הכי גדול שיש האינטואיציה שלנו עלולה להתפוצץ, אבל זה טוב; כל הרעיון הוא לראות דברים ששונים מהאינטואיציה היומיומית.&lt;/p&gt;

&lt;h2&gt;חלק רביעי, ובו דרך אחרת לחשוב על ראשוניים קטנים וגדולים&lt;/h2&gt;

&lt;p&gt;בדוגמת יחס הסדר שנתתי, &lt;strong&gt;כל&lt;/strong&gt; הראשוניים היו קטנים. אפשר אולי היה לחשוב על הגדרה ל”גדול” שבה חלק מהמספרים הטבעיים יהיו גדולים (מספרים שיש להם המון מחלקים? מחלקים שהם חזקות גדולות?) אבל לא משנה מה היא הייתה, אף ראשוני לא היה מתאים אליה. אבל אפשר להציג עוד תוצאה, מרהיבה לחלוטין לטעמי, שנותנת לנו זווית התבוננות נוספת על מושגי ה”קטן”/”גדול” הללו. הדרך הזו תשתמש במתמטיקה טיפה יותר מתוחכמת אבל גם אם אתם לא מכירים אותה, אל תתייאשו! לא באמת צריך להבין אותה לעומק.&lt;/p&gt;

&lt;p&gt;בואו נתחיל עם סיפור יפה: אכילס רוצה לרוץ לאורכו של אצטדיון בן קילומטר אחד. לפני שהוא יגיע לקצה השני שלו הוא חייב לעבור דרך נקודת האמצע, כלומר הוא קודם כל צריך לעבור &lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; קילומטר. אחר כך נותר לו עוד חצי קילומטר, אבל לפני שיעבור את כל המרחק הזה הוא צריך לעבור &lt;strong&gt;חצי&lt;/strong&gt; ממנו, כלומר לעבור עוד &lt;span&gt;\( \frac{1}{4} \)&lt;/span&gt; קילומטר. ואחרי שעבר אותו, הוא צריך לעבור עוד &lt;span&gt;\( \frac{1}{8} \)&lt;/span&gt; קילומטר כדי להגיע לחצי מהמרחק שנותר, וכן הלאה וכן הלאה. עכשיו, אני חושב שכולנו נסכים שאכילס יגיע לקצה השני של האצטדיון ואכן יעבור 1 קילומטר (“אני לא מסכים!” צועק מישהו בשם זנון מהיציע, אבל אנחנו במרחק 2,000 שנים ממנו אז נתעלם) ולכן, אינטואיטיבית, אנחנו יכולים לזרום עם הטענה שלי ש-&lt;span&gt;\( \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\ldots=1 \)&lt;/span&gt;. כלומר, שאפשר לחבר אינסוף מספרים ולקבל משהו סופי. דגש על &lt;strong&gt;אפשר&lt;/strong&gt;, אני בהחלט לא אומר שזה תמיד יעבוד.&lt;/p&gt;

&lt;p&gt;הסיבה שזה עובד במקרה למעלה היא שהאיברים שמשתתפים בסכום הופכים מהר מאוד לקטנים מאוד. אפשר לנסח את זה בצורה פורמלית לגמרי, אבל כרגע לא אכנס לזה. הנקודה החשובה היא שלא מספיק שהאיברים הופכים לקטנים עוד ועוד - זה צריך לקרות &lt;strong&gt;מהר&lt;/strong&gt;. כמה מהר? ובכן, אם נסתכל על הסכום הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1+\frac{1}{2}+\frac{1}{3}+\frac{1}{4}+\frac{1}{5}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;הסכום הזה &lt;strong&gt;לא&lt;/strong&gt; מסתכם לשום דבר סופי - הוא יוצא “אינסוף”. לעומת זאת, הסכום הבא:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 1+\frac{1}{4}+\frac{1}{9}+\frac{1}{16}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;שאפשר לכתוב גם בתור&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{1}{1^{2}}+\frac{1}{2^{2}}+\frac{1}{3^{2}}+\frac{1}{4^{2}}+\ldots \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;יוצא מספר סופי, ועוד אחד שמעורר תהיות “מאיפה זה בכלל הגיע?!” - המספר &lt;span&gt;\( \frac{\pi^{2}}{6} \)&lt;/span&gt; (מאיפה זה באמת הגיע? יש שלל הסברים, אבל זה לפוסט אחר).&lt;/p&gt;

&lt;p&gt;את מה שראינו אפשר לסכם בצורה הבאה: אם אנחנו מחברים את כל האיברים מהצורה &lt;span&gt;\( \frac{1}{n} \)&lt;/span&gt; כאשר &lt;span&gt;\( n \)&lt;/span&gt; הוא &lt;strong&gt;מספר טבעי&lt;/strong&gt; זה יוצא אינסוף, אבל אם אנחנו לא סוכמים את כל האיברים הללו אלא רק חלק מהם, אנחנו עשויים לקבל מספר סופי. אם מחברים רק את האיברים שעבורם &lt;span&gt;\( n \)&lt;/span&gt; הוא חזקה של 2, מקבלים משהו סופי; אם מחברים רק את האיברים שעבורם &lt;span&gt;\( n \)&lt;/span&gt; הוא ריבוע של מספר טבעי, מקבלים משהו סופי.&lt;/p&gt;

&lt;p&gt;מה קורה אם מחברים את כל האיברים שעבורם &lt;span&gt;\( n \)&lt;/span&gt; ראשוני? זו התוצאה שאני רוצה לדבר עליה כאן. התשובה היא שמקבלים אינסוף, והעובדה הזו בפני עצמה היא עוד הוכחה לכך שיש אינסוף ראשוניים כי אם היה רק מספר סופי שלהם, בוודאי שגם סכום שלהם היה סופי. אבל איך מוכיחים את הטענה הזו? יש שלל הוכחות, אבל זו שמעניינת אותי כאן היא הוכחה של פאול ארדש, שכמעט ולא דורשת היכרות עם מתמטיקה מתקדמת ואני אחליק בקלילות גם את מה שכן צריך. נתמקד בחלק שאותו אפשר להבין בלי ידע מתמטי מתקדם כלשהו, אם כי זה לא אומר שהוא יהיה &lt;strong&gt;קל&lt;/strong&gt; להבנה. אבל אם נבין אותו, נבין גם דרך אחרת לגמרי להתבונן על ענייני ה”קטן”/”גדול”, מה שנותן תוכן מתמטי מאוד מעניין לשאלה המקורית.&lt;/p&gt;

&lt;p&gt;ראשית, האינטואיציה הכללית: ככל ש-&lt;span&gt;\( n \)&lt;/span&gt; יותר &lt;strong&gt;גדול&lt;/strong&gt; כך &lt;span&gt;\( \frac{1}{n} \)&lt;/span&gt; יותר &lt;strong&gt;קטן&lt;/strong&gt; ולכן תורם פחות לסכום. לכן אפשר לתת את האינטואיציה לפיה אם הסכום &lt;strong&gt;מתכנס&lt;/strong&gt; (כלומר, מסתכם למספר סופי) אז רוב ה-&lt;span&gt;\( n \)&lt;/span&gt;-ים המעורבים בו הם &lt;strong&gt;גדולים&lt;/strong&gt; (כי אז מה שהם תורמים לסכום הוא קטן יחסית) ואילו אם הסכום &lt;strong&gt;מתבדר&lt;/strong&gt; (כלומר, יוצא אינסוף) אז רוב ה-&lt;span&gt;\( n \)&lt;/span&gt;-ים המעורבים בו הם &lt;strong&gt;קטנים&lt;/strong&gt; (ולכן מה שהם תורמים לסכום הוא גדול יחסית). זו אינטואיציה די מסוכנת, כי כשמסתכלים על סכומים אינסופיים השאלה אם הם מתכנסים או מתבדרים לא תלויה בראש של הסכום, כלומר באיברים הראשונים שבו, אלא רק ב”זנב” שלו - באינסוף האיברים האחרונים. אם אני אקח את הסכום&lt;span&gt;\( 1+\frac{1}{2}+\frac{1}{3}+\frac{1}{4}+\frac{1}{5}+\ldots \)&lt;/span&gt; ובמקום להתחיל אותו מ-1 אני אתחיל אותו מ-&lt;span&gt;\( \frac{1}{1,000,000,000} \)&lt;/span&gt;, שום דבר לא ישתנה - הסכום עדיין יצא אינסוף. אם אני אתחיל את הסכום &lt;span&gt;\( 1+\frac{1}{4}+\frac{1}{9}+\frac{1}{16}+\ldots \)&lt;/span&gt; רק מ-&lt;span&gt;\( \frac{1}{121} \)&lt;/span&gt; אז הסכום עדיין יתכנס, אם כי הוא יתכנס למספר אחר (הסכום המקורי פחות סכום כל האיברים ב”ראש” שקיצצנו). אז אפילו אם סכום הוא מתבדר ולכן אני מסיק ש”רוב” האיברים בו קטנים, אני לא באמת יכול להגיד איפה מתחיל ונגמר הרוב הזה, כי אני יכול להתחיל את הזנב מאיפה שאני רוצה; כלומר, אני שוב רואה את “קטן” כמושג יחסי ולא אבסולוטי, אבל עכשיו אפילו קשה לומר ביחס &lt;strong&gt;אל מה&lt;/strong&gt;. אין לי אנלוגיה טובה במיוחד מהמקרה הנוכחי למקרים הקודמים, וזו בדיוק הסיבה שבגללה אני מביא את המקרה הנוכחי - אמרתי שזו תהיה דרך שונה לגמרי לחשוב על זה.&lt;/p&gt;

&lt;p&gt;בואו נראה את ההוכחה של ארדש לכך שהסכום מתבדר. מה שארדש עושה הוא הוכחה בשלילה - הוא &lt;strong&gt;מניח&lt;/strong&gt; שהסכום כן מתכנס למספר כלשהו ומגיע מכך לסתירה, מה שגורם לו להסיק שההנחה שהסכום מתכנס הייתה שגויה. ארדש מתחיל מלהגיד שאם הסכום מתכנס, ולא משנה לאיזה מספר הוא מתכנס, אז יש לו זנב שמתכנס לערך &lt;strong&gt;קטן&lt;/strong&gt;. מה זאת אומרת? נניח שאני מסמן את כל הראשוניים באופן הבא: &lt;span&gt;\( p_{1},p_{2},p_{3},\ldots \)&lt;/span&gt;, אז קיים &lt;span&gt;\( k \)&lt;/span&gt; טבעי כלשהו כך ש-&lt;span&gt;\( \frac{1}{p_{k+1}}+\frac{1}{p_{k+2}}+\frac{1}{p_{k+3}}+\ldots&amp;lt;\frac{1}{2} \)&lt;/span&gt; - ה”זנב” שהוא סכום כל ההופכיים של ראשוניים שגדולים מ-&lt;span&gt;\( p_{k} \)&lt;/span&gt; יוצא פחות מחצי.&lt;/p&gt;

&lt;p&gt;למה הטענה הזו נכונה? זו הטענה היחידה שדורשת מתמטיקה קצת יותר מתקדמת כדי להוכיח אותה - ספציפית, תוצאות בסיסיות יחסית בתורה של טורים אינסופיים. הרעיון הוא כזה: נניח שכל הטור של הופכיי הראשוניים מתכנס לאיזה מספר &lt;span&gt;\( A \)&lt;/span&gt;, כלומר &lt;span&gt;\( \frac{1}{p_{1}}+\frac{1}{p_{2}}+\ldots=A \)&lt;/span&gt;. אז אני מתחיל לסכום את כל האיברים בטור ובודק לאן הגעתי. אני &lt;strong&gt;חייב&lt;/strong&gt; מתישהו לעבור את &lt;span&gt;\( A-\frac{1}{2} \)&lt;/span&gt; כי אם אני אף פעם לא עובר אותו אני לא אגיע אל &lt;span&gt;\( A \)&lt;/span&gt; (היי, אכילס!). מרגע שעברתי את &lt;span&gt;\( A-\frac{1}{2} \)&lt;/span&gt; כל האיברים שנשארו בטור חייבים להסתכם אל משהו שלא גדול מ-&lt;span&gt;\( \frac{1}{2} \)&lt;/span&gt; אחרת נעבור את &lt;span&gt;\( A \)&lt;/span&gt; (כאן אני משתמש בכך שכל האיברים בטור הם &lt;strong&gt;מספרים חיוביים&lt;/strong&gt;, כלומר אי אפשר לחבר איברים לטור ובכך להקטין את הסכום הכולל). זה הרעיון, ועל הפורמליזם אני אוותר כאן.&lt;/p&gt;

&lt;p&gt;על הראשוניים עד וכולל &lt;span&gt;\( p_{k} \)&lt;/span&gt; אפשר לחשוב, כאמור, בתור “הראשוניים הקטנים”, אלו שתורמים הכי הרבה לסכום (כי כשמחלקים 1 בהם מקבלים משהו גדול יחסית) ועל כל יתר הראשוניים אפשר לחשוב בתור “הראשוניים הגדולים”. עכשיו ארדש מראה שקורים שני דברים שונים: ראשית: שמהראשוניים הקטנים אי אפשר להרכיב &lt;strong&gt;יותר מדי&lt;/strong&gt; מספרים; שנית, שמאותם ראשוניים בדיוק אפשר להרכיב &lt;strong&gt;המון&lt;/strong&gt; מספרים. שני אלו מן הסתם מובילים לסתירה אם בוחרים את הפרמטרים שלנו בצורה זהירה.&lt;/p&gt;

&lt;p&gt;מה שארדש עושה דומה למה שראינו קודם בפוסט - הוא לוקח &lt;span&gt;\( N \)&lt;/span&gt; טבעי כלשהו ומצמצם את ה”עולם” שלנו רק למספרים עד וכולל &lt;span&gt;\( N \)&lt;/span&gt; ושואל את עצמו - מבין כל המספרים בתחום &lt;span&gt;\( 1,\ldots,N \)&lt;/span&gt;, כמה מהמספרים הללו בנויים אך ורק מראשוניים קטנים? כלומר, שבפירוק לגורמים שלהם יש רק ראשוניים עד וכולל &lt;span&gt;\( p_{k} \)&lt;/span&gt;. בואו נראה דוגמא קונקרטית לזה עם שלושת הראשוניים הראשונים, &lt;span&gt;\( 2,3,5 \)&lt;/span&gt;. איזה מספרים אפשר להרכיב מהם? ובכן, את 2,3,5 כמובן, אבל גם את &lt;span&gt;\( 6,10,15 \)&lt;/span&gt; שמתקבלים ממכפלה של זוגות של איברים מתוכם, וגם את &lt;span&gt;\( 30 \)&lt;/span&gt; שמתקבל מהמכפלה של שלושתם. ואם רוצים אפשר להכניס גם את &lt;span&gt;\( 1 \)&lt;/span&gt; לתמונה בתור “המכפלה הריקה” שלהם. במילים אחרות, מה שתיארתי עד כה הוא את כל המספרים מהצורה&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( 2^{a}3^{b}5^{c} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כאשר &lt;span&gt;\( a,b,c \)&lt;/span&gt; הם או 0 או 1. מכיוון שלכל אחד מהמשתנים הללו יש 2 אפשרויות, אז מספר הקומבינציות האפשריות של ערכים לכל המשתנים הם 2 (עבור &lt;span&gt;\( a \)&lt;/span&gt;) כפול 2 (עבור &lt;span&gt;\( b \)&lt;/span&gt;) כפול 2 (עבור &lt;span&gt;\( c \)&lt;/span&gt;) - בסך הכל 8, מה שמתאים למספרים שמצאנו: &lt;span&gt;\( 1,2,3,5,6,10,15,30 \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;אותו טיעון עובד גם באופן כללי כשיש לנו &lt;span&gt;\( k \)&lt;/span&gt; ראשוניים: מסתכלים על כל המכפלות &lt;span&gt;\( p_{1}^{a_{1}}\ldots p_{k}^{a_{k}} \)&lt;/span&gt; כך שכל &lt;span&gt;\( a_{i} \)&lt;/span&gt; הוא או 0 או 1 ומקבלים מספר שמתחלק רק בראשוניים קטנים - בסך הכל &lt;span&gt;\( 2^{k} \)&lt;/span&gt; מספרים. ייתכן שחלק מהמספרים הללו יוצאים גדולים מ-&lt;span&gt;\( N \)&lt;/span&gt; (הרי לא התחייבתי בשום צורה לגבי הערך של &lt;span&gt;\( N \)&lt;/span&gt;) ולכן לא אמורים להיות בספירה, אבל זה בסדר כי מספיק לי להראות &lt;strong&gt;חסם מלמעלה&lt;/strong&gt; על כמות המספרים שאפשר להרכיב עם ראשוניים קטנים - כל עוד החסם הזה יהיה די קטן, אני אוכל להסיק את המסקנה שלי, שאי אפשר להרכיב “יותר מדי” מספרים.&lt;/p&gt;

&lt;p&gt;העניין הוא שכרגע אני מפספס די הרבה מספרים, ורואים את זה בדוגמא שלנו. מה עם &lt;span&gt;\( 4 \)&lt;/span&gt;? הוא מתחלק רק ב-2. ו-9 מתחלק רק ב-3. ומה עם &lt;span&gt;\( 60 \)&lt;/span&gt;? גם הוא מתחלק רק ב-&lt;span&gt;\( 2,3,5 \)&lt;/span&gt;. העניין הוא שעד כה הסתכלתי רק על מספרים שכל ראשוני משתתף במכפלה שנותנת אותם &lt;strong&gt;לכל היותר פעם אחת&lt;/strong&gt;. אבל ראשוני יכול להופיע הרבה פעמים במכפלה. הטיעון של ארדש מטפל בזה בצורה חכמה - הוא סופר גם את המקרים הללו, אבל מתייחס לכך שאם יש ראשוניים שמופיעים יותר מפעם אחת זה מגדיל עוד יותר את המספר שאנחנו בונים ולכן פחות ופחות מספרים יצליחו להיות מתחת לחסם של &lt;span&gt;\( N \)&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;הנה הטיעון המסודר. נסתכל על כל המכפלות &lt;span&gt;\( p_{1}^{n_{1}}\ldots p_{k}^{n_{k}} \)&lt;/span&gt; כך שאין לי הגבלה על ה-&lt;span&gt;\( n \)&lt;/span&gt;-ים מלבד זו ש-&lt;span&gt;\( n \)&lt;/span&gt; הוא מספר טבעי. עכשיו, כל מספר טבעי אפשר לכתוב בתור &lt;span&gt;\( n=2m+a \)&lt;/span&gt; כך ש-&lt;span&gt;\( m \)&lt;/span&gt; הוא מספר טבעי אחר ו-&lt;span&gt;\( a \)&lt;/span&gt; הוא או 0 או 1 (אם &lt;span&gt;\( n \)&lt;/span&gt; זוגי אז &lt;span&gt;\( a \)&lt;/span&gt; יהיה 0 ואחרת הוא יהיה 1). בואו ניזכר לרגע בחוקי החזקות הבסיסים:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x^{a+b}=x^{a}\cdot x^{b} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( x^{ab}=\left(x^{a}\right)^{b} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \left(xy\right)^{a}=x^{a}y^{a} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;עם החוקים הללו אנחנו רואים ש-&lt;span&gt;\( p^{n}=p^{2m+a}=p^{a}\cdot\left(p^{m}\right)^{2} \)&lt;/span&gt;, ולכן&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( p_{1}^{n_{1}}\ldots p_{k}^{n_{k}}=p_{1}^{a_{1}}\ldots p_{k}^{a_{k}}\cdot\left(p_{1}^{m_{1}}\ldots p_{k}^{m_{k}}\right)^{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;במילים אחרות, אני יכול לכתוב כל מספר בתור מכפלה מהצורה &lt;span&gt;\( s^{2}r \)&lt;/span&gt;, כאשר &lt;span&gt;\( r \)&lt;/span&gt; הוא בעל התכונה שהוא “חופשי מריבועים” - הוא לא מתחלק על ידי אף ריבוע, כי כל מספר ראשוני במכפלה שנותנת אותו מופיע לכל היותר פעם אחת. פירוק כזה של מספר טבעי למכפלה של ריבוע ומספר חופשי מריבועים הוא טריק סטנדרטי בתורת המספרים האלמנטרית ותמיד נחמד להראות אותו.&lt;/p&gt;

&lt;p&gt;איך זה עוזר לארדש? ובכן, ארדש כבר הוכיח לנו שאין יותר מדי מספרים חופשיים מריבועים שמורכבים רק מ-&lt;span&gt;\( k \)&lt;/span&gt; הראשוניים הראשונים: יש בדיוק &lt;span&gt;\( 2^{k} \)&lt;/span&gt; ערכים אפשריים של &lt;span&gt;\( r \)&lt;/span&gt;. אילו ערכים אפשריים יש ל-&lt;span&gt;\( s \)&lt;/span&gt;? אנחנו צריכים שיתקיים &lt;span&gt;\( s^{2}r\le N \)&lt;/span&gt; ולכן בפרט שיתקיים &lt;span&gt;\( s^{2}\le N \)&lt;/span&gt; כלומר &lt;span&gt;\( s\le\sqrt{N} \)&lt;/span&gt;. אז יש לנו &lt;span&gt;\( 2^{k} \)&lt;/span&gt; דרכים אפשריות לבחור את &lt;span&gt;\( r \)&lt;/span&gt; ולכל היותר &lt;span&gt;\( \sqrt{N} \)&lt;/span&gt; דרכים אפשריות לבחור את &lt;span&gt;\( s \)&lt;/span&gt;, ולכן חסם מלמעלה על כמות המספרים בתחום &lt;span&gt;\( 1,\ldots,N \)&lt;/span&gt; שמורכבים רק מהראשוניים &lt;span&gt;\( p_{1},\ldots,p_{k} \)&lt;/span&gt; היא &lt;span&gt;\( 2^{k}\sqrt{N} \)&lt;/span&gt;. אוטוטו נראה שזה מספר &lt;strong&gt;קטן מדי&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;עכשיו, בואו נסתכל על המספרים בתחום &lt;span&gt;\( 1,\ldots,N \)&lt;/span&gt; שמתחלקים על ידי ראשוני גדול אחד לפחות, למשל על ידי הראשוני &lt;span&gt;\( p_{t} \)&lt;/span&gt; כך ש-&lt;span&gt;\( t&amp;gt;k \)&lt;/span&gt;. הרעיון הוא שלא יכולים להיות יותר מדי מספרים כאלו כי &lt;span&gt;\( p_{t} \)&lt;/span&gt; הוא גדול. פורמלית, אם מספר כלשהו מתחלק על ידי &lt;span&gt;\( p_{t} \)&lt;/span&gt; אז הוא מהצורה &lt;span&gt;\( p_{t}\cdot s \)&lt;/span&gt; כאשר &lt;span&gt;\( s \)&lt;/span&gt; הוא מספר טבעי כלשהו (שיכול אפילו להתחלק שוב על ידי &lt;span&gt;\( p_{t} \)&lt;/span&gt;, זה לא מפריע לי). מכיוון ש-&lt;span&gt;\( p_{t}s\le N \)&lt;/span&gt; אז &lt;span&gt;\( s\le\frac{N}{p_{t}} \)&lt;/span&gt;, כלומר יש לנו לכל היותר &lt;span&gt;\( \frac{N}{p_{t}} \)&lt;/span&gt; מספרים שמתחלקים על ידי &lt;span&gt;\( p_{t} \)&lt;/span&gt; בתחום &lt;span&gt;\( 1,\ldots,N \)&lt;/span&gt;. אז כמה מספרים יש לי בסך הכל? אני אספור את כל מי שמתחלקים על ידי &lt;span&gt;\( p_{k+1} \)&lt;/span&gt;, כלומר לכל היותר &lt;span&gt;\( \frac{N}{p_{k+1}} \)&lt;/span&gt;, ועוד מי שמתחלקים על ידי &lt;span&gt;\( p_{k+2} \)&lt;/span&gt; כלומר לכל היותר &lt;span&gt;\( \frac{N}{p_{k+2}} \)&lt;/span&gt;וכן הלאה. בצורה הזו ייתכן מאוד שאני אספור את אותו מספר כמה פעמים (כי הוא מתחלק גם על ידי &lt;span&gt;\( p_{k+1} \)&lt;/span&gt; וגם על ידי &lt;span&gt;\( p_{k+2} \)&lt;/span&gt;, למשל) אבל זה לא מפריע לי - אני רק רוצה לחסום מלמעלה את כמות המספרים שמתחלקים על ידי ראשוני גדול. אני אקבל:&lt;/p&gt;

&lt;p&gt;&lt;span&gt;\( \frac{N}{p_{k+1}}+\frac{N}{p_{k+2}}+\frac{N}{p_{k+3}}+\ldots=N\cdot\left(\frac{1}{p_{k+1}}+\frac{1}{p_{k+2}}+\frac{1}{p_{k+3}}+\ldots\right)&amp;lt;\frac{N}{2} \)&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;כשהמעבר האחרון נובע ממה שהתחלנו איתו - בחרנו את &lt;span&gt;\( k \)&lt;/span&gt; בכוונה כדי שה”זנב” יתכנס למספר קטן מחצי. עכשיו, את מה שעשיתי בשורה הקודמת צריך להצדיק בצורה פורמלית, כי כל עבודה עם טורים אינסופיים דורשת הצדקות זהירות - אבל זה עובד, לא לדאוג.&lt;/p&gt;

&lt;p&gt;מה קיבלנו? שלכל היותר חצי מהמספרים בתחום &lt;span&gt;\( 1,\ldots,N \)&lt;/span&gt; יכולים להתחלק על ידי ראשוניים “גדולים”. לכן &lt;strong&gt;לפחות&lt;/strong&gt; חצי מהם מתחלקים רק על ידי ראשוניים קטנים. זה אומר שצריך להתקיים &lt;span&gt;\( \frac{N}{2}&amp;lt;2^{k}\sqrt{N} \)&lt;/span&gt;, או במילים אחרות - &lt;span&gt;\( \sqrt{N}&amp;lt;2^{k+1} \)&lt;/span&gt; (חילקתי את שני האגפים ב-&lt;span&gt;\( \sqrt{N} \)&lt;/span&gt; וכפלתי אותם ב-2) או במילים אחרות, &lt;span&gt;\( N&amp;lt;2^{2\left(k+1\right)} \)&lt;/span&gt; (העליתי בריבוע את שני האגפים).&lt;/p&gt;

&lt;p&gt;אלא מה, &lt;strong&gt;לא הנחתי שום דבר כזה&lt;/strong&gt; על &lt;span&gt;\( N \)&lt;/span&gt;. כל מה שארדש עשה תקף עבור &lt;span&gt;\( N \)&lt;/span&gt; &lt;strong&gt;כללי&lt;/strong&gt;, כלשהו. לכן זה אמור לעבוד גם אם &lt;span&gt;\( N\ge2^{2\left(k+1\right)} \)&lt;/span&gt;, אבל אז מקבלים סתירה והמתמטיקה מתרסקת, מה שמוביל את ארדש לכך שההנחה המקורית שלו, שהטור של הופכיי הראשוניים מתכנס, לא הייתה נכונה.&lt;/p&gt;

&lt;p&gt;בואו נחדד שוב מה ארדש אומר בעצם: הוא אומר שאם נחלק את הראשוניים ל-&lt;span&gt;\( k \)&lt;/span&gt; ראשוניים “קטנים” וכל יתר אינסוף הראשוניים הם “גדולים”, אז אם נסתכל על חתיכה גדולה מספיק מהמספרים הטבעיים, הראשוניים ה”קטנים” יהיו חייבים להרכיב לבדם לפחות חצי מהחתיכה הזו כי הראשוניים ה”גדולים” הם גדולים מדי מכדי להרכיב את רוב המספרים שם, אבל מצד שני פשוט אין מספיק ראשוניים קטנים כדי להרכיב כזו כמות של מספרים. המסקנה, אם תרצו, היא שראשוניים “קטנים” יש המון, אם כי כאמור קשה לי לתאר את המובן המדויק הזה של “המון”.&lt;/p&gt;

&lt;h2&gt;חלק חמישי וקצר במיוחד שבו אני שואל ולא באמת מבין מה למדנו מכל זה&lt;/h2&gt;

&lt;p&gt;לסיכום, מה בעצם למדנו? האם למדנו שרוב הראשוניים הם קטנים? לא. האם למדנו שרוב הראשוניים הם גדולים? לא. אני עדיין לא בטוח מה המשמעות שאנחנו רוצים לתת למילים הללו. אבל כן למדנו כל מני דברים נחמדים בפני עצמם - מה זה ראשוניים, שיש אינסוף מהם, מה זה “כמעט כל” המספרים, מה משפט המספרים הראשוניים מספר לנו על הכמות של הראשוניים עד גודל כלשהו, על האופן שבו אפשר להגדיר יחסי סדר שונים על הטבעיים ובפרט יחס של חילוק במקום “קטן מ-“ הרגיל, ואיך אפשר להשתמש בטורים אינסופיים כדי להעריך עד כמה מהר סדרת מספרים כלשהי נהיית גדולה. כל אלו הם דברים &lt;strong&gt;מעניינים&lt;/strong&gt; במתמטיקה, ושאלה היא מוצדקת אם היא נותנת לנו תירוץ לדבר על דברים מעניינים, אז אני בסך הכל סבבה עם השאלה “האם רוב הראשוניים הם קטנים?” כל עוד אנחנו זוכרים שהמטרה פה היא לא לענות עליה ובטח שלא לחשוב שיש לה תשובה חד משמעית, אלא להשתמש בה בתור תירוץ לראות דברים מעניינים באמת.&lt;/p&gt;</content><author><name></name></author><category term="מספרים ראשוניים" /><summary type="html">חלק ראשון, ובו כמעט הכל ממש ממש ממש גדול</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://gadial.net/assets/img/main/default-card.png" /><media:content medium="image" url="http://gadial.net/assets/img/main/default-card.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>