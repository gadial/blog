<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>בעיית יוספוס | לא מדויק</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="בעיית יוספוס" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<meta property="og:description" content="לא מדויק - בלוג על מתמטיקה ומדעי המחשב" />
<link rel="canonical" href="http://gadial.net/2021/04/10/josephus_problem/" />
<meta property="og:url" content="http://gadial.net/2021/04/10/josephus_problem/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-10T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="twitter:title" content="בעיית יוספוס" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"url":"http://gadial.net/2021/04/10/josephus_problem/","@type":"BlogPosting","description":"לא מדויק - בלוג על מתמטיקה ומדעי המחשב","headline":"בעיית יוספוס","dateModified":"2021-04-10T00:00:00+00:00","datePublished":"2021-04-10T00:00:00+00:00","image":"http://gadial.net/assets/img/main/default-card.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2021/04/10/josephus_problem/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/lecture_notes">סיכומי הרצאות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">דף אקראי</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2021/03/24/how_to_division/">&laquo; ארבע פעולות החשבון - חילוק</a>
    
    
      <a class="next" href="/2021/05/13/trigonometry_intro/">מה בעצם הולך בטריגונומטריה בתיכון? (חלק א') &raquo;</a>
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">בעיית יוספוס</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-04-10T00:00:00+00:00" itemprop="datePublished">Apr 10, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>בעיית יוספוס, על שם ההיסטוריון יוספוס פלביוס, היא ההוכחה שמתמטיקאים יכולים למצוא בעיה מתמטית בכל סיפור שרק נותן להם שמץ של הזדמנות לעשות זאת. במקרה הזה, הספר “תולדות מלחמת היהודים עם הרומאים” של יוספוס שמתאר את המרד הגדול ברומאים. בזמן המלחמה הזו פלביוס עדיין נקרא יוסף בן מתיתיהו והיה אחד ממפקדי הצבא היהודי, אך לבסוף <a href="http://www.daat.ac.il/daat/vl/milhamot/milhamot10.pdf">("תולדות מלחמת היהודים עם הרומאים", ספר 3, פרק שמיני)</a> הובס על ידי הרומאים ביודפת ומצא את עצמו מסתתר במערה עם ארבעים אנשים.</p>

<p>כשהיה ברור לאנשים במערה שהרומאים עומדים ללכוד אותם, החליטו שעדיף להם להתאבד מאשר ליפול בידיהם. חוץ מאשר יוספוס שלא התלהב כל כך מכל הקטע הזה של מות קדושים וניסה להסתלק אבל לא בדיוק נתנו לו (“מהרו אליו מכל עברים בחרבות שלופות וחרפו אותו על מרך-לבו”).</p>

<p>אלא ש”גם בעת המצוקה הזאת לא נבצרה מזימה מיוסף” והוא הציע שאם כבר עליהם למות, שיעשו זאת בהגרלה. בכל סיבוב של ההגרלה ייבחר אדם אחד, שיהרוג את האדם שנבחר קודם (“הבו ונטיל גורלות, מי ממנו ימית את חברו. והנלכד בגורל יפול בחרב הבא אחריו”), וכך זה יימשך עד שכולם מתים. וכך הנה, ורצה הגורל שיוסף ואדם אחד יחיד נותרו בחיים עד הסוף (“אולי היה זה מקרה ואולי אצבע אלוהים”) ויוסף הצליח לשכנע את האדם האחר לא להשתתף בהימור, וכך ניצלו חייו (של יוסף; לא בדיוק מסופר מה עלה בגורל השני ומכיוון שמדובר ברומאים אני לא אופטימי).</p>

<p>בתור סיפור, זה סיפור מוצלח למדי, למי שאוהבים דם ואש ותמרות עשן; אבל כמה הוא אמין? והאם אפשר לחלץ מפה חידה מתמטית מעניינת?</p>

<p>ראשית, מה הסיכוי של יוסף לשרוד הרפתקאה כזו ב”מקרה”, כדבריו? על פי הסיפור, היו עם יוסף 40 אנשים נוספים, כלומר בסך הכל היו 41. אם ההגרלה שבוצעה היא הוגנת, הסיכוי של יוסף להיות האחרון ששורד הוא <span>\( \frac{1}{41}\approx2.44\% \)</span> - ממש לא משהו. איך הגעתי למספר הזה? דרך אחת היא פשוט לומר שלכל האנשים אותו סיכוי בדיוק; דרך מסורבלת יותר עם פחות נפנוף ידיים היא להגיד שכל הגרלה יוצרת <strong>סידור בשורה</strong> של האנשים - האיש הראשון, האיש השני וכן הלאה, מה שנקרא ב<a href="https://gadial.net/2010/06/20/combinatorics_intro/">קומבינטוריקה</a> <strong>תמורה</strong>. יש <span>\( 41! \)</span> תמורות כאלו, כאשר סימן הקריאה מתאר את פעולת ה<strong>עצרת</strong>: <span>\( n!=1\cdot2\cdot3\cdots n \)</span>. אם נספור רק את התמורות שבהן יוסף הוא אחרון, נראה שיש <span>\( 40! \)</span> כאלו, כי פשוט מסדרים בשורה את כל האנשים מלבד יוסף, ואז מוסיפים אותו בסוף. לכן יש ליוסף סיכוי של <span>\( \frac{40!}{41!}=\frac{1}{41} \)</span> להישאר אחרון.</p>

<p>אבל רגע, יוסף סיפר שנשאר איתו עוד אדם אחד. אם נניח שלא משנה איזה אדם היה שורד עם יוסף, די בכך שנשאר רק אחד נוסף כדי שיוסף יוכל לשכנע אותו, הסיכוי של יוסף לשרוד גדל פי 2; עכשיו כדי לקבל תמורה שבה הוא שורד, מסדרים את 40 האנשים האחרים בשורה ואז בוחרים אחד משני המקומות האחורנים בשביל יוסף ומסדרים את האחרים “סביבו” (או כולם לפניו, או שהאחרון בסידור של האנשים האחרים יהיה אחריו) ויוסף מקבל סיכוי של <span>\( \frac{2\cdot40!}{41!}=\frac{2}{41}\approx4.88\% \)</span> לשרוד (ובאופן כללי, אם יוסף היה מצליח לשכנע את הנותרים כשנשארו <span>\( k \)</span> אנשים, אז הסיכוי שלו לשרוד היה <span>\( \frac{k\cdot40!}{41!}=\frac{k}{41} \)</span>).</p>

<p>העניין הוא שגם <span>\( 4.88\% \)</span> הוא לא סיכוי גדול במיוחד. במילים אחרות, אנחנו לא מאמינים ל”אולי היה זה מקרה ואולי אצבע אלוהים” של יוסף ומעדיפים לחשוב עליו בתור תחמן שהצליח איכשהו להנדס את ההגרלה לטובתו. הבעיה היא שאנחנו לא יודעים מה <strong>הייתה</strong> ההגרלה - יוסף לא מספר לנו שום דבר מעבר ל”הבו ונטיל גורלות”. אז מה עושים? ממציאים! איכשהו בפולקלור המתמטי השתרשה גרסה מאוד ספציפית של הגרלה שבה לכאורה השתמשו בסיפור הזה, והמתמטיקה מתעניינת בדיוק במחקר של סוג ההגרלה הזה.</p>

<p>בהגרלה הזו האנשים עומדים במעגל - נסמן אותם בתור המספרים מ-1 עד 41 (יש גרסאות מתמטיות שמתארות את הסיפור עם מספר שונה של אנשים, אבל המספר מהסיפור של יוסף עצמו הוא 41). בוחרים מספר כלשהו, נאמר 3 (גם פה, בגרסאות מתמטיות שונות ומשונות משתמשים גם במספרים אחרים), ואז מתחילים לעבור על המעגל 3 צעדים בפעם. בפעם הראשונה מגיעים אל איש מס’ 3 ומסירים אותו מהמעגל (אני אוותר על תיאורים אלימים יותר); אחר כך אל איש מספר 6 ומסירים גם אותו, וכך זה נמשך; אנו מסירים מהמעגל את אנשים <span>\( 3,6,9,12,15,18,21,24,27,30,33,36,39 \)</span> ולכאורה האיש הבא שנסיר אמור להיות מס’ 42, אבל אין במעגל 42 אנשים אלא רק 41, אז מתחילים מחדש ומסירים את איש מס’ 1. עכשיו נראה שהבא בתור הוא 4, אבל זה לא מה שקורה. כזכור, כבר הסרנו מהמעגל את איש מס’ 3, ולכן אם נספור שלושה צעדים החל מאיש מס’ 1, נקבל את איש 2, איש 4 ואיש 5, ולכן 5 הוא הבא בתור שיוסר מהמעגל, וכן הלאה.</p>

<p>בשיטה הזו בכלל אין חשיבות ל<strong>מזל</strong>. היא מרגישה קצת אקראית במובן זה שהיא יוצרת לנו תמורה כלשהי של האנשים, שאחרי הסיבוב הראשון סביב המעגל כבר נראית “מבולגנת”, אולם בתיאוריה, מי שיודע שיש 41 אנשים והולכים לעבור 3 בכל פעם יכול לעשות חישוב מהיר בראש ולגלות את המקום שבו כדאי לו להיות במעגל כדי להיות זה שנשאר אחרון.</p>

<p>האם זה מה שיוסף עשה, והוא גם מחשב אנושי בנוסף להיסטוריון מחונן? ובכן… כנראה שלא. כאשר יוסף נשאר עם האדם הבודד הנוסף, הוא אומר שהוא “לא רצה להלכד בגורל ולמות, וגם לא לטמא את ידו בדם אחים אם ישאר האחרון”. אבל הרי אם הייתה ננקטת שיטה דטרמיניסטית, בשלב הזה יוסף בודאות כבר היה יודע אם הוא יישאר האחרון או לא; כלומר, נראה שבכל שלב בוצעה הגרלה חדשה, בשונה מהשיטה של המעגל. אלא שזה לא משנה לנו כי עם כל הכבוד לסיפור המעניין של יוסף, אנחנו פה בשביל חידת המעגל עצמה.</p>

<p>אם כן, מה המטרה שלנו בחידה? באופן כללי, לכל מספר אנשים <span>\( n \)</span> ומספר צעדים <span>\( q \)</span> אנחנו מקבלים <strong>תמורה</strong> <span>\( J_{n,q} \)</span>, ויכולים לשאול את עצמנו כל מני שאלות עליה - איך מחשבים אותה? מה האיבר האחרון בה? מה המבנה שלה? וכדומה. זה תחום רחב שלא ידוע עליו יותר מדי במקרה הכללי, ולכן אספר כמה סיפורים ספציפיים שקשורים אליו, ונתחיל ממה שאני מחבב במיוחד: במקרה שבו <span>\( q=2 \)</span>, כלומר מתקדמים במעגל שני צעדים בכל פעם, איך אפשר לחשב מה המקום של האדם האחרון שיישאר במעגל, מבלי לחשב את כל <span>\( J_{n,2} \)</span>?</p>

<p>מה שיש לנו פה בעצם הוא <strong>סדרה</strong> של מספרים - לכל <span>\( n \)</span>, מתאים המיקום שתקף לאותו מספר אנשים <span>\( n \)</span>. בואו נסמן ב-<span>\( a_{n} \)</span> את אברי הסדרה הזו. לפנינו בעיה קומבינטורית סטנדרטית - למצוא חוקיות בתוך סדרת מספרים. איך עושים את זה? דבר ראשון שתמיד כדאי לעשות - לחשב כמה ערכים ראשונים, פשוט על ידי כך שמשחקים את המשחק. בבירור <span>\( a_{1}=1 \)</span> (כי אדם בודד הוא כבר האחרון) ו-<span>\( a_{2}=1 \)</span> (כי בשלב הראשון הולכים שני צעדים, שהראשון חולף על פני 1 והשני מגיע אל 2 ומוציא אותו) ו-<span>\( a_{3}=3 \)</span> וכך נמשיך ונקבל את הסדרה:</p>

<p><span>\( 1,1,3,1,3,5,7,1,3,5,7,9,11,13,15,1,3,5,7,\ldots \)</span></p>

<p>לא טרחתי לחשב את הסדרה בעצמי, כמובן; קל לכתוב קוד (למשל, בפייתון) שמייצר אותה:</p>
<div class="code-block">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">josephus_permutation</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">q</span><span class="p">):</span>
    <span class="n">people</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">location</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">people</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="p">(</span><span class="n">location</span> <span class="o">+</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">people</span><span class="p">)</span>
        <span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">people</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">location</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">result</span>
<span class="k">print</span><span class="p">([</span><span class="n">josephus_permutation</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)])</span></code></pre></figure>

</div>
<p>עכשיו, הסדרה נראית כמו ערבוביה גדולה אבל כמה דברים ברורים - קודם כל, יש מספרים שחוזרים על עצמם המון, אפילו בסוג של מחזוריות. שנית, כל המספרים הם <strong>אי זוגיים</strong>. אלו אבחנות פשוטות ולא מפתיעות אבל הן מצביעות על כך שיש פה סדר שאפשר למצוא. בואו נחשוב על זה - למה כל המספרים אי זוגיים? כמובן, כי מאחר ו-<span>\( q=2 \)</span> הרי שבסיבוב הראשון של ה”משחק” נפטרים מכל הערכים הזוגיים שהיו. למשל, אם <span>\( n=8 \)</span> אז הסיבוב הראשון מסלק את <span>\( 2,4,6,8 \)</span> ואז בסיבוב השני נשארנו עם <span>\( 1,3,5,7 \)</span> (שמתוכם נסיר את <span>\( 3,7 \)</span> ובסיבוב השלישי נסיר את <span>\( 5 \)</span>). בשלב הזה האינטואיציה המתמטית עשויה לקפוץ - הסיבוב הראשון בעצם מייצר לנו בעיית יוספוס <strong>חדשה</strong>, עם חצי ממספר האיברים בבעיה המקורית.</p>

<p>מהבעיה <span>\( n=8 \)</span> עברנו אל בעיה קצת מוזרה, שבה <span>\( n=4 \)</span> אבל האיברים לא ממוספרים בתור <span>\( 1,2,3,4 \)</span> אלא בתור <span>\( 1,3,5,7 \)</span>. מה הקשר בין שתי הסדרות הללו, <span>\( 1,2,3,4 \)</span> ו-<span>\( 1,3,5,7 \)</span>? זה לא קשר של שוויון, אבל אפשר <strong>לנחש</strong> שיש קשר פשוט ולראות אם זה עובד בפועל. קשר פשוט במיוחד הוא קשר <strong>לינארי</strong>, <span>\( y=ax+b \)</span> כאשר <span>\( a,b \)</span> הם קבועים. מספיק להציב ערכי <span>\( x,y \)</span> עבור שני האיברים הראשונים בסדרה כדי להסיק מה <span>\( a,b \)</span> חייבים להיות אם הקשר אכן מתקיים:</p>

<p><span>\( 1=a\cdot1+b \)</span></p>

<p><span>\( 3=a\cdot2+b \)</span></p>

<p>נחסר את המשוואה הראשונה מהשניה ונקבל <span>\( 2=a \)</span> ואז נציב את זה במשוואה הראשונה ונקבל <span>\( 1=2\cdot1+b \)</span>, כלומר <span>\( b=-1 \)</span>. במילים אחרות, אנחנו מנחשים שמתקיים הקשר הפשוט <span>\( y=2x-1 \)</span>. בדיקה זריזה תראה שהוא אכן מתקיים.</p>

<p>ייתכן שזה נראה מיותר לגמרי - שאפשר לראות “בעין” שזה הקשר בין <span>\( 1,2,3,4 \)</span> ובין <span>\( 1,3,5,7 \)</span>, ולחלקנו זה כנראה המצב; אבל מה שנחמד פה הוא שגם לניחושים ואינטואיציות כאלו יש דרך שיטתית שבה אפשר להגיע אליהם.</p>

<p>אם כן, גילינו שיטה שבה אפשר לצמצם את ממדי בעיית יוספוס: לחלק את מספר האיברים ב-2 לקבלת בעיה קטנה יותר, לקחת את התוצאה שלה, להכפיל ב-2 ולהחסיר 1. או בניסוח מתמטי:</p>

<p><span>\( a_{2n}=2a_{n}-1 \)</span></p>

<p>קל לבדוק שזה עובד לכל <span>\( n \)</span> - אבל הנוסחה הזו מטפלת רק במקרים שבהם התחלנו עם מספר <strong>זוגי</strong> של שחקנים. מה קורה במקרה האי זוגי, כלומר עבור <span>\( a_{2n+1} \)</span>?</p>

<p>ובכן, שוב כדאי להסתכל על דוגמא, נאמר עבור <span>\( 1,2,3,4,5,6,7,8,9 \)</span>. כאן אחרי הסיבוב הראשון נישאר עם <span>\( 1,3,5,7,9 \)</span>, כשהבא בתור יהיה 1. בואו נסלק גם את ה-1 הזה מהתמונה, ונישאר עם <span>\( 3,5,7,9 \)</span>. קיבלנו 4 איברים כמו קודם, רק שעכשיו ההתאמה שלו צריכה להתאים את <span>\( 1,2,3,4 \)</span> אל <span>\( 3,5,7,9 \)</span> - חישוב זריז יראה שהפעם צריך לכפול ב-2 <strong>ולחבר</strong> 1, ונקבל</p>

<p><span>\( a_{2n+1}=2a_{n}+1 \)</span></p>

<p>המסקנה שלנו היא שאפשר לתת <strong>נוסחת נסיגה</strong> פשוטה עבור <span>\( a_{n} \)</span>:</p>

<p><span>\( a_{n}=\begin{cases} 1 &amp; n=1\\ 2a_{k}-1 &amp; n=2k\\ 2a_{k}+1 &amp; n=2k+1 \end{cases} \)</span></p>

<p>הנוסחה הזו מאפשרת לנו לחשב את הרשימה <span>\( 1,1,3,1,3,5,7,1,3,5,7,9,11,13,15,1,3,5,7,\ldots \)</span> הרבה יותר בקלות. הנה קוד שעושה את זה:</p>
<div class="code-block">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">a</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></code></pre></figure>

</div>
<p>זה לכשעצמו כבר מאפשר לנו לחשב בקלות את הפתרון של בעיית יוספוס גם עבור ערכים גבוהים מאוד, אבל יש דרך לעשות את זה <strong>עוד יותר נחמד</strong>. אז בואו נראה אותה. אנחנו רוצים “לפתור” את נוסחת הנסיגה - לקבל דרך לחשב את <span>\( a_{n} \)</span> ישירות מתוך <span>\( n \)</span>, בלי לעבור דרך ערכים קטנים יותר.</p>

<p>ראשית, בואו נסתכל שוב על רשימת המספרים:</p>

<p><span>\( 1,1,3,1,3,5,7,1,3,5,7,9,11,13,15,1,3,5,7,\ldots \)</span></p>

<p>אמרנו כבר שרואים פה חזרתיות. עכשיו אולי יהיה יותר קל להבין מאיפה היא מגיעה. נוסחת הנסיגה בעצם אומרת לנו שלמעט האיבר הראשון, כל זוג אברים אחר כך יגיע בתור צמד מהצורה <span>\( 2a_{k}\pm1 \)</span> כאשר <span>\( a_{k} \)</span> הוא איבר מוקדם יותר. לי קל לדמיין את זה במבנה של <strong>עץ בינארי</strong>, כשלוקחים את האיבר הראשון בסדרה לצומת העליון, את שני הבאים להיות הבנים שלו, את <strong>ארבעת</strong> הבאים להיות הבנים של הבנים, וכן הלאה:</p>

<p><img src="/assets/img/2021/josephus_graph.png" alt="" /></p>

<p>בצורה הזו רואים שאפשר לחלק את המספרים בסדרה לקבוצות מגודל <span>\( 2^{k} \)</span> (כאשר <span>\( k \)</span> הוא מספר השורה שלהן, החל משורה 0):</p>

<p><span>\( 1 \)</span></p>

<p><span>\( 1,3 \)</span></p>

<p><span>\( 1,3,5,7 \)</span></p>

<p><span>\( 1,3,5,7,9,11,13,15 \)</span></p>

<p>וכל שכבה פשוט חוזרת על כל המספרים האי-זוגיים מ-1 ועד שהיא מתמלאת.</p>

<p>בניסוח מתמטי פורמלי אפשר לומר זאת כך: <span>\( a_{2^{k}+m}=2m+1 \)</span>, כאשר <span>\( m&lt;2^{k} \)</span>.</p>

<p>קיבלנו נוסחה סגורה יפה עבור <span>\( a_{n} \)</span>, אבל אפשר להציג אותה בצורה <strong>עוד יותר יפה</strong> אם חושבים לרגע על מה היא בעצם עושה. בשביל זה כדאי להסתכל על <strong>הייצוג הבינארי</strong> של <span>\( n \)</span>.</p>

<p>ייצוג בינארי של מספר הוא כתיבה שלו בתור סכום של חזקות של 2. כשאני כותב “1101” אני מדבר על הסכום <span>\( 1\cdot2^{0}+0\cdot2^{1}+1\cdot2^{2}+1\cdot2^{3}=1+4+8=13 \)</span>. עכשיו, אם ידוע לי ש-<span>\( n \)</span> הוא מספר מהצורה <span>\( 2^{k}+m \)</span> כאשר <span>\( m&lt;2^{k} \)</span>, מה זה אומר על הייצוג הבינארי של <span>\( n \)</span>? זה אומר שהייצוג הזה כולל <span>\( k \)</span> ספרות כשהספרה ה-<span>\( k \)</span>-ית היא 1, ויתר הספרות מרכיבות את המספר <span>\( m \)</span>. זה אומר שאם אני אקח את הייצוג הבינארי הזה ו<strong>אמחק</strong> ממנו את הספרה האחרונה הזו, אני אקבל את הייצוג הבינארי של <span>\( m \)</span> עצמו.</p>

<p>עכשיו, אם אני לוקח מספר וכופל אותו ב-2, הייצוג הבינארי שלו זז צעד אחד שמאלה: אם אני כופל את 1101 ב-2 אני מקבל 11010. אם אני לוקח את זה ומוסיף לו 1, אני משנה את הספרה הימנית ביותר מ-0 ל-1. לכן את הנוסחה <span>\( a_{2^{k}+m}=2m+1 \)</span> אפשר לתאר גם בצורה הבאה:</p>

<p>בהינתן <span>\( n \)</span>, קחו את הייצוג הבינארי שלו, הסירו מהמספר את ה-1 השמאלי ביותר והכניסו אותו מחדש במקום הימני ביותר. קיבלתן את הייצוג הבינארי של <span>\( a_{n} \)</span>. למשל, ראינו שהייצוג הבינארי של 13 הוא 1101 ולכן אחרי התעלול נעבור אל 1011, שהוא הייצוג הבינארי של <span>\( 1+2+8=11 \)</span>. כך אנו יודעים שבמקום ה-13 בסדרה יהיה האיבר 11.</p>

<p>עכשיו קיבלנו משהו שיוסף היה יכול לעשות בראש, אילו באמת היו משתמשים בשיטה הזו עם <span>\( q=2 \)</span>. היו במעגל 41 אנשים, והייצוג הבינארי של 41 הוא 101001 (את זה אפילו אני מצליח לחשב בראש) ולכן המקום שיישאר אחרון הוא 10011, שהוא המספר <span>\( 16+2+1=19 \)</span>, ולכן זה המקום שיוסף היה צריך להיות בו.</p>

<p>שימו לב שבמעבר מ-101001 אל 10011 “איבדנו” ספרה - זה כי אחרי הסרת ה-1 השמאלי ביותר מ-101001 נשארנו עם 01001, והאפס השמאלי הזה מתפוגג לו. זה בעצם מלמד אותנו מה יקרה אם נשחק את המשחק שבו אנו מתחילים עם <span>\( n \)</span>, מחליפים אותו ב-<span>\( a_{n} \)</span>, מחליפים אותו ב-<span>\( a_{a_{n}} \)</span> וכן הלאה - אנחנו הולכים לקחת את המספר <span>\( n \)</span> ולהעביר 1-ים משמאל לימין תוך שאנו מאבדים את כל האפסים בדרך, ואחרי מספר סיבובים ששווה למספר הספרות הבינאריות של <span>\( n \)</span> נישאר עם מספר שכולו 1-ים, כמספר ה-<span>\( 1 \)</span>-ים שהיו ב-<span>\( n \)</span> במקור. פורמלית, נגיע אל <span>\( 2^{\#_{1}\left(n\right)}-1 \)</span> כאשר <span>\( \#_{1}\left(n\right) \)</span> הוא מספר ה-1-ים בייצוג בינארי של <span>\( n \)</span>.</p>

<p>זו התוצאה שרציתי להציג בפוסט, למרות שאפשר לשאול עוד הרבה שאלות אחרות על בעיית יוספוס, אבל במהלך קריאה של דברים לקראת כתיבת הפוסט נתקלתי במשהו שהוא כל כך הזוי ממבט ראשון שאני חייב לספר גם עליו, אם כי הוא ידרוש גלישה למונחים טכניים מתקדמים יחסית.</p>

<p>התוצאה הזו מוזכרת בספר Matters Mathematical של Herstein ו-Kaplansky. הם מציבים לעצמם למטרה להתעניין לא בפתרון ל”בעיית יוספוס” (מי נשאר אחרון) אלא בהבנת המבנה של התמורה <span>\( J_{n,q} \)</span> כולה. בפרט, לכל תמורה הם מפרקים אותה <a href="https://gadial.net/2017/03/14/permutation_groups/">למבנה המעגלי</a> שלה.</p>

<p>למשל, את <span>\( J_{11,2} \)</span> אפשר לתאר בתור הרשימה <span>\( 2,4,6,8,10,1,5,9,3,11,7 \)</span>. הרשימה הזו היא דרך פשוטה לומר “1 עובר ל-2, 2 עובר ל-4, 3 עובר ל-6” וכן הלאה. כשרוצים לתאר דבר כזה בתור <strong>מעגל</strong> פשוט מתחילים מאיבר כלשהו ורואים לאן הוא עובר, ולאן עובר מי שהוא עובר אליו, וכן הלאה - עד שחוזרים לאיבר שהתחלנו ממנו, ואז בוחרים איבר שטרם בחרנו ופותחים מעגל חדש. אם נעשה את זה על <span>\( J_{11,2} \)</span> נקבל את הייצוג <span>\( \left(1\ 2\ 4\ 8\ 9\ 3\ 6\right)\left(5\ 10\ 11\ 7\right) \)</span> כלומר, קיבלנו שני מעגלים, שהאחד הוא מאורך 7 והשני הוא מאורך 4.</p>

<p>הרשטיין וקפלנסקי מתארים כמה תוצאות על התמורות הללו. למשל, אם <span>\( n\equiv1\left(\text{mod }4\right) \)</span> (כלומר, כשמחלקים את <span>\( n \)</span> ב-4 מקבלים שארית 1) ובנוסף לכך גם <span>\( n \)</span> וגם <span>\( 2n+1 \)</span> הם ראשוניים, אז <span>\( J_{n,2} \)</span> תורכב ממעגל אחד גדול (זה קורה עבור <span>\( J_{5,2} \)</span>, למשל). אבל התוצאה המעניינת ביותר שלהם נוגעת למקרה של <span>\( n\equiv3\left(\text{mod }4\right) \)</span> כך ש-<span>\( n \)</span> ו-<span>\( 2n+1 \)</span> שניהם ראשוניים (למשל <span>\( n=11 \)</span> שבדוגמא שלי). במקרה כזה אפשר להוכיח שיהיו בדיוק <strong>שני</strong> מעגלים בפירוק. והנה רשימה של ה<strong>אורכים</strong> של המעגלים הללו עבור ערכים קטנים של <span>\( n \)</span> שמקיימים את התנאי:</p>

<p><span>\( \begin{array}{cc} 3: &amp; 2,1\\ 11: &amp; 7,4\\ 23: &amp; 14,9\\ 83: &amp; 47,36\\ 131: &amp; 72,59\\ 179: &amp; 99,80\\ 191: &amp; 104,87\\ 239: &amp; 132,107\\ 251: &amp; 136,115 \end{array} \)</span></p>

<p>קיבלנו כאן רשימה די מוזרה של מספרים אקראיים לכאורה. מתמטיקאים אוהבים למצוא סדר בדברים האקראיים לכאורה, וכאן הסדר הוא מפתיע למדי וקשור אל <strong>תורת המספרים האלגברית</strong>. זה תחום עשיר ויפה שרק <a href="http://gadial.net/2011/08/19/algebraic_number_theory_intro_1/">נגעתי בקצה-קצהו</a> בבלוג, אבל לשמחתי ברמה שמקיפה את כל המושגים שבהם אשתמש עכשיו.</p>

<p>בתורת המספרים האלגברית מתעסקים במשהו שנקרא <strong>חוגי שלמים</strong>. בלי להיכנס להגדרה המלאה (כי אני מחביא פה כל מני מורכבויות לא רלוונטיות), אם ניקח את <span>\( \mathbb{Z} \)</span> ונרחיב אותו על ידי הוספת מספר “מבחוץ” כמו <span>\( \sqrt{-11} \)</span>, ונקבל את מה שמסומן בתור <span>\( \mathbb{Z}\left[\sqrt{-11}\right] \)</span>: אוסף כל האיברים מהצורה <span>\( a+b\sqrt{-11} \)</span> כך ש-<span>\( a,b\in\mathbb{Z} \)</span>, התוצאה תהיה מבנה אלגברי שנקרא <strong>חוג</strong> שיש בו פעולות כפל וחיבור. כך למשל</p>

<p><span>\( \left(a+b\sqrt{-11}\right)\left(c+d\sqrt{-11}\right)=\left(ac-11bd\right)+\left(ad+bc\right)\sqrt{-11} \)</span></p>

<p>החוגים שמתקבלים בצורה הזו הם מעניינים מאוד, ואפשר לחקור אותם באמצעות כלים דומים לאלו שבהם חוקרים את <span>\( \mathbb{Z} \)</span> עצמו, אבל מהר מאוד מגיעים לחוגים שבהם אחד הכלים הבסיסיים ביותר שלנו נשבר. ב-<span>\( \mathbb{Z} \)</span> יש למספרים מה שנקרא <strong>פריקות יחידה</strong>, כלומר כל מספר שלם ניתן להצגה בצורה אחת ויחידה בתור מכפלה של אי-פריקים. בחוגי שלמים כלליים יותר, לא בהכרח. הדוגמא הקלאסית היא החוג <span>\( \mathbb{Z}\left[\sqrt{-5}\right] \)</span> שבו <span>\( 6=2\cdot3=\left(1+\sqrt{-5}\right)\left(1-\sqrt{-5}\right) \)</span> הם שני פירוקים שונים של 6 לאי-פריקים.</p>

<p>בלי פריקות יחידה, הרבה מתורת המספרים נזרק לפח, וזה מאוד מצער. לכן תורת המספרים האלגברית מוצאת דרך לתקן חלקית את הבעיה. במקום לדבר על פריקות יחידה של מספרים לאי-פריקים, מדברים על פריקות שלהם ל<strong>אידאלים</strong>, כשאידאלים הם קבוצות של מספרים בעלי תכונות מסויימות (אינטואיטיבית אפשר לחשוב על אידאלים בתור משהו שאפשר לפרק אליו אי-פריקים כדי שפירוקים שאינם יחידים יגיעו בסוף לאטומים עוד יותר בסיסיים שכן יהיו משותפים). למרבה השמחה, בחוגי השלמים זה אכן מחזיר את מושג הפריקות היחידה; רק נשאר להבין מה אנחנו מאבדים במעבר מפריקות יחידה לאי-פריקים אל פריקות יחידה לאידאלים.</p>

<p>כאן נכנסת לתמונה חבורה שנקראת Ideal Class Group (“חבורת מחלקות האידאלים”?) שבמובן מסויים מתארת את האופן שבו הפריקות היחידה “נשברת” - ככל שהיא יותר גדולה ומסובכת, כך הפריקות היחידה הרוסה יותר (וה”מחיר” של תיקון שלו כדי לשמר חלק מהמתמטיקה שלנו יהיה כרוך בויתורים גדולים יותר). הקטע הזה של פריקות יחידה לאידאלים קיים במחלקה רחבה של חוגים, שנקראים <strong>חוגי דדקינד</strong>; מה שיפה בחוגי שלמים ספציפית הוא שבהם החבורה הזו יחסית נחמדה - בפרט, היא <strong>סופית</strong>. הגודל שלה נקרא “מספר המחלקה”, Class Number.</p>

<p>איך כל זה קשור אל בעיית יוספוס? פשוט מאוד, נכון שאמרתי שעבור ערכי <span>\( n \)</span> כך ש-<span>\( n,2n+1 \)</span> שניהם ראשוניים, <span>\( n\equiv3\left(\text{mod }4\right) \)</span> אז התמורה <span>\( J_{n,2} \)</span> מורכבת בדיוק משני מעגלים, וכתבתי רשימה של אורכי המעגלים הללו?</p>

<p><span>\( \begin{array}{cc} 3: &amp; 2,1\\ 11: &amp; 7,4\\ 23: &amp; 14,9\\ 83: &amp; 47,36\\ 131: &amp; 72,59\\ 179: &amp; 99,80\\ 191: &amp; 104,87\\ 239: &amp; 132,107\\ 251: &amp; 136,115 \end{array} \)</span></p>

<p>אז אם ניקח <span>\( n \)</span> ונסתכל בחוג השלמים <span>\( \mathbb{Z}\left[\sqrt{-\left(2n+1\right)}\right] \)</span>, נקבל שמספר המחלקה שלו שווה ל<strong>הפרש</strong> בין גדלי שני המעגלים שמרכיבים את <span>\( J_{n,2} \)</span>. למשל, עבור <span>\( n=11 \)</span> נקבל שמספר המחלקה של <span>\( \mathbb{Z}\left[\sqrt{-23}\right] \)</span> הוא <span>\( 7-4=3 \)</span>.</p>

<p>מה הולך פה? אין לי מושג, לא קראתי את ההוכחה. אני מניח שאחרי שרואים את ההוכחה התוצאה הזו הרבה פחות מפתיעה, אבל כרגע היא עבורי סוג של קסם - קישור שממש לא ציפיתי לו בין שני תחומים לכאורה שונים במתמטיקה. קצת מזכיר את עניין ה-Monstrous Moonshine המפורסם <a href="https://gadial.net/2009/07/14/monster/">שכתבתי עליו בבלוג</a>. במתמטיקה דברים כאלו הם חלק מהכיף.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2021/03/24/how_to_division/">&laquo; ארבע פעולות החשבון - חילוק</a>
    
    
      <a class="next" href="/2021/05/13/trigonometry_intro/">מה בעצם הולך בטריגונומטריה בתיכון? (חלק א') &raquo;</a>
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2021/04/10/josephus_problem/';
      this.page.identifier = 'http://gadial.net/2021/04/10/josephus_problem/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2021/04/10/josephus_problem/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script>

<!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
