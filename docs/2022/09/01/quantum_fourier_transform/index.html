<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>התמרת פורייה הקוונטית - לא מדויק</title>
    <link rel="icon" type="image/x-icon" href="/new_blog/favicon.ico">
    
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'David', 'Tahoma', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        /* Top navigation bar */
        .top-nav {
            background: #2c3e50;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .top-nav .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .top-nav .site-title {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        
        .top-nav .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .top-nav .nav-links a {
            color: #ecf0f1;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            white-space: nowrap;
        }
        
        .top-nav .nav-links a:hover {
            background: #34495e;
        }
        
        .top-nav .search-box {
            display: flex;
            gap: 5px;
        }
        
        .top-nav .search-box input {
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            font-size: 0.9em;
            min-width: 150px;
        }
        
        .top-nav .search-box button {
            padding: 5px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .top-nav .search-box button:hover {
            background: #2980b9;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .top-nav .nav-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .top-nav .site-title {
                text-align: center;
                margin-bottom: 10px;
            }
            
            .top-nav .nav-links {
                flex-direction: column;
                width: 100%;
            }
            
            .top-nav .nav-links a {
                text-align: center;
                padding: 8px;
            }
            
            .top-nav .search-box {
                width: 100%;
                flex-direction: column;
            }
            
            .top-nav .search-box input {
                width: 100%;
                margin-bottom: 5px;
                min-width: 0;
            }
            
            .top-nav .search-box button {
                width: 100%;
            }
        }
        
        /* Blockquote styling */
        blockquote {
            background: #f9f9f9;
            border-right: 5px solid #ccc;
            margin: 1.5em 10px;
            padding: 0.75em 16px;
            position: relative;
            font-style: italic;
        }
        
        blockquote:before {
            content: '"';
            position: absolute;
            top: -10px;
            right: 8px;
            font-size: 3.5em;
            color: #ccc;
            line-height: 1;
        }
        
        blockquote p {
            display: block;
            margin: 0 0 0.75em 0;
        }
        
        blockquote p:last-child {
            margin-bottom: 0;
        }
        
        
        body {
            line-height: 1.8;
        }
        
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            margin-bottom: 40px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .post-meta {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .post-meta .date {
            margin-left: 15px;
        }
        
        .post-meta .categories,
        .post-meta .tags {
            display: inline;
        }
        
        .post-meta .categories a,
        .post-meta .tags a {
            color: #3498db;
            text-decoration: none;
            margin: 0 5px;
        }
        
        .post-meta .categories a:hover,
        .post-meta .tags a:hover {
            text-decoration: underline;
        }
        
        article {
            font-size: 1.1em;
        }
        
        article h2 {
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.8em;
        }
        
        article h3 {
            margin-top: 25px;
            margin-bottom: 12px;
            color: #34495e;
            font-size: 1.4em;
        }
        
        article p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        article ul, article ol {
            margin-right: 30px;
            margin-bottom: 15px;
        }
        
        article li {
            margin-bottom: 8px;
        }
        
        article code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        article pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 20px;
            direction: ltr;
            text-align: left;
        }
        
        article pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        
        /* Image styles - responsive and contained */
        article img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
        }
        
        /* Math rendering styles */
        .math {
            direction: ltr;
        }
        
        span.math {
            direction: ltr;
        }
        
        /* Override RTL for KaTeX */
        .katex {
            direction: ltr;
            unicode-bidi: embed;
        }
        
        /* Force KaTeX content to wrap by overriding its internal structure */
        .katex-html {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .base {
            display: inline !important;
            white-space: normal !important;
        }
        
        .katex .mord,
        .katex .mbin,
        .katex .mrel,
        .katex .mopen,
        .katex .mclose,
        .katex .mpunct,
        .katex .minner {
            display: inline !important;
            white-space: normal !important;
        }
        
        div.math {
            display: block;
            text-align: center;
            padding: 15px 0;
            direction: ltr;
        }
        
        /* RTL adjustments for code blocks */
        .highlight {
            direction: ltr;
            text-align: left;
        }
        
        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #95a5a6;
            font-size: 0.9em;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            article {
                font-size: 1em;
            }
        }
        
        /* Post navigation */
        .post-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            gap: 20px;
        }
        
        .post-navigation .nav-link {
            flex: 1;
            text-decoration: none;
            color: #2c3e50;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            transition: background 0.2s;
        }
        
        .post-navigation .nav-link:hover {
            background: #e9ecef;
        }
        
        .post-navigation .nav-prev {
            text-align: right;
        }
        
        .post-navigation .nav-next {
            text-align: left;
        }
        
        .post-navigation .nav-label {
            font-size: 0.85em;
            color: #7f8c8d;
            display: block;
            margin-bottom: 5px;
        }
        
        .post-navigation .nav-title {
            font-weight: bold;
            font-size: 1.1em;
        }

    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <a href="/new_blog/" class="site-title">לא מדויק</a>
            <div class="nav-links">
                <a href="/new_blog/">דף הבית</a>
                <a href="/new_blog/random.html">פוסט אקראי</a>
                <a href="/new_blog/post_list.html">כל הפוסטים</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="חיפוש...">
                    <button onclick="searchPosts()">חפש</button>
                </div>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <!-- Post Navigation -->
        
        <nav class="post-navigation">
            
            <a href="/new_blog/2022/08/07/quantum_computing_math_5/" class="nav-link nav-prev">
                <span class="nav-label">פוסט ישן יותר →</span>
                <span class="nav-title">חישוב קוונטי בגישה מתמטית, חלק ה&#39;: אלגוריתם דויטש-ג&#39;וזה</span>
            </a>
            

            
            <a href="/new_blog/2022/09/06/phase_estimation_algorithm/" class="nav-link nav-next">
                <span class="nav-label">← פוסט חדש יותר</span>
                <span class="nav-title">חישוב קוונטי: אלגוריתם הערכת פאזה</span>
            </a>
            
        </nav>
        
        
        <header>
            <h1>התמרת פורייה הקוונטית</h1>
            <div class="post-meta">
                <span class="date">2022-09-01</span>
                
                <span class="categories">
                    | קטגוריות:
                    
                    <a href="/categories/חישוב קוונטי.html">חישוב קוונטי</a>
                    
                </span>
                
                
                <span class="tags">
                    | תגיות:
                    
                    <a href="/tags/חישוב קוונטי.html">חישוב קוונטי</a>
                    
                </span>
                
            </div>
        </header>
        
        <article>
            <h2>מה זה בכלל ובשביל מה זה טוב?</h2>

<p>בסדרת הפוסטים הקודמת שלי על חישוב קוונטי, מטרת העל שלי הייתה הגעה אל <strong>האלגוריתם של שור</strong>, לפירוק מהיר של מספרים לגורמים. בגלל ההשלכות המהותיות שיהיו לאלגוריתם הזה אם ימומש בפועל בצורה אמינה, הוא הפך להיות "הגביע הקדוש" של הצגה פופולרית של חישוב קוונטי - הפואנטה שמנסים להגיע אליה. וזה גרם לי קצת לרוץ על מה שקורה בדרך אליו, ובפרט דחסתי ב<a href="https://gadial.net/2014/08/24/shor_algorithm/">התחלה של הפוסט עליו</a> את הכלי המרכזי שעליו הוא מסתמך - <strong>התמרת פורייה המהירה</strong>. לכלי הזה מגיע פוסט משל עצמו, ועכשיו סוף סוף אתקן את המעוות.</p>
<p>"התמרת פורייה" היא קסם שמופיע בשלל מקומות ברחבי המתמטיקה. בגדול, הרעיון בה הוא לקחת פריט מידע כלשהו ולפרק אותו לגורמים שמאפשרים לראות דברים שחבויים לרוב מתחת לפני השטח. הדוגמא הקלאסית היא <strong>גל קול</strong>. התיאור הכללי של גל קול נותן את העוצמה שלו ("אמפליטודה") לאורך זמן. אם ניקח את גל הקול הזה ונבצע עליו התמרת פורייה, נקבל מעין פירוק שלו לאינספור גלים פשוטים, כאלו שאפשר לתאר בעזרת סינוסים וקוסינוסים, שמתאימים לתדירויות שונות ש"מתחבאות" בתוך גל הקול. אם גל הקול הוא של להקה, אז תדירויות שונות בפירוק הפורייה יתאימו לכלי נגינה שונים - יש תדירויות שמתאימות לסולנית, וכאלו שמתאימות לגיטרה בס, וכאלו שמתאימות לקלידים; ואם נחזק או נחליש תדירויות מסויימות, אז בגל הקול המקורי נשמע טוב יותר או פחות את כלי הנגינה המתאים. זה סוג של ניתוח שאפשר לבצע באמצעות התמרת פורייה שנותן אינטואיציה גם להפעלה שלה על תחומים שונים בעליל.</p>
<p>בפוסט הזה אני לא אכנס לשימושים - בפוסט הבא יופיע שימוש חזק מאוד, שנקרא <strong>הערכת פאזה</strong> והוא מה שמוביל גם לאלגוריתם של שור. אני אסתפק בלהציג את ההגדרות הפורמליות ואיך עושים את זה קוונטית.</p>
<h2>מה זו התמרת פורייה?</h2>

<p>יש לי סדרה של פוסטים על <a href="https://gadial.net/2014/04/28/fourier_series_intro/">התמרות פורייה</a> למיניהן, אז לא אכנס כאן לתיאור רחב של כל הסוגים שלהן והקשרים ביניהם (אבל יש הרבה סוגים ויש קשרים ביניהם וזה מגניב). מה שמעניין אותנו ספציפית בפוסט הזה הוא מה שנקרא <strong>התמרת פורייה הבדידה</strong> ומוגדר כך:</p>
<p>אם <span class="math">\(N\)</span> הוא מספר טבעי כלשהו ו-<span class="math">\(\left(a_{0},a_{1},\ldots,a_{N-1}\right)\in\mathbb{C}^{N}\)</span> היא סדרה של <span class="math">\(N\)</span> מספרים מרוכבים, אז התמרת פורייה הבדידה שלה היא סדרה אחרת של <span class="math">\(N\)</span> מספרים מרוכבים, <span class="math">\(\left(b_{0},\ldots,b_{N-1}\right)\)</span> שמקיימת</p>
<p><span class="math">\(b_{j}=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}a_{k}e^{\frac{2\pi i}{N}jk}\)</span></p>
<p>זו נוסחה טיפה מפחידה במבט ראשון ויהיה קריטי לנו להתרגל אליה, אז בואו נדבר שניה על מה זה <span class="math">\(e^{\frac{2\pi i}{N}jk}\)</span>. זו בסך הכל שיטת סימון למספר מרוכב מסוים, ולא סתם מספר מרוכב אלא <strong>שורש יחידה</strong> מסדר <span class="math">\(N\)</span>, כלומר מספר מרוכב <span class="math">\(z\)</span> שמקיים <span class="math">\(z^{N}=1\)</span>. למשל, שורשי היחידה מסדר 4 הם <span class="math">\(\left\{ 1,-1,i,-i\right\} \)</span>. אז התמרת פורייה הבדידה היא בסך הכל "כדי לקבל את האיבר ה-<span class="math">\(k\)</span> של ההתמרה, בואו נחבר את כל ה-<span class="math">\(a\)</span>-ים של הסדרה המקורית כשהם מוכפלים בשורשי יחידה מסויימים ש-<span class="math">\(k\)</span> מגדיר לנו". זה הכל, וזה לא כזה נורא מבחינה קונספטואלית.</p>
<p>איך כל זה קשור למספר <span class="math">\(e\)</span>? ובכן, אחת הנוסחאות הבסיסיות באנליזה מרוכבת היא <strong>נוסחת אוילר</strong>:</p>
<p><span class="math">\(e^{i\theta}=\cos\theta+i\sin\theta\)</span></p>
<p>על המספר המרוכב <span class="math">\(\cos\theta+i\sin\theta\)</span> אפשר לחשוב בתור נקודה במישור, עם קואורדינטות <span class="math">\(\left(\cos\theta,\sin\theta\right)\)</span>; אם זוכרים ש-<span class="math">\(\cos^{2}\theta+\sin^{2}\theta=1\)</span> אז רואים שהמרחק של הנקודה הזו מראשית הצירים הוא 1, כך שאפשר לחשוב על כל הנקודות מהצורה הזו בתור <strong>מעגל</strong> - מעגל היחידה. הזווית <span class="math">\(\theta\)</span> היא הזווית שיוצר קו מראשית הצירים אל הנקודה הזו ביחס לכיוון החיובי של ציר <span class="math">\(x\)</span>.</p>
<p><img src="/new_blog/img/2022/euler_formula.png" alt=""/></p>
<p>לא כזה קריטי להבין מדוע הנוסחה הזו נכונה עכשיו - מבחינתנו אפשר לחשוב עליה בתור דרך קומפקטית לכתוב מספרים מרוכבים. מה שרלוונטי לנו הוא להבין מה קורה אם מציבים <span class="math">\(\theta=2\pi\)</span>. במקרה הזה, אפשר לחשוב על המספר בתור מה שמקבלים כשמתחילים על הנקודה <span class="math">\(\left(1,0\right)\)</span> במישור ואז מבצעים סיבוב של <span class="math">\(2\pi\)</span> מעלות סביב ראשית הצירים. כזכור, <span class="math">\(2\pi\)</span> זו הדרך להגיד ברדיאנים את מה שנקרא "360 מעלות" בשפת בני אנוש - סיבוב שלם, שמחזיר אותנו אל <span class="math">\(\left(1,0\right)\)</span>. שורשי היחידה הם מה שמקבלים כשלוקחים את הסיבוב השלם הזה וחותכים אותו לחתיכות מאורך שווה - למשל, שורשי היחידה מסדר 4 מתקבלים כשמחלקים את ה-360 מעלות הללו ל-4, ומקבלים סיבובים של 90 מעלות, או <span class="math">\(\frac{\pi}{2}\)</span> בשפת הרדיאנים. כך למשל <span class="math">\(i=e^{i\frac{\pi}{2}}\)</span>.</p>
<p>את הביטוי המפחיד <span class="math">\(e^{\frac{2\pi i}{N}jk}\)</span> אפשר להציג, אם כן, בתור דבר קצת יותר רגוע:</p>
<p><span class="math">\(e^{\frac{2\pi i}{N}jk}=\left(e^{i\cdot\frac{2\pi}{N}k}\right)^{j}\)</span></p>
<p>כלומר, כדי לחשב את <span class="math">\(b_{j}\)</span>, אנחנו קודם כל לוקחים את שורשי היחידה מסדר <span class="math">\(N\)</span>, שהם איברים מהצורה <span class="math">\(e^{i\cdot\frac{2\pi}{N}\cdot k}\)</span> עבור <span class="math">\(k=0,1,\ldots,N-1\)</span>, ואז אנחנו מעלים את כולם בחזקת <span class="math">\(j\)</span>, כופלים ב-<span class="math">\(a_{n}\)</span>-ים המתאימים ומחברים. למשל, עבור <span class="math">\(N=4\)</span>:</p>
<p><span class="math">\(b_{j}=a_{0}\cdot1^{j}+a_{1}\cdot i^{j}+a_{2}\cdot\left(-1\right)^{j}+a_{3}\cdot\left(-i\right)^{j}\)</span></p>
<p>זה יניב כל מני סכומים מורכבים יותר ופחות, כתלות בערך של <span class="math">\(k\)</span>. למשל עבור <span class="math">\(j=0\)</span> נקבל פשוט</p>
<p><span class="math">\(b_{0}=\frac{1}{2}\left(a_{0}+a_{1}+a_{2}+a_{3}\right)\)</span></p>
<p>עבור <span class="math">\(j=1\)</span> כל שורשי היחידה השונים יככבו בסכום:</p>
<p><span class="math">\(b_{1}=\frac{1}{2}\left(a_{0}+ia_{1}-a_{2}-ia_{3}\right)\)</span></p>
<p>עבור <span class="math">\(j=2\)</span> דברים הולכים להתבטל כי <span class="math">\(\left(-1\right)^{2}=1\)</span> ו-<span class="math">\(\left(\pm i\right)^{2}=-1\)</span>:</p>
<p><span class="math">\(b_{2}=\frac{1}{2}\left(a_{0}-a_{1}+a_{2}-a_{3}\right)\)</span></p>
<p>וכן הלאה - אני מקווה שהעיקרון ברור.</p>
<p>החישוב של ההתמרה לא נראה פה כמו עניין קשה במיוחד, והוא באמת לא קשה במיוחד אם <span class="math">\(N\)</span> לא גדול. אבל אנחנו רוצים כן לטפל במקרה שבו <span class="math">\(N\)</span> גדול. חישוב נאיבי של ההתמרה לוקח בערך <span class="math">\(O\left(N^{2}\right)\)</span> פעולות, אבל היופי בכל הסיפור הזה הוא שקיימות שיטות מחוכמות לביצוע <strong>מהיר</strong> של התמרת פורייה הזו, שלוקחות זמן של <span class="math">\(O\left(N\log N\right)\)</span>. <a href="https://gadial.net/2014/05/27/fast_fourier_transform/">יש לי תיאור</a> של אחת מהשיטות הללו בבלוג וזה אכן יופי של דבר. כל הדברים הללו קשורים לחישוב <strong>קלאסי</strong>, בלי מחשב קוונטי.</p>
<p>בחישוב קוונטי אפשר לבצע את התמרת פורייה הזו בזמן <span class="math">\(O\left(\log^{2}N\right)\)</span>. שימו לב להבדל: בהתמרה קלאסית, הזמן הוא <span class="math">\(O\left(N\log N\right)\)</span>. בקוונטית הוא <span class="math">\(O\left(\log^{2}N\right)\)</span>. זה שינוי עצום. אנחנו נעבוד עם המקרה שבו <span class="math">\(N=2^{n}\)</span> עבור <span class="math">\(n\)</span> כלשהו; במקרה הזה, <span class="math">\(O\left(\log^{2}N\right)=O\left(n^{2}\right)\)</span> בזמן ש-<span class="math">\(O\left(N\log N\right)=O\left(n\cdot2^{n}\right)\)</span> - אקספוננציאלי ב-<span class="math">\(n\)</span> מול פולינומי ב-<span class="math">\(n\)</span>. זו הדגמה יפה מאוד של הכוח של חישוב קוונטי ביחס לחישוב רגיל.</p>
<p>אבל מה? התמרת פורייה הקוונטית היא גם המחשה מצויינת ל<strong>חולשה</strong> של חישוב קוונטי אל מול חישוב רגיל. בחישוב רגיל, אנחנו מתחילים עם הסדרה <span class="math">\(a_{0},a_{1},\ldots,a_{N-1}\)</span> ביד ומסיימים עם הסדרה <span class="math">\(b_{0},b_{1},\ldots,b_{N-1}\)</span> ביד; לעומת זאת בחישוב קוונטי מה שיהיה לנו בסוף הוא <strong>סופרפוזיציה</strong> כלשהי של אברי הסדרה <span class="math">\(b_{0},b_{1},\ldots,b_{N-1}\)</span> (ההגדרה המדויקת תכף תגיע). אנחנו לא יודעים לקרוא את ה-<span class="math">\(b\)</span>-ים מתוך הסופרפוזיציה הזו; רק למדוד אותה ולקוות לטוב, או לעשות איתה עוד דברים בהמשך החישוב, ואז למדוד אותה ולקוות לטוב. ה"מידע" של התמרת הפורייה לא נגיש לנו ישירות, אלא רק דרך אפקט עקיף. כפי שנראה בהמשך, גם האפקט העקיף הזה יכול להיות חזק מאוד, בשימושים המתאימים.</p>
<h2>איך נראית התמרת פורייה הקוונטית?</h2>

<p>כאשר <span class="math">\(N=2^{n}\)</span>, התמרת פורייה הקוונטית היא אופרטור שפועל על <span class="math">\(n\)</span> קיוביטים. כזכור, המצב הכללי של <span class="math">\(n\)</span> קיוביטים הוא סופרפוזיציה מהצורה <span class="math">\(\sum_{x\in\left\{ 0,1\right\} ^{n}}\alpha_{x}\left|x\right\rangle \)</span>, כאשר ה-<span class="math">\(\left|x\right\rangle \)</span>-ים הללו הם אברי הבסיס של המצב הקוונטי. בשביל התמרת פורייה אנקוט בשיטת סימון טיפ-טיפה שונה: הרי על כל <span class="math">\(x\in\left\{ 0,1\right\} ^{n}\)</span> כזה אפשר לחשוב בתור <strong>ייצוג בינארי</strong> של מספר, למשל <span class="math">\(110\)</span> הוא הייצוג הבינארי של <span class="math">\(1\cdot2^{2}+1\cdot2^{1}+0\cdot2^{0}=6\)</span>. אז במקום לדבר על המצב <span class="math">\(\left|110\right\rangle \)</span> אני אדבר על המצב <span class="math">\(\left|6\right\rangle \)</span>. ובאופן כללי - המצבים שלי יהיו מהצורה <span class="math">\(\left|j\right\rangle \)</span> כאשר <span class="math">\(0\le j\le N-1\)</span>.</p>
<p>שימו לב כי בשיטת הייצוג הזו, הערך של הקיוביט הראשון הוא <strong>הספרה המשמעותית ביותר</strong> ב-<span class="math">\(j\)</span> והערך של הקיוביט האחרון הוא הספרה הכי פחות משמעותית; זו בחירה שרירותית, כמובן, אבל היא תשפיע על הסימונים שלנו מכאן ואילך.</p>
<p>כעת, כדי להגדיר אופרטור אוניטרי על <span class="math">\(n\)</span> קיוביטים, מספיק להגדיר אותו על אברי הבסיס. אז הבה ונגדיר את האופרטור <span class="math">\(\text{QFT}_{N}\)</span> (ראשי תיבות של Quantum Fourier Transform):</p>
<p><span class="math">\(\text{QFT}_{N}\left(\left|j\right\rangle \right)=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}e^{\frac{2\pi i}{N}jk}\left|k\right\rangle \)</span></p>
<p>כלומר, אם אנחנו מפעילים את <span class="math">\(\text{QFT}_{N}\)</span> על סופרפוזיציה <span class="math">\(\sum_{j=0}^{N-1}a_{j}\left|j\right\rangle \)</span>, הפלט יהיה</p>
<p><span class="math">\(\sum_{j=0}^{N-1}a_{j}\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}e^{\frac{2\pi i}{N}jk}\left|k\right\rangle =\sum_{k=0}^{N-1}\left(\frac{1}{\sqrt{N}}\sum_{j=0}^{N-1}a_{j}e^{\frac{2\pi i}{N}jk}\right)\left|k\right\rangle =\)</span></p>
<p><span class="math">\(=\sum_{k=0}^{N-1}b_{k}\left|k\right\rangle \)</span></p>
<p>כלומר, כשמפעילים את <span class="math">\(\text{QFT}_{N}\)</span> על סופרפוזיציה שמקדמיה הם הסדרה <span class="math">\(\left(a_{0},a_{1},\ldots,a_{N-1}\right)\)</span> מקבלים כפלט סופרפוזיציה שמקדמיה הם הסדרה <span class="math">\(\left(b_{0},\ldots,b_{N-1}\right)\)</span>. כלומר, במקרה הזה גם סדרת הקלט וגם סדרת הפלט נתונות בצורה מובלעת; לא בתור קלט מפורש אלא בתור מקדמים של סופרפוזיציה.</p>
<p>ההגדרה <span class="math">\(\text{QFT}_{N}\left(\left|j\right\rangle \right)=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}e^{\frac{2\pi i}{N}jk}\left|k\right\rangle \)</span> מתאימה להגדרה ה"קלאסית", ותהיה מוכרת ונעימה למי שרגילים להתמרת פורייה הבדידה. אבל יש עוד דרך לתאר את אגף ימין פה - לא בתור סכום של <span class="math">\(2^{n}\)</span> מצבים על <span class="math">\(n\)</span> קיוביטים, אלא בתור <strong>מכפלה טנזורית</strong> של <span class="math">\(n\)</span> מצבים, אחד לכל קיוביט. שיטת הייצוג הנוספת הזו תהיה חדשה גם למי שמכירים את התמרת פורייה, ובמבט ראשון היא תהיה <strong>מפחידה ביותר</strong>. כל כך מפחידה, עד שגם אני, כשכתבתי בעבר דברים על התמרת פורייה הקוונטית, ניסיתי בכוח להתחמק ממנה - עד שהגעתי לשימושים בפועל בה וזה התפוצץ לי בפרצוף. האמת היא ששיטת הייצוג הזו היא גם נוחה מאוד לשימוש וגם לא כזו נוראית, אחרי שמתרגלים אליה. ומכיוון שאני לא מאמין בלשמור אתכם במתח אני אציג אותה מייד, וננסה להבין מה הולך שם ולמה זה מתאים להגדרה ה"רגילה":</p>
<p><span class="math">\(\text{QFT}_{N}\left(\left|j\right\rangle \right)\frac{1}{\sqrt{N}}\bigotimes_{t=1}^{n}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\left|1\right\rangle \right)=\)</span></p>
<p><span class="math">\(=\frac{\left(\left|0\right\rangle +e^{2\pi i0.j_{n}}\left|1\right\rangle \right)\otimes\left(\left|0\right\rangle +e^{2\pi i0.j_{n-1}j_{n}}\left|1\right\rangle \right)\otimes\cdots\otimes\left(\left|0\right\rangle +e^{2\pi i0.j_{1}\ldots j_{n}}\left|1\right\rangle \right)}{\sqrt{N}}\)</span></p>
<p>ככל הנראה הדבר הכי קשה לעיכול בנוסחה הזו הוא מה שקורה בחזקה של <span class="math">\(e\)</span>, אז אני אתחיל עם זה. בואו ננסה להבין איך נראה האיבר <span class="math">\(e^{\frac{2\pi i}{N}jk}\)</span> עבור <span class="math">\(j\)</span> כלשהו. נתחיל עם המקרה שבו <span class="math">\(k=1\)</span>. ראשית, אפשר לכתוב <span class="math">\(e^{\frac{2\pi i}{N}jk}=e^{2\pi i\cdot\frac{j}{N}}\)</span>, כלומר החלק שאנחנו צריכים להבין הוא את <span class="math">\(\frac{j}{N}\)</span>. שנית, אנחנו יודעים ש-<span class="math">\(0\le j\le N-1\)</span>, ולכן <span class="math">\(\frac{j}{N}\)</span> הולך להיות <strong>שבר</strong>: מספר בין 0 ל-1. מספרים כאלו אנחנו מייצגים בדרך כלל בייצוג עשרוני, נאמר <span class="math">\(0.125\)</span> בא לתאר את הסכום</p>
<p><span class="math">\(1\cdot\frac{1}{10}+2\cdot\frac{1}{100}+5\cdot\frac{1}{1000}=\frac{125}{1000}=\frac{1}{8}\)</span></p>
<p>כמו שאפשר לראות מהדוגמא, קל להבין איך ייראו הספרות של שבר כלשהו אם יש לנו הצגה שלו חלקי חזקה כלשהי של 10: מכיוון שהשבר שלנו היה מהצורה <span class="math">\(\frac{125}{1000}\)</span>, ידענו שהוא ייכתב בתור <span class="math">\(0.125\)</span>. אם אני מסתכל על השבר <span class="math">\(\frac{523}{1000}\)</span> אני כבר יודע שהוא ייכתב בתור <span class="math">\(0.523\)</span>.</p>
<p>ומה קורה אם אני רוצה להציג את המספר לא בשיטה העשרונית, אלא בשיטה <strong>הבינארית</strong>? בשיטה הזו אני עדיין יכול לכתוב ספרות שהן או 0 או 1 מימין לנקודה, ולקבל סכום של חזקות שליליות של 2. אם נסתכל על מספר עם שלוש ספרות מימין לנקודה, <span class="math">\(0.j_{1}j_{2}j_{3}\)</span>, הוא מייצג את</p>
<p><span class="math">\(j_{1}\cdot\frac{1}{2^{-1}}+j_{2}+\frac{1}{2^{-2}}+j_{3}\cdot\frac{1}{2^{-3}}\)</span></p>
<p>ובאופן כללי, <span class="math">\(0.j_{1}j_{2}\ldots j_{n}\)</span> הולך לייצג את <span class="math">\(\sum_{r=1}^{n}j_{r}\frac{1}{2^{r}}\)</span>. וכמו במקרה העשרוני, אם יש לי מספר שברי שמראש נתון בתור "משהו חלקי חזקה של 2", ברור לי איך ייראה הייצוג שלו: אם החזקה שבמכנה היא <span class="math">\(2^{n}\)</span>, אז אני אקח ייצוג בינארי שלו בעזרת <span class="math">\(n\)</span> ספרות, והן מה שיופיע מימין לנקודה. במילים אחרות, אם נתון לי <span class="math">\(\frac{j}{2^{n}}\)</span>, אז אני אכתוב את <span class="math">\(j\)</span> בתור <span class="math">\(j=\sum_{r=1}^{n}j_{r}2^{n-r}\)</span> (כלומר, כאן <span class="math">\(j_{1}\)</span> היא הספרה המשמעותית ביותר, <span class="math">\(j_{2}\)</span> הבאה בתור אחריה וכן הלאה; לרוב אנחנו עושים ההפך ולכן זו עשויה להיות נקודה מבלבלת). ואז אני אקבל את הייצוג הבינארי השברי</p>
<p><span class="math">\(\frac{j}{2^{n}}=0.j_{1}j_{2}\ldots j_{n}\)</span></p>
<p>אם הנקודה הזו (שלא קשורה לקוונטים או לאלגברה לינארית, סתם לייצוג של מספרים בבסיסי ספירה שונים) ברורה לכם - ברכותי! אני מקווה שהרע ביותר כבר מאחורינו.</p>
<p>עכשיו, מה קורה אם אני לוקח את המספר <span class="math">\(\frac{j}{2^{n}}=0.j_{1}j_{2}\ldots j_{n}\)</span> ומכפיל אותו פי 2? כמו שהכפלת ייצוג עשרוני רגיל ב-10 מזיזה את כל הספרות צעד אחד שמאלה, למשל <span class="math">\(10\cdot0.125=1.25\)</span>, אז גם בייצוג בינארי כל הספרות יזוזו צעד אחד שמאלה: </p>
<p><span class="math">\(2\cdot\frac{j}{2^{n}}=j_{1}.j_{2}j_{3}\ldots j_{n}\)</span>.</p>
<p>ובאופן כללי, אם אנחנו כופלים בחזקה כלשהי של 2, נאמר <span class="math">\(2^{t}\)</span> כאשר <span class="math">\(t\le n\)</span>, האפקט יהיה הזזת הספרות <span class="math">\(t\)</span> צעדים שמאלה:</p>
<p><span class="math">\(2^{t}\cdot\frac{j}{2^{n}}=j_{1}j_{2}\ldots j_{t}.j_{t+1}\ldots j_{n}\)</span>.</p>
<p>אוקיי, התרגלנו קצת לצורת הכתיב הזו. עכשיו מגיע הפאנץ'. בואו נחזור שניה אל הביטוי <span class="math">\(e^{\frac{2\pi i}{N}jk}\)</span> שכבר ראינו לא מעט כאן. אני יכול לכתוב אותו שוב פעם באופן קצת שונה: <span class="math">\(e^{2\pi i\cdot\left(k\cdot\frac{j}{N}\right)}\)</span>. כעת, מכיוון שאצלנו <span class="math">\(N=2^{n}\)</span> אפשר לכתוב אותו בתור</p>
<p><span class="math">\(e^{2\pi i\cdot\left(k\cdot\frac{j}{2^{n}}\right)}\)</span></p>
<p>ואם נניח ש-<span class="math">\(k\)</span> הוא חזקה כלשהי של 2, נאמר <span class="math">\(k=2^{n-t}\)</span> (למה לא <span class="math">\(k=2^{t}\)</span>? כי דווקא בראשון נשתמש בהמשך), אז אפשר לכתוב</p>
<p><span class="math">\(k\cdot\frac{j}{2^{n}}=j_{1}j_{2}\ldots j_{n-t}.j_{n-t+1}\ldots j_{n}\)</span></p>
<p>ועכשיו הפאנץ': את כל החלק שמשמאל לנקודה הבינארית <strong>אנחנו יכולים להעלים</strong>. למה? בגלל שיש לנו אקספוננט בחזקת <span class="math">\(2\pi i\)</span> כפול משהו. בואו נראה את זה: אם יש לי מספר מהצורה <span class="math">\(a+b\)</span> כך ש-<span class="math">\(a\)</span> הוא מספר שלם, אז מתקיים</p>
<p><span class="math">\(e^{2i\pi\left(a+b\right)}=e^{2i\pi a}\cdot e^{2i\pi b}=\left(e^{2i\pi}\right)^{a}\cdot e^{2i\pi b}=1\cdot e^{2i\pi b}=e^{2i\pi b}\)</span></p>
<p>כלומר, כל החלק של <span class="math">\(a\)</span> נעלם, כי הוא מייצג כמות שלמה של סיבובים מלאים סביב ראשית הצירים, שלא משפיעה על התוצאה הסופית. איפה היה חשוב ש-<span class="math">\(a\)</span> הוא שלם? במעבר <span class="math">\(e^{2i\pi a}=\left(e^{2i\pi}\right)^{a}\)</span> שאינו נכון באופן כללי אבל כן נכון עבור שלמים.</p>
<p>חזרה אל המקרה שלנו, שבו יש לנו מספר בייצוג בינארי שאפשר להפריד לסכום של "מה שמשמאל לנקודה" ו"מה שמימין לנקודה":</p>
<p><span class="math">\(k\cdot\frac{j}{2^{n}}=j_{1}j_{2}\ldots j_{n-t}.j_{n-t+1}\ldots j_{n}=j_{1}j_{2}\ldots j_{n-t}+0.j_{n-t+1}\ldots j_{n}\)</span></p>
<p>ולכן נקבל, עבור <span class="math">\(k=2^{n-t}\)</span>, שמתקיים </p>
<p><span class="math">\(e^{2\pi i\cdot\left(k\cdot\frac{j}{2^{n}}\right)}=e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\)</span></p>
<p>וזה בדיוק מה שהופיע בנוסחה המוזרה של <span class="math">\(\text{QFT}\)</span> שנתתי:</p>
<p><span class="math">\(\text{QFT}_{N}\left(\left|j\right\rangle \right)\frac{1}{\sqrt{N}}\bigotimes_{t=1}^{n}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\left|1\right\rangle \right)\)</span></p>
<p>כלומר, הבנו את המשמעות של הרכיב הכי בעייתי בנוסחה; עכשיו בואו נבין למה היא נכונה ושקולה אל</p>
<p><span class="math">\(\text{QFT}_{N}\left(\left|j\right\rangle \right)=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}e^{\frac{2\pi i}{N}jk}\left|k\right\rangle \)</span></p>
<p>אין כאן יותר מאשר חישוב טכני. אני לא אוהב דברים שאין בהם יותר מאשר חישוב טכני. קשה לפתח ככה אינטואיציה, והרבה ספרים פשוט נותנים את החישוב הטכני וזהו. אז לפני שנעשה את החישוב הטכני, בואו נראה דוגמא קצת יותר פשוטה: הפולינום <span class="math">\(\left(1+x\right)\left(1+x^{2}\right)\left(1+x^{3}\right)\)</span>.</p>
<p>נניח שנותנים לנו את הפולינום הזה ומבקשים מאיתנו לפתוח סוגריים. זה יהיה טכני, אין ספק, אבל מה בעצם נעשה? אנחנו בעצם יוצרים 8 שלשות: כל שלשה נבנית על ידי כך שאני בוחר איבר מהסוגריים הראשונים, איבר מהשניים ואיבר מהשלישיים, וכופל את כולם. את כל 8 התוצאות שאקבל אני מחבר. עכשיו, בגלל שבכל אחד מהסוגריים אחד האיברים הוא 1, הכפלה בו לא עושה כלום, מה שדי מפשט את מה שאני מקבל:</p>
<p><span class="math">\(1+x+x^{2}+x^{3}+x\cdot x^{2}+x\cdot x^{3}+x^{2}\cdot x^{3}+x\cdot x^{2}+x^{3}=\)</span></p>
<p><span class="math">\(=1+x+x^{2}+x^{3}+x^{3}+x^{4}+x^{5}+x^{6}\)</span></p>
<p>עכשיו אפשר לעשות את אותו דבר עם המכפלה הטנזורית שלנו:</p>
<p><span class="math">\(\bigotimes_{t=1}^{n}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\left|1\right\rangle \right)\)</span></p>
<p>כזכור, מה שיפה במכפלות טנזוריות הוא שהן משחקות יפה עם חוקי הכפל והחיבור הרגילים. אם למשל יש לי את המכפלה הפשוטה יחסית</p>
<p><span class="math">\(\left(\left|0\right\rangle +a\left|1\right\rangle \right)\otimes\left(\left|0\right\rangle +b\left|1\right\rangle \right)\)</span></p>
<p>ואני פותח את המכפלה על פי חוקי הדיסטריביוטיביות, <a href="https://gadial.net/2022/07/31/quantum_computing_math_2/">כמו שכבר ראינו</a> שאפשר לעשות במהלך סדרת הפוסטים הזו, אז אני אקבל</p>
<p><span class="math">\(\left|00\right\rangle +b\left|01\right\rangle +a\left|10\right\rangle +ab\left|11\right\rangle \)</span></p>
<p>כלומר, על ידי התבוננות בספרות של <span class="math">\(\left|x\right\rangle \)</span> אני יודע אילו איברים יופיעו במקדם של האיבר הזה: אם הספרה השמאלית, המשמעותית יותר, היא 1 אז יופיע <span class="math">\(a\)</span>, ואם הספרה הימנית היא 1 אז יופיע <span class="math">\(b\)</span>, ואם שתיהן 1 אז שניהם יופיעו. אותו הדבר יקרה גם עבור הביטוי</p>
<p><span class="math">\(\bigotimes_{t=1}^{n}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\left|1\right\rangle \right)\)</span></p>
<p>כשאני אפתח אותו, אני אקבל סכום של כל האיברים מהצורה <span class="math">\(\left|x\right\rangle \)</span> כך של-<span class="math">\(x\)</span> יש <span class="math">\(n\)</span> ספרות, והמקדמים של ה-<span class="math">\(\left|x\right\rangle \)</span> הזה יהיו מכפלות של כל ה-<span class="math">\(e\)</span>-ים המפלצתיים שמתאימים לכניסות של <span class="math">\(x\)</span> שהן 1.</p>
<p>עכשיו, כשאני מרגיש שהבנו קצת יותר טוב מה הולך ב"ביטוי המפלצתי", אני דווקא רוצה לחזור אל ההגדרה ה"רגילה" של ההתמרה:</p>
<p><span class="math">\(\text{QFT}_{N}\left(\left|j\right\rangle \right)=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}e^{\frac{2\pi i}{N}jk}\left|k\right\rangle \)</span></p>
<p>ובואו ננסה להגיע ממנה אל "הביטוי המפלצתי". הדבר היחיד בהגדרה הרגילה שעדיין לא מסתדר לנו טוב הוא ה-<span class="math">\(k\)</span> הזה. כזכור, הפישוט המאוד נחמד של <span class="math">\(e^{2\pi i\cdot\left(k\cdot\frac{j}{2^{n}}\right)}\)</span> שעשיתי קודם שבו נפטרתי מכל הספרות משמאל לנקודה הניח ש-<span class="math">\(k\)</span> הוא <strong>חזקה של </strong><strong>2</strong> וזה בוודאי לא מה שקורה כשמריצים את <span class="math">\(k\)</span> על כל המספרים מ-0 עד <span class="math">\(N-1\)</span>. כדי להתמודד עם הבעיה הזו, אנחנו עוברים להתבונן על <strong>הייצוג הבינארי</strong> של <span class="math">\(k\)</span>. מכיוון ש-<span class="math">\(0\le k\le N-1=2^{n}-1\)</span> אפשר לייצג את <span class="math">\(k\)</span> בעזרת <span class="math">\(n\)</span> ספרות בינאריות. נכתוב <span class="math">\(k=k_{1}k_{2}\ldots k_{n}\)</span>, כלומר שוב ה-<span class="math">\(k_{1}\)</span> יהיה הספרה המשמעותית ביותר, מה שאומר שבייצוג בתור סכום נקבל</p>
<p><span class="math">\(k=\sum_{t=1}^{n}2^{n-t}k_{t}\)</span></p>
<p>זוכרות שקודם מתישהו כפלתי ב-<span class="math">\(2^{n-t}\)</span> במקום ב-<span class="math">\(2^{t}\)</span> שנראה יותר טבעי? אז הנה איך <span class="math">\(2^{n-t}\)</span> צץ לו.</p>
<p>עכשיו אפשר להתחיל לעשות חשבון:</p>
<p><span class="math">\(\text{QFT}_{N}\left(\left|j\right\rangle \right)=\frac{1}{\sqrt{N}}\sum_{k=0}^{N-1}e^{\frac{2\pi i}{N}jk}\left|k\right\rangle =\)</span></p>
<p><span class="math">\(=\frac{1}{\sqrt{N}}\sum_{k_{1}k_{2}\ldots k_{n}=0}^{N-1}e^{\frac{2\pi i}{N}j\sum_{t=1}^{n}2^{n-t}k_{t}}\left|k_{1}\ldots k_{n}\right\rangle =\)</span></p>
<p><span class="math">\(\frac{1}{\sqrt{N}}\sum_{k_{1}k_{2}\ldots k_{n}=0}^{N-1}\prod_{t=1}^{n}e^{\frac{2\pi i}{N}j2^{n-t}k_{t}}\left|k_{1}\ldots k_{n}\right\rangle =\)</span></p>
<p>כשהמעבר האחרון נובע מכך שחיבור במעריך של <span class="math">\(e\)</span> הופך למכפלה, כמו בנוסחה <span class="math">\(e^{a+b}=e^{a}\cdot e^{b}\)</span>.</p>
<p>נעצור עכשיו לשניה ונסתכל על מה שהולך במעריך של ה-<span class="math">\(e\)</span> הזה: אם <span class="math">\(k_{t}=0\)</span>, אז <span class="math">\(e^{\frac{2\pi i}{N}j2^{n-t}k_{t}}=e^{0}=1\)</span> - המקדם נעלם כולו. אם לעומת זאת <span class="math">\(k_{t}=1\)</span> אנחנו נשארים עם <span class="math">\(e^{\frac{2\pi i}{N}j2^{n-t}}=e^{2\pi i\cdot0.0.j_{n-t+1}\ldots j_{n}}\)</span> שכבר מוכרים לנו בשלב הזה. אם כן, הדבר העיקרי שאנחנו צריכים לעשות עכשיו הוא לעבור מסכום של <span class="math">\(N\)</span> מכפלות של <span class="math">\(n\)</span> איברים אל מכפלה הטנזורית של <span class="math">\(n\)</span> איברים שכל אחד מהם הוא סכום של שניים:</p>
<p><span class="math">\(\frac{1}{\sqrt{N}}\sum_{k_{1}k_{2}\ldots k_{n}=0}^{N-1}\prod_{t=1}^{n}e^{\frac{2\pi i}{N}j2^{n-t}k_{t}}\left|k_{1}\ldots k_{n}\right\rangle =\)</span></p>
<p><span class="math">\(=\frac{1}{\sqrt{N}}\bigotimes_{t=1}^{n}\left(e^{\frac{2\pi i}{N}j2^{n-t}\cdot0}\left|0\right\rangle +e^{\frac{2\pi i}{N}j2^{n-t}\cdot1}\left|1\right\rangle \right)\)</span></p>
<p>ועל פי הפישוטים שהראיתי לפני רגע, אנחנו מקבלים</p>
<p><span class="math">\(\frac{1}{\sqrt{N}}\bigotimes_{t=1}^{n}\left(e^{\frac{2\pi i}{N}j2^{n-t}\cdot0}\left|0\right\rangle +e^{\frac{2\pi i}{N}j2^{n-t}\cdot1}\left|1\right\rangle \right)=\)</span></p>
<p><span class="math">\(=\frac{1}{\sqrt{N}}\bigotimes_{t=1}^{n}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\left|1\right\rangle \right)\)</span></p>
<p>וזו בדיוק הנוסחה שרצינו. זהו, החלק הגרוע ביותר הסתיים - עכשיו אנחנו יודעים איך התמרת הפורייה הקוונטית נראית בצורה שלה שתהיה לנו שימושית יותר, וגם יהיה לנו יחסית קל להבין למה המעגל הקוונטי שתכף אתאר מחשב אותה. יש רק עוד פישוט אחד אחרון שאולי כדאי לעשות: מכיוון ש-<span class="math">\(N=2^{n}\)</span> הרי שאפשר לכתוב <span class="math">\(\sqrt{N}=2^{\frac{n}{2}}\)</span> ולקבל את הנוסחה</p>
<p><span class="math">\(\frac{1}{2^{n/2}}\bigotimes_{t=1}^{n}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\left|1\right\rangle \right)\)</span></p>
<p>ולפעמים אפילו כותבים</p>
<p><span class="math">\(\bigotimes_{t=1}^{n}\frac{1}{\sqrt{2}}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\left|1\right\rangle \right)\)</span></p>
<p>בתור התמרת פורייה הקוונטית. אני אישית מאוד מחבב את הצורה האחרונה, כי אחרי שמתעסקים מספיק זמן עם חישוב קוונטי כבר מתרגלים לאהוב <span class="math">\(\sqrt{2}\)</span> מוזרים שנדחפים לכל מקום, וכפי שנראה עוד רגע - זו גם תהיה הצורה הכי מועילה עבורנו.</p>
<h2>אז איך מחשבים את זה?</h2>

<p>סיכום החלק הקודם הוא פשוט: אנחנו רוצים לממש אופרטור קוונטי בשם <span class="math">\(\text{QFT}_{N}\)</span> שמקיים</p>
<p><span class="math">\(\text{QFT}_{N}\left(\left|j\right\rangle \right)=\bigotimes_{t=1}^{n}\frac{1}{\sqrt{2}}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-t+1}\ldots j_{n}}\left|1\right\rangle \right)\)</span></p>
<p>הייצוג באגף ימין, שנראה אולי מפחיד בהתחלה, מועיל <strong>מאוד</strong> להבין מה צריך לעשות, כי זה ייצוג של מצב קוונטי בצורה פשוטה מאוד, שבה המצב של כל קיוביט מתואר <strong>בנפרד</strong>. זה לא מצב שזור; כדי להבין איך מגיעים אליו מספיק להסתכל על כל קיוביט בתורו.</p>
<p>ראשית, בואו ניזכר בזהירות מה <strong>הקלט</strong> שלנו פה. יש למעגל <span class="math">\(n\)</span> קיוביטים, והמצב שלהם הוא <span class="math">\(\left|j\right\rangle \)</span>, שאותו אני מתאר בתור <span class="math">\(\left|j_{1}j_{2}\ldots j_{n}\right\rangle \)</span> - כל <span class="math">\(j_{t}\)</span> כאן הוא או 0 או 1.</p>
<p>עכשיו, בואו נתחיל מהערך שאמור להגיע אל הקיוביט <strong>הראשון</strong>. כלומר, בנוסחה לעיל זה המקרה <span class="math">\(t=1\)</span> - המצב הבא:</p>
<p><span class="math">\(\frac{1}{\sqrt{2}}\left(\left|0\right\rangle +e^{2\pi i0.j_{n}}\left|1\right\rangle \right)\)</span></p>
<p>זה מצב פשוט מאוד, אבל הוא מסווה את זה היטב עם השימוש הזה ב-<span class="math">\(e\)</span>. בואו נראה את זה: ל-<span class="math">\(j_{n}\)</span> יש בדיוק שני ערכים אפשריים: או 0 או 1. אם <span class="math">\(j_{n}=0\)</span> אז <span class="math">\(e^{2\pi i0.j_{n}}=1\)</span> ולכן המצב הוא <span class="math">\(\frac{\left|0\right\rangle +\left|1\right\rangle }{\sqrt{2}}\)</span>. אם לעומת זאת <span class="math">\(j_{n}=1\)</span> אז <span class="math">\(0.j_{n}=\frac{1}{2}\)</span> (זכרו - <span class="math">\(0.j_{n}\)</span> הוא לא ייצוג עשרוני אלא ייצוג בינארי) ולכן <span class="math">\(e^{2\pi i0.j_{n}}=e^{\pi i}=-1\)</span> (סיבוב של 180 מעלות) ונקבל <span class="math">\(\frac{\left|0\right\rangle -\left|1\right\rangle }{\sqrt{2}}\)</span>.</p>
<p>אז במילים אחרות, המצב שצריך לקבל תלוי בערך של <span class="math">\(j_{n}\)</span>, והוא</p>
<p><span class="math">\(\begin{cases} \frac{\left|0\right\rangle +\left|1\right\rangle }{\sqrt{2}} &amp; j_{n}=0\\ \frac{\left|0\right\rangle -\left|1\right\rangle }{\sqrt{2}} &amp; j_{n}=1 \end{cases}\)</span></p>
<p>נראה מוכר? המצב הזה הוא <strong>בדיוק</strong> התוצאה של <span class="math">\(H\left(\left|j_{n}\right\rangle \right)\)</span>. ככה <span class="math">\(H\)</span> מוגדר. אז ברור לנו מה לעשות - כדי לקבל את הערך שאמור להגיע אל הקיוביט <strong>הראשון</strong> אנחנו רק צריכים להפעיל <span class="math">\(H\)</span> על הקיוביט <span class="math">\(\left|j_{n}\right\rangle \)</span>, כלומר על הקיוביט <strong>האחרון</strong>. רגע רגע רגע, משהו לא מסתדר פה.</p>
<p>תזכרו - אם אנחנו מפעילים <span class="math">\(H\)</span> על הקיוביט <strong>האחרון</strong> אנחנו משנים את הקיוביט <strong>האחרון</strong>. זה מה ששערים עושים - משנים את הקיוביט שעליו הם מופעלים. אז מה נעשה? פשוט מאוד: נפעיל את <span class="math">\(H\)</span> על הקיוביט האחרון. למעשה, כל מה שיקרה מעתה ואילך הולך לייצר לנו את הפלטים <strong>בסדר הפוך</strong> ממה שרצינו בהתחלה. זה לא נורא, כי אחרי שמסיימים לייצר את המצב שרצינו רק עם סדר קיוביטים הפוך, אפשר להפעיל שערי SWAP שמחליפים את הקיוביטים.</p>
<p>פורמלית, שער SWAP על שני קיוביטים מוגדר כך:</p>
<p><span class="math">\(\text{SWAP}\left(\left|00\right\rangle \right)=\left|00\right\rangle \)</span></p>
<p><span class="math">\(\text{SWAP}\left(\left|01\right\rangle \right)=\left|10\right\rangle \)</span></p>
<p><span class="math">\(\text{SWAP}\left(\left|10\right\rangle \right)=\left|01\right\rangle \)</span></p>
<p><span class="math">\(\text{SWAP}\left(\left|11\right\rangle \right)=\left|11\right\rangle \)</span></p>
<p>אם נפעיל אותו על שני קיוביטים לא שזורים, שאחד במצב <span class="math">\(\alpha\left|0\right\rangle +\beta\left|1\right\rangle \)</span> והשני במצב <span class="math">\(\gamma\left|0\right\rangle +\delta\left|1\right\rangle \)</span>, כלומר הם במצב המשותף</p>
<p><span class="math">\(\left(\alpha\left|0\right\rangle +\beta\left|1\right\rangle \right)\otimes\left(\gamma\left|0\right\rangle +\delta\left|1\right\rangle \right)=\alpha\gamma\left|00\right\rangle +\alpha\delta\left|01\right\rangle +\beta\gamma\left|10\right\rangle +\beta\delta\left|11\right\rangle \)</span></p>
<p>נגיע אל המצב</p>
<p><span class="math">\(\alpha\gamma\left|00\right\rangle +\beta\gamma\left|01\right\rangle +\alpha\delta\left|10\right\rangle +\beta\delta\left|11\right\rangle =\left(\gamma\left|0\right\rangle +\delta\left|1\right\rangle \right)\otimes\left(\alpha\left|0\right\rangle +\beta\left|1\right\rangle \right)\)</span></p>
<p>כלומר, זה ישיג בדיוק את האפקט שרצינו, של החלפת הקיוביטים. איך אפשר לממש <span class="math">\(\text{SWAP}\)</span> שכזה? אפשר כמובן לעשות את זה כבר ברמת החומרה של המחשב הקונטי, אבל אפשר גם להשתמש בשלושה שערי <span class="math">\(\text{CX}\)</span> בזה אחר זה: </p>
<p><span class="math">\(\text{SWAP}_{1,2}=\text{CX}_{1,2}\text{CX}_{2,1}\text{CX}_{1,2}\)</span></p>
<p><img src="/new_blog/img/2022/swap_gate.png" alt=""/></p>
<p>עשו את החישוב בעצמכם על ארבעת אברי הבסיס ותראו שהבניה הזו אכן עובדת. אז שערי SWAP הם לא בעיה משמעותית, ומעתה ואילך נמשיך לבנות את המעגל של התמרת הפורייה הקוונטית בלי לחשוש מכך שהוא מייצר לנו את הפלטים בסדר הפוך.</p>
<p>נעבור עכשיו אל המצב השני שצריך לייצר: <span class="math">\(\frac{1}{\sqrt{2}}\left(\left|0\right\rangle +e^{2\pi i0.j_{n-1}j_{n}}\left|1\right\rangle \right)\)</span>. כאן הסיפור כבר מסתבך כי בחזקה של <span class="math">\(e\)</span> מעורבות <strong>שתי</strong> ספרות של <span class="math">\(j\)</span>, גם <span class="math">\(j_{n}\)</span> וגם <span class="math">\(j_{n-1}\)</span>. אם קודם פעלנו על הקיוביט <span class="math">\(\left|j_{n}\right\rangle \)</span>, עכשיו אנחנו רוצים לפעול על <span class="math">\(\left|j_{n-1}\right\rangle \)</span>, אבל מכיוון שהמצב שאנחנו צריכים להגיע אליו מערב גם את <span class="math">\(j_{n}\)</span> ברור שהקיוביט <span class="math">\(\left|j_{n}\right\rangle \)</span> צריך להשפיע איכשהו. ההשפעה שלו תבוא לידי ביטוי בכך שנפעיל על <span class="math">\(\left|j_{n-1}\right\rangle \)</span> שער <strong>מותנה</strong>, כלומר כזה שמופעל אם <span class="math">\(j_{n}=1\)</span> ולא מופעל אם <span class="math">\(j_{n}=0\)</span>. בשביל שזה יעבוד כמו שצריך, השער המותנה הזה צריך להיות מופעל <strong>לפני</strong> שאנחנו עושים את ה-<span class="math">\(H\)</span> על <span class="math">\(\left|j_{n}\right\rangle \)</span>, אחרת נקבל סמטוחה; זכרו שכדי לייצר מצב שזור (שזה <strong>לא</strong> מה שאנחנו רוצים פה!) מפעילים <span class="math">\(H\)</span> על קיוביט כלשהו ואז <span class="math">\(CX\)</span> על קיוביט אחר, כך שה-<span class="math">\(CX\)</span> מותנה בקיוביט שהפעלנו עליו <span class="math">\(H\)</span>. כלומר, מה שאני מתאר עכשיו הולך לקרות <strong>לפני</strong> הפעלת ה-<span class="math">\(H\)</span> על <span class="math">\(\left|j_{n}\right\rangle \)</span> (לא לדאוג! עוד מעט אראה דוגמא של המעגל השלם עבור שלושה קיוביטים ואז הכל יהיה ברור).</p>
<p>עכשיו, בואו ננסה להבין מה אנחנו רוצים לעשות לקיוביט <span class="math">\(\left|j_{n-1}\right\rangle \)</span>. אנחנו רוצים לייצר ממנו את <span class="math">\(\left|0\right\rangle +e^{2\pi i0.j_{n-1}j_{n}}\left|1\right\rangle \)</span>, כלומר ליצור סופרפוזיציה, כשבסופרפוזיציה הזו לא מתעסקים עם <span class="math">\(\left|0\right\rangle \)</span> אבל כן מתעללים קשות במקדם של <span class="math">\(\left|1\right\rangle \)</span>. ראינו ש-<span class="math">\(H\)</span> שמופעל על <span class="math">\(\left|j_{n-1}\right\rangle \)</span> הוא בעל אפקט כזה: הוא עוזב את <span class="math">\(\left|0\right\rangle \)</span> בשקט אבל כופל את המקדם של <span class="math">\(\left|1\right\rangle \)</span> ב-<span class="math">\(e^{2\pi i\cdot0.j_{n-1}}\)</span>. עכשיו, מה עם <span class="math">\(j_{n}\)</span>? ובכן, יש לנו פה את הסיטואציה הרגילה שסכום במעריך הופך למכפלה:</p>
<p><span class="math">\(e^{2\pi i0.j_{n-1}j_{n}}=e^{2\pi i\left(0.j_{n-1}+0.0j_{n}\right)}=e^{2\pi i0.j_{n-1}}\cdot e^{2\pi i0.0j_{n}}\)</span></p>
<p>כלומר, אנחנו רוצים להפעיל על המצב הקוונטי ש-<span class="math">\(\left|j_{n-1}\right\rangle \)</span> הולך אליו שער שכופל ב-1 אם <span class="math">\(j_{n}=0\)</span>, אז אם <span class="math">\(j_{n}=1\)</span> אז הוא כופל ב-</p>
<p><span class="math">\(e^{2\pi i\cdot0.01}=e^{\frac{2\pi i}{4}}\)</span></p>
<p>גם זה שער מוכר לנו: <span class="math">\(e^{\frac{2\pi i}{4}}=e^{\frac{\pi i}{2}}=i\)</span>, ולכן השער שרוצים לכפול בו הוא <span class="math">\(S\)</span>:</p>
<p><span class="math">\(S=\left(\begin{array}{cc} 1 &amp; 0\\ 0 &amp; i \end{array}\right)\)</span></p>
<p>אבל ה-<span class="math">\(S\)</span> הזה, שמופעל על <span class="math">\(\left|j_{n-1}\right\rangle \)</span>, צריך להיות מותנה ב-<span class="math">\(\left|j_{n}\right\rangle \)</span>. איך מייצרים שער מותנה? <a href="https://gadial.net/2022/08/03/quantum_computing_math_4/">כבר תיארתי את זה</a> בפוסט על שערים קוונטיים: אם רוצים ליצור גרסה מותנית של האופרטור <span class="math">\(U\)</span> מסתכלים על מטריצת הבלוקים</p>
<p><span class="math">\(\left(\begin{array}{cc} I &amp; 0\\ 0 &amp; U \end{array}\right)\)</span></p>
<p>כלומר, במקרה הנוכחי מפעילים את האופרטור </p>
<p><span class="math">\(\left(\begin{array}{cccc} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; i \end{array}\right)\)</span></p>
<p>וזהו, זה משיג את האפקט שרצינו ואנו מקבלים <span class="math">\(\left|0\right\rangle +e^{2\pi i0.j_{n-1}j_{n}}\left|1\right\rangle \)</span>.</p>
<p>עוד צעד אחד וכבר נבין מה קורה באופן כללי: עכשיו אנחנו רוצים לייצר מ-<span class="math">\(\left|j_{n-2}\right\rangle \)</span> את המצב <span class="math">\(\left|0\right\rangle +e^{2\pi i0.j_{n-2}j_{n-1}j_{n}}\left|1\right\rangle \)</span>. הרעיון כבר ברור: נפעיל <span class="math">\(H\)</span> על <span class="math">\(\left|j_{n-2}\right\rangle \)</span> עצמו, ונפעיל <span class="math">\(S\)</span> מותנה על <span class="math">\(\left|j_{n-1}\right\rangle \)</span>, אבל עכשיו בשביל <span class="math">\(\left|j_{n}\right\rangle \)</span> צריך שער חדש - שער שהאפקט שלו הוא להשאיר את <span class="math">\(\left|0\right\rangle \)</span> ללא שינוי אבל לכפול את <span class="math">\(\left|1\right\rangle \)</span> ב-<span class="math">\(e^{2\pi i0.00j_{n}}\)</span>, כלומר במקרה שבו <span class="math">\(j_{n}=0\)</span> לא לעשות כלום (את זה משיגים בכך שהשער יהיה מותנה ב-<span class="math">\(\left|j_{n}\right\rangle \)</span>) ואם <span class="math">\(j_{n=1}\)</span> אז לכפול ב-<span class="math">\(e^{2\pi i0.001}=e^{\frac{2\pi i}{2^{3}}}\)</span>. אמנם, גם השער הזה חשוב מספיק כדי שיהיה לו שם משל עצמו (שער T, ועוד אדבר עליו בהמשך) אבל אנחנו מנסים להבין את הרעיון הכללי ולכן לא רוצים להמשיך להשתמש בשמות פרטניים לשערים. בשלב הזה כבר ברור שאנחנו צריכים לתת סימן כללי לשערים מהצורה <span class="math">\(e^{\frac{2\pi i}{2^{s}}}\)</span> עבור <span class="math">\(s\ge0\)</span>. הסימון המקובל הוא</p>
<p><span class="math">\(R_{s}=\left(\begin{array}{cc} 1 &amp; 0\\ 0 &amp; e^{\frac{2\pi i}{2^{s}}} \end{array}\right)\)</span></p>
<p>אם כן, <span class="math">\(R_{1}=Z,R_{2}=S,R_{3}=T\)</span> ומשם והלאה אנחנו לא טורחים לתת להם שמות. אפשר לחשוב על זה גם ככה: <span class="math">\(R_{s+1}=\sqrt{R_{s}}\)</span> (כשיש לנו מטריצה אלכסונית, השורש שלה הוא המטריצה שהאיברים על האלכסון שלה הם השורש של האיברים על האלכסון במטריצה המקורית; אבל "שורש" במספרים מרוכבים הוא עניין מסובך יותר מזה ולכן זו אינטואיציה בלבד).</p>
<p>אם כן, מה שאנחנו עושים ל-<span class="math">\(\left|j_{n-2}\right\rangle \)</span> הוא שלושה דברים:</p>
<ul> <li>מפעילים שער <span class="math">\(H\)</span> על <span class="math">\(\left|j_{n-2}\right\rangle \)</span> - זה מה שמייצר את הסופרפוזיציה הראשונית של <span class="math">\(\left|0\right\rangle \)</span> ו-<span class="math">\(\left|1\right\rangle \)</span> ועל הדרך גם כופל את <span class="math">\(\left|1\right\rangle \)</span> ב-<span class="math">\(-1\)</span> אם <span class="math">\(j_{n-2}=1\)</span> (שימו לב שאנחנו <strong>לא</strong> משתמשים פה ב-<span class="math">\(R_{1}=Z\)</span>).</li>


<li>מפעילים על <span class="math">\(\left|j_{n-2}\right\rangle \)</span> שער <span class="math">\(R_{2}\)</span> שמותנה ב-<span class="math">\(\left|j_{n-1}\right\rangle \)</span>.</li>


<li>מפעילים על <span class="math">\(\left|j_{n-2}\right\rangle \)</span> שער <span class="math">\(R_{3}\)</span> שמותנה ב-<span class="math">\(\left|j_{n}\right\rangle \)</span></li>

</ul>

<p>כל זה קורה <strong>לפני</strong> שאנחנו מטפלים בקיוביטים <span class="math">\(\left|j_{n-1}\right\rangle \)</span> ו-<span class="math">\(\left|j_{n}\right\rangle \)</span>.</p>
<p>אם <span class="math">\(n=3\)</span>, אחרי הטיפול ב-<span class="math">\(\left|j_{n-2}\right\rangle =\left|j_{1}\right\rangle \)</span> בעצם סיימנו את תיאור הפעולות שאנחנו מבצעים על כל הקיוביטים במעגל. רק צריך לזכור שבסוף המעגל עושים SWAP ל-<span class="math">\(\left|j_{1}\right\rangle \)</span> ול-<span class="math">\(\left|j_{3}\right\rangle \)</span>.</p>
<p>כך נראה המעגל במקרה הזה (האיקסים שמחוברים בקו בסיום מייצגים את ה-SWAP):</p>
<p><img src="/new_blog/img/2022/QFT_3_qubits.png" alt=""/></p>
<p>מכאן כבר די ברור מה צריך לקרות באופן כללי כשיש לנו <span class="math">\(n\)</span> קיוביטים. עבור הקיוביט ה-<span class="math">\(t\)</span>-י (<span class="math">\(1\le t\le n\)</span>), ראשית נפעיל עליו שער <span class="math">\(H\)</span> ולאחר מכן נפעיל עליו באופן סדרתי את השערים <span class="math">\(R_{2},R_{3},\ldots,R_{n+1-t}\)</span>, כאשר השער <span class="math">\(R_{k}\)</span> בסדרה הזו נשלט על ידי הקיוביט ה-<span class="math">\(k+t-1\)</span>. בסיום סדרת השערים הזו מתבצעים SWAP-ים: לכל <span class="math">\(1\le t\le n\)</span>, הקיוביט <span class="math">\(t\)</span> מוחלף עם הקיוביט <span class="math">\(n+1-t\)</span> (כשיש מספר אי זוגי של קיוביטים מן הסתם הקיוביט האמצעי לא יוחלף עם עצמו אלא פשוט לא נעשה לו כלום.</p>
<p>המעגל הזה פשוט עד להפתיע, ביחס לכל כאב הראש שעברנו עד אליו. הוא גם קטן: יש <span class="math">\(n\)</span> קיוביטים ועל כל אחד מהם מופעלים <span class="math">\(O\left(n\right)\)</span> שערים, כך שבסך הכל המעגל דורש <span class="math">\(O\left(n^{2}\right)=O\left(\log^{2}N\right)\)</span> שערים, כמו שהבטחתי בהתחלה.</p>
<p>הנה איך שזה נראה באופן כללי, רק בלי שערי ה-SWAP בסוף שקצת בעייתי לצייר:</p>
<p><img src="/new_blog/img/2022/QFT_n_qubits.png" alt=""/></p>
<p>מה עדיין חסר לנו? שימוש כלשהו שיראה למה כל זה היה טוב. שימוש מרהיב כזה יהיה בפוסט הבא; לרוע המזל, השימוש אמנם משתמש בפורייה בצורה מרהיבה אבל אחרי הפוסט הבא כנראה נשאל את עצמנו בשביל מה משתמשים בשימוש הזה. ואז יגיע האלגוריתם של שור.</p>
        </article>
        
        <footer>
            <p>© כל הזכויות שמורות לגדי אלכסנדרוביץ'</p>
        </footer>
    </div>

    
    <script>
        function searchPosts() {
            const searchTerm = document.getElementById('searchInput').value;
            if (searchTerm.trim()) {
                window.location.href = '/new_blog/post_list.html?search=' + encodeURIComponent(searchTerm);
            }
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPosts();
            }
        });
    </script>
    
    
    <!-- Auto-render KaTeX math -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\(", right: "\\)", display: false}
                ],
                throwOnError: false
            });
        });
    </script>

</body>
</html>