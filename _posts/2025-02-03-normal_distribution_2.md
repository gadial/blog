---
title: "מה הקטע עם התפלגות נורמלית? (חלק ב': על שתי הסתברויות)"
layout: post
categories:
  - הסתברות
tags:
  - התפלגות נורמלית
image: "/assets/img/2025/histogram_11.png"
description: 'על הסתברות בדידה והסתברות רציפה, איך הסתברות 0 אומרת "לא סביר אבל עדיין אפשרי" ומהומה טכנית גדולה לקינוח'
---


<h2>מבוא</h2>

<a href="https://gadial.net/2025/01/31/normal_distribution_1/">בפוסט הקודם</a> התחלתי לדבר על מה שנקרא <strong>התפלגות נורמלית</strong> ופורמלית מוגדר בתור {% equation %}f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}{% endequation %} אבל בגלל שאלו הרבה סימנים מפחידים שלא אומרים הרבה כרגע, העדפתי להסתכל על הדבר הזה:

<img src="{{site.baseurl}}{{site.post_images}}/2025/histogram_8.png" alt=""/>

התמונה הזו מציגה את הקשר בין שתי התפלגויות שונות. אחת נקראת <strong>התפלגות בינומית</strong> ומתוארת על ידי הפסים, והשניה שמתוארת על ידי קו רציף היא ההתפלגות הנורמלית, ומה שאנחנו רואים הוא שבמובן מסוים ההתפלגות הנורמלית היא <strong>קירוב טוב</strong> של ההתפלגות הבינומית. בפוסט הזה אני רוצה שנבהיר בצורה מתמטית איך בעצם מגדירים את הנפשות הפועלות - איך מגדירים התפלגויות ומה הולך בהגדרה של התפלגות נורמלית. העניין הוא שההגדרות בתורת ההסתברות הן <strong>לא דבר פשוט</strong> ולכן הפוסט הזה כבר ייכנס למתמטיקה לא לגמרי טריוויאלית. למעשה, תמונת הפסים-מול-עקומה ממחישה את זה יפה - יש שתי דרכים <strong>שונות</strong> להגדיר התפלגויות, דרך אחת שנקראת <strong>התפלגות בדידה</strong> וכאן מתאימה לפסים, והדרך השניה שנקראת <strong>התפלגות רציפה</strong> ומתאימה לעקומה. יש המון דמיון בין שתי הגישות אבל גם הבדלים מהותיים; ויש דרך "מאחדת" להציג את שניהם בתור מקרים פרטיים של אותו דבר, אבל היא לא בהכרח הופכת את הסיטואציה לקלה יותר להבנה אז אני לא אכנס אליה כאן. בואו נתחיל מהמקרה שקצת יותר מתאים לתפיסה היומיומית שלנו של הסתברות - התפלגות בדידה.

<h2>התפלגויות בדידות</h2>

בואו נסתכל על סיטואציה הסתברותית פשוטה: הטלת קוביה הוגנת. במקרה הזה, יש שש תוצאות אפשריות להטלת הקוביה: {% equation %}X=\left\{ 1,2,3,4,5,6\right\} {% endequation %}. לכל תוצאה כזו אנחנו מתאימים <strong>הסתברות</strong> שהיא תקרה: {% equation %}p\left(1\right)=p\left(2\right)=\ldots=p\left(6\right)=\frac{1}{6}{% endequation %}. הרעיון פה הוא שהסכום של כל ההסתברויות יוצא 1, או כמו שמסמנים בקיצור, {% equation %}\sum_{i=1}^{6}p\left(i\right)=1{% endequation %}. אפשר כמובן גם לדבר על קוביה לא הוגנת, למשל כזו שיש לה סיכוי של לא פחות מאשר {% equation %}\frac{1}{2}{% endequation %} ליפול על 4, וכל יתר הצדדים מתחלקים שווה בשווה. במקרה הזה, מכיוון שההסתברויות צריכות להסתכם ל-1, יש לנו הסתברות של {% equation %}\frac{1}{2}{% endequation %} לחלק בין חמישה צדדים של הקוביה, אז נקבל {% equation %}p\left(1\right)=\frac{1}{10}{% endequation %} וכן הלאה לכל {% equation %}i{% endequation %} חוץ מאשר {% equation %}p\left(4\right)=\frac{1}{2}{% endequation %}.

אפשר להכליל את הרעיון הזה בקלות: {% equation %}A=\left\{ a_{1},a_{2},\ldots,a_{n}\right\} {% endequation %} תהיה קבוצה של {% equation %}n{% endequation %} תוצאות אפשריות של הסיטואציה ההסתברותית שלנו. לכזו קבוצה קוראים <strong>מרחב המדגם</strong> (כי הסיטואציה ההסתברותית <strong>דוגמת</strong> תוצאה אחת מתוכו) ואנחנו מגדירים פונקציה {% equation %}p:A\to\left[0,1\right]{% endequation %} שמתאימה לכל איבר במרחב המדגם מספר בין 0 ל-1 כך ש-{% equation %}\sum_{i=1}^{n}p\left(a_{i}\right)=1{% endequation %}. ההגדרה הפשוטה הזו מספיקה להרבה מאוד סיטואציות הסתברותיות שאנחנו נתקלים בהן במציאות.

אבל ממש לא לכולן.

בפוסט הקודם דיברתי על הסיטואציה שבה אני זורק כדורסל ובגלל שאני לא באמת יודע איך לזרוק כדורסל לסל, יש לי הסתברות של {% equation %}\frac{1}{10}{% endequation %} לקלוע (הייתי נדיב) והשאלה שאני שואל היא - כמה זריקות לסל יידרשו לי עד שאקלע? ובכן, ברור שיש לי הסתברות של {% equation %}\frac{1}{10}{% endequation %} לקלוע בנסיון הראשון. אם פספסתי, זה קרה בהסתברות {% equation %}\frac{9}{10}{% endequation %} והסיכוי שאני אצליח בנסיון השני הוא {% equation %}\frac{1}{10}{% endequation %}, אז אינטואיטיבית יש לי הסתברות של {% equation %}\frac{9}{10}\cdot\frac{1}{10}=\frac{9}{100}{% endequation %} להצליח בזריקה השניה, וכן הלאה. טוב ויפה, אבל איך ממדלים את זה כמו שעשיתי לפני רגע, עם קבוצה {% equation %}X{% endequation %} של כל התוצאות האפשריות? אני יכול לומר משהו כמו {% equation %}p\left(1\right)=\frac{1}{10}{% endequation %} ו-{% equation %}p\left(2\right)=\frac{9}{100}{% endequation %} וכן הלאה, אבל מספר ההטלות שיידרשו לי עד שאקלע לסל הוא <strong>לא חסום</strong>. אני לא יכול להבטיח שיידרשו לי רק 42 הטלות. אם אני אגיע אל ההטלה ה-42 זה אומר שהייתי מאוד חסר מזל עד כה, אבל ליקום לא אכפת מחוסר המזל שלי עד כה - גם בהטלה ה-42, הסיכוי שלי לקלוע יהיה רק {% equation %}\frac{1}{10}{% endequation %} ולכן בהחלט ייתכן שאגיע להטלה ה-43. במילים אחרות, אם אני רוצה שיהיה לי סיכוי כלשהו למשל אפילו את הסיטואציה המאוד פשוטה הזו אני צריך ש-{% equation %}X{% endequation %} תהיה קבוצה <strong>אינסופית</strong>, במקרה הזה {% equation %}A=\left\{ 1,2,3,\ldots\right\} {% endequation %}.

אם {% equation %}X=\left\{ a_{1},a_{2},a_{3},\ldots\right\} {% endequation %} היא קבוצה אינסופית, זה יוצר לנו קושי טכני חדש. דרשתי קודם שיתקיים {% equation %}\sum_{i=1}^{n}p\left(a_{i}\right)=1{% endequation %}, אבל עכשיו {% equation %}X{% endequation %} היא <strong>אינסופית</strong> ולכן גם הסכום צריך להיות אינסופי: {% equation %}\sum_{i=1}^{\infty}p\left(a_{i}\right)=1{% endequation %}. זה מכניס לנו לתמונה מושג חדש <strong>וממש לא טריוויאלי</strong> - <a href="https://gadial.net/2008/06/17/infinite_series/">סכום אינסופי</a>, משהו שלומדים בדרך כלל בחדו"א. כל הסיפור הפך לפתע למסובך יותר: בשביל למדל סיטואציה פשוטה יחסית, אנחנו צריכים כלים מתמטיים לא לגמרי טריוויאליים.

יש עוד מושג מרכזי אחד שצריך להכיר. בואו נחזור אל ההיסטוגרמה שהבאתי בתחילת הפוסט; בפוסט הקודם סיפרתי עליה סיפור של משחק שבו אני מטיל מטבע הוגן 10 פעמים וסופר כמה פעמים נפלתי על "עץ". אפשר למדל כאן את מרחב המדגם בתור {% equation %}A=\left\{ 0,1,\ldots,10\right\} {% endequation %} אבל זה יהיה טיפה מסובך כי לא לגמרי ברור איזו הסתברות לתת לכל איבר במרחב המדגם. תחת זאת אפשר לתת מרחב מדגם שבמובן מסוים הוא פשוט יותר: {% equation %}X{% endequation %} פשוט יכיל את כל התוצאות האפשריות של הטלת מטבע הוגן 10 פעמים. אם אני אסמן "עץ" בתור 1 ו"פלי" בתור 0 אני יכול לחשוב על כל תוצאה אפשרית בתור עשירייה {% equation %}b=\left(b_{1},b_{2},\ldots,b_{10}\right){% endequation %} כך ש-{% equation %}b_{i}\in\left\{ 0,1\right\} {% endequation %}, כלומר מרחב המדגם שלי הוא מה שמסומן ב-{% equation %}A=\left\{ 0,1\right\} ^{10}{% endequation %}. בגלל שלעץ ולפלי יש בדיוק אותה הסתברות {% equation %}\frac{1}{2}{% endequation %} בכל הטלה, ההסתברות של כל עשירייה היא {% equation %}\frac{1}{2}\cdot\frac{1}{2}\cdots\frac{1}{2}=\frac{1}{2^{10}}{% endequation %} (זו עדיין אמירה אינטואיטיבית ולא טענה פורמלית - אגיע לטענה הפורמלית עוד מעט).

עכשיו, אני יכול להגדיר <strong>פונקציה</strong> {% equation %}X:A\to\mathbb{R}{% endequation %} שלכל עשירייה, סופרת כמה "עץ" יש בה, כלומר הכי פורמלית שרק אפשר, {% equation %}X\left(b\right)=\sum_{i=1}^{10}b_{i}{% endequation %}. זו פונקציה במובן הרגיל של תורת הקבוצות, אבל מכיוון שהיא מוגדרת על מרחב מדגם שיש עליו <strong>מבנה</strong> של אקראיות, המבנה הזה עובר גם אליה - אפשר לשאול עכשיו שאלות כמו "אם אני בוחר איבר מ-{% equation %}A{% endequation %} באקראי, מה ההסתברות ש-{% equation %}X{% endequation %} יחזיר עליו 3?" או בכתיב הסטנדרטי, מהו {% equation %}P\left(X=3\right){% endequation %}. התשובה לזה פשוטה: כדי ש-{% equation %}X{% endequation %} יקבל 3, צריך שמי שיעלה בגורל הוא אחד מאיברי מרחב המדגם שיש לו בדיוק 3 פעמים 1 ויתר הפעמים 0, אז אני סוכם את ההסתברויות של <strong>כל</strong> האיברים הללו. לכל איבר, ההסתברות שלו היא {% equation %}\frac{1}{2^{10}}{% endequation %}, ומספר האיברים הללו הוא בדיוק {% equation %}{10 \choose 3}{% endequation %} - מספר הדרכים לבחור 3 מקומות מתוך 10 כדי לשים בהם 1 (<a href="https://gadial.net/2010/06/20/combinatorics_intro/">יש לי פוסט</a> שמסביר את זה; כאן אני מניח שאנחנו מכירים קומבינטוריקה בסיסית), אז בסך הכל נקבל {% equation %}P\left(X=3\right)={10 \choose 3}\frac{1}{2^{10}}{% endequation %}.

הפונקציה {% equation %}X{% endequation %} שהגדרתי כאן מכונה <strong>משתנה מקרי</strong>. זה סוג האובייקטים המרכזי שאנחנו מתעסקים בו בהסתברות. היופי בשימוש במשתנים מקריים הוא שאנחנו יכולים לשמור את מרחב המדגם שלנו פשוט יחסית, ולהגדיר מעל אותו מרחב מדגם שלל משתנים מקריים שונים ומשונים, ולשאול גם שאלות יותר מורכבות מאשר סתם "איך מחשבים את זה?" אלא גם "מה הקשרים בין המשתנים המקריים השונים" וכן הלאה.

בואו נעבור למשהו כללי יותר. נניח שאני מטיל מטבע <strong>לא הוגן</strong> בדיוק {% equation %}n{% endequation %} פעמים וסופר כמה פעמים קיבלתי עץ, וניקח {% equation %}0\le k\le n{% endequation %} - מה ההסתברות שקיבלתי {% equation %}k{% endequation %} פעמים עץ? אפשר להגדיר משתנה מקרי {% equation %}X{% endequation %} כמו קודם, ועכשיו השאלה היא מהו {% equation %}P\left(X=k\right){% endequation %}. אני אסמן ב-{% equation %}p{% endequation %} את ההסתברות שבהטלת המטבע מקבלים עץ וב-{% equation %}q{% endequation %} את ההסתברות שמקבלים פלי ({% equation %}p+q=1{% endequation %} כי בכל הטלה יש הסתברות 1 שתתקבל אחת משתי התוצאות). אז כדי לקבל <strong>בדיוק</strong> {% equation %}k{% endequation %} פעמים עץ, צריך לבחור {% equation %}k{% endequation %} מתוך {% equation %}n{% endequation %} ההטלות שבהן יתקבל עץ (לזה יש {% equation %}{n \choose k}{% endequation %} אפשרויות) ואז באותן {% equation %}k{% endequation %} הטלות ההסתברות לקבל עץ הוא {% equation %}p{% endequation %} לכל הטלה, כלומר {% equation %}p^{k}{% endequation %} בסך הכל, ועבור יתר ההטלות ההסתברות לקבל פלי היא {% equation %}q{% endequation %} בכל הטלה, כלומר {% equation %}q^{n-k}{% endequation %} בסך הכל, ולכן נקבל {% equation %}P\left(X=k\right)={n \choose k}p^{k}q^{n-k}{% endequation %}. משתנה מקרי שמקיים את הנוסחה הזו נקרא <strong>משתנה מקרי בינומי</strong> או פשוט <strong>התפלגות בינומית</strong> כשהמילה "בינומי" כאן מגיעה מכך שהמספרים בנוסחה מגיעים מהבינום של ניוטון (הנוסחה {% equation %}\left(p+q\right)^{n}=\sum_{k=0}^{n}{n \choose k}p^{k}q^{n-k}{% endequation %}).

לא הייתי חייב לספר את כל סיפור המטבעות הזה. הייתי יכול פשוט <strong>להגדיר</strong> משתנה מקרי בינומי עם הנוסחה {% equation %}P\left(X=k\right)={n \choose k}p^{k}q^{n-k}{% endequation %}. להגיד "בואו ניקח {% equation %}X{% endequation %} שמקיים את הנוסחה הזו ועכשיו בואו נעשה איתו דברים". אני טרחתי וסיפרתי סיפור ובניתי מרחב מדגם {% equation %}A{% endequation %} ספציפי, אבל אפשר גם לספר סיפורים אחרים ולבנות מרחבי מדגם אחרים שעדיין יניבו לנו משתנה מקרי {% equation %}X{% endequation %} עם אותה התפלגות (אפילו אם בתור פונקציה, {% equation %}X{% endequation %} יוגדר בצורה שונה). זו רמת אבסטרקציה שקצת צריך להתרגל אליה.

עדיין, סיפור המטבעות <strong>כן</strong> עוזר לנו להבין את {% equation %}X{% endequation %} יותר טוב. הנה דוגמא: על אותו מרחב מדגם של {% equation %}A=\left\{ 0,1\right\} ^{n}{% endequation %} אני יכול להגדיר עוד משתנים מקריים {% equation %}Y_{1},Y_{2},\ldots,Y_{n}{% endequation %}. כל משתנה מקרי מסתכל על הטלת מטבע אחת ויחידה ואומר האם <strong>בה</strong> התקבל עץ או פלי. למשל {% equation %}Y_{7}{% endequation %} מקבל 1 אם בהטלה 7 יצא עץ ואחרת הוא מקבל 0. פורמלית, {% equation %}Y_{k}\left(b\right)=b_{k}{% endequation %}, אבל אני הולך לוותר יותר ויותר על ה"פורמלית" הזה ככל שנתקדם. משתנה מקרי כזה, שמקבל או 0 או 1, נקרא <strong>אינדיקטור</strong>, ובמקרה שלנו {% equation %}P\left(Y_{k}=1\right)=p{% endequation %} ואפשר לראות שמתקיים {% equation %}X=Y_{1}+Y_{2}+\ldots+Y_{n}{% endequation %}, כלומר אני יכול לתאר את {% equation %}X{% endequation %} בתור סכום של אינדיקטורים. כשאני אגיע לדיבורים על <strong>תוחלת</strong> זה יהיה נוח למדי לראות את {% equation %}X{% endequation %} ככה.

יש עוד נקודה אחת לגבי משתנים מקריים ששווה לדבר עליה עכשיו. בואו נניח שאני שולף איבר {% equation %}b\in A{% endequation %} אקראי ממרחב המדגם שלי, ועכשיו אני מסתכל על {% equation %}Y_{3}\left(b\right){% endequation %}. האם זה נותן לי <strong>אינפורמציה</strong> כלשהי על הערכים של משתנים מקריים אחרים? למשל, אם {% equation %}Y_{3}\left(b\right)=1{% endequation %}, בהחלט קיבלתי אינפורמציה כלשהי על {% equation %}X{% endequation %}: אני יודע ש-{% equation %}X\left(b\right)>0{% endequation %}. זה אומר שחשיפה למידע ש-{% equation %}Y_{3}\left(b\right)=1{% endequation %} <strong>שינתה</strong> את הערכות ההסתברות שלי לגבי {% equation %}X{% endequation %}; אם קודם הערכתי ש-{% equation %}P\left(X=0\right)=q^{n}{% endequation %}, עכשיו אני מעריך ש-{% equation %}P\left(X=0|Y_{3}=1\right)=0{% endequation %} (הקו המפריד אומר "בתנאי ש-", כלומר ההסתברות של {% equation %}X=0{% endequation %} בתנאי שמתקיים {% equation %}Y_{3}=1{% endequation %}). לעומת זאת, המידע שלי על {% equation %}Y_{5}{% endequation %} לא מושפע מידע כלשהו על {% equation %}Y_{3}{% endequation %} (כי הם בודקים הטלות שונות). כלומר, אפשר לכתוב באופן כללי {% equation %}P\left(Y_{5}=k|Y_{3}=t\right)=P\left(Y_{5}=k\right){% endequation %}. על סיטואציה כזו, שבה יש לנו משתנים {% equation %}X,Y{% endequation %} ואנחנו יודעים ש-{% equation %}P\left(X=k|Y=t\right)=P\left(X=k\right){% endequation %} אנחנו אומרים ש-{% equation %}X,Y{% endequation %} הם משתנים <strong>בלתי תלויים</strong>.

עכשיו, מה ההסתברות ש-{% equation %}X=k{% endequation %} וגם {% equation %}Y=t{% endequation %} <strong>ביחד</strong>? אני אסמן את זה ב-{% equation %}P\left(X=k\wedge Y=t\right){% endequation %}. אינטואיטיבית (ואפשר גם להוכיח את זה פורמלית) זה יהיה שווה להסתברות {% equation %}P\left(Y=t\right){% endequation %}, כפול ההסתברות ש-{% equation %}X=k{% endequation %} <strong>בהינתן</strong> שאנחנו כבר יודעים ש-{% equation %}Y=t{% endequation %}, כלומר 

{% equation %}P\left(X=k\wedge Y=t\right)=P\left(Y=t\right)\cdot P\left(X=k|Y=t\right){% endequation %}

ואם ידוע ש-{% equation %}X,Y{% endequation %} בלתי תלויים אפשר להציב {% equation %}P\left(X=k|Y=t\right)=P\left(X=k\right){% endequation %} ולקבל

{% equation %}P\left(X=k\wedge Y=t\right)=P\left(X=k\right)P\left(Y=t\right){% endequation %}

כלומר - עבור משתנים בלתי תלויים, ההסתברות לאירוע משותף לשניהם היא <strong>מכפלת</strong> ההסתברויות עבור כל אחד מהם בנפרד. זו ההצדקה (בנפנוף ידיים) לכך שההסתברות לקבל בדיוק {% equation %}k{% endequation %} פעמים "עץ" בהטלת מטבע ספציפית היא {% equation %}p^{k}q^{n-k}{% endequation %} - אחרי שבחרנו {% equation %}k{% endequation %} משתנים שיקבלו "עץ" ההסתברות שכולם אכן יקבלו עץ היא {% equation %}p^{k}{% endequation %}, מכפלת ההסתברויות של כל אחד מהם, כי הם בלתי תלויים (ואז גם מוסיפים את {% equation %}n-k{% endequation %} המשתנים האחרים שמקבלים פלי בהסתברות {% equation %}q{% endequation %} לתמונה).

<h2>התפלגויות רציפות</h2>

עד עכשיו מה שראינו היה יחסית פשוט. עכשיו בואו נסבך את זה ממש. נתחיל משאלה תמימה: איך, בעצם, עם הכלים שיש לי כרגע, אני יכול להגדיר סיטואציה הסתברותית שבה אני בוחר מספר בין {% equation %}0{% endequation %} ל-{% equation %}1{% endequation %} באקראי, בהסתברות שווה לכל מספר?

זו כמובן לא סיטואציה מופרכת. בכל שפת תכנות שמכבדת את עצמה יש פונקציית ספרייה שמחזירה מספר בין 0 ל-1 באקראי ובהסתברות אחידה לכל תוצאה. אבל לדבר על זה במונחים של שפת תכנות זו רמאות, כי בשפת תכנות יש רק מספר <strong>סופי</strong> של מספרים בין 0 ל-1 שאנחנו בכלל טורחים לייצג, אז אנחנו פשוט במקרה פשוט של הסתברות בדידה. אבל בין 0 ל-1 <strong>אין</strong> מספר סופי של מספרים. יש למשל את {% equation %}1{% endequation %}, ואת {% equation %}\frac{1}{2}{% endequation %}, ואת {% equation %}\frac{1}{3}{% endequation %}, ואת {% equation %}\frac{1}{4}{% endequation %} וכן הלאה וכן הלאה. עכשיו, מה ההסתברות שכל אחד מהמספרים הללו יתקבל? נניח ש-{% equation %}p\left(1\right)=\frac{1}{n}{% endequation %} עבור {% equation %}0\le\frac{1}{n}\le1{% endequation %} כלשהו. מכיוון שההתפלגות הזו היא אחידה, גם {% equation %}p\left(\frac{1}{2}\right)=\frac{1}{n}{% endequation %} וכן הלאה, ואז אני מקבל {% equation %}p\left(1\right)+p\left(\frac{1}{2}\right)+\ldots+p\left(\frac{1}{n+1}\right)=\frac{n+1}{n}>1{% endequation %} ואופס! חרגתי מהגבול. סכום ההסתברויות על <strong>כל</strong> התוצאות האפשריות במרחב חייב להיות לכל היותר 1 וכבר עברתי את זה. המסקנה היא פשוטה: אם אני רוצה להגדיר התפלגות כלשהי על אינסוף איברים, ההתפלגות <strong>לא יכולה</strong> להיות אחידה; היא חייבת לקטון כל הזמן, אחרת סכום ההסתברות של כל התוצאות האפשריות יעבור את 1.

אז יש לנו בעיה מהותית פה, וקל להצביע על האשם בבעיה המהותית הזו: <strong>אינסוף</strong>. מושג האינסוף מסבך לנו את החיים בצורה שבה מחשבים לא מסתבכים. העניין הוא שמתמטיקאים דווקא אוהבים את האינסוף הזה - אחרי שמתרגלים אליו ומאלפים אותו, הרבה יותר קל לבצע חישובים איתו. יש תחום שלם שעוסק בזה שנקרא <strong>חדו"א</strong>. הנקודה היא שאת מה שהולך לקרות עכשיו המתמטיקאים מקבלים בשמחה ובששון כי הוא <strong>משפר</strong> להם את תורת ההסתברות, לא מסבך אותה. אבל במבט ראשון זה יהיה קצת מוזר.

הרעיון הבסיסי הוא לשנות את הגישה שלנו להסתברות. עד עכשיו הגישה הייתה "יש לנו קבוצה {% equation %}A{% endequation %} ולכל איבר {% equation %}a\in A{% endequation %} אנחנו מגדירים הסתברות {% equation %}p\left(a\right){% endequation %}". עכשיו הגישה תהיה שונה - אנחנו <strong>לא</strong> נגדיר הסתברות עבור איבר בודד אלא עבור <strong>קבוצות</strong> של איברים, וההסתברות שנקבל באה לומר מה הסיכוי שנעלה בגורל איבר <strong>כלשהו</strong> מתוך הקבוצה.

בואו נבין קודם איך זה עובד עבור התפלגות אחידה בין 0 ל-1 כי אפילו במקרה הפשוט הזה אפשר לראות את הסיבוכים. ראשית, {% equation %}p\left(\left[0,1\right]\right)=1{% endequation %} על פי מה שזה עתה תיארתי - ההסתברות שאני אקבל איבר <strong>כלשהו</strong> בין 0 ל-1 היא כמובן 1, ההסתברות הכוללת האפשרית.

מה עם {% equation %}p\left(\left[0,\frac{1}{2}\right]\right){% endequation %}? אם חילקתי את הקטע שלי לשני חלקים שווים בגודלם, וההתפלגות אחידה, אני מניח שההסתברות שמספר אקראי יפול בחצי הראשון היא {% equation %}\frac{1}{2}{% endequation %}. אז קיבלנו {% equation %}p\left(\left[0,\frac{1}{2}\right]\right)=\frac{1}{2}{% endequation %} ומאותו נימוק {% equation %}p\left(\left[\frac{1}{2},1\right]\right)=\frac{1}{2}{% endequation %}. ואם אני אחלק את העולם שלי לשלושה חלקים? אז מתבקש ש-{% equation %}p\left(\left[0,\frac{1}{3}\right]\right)=\frac{1}{3}{% endequation %} וכן הלאה, ומכאן קצרה הדרך לטענה הכללית: {% equation %}p\left(\left[a,b\right]\right)=b-a{% endequation %}, לכל {% equation %}0\le a<b\le1{% endequation %}. כלומר, ההסתברות שמספר ייפול בקטע כלשהו שווה ממש לאורך שלו.

זה כמובן מעלה את השאלה מה קורה אם {% equation %}a=b{% endequation %}. אם ה"קטע" שלי כולל בדיוק נקודה אחת. על פי מה שאמרתי כרגע, {% equation %}p\left(\left[a,a\right]\right)=0{% endequation %}, ואם חושבים על זה לרגע פשוט <strong>אין לי ברירה</strong>, זה חייב להיות ככה בדיוק מהנימוק שכבר ראינו. אבל אם ההסתברות של איבר בודד היא 0, מה הולך כאן? איך זה ייתכן שעבור איבר בודד ההסתברות היא 0 אבל עבור קבוצה של איברים היא לא, הרי ההסתברות של כל איבר בקבוצה היא 0!

אז ראשית, אנחנו לומדים מכאן ש"הסתברות 0" בהקשר הרציף שבו אנחנו נמצאים עכשיו היא בעלת משמעות <strong>שונה</strong> מאשר "הסתברות 0" בהקשר הבדיד. בהקשר הבדיד הסתברות 0 פירושה "זה אף פעם לא יקרה לעולם בחיים תשכחו מזה אין מצב" ואילו בהקשר הרציף הסתברות 0 פירושה "זה לא משהו סביר בפני עצמו אבל זה יכול לקרות". זה לא "פרדוקס" או משהו דומה פשוט כי הסתברות רציפה היא משהו שאני ממציא <strong>כרגע</strong>. זה מבנה מתמטי שבא להקל עלינו לתאר כל מני דברים; אין איזה חוק טבע קוסמי שקובע מה המשמעות של "הסתברות 0" במבנה הזה <strong>אמורה להיות</strong>.

שנית, הקטע הזה של משהו שאינו 0 שמורכב מהרבה דברים שהם כן 0 לא אמור להיות חדש לנו, זו לא המצאה של תורת ההסתברות, אלא זו תוצאה של <strong>הגאומטריה</strong> שבחרנו לבסס את תורת ההסתברות עליה. אנחנו מגדירים את ההסתברות של קטע בתור <strong>האורך</strong> שלו, וקטע שכולל נקודה אחת הוא מאורך 0. אנחנו חיים עם זה טוב למרות שזה אומר שקטעים מאורך שגדול מ-0 מורכבים מאינסוף נקודות שהאורך של כל אחת מהן הוא כן 0, כי אנחנו לא <strong>מצפים</strong> שהאורך של קטע יהיה בסך הכל סכום האורכים של הנקודות שמרכיבות אותו אלא משהו כללי יותר. באופן דומה כשאנחנו עוברים לדו מימד אז לקו אין <strong>שטח</strong> למרות שאם ניקח ריבוע, אפשר לפרק אותו לאוסף של קווים, וכן הלאה.

בסדר, אז השלמנו נפשית עם זה שלנקודה יש הסתברות 0, והיה לנו קל לקנות את זה שבהתפלגות האחידה, ההסתברות של הקטע {% equation %}\left[a,b\right]{% endequation %} היא {% equation %}b-a{% endequation %}. אבל מה ההסתברות של קבוצות מורכבות יותר של נקודות? אז למשל, אם ניקח את איחוד הקטעים {% equation %}\left[0,\frac{1}{3}\right]\cup\left[\frac{2}{3},1\right]{% endequation %} שאורך כל אחד מהם הוא {% equation %}\frac{1}{3}{% endequation %} והם זרים, נצפה שהאורך של שניהם ביחד יהיה סכום האורכים שלהם, {% equation %}\frac{1}{3}+\frac{1}{3}{% endequation %}. זה יוצר ציפיה כללית יותר: שאם {% equation %}A,B{% endequation %} הן קבוצות זרות (או אפילו בעלות חיתוך שהוא נקודה משותפת בודדת כי פשוט אפשר להשמיט את הנקודה הזו מאחת הקבוצות) אז {% equation %}p\left(A\cup B\right)=p\left(A\right)+p\left(B\right){% endequation %}. התכונה הזו נקראת <strong>אדיטיביות</strong> ואם היא מתקיימת אז אפשר להוכיח באינדוקציה שמתקיים {% equation %}p\left(\bigcup_{i=1}^{n}A_{i}\right)=\sum_{i=1}^{n}p\left(A_{i}\right){% endequation %} עבור קבוצות זרות. אבל למעשה, אנחנו רוצים אפילו יותר מכך - בגלל שאפשר לעשות לקטע {% equation %}\left[0,1\right]{% endequation %} את מה שנקרא "פרדוקס הדיכוטומיה" (הפרדוקס שבו אכילס רוצה לרוץ מקצה אחד של מסלול לקצה השני אבל קודם הוא צריך לעבור את חצי הדרך ואז את חצי מה שנשאר וכן הלאה) ולקבל {% equation %}\left[0,1\right]=\left[0,\frac{1}{2}\right]\cup\left[\frac{1}{2},\frac{3}{4}\right]\cup\left[\frac{3}{4},\frac{7}{8}\right]\cup\ldots{% endequation %} כך שהיינו מצפים שיתקיים {% equation %}p\left(\left[0,\frac{1}{2}\right]\cup\left[\frac{1}{2},\frac{3}{4}\right]\cup\left[\frac{3}{4},\frac{7}{8}\right]\cup\ldots\right)=1{% endequation %} וזה אכן מתקיים אם מניחים ש-

{% equation %}p\left(\left[0,\frac{1}{2}\right]\cup\left[\frac{1}{2},\frac{3}{4}\right]\cup\left[\frac{3}{4},\frac{7}{8}\right]\cup\ldots\right)=p\left(\left[0,\frac{1}{2}\right]\right)+p\left(\left[\frac{1}{2},\frac{3}{4}\right]\right)+\ldots=\frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\ldots=1{% endequation %}

כשהשוויון האחרון נובע ממה שאנחנו יודעים על סכומים אינסופיים (ואנחנו יודעים אותו כי זה חלק מחדו"א). אז התכונה שאנחנו מצפים שתתקיים היא {% equation %}p\left(\bigcup_{i=1}^{\infty}A_{i}\right)=\sum_{i=1}^{\infty}p\left(A_{i}\right){% endequation %} ולדבר כזה קוראים "{% equation %}\sigma{% endequation %}-אדיטיביות".

במילים אחרות, אנחנו רוצים ש-{% equation %}p{% endequation %} תהיה פונקציה על תתי-קבוצות של {% equation %}\left[0,1\right]{% endequation %} שמקיימת {% equation %}\sigma{% endequation %}-אדיטיביות ושלכל {% equation %}A{% endequation %} יתקיים {% equation %}p\left(A\right)\ge0{% endequation %} ולא אמרתי את זה במפורש אבל מן הסתם {% equation %}p\left(\emptyset\right)=0{% endequation %} כי אפילו על קבוצה עם נקודה אחת מקבלים 0. לפונקציה {% equation %}p{% endequation %} כזו יש שם: <strong>מידה</strong>. יש תחום שלם שעוסק במידות ובשימושים הנרחבים שלהן, אבל אני לא אכנס לזה בכלל כאן, רק אעיר שלוש הערות. ראשית, מ-{% equation %}p{% endequation %} אנחנו דורשים עוד משהו שלא נדרש ממידות באופן כללי - ש-{% equation %}p{% endequation %} על "הכל" יהיה שווה 1. למידה שמקיימת את זה קוראים <strong>מידת הסתברות</strong>. שנית, גם אם ההתפלגויות הבדידות שראינו קודם אפשר לנסח בפורמליזם של מידות. אני אוותר על זה כאן, אבל זו הדרך "לאחד" את ההתפלגויות הבדידות עם הרציפות. לבסוף, וזה החלק הקריטי, <strong>למידה יש מגבלות</strong>. בפרט, פשוט אי אפשר להגדיר מידה על <strong>כל</strong> תת-הקבוצות של {% equation %}\left[0,1\right]{% endequation %} ואני נותן הוכחה לזה <a href="https://gadial.net/2010/03/03/no_measure_on_the_real_line/">כאן</a>. זה אומר שלא לכל תת-קבוצה של {% equation %}\left[0,1\right]{% endequation %} תהיה הסתברות מוגדרת, אפילו תחת ההתפלגות האחידה, פשוט כי תתי-הקבוצות הללו "מסובכות מדי" (לא לבלבל את זה עם תת-הקבוצה {% equation %}\left\{ a\right\} {% endequation %} שההסתברות שלה בהחלט מוגדרת, פשוט שווה לאפס).

כל זה דיבר רק על התפלגות <strong>אחידה</strong>, אבל מה קורה באופן כללי? במקרה הכללי עדיין ההסתברות של כל נקודה תהיה אפס, אבל לא כל הנקודות יהיו שוות זו לזו - יהיו נקודות שהאפס שלהן "יותר גדול". למעשה, זה <strong>כבר קרה</strong> אם חושבים על ההתפלגות האחידה על {% equation %}\left[0,1\right]{% endequation %} בתור משהו שה"עולם" שלו הוא כל הממשיים, {% equation %}\mathbb{R}{% endequation %}. מה שקרה הוא שלממשיים ב-{% equation %}\left[0,1\right]{% endequation %} היה משקל חיובי שבא לידי ביטוי כשמאגדים מספיק מהם ביחד, בזמן שלממשיים מחוץ לקטע היה משקל אפס ולכן לא משנה כמה מהם מאגדים ביחד, לא יוצא מזה כלום. עולה השאלה - מה הכלי הטכני שיש לנו שמסוגל לשלב ככה בין <strong>האורך</strong> של קטע ובין <strong>המשקל</strong> שאנחנו נותנים לו? ויש כלי כזה, שהוא אחד מהכוכבים הנוצצים של המתמטיקה: <strong>אינטגרל</strong>.

הנה הרעיון הפורמלי: כשאנחנו באים להגדיר משתנה מקרי רציף {% equation %}X{% endequation %}, הוא תאופיין על ידי פונקציה {% equation %}f:\mathbb{R}\to[0,\infty({% endequation %} שנקראת <strong>פונקציית צפיפות ההסתברות</strong> כך ש-{% equation %}P\left(X\in B\right)=\int_{B}f\left(x\right)dx{% endequation %} בהנחה שהאינטגרל מוגדר (ואחרת {% equation %}P\left(X\in B\right){% endequation %} פשוט לא יהיה מוגדר). ה"צפיפות" בשם הפונקציה לא תפתיע כנראה אף אחת שמכירה פיזיקה: אם יש לנו צורה {% equation %}B{% endequation %} ואנחנו רוצים לחשב את המסה שלה, אנחנו מבצעים אינטגרל על {% equation %}B{% endequation %} על הפונקציה שמתארת את <strong>הצפיפות</strong> של {% equation %}B{% endequation %} (כמה מסה מרוכזת בכל איזור של {% equation %}B{% endequation %}). זה בדיוק אותו רעיון.

הדרישה היחידה שלנו מ-{% equation %}f{% endequation %} פרט לחיוביות שלה היא שההסתברות הכוללת תצא 1, כלומר שיתקיים {% equation %}\int_{-\infty}^{\infty}f\left(x\right)dx=1{% endequation %}. אני מניח כאן שאנחנו בסדר עם אינטגרלים מוכללים - אבל גם אם אנחנו לא בסדר לא נורא, נראה שהחישובים הרלוונטיים הם לא סוף העולם.

עבור ההתפלגות האחידה, פונקציית הצפיפות די פשוטה:

{% equation %}f\left(x\right)=\begin{cases} 1 & x\in\left[0,1\right]\\ 0 & x\notin\left[0,1\right] \end{cases}{% endequation %}.

אם היינו רוצים להגדיר התפלגות אחידה על קטע גדול יותר, למשל {% equation %}\left[0,2\right]{% endequation %}, היינו צריכים לשנות את הפונקציה בהתאם כדי שהאינטגרל על הכל ייצא 1:

{% equation %}f\left(x\right)=\begin{cases} \frac{1}{2} & x\in\left[0,2\right]\\ 0 & x\notin\left[0,2\right] \end{cases}{% endequation %}

הבנו את הרעיון? יפה, אז אפשר סוף כל סוף להגיע אל ההתפלגות שהיא הסיבה שלשמה נתכנסנו: ההתפלגות הנורמלית.

<h2>מפגש ראשון עם התפלגות נורמלית</h2>

אמרתי בתחילת הפוסט שהתפלגות נורמלית מוגדרת עם {% equation %}f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}{% endequation %} ועכשיו אנחנו סוף סוף יכולים להבין מה הולך כאן, אבל זה <strong>עדיין</strong> מסובך מדי; לעת עתה אני אסתכל על מקרה פרטי מרכזי, שממנו בעצם קל יחסית להבין את המקרה הכללי - הפונקציה {% equation %}f\left(x\right)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}{% endequation %} שמתקבלת מהצבת {% equation %}\mu=0,\sigma=1{% endequation %} בנוסחה הקודמת. ככה הפונקציה הזו נראית כשמציירים גרף שלה:

<img src="{{site.baseurl}}{{site.post_images}}/2025/histogram_11.png" alt=""/>

הגרף הזה מתאר רק את החלק {% equation %}\left[-3,3\right]{% endequation %} כי זה החלק המעניין; מחוץ לו הפונקציה פשוט נראית ממש שטוחה. לפונקציה הזו יש שלל שמות - בפרט "עקומת הפעמון" בגלל הצורה שלה, או "גאוסיאן" על שם המתמטיקאי גאוס שעשה בה שימוש נרחב (אבל לא היה הראשון שתיאר אותה; זה היה דה-מואבר).

השאלה המנחה שלנו בכל סדרת הפוסטים הזו היא "מאיפה הפונקציה הזו הגיעה בכלל?" והתשובה שאני נותן כאן היא "ממשפט הגבול המרכזי" שאותו אני עוד צריך להראות פורמלית אבל כבר אמרתי מהו - העקומה הספציפית הזו פשוט מתארת <strong>ממש טוב</strong> את מה שקורה כשיש לנו משתנה מקרי ואנחנו מחברים הרבה עותקים בלתי תלויים של עצמו. אבל כבר בשלב הזה אני יכול להסביר מאיפה<strong> חלק</strong> מהפונקציה הגיע - למה {% equation %}\pi{% endequation %} נמצא שם. התשובה הקצרה היא שהוא שם כי {% equation %}2\pi{% endequation %} הוא היקף מעגל היחידה. התשובה הקצת פחות קצרה היא שהוא שם בגלל הדרישה {% equation %}\int_{-\infty}^{\infty}f\left(x\right)dx=1{% endequation %} על פונקציות צפיפות. בואו נעבור לתשובה המלאה.

אז כאמור, אנחנו צריכים להראות שמתקיים {% equation %}\int_{-\infty}^{\infty}f\left(x\right)dx=1{% endequation %}, כלומר {% equation %}\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}dx=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx=1{% endequation %}, כלומר מספיק להראות ש-{% equation %}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx=\sqrt{2\pi}{% endequation %}. עכשיו, איך בדרך כלל מחשבים אינטגרל מהצורה {% equation %}\int_{-\infty}^{\infty}f\left(x\right)dx{% endequation %}? קודם כל מוצאים <strong>פונקציה קדומה</strong>, {% equation %}F\left(x\right){% endequation %} כך ש-{% equation %}F^{\prime}\left(x\right)=f\left(x\right){% endequation %}. אחר כך מחשבים את האינטגרל על הגבולות הסופיים {% equation %}\int_{a}^{b}f\left(x\right)dx=F\left(b\right)-F\left(a\right){% endequation %}, ולבסוף משאיפים בזהירות את {% equation %}b{% endequation %} ל-{% equation %}\infty{% endequation %} ואת {% equation %}a{% endequation %} ל-{% equation %}-\infty{% endequation %} ובודקים לאן הביטוי הולך.

זה לא מה שיקרה כאן.

לב הבעיה הוא שלפונקציה {% equation %}e^{-x^{2}}{% endequation %} <strong>אין</strong> פונקציה קדומה שאפשר להציג בצורה פשוטה ("אלמנטרית"). להוכיח את זה זה סיפור בפני עצמו ואני לא אכנס לזה הפעם, אבל תשכחו מהשיטה המסורתית. לא נחשב את האינטגרל הזה בדרך המסורתית. למרבה השמחה, לא חסרות דרכים אחרות.

בואו נסמן {% equation %}I=\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx{% endequation %}. במקום להוכיח {% equation %}I=\sqrt{2\pi}{% endequation %}, נוכיח ש-{% equation %}I^{2}=2\pi{% endequation %} (ובגלל שהאינטגרל של {% equation %}I{% endequation %} הוא על פונקציה <strong>חיובית</strong>, {% equation %}I{% endequation %} הוא השורש החיובי של {% equation %}2\pi{% endequation %}). הרעיון הוא להפוך את {% equation %}I^{2}{% endequation %}, שהוא מכפלה של שני אינטגרלים במשתנה יחיד, לאינטגרל <strong>כפול</strong> באמצעות מה שנקרא <strong>משפט פוביני</strong>. בואו נתחיל מלראות איך זה בערך עובד ואז נדבר על הפרטים הטכניים שצריך לגהץ. הטריק הבסיסי הוא זה:

{% equation %}I^{2}=\left(\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx\right)\left(\int_{-\infty}^{\infty}e^{-\frac{y^{2}}{2}}dy\right)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy{% endequation %}

עכשיו מבצעים <strong>החלפת משתנים</strong> של האינטגרל הכפול. מגדירים

{% equation %}x=r\cos\theta{% endequation %}

{% equation %}y=r\sin\theta{% endequation %}

עבור {% equation %}r\in[0,\infty({% endequation %} ו-{% equation %}\theta\in\left[0,2\pi\right]{% endequation %}

מה שנותן לנו:

{% equation %}x^{2}+y^{2}=r^{2}\left(\cos^{2}\theta+\sin^{2}\theta\right)=r^{2}{% endequation %}

{% equation %}dxdy=rd\theta dr{% endequation %}

כלומר

{% equation %}\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy=\int_{0}^{\infty}\left(\int_{0}^{2\pi}re^{-\frac{r^{2}}{2}}d\theta\right)dr={% endequation %}

{% equation %}=2\pi\int_{0}^{\infty}re^{-\frac{r^{2}}{2}}dr=-2\pi\left.e^{\frac{-r^{2}}{2}}\right|_{0}^{\infty}=2\pi{% endequation %}

אוקיי, מה קרה פה כרגע? לי זה נראה כמו קסם בכל פעם שאני רואה את זה, אבל האמת היא שלא קרה פה שום דבר חריג - זה תרגיל מאוד סטנדרטי בחדו"א, וכפי שקורה בדרך כלל בחדו"א - <strong>להצדיק</strong> כל מעבר דורש עבודה אבל מרגע שיושב לנו למה אפשר להצדיק את כולם, העבודה היא די פשוטה. אני אתחיל דווקא מהסוף ואלך אחורה צעד-צעד כדי שנראה שהכל תקין, כי ככל שמתקרבים להתחלה כך הנניח-נזניח שלנו נהיה גדול יותר.

ראשית, האינטגרל {% equation %}\int_{0}^{\infty}re^{-\frac{r^{2}}{2}}dr{% endequation %}. הוא מאוד מזכיר את מה שהתחלנו ממנו, {% equation %}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx{% endequation %}, אבל יש הבדל מהותי אחד: {% equation %}e^{-\frac{r^{2}}{2}}{% endequation %} מוכפל ב-{% equation %}r{% endequation %}, וההבדל הקטן הזה פירושו <strong>שיש</strong> פונקציה קדומה אלמנטרית לאינטגרנד. אם אנחנו גוזרים את {% equation %}e^{x}{% endequation %} אנחנו מקבלים {% equation %}e^{x}{% endequation %}; זו התכונה הבסיסית של הפונקציה הזו (אפשר אפילו <strong>להגדיר</strong> אותה באמצעותה, <a href="https://gadial.net/2010/03/27/exponent/">הנה פוסט</a> שעושה את זה). עכשיו, על פי כלל השרשרת, {% equation %}\left(e^{g\left(x\right)}\right)^{\prime}=g^{\prime}\left(x\right)e^{g\left(x\right)}{% endequation %}, ומכיוון שבמקרה שלנו {% equation %}g\left(r\right)=-\frac{r^{2}}{2}{% endequation %} נקבל {% equation %}g^{\prime}\left(r\right)=-r{% endequation %} כלומר {% equation %}\left(e^{-\frac{r^{2}}{2}}\right)=-re^{-\frac{r^{2}}{2}}{% endequation %} ולכן הפונקציה הקדומה של {% equation %}re^{-\frac{r^{2}}{2}}{% endequation %} היא {% equation %}-e^{-\frac{r^{2}}{2}}{% endequation %}.

מה שנשאר לנו, אם אנחנו יודעים את הפונקציה הקדומה, הוא לחשב את {% equation %}-2\pi\left.e^{\frac{-r^{2}}{2}}\right|_{0}^{\infty}{% endequation %}. החישוב הוא סטנדרטי לאינטגרלים מוכללים: כדי לחשב את {% equation %}\left.F\left(r\right)\right|_{0}^{\infty}{% endequation %} לוקחים {% equation %}a\in[0,\infty({% endequation %} כלשהו ומחשבים את {% equation %}\lim_{a\to\infty}\left[F\left(a\right)-F\left(0\right)\right]{% endequation %}. במקרה שלנו, {% equation %}\lim_{a\to\infty}e^{-\frac{a^{2}}{2}}=0{% endequation %} כי {% equation %}e^{x}{% endequation %} הוא פונקציה רציפה וכש-{% equation %}a\to\infty{% endequation %} אז {% equation %}-\frac{a^{2}}{2}\to-\infty{% endequation %} ואנחנו יודעים ש-{% equation %}\lim_{x\to-\infty}e^{x}=0{% endequation %}. מצד שני, כשמציבים {% equation %}ra=0{% endequation %} ב-{% equation %}e^{\frac{-r^{2}}{2}}{% endequation %} מקבלים 1, ולכן בסך הכל נשארים עם {% equation %}-2\pi\cdot0-\left(-2\pi\cdot1\right)=2\pi{% endequation %}. עד כאן הכל טוב.

עכשיו בואו נדבר על <strong>החלפת המשתנים</strong> שמאפשרת לנו לכתוב {% equation %}\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy=\int_{0}^{\infty}\left(\int_{0}^{2\pi}re^{-\frac{r^{2}}{2}}d\theta\right)dr{% endequation %}. כאן יש את הפער הגדול ביותר בין כמה שהפעולה הטכנית הזו היא סטנדרטית אחרי שהתרגלנו אליה, וכמה המשפט שעליה היא מבוססת הוא עמוק ומורכב. <a href="https://gadial.net/2016/04/12/general_change_of_variables/">יש לי פוסט</a> על הוכחת המשפט באופן כללי וזה... לא כל כך פשוט. אבל למרבה השמחה מה שפשוט הוא <strong>הרעיון</strong>. את הרעיון, גם במקרה הכי כללי, אפשר לתאר על ידי הנוסחה הפשוטה

{% equation %}\int_{B}f=\int_{A}\left(f\circ g\right)\left|\det Dg\right|{% endequation %}

(הנוסחה הזו משמיטה את ה-{% equation %}dx{% endequation %}-ים למיניהם שאנחנו משתמשים בהם כדי לעקוב אחרי משתני האינטגרציה). הרעיון פה הוא ש-{% equation %}f{% endequation %} היא הפונקציה שעליה מבצעים אינטגרציה, וכדי שהמשפט יעבוד היא צריכה להיות רציפה (במקרה שלנו {% equation %}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}{% endequation %} רציפה) ואילו {% equation %}g{% endequation %} היא הפונקציה שמתארת את החלפת המשתנים - במקרה שלנו זו החלפה היא <strong>מאוד סטנדרטית</strong>, אולי ההחלפה הכי בסיסית שרואים בחדו"א. היא מתבססת על פונקציה {% equation %}g:\mathbb{R}^{2}\to\mathbb{R}^{2}{% endequation %} שמוגדרת על ידי {% equation %}g\left(r,\theta\right)=\left(r\cos\theta,r\sin\theta\right){% endequation %}. את הפונקציה הזו צריך לצמצם לתת-קבוצה {% equation %}A{% endequation %}, כך שעל תת-הקבוצה הזו {% equation %}g{% endequation %} היא חח"ע ועל, והתמונה שלה היא בדיוק {% equation %}B{% endequation %}, הקבוצה שעליה אנחנו מנסים לבצע את האינטגרציה של {% equation %}f{% endequation %}. במקרה שלנו, {% equation %}A=\left(0,\infty\right)\times[0,2\pi({% endequation %} בזמן ש-{% equation %}B=\mathbb{R}^{2}\backslash\left\{ 0\right\} {% endequation %} (אני משמיט את 0 כי איתו {% equation %}g{% endequation %} כבר לא תהיה חח"ע, אבל נקודה אחת לא משפיעה על האינטגרל). על {% equation %}g{% endequation %} יש דרישה חזקה יותר של רציפות - גם היא וגם ההופכית שלה צריכות להיות גזירות ברציפות, אבל לא קשה לבדוק שזה מתקיים.

הביטוי {% equation %}f\circ g{% endequation %} פירושו "קודם להפעיל את {% equation %}g{% endequation %} ואז את {% equation %}f{% endequation %}" (כן, אני יודע שיש טקסטים שעושים בדיוק ההפך) אז במקרה שלנו אנחנו מקבלים

{% equation %}\left(f\circ g\right)\left(r,\theta\right)=e^{-\frac{\left(r\cos\theta\right)^{2}+\left(r\sin\theta\right)^{2}}{2}}=e^{-\frac{r^{2}}{2}}{% endequation %}

זו "החלפת המשתנים" בפעולה (ואני מקווה שזה מבהיר למה {% equation %}g{% endequation %} היא דווקא מהמשתנים ה"חדשים" ל"ישנים"; אותי זה תמיד מבלבל). מה שנשאר לעשות הוא לכפול בביטוי {% equation %}\left|\det Dg\right|{% endequation %} שנקרא <strong>היעקוביאן</strong> של {% equation %}g{% endequation %}, שהוא הגורם שמודד כמה {% equation %}g{% endequation %} "מעוותת את המרחב" ולכן משנה את תפיסת השטח שלנו. כאן {% equation %}Dg{% endequation %} היא מטריצה של כל הנגזרות החלקיות של {% equation %}g{% endequation %}: מכיוון ש-{% equation %}g:\mathbb{R}^{2}\to\mathbb{R}^{2}{% endequation %} היא פונקציה בשני משתנים יש ל-{% equation %}Dg{% endequation %} שתי עמודות - בעמודה הראשונה גוזרים לפי {% equation %}r{% endequation %} ובשניה לפי {% equation %}\theta{% endequation %}. בנוסף, מכיוון ש-{% equation %}g{% endequation %} היא פונקציה עם שני רכיבים, יש ל-{% equation %}Dg{% endequation %} שני שורות: בראשונה גוזרים את הרכיב {% equation %}r\cos\theta{% endequation %} ובשניה את הרכיב {% equation %}r\sin\theta{% endequation %}. מקבלים:

{% equation %}Dg=\left[\begin{array}{cc} \cos\theta & -r\sin\theta\\ \sin\theta & r\cos\theta \end{array}\right]{% endequation %}

ולכן

{% equation %}\det Dg=r\cos^{2}\theta+r\sin^{2}\theta=r\left(\cos^{2}\theta+\sin^{2}\theta\right)=r{% endequation %}

ואנחנו כופלים <strong>בערך המוחלט</strong> של הביטוי הזה, כלומר עדיין כופלים ב-{% equation %}r{% endequation %}. כל הדבר הזה מתבטא בפועל בכלל המצחיק {% equation %}dxdy=rd\theta dr{% endequation %} שהוא לא משהו פורמלי (למרות <a href="https://gadial.net/2016/08/21/stokes_theorem_overview/">שאם באמת רוצים</a> <strong>אפשר</strong> לפרמל את המשמעות של ה-{% equation %}dx{% endequation %}-ים הללו אבל בואו לא נעשה את זה הפעם) שאומר לנו "אחרי שהחלפתם את המשתנים באינטגרנד, תחליפו גם את הסימן שמתאר לכם את משתני הסכימה אבל אל תשכחו בנוסף גם לכפול ביעקוביאן {% equation %}r{% endequation %}". מכאן והלאה האינטגרל נפתר בקלות.

מה שנשאר לי להסביר הוא את המעבר

{% equation %}\left(\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx\right)\left(\int_{-\infty}^{\infty}e^{-\frac{y^{2}}{2}}dy\right)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy{% endequation %}

שבו הופכים מכפלה של שני אינטגרלים חד-ממדיים לאינטגרל דו-ממדי. הכלי הבסיסי פה הוא <strong>משפט פוביני</strong>:

{% equation %}\int\int_{X\times Y}f\left(x,y\right)dxdy=\int_{X}\left(\int_{Y}f\left(x,y\right)dy\right)dx{% endequation %}

כאן באגף שמאל יש לנו אינטגרל כפול, ובאגף ימין יש לנו שני אינטגרלים חד-ממדיים, אבל לא מוכפלים אלא מופעלים אחד על השני. כלומר, האינטגרל החיצוני {% equation %}\int_{X}\left(\ldots\right)dx{% endequation %} מופעל על פונקציה של {% equation %}x{% endequation %} שמתקבלת מכך שבוחרים ערך ל-{% equation %}x{% endequation %}, "מקפיאים" אותו ומחשבים את האינטגרל החד-ממדי {% equation %}\int_{Y}f_{x}\left(y\right)dy{% endequation %} שמופעל על הפונקציה {% equation %}f_{x}\left(y\right){% endequation %} שמוגדרת על ידי {% equation %}f_{x}\left(y\right)=f\left(x,y\right){% endequation %}. כדי שהטריק הזה יעבוד צריך שה-{% equation %}f{% endequation %} שלנו תהיה רציפה (כבר ראינו שזה קורה) או שהאינטגרל לא יהיה אינטגרל רגיל אלא הגרסה המוכללת והחזקה שלו, <strong>אינטגרל לבג</strong>, אבל על זה אני לא אדבר הפעם.

במקרה הספציפי שלנו, {% equation %}f\left(x,y\right)=e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}=e^{-\frac{x^{2}}{2}}\cdot e^{-\frac{y^{2}}{2}}{% endequation %} כלומר אם אני מסתכל על {% equation %}f_{x}\left(y\right){% endequation %} זו פונקציה מהצורה של קבוע (שתלוי ב-{% equation %}x{% endequation %}) שמוכפל ב-{% equation %}e^{-\frac{y^{2}}{2}}{% endequation %}. מכפלה בקבוע אפשר להוציא מחוץ לאינטגרל:

{% equation %}\int_{X}\left(\int_{Y}f\left(x,y\right)dy\right)dx=\int_{X}e^{-\frac{x^{2}}{2}}\left(\int_{Y}e^{-\frac{y^{2}}{2}}dy\right)dx{% endequation %}

אבל עכשיו מה שיש באינטגרל הפנימי <strong>לא תלוי</strong> ב-{% equation %}x{% endequation %} בשום צורה, כלומר הוא תמיד יוצא אותו מספר לא משנה מה הערך של {% equation %}x{% endequation %}, ולכן מנקודת המבט של האינטגרל החיצוני, {% equation %}\int_{Y}e^{-\frac{y^{2}}{2}}dy{% endequation %} הוא <strong>קבוע</strong> שאפשר להוציא החוצה, ומקבלים

{% equation %}\int_{X}\left(\int_{Y}f\left(x,y\right)dy\right)dx=\int_{X}e^{-\frac{x^{2}}{2}}dx\int_{Y}e^{-\frac{y^{2}}{2}}dy{% endequation %}

וזה מה שהשתמשתי בו בהוכחה.

יש רק בעיה קטנה אחת פה: בשביל להשתמש במשפט פוביני, אני צריך ש-{% equation %}X,Y{% endequation %} יהיו קטעים סופיים. זה גורר עוד סיבוך טכני. במקום לחשב את {% equation %}I=\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx{% endequation %} אני בוחר {% equation %}a\in[0,\infty({% endequation %} ומחשב את {% equation %}I\left(a\right)=\int_{-a}^{a}e^{-\frac{x^{2}}{2}}dx{% endequation %} ואז בודק מה יוצא {% equation %}\lim_{a\to\infty}I\left(a\right){% endequation %}. אבל אפילו כאן מתחבא <strong>עוד</strong> סיבוך טכני! כי באינטגרל מוכלל מהצורה {% equation %}\int_{-\infty}^{\infty}f\left(x\right)dx{% endequation %} זה <strong>לא תקין</strong> לבחור נקודה אחת {% equation %}a{% endequation %} ולהסתכל על הגבול {% equation %}\lim_{a\to\infty}\int_{-a}^{a}f\left(x\right)dx{% endequation %} כי הסימטריה שזה יוצר עלולה "למסך" תקלות. האופן שבו <strong>באמת</strong> מגדירים את הערך של אינטגרל אינסופי לשני הכיוונים שכזה הוא עם אחת משתי השיטות הבאות: או שבוחרים {% equation %}a,b{% endequation %} ומסתכלים על הגבול <strong>הכפול</strong> {% equation %}\lim_{a\to\infty}\lim_{b\to\infty}\int_{a}^{b}f\left(x\right)dx{% endequation %} או שמפצלים את האינטגרל לסכום של שני אינטגרלים, {% equation %}\int_{-\infty}^{\infty}f\left(x\right)dx=\int_{-\infty}^{c}f\left(x\right)dx+\int_{c}^{\infty}f\left(x\right)d\left(x\right){% endequation %}.

כדי לראות למה זה קריטי, בואו ניקח {% equation %}f\left(x\right)=x{% endequation %}. אז למשל {% equation %}\int_{0}^{\infty}xdx=\left.\frac{x^{2}}{2}\right|_{0}^{\infty}=\infty{% endequation %} ובדומה {% equation %}\int_{-\infty}^{0}xdx=-\infty{% endequation %} והביטוי {% equation %}\infty-\infty{% endequation %} בכלל לא מוגדר; ואם אני מסתכל על {% equation %}\int_{a}^{b}xdx=\frac{b^{2}-a^{2}}{2}{% endequation %} אז הגבול הכפול {% equation %}\lim_{a\to\infty}\lim_{b\to\infty}\frac{b^{2}-a^{2}}{2}{% endequation %} שוב לא יהיה מוגדר, מאותן סיבות.

באינטגרל שלנו, {% equation %}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx{% endequation %}, זו לא בעיה אמיתית כי אפשר לפרק את האינטגרל באמצע ולקבל שני חלקים שכל אחד מהם מתכנס יפה למשהו סופי (אל {% equation %}\frac{\sqrt{2\pi}}{2}{% endequation %} בגלל הסימטריה) אבל אם אני חותך את האינטגרל באמצע, כל הטריקים היפים שעשיתי קודם כבר לא עובדים! הצילו! חדו"א יכול להיות מאוד אכזרי לפעמים.

למרבה המזל, יש לנו דרך קיצור כאן. יש שיטה שנקראת "הערך העיקרי של קושי" (Principal Value) שמאפשרת לתת ערך ל-{% equation %}\lim_{a\to\infty}\int_{-a}^{a}f\left(x\right)dx{% endequation %}, והערך הזה יוצא שווה אל {% equation %}\int_{-\infty}^{\infty}f\left(x\right)dx{% endequation %} במקרים שבהם {% equation %}f\left(x\right){% endequation %} מתכנסת בערך מוחלט, כלומר אם {% equation %}\int_{-\infty}^{\infty}\left|f\left(x\right)\right|dx<\infty{% endequation %}. זה בהחלט המצב גם עבור {% equation %}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx{% endequation %}. ראשית, הערך המוחלט בכלל לא משפיע כאן כי {% equation %}e{% endequation %} בחזקת משהו ממשי הוא תמיד חיובי; ושנית, אפשר לחסום את האינטגרל הזה בצורה די נחמדה:

{% equation %}\int_{-\infty}^{\infty}e^{-\frac{x^{2}}{2}}dx<\int_{-\infty}^{-1}-xe^{-\frac{x^{2}}{2}}dx+\int_{-1}^{1}e^{-\frac{x^{2}}{2}}dx+\int_{1}^{\infty}xe^{-\frac{x^{2}}{2}}dx{% endequation %}

כי כאשר {% equation %}x{% endequation %} גדול מ-1 מכפלה בו רק מגדילה את האינטגרל, וכשהוא קטן ממינוס 1 מכפלה ב-{% equation %}-x{% endequation %} רק מגדילה את האינטגרל. עכשיו קיבלנו סכום של שלושה אינטגרלים שהאמצעי מביניהם הוא בוודאי סופי (כי הוא של פונקציה רציפה על קטע סגור) ואת האחרים אפשר לחשב במפורש כפי שכבר ראינו קודם, למשל {% equation %}\int_{1}^{\infty}xe^{-\frac{x^{2}}{2}}=\left.-e^{-\frac{x^{2}}{2}}\right|_{1}^{\infty}=e^{-\frac{1}{2}}{% endequation %}. זה מוכיח שהאינטגרל חסום ואפשר כמו שאמרתי קודם לכתוב {% equation %}I\left(a\right)=\int_{-a}^{a}e^{-\frac{x^{2}}{2}}dx{% endequation %} ולבדוק מה יוצא {% equation %}\lim_{a\to\infty}I\left(a\right){% endequation %}.

את {% equation %}I\left(a\right)=\int_{-a}^{a}e^{-\frac{x^{2}}{2}}dx{% endequation %} אפשר לחשב כמו שראינו עם משפט פוביני, ומקבלים 

{% equation %}\int_{-a}^{a}e^{-\frac{x^{2}}{2}}dx=\int_{-a}^{a}\int_{-a}^{a}e^{-\frac{\left(x^{2}+y^{2}\right)}{2}}dxdy{% endequation %}

אבל עכשיו נוצר לנו סיבוך בשלב החלפת המשתנים. אנחנו עדיין משתמשים באותה החלפה בדיוק:

{% equation %}x=r\cos\theta{% endequation %}

{% equation %}y=r\sin\theta{% endequation %}

אבל הרעיון בהחלפת משתנים הוא כזכור לקחת אינטגרל שמוגדר על קבוצה אחת {% equation %}A{% endequation %} ולהגדיר אותו על קבוצה אחרת {% equation %}B{% endequation %} כך שהחלפת המשתנים מעבירה את {% equation %}B{% endequation %} <strong>בדיוק</strong> אל {% equation %}A{% endequation %}. ואצלנו עכשיו {% equation %}A{% endequation %} הוא <strong>ריבוע</strong>, {% equation %}A=\left[-a,a\right]\times\left[-a,a\right]{% endequation %} בזמן שהחלפת המשתנים מוגדרת על קבוצה {% equation %}B=\left[0,t\right]\times\left[0,2\pi\right]{% endequation %} (שוב, עד כדי התעלמות מהבעייתיות בנקודה 0) ומעבירה את הקבוצה הזו אל <strong>העיגול </strong>{% equation %}\left\{ \left(r\cos\theta,r\sin\theta\right)\ |\ 0\le\theta\le2\pi,0\le r\le t\right\} {% endequation %} שהרדיוס שלו הוא {% equation %}t{% endequation %}.

אז מה עושים? שוב חוסמים! העיגול ש<strong>חסום</strong> בתוך {% equation %}A{% endequation %} הוא בעל רדיוס {% equation %}a{% endequation %}, והמעגל <strong>שחוסם</strong> את {% equation %}A{% endequation %} הוא בעל רדיוס {% equation %}\sqrt{2}a{% endequation %} (זה תרגיל נחמד לצייר את הריבע ולהבין למה אלו רדיוסי המעגלים), ומכיוון שהפונקציה חיובית, האינטגרל שלה על {% equation %}A{% endequation %} יהיה בין האינטגרלים שלה על שני המעגלים הללו:

{% equation %}\int_{0}^{a}\left(\int_{0}^{2\pi}re^{-\frac{r^{2}}{2}}d\theta\right)dr\le I\left(a\right)\le\int_{0}^{\sqrt{2}a}\left(\int_{0}^{2\pi}re^{-\frac{r^{2}}{2}}d\theta\right)dr{% endequation %}

ואת האינטגרלים הללו כבר ראינו איך לחשב. מכיוון שאין {% equation %}\infty{% endequation %} מעורב שמאפס את האקספוננט, הם יוצאים פחות "נקיים", אבל אנחנו כבר שקועים בלכלוך מכאן ועד להודעה חדשה אז למי אכפת? בסופו של חישוב האינטגרל מקבלים {% equation %}-2\pi\left.e^{\frac{-r^{2}}{2}}\right|_{0}^{t}=-2\pi\left(e^{-\frac{t^{2}}{2}}-1\right)=2\pi\left(1-e^{-\frac{t^{2}}{2}}\right){% endequation %} ורק נשאר להציב {% equation %}t=a,\sqrt{2}a{% endequation %} ולקבל:

{% equation %}2\pi\left(1-e^{-\frac{a^{2}}{2}}\right)\le I\left(a\right)\le2\pi\left(1-e^{-a^{2}}\right){% endequation %}

עכשיו אפשר להשתמש בכלל הסנדוויץ': {% equation %}\lim_{a\to\infty}2\pi\left(1-e^{-\frac{a^{2}}{2}}\right)=2\pi\left(1-e^{-a^{2}}\right)=2\pi{% endequation %} ולכן מקבלים {% equation %}\lim_{a\to\infty}I\left(a\right)=2\pi{% endequation %} בצורה הכי פורמלית בעולם.

בספרי לימוד של תורת ההסתברות בדרך כלל לא יראו לכם את כל המהומה הזו; יסתפקו בהוכחה שהראיתי בהתחלה, שמדלגת מעל שלבים בצורה קלילה. עכשיו אנחנו כנראה גם מבינים למה - כי אחרי שרואים את זה צריך לנוח, ולכן אני מסיים את הפוסט כאן ולא מדלג בקלילות אל הנושא הבא - כלומר, אל השאלה מה בנוסחה הכללית {% equation %}f\left(x\right)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\left(x-\mu\right)^{2}/2\sigma^{2}}{% endequation %} התפקיד של אותם {% equation %}\sigma{% endequation %} ו-{% equation %}\mu{% endequation %} מזעזעים שמתחבאים בה ואיך אנחנו מקשרים את המקרה הכללי איתם אל מה שראינו כרגע. 