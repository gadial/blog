---
id: 3374
title: "צורת ז'ורדן, התכל'ס"
date: 2016-08-30 22:57:48
layout: post
categories: 
  - אלגברה לינארית
tags: 
  - אלגברה לינארית
  - צורת ז'ורדן
---
<strong>מבוא ובו סיפור חיים מרגש ומטריצות, הרבה מטריצות</strong>

בזמנו כתבתי סדרת פוסטים על אלגברה לינארית, ששיאה היה אמור להיות פוסט על צורת ז'ורדן. בפועל הגעתי עד ל<a href="http://www.gadial.net/2012/01/09/primary_decomposition_theorem/">משפט הפירוק הפרימרי</a> (גם זה סוג של שיא) ושם נתקעתי, כי את צורת ז'ורדן לא הצלחתי להציג בצורה משביעת רצון, אפילו לא לעצמי, ולמרות שזה נושא שכבר הכרתי מכמה נקודות התבוננות שונות. כיום אני חושב שאני יודע להצביע על הבעיה המרכזית שלי; הדרך ה"נכונה" להציג את צורת ז'ורדן, זו שכוללת את כל התיאוריה שמובילה אליה, היא מאוד עמוסה ברעיונות שנראים קצת לא קשורים בהתחלה ופתאום הכל מסתדר. זה יפה בצורה בלתי רגילה. זה גם לא בדיוק פרקטי לקרוא את זה כשכל מה שרוצים באותו הרגע הוא להבין איך מוצאים את צורת ז'ורדן הארורה הזו ו"מה האלגוריתם". אז בואו נעשה את הדבר הבא: אתחיל מהצגה של התכל'ס - מה זה, מה התכונות הבסיסיות של זה, איך מוצאים את זה, וזהו. ארמוז קצת לגבי <strong>למה</strong> זה עובד ומאיפה דברים מגיעים, אבל לא אכנס לפרטים. אחר כך, כשהרעיון הכללי כבר יושב לנו טוב, נוכל ללכת ולהסתכל על התיאוריה הכללית שמסביב, ולהתלהב מכמה שזה יפה.

נתחיל עם תיאור של מה זה בכלל. ההקשר הכללי שלנו הוא אלגברה לינארית, שאני מניח שכולכם מכירים; ההקשר הפרטני יותר הוא זה של צורות קנוניות של מטריצות/טרנספורמציות לינאריות, שגם אותו אני מניח שאתם מכירים. לכל הפחות, צריך להכיר את הנושא של <a href="http://www.gadial.net/2011/12/03/eigenvalues_main/">לכסון מטריצות</a>, כי זה בדיוק מה שצורת ז'ורדן באה להכליל. השורה התחתונה של מהי צורת ז'ורדן היא פשוטה להדהים. בלכסון מטריצות, הרעיון היה שאפשר למצוא עבור מטריצות {% equation %}A{% endequation %} מסויימות מטריצה {% equation %}D{% endequation %} אלכסונית ומטריצה {% equation %}P{% endequation %} הפיכה, כך ש-{% equation %}D=P^{-1}AP{% endequation %}. בניסוח אחר: לטרנספורמציות לינאריות מסויימות היה אפשר למצוא בסיס שבו הן מיוצגות על ידי מטריצה {% equation %}D{% endequation %} אלכסונית. הדגש היה על <strong>מסויימות</strong>; לא כל מטריצה/טרנספורמציה הייתה "לכסינה" בצורה הזו. צורת ז'ורדן באה לתת משהו שמתקיים לכל מטריצה או טרנספורמציה, בתנאי אחד: שהשדה שמעליו אנחנו עובדים הוא סגור אלגברית (אסביר את זה בהמשך). התוצאה היא כמעט אותה תוצאה, רק שבמקום {% equation %}D{% endequation %} <strong>אלכסונית</strong> יש לנו {% equation %}J{% endequation %} שהיא "כמעט אלכסונית" - פרט לאיברים על האלכסון, עשויים להופיע 1-ים במקומות שונים ומשונים על גבי האלכסון המשני שמעל האלכסון הראשי. זה הכל.

בשביל שתהיה לנו כל הזמן דוגמה כלשהי מול העיניים, הנה משהו קונקרטי:

{% equation %}A=\left(\begin{array}{rrrrrr}3 & 0 & 0 & 0 & 0 & 0\\0 & 2 & 0 & 0 & -1 & 0\\0 & 0 & 2 & 0 & 1 & 0\\0 & 0 & 0 & 2 & 0 & 1\\0 & 1 & 1 & 0 & 2 & 0\\0 & 0 & 0 & 0 & 0 & 2\end{array}\right){% endequation %}

{% equation %}J=\left(\begin{array}{rrrrrr}3 & 0 & 0 & 0 & 0 & 0\\0 & 2 & 1 & 0 & 0 & 0\\0 & 0 & 2 & 1 & 0 & 0\\0 & 0 & 0 & 2 & 0 & 0\\0 & 0 & 0 & 0 & 2 & 1\\0 & 0 & 0 & 0 & 0 & 2\end{array}\right){% endequation %}

{% equation %}P=\left(\begin{array}{rrrrrr}1 & 0 & 0 & 0 & 0 & 0\\0 & -1 & 0 & 1 & 0 & 0\\0 & 1 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 1 & 0\\0 & 0 & 1 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 1\end{array}\right){% endequation %}

שימו לב לצורה של {% equation %}J{% endequation %}. זה מה שנקרא <strong>מטריצת בלוקים</strong>. רובה אפסים, פרט לשלוש תת-מטריצות שהאלכסון הראשי שלהן נח על האלכסון הראשי של המטריצה: המטריצה {% equation %}\left(\begin{array}{c}3\end{array}\right){% endequation %} (מטריצה מסדר {% equation %}1\times1{% endequation %}), המטריצה {% equation %}\left(\begin{array}{ccc}2 & 1 & 0\\0 & 2 & 1\\0 & 0 & 2\end{array}\right){% endequation %} והמטריצה {% equation %}\left(\begin{array}{cc}2 & 1\\0 & 2\end{array}\right){% endequation %}. על מטריצה כזו אומרים שהיא מורכבת משלושה <strong>בלוקי ז'ורדן</strong>, שאחד מהם הוא מגודל 1 ומתאים לערך העצמי 3, השני הוא מגודל 3 ומתאים לערך העצמי 2, והשלישי הוא מגודל 2 ומתאים לערך העצמי 2. כלומר, בלוק ז'ורדן הוא בסך הכל מטריצה סקלרית (כלומר, כזו שבה על האלכסון הראשי יש ערך סקלרי קבוע כלשהו) ועוד מטריצה שבה על האלכסון המשני העליון יש 1-ים. כל צורת ז'ורדן היא משהו כזה: מטריצת בלוקים שבה הבלוקים הם בלוקי ז'ורדן. לב הרעיון הוא שכל מטריצה דומה למטריצת ז'ורדן <strong>יחידה</strong>, עד כדי זה שאפשר לשחק עם הסדר של העמודות. כלומר, אם נמיין את הבלוקים (למשל) על פי גודל הערך העצמי ואז על פי גדלי הבלוקים, נקבל ייצוג יחיד.

השאלה שלנו, אם כן, היא זו: בהינתן {% equation %}A{% endequation %} כמו זו, איך מוצאים את {% equation %}J{% endequation %}? ואיך מוצאים את {% equation %}P{% endequation %}? זה מה שנטפל בו בפוסט הזה. לא ניכנס להוכחות של קיום ויחידות צורת ז'ורדן או כל דבר דומה.

<strong>פרק ראשון, ובו נוסטלגיה מהימים הטובים שבהם פולינומים היו פולינומים, ריבוי אלגברי היה ריבוי גאומטרי, ומטריצות היו לכסינות</strong>

נתחיל מלהזכיר את המושגים שרלוונטיים לנו. צורת ז'ורדן היא סוג של הכללה של לכסון מטריצות, ולכן לא פלא שהמושגים שצצו בלכסון מטריצות הם בעלי תפקיד מרכזי גם כאן, אז נזכיר אותם. המושג הבסיסי הוא <strong>ערך עצמי</strong> של {% equation %}A{% endequation %}: {% equation %}\lambda{% endequation %} הוא ערך עצמי אם קיים וקטור {% equation %}v\ne0{% endequation %} כך ש-{% equation %}Av=\lambda v{% endequation %}. על {% equation %}v{% endequation %} אומרים שהוא <strong>וקטור עצמי</strong> של {% equation %}A{% endequation %}.

מציאת ערכים עצמיים זה עניין פשוט יחסית. נניח ש-{% equation %}A{% endequation %} היא מטריצה מסדר {% equation %}n\times n{% endequation %} מעל שדה {% equation %}\mathbb{F}{% endequation %}. אם {% equation %}Av=\lambda v{% endequation %} אז על ידי העברת אגפים מקבלים ש-{% equation %}\left(A-\lambda I\right)v=0{% endequation %}, כלומר {% equation %}v\in\ker\left(A-\lambda I\right){% endequation %}. בפרט, זה אומר שהגרעין של המטריצה {% equation %}A-\lambda I{% endequation %} אינו טריוויאלי, ולכן המטריצה הזו אינה הפיכה, ולכן הדטרמיננטה שלה היא אפס: {% equation %}\det\left(A-\lambda I\right)=0{% endequation %}. זה מוביל להגדרה הבאה של <strong>הפולינום האופייני</strong> של מטריצה {% equation %}A{% endequation %}: {% equation %}p_{A}\left(x\right)=\det\left(xI-A\right){% endequation %}. כאן {% equation %}xI-A{% endequation %} היא מטריצה שהכניסות שלה לא שייכות סתם לאיזה שדה {% equation %}\mathbb{F}{% endequation %} אלא ל-{% equation %}\mathbb{F}\left[x\right]{% endequation %} - חוג הפולינומים מעל {% equation %}\mathbb{F}{% endequation %}. חישוב הדטרמיננטה עדיין מתבצע באותו האופן. מקבלים תמיד פולינום מתוקן (כלומר, כזה שבו המקדם המוביל הוא 1; זו הסיבה שלוקחים דטרמיננטה של {% equation %}xI-A{% endequation %} ולא של {% equation %}A-xI{% endequation %}) ממעלה {% equation %}n{% endequation %}. למשל, עבור המטריצה {% equation %}A{% endequation %} בדוגמה שלנו, חישוב ישיר נותן {% equation %}p_{A}\left(x\right)=\left(x-3\right)\left(x-2\right)^{5}{% endequation %}. הפואנטה בפולינום האופייני הוא שהערכים העצמיים של {% equation %}A{% endequation %} הם בדיוק השורשים של הפולינום הזה.

בדוגמה שלנו, הפולינום התפרק למכפלה של גורמים לינאריים, כלומר גורמים מהצורה {% equation %}\left(x-\lambda\right){% endequation %}. חלק מהגורמים חזרו על עצמם - {% equation %}\left(x-2\right){% endequation %} הופיע 5 פעמים - אבל זו לא בעיה. מתי יש בעיה? אם יש לנו גורם שאנחנו לא יכולים לפרק יותר מעל השדה הנוכחי שלנו. נראה את הדוגמה הקלאסית לכך. נניח שאנחנו מעל השדה {% equation %}\mathbb{R}{% endequation %} ונתבונן על המטריצה {% equation %}\left(\begin{array}{cc}0 & 1\\-1 & 0\end{array}\right){% endequation %}. הפולינום האופייני שלה הוא {% equation %}\det\left(\begin{array}{cc}x & -1\\1 & x\end{array}\right)=x^{2}+1{% endequation %}. מעל {% equation %}\mathbb{R}{% endequation %} אי אפשר לפרק את הפולינום הזה לגורמים לינאריים. אם נעבור אל {% equation %}\mathbb{C}{% endequation %} הפולינום יתפרק ל-{% equation %}\left(x-i\right)\left(x+i\right){% endequation %}, ואלו אכן הערכים העצמיים של המטריצה הזו; אבל מעל {% equation %}\mathbb{R}{% endequation %} אנחנו "תקועים". כאן זה החיסרון היחיד של צורת ז'ורדן: אם הפולינום האופייני לא מתפרק לגורמים לינאריים, צורת ז'ורדן לא עובדת. אם <strong>נרחיב את השדה</strong> שמעליו אנחנו עובדים לשדה שבו הפולינום הזה מתפרק לגורמים לינאריים, אז מעל השדה המורחב הזה נוכל למצוא צורת ז'ורדן והכל יהיה טוב ויפה, אבל בלי זה אין על מה לדבר. לכן בכל הדיון על צורות ז'ורדן מניחים שהפולינום האופייני של המטריצה שלנו כן מתפרק לגורמים לינאריים (לפעמים פשוט מניחים שעובדים מעל השדה {% equation %}\mathbb{C}{% endequation %} שכל פולינום מעליו מתפרק לגורמים לינאריים וחסל; זהו <strong>המשפט היסודי של האלגברה</strong>).

לכל שורש {% equation %}\lambda{% endequation %} של הפולינום האופייני מגדירים את <strong>הריבוי האלגברי</strong> שלו להיות מספר הפעמים שבהן הגורם {% equation %}x-\lambda{% endequation %} מופיע בפולינום האופייני. בדוגמה שלנו הריבוי האלגברי של 3 הוא 1 והריבוי האלגברי של 2 הוא 5. כמו כן, מגדירים את <strong>הריבוי הגאומטרי</strong> של {% equation %}\lambda{% endequation %} בתור {% equation %}\dim\ker\left(A-\lambda I\right){% endequation %}, שזו דרך אחרת לומר "המימד של תת-המרחב של הוקטורים העצמיים שמתאימים לערך {% equation %}\lambda{% endequation %}".

לבסוף, המשפט הבסיסי על לכסון מטריצות אומר שמטריצה היא לכסינה אם ורק אם הריבוי האלגברי של כל ערך עצמי שווה לריבוי הגיאומטרי שלו (אפשר לראות שתמיד הריבוי האלגברי <strong>גדול או שווה</strong>). במקרה הזה, אפשר למצוא למרחב כולו בסיס שכולו בנוי מוקטורים עצמיים של {% equation %}A{% endequation %}. כעת הטרנספורמציה הלינארית ש-{% equation %}A{% endequation %} מייצג תהיה מיוצגת על ידי מטריצה אלכסונית בבסיס הזה; ואם נגדיר את {% equation %}P{% endequation %} להיות המטריצה שעמודותיה הם הוקטורים העצמיים הללו, אז נקבל ש-{% equation %}P^{-1}AP=D{% endequation %} כאשר {% equation %}D{% endequation %} אלכסונית ועל האלכסון שלה מופיעים הערכים העצמיים של {% equation %}A{% endequation %}.

צורת ז'ורדן באה לטפל בסיטואציה שבה הריבוי הגיאומטרי <strong>קטן</strong> מהריבוי האלגברי. במצב הזה, אין לנו "מספיק" וקטורים עצמיים כדי לקבל בסיס, אז אנחנו מתחילים לחפש וקטורים במקומות נוספים. הנה הרעיון: אם עבור וקטורים עצמיים עבור {% equation %}\lambda{% endequation %} חיפשנו איברים של {% equation %}\ker\left(A-\lambda I\right){% endequation %}, הרי שעכשיו אנחנו נחפש איברים של {% equation %}\ker\left(A-\lambda I\right)^{k}{% endequation %} עבור {% equation %}k\ge1{% endequation %}. אבל לא מספיק לבחור "סתם" איברים של המרחבים הללו; צריך לבצע את הבחירה הזו בצורה זהירה למדי כדי לוודא שאנחנו אכן תופסים את כל מה שצריך לתפוס. אני אתן כבר עכשיו את הרעיון על קצה המזלג:
<ol>
	<li>בכל שלב, אנחנו מחפשים וקטורים ב-{% equation %}\ker\left(A-\lambda I\right)^{k}{% endequation %} <strong>שאינם</strong> שייכים ל-{% equation %}\ker\left(A-\lambda I\right)^{k-1}{% endequation %} (ועוד תכונה יותר מסובכת שאסביר בהמשך, <strong>אל תחשבו</strong> שהתיאור הזה שלם).</li>
	<li>בכל שלב, אם בחרנו וקטור {% equation %}v{% endequation %} כלשהו, אנחנו צריכים לקחת את כל ה<strong>שרשרת</strong> שהוא יוצר על ידי הפעלות חוזרות ונשנות של {% equation %}\left(A-\lambda I\right){% endequation %} עליו. דהיינו, אם לקחנו את {% equation %}v{% endequation %} לקבוצת הוקטורים שאנחנו בונים, ניקח גם את {% equation %}\left(A-\lambda I\right)v{% endequation %}, גם את {% equation %}\left(A-\lambda I\right)^{2}v{% endequation %} וכן הלאה עד אשר מגיעים אל 0.</li>
</ol>
זה, על רגל אחת, האלגוריתם שלנו. הוא לא שונה כל כך ממה שקרה בסיטואציה של לכסון מטריצות: שם התחלנו מ-{% equation %}k=1{% endequation %}, ולכן בסך הכל חיפשנו כמה שיותר וקטורים ב-{% equation %}\ker\left(A-\lambda I\right){% endequation %} כאשר תנאי ה"אינם שייכים" היה בדיוק התנאי שהוקטורים העצמיים שונים מ-0.

<b>פרק שני, שבו הפולינום המינימלי מראה שאת מה שהוא הספיק לשכוח על בלוקי ז'ורדן אנחנו עוד לא למדנו</b>

דבר אחד עדיין בבירור חסר ב"אלגוריתם" שאני מציע כאן - איך יודעים מאיזה {% equation %}k{% endequation %} להתחיל את החיפוש? בשביל זה נכניס לתמונה עוד מושג מוכר מהעבר: <strong>פולינום מינימלי</strong>.

בהינתן מטריצה {% equation %}A{% endequation %}, <strong>הפולינום המינימלי</strong> {% equation %}m_{A}\left(x\right){% endequation %} שלה הוא פולינום מתוקן שמקיים {% equation %}m_{A}\left(A\right)=0{% endequation %} והוא מחלק כל פולינום אחד שמאפס את {% equation %}A{% endequation %} - במילים יותר פורמליות, {% equation %}m_{A}\left(x\right){% endequation %} הוא <strong>היוצר</strong> של אידאל הפולינומים שמאפסים את {% equation %}A{% endequation %} בחוג {% equation %}\mathbb{F}\left[x\right]{% endequation %}. העובדה שקיים כזה פולינום מובטחת מכך ש-{% equation %}\mathbb{F}\left[x\right]{% endequation %} הוא תחום ראשי; לא אכנס כאן לפרטים. כלי מועיל מאוד בדרך למציאת הפולינום המינימלי הוא <strong>משפט קיילי המילטון</strong> שאומר ש-{% equation %}p_{A}\left(A\right)=0{% endequation %}, כלומר הפולינום האופייני של מטריצה מאפס אותה, ולכן הפולינום המינימלי מחלק אותו; אפשר להראות שהפולינום המינימלי הוא בעל אותם גורמים לינאריים בדיוק כמו הפולינום האופייני, רק שהריבוי שלהם עשוי להיות קטן יותר (כלומר, מקטינים חלק מהחזקות, אבל לא מורידים חזקה כלשהי ל-0). לכן אפשר פשוט להציב את {% equation %}A{% endequation %} בכל מני מועמדים אפשריים ולראות מה קורה (בהמשך נראה שיש דרך חכמה יותר למצוא את הפולינום המינימלי). בדוגמה שלנו, {% equation %}m_{A}\left(x\right)=\left(x-3\right)\left(x-2\right)^{3}{% endequation %}, כלומר הגורם {% equation %}\left(x-3\right){% endequation %} לא נעלם (אסור לו להיעלם) והגורם {% equation %}\left(x-2\right)^{5}{% endequation %} איבד 2 ממעריך החזקה שלו והפך להיות {% equation %}\left(x-2\right)^{3}{% endequation %}.

מה שיפה הוא שהפולינומים האופייני והמינימלי של {% equation %}A{% endequation %} מספקים לנו המון מידע על צורת ז'ורדן של המטריצה. לפעמים מספיק מידע כדי לקבוע מהי בצורה יחידה (אבל לא תמיד). הנה סיכום זריז:
<ul>
	<li>לכל ערך עצמי {% equation %}\lambda{% endequation %}, הריבוי האלגברי של {% equation %}\lambda{% endequation %} (הדרגה של {% equation %}\left(x-\lambda\right){% endequation %} בפולינום האופייני) שווה ל<strong>סכום גדלי</strong> בלוקי ז'ורדן המתאימים ל-{% equation %}\lambda{% endequation %}.</li>
	<li>לכל ערך עצמי {% equation %}\lambda{% endequation %}, הריבוי הגאומטרי של {% equation %}\lambda{% endequation %} שווה ל<strong>מספר</strong> בלוקי ז'ורדן המתאימים ל-{% equation %}\lambda{% endequation %}.</li>
	<li>לכל ערך עצמי {% equation %}\lambda{% endequation %}, הריבוי של {% equation %}\lambda{% endequation %} <strong>בפולינום המינימלי</strong> שווה לגודל בלוק הז'ורדן הגדול ביותר המתאים ל-{% equation %}\lambda{% endequation %}.</li>
</ul>
בואו נראה מה שלושת אלו אומרים בדוגמה שלנו. עבור {% equation %}\lambda=3{% endequation %} קיים בפולינום האופייני הגורם {% equation %}\left(x-3\right){% endequation %} שהוא ממעלה 1, כלומר הריבוי האלגברי הוא 1 ולכן גם הריבוי הגאומטרי הוא 1. המסקנה היא שב-{% equation %}J{% endequation %} יהיה בלוק ז'ורדן יחיד שמתאים ל-{% equation %}\lambda=3{% endequation %} ושהגודל שלו יהיה 1. זה אכן מה שקורה.

לגבי הערך העצמי {% equation %}\lambda=2{% endequation %}, הריבוי האלגברי שלו הוא 5, ולכן סכום גדלי כל הבלוקים שלו יהיה 5. כמה בלוקים כאלו יהיו? בשביל זה צריך להפשיל שרוולים ולמצוא את הריבוי הגיאומטרי, כלומר לחשב את {% equation %}\dim\ker\left(A-2I\right){% endequation %}, מה שאפשר לעשות על ידי דירוג מטריצות סטנדרטי. מקבלים ריבוי גיאומטרי 2, ולכן יהיו שני בלוקי ז'ורדן. זה זמן לא רע לעצור ולחשוב מה הם יכולים להיות. סכום הגדלים שלהם יהיה 5; בכמה דרכים אפשר לכתוב את 5 בתור סכום של שני מספרים טבעיים חיוביים? או {% equation %}5=1+4{% endequation %} או {% equation %}5=2+3{% endequation %}. אלא שהמקרה הראשון נפסל בשל הפולינום המינימלי; הריבוי של {% equation %}\lambda=2{% endequation %} בפולינום המינימלי הוא 3 ולכן לא ייתכן שיש בלוק מגודל 4. לכן בהכרח האפשרות הנוספת היא הנכונה - יהיה לנו בלוק אחד מגודל 3 ובלוק אחר מגודל 2, וזה בדיוק מה שיש לנו. הנה כי כן, רק מהיכרות עם הפולינום האופייני והמינימלי של {% equation %}A{% endequation %} כבר הבנו בדיוק איך צורת ז'ורדן שלה תיראה. אם אנחנו רוצים למצוא את {% equation %}P{% endequation %} המז'רדנת, נצטרך לעבוד עוד קצת.

האם המידע שכתבתי למעלה זה כל המידע שאפשר לחלץ על צורת ז'ורדן מבלי לחשב את {% equation %}P{% endequation %} במפורש? ובכן, לא. שמרתי את הדבר המסובך ביותר לסוף:
<ul>
	<li>לכל ערך עצמי {% equation %}\lambda{% endequation %}, מספר בלוקי ז'ורדן המתאימים ל-{% equation %}\lambda{% endequation %} מגודל {% equation %}k{% endequation %} <strong>לפחות</strong> הוא ההפרש {% equation %}\dim\ker\left(A-\lambda I\right)^{k}-\dim\ker\left(A-\lambda I\right)^{k-1}{% endequation %}.</li>
</ul>
עוד רגע אסביר את ההגיון מאחורי התכונה הזו, ויש בהחלט הגיון, אבל לפני כן בואו נעזור קצת למי שה"לפחות" הזה מציק לו ורוצה לדעת מה המספר <strong>בדיוק</strong>. הטיעון הוא קצת חמקמק, אז הנה דוגמה: נניח שאני יודע שיש בדיוק 5 בלוקים מגודל שהוא <strong>לפחות</strong> 3, ואני יודע שיש 2 בלוקים מגודל שהוא <strong>לפחות</strong> 4, כמה בלוקים מגודל <strong>בדיוק</strong> 3 יש? אני מקווה שאתם צועקים עלי "שלושה!". איך ידעתם? כי אפשר לראות שבמעבר בין בלוקים מגודל <strong>לפחות</strong> 3 אל גודל <strong>לפחות</strong> 4 "איבדנו" 3 בלוקים; אלו חייבים להיות הבלוקים שגודלם הוא <strong>בדיוק</strong> 3.

מכאן שכדי לקבל את מספר הבלוקים מגודל {% equation %}k{% endequation %} <strong>בדיוק</strong> אנחנו צריכים לחשב את מספר הבלוקים מגודל {% equation %}k{% endequation %} <strong>לפחות</strong>, פחות מספר הבלוקים מגודל {% equation %}k+1{% endequation %} <strong>לפחות</strong>. אפשר לעשות את זה על ידי שתי הפעלות של הנוסחה לעיל. נקבל:
<ul>
	<li>לכל ערך עצמי {% equation %}\lambda{% endequation %}, מספר בלוקי ז'ורדן המתאימים ל-{% equation %}\lambda{% endequation %} מגודל {% equation %}k{% endequation %} <strong>בדיוק</strong> הוא ההפרש {% equation %}2\dim\ker\left(A-\lambda I\right)^{k}-\dim\ker\left(A-\lambda I\right)^{k+1}-\dim\ker\left(A-\lambda I\right)^{k-1}{% endequation %}.</li>
</ul>
תעשו לעצמכם את החשבון ותראו שאכן זה מה שיוצא.

<strong>פרק שלישי, שבו אנחנו מז'רדנים סוף סוף בעזרת וקטורים ציקליים שזה סוג מיוחד של וקטור עצמי מוכלל וזה לא נשמע גס בכלל</strong>

עכשיו אני רוצה לעבור לדבר על האופן שבו מוצאים את {% equation %}P{% endequation %}, מה שישתלב יפה עם הסבר לגבי המקום שממנו כל התכונות הללו מגיעות מלכתחילה. כשמדברים על {% equation %}P{% endequation %} קצת יותר קל לדעתי לחשוב על {% equation %}A{% endequation %} לא בתור מטריצה שרוצים למצוא אחת שדומה לה, אלא בתור טרנספורמציה לינארית שאנחנו מחפשים בסיס {% equation %}P{% endequation %} למרחב שבו היא מיוצגת על ידי מטריצה נחמדה - מטריצת בלוקים. מה הרעיון של מטריצת בלוקים שמייצגת טרנספורמציה לינארית? שכל בלוק מייצג <strong>תת-מרחב אינוריאנטי</strong> של הטרנספורמציה. אם {% equation %}T:V\to V{% endequation %} היא טרנספורמציה ו-{% equation %}W{% endequation %} הוא תת-מרחב של {% equation %}V{% endequation %}, אז {% equation %}W{% endequation %} הוא {% equation %}T{% endequation %}-אינוריאנטי אם {% equation %}T\left(W\right)\subseteq W{% endequation %}. זה אומר שאם כחלק מהבסיס {% equation %}P{% endequation %} שלנו יש בסיס ל-{% equation %}W{% endequation %}, ושאר אברי {% equation %}P{% endequation %} לא שייכים ל-{% equation %}W{% endequation %}, אז כשמייצגים את {% equation %}T{% endequation %} באמצעות {% equation %}P{% endequation %} נקבל בלוק שמתאים בדיוק ל-{% equation %}W{% endequation %}. בואו נראה את זה עם דוגמה פשוטה. נניח ש-{% equation %}V=W\oplus U{% endequation %} כך ש-{% equation %}W,U{% endequation %} הם {% equation %}T{% endequation %}-אינוריאנטים, וניקח בסיס {% equation %}P=\left\{ w_{1},w_{2},u_{1},u_{2}\right\} {% endequation %} שמורכב מאיחוד בסיסים של {% equation %}W,U{% endequation %}. לצורך הקונקרטיות נניח ש-{% equation %}T\left(w_{1}\right)=w_{1}+w_{2}{% endequation %} ו-{% equation %}T\left(w_{2}\right)=2w_{1}-w_{2}{% endequation %}, וש-{% equation %}T\left(u_{1}\right)=3u_{2}{% endequation %}, {% equation %}T\left(u_{2}\right)=u_{1}-u_{2}{% endequation %}. אם נשב ונחשב את המטריצה המייצגת של {% equation %}T{% endequation %} על פי {% equation %}P{% endequation %} נקבל את המטריצה הבאה:

{% equation %}\left(\begin{array}{cccc}1 & 2 & 0 & 0\\1 & -1 & 0 & 0\\0 & 0 & 0 & 1\\0 & 0 & 3 & -1\end{array}\right){% endequation %}

האינטואיציה: כל וקטור עמודה במטריצה המייצגת שווה לתוצאת ההפעלה של {% equation %}T{% endequation %} על אחד מאברי הבסיס, כשמה שנכתב בעמודה הוא <strong>וקטור הקואורדינטות</strong> שלו על פי הבסיס. העמודה הראשונה היא וקטור ששייך ל-{% equation %}W{% endequation %} ולכן גם הפלט שלו יהיה ב-{% equation %}W{% endequation %} ולכן וקטור הקואורדינטות שלו יתאפס על השורות שמתאימות לאברי בסיס שאינם ב-{% equation %}W{% endequation %}, וכדומה.

אם כן, זה מה שקורה גם בצורת ז'ורדן. איכשהו מצליחים לפרק את {% equation %}V{% endequation %} לתת-מרחבים אינוריאנטים, שכל אחד מהם מתאים לבלוק ז'ורדן מסויים. לב-לבו של הרעיון בצורת ז'ורדן הוא שכל תת-מרחב כזה הוא <strong>ציקלי</strong>: הוא מתקבל מכך שלוקחים וקטור בודד ב-{% equation %}V{% endequation %}, שנקרא לו <strong>וקטור ציקלי</strong>, ואז מפעילים עליו את כל החזקות האפשריות של {% equation %}T{% endequation %} (כולל 0) ולוקחים את כל הצירופים הלינאריים האפשריים. אבל הרעיון הזה לבדו לא מספיק - כדי שנקבל בלוק ז'ורדן צריך לבחור בצורה זהירה את הוקטורים שיהיו בבסיס. בואו ננסה לעשות הינדוס לאחור כדי להבין מה צריך. ניקח בלוק ז'ורדן תמים, נאמר מסדר {% equation %}3\times3{% endequation %}:

{% equation %}\left(\begin{array}{ccc}\lambda & 1 & 0\\0 & \lambda & 1\\0 & 0 & \lambda\end{array}\right){% endequation %}

בואו נאמר שהבסיס שיצר אותו הוא {% equation %}\left\{ w_{1},w_{2},w_{3}\right\} {% endequation %}. עכשיו אנחנו מבינים את המשמעות של בלוק כזה - הוא אומר שהטרנספורמציה פועלת באופן הבא:

{% equation %}T\left(w_{1}\right)=\lambda w_{1}{% endequation %}

{% equation %}T\left(w_{2}\right)=w_{1}+\lambda w_{2}{% endequation %}

{% equation %}T\left(w_{3}\right)=w_{2}+\lambda w_{3}{% endequation %}

נסתכל למשל על המשוואה האחרונה. אפשר לכתוב אותה גם בתור {% equation %}T\left(w_{3}\right)=w_{2}+\lambda I\left(w_{3}\right){% endequation %} כאשר {% equation %}I{% endequation %} היא פונקצית הזהות. העברת אגפים תיתן {% equation %}w_{2}=\left(T-\lambda I\right)w_{3}{% endequation %} (כן, אני קצת משנה את תפקידי הסוגריים, אתם חזקים, תתמודדו). באופן דומה, {% equation %}w_{1}=\left(T-\lambda I\right)w_{2}{% endequation %} ואילו {% equation %}\left(T-\lambda I\right)w_{1}=0{% endequation %}. מה שזה אומר בפועל הוא שתת-המרחב האינוריאנטי שנותן לו את בלוק הז'ורדן הזה נבנה מתוך וקטור {% equation %}w_{3}{% endequation %} שאנחנו מוצאים בדרך קסם כלשהי (שעוד מעט תוסבר), ועליו אנחנו מפעילים שוב ושוב את {% equation %}\left(T-\lambda I\right){% endequation %} עד שלבסוף אנחנו מגיעים אל 0 (או, אם תרצו, עד שאנחנו מגיעים אל וקטור עצמי של {% equation %}T{% endequation %} המתאים לערך העצמי {% equation %}\lambda{% endequation %}). {% equation %}w_{3}{% endequation %} הוא אותו <strong>וקטור ציקלי</strong> שהזכרתי קודם. שימו לב שכדי שהצורה היפה של בלוק ז'ורדן תתקבל אנחנו צריכים להקפיד על הסדר שבו הוקטורים מופיעים בבסיס: הוקטור הציקלי מופיע <strong>אחרון</strong>, והוקטורים שמתקבלים ממנו מופיעים לפניו, כשהסדר הוא מההפעלה האחרונה אל ההפעלה הראשונה.

זה מה שתיארתי קודם במה שקראתי לו "הרעיון על קצה המזלג"; עכשיו אנחנו גם מבינים למה צריך לעשות את זה. רק נשאר להבין איפה מוצאים את הוקטורים הציקליים המדוברים. ובכן, בואו נמשיך עוד קצת עם הדוגמה הנוכחית שלנו. ראינו ש-{% equation %}\left(T-\lambda I\right)w_{1}=0{% endequation %}. דרך אחרת לכתוב את זה היא {% equation %}w_{1}\in\ker\left(T-\lambda I\right){% endequation %}. ראינו גם ש-{% equation %}w_{1}=\left(T-\lambda I\right)w_{2}{% endequation %}, ולכן אם נפעיל את {% equation %}\left(T-\lambda I\right){% endequation %} על שני האגפים נקבל ש-{% equation %}\left(T-\lambda I\right)^{2}w_{2}=0{% endequation %}, כלומר {% equation %}w_{2}\in\ker\left(T-\lambda I\right)^{2}{% endequation %}. בדומה {% equation %}w_{3}\in\ker\left(T-\lambda I\right)^{3}{% endequation %}. העיקרון הזה נכון באופן כללי: לכל ערך עצמי {% equation %}\lambda{% endequation %} של {% equation %}T{% endequation %}, וקטור ציקלי שיוצר תת-מרחב מגודל {% equation %}k{% endequation %} עשוי להסתתר לנו בתוך {% equation %}\ker\left(T-\lambda I\right)^{k}{% endequation %}. אז אלו המקומות שבהם אנחנו מחפשים את הוקטורים הציקליים שלנו. בואו נדבר שניה טרמינולוגיה: <strong>וקטור עצמי</strong> היה וקטור {% equation %}w\in\ker\left(T-\lambda I\right){% endequation %}; לכן שם סביר לוקטור {% equation %}w\in\ker\left(T-\lambda I\right)^{k}{% endequation %} הוא <strong>וקטור עצמי מוכלל</strong>. אם כדי ללכסן מטריצה חיפשנו בסיס שמורכב מוקטורים עצמיים שלה, כאן אנחנו מחפשים בסיס שמורכב מוקטורים עצמיים מוכללים שלה. הקושי הוא שלא כל "סתם" בסיס של וקטורים עצמיים מוכללים יעבוד; חייבים כזה שנבנה מתוך וקטורים עצמיים מוכללים ציקליים.

מבחינה חישובית, בינתיים הכל מאוד קל: למצוא איברים ב-{% equation %}\ker\left(T-\lambda I\right)^{k}{% endequation %} זה בפועל לחשב חזקה של מטריצה סקלרית ולדרג אותה. להפעיל את {% equation %}\left(T-\lambda I\right){% endequation %} על וקטורים זה קל מאוד. אבל עדיין יש דברים לא ברורים. בתור התחלה, מאיפה מתחילים? נניח שאני יודע ש-{% equation %}\lambda{% endequation %} הוא ערך עצמי של {% equation %}T{% endequation %}, אז אני הולך לחפש וקטור ציקלי ב-{% equation %}\ker\left(T-\lambda I\right)^{k}{% endequation %}. אבל עבור איזה {% equation %}k{% endequation %}? שאני אקח באקראי {% equation %}k=1,000{% endequation %}? ובכן, כמובן שלא. ככל שמגדילים את {% equation %}k{% endequation %}, כך גם המרחב {% equation %}\ker\left(T-\lambda I\right)^{k}{% endequation %} גדל, עד שמגיעים לנקודת שבת. אפשר להתחיל את החיפושים ממנה. לא קשה לראות שה-{% equation %}k{% endequation %} שמתאים לנקודת השבת הזו הוא בדיוק החזקה {% equation %}k{% endequation %} של הגורם {% equation %}\left(x-\lambda\right){% endequation %} בפולינום המינימלי של {% equation %}T{% endequation %}, מה שמחזיר אותנו לתכונות שראינו קודם. וקטור ציקלי שנמצא ב-{% equation %}\ker\left(T-\lambda I\right)^{k}{% endequation %} יוצר בלוק מגודל <strong>לכל היותר</strong> {% equation %}k{% endequation %}; לכל היותר, כי הוא עשוי להיות שייך גם ל-{% equation %}\ker\left(T-\lambda I\right)^{k-1}{% endequation %} ואז הסדרה שהוא ייצור תהיה מאורך קטן מ-{% equation %}k{% endequation %}. לעומת זאת, אם הוא שייך ל-{% equation %}\ker\left(T-\lambda I\right)^{k}{% endequation %} אבל לא שייך ל-{% equation %}\ker\left(T-\lambda I\right)^{k-1}{% endequation %} מובטח לנו שגודל הבלוק שהוא ייצור הוא <strong>בדיוק</strong> {% equation %}k{% endequation %}. זה מסביר לנו באופן מלא את התכונה של "גודל הבלוק המקסימלי שווה לחזקה של הגורם בפולינום המינימלי" וגם את התכונות המסובכות אחר כך שהתבססו על המימדים של {% equation %}\ker\left(T-\lambda I\right)^{k}{% endequation %}. כמו כן, מכיוון שהסדרה שיוצר וקטור ציקלי מסתיימת תמיד בוקטור עצמי, הרי שמספר הסדרות של וקטורים ציקליים בלתי תלויים - שהוא בדיוק מספר הבלוקים - יהיה שווה למספר הוקטורים העצמיים הבלתי תלויים, כלומר לריבוי הגיאומטרי של {% equation %}\lambda{% endequation %}. הכל מתחבר!

נשאר רק להבין מה זה אומר למצוא וקטורים ציקליים "בלתי תלויים". לצורך כך בואו ניקח דוגמת צעצוע. נניח שאנחנו מחפשים וקטורים ציקליים עבור המטריצה

{% equation %}\left(\begin{array}{ccccc}2 & 1 & 0 & 0 & 0\\0 & 2 & 0 & 0 & 0\\0 & 0 & 2 & 1 & 0\\0 & 0 & 0 & 2 & 0\\0 & 0 & 0 & 0 & 2\end{array}\right){% endequation %}

זה אווילי, כי המטריצה הזו כבר נמצאת בצורת ז'ורדן. יש לנו שלושה בלוקים שכולם מתאימים לערך העצמי 2: שניים מגודל 2 ואחד מגודל 1. עדיין, בואו נראה מה קורה כשלוקחים את הפרוצדורה ומפעילים אותה על המקרה הזה. לא קשה לבדוק ולראות ש-{% equation %}\left(A-2I\right)^{2}{% endequation %} היא מטריצת האפס, ולכן {% equation %}\ker\left(A-2I\right)^{2}=\mathbb{C}^{5}{% endequation %} - המרחב כולו. יש לנו לכאורה חופש בחירה מוחלט לוקטורים שמתחשק לנו לקחת. אבל בפועל יש לנו שתי מגבלות. ראשית, אנחנו רוצים וקטורים ש<strong>לא</strong> שייכים ל-{% equation %}\ker\left(A-2I\right){% endequation %}, כי וקטורים כאלו יוצרים לנו בלוק מגודל 1 (כלומר, הסדרה שהם יוצרים תהיה מאורך 1 ותכיל רק את עצמם). זה מצמצם את חופש הבחירה שלנו: {% equation %}\ker\left(A-2I\right)=\left\{ \left(x,0,y,0,z\right)\ |\ x,y,z\in\mathbb{C}\right\} {% endequation %} ולכן כל וקטור שניקח יהיה חייב להיות מהצורה {% equation %}\left(a_{1},a_{2},a_{3},a_{4},a_{5}\right){% endequation %} כך ש-{% equation %}a_{2}\ne0{% endequation %} או {% equation %}a_{4}\ne0{% endequation %}.

יודעים מה? זה לא נשמע כמו מגבלה כל כך רצינית. לכאורה עדיין יש לנו המון וקטורים שאפשר לקחת. אבל האתגר הוא לקחת וקטורים שהשרשראות שהם יוצרים לא "יתנגשו". בואו נראה מקרה שבו זה כן קורה. בתור וקטור אחד ניקח את {% equation %}v=\left(0,1,0,0,0\right){% endequation %}, אבל בתור הוקטור השני, במקום לקחת את {% equation %}\left(0,0,0,1,0\right){% endequation %} המתבקש, אני אקח לצורך הדוגמה דווקא את {% equation %}u=\left(1,1,0,0,0\right){% endequation %}. למה לא? שני הוקטורים הללו, {% equation %}v,u{% endequation %}, הם בלתי תלויים לינארית; המרחב שהם פורשים הוא ממימד 2. מה אמור לרמוז לנו ש"אסור" לקחת את {% equation %}u{% endequation %}?

ובכן, בואו נסתכל על השרשרת ששני אלו מייצרים: {% equation %}\left(A-2I\right)v=\left(A-2I\right)u=\left(1,0,0,0,0\right){% endequation %}. קיבלנו התנגשות באיבר השני בשרשרת. מה שזה אומר לנו בפועל הוא ששני הוקטורים הציקליים {% equation %}u,v{% endequation %} מתאימים שניהם <strong>לאותו הבלוק</strong>. אני יכול להחליף את אחד מהם בשני ובסופו של דבר עדיין נקבל בסיס שנותן לנו את אותה צורת ז'ורדן. אבל אני לא יכול לדחוף ל-{% equation %}P{% endequation %} את שניהם ביחד. כי כזכור, כדי שהעסק יעבוד אנחנו צריכים לדחוף כל וקטור ציקלי ואת כל מי שהוא יוצר. אז מה נעשה עם {% equation %}\left(1,0,0,0,0\right){% endequation %}? נדחוף אותו פעמיים? ככה נקבל מטריצה {% equation %}P{% endequation %} לא הפיכה; "בסיס" {% equation %}P{% endequation %} שהוא תלוי לינארית כי אותו איבר מופיע בו פעמיים. אז אולי נוסיף את {% equation %}\left(1,0,0,0,0\right){% endequation %} רק פעם אחת? אבל אז נקבל <strong>מעט מדי</strong> וקטורים עצמיים מוכללים מכדי לקבל בסיס. בקיצור, אסור באיסור חמור לקבל התנגשות. האופןש בו יכלנו לזהות ש-{% equation %}u{% endequation %} הוא רע הוא על ידי כך שהיינו מזהים שאי שם בהמשך הוא ייתן לנו התנגשות עם {% equation %}v{% endequation %}.

מה הסיבה שבגללה קיבלנו התנגשות שכזו? ובכן, אם תחשבו על זה רגע, {% equation %}u=v+\left(1,0,0,0,0\right){% endequation %}. כלומר, אפשר לחשוב על {% equation %}u{% endequation %} הרע שלנו בתור {% equation %}v{% endequation %} הטוב ועוד "תוספת". עכשיו, אם נפעיל את {% equation %}\left(A-\lambda I\right){% endequation %} על {% equation %}u{% endequation %}, אז בזכות הלינאריות של טרנספורמציות לינאריות נקבל ש-{% equation %}\left(A-\lambda I\right)u=\left(A-\lambda I\right)v+\left(A-\lambda I\right)\left(1,0,0,0,0\right){% endequation %}. אלא ש-{% equation %}\left(1,0,0,0,0\right)\in\ker\left(A-\lambda I\right){% endequation %} ולכן התוספת "תתבטל". ונקבל התנגשות.

זה הרעיון שמתאר את הבעיה באופן כללי: שני וקטורים {% equation %}u,v\in\ker\left(A-\lambda I\right)^{k}{% endequation %} הם "בעייתיים" אם מתקיים ש-{% equation %}u-v\in\ker\left(A-\lambda I\right)^{k-1}{% endequation %}. פירוש הדבר הוא שאם נפעיל את {% equation %}\left(A-\lambda I\right){% endequation %} עליהם {% equation %}k-1{% endequation %} פעמים, מתישהו נקבל התנגשות - לכן לא נצליח לקבל {% equation %}k{% endequation %} וקטורים שונים. לתכונה הזו של ה"בעייתיות" יש טרמינולוגיה מאוד סטנדרטית במתמטיקה שבאה לתאר אותה, אם כי ייתכן שלרובכם היא לא מוכרת בהקשר של מרחבים וקטוריים: אומרים ש-{% equation %}u,v{% endequation %} הם <strong>שקולים מודולו</strong> {% equation %}\ker\left(A-\lambda I\right)^{k-1}{% endequation %}. הטרמינולוגיה הזו מאפשרת לנו לנסח מאוד באלגנטיות את מה שצריך לעשות כדי למצוא את הוקטורים הציקליים של {% equation %}\ker\left(A-\lambda I\right)^{k}{% endequation %}: אנחנו צריכים למצוא <strong>בסיס</strong> עבור <strong>מרחב המנה</strong> {% equation %}\ker\left(A-\lambda I\right)^{k}/\ker\left(A-\lambda I\right)^{k-1}{% endequation %}, ואז להעביר את הבסיס הזה לקבוצת וקטורים ב-{% equation %}\ker\left(A-\lambda I\right)^{k}{% endequation %}. אני אסביר את הטרמינולוגיה הזו בהמשך, כי לטעמי זו הדרך הנכונה לתאר את מה שצריך לעשות, אבל כדי לא לכפות אותה עליכם אני אציג קודם כל את האלגוריתם הכללי עם הניסוחים המסורבלים שכופה עלינו ההתעלמות מהטרמינולוגיה הזו.

בואו רק נשלים את דוגמת הצעצוע שלנו. אני מניח שאנחנו מסכימים ששני הוקטורים הציקליים שעלינו לבחור ב-{% equation %}\ker\left(A-2I\right)^{2}{% endequation %} הם הוקטורים {% equation %}v_{2}=\left(0,1,0,0,0,0\right){% endequation %} ו-{% equation %}u_{2}=\left(0,0,0,1,0\right){% endequation %}. סימנתי אותם עם אינדקס 2, כי כזכור, בבסיס הסדור {% equation %}P{% endequation %} שאני בונה הם מופיעים <strong>אחרי</strong> מי שמתקבלים מהם. ומי מתקבלים מהם?

{% equation %}v_{1}=\left(A-2I\right)v_{2}=\left(1,0,0,0,0\right){% endequation %}

{% equation %}u_{1}=\left(A-2I\right)u_{2}=\left(0,0,1,0,0\right){% endequation %}

אם כן, כרגע הבסיס הסדור שלי כולל את האיברים {% equation %}\left\{ v_{1},v_{2},u_{1},u_{2}\right\} {% endequation %}. עדיין חסר לי וקטור עצמי מוכלל אחד. האם פספסתי מישהו ב-{% equation %}\ker\left(A-2I\right)^{2}{% endequation %}? התשובה היא לא. דרך פשוטה להיות בטוחים בכך: {% equation %}\dim\ker\left(A-2I\right)^{2}-\dim\ker\left(A-2I\right)=2{% endequation %} ולכן אני מצפה למצוא רק 2 וקטורים ציקליים "בלתי תלויים" שם. אם כן, מה נשאר? כרגע יש לי שני וקטורים בלתי תלויים ב-{% equation %}\ker\left(A-2I\right){% endequation %}, אבל {% equation %}\dim\ker\left(A-2I\right)=3{% endequation %}, כך שחסר לי וקטור. אז מה שאני אעשה הוא לקחת את הקבוצה {% equation %}\left\{ u_{1},v_{1}\right\} {% endequation %}, ו<strong>להשלים אותה לבסיס</strong> של {% equation %}\ker\left(A-2I\right){% endequation %}. זה יניב לי את הוקטור {% equation %}\left(0,0,0,0,1\right){% endequation %}, וכך קיבלנו לבסוף את {% equation %}P{% endequation %} שלנו, שהיא פשוט הבסיס הסטנדרטי (מה שהוא לחלוטין לא מפתיע, כמובן, שהרי המטריצה שהתחלתי ממנה כבר הייתה בצורת ז'ורדן). ומה היה קורה אם הייתי בוחר, למשל, {% equation %}v_{2}=\left(1,1,0,0,0\right){% endequation %}? הייתי מקבל {% equation %}v_{1}=\left(1,0,0,0,0\right){% endequation %} ולכן שאר הבסיס שלי לא היה משתנה. אז הייתי מקבל בסיס קצת שונה, אבל הייצוג של המטריצה בבסיס הזה היה עדיין אותו ייצוג. באופן כללי בהינתן מטריצה {% equation %}A{% endequation %}, <strong>יש הרבה</strong> מטריצות מז'רדנות {% equation %}P{% endequation %}, כלומר הרבה מטריצות {% equation %}P{% endequation %} שונות שעבורן {% equation %}P^{-1}AP=J{% endequation %} כאשר {% equation %}J{% endequation %} היא אותה צורת ז'ורדן של {% equation %}A{% endequation %}. אין עם זה בעיה.

<strong>פרק רביעי, ובו אלגוריתם שהוא התכל'ס של התכל'ס ודוגמה שהיא התכל'ס של התכל'ס של התכל'ס</strong>

מה שנעשה עכשיו הוא זה: ראשית אציג את האלגוריתם המלא למציאת צורת ז'ורדן של מטריצה כללית {% equation %}A{% endequation %}; שנית אראה איך הוא עובד במקרה של ה-{% equation %}A{% endequation %} שהצגתי בתחילת הפוסט, בתור דוגמה; ולבסוף אנסח מחדש את האלגוריתם בטרמינולוגיה שאני אוהב של מרחבי מנה, אחרי שאסביר מהם בכלל.

נתחיל עם האלגוריתם הכללי. נתונה מטריצה {% equation %}A{% endequation %} ואנחנו רוצים למצוא את צורת ז'ורדן שלה ומטריצה מז'רדנת. מה עושים?
<ol>
	<li>נחשב את הפולינום האופייני {% equation %}p_{A}\left(x\right)=\det\left(xI-A\right){% endequation %} ונפרק אותו לגורמים לינאריים {% equation %}p_{A}\left(x\right)=\left(x-\lambda_{1}\right)^{k_{1}}\cdots\left(x-\lambda_{n}\right)^{k_{n}}{% endequation %}. אם הפולינום לא מתפרק לגורמים לינאריים מעל השדה אפשר לשכוח מצורת ז'ורדן. השורשים של הפולינום האופייני נקראים <strong>ערכים עצמיים</strong> של {% equation %}A{% endequation %}.</li>
	<li>לכל ערך עצמי {% equation %}\lambda{% endequation %} נסמן לצורך נוחות ב-{% equation %}B_{\lambda}{% endequation %} את המטריצה {% equation %}B_{\lambda}\triangleq A-\lambda I{% endequation %}, וכעת:
<ol>
	<li>נחשב את {% equation %}\dim\ker B_{\lambda}^{k}{% endequation %} עבור {% equation %}k=1,2,\dots{% endequation %} עד אשר נמצא {% equation %}k{% endequation %} כך ש-{% equation %}\dim\ker B_{\lambda}^{k+1}=\dim\ker B_{\lambda}^{k}{% endequation %} (באופן שקול, אפשר למצוא את הפולינום המינימלי של {% equation %}A{% endequation %} בדרך אחרת; {% equation %}k{% endequation %} המבוקש היא החזקה של הגורם {% equation %}\left(x-\lambda\right){% endequation %}).</li>
	<li>נבנה באופן אינדוקטיבי סדרה של קבוצות {% equation %}P_{k}^{\lambda},P_{k-1}^{\lambda},P_{k-2}^{\lambda},\dots,P_{1}^{\lambda}{% endequation %} באופן הבא: בתחילה, {% equation %}P_{k}^{\lambda}=\emptyset{% endequation %}. כעת, לכל {% equation %}t=k,k-1,\dots,1{% endequation %}:
<ol>
	<li>נוסיף ל-{% equation %}P_{t}^{\lambda}{% endequation %} איברים עד שיהיו בה {% equation %}\dim\ker B_{\lambda}^{t}-\dim\ker B_{\lambda}^{t-1}{% endequation %} איברים בסך הכל, כך שאין שני איברים <strong>שונים</strong> {% equation %}v,u\in P_{t}^{\lambda}{% endequation %} עבורם {% equation %}v-u\in\ker B_{\lambda}^{t-1}{% endequation %}. לאיברים שמתווספים בשלב הזה נקרא <strong>וקטורים ציקליים</strong>.</li>
	<li>לכל {% equation %}v\in P_{t}^{\lambda}{% endequation %} נוסיף ל-{% equation %}P_{t-1}^{\lambda}{% endequation %} את {% equation %}B_{\lambda}\cdot v{% endequation %} (לוקטורים הללו לא נקרא וקטורים ציקליים).</li>
</ol>
</li>
	<li>נגדיר {% equation %}P^{\lambda}=\bigcup_{t=1}^{k}P_{t}^{\lambda}{% endequation %}.</li>
</ol>
</li>
	<li>נגדיר {% equation %}P=\bigcup_{\lambda}P^{\lambda}{% endequation %}.</li>
	<li>נסדר את איברי ב-{% equation %}P{% endequation %} באופן הבא: נגדיר סדר כלשהו על הערכים העצמיים וכל הוקטורים שהתקבלו מערך עצמי {% equation %}\lambda{% endequation %} יופיעו ביחד בהתאם לסדר הזה, ונגדיר סדר כלשהו על הוקטורים הציקליים שהתגלו במהלך האלגוריתם. אם {% equation %}v{% endequation %} הוא וקטור ציקלי ששייך ל-{% equation %}P_{t}^{\lambda}{% endequation %} אז נסדר את האיברים {% equation %}B^{t}v,B^{t-1}v,\dots,Bv,v{% endequation %} בסדר הזה (כך ש-{% equation %}B^{t}v{% endequation %} ראשון ו-{% equation %}v{% endequation %} אחרון).</li>
</ol>
זה האופן הכי טוב שבו אני מסוגל לכתוב את האלגוריתם. נתקלתי בשלל ניסוחים שונים ומשונים שלו במקומות שונים ומשונים ואת כולם היה לי קשה מאוד להבין. אני מקווה שהניסוח הזה בהיר למדי. מה שכנראה לא ברור הוא <strong>איך</strong> מבצעים חלק מהשלבים של האלגוריתם. הרי מה שכתבתי לעיל הוא עדיין לא משהו שאפשר לתת למחשב לעשות. בעיה אחת, שקיימת כבר בלכסון מטריצות, היא איך לפרק את הפולינום האופייני לגורמים לינאריים - או באופן שקול, איך למצוא את השורשים שלו. מה אני אגיד לכם, זה עניין בעייתי. יש אלגוריתמים כמו ניוטון-רפסון שמוצאים שורשים של פולינומים (לפחות באופן מקורב) וכדומה, אבל באופן כללי זה יכול להיות מסובך. זה נושא ששייך לאנליזה נומרית ובדרך כלל לא רלוונטי לסטודנטים שלומדים את הנושא, כי עבורם יש תרגילים פשוטים שבהם לרוב אפשר לנחש בצורה חכמה את השורשים או שהם נתונים במפורש.

החלק היותר מעניין הוא זה שבו צריך לקחת את {% equation %}P_{t}^{\lambda}{% endequation %}, שאולי כבר יש בה כמה וקטורים שהגיעו מהשלב הקודם, ולהרחיב אותה כך שיהיו בה {% equation %}\dim\ker B_{\lambda}^{t}-\dim\ker B_{\lambda}^{t-1}{% endequation %} וקטורים שהם "בלתי תלויים, במובן שאמרתי קודם - לא מתקיים {% equation %}v-u\in\ker B_{\lambda}^{t-1}{% endequation %} לאף זוג וקטורים בתוכה. התשובה הפשוטה ביותר שאני מכיר היא זו: קחו בסיס ל-{% equation %}\ker B_{\lambda}^{t-1}{% endequation %}. הוסיפו לו את איברי {% equation %}P_{t}^{\lambda}{% endequation %} הנוכחיים. קיבלתם קבוצה של וקטורים ב-{% equation %}\ker B_{\lambda}^{t}{% endequation %} ואפשר להוכיח שהם תמיד יהיו בלתי תלויים לינארית. הרחיבו אותה לבסיס של {% equation %}\ker B_{\lambda}^{t}{% endequation %}. אברי הבסיס החדשים הם בדיוק האיברים שאתם רוצים להוסיף ל-{% equation %}P_{t}^{\lambda}{% endequation %}. כמובן, אני מניח שאתם כבר יודעים לפתור את בעיית ה"השלמה של קבוצת וקטורים לבסיס" - אבל זו בעיה הרבה יותר סטנדרטית באלגברה לינארית ולא אדבר עליה כאן.

למה זה עובד? פשוט מאוד: כי אם עבור {% equation %}v,u\in P_{t}^{\lambda}{% endequation %} מתקיים ש-{% equation %}v-u\in\ker B_{\lambda}^{t-1}{% endequation %}, אז אפשר לכתוב את {% equation %}v-u{% endequation %} כצירוף לינארי של הבסיס של {% equation %}\ker B_{\lambda}^{t-1}{% endequation %}, כלומר {% equation %}v-u=\sum\rho_{i}b_{i}{% endequation %}. נעביר אגפים והופס, {% equation %}v-u-\sum\rho_{i}b_{i}=0{% endequation %}, קיבלנו צירוף לינארי של אברי בסיס של {% equation %}\ker B_{\lambda}^{t}{% endequation %} שנותן 0. זה אפשרי רק אם כל המקדמים בצירוף הלינארי הזה הם 0, כלומר בפרט {% equation %}v-u=0{% endequation %}, כלומר {% equation %}v=u{% endequation %}. אז רק רגע, אם זה כל כך פשוט, למה לא כתבתי את זה באלגוריתם מלכתחילה? ובכן, בגלל שאם <strong>אני</strong> הייתי קורא את זה באלגוריתם מלכתחילה, לא הייתי מבין מה לעזאזל הרעיון שמאחורי השלב הזה. אני מעדיף שהאלגוריתם יציג את הרעיון ולא את הפרטים של הביצוע הטכני שלו. פרט לכך, אל תדאגו - בניסוח עם מרחבי מנה, יופיע שם בדיוק הדבר הזה.

בואו נעבור, אם כן, לפתרון של הדוגמה מתחילת הפוסט. אקפוץ על השלב של חישוב הפולינום האופייני של {% equation %}A{% endequation %}: כפי שאמרתי קודם, מקבלים {% equation %}p_{A}\left(x\right)=\left(x-3\right)\left(x-2\right)^{5}{% endequation %}. סביר להתחיל עם הערך העצמי 3. עבורו, המטריצה {% equation %}B=\left(A-3I\right){% endequation %} יוצאת

{% equation %}B=\left(\begin{array}{rrrrrr}0 & 0 & 0 & 0 & 0 & 0\\0 & -1 & 0 & 0 & -1 & 0\\0 & 0 & -1 & 0 & 1 & 0\\0 & 0 & 0 & -1 & 0 & 1\\0 & 1 & 1 & 0 & -1 & 0\\0 & 0 & 0 & 0 & 0 & -1\end{array}\right){% endequation %}

דירוג מטריצות סטנדרטי יעביר אותנו למטריצה הבאה:

{% equation %}\left(\begin{array}{rrrrrr}0 & 0 & 0 & 0 & 0 & 0\\0 & 1 & 0 & 0 & 0 & 0\\0 & 0 & 1 & 0 & 0 & 0\\0 & 0 & 0 & 1 & 0 & 0\\0 & 0 & 0 & 0 & 1 & 0\\0 & 0 & 0 & 0 & 0 & 1\end{array}\right){% endequation %}

ולכן {% equation %}\ker B=\mbox{span}\left\{ e_{1}\right\} {% endequation %} כאשר {% equation %}e_{1}=\left(1,0,0,0,0,0\right){% endequation %} הוא וקטור של הבסיס הסטנדרטי. אם נחזור על התעלול עבור {% equation %}B^{2}{% endequation %} נגלה שנקבל את אותו הדבר בדיוק - {% equation %}\ker B^{2}=\ker B^{1}{% endequation %}. זה כמובן לא אמור להפתיע אותנו בשום צורה - אנחנו יודעים שהגורם של {% equation %}\left(x-3\right){% endequation %} בפולינום האופייני הוא 1, ולכן זה גם הגורם בפולינום המינימלי, ולכן המרחב {% equation %}\ker B^{2}{% endequation %} ממילא לא רלוונטי עבורנו. אם כן, אין לנו כמעט מה לעשות כאן: ב-{% equation %}P{% endequation %} הסופי שלנו יהיה את {% equation %}e_{1}{% endequation %}, ואפשר לעבור לטפל בערך העצמי האחר, {% equation %}\lambda=2{% endequation %}.

נגדיר אם כן {% equation %}B=\left(A-2I\right){% endequation %}, נחשב חזקות של {% equation %}B{% endequation %} ונקבל את המטריצות

{% equation %}B=\left(\begin{array}{rrrrrr}1 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & -1 & 0\\0 & 0 & 0 & 0 & 1 & 0\\0 & 0 & 0 & 0 & 0 & 1\\0 & 1 & 1 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\end{array}\right),B^{2}=\left(\begin{array}{rrrrrr}1 & 0 & 0 & 0 & 0 & 0\\0 & -1 & -1 & 0 & 0 & 0\\0 & 1 & 1 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\end{array}\right),B^{3}=\left(\begin{array}{rrrrrr}1 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\end{array}\right){% endequation %}

ובבירור {% equation %}B^{4}=B^{3}{% endequation %} ולכן הסיפור ייתקע ב-{% equation %}B^{3}{% endequation %} ומשם אנחנו צריכים להתחיל לחפש את הוקטורים הציקליים שלנו.

נפתח, אם כן, במציאת וקטורים ציקליים ב-{% equation %}\ker B^{3}{% endequation %}. אמרנו שהדרך לעשות זאת בפועל היא למצוא בסיס ל-{% equation %}\ker B^{2}{% endequation %} ואז להשלים אותו לבסיס של {% equation %}\ker B^{3}{% endequation %}. מה יניב לנו דירוג מטריצות של {% equation %}B^{2}{% endequation %}? את המטריצה הבאה:

{% equation %}\left(\begin{array}{rrrrrr}1 & 0 & 0 & 0 & 0 & 0\\0 & 1 & 1 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\end{array}\right){% endequation %}

כלומר, {% equation %}\ker B^{2}=\left\{ \left(0,a,-a,b,c,d\right)\ |\ a,b,c,d\in\mathbb{C}\right\} {% endequation %} - מרחב 4-ממדי. בתור בסיס שלו אפשר לקחת למשל את {% equation %}\left\{ e_{2}-e_{3},e_{4},e_{5},e_{6}\right\} {% endequation %}.

את {% equation %}B^{3}{% endequation %} אין צורך לדרג - היא כבר מדורגת, ובבירור {% equation %}\ker B^{3}=\left\{ \left(0,a,f,b,c,d\right)\ |\ a,b,c,d,f\in\mathbb{C}\right\} {% endequation %}. כלומר, הוסרה המגבלה על הקואורדינטה השלישית להיות נגדית של השניה. אם כן, את מי אפשר להוסיף לבסיס {% equation %}\left\{ e_{2}-e_{3},e_{4},e_{5},e_{6}\right\} {% endequation %}? אפשר להוסיף את {% equation %}e_{2}{% endequation %} בלי לדאוג יותר מדי. קל לבדוק שהוא אכן בלתי תלוי בשאר הוקטורים. אם כן, {% equation %}e_{2}{% endequation %} יהיה הוקטור הציקלי הראשון שלנו, זה שיצור בלוק ז'ורדן מסדר 3. בסימונים שלי, {% equation %}P_{3}=\left\{ e_{2}\right\} {% endequation %}.

עכשיו, נחשב את {% equation %}B\cdot e_{2}=e_{5}{% endequation %} (זכרו - מטריצה כפול וקטור בסיס סטנדרטי זה פשוט לקחת את העמודה המתאימה). רעיונית אני יכול להמשיך עם זה, לחשב גם את {% equation %}B^{2}\cdot e_{2}=-e_{2}+e_{3}{% endequation %} וכבר להגיד שאני מוסיף לבסיס שאני בונה את שלושת הוקטורים הללו, אבל בואו נרגיע רגע עם זה ונעבוד על פי האלגוריתם שלי. בסימונים שלי, {% equation %}P_{2}=\left\{ e_{5}\right\} {% endequation %} בשלב הזה ואני צריך להרחיב אותה עוד קצת. מתחילים בלמצוא את {% equation %}\ker B{% endequation %} על ידי דירוג של {% equation %}B{% endequation %}. מקבלים את המטריצה המדורגת

{% equation %}\left(\begin{array}{rrrrrr}1 & 0 & 0 & 0 & 0 & 0\\0 & 1 & 1 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 1 & 0\\0 & 0 & 0 & 0 & 0 & 1\\0 & 0 & 0 & 0 & 0 & 0\\0 & 0 & 0 & 0 & 0 & 0\end{array}\right){% endequation %}

כלומר, {% equation %}\ker B=\left\{ \left(0,a,-a,b,0,0\right)\ |\ a,b\in\mathbb{C}\right\} {% endequation %} וזהו בבירור מרחב ממימד 2. לכן אנחנו רוצים להרחיב את {% equation %}P_{2}{% endequation %} כך שיהיו בה {% equation %}\dim\ker B^{2}-\dim\ker B=4-2=2{% endequation %} וקטורים. נפעל כמו קודם: ניקח בסיס ל-{% equation %}\ker B{% endequation %}, נוסיף אליו את מי שכבר ב-{% equation %}P_{2}{% endequation %}, ואז נרחיב לבסיס של {% equation %}\ker B^{2}{% endequation %}. בסיס ל-{% equation %}\ker B{% endequation %} הוא {% equation %}\left\{ e_{2}-e_{3},e_{4}\right\} {% endequation %}, ולכן אנחנו רוצים להרחיב את הקבוצה {% equation %}\left\{ e_{2}-e_{3},e_{4},e_{5}\right\} {% endequation %} לבסיס עבור {% equation %}\ker B^{2}{% endequation %}. היי, זה בדיוק כמו הבסיס של {% equation %}\ker B^{2}{% endequation %} שכבר מצאנו קודם חוץ מ-{% equation %}e_{6}{% endequation %} שלא בפנים! איזה יופי, גילינו ש-{% equation %}e_{6}{% endequation %} הוא הוקטור הציקלי השני שלנו. בסך הכל, {% equation %}P_{2}=\left\{ e_{5},e_{6}\right\} {% endequation %} בסוף השלב הזה.

כעת אנו מחשבים את {% equation %}B\cdot e_{5}=-e_{2}+e_{3}{% endequation %} ואת {% equation %}B\cdot e_{6}=e_{4}{% endequation %} ומקבלים {% equation %}P_{1}=\left\{ -e_{2}+e_{3},e_{4}\right\} {% endequation %}. מכיוון ש-{% equation %}\dim\ker B=2{% endequation %} אין לנו עוד וקטורים שאנחנו רוצים להוסיף לקבוצה הזו - סיימנו. על ידי איחוד כל ה-{% equation %}P{% endequation %}-ים שמצאנו וסידור על פי שיטת הסידור שבחרתי קודם, אני מקבל בסוף את הבסיס הסדור {% equation %}P=\left\{ e_{1},-e_{2}+e_{3},e_{5},e_{2},e_{4},e_{6}\right\} {% endequation %}. אם תסתכלו על המטריצה מתחילת הפוסט, זו בדיוק המטריצה הזו. סיימנו!

כמובן, מה שהיה פה הוא קסם. איך קרה הנס הזה שהיו קיימים לנו וקטורים ציקליים, ושקיבלנו קבוצה בלתי תלויה של וקטורים? מה שמבטיח לנו את זה הוא משפט עמוק שלא הוכחתי ולא הראיתי במפורש, אבל זה, כאמור, יהיה שייך לפוסט אחר.

<strong>פרק חמישי ואחרון שבו האלגוריתם מקבל מנה אחת אפיים ואוי ואבוי טוב שזה נגמר נשבר לי מבדיחות הקרש הללו</strong>

הבטחתי להציג את הטרמינולוגיה שלטעמי היא הנכונה ביותר לתיאור כל הסיפור הזה - <strong>מרחבי מנה</strong>. מרחבי מנה באלגברה הם נושא נפוץ ביותר - בהקשר של חבורות וחוגים אנחנו רואים אותם כל הזמן. איכשהו יצא שעבור מרחבים וקטוריים אותו מושג הוא הרבה פחות פופולרי ושימושי, אבל כאן הוא בהחלט מתאים. אז אני אתאר את ההגדרות הבסיסיות - שוב, תחת הנחה שאתם יודעים קצת אלגברה.

ובכן, יהא {% equation %}V{% endequation %} מרחב וקטורי ו-{% equation %}W\subseteq V{% endequation %} תת-מרחב שלו. נגדיר <strong>יחס שקילות</strong> על הוקטורים של {% equation %}V{% endequation %}: {% equation %}v\equiv_{W}u{% endequation %} אם ורק אם {% equation %}v-u\in W{% endequation %}. זה בבירור יחס שקילות בגלל תכונות סטנדרטיות של תת-מרחבים וקטוריים: {% equation %}0\in W{% endequation %} ולכן רפלקסיביות; אם {% equation %}v\in W{% endequation %} גם {% equation %}-v\in W{% endequation %} ולכן סימטריה; ו-{% equation %}W{% endequation %} סגור לחיבור ולכן טרנזיטיביות ({% equation %}\left(v-w\right)=\left(v-u\right)+\left(u-w\right){% endequation %}). <strong>מחלקת השקילות</strong> של {% equation %}v{% endequation %} היא אוסף כל האיברים השקולים לו: {% equation %}\left[v\right]_{W}\triangleq\left\{ u\in V\ |\ v\equiv_{W}u\right\} =\left\{ v+w\ |\ w\in W\right\} {% endequation %}. השוויון האחרון מצדיק את הסימון המקובל יותר, {% equation %}v+W{% endequation %}, עבור מחלקת השקילות הזו, שגם נקראת לפעמים <strong>קוסט</strong> של {% equation %}W{% endequation %}. כעת אנחנו מגדירים את <strong>מרחב המנה</strong> {% equation %}V/W{% endequation %} בתור מרחב המנה של היחס - אוסף הקוסטים שלו. דהיינו, {% equation %}V/W\triangleq\left\{ v+W\ |\ v\in V\right\} {% endequation %}.

שימו לב לכך ש-{% equation %}V/W{% endequation %} הוא <strong>לא</strong> תת-מרחב של {% equation %}V{% endequation %}. זה לא ייתכן כבר ברמה הסינטקטית: אברי {% equation %}V/W{% endequation %} הם לא איברים של {% equation %}V{% endequation %} אלא <strong>קבוצות</strong> של איברים של {% equation %}V{% endequation %}. אז איך נכון לחשוב על {% equation %}V/W{% endequation %}? בתור מרחב שמתקבל מכך ש"מדביקים ביחד" איברים שונים של {% equation %}V{% endequation %}. הדוגמה הקלאסית היא עבור {% equation %}V=\mathbb{R}^{2}{% endequation %} ו-{% equation %}W{% endequation %} שהוא תת-מרחב ממימד 1, כלומר קו ישר ב-{% equation %}\mathbb{R}^{2}{% endequation %}. במקרה הזה, מחלקות השקילות של {% equation %}V/W{% endequation %} יהיו בדיוק הישרים שמקבילים ל-{% equation %}V/W{% endequation %}. המרחב הזה איזומורפי ל-{% equation %}\mathbb{R}^{1}{% endequation %} - תחשבו, למשל, שמעבירים כל ישר ב-{% equation %}V/W{% endequation %} לנקודה שהוא חותך על ציר {% equation %}x{% endequation %} (או, אם {% equation %}W{% endequation %} הוא ציר {% equation %}x{% endequation %}, לנקודה שהוא חותך על ציר {% equation %}y{% endequation %}).

דרך קצת יותר כללית להבין מרחבי מנה היא באמצעות משפט האיזומורפיזם הראשון, כשהוא מנוסח עבור מרחבים וקטוריים: אם {% equation %}T:V\to U{% endequation %} היא טרנספורמציה לינארית כלשהי, אז {% equation %}V/\ker T\cong\mbox{Im}T{% endequation %}. כלומר, כדי להבין מרחב מנה {% equation %}V/W{% endequation %} אפשר לחשוב על טרנספורמציה לינארית שמעבירה את אברי {% equation %}V{% endequation %} למרחב כלשהו שנוח לנו לדמיין כך שהגרעין יוצא בדיוק {% equation %}W{% endequation %}. בעזרת המשפט הזה קל לראות שלמשל, אם {% equation %}V=W\oplus U{% endequation %} אז {% equation %}V/W\cong U{% endequation %} (עם ההעתקה {% equation %}T\left(v\right)=T\left(w+u\right)=u{% endequation %}, כאשר {% equation %}v=w+u{% endequation %} היא ההצגה היחידה של {% equation %}v{% endequation %} כצירוף לינארי של איבר מ-{% equation %}W{% endequation %} ואיבר מ-{% equation %}U{% endequation %}). באופן מפורש, האיזומורפיזם שולח את {% equation %}u\in U{% endequation %} אל {% equation %}u+W\in V/W{% endequation %} (ולהיפך: משפט האיזומורפיזם הראשון מראה שכל קוסט של {% equation %}W{% endequation %} ניתן לכתיבה באופן יחיד בתור {% equation %}u+W{% endequation %} עם {% equation %}u\in W{% endequation %} ואז האיזומורפיזם מעביר את הקוסט אל {% equation %}u{% endequation %}).

התוצאה האחרונה הזו גם מראה לנו כיצד ניתן למצוא בסיס ל-{% equation %}V/W{% endequation %}: אם נתון לנו כבר בסיס {% equation %}\left\{ w_{1},\dots,w_{k}\right\} {% endequation %} עבור {% equation %}W{% endequation %}, אנחנו משלימים אותו לבסיס עבור {% equation %}V{% endequation %}, שנסמן {% equation %}\left\{ w_{1},\dots,w_{k},u_{1},\dots,u_{t}\right\} {% endequation %}. כעת נגדיר {% equation %}U=\mbox{span}\left\{ u_{1},\dots,u_{t}\right\} {% endequation %} וקיבלנו ש-{% equation %}V=W\oplus U{% endequation %}. לכן {% equation %}U\cong V/W{% endequation %}, ולכן {% equation %}u_{1}+W,\dots,u_{t}+W{% endequation %} הוא בסיס של {% equation %}V/W{% endequation %} (התמונה של בסיס על ידי איזומורפיזם היא בסיס).

עכשיו, עם הטרמינולוגיה החדשה הזו, הנה ניסוח מחודש של האלגוריתם למציאת צורת ז'ורדן של {% equation %}A{% endequation %}:
<ol>
	<li>נחשב את הפולינום האופייני {% equation %}p_{A}\left(x\right)=\det\left(xI-A\right){% endequation %} ונפרק אותו לגורמים לינאריים {% equation %}p_{A}\left(x\right)=\left(x-\lambda_{1}\right)^{k_{1}}\cdots\left(x-\lambda_{n}\right)^{k_{n}}{% endequation %}. אם הפולינום לא מתפרק לגורמים לינאריים מעל השדה אפשר לשכוח מצורת ז'ורדן. השורשים של הפולינום האופייני נקראים <strong>ערכים עצמיים</strong> של {% equation %}A{% endequation %}.</li>
	<li>לכל ערך עצמי {% equation %}\lambda{% endequation %} נסמן לצורך נוחות ב-{% equation %}B_{\lambda}{% endequation %} את המטריצה {% equation %}B_{\lambda}\triangleq A-\lambda I{% endequation %}, ונסמן ב-{% equation %}V_{\lambda}^{k}{% endequation %} את תת-המרחב {% equation %}V_{\lambda}^{k}\triangleq\ker B_{\lambda}^{k}{% endequation %}. כעת:
<ol>
	<li>נחשב את {% equation %}\dim\left(V_{\lambda}^{k+1}/V_{\lambda}^{k}\right){% endequation %} עבור {% equation %}k=1,2,\dots{% endequation %} עד אשר נמצא {% equation %}k{% endequation %} שהמימד שווה ל-0 עבורו.</li>
	<li>נבנה באופן אינדוקטיבי סדרה של קבוצות {% equation %}P_{k}^{\lambda},P_{k-1}^{\lambda},P_{k-2}^{\lambda},\dots,P_{1}^{\lambda}{% endequation %} באופן הבא: בתחילה, {% equation %}P_{k}^{\lambda}=\emptyset{% endequation %}. כעת, לכל {% equation %}t=k,k-1,\dots,1{% endequation %}:
<ol>
	<li>ניקח את קבוצת הקוסטים {% equation %}\left\{ v+V_{\lambda}^{t-1}\ |\ v\in P_{t}^{\lambda}\right\} {% endequation %} ונרחיב אותה לבסיס של {% equation %}V_{\lambda}^{t}/V_{\lambda}^{t-1}{% endequation %}.</li>
	<li>נוסיף ל-{% equation %}P_{t}^{\lambda}{% endequation %} את הנציגים של הקוסטים שהתווספו בשלב ההרחבה הזה. לאיברים הללו נקרא <strong>וקטורים ציקליים</strong>.</li>
	<li>לכל {% equation %}v\in P_{t}^{\lambda}{% endequation %} נוסיף ל-{% equation %}P_{t-1}^{\lambda}{% endequation %} את {% equation %}B_{\lambda}\cdot v{% endequation %} (לוקטורים הללו לא נקרא וקטורים ציקליים).</li>
</ol>
</li>
	<li>נגדיר {% equation %}P^{\lambda}=\bigcup_{t=1}^{k}P_{t}^{\lambda}{% endequation %}.</li>
</ol>
</li>
	<li>נגדיר {% equation %}P=\bigcup_{\lambda}P^{\lambda}{% endequation %}.</li>
	<li>נסדר את איברי ב-{% equation %}P{% endequation %} באופן הבא: נגדיר סדר כלשהו על הערכים העצמיים וכל הוקטורים שהתקבלו מערך עצמי {% equation %}\lambda{% endequation %} יופיעו ביחד בהתאם לסדר הזה, ונגדיר סדר כלשהו על הוקטורים הציקליים שהתגלו במהלך האלגוריתם. אם {% equation %}v{% endequation %} הוא וקטור ציקלי ששייך ל-{% equation %}P_{t}^{\lambda}{% endequation %} אז נסדר את האיברים {% equation %}B^{t}v,B^{t-1}v,\dots,Bv,v{% endequation %} בסדר הזה (כך ש-{% equation %}B^{t}v{% endequation %} ראשון ו-{% equation %}v{% endequation %} אחרון).</li>
</ol>
זו הגרסה הפשוטה ביותר של האלגוריתם שאני מסוגל לתאר. האם תוכלו לתת ניסוח טוב יותר? אשמח לשמוע.
